const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-DPhFfl2S.js","assets/utils-Cz6gIjS7.js","assets/vue-C4hvfNT6.js","assets/utils-B7EFy5Gd.css"])))=>i.map(i=>d[i]);
var Or=Object.defineProperty;var On=e=>{throw TypeError(e)};var Mr=(e,t,n)=>t in e?Or(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var I=(e,t,n)=>Mr(e,typeof t!="symbol"?t+"":t,n),Gt=(e,t,n)=>t.has(e)||On("Cannot "+n);var F=(e,t,n)=>(Gt(e,t,"read from private field"),n?n.call(e):t.get(e)),de=(e,t,n)=>t.has(e)?On("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),it=(e,t,n,r)=>(Gt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),st=(e,t,n)=>(Gt(e,t,"access private method"),n);var Mn=(e,t,n,r)=>({set _(i){it(e,t,i,n)},get _(){return F(e,t,r)}});import{C as Ir,ag as dn,ah as pn,aG as Ye,r as nn,ap as Lr,aH as B,y as Ee,p as mn,v as Qe,i as Et,b as se,P as Cr,m as et,D as wt,x as Pr,w as zt,aI as ct,a as ot,N as Wt,O as _t,n as xr,E as In,t as gn,F as rn,u as lt,B as Ae,o as kr,S as $r,V as Ln,c as ue,q as qr,G as sn,L as Hr,aJ as Fr,U as Ur,_ as Ht,I as on,aw as Br,H as Yr,aK as nr,h as me,T as Vr,K as Gr,W as zr,A as Wr,ay as jr,R as Zr,aL as Cn,aM as Pn,aD as Xr,aC as xn,az as Jr,aA as Kr,aB as Qr}from"./utils-Cz6gIjS7.js";import{d as pt,h as Re,c as Ze,a as Ve,b as ae,n as ie,v as Rt,e as j,D as Ot,u as rr,s as Mt,g as ir,J as ei,i as K,f as kn,F as ti,w as ni,y as ri,B as $n,C as ii,S as si,N as oi,r as jt,j as ui,R as ai}from"./vue-C4hvfNT6.js";const ce=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),bt=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),un=Object.freeze({CREATED:0,MOUNDTED:1}),le={UNDEFINED:0,PENDING:1,DONE:2},Se={PENDING:-1,HIDDEN:0,VISIBLE:1},ut=[25,50,75,100,125,150,200,300,400],li=["class","className","style"],Te=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDDE_LINE:"quickprint-guide-line"}),qn=Promise.resolve(),ci=2e3,fi=48;let an=0,At=0;function hi(){an=0,At=0}function ze(){return an<=ci?(an++,qn):At<fi?(At++,qn):new Promise(e=>{At=0,setTimeout(e)})}function di(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)}function pi(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123}function ln(e){return e==null?"":typeof e=="string"?e.trim():Array.isArray(e)?e.map(ln).join(" "):typeof e=="object"?Object.keys(e).filter(t=>e[t]).join(" "):""}function sr(e,t){if(t!=null){if(t instanceof Element){e.appendChild(t);return}if(Array.isArray(t)){for(const n of t)sr(e,n);return}e.textContent+=t}}function mi(e,t){if(!(t==null||typeof t!="object"))for(const n of Object.keys(t)){const r=t[n];if(r==null)continue;const i=Ir(n);e.style.setProperty(i,r)}}function gi(e,t){if(ln(t)=="")return;const r=e.className==""?"":" ";e.className+=r+ln(t)}function or(e,t,n){switch(t){case"class":case"className":gi(e,n);break;case"style":mi(e,n);break;case"children":n!=null&&sr(e,n);break;case"innerHTML":break;default:if(t[0]==="@")return vi(e,t,n);t in e&&(e[t]=n),n==null?e.removeAttribute(t):e.setAttribute(t,n)}}function vi(e,t,n){Reflect.set(e,t.slice(1),n)}function Ei(e,t,n){const r=e(t);if(r==null)return null;for(const i of Object.keys(t??{}))(di(i)||pi(i)||li.includes(i))&&or(r,i,t[i]);return r}function wi(e,t,n){const r=document.createElement(e);if(r==null)return null;for(const i of Object.keys(t??{}))or(r,i,t[i]);return r}function Q(e,t,n){return typeof e=="function"?Ei(e,t):wi(e,t)}function Hn(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var xt,xe;const kt=class kt{constructor(t,n,r){de(this,xt,dn(pn.PRINT_PAGE));de(this,xe,Object.create(null));I(this,"fid");I(this,"define");I(this,"pageNum",-1);I(this,"pageTotal",-1);I(this,"extra",!1);I(this,"paper");I(this,"header");I(this,"footer");I(this,"children",[]);I(this,"fixed",[]);I(this,"parent");I(this,"element");I(this,"rendering");I(this,"state",bt.CREATED);this.fid=r,this.define=t,this.paper=this.createPaper(t,n),this.header=this.createHeader(),this.footer=this.createFooter(),Ye(this,"parent",null),Ye(this,"element",null),Ye(this,"rendering",0)}static create(t,n,r="0000"){return new kt(t,n,r)}get id(){return"@"+F(this,xt)}get index(){return this.parent==null?-1:this.parent.pages.findIndex(t=>t.id===this.id)}get defines(){const t=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>t.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>t.add(i.id)),this.define.children.filter(i=>!t.has(i.id)).sort(nn.sort)}get style(){const{offsetWidth:t,offsetHeight:n}=this.paper;return{width:t+"px",height:n+"px"}}createPageHeader(){const t=this.header;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[Te.GUIDDE_LINE,Te.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}createPageFooter(){const t=this.footer;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[Te.GUIDDE_LINE,Te.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}render(){return Q("div",{id:this.id,class:Te.PAGE,"data-index":this.index+1,children:Q("div",{class:Te.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(t){this.state=bt.PAGED,await this.onPaged()}async mountChild(t){if(this.element==null||t.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(t.element),await ze(),await t.mount(t.element),!0)}async replaceChild(t,n){if(this.element==null||t.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null?r.removeChild(t.element):r.replaceChild(n,t.element),await ze(),await t.mount(n),!0)}beginPaging(){this.state=bt.PAGING}onCreated(){const t=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(t.map(n=>n.onCreated()))}onPaged(){const t=this.children.map(n=>typeof n.onPaged=="function"?n.onPaged():Promise.resolve());return Promise.allSettled(t)}onFinshed(){const t=this.children.map(n=>typeof n.onFinished=="function"?n.onFinished():Promise.resolve());return Promise.allSettled(t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),F(this,xe)[t.id]=t}appendToHeader(t){t.setParent(this),this.header.children.push(t),F(this,xe)[t.id]=t}appendToFooter(t){t.setParent(this),this.footer.children.push(t),F(this,xe)[t.id]=t}appendToFixed(t){t.setParent(this),this.fixed.push(t),F(this,xe)[t.id]=t}createPaper(t,n){return{size:n.size,width:n.width,height:n.height,orientation:t.orientation,offsetWidth:Math.round(n.width),offsetHeight:Math.round(n.height)}}createHeader(){const t=this.define.header;if(t.display!==!0)return Hn();const n=t.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const t=this.define.footer;if(t.display!==!0)return Hn();const n=t.height??0,i=Math.floor(Lr(this.paper.height))-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const t=new kt(this.define,this.paper,this.fid);t.rendering=0;for(const n of this.header.children){const r=n.clone();t.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();t.appendToFooter(r)}return t}findElement(t){const n=F(this,xe)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}filterElement(t){const n=typeof t=="string"?t:t.id;return this.children.filter(r=>r.define.id===n)}};xt=new WeakMap,xe=new WeakMap;let It=kt;var tt=1e9,yi={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},En,V=!0,ge="[DecimalError] ",Ge=ge+"Invalid argument: ",vn=ge+"Exponent out of range: ",nt=Math.floor,He=Math.pow,Ni=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe,ne=1e7,Y=7,ur=9007199254740991,Lt=nt(ur/Y),N={};N.absoluteValue=N.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};N.comparedTo=N.cmp=function(e){var t,n,r,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(r=s.d.length,i=e.d.length,t=0,n=r<i?r:i;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};N.decimalPlaces=N.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Y;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};N.dividedBy=N.div=function(e){return Me(this,new this.constructor(e))};N.dividedToIntegerBy=N.idiv=function(e){var t=this,n=t.constructor;return H(Me(t,new n(e),0,1),n.precision)};N.equals=N.eq=function(e){return!this.cmp(e)};N.exponent=function(){return X(this)};N.greaterThan=N.gt=function(e){return this.cmp(e)>0};N.greaterThanOrEqualTo=N.gte=function(e){return this.cmp(e)>=0};N.isInteger=N.isint=function(){return this.e>this.d.length-2};N.isNegative=N.isneg=function(){return this.s<0};N.isPositive=N.ispos=function(){return this.s>0};N.isZero=function(){return this.s===0};N.lessThan=N.lt=function(e){return this.cmp(e)<0};N.lessThanOrEqualTo=N.lte=function(e){return this.cmp(e)<1};N.logarithm=N.log=function(e){var t,n=this,r=n.constructor,i=r.precision,s=i+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(fe))throw Error(ge+"NaN");if(n.s<1)throw Error(ge+(n.s?"NaN":"-Infinity"));return n.eq(fe)?new r(0):(V=!1,t=Me(ht(n,s),ht(e,s),s),V=!0,H(t,i))};N.minus=N.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?cr(t,e):ar(t,(e.s=-e.s,e))};N.modulo=N.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(e=new r(e),!e.s)throw Error(ge+"NaN");return n.s?(V=!1,t=Me(n,e,0,1).times(e),V=!0,n.minus(t)):H(new r(n),i)};N.naturalExponential=N.exp=function(){return lr(this)};N.naturalLogarithm=N.ln=function(){return ht(this)};N.negated=N.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};N.plus=N.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ar(t,e):cr(t,(e.s=-e.s,e))};N.precision=N.sd=function(e){var t,n,r,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ge+e);if(t=X(i)+1,r=i.d.length-1,n=r*Y+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};N.squareRoot=N.sqrt=function(){var e,t,n,r,i,s,o,u=this,a=u.constructor;if(u.s<1){if(!u.s)return new a(0);throw Error(ge+"NaN")}for(e=X(u),V=!1,i=Math.sqrt(+u),i==0||i==1/0?(t=ye(u.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=nt((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new a(t)):r=new a(i.toString()),n=a.precision,i=o=n+3;;)if(s=r,r=s.plus(Me(u,s,o+2)).times(.5),ye(s.d).slice(0,o)===(t=ye(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(H(s,n+1,0),s.times(s).eq(u)){r=s;break}}else if(t!="9999")break;o+=4}return V=!0,H(r,n)};N.times=N.mul=function(e){var t,n,r,i,s,o,u,a,c,f=this,d=f.constructor,y=f.d,m=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,n=f.e+e.e,a=y.length,c=m.length,a<c&&(s=y,y=m,m=s,o=a,a=c,c=o),s=[],o=a+c,r=o;r--;)s.push(0);for(r=c;--r>=0;){for(t=0,i=a+r;i>r;)u=s[i]+m[r]*y[i-r-1]+t,s[i--]=u%ne|0,t=u/ne|0;s[i]=(s[i]+t)%ne|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,V?H(e,d.precision):e};N.toDecimalPlaces=N.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(De(e,0,tt),t===void 0?t=r.rounding:De(t,0,8),H(n,e+X(n)+1,t))};N.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=We(r,!0):(De(e,0,tt),t===void 0?t=i.rounding:De(t,0,8),r=H(new i(r),e+1,t),n=We(r,!0,e+1)),n};N.toFixed=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?We(i):(De(e,0,tt),t===void 0?t=s.rounding:De(t,0,8),r=H(new s(i),e+X(i)+1,t),n=We(r.abs(),!1,e+X(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};N.toInteger=N.toint=function(){var e=this,t=e.constructor;return H(new t(e),X(e)+1,t.rounding)};N.toNumber=function(){return+this};N.toPower=N.pow=function(e){var t,n,r,i,s,o,u=this,a=u.constructor,c=12,f=+(e=new a(e));if(!e.s)return new a(fe);if(u=new a(u),!u.s){if(e.s<1)throw Error(ge+"Infinity");return u}if(u.eq(fe))return u;if(r=a.precision,e.eq(fe))return H(u,r);if(t=e.e,n=e.d.length-1,o=t>=n,s=u.s,o){if((n=f<0?-f:f)<=ur){for(i=new a(fe),t=Math.ceil(r/Y+4),V=!1;n%2&&(i=i.times(u),Un(i.d,t)),n=nt(n/2),n!==0;)u=u.times(u),Un(u.d,t);return V=!0,e.s<0?new a(fe).div(i):H(i,r)}}else if(s<0)throw Error(ge+"NaN");return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,u.s=1,V=!1,i=e.times(ht(u,r+c)),V=!0,i=lr(i),i.s=s,i};N.toPrecision=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?(n=X(i),r=We(i,n<=s.toExpNeg||n>=s.toExpPos)):(De(e,1,tt),t===void 0?t=s.rounding:De(t,0,8),i=H(new s(i),e,t),n=X(i),r=We(i,e<=n||n<=s.toExpNeg,e)),r};N.toSignificantDigits=N.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(De(e,1,tt),t===void 0?t=r.rounding:De(t,0,8)),H(new r(n),e,t)};N.toString=N.valueOf=N.val=N.toJSON=N[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=X(e),n=e.constructor;return We(e,t<=n.toExpNeg||t>=n.toExpPos)};function ar(e,t){var n,r,i,s,o,u,a,c,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),V?H(t,d):t;if(a=e.d,c=t.d,o=e.e,i=t.e,a=a.slice(),s=o-i,s){for(s<0?(r=a,s=-s,u=c.length):(r=c,i=o,u=a.length),o=Math.ceil(d/Y),u=o>u?o+1:u+1,s>u&&(s=u,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(u=a.length,s=c.length,u-s<0&&(s=u,r=c,c=a,a=r),n=0;s;)n=(a[--s]=a[s]+c[s]+n)/ne|0,a[s]%=ne;for(n&&(a.unshift(n),++i),u=a.length;a[--u]==0;)a.pop();return t.d=a,t.e=i,V?H(t,d):t}function De(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ge+e)}function ye(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)r=e[t]+"",n=Y-r.length,n&&(s+=Pe(n)),s+=r;o=e[t],r=o+"",n=Y-r.length,n&&(s+=Pe(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Me=function(){function e(r,i){var s,o=0,u=r.length;for(r=r.slice();u--;)s=r[u]*i+o,r[u]=s%ne|0,o=s/ne|0;return o&&r.unshift(o),r}function t(r,i,s,o){var u,a;if(s!=o)a=s>o?1:-1;else for(u=a=0;u<s;u++)if(r[u]!=i[u]){a=r[u]>i[u]?1:-1;break}return a}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*ne+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var u,a,c,f,d,y,m,R,p,l,h,w,A,$,P,x,k,C,z=r.constructor,M=r.s==i.s?1:-1,D=r.d,O=i.d;if(!r.s)return new z(r);if(!i.s)throw Error(ge+"Division by zero");for(a=r.e-i.e,k=O.length,P=D.length,m=new z(M),R=m.d=[],c=0;O[c]==(D[c]||0);)++c;if(O[c]>(D[c]||0)&&--a,s==null?w=s=z.precision:o?w=s+(X(r)-X(i))+1:w=s,w<0)return new z(0);if(w=w/Y+2|0,c=0,k==1)for(f=0,O=O[0],w++;(c<P||f)&&w--;c++)A=f*ne+(D[c]||0),R[c]=A/O|0,f=A%O|0;else{for(f=ne/(O[0]+1)|0,f>1&&(O=e(O,f),D=e(D,f),k=O.length,P=D.length),$=k,p=D.slice(0,k),l=p.length;l<k;)p[l++]=0;C=O.slice(),C.unshift(0),x=O[0],O[1]>=ne/2&&++x;do f=0,u=t(O,p,k,l),u<0?(h=p[0],k!=l&&(h=h*ne+(p[1]||0)),f=h/x|0,f>1?(f>=ne&&(f=ne-1),d=e(O,f),y=d.length,l=p.length,u=t(d,p,y,l),u==1&&(f--,n(d,k<y?C:O,y))):(f==0&&(u=f=1),d=O.slice()),y=d.length,y<l&&d.unshift(0),n(p,d,l),u==-1&&(l=p.length,u=t(O,p,k,l),u<1&&(f++,n(p,k<l?C:O,l))),l=p.length):u===0&&(f++,p=[0]),R[c++]=f,u&&p[0]?p[l++]=D[$]||0:(p=[D[$]],l=1);while(($++<P||p[0]!==void 0)&&w--)}return R[0]||R.shift(),m.e=a,H(m,o?s+X(m)+1:s)}}();function lr(e,t){var n,r,i,s,o,u,a=0,c=0,f=e.constructor,d=f.precision;if(X(e)>16)throw Error(vn+X(e));if(!e.s)return new f(fe);for(V=!1,u=d,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),c+=5;for(r=Math.log(He(2,c))/Math.LN10*2+5|0,u+=r,n=i=s=new f(fe),f.precision=u;;){if(i=H(i.times(e),u),n=n.times(++a),o=s.plus(Me(i,n,u)),ye(o.d).slice(0,u)===ye(s.d).slice(0,u)){for(;c--;)s=H(s.times(s),u);return f.precision=d,t==null?(V=!0,H(s,d)):s}s=o}}function X(e){for(var t=e.e*Y,n=e.d[0];n>=10;n/=10)t++;return t}function Zt(e,t,n){if(t>e.LN10.sd())throw V=!0,n&&(e.precision=n),Error(ge+"LN10 precision limit exceeded");return H(new e(e.LN10),t)}function Pe(e){for(var t="";e--;)t+="0";return t}function ht(e,t){var n,r,i,s,o,u,a,c,f,d=1,y=10,m=e,R=m.d,p=m.constructor,l=p.precision;if(m.s<1)throw Error(ge+(m.s?"NaN":"-Infinity"));if(m.eq(fe))return new p(0);if(t==null?(V=!1,c=l):c=t,m.eq(10))return t==null&&(V=!0),Zt(p,c);if(c+=y,p.precision=c,n=ye(R),r=n.charAt(0),s=X(m),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(e),n=ye(m.d),r=n.charAt(0),d++;s=X(m),r>1?(m=new p("0."+n),s++):m=new p(r+"."+n.slice(1))}else return a=Zt(p,c+2,l).times(s+""),m=ht(new p(r+"."+n.slice(1)),c-y).plus(a),p.precision=l,t==null?(V=!0,H(m,l)):m;for(u=o=m=Me(m.minus(fe),m.plus(fe),c),f=H(m.times(m),c),i=3;;){if(o=H(o.times(f),c),a=u.plus(Me(o,new p(i),c)),ye(a.d).slice(0,c)===ye(u.d).slice(0,c))return u=u.times(2),s!==0&&(u=u.plus(Zt(p,c+2,l).times(s+""))),u=Me(u,new p(d),c),p.precision=l,t==null?(V=!0,H(u,l)):u;u=a,i+=2}}function Fn(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(r,i),t){if(i-=r,n=n-r-1,e.e=nt(n/Y),e.d=[],r=(n+1)%Y,n<0&&(r+=Y),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=Y;r<i;)e.d.push(+t.slice(r,r+=Y));t=t.slice(r),r=Y-t.length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),V&&(e.e>Lt||e.e<-Lt))throw Error(vn+n)}else e.s=0,e.e=0,e.d=[0];return e}function H(e,t,n){var r,i,s,o,u,a,c,f,d=e.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(r=t-o,r<0)r+=Y,i=t,c=d[f=0];else{if(f=Math.ceil((r+1)/Y),s=d.length,f>=s)return e;for(c=s=d[f],o=1;s>=10;s/=10)o++;r%=Y,i=r-Y+o}if(n!==void 0&&(s=He(10,o-i-1),u=c/s%10|0,a=t<0||d[f+1]!==void 0||c%s,a=n<4?(u||a)&&(n==0||n==(e.s<0?3:2)):u>5||u==5&&(n==4||a||n==6&&(r>0?i>0?c/He(10,o-i):0:d[f-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return a?(s=X(e),d.length=1,t=t-s-1,d[0]=He(10,(Y-t%Y)%Y),e.e=nt(-t/Y)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=f,s=1,f--):(d.length=f+1,s=He(10,Y-r),d[f]=i>0?(c/He(10,o-i)%He(10,i)|0)*s:0),a)for(;;)if(f==0){(d[0]+=s)==ne&&(d[0]=1,++e.e);break}else{if(d[f]+=s,d[f]!=ne)break;d[f--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(V&&(e.e>Lt||e.e<-Lt))throw Error(vn+X(e));return e}function cr(e,t){var n,r,i,s,o,u,a,c,f,d,y=e.constructor,m=y.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new y(e),V?H(t,m):t;if(a=e.d,d=t.d,r=t.e,c=e.e,a=a.slice(),o=c-r,o){for(f=o<0,f?(n=a,o=-o,u=d.length):(n=d,r=c,u=a.length),i=Math.max(Math.ceil(m/Y),u)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=a.length,u=d.length,f=i<u,f&&(u=i),i=0;i<u;i++)if(a[i]!=d[i]){f=a[i]<d[i];break}o=0}for(f&&(n=a,a=d,d=n,t.s=-t.s),u=a.length,i=d.length-u;i>0;--i)a[u++]=0;for(i=d.length;i>o;){if(a[--i]<d[i]){for(s=i;s&&a[--s]===0;)a[s]=ne-1;--a[s],a[i]+=ne}a[i]-=d[i]}for(;a[--u]===0;)a.pop();for(;a[0]===0;a.shift())--r;return a[0]?(t.d=a,t.e=r,V?H(t,m):t):new y(0)}function We(e,t,n){var r,i=X(e),s=ye(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Pe(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Pe(-i-1)+s,n&&(r=n-o)>0&&(s+=Pe(r))):i>=o?(s+=Pe(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+Pe(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=Pe(r))),e.s<0?"-"+s:s}function Un(e,t){if(e.length>t)return e.length=t,!0}function fr(e){var t,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ge+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Fn(o,s.toString())}else if(typeof s!="string")throw Error(Ge+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,Ni.test(s))Fn(o,s);else throw Error(Ge+s)}if(i.prototype=N,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=fr,i.config=i.set=Di,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Di(e){if(!e||typeof e!="object")throw Error(ge+"Object expected");var t,n,r,i=["precision",1,tt,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((r=e[n=i[t]])!==void 0)if(nt(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(Ge+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ge+n+": "+r);return this}var En=fr(yi);fe=new En(1);const Ne=En,Z={of(e){return new Ne(e)},sum(...e){let t=new Ne(0);for(const n of e)t=t.plus(n);return t},toFormat(e,t,n,r){const i=e.toFixed(t,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[u,a]=i.split("."),c=[];for(let f=u.length;f>0;f-=s)c.unshift(u.slice(Math.max(0,f-s),f));return c.join(o)+(a?`.${a}`:"")},round(e,t,n){return Z.of(e).toDecimalPlaces(t,n).toNumber()}};function _i(e){switch(e){case B.Equal:return"==";case B.NotEqual:return"!=";case B.Lte:return"<=";case B.Gte:return">=";case B.LogicalAnd:return"&&";case B.LogicalOr:return"||";case B.Power:return"**";case B.Nullish:return"??";case B.Group:return"()";default:return String.fromCharCode(e)}}function pe(e){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(e)}function at(e){return e==null}const rt=new Map;function bi(e,t){const n=rt.get(e);if(n==null)throw new Error(`不支持的函数：${e}`);return n(...t)}function hr(){return new Error("Unexpected end of input")}function te(e){return new Error(`Unexpected end of input at position ${e.start}, near \`${_i(e.value)}\``)}function Ai(e,t,n){switch(e.value){case B.Plus:{if(e.left==null||e.right==null)throw te(e);return typeof t=="string"||typeof n=="string"?t+n:pe(t)&&pe(n)?Z.of(t).plus(n).toNumber():Number.NaN}case B.Minus:{if(e.left==null&&e.right==null)throw te(e);return e.left==null&&e.right?-n:pe(t)&&pe(n)?Z.of(t).minus(n).toNumber():Number.NaN}case B.Asterisk:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).times(n).toNumber():Number.NaN}case B.Slash:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).div(n).toNumber():Number.NaN}case B.Percent:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).mod(n).toNumber():Number.NaN}case B.Power:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).pow(n).toNumber():Number.NaN}case B.Equal:{if(e.left==null||e.right==null)throw te(e);return at(t)&&at(n)?!0:t===n}case B.NotEqual:{if(e.left==null||e.right==null)throw te(e);return at(t)&&at(n)?!1:t!==n}case B.Lt:{if(e.left==null||e.right==null)throw te(e);return t<n}case B.Lte:{if(e.left==null||e.right==null)throw te(e);return t<=n}case B.Gt:{if(e.left==null||e.right==null)throw te(e);return t>n}case B.Gte:{if(e.left==null||e.right==null)throw te(e);return t>=n}case B.LogicalAnd:{if(e.left==null||e.right==null)throw te(e);return t&&n}case B.LogicalOr:{if(e.left==null||e.right==null)throw te(e);return t||n}case B.LogicalNot:{if(e.right==null)throw te(e);return!n}case B.Nullish:{if(e.left==null||e.right==null)throw te(e);return at(t)?n:t}default:throw te(e)}}function Si(e,t){const r=(e.children??[]).map(i=>{if(i!=null)return Oe(i,t)});return bi(e.value,r)}function Ti(e,t){var n;return t==null||typeof t!="object"?null:(n=t.data)==null?void 0:n[e.value]}function Ri(e,t){var n;return t==null||typeof t!="object"?null:(n=t.scope)==null?void 0:n[e.value]}function Oi(e,t){if(e.left==null||e.right==null||e.condition==null)throw hr();return Oe(e.condition,t)?(e.result=Oe(e.left,t),e.result):(e.result=Oe(e.right,t),e.result)}function Oe(e,t){switch(e.type){case Ee.NULL:return null;case Ee.UNDEFINED:return;case Ee.NUMBER:return Number(e.value);case Ee.STRING:return String(e.value);case Ee.TEMPLATE:{const r=(Array.isArray(e.value)?e.value:[e.value]).map(i=>Oe(i,t));return e.result=r.join(""),e.result}case Ee.BOOLEAN:return!!e.value;case Ee.VARIABLE:return e.result=Ti(e,t),e.result;case Ee.REFERENCE:return e.result=Ri(e,t),e.result;case Ee.FUNCTION:return e.result=Si(e,t),e.result;case Ee.OPERATOR:{if(e.isQuestion)return Oi(e,t);if(e.isGroup){if(e.right==null)throw te(e);return e.result=Oe(e.right,t),e.result}const n=e.left?Oe(e.left,t):null,r=e.right?Oe(e.right,t):null;return e.result=Ai(e,n,r),e.result}default:throw hr()}}function Mi(e,t){return Oe(e,t??{})}const dr="Resolve Element Value Pending Error",pr="ElementValueError";function q(e){const t=Object.create(null);return t.state=le.DONE,t.raw=e,t}function Xe(){const e=Object.create(null);return e.state=le.PENDING,e}function Ft(){const e=new Error(dr);return e.name=pr,e}function Ii(e){return e instanceof Error&&e.name===pr&&e.message===dr}function Li(e,t){const n=typeof t=="string"?mn(t)?Qe(t):null:t;if(n==null)return q();switch(n.value){case Et.CURRENT_DATE:return q(Date.now());case Et.PAGE_NUMBER:{const r=e.doc;return r==null?q():r.isPaged?q(e.pageNum):Xe()}case Et.PAGE_TOTAL:{const r=e.doc;return r==null?q():r.isPaged?q(r.pages.length):Xe()}case Et.ROW_INDEX:{const r=e.doc;if(r==null)return q();if(r.isPaged){if(e.type!==se.TABLE_CELL)return q();const i=e.parent;return i==null?q():q(i.rowIndex)}return Xe()}default:return q()}}function Ci(e,t){const n=typeof t=="string"?mn(t)?Qe(t):null:t;if(n==null)return q();switch(n.value){case Cr.ELEMENT_VALUR:return e.isProcessValueDone?q(e.getRawValue()):Xe();default:return q()}}function Pi(e,t,n){const r=typeof t=="string"?Qe(t):t,i=e.parent;if(i==null||!i.isBindVariable)return q(ct(n,r.value));const s=Qe(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?q():q(ct(i.rowData,r.value)):q(ct(n,r.value))}async function xi(e,t){const n=e.define;if(n.ds==null)return q();const r=n.ds,i=r.value;return et(i)?q():r.type===wt.TEMPLATE?ki(e,i):r.type===wt.VARIABLE?wn(e,i,t):r.type===wt.FORMULA?mr(e,i,t):r.type===wt.CODE?$i(e,i):q(r.value)}function wn(e,t,n,r=!1){const i=Qe(t);switch(i.varType){case zt.DS:return e.type===se.TABLE_CELL?Pi(e,i,n):e.type===se.TABLE_ROW?q(e.rowData):q(ct(n,r?i.path:i.value));case zt.BUILTIN:return Li(e,i);case zt.SPECIAL:return Ci(e,i);default:return q()}}function ki(e,t){return console.log("TODO: template:"+t),q()}function mr(e,t,n){try{const r=Pr.compile(t),i={data:{},scope:{}};for(const o of r.variable){const u=wn(e,o.value,n);if(u.state===le.PENDING)return Xe();Reflect.set(i.data,o.value,u.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{value:o.value,element:e});const s=Mi(r.root,i);return q(s)}catch(r){return Ii(r)?Xe():(console.log(r),q())}}async function $i(e,t){try{const r=new Function("element",`return (${t})(element)`)(e);if(r instanceof Promise){const i=await r;return q(i)}return q(r)}catch(n){return console.log(n),q()}}function Bn(){const e=document.createElement("span"),t="important";return e.style.visibility="hidden",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.zIndex="-1",e.style.setProperty("line-height","1",t),e.style.setProperty("font-family","宋体",t),e.style.setProperty("padding","0",t),e.textContent="水",e}function qi(){const e=Bn();e.style.fontSize="6px",document.body.appendChild(e);const t=Bn();t.style.fontSize="12px",document.body.appendChild(t);const n=e.clientHeight<t.clientHeight;return document.body.removeChild(e),document.body.removeChild(t),n}let gr=function(){const e=qi();return gr=function(){return e},e};const Hi=/Chrome/.test(navigator.userAgent);function yn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var we={},Yn;function vr(){if(Yn)return we;Yn=1;var e=/^([+-])?0*(\d+)(\.(\d+))?$/,t=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=we.e2ten=function(i){var s=t.exec(i.toString());if(!s)return i;var o=s[2],u=s[4]||"",a=s[5]?+s[5]:0;if(a>0){var c=u.substr(0,a);c=c.length<a?c+new Array(a-c.length+1).join("0"):c,u=u.substr(a),o+=c}else{a=-a;var f=o.length-a;f=f<0?0:f;var d=o.substr(f,a);d=d.length<a?new Array(a-d.length+1).join("0")+d:d,o=o.substring(0,f),u=d+u}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(u?"."+u:"")};we.getNumbResult=function(i){var s=e.exec(i.toString());if(!s&&t.test(i.toString())&&(s=e.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},we.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var u=[].slice.call(arguments,2);u.unshift(s),i.apply(null,u)}return s};var r=we.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return we.extend=function(i){for(var s,o=arguments[0]||{},u=Array.prototype.slice.call(arguments,1),a=0;a<u.length;a++){var c=u[a];for(s in c)r(c,s)&&(o[s]=c[s])}return o},we.getDigit=function(i){return i>=5?(i-4)*4+4:i},we.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},we.clearZero=function(i,s,o){if(i==null)return"";var u=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,a=new RegExp("^"+u+"+"),c=new RegExp(u+"+$"),f=new RegExp(u+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(a,"")),(!o||o=="$")&&(i=i.replace(c,"")),(!o||o=="nto1")&&(i=i.replace(f,s)),i},we}var Xt,Vn;function Fi(){if(Vn)return Xt;Vn=1;var e=vr();function t(i,s){var o=e.getNumbResult(i);if(!o)return i;s=s||{};var u=this.ch,a=this.ch_u,c=this.ch_f||"",f=this.ch_d||".",d=u.charAt(0),y=o.int,m=o.decimal,R=o.minus,p="",l="",h=R?c:"",w=function k(C,z,M){C=e.getNumbResult(C).int;var D="",O=arguments.length>1?arguments[1]:s.tenMin,J=C.length;if(J==1)return u.charAt(+C);if(J<=4)for(var b=0,E=J;E--;){var g=+C.charAt(b);D+=O&&J==2&&b==0&&g==1?"":u.charAt(g),D+=g&&E?a.charAt(E):"",b++}else{for(var _=C.length/4>>0,v=C.length%4;v==0||!a.charAt(3+_);)v+=4,_--;var S=C.substr(0,v),T=C.substr(v);D=k(S,O)+a.charAt(3+_)+(T.charAt(0)=="0"?d:"")+k(T,T.length>4?O:!1)}return D=e.clearZero(D,d),D};if(m){m=e.clearZero(m,"0","$");for(var A=0;A<m.length;A++)l+=u.charAt(+m.charAt(A));l=l?f+l:""}if(p=w(y),s.ww&&a.length>5){var $=a.charAt(4),P=a.charAt(5),x=p.lastIndexOf(P);~x&&(p=p.substring(0,x).replace(new RegExp(P,"g"),$+$)+p.substring(x))}return h+p+l}function n(i,s){i=i.toString();var o=i.split(this.ch_d),u=o[0].replace(this.ch_f,""),a=o[1],c=!!~o[0].indexOf(this.ch_f),f=this.ch_u.charAt(1),d=this.ch_u.charAt(4),y=this.ch_u.charAt(5);u=u.replace(new RegExp(d+"{2}(?!"+d+")","g"),y);for(var m=u.split(""),R=0,p=0,l=[],h=[],w=[],A=0;A<m.length;A++){var $=m[A],P=0,x=0;if(~(P=this.ch.indexOf($)))P>0&&w.unshift(P);else if(~(x=this.ch_u.indexOf($))){var k=e.getDigit(x);R>x?(e.unshiftZero(w,k),e.centerArray(h,w)):x>=p?(A==0&&(w=[1]),e.centerArray(l,h,w),l.length>0&&e.unshiftZero(l,k),p=x):(w.length==0&&f==$&&(w=[1]),e.centerArray(h,w),e.unshiftZero(h,e.getDigit(x)),R=x)}}e.centerArray(l,h,w).reverse(),l.length==0&&l.push(0);var C=0;if(a){l.push("."),C="0.";for(var A=0;A<a.length;A++)C+=this.ch.indexOf(a.charAt(A)),l.push(this.ch.indexOf(a.charAt(A)));C=+C}return c&&l.unshift("-"),s&&s.outputString?l.join(""):parseFloat(l.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},u=e.getNumbResult(i),a=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!u)return i;s=e.extend(o,s);var c=u.int,f=u.decimal||"",d=s.outSymbol?this.m_t:"",y=u.minus?this.ch_f:"",m="";if(s.complete){for(var R=1;R<this.m_u.length;R++)m+=t.call(this,f.charAt(R-1)||"0")+this.m_u.charAt(R);y+=t.call(this,c,s)+this.m_u.charAt(0)}else{var p=s.unOmitYuan||c!=="0";if(f=f.substr(0,this.m_u.length-1),f=e.clearZero(f,"0","$"),f)for(var l,R=0;R<this.m_u.length-1;R++)f.charAt(R)&&f.charAt(R)!="0"&&(m+=t.call(this,f.charAt(R))+this.m_u.charAt(R+1),l=!1),f.charAt(R)==="0"&&!l&&((R!=0||c!=="0")&&(m+=a),l=!0);(p||!m)&&(y+=t.call(this,c,s)+this.m_u.charAt(0)),s.forceZheng?(m==""||m.charAt(m.length-1)!==this.m_u[2])&&(m+=this.m_z):y+=u.decimal?"":this.m_z,s.forceZheng}return d+y+m}return Xt={CL:t,unCL:n,toMoney:r},Xt}var Jt,Gn;function Ui(){if(Gn)return Jt;Gn=1;var e=Fi(),t=vr();function n(r,i){return{encodeS:function(s,o){return o=t.extend({ww:!0,tenMin:!0},o),e.CL.call(r,s,o)},encodeB:function(s,o){return o=t.extend({ww:!0},o),e.CL.call(i,s,o)},decodeS:function(){return e.unCL.apply(r,arguments)},decodeB:function(){return e.unCL.apply(i,arguments)},toMoney:function(s,o){return o=t.extend({ww:!0},o),e.toMoney.call(i,s,o)}}}return Jt=n,Jt}var Kt,zn;function Bi(){return zn||(zn=1,Kt={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),Kt}var Qt,Wn;function Yi(){return Wn||(Wn=1,Qt={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),Qt}var en,jn;function Vi(){if(jn)return en;jn=1;var e=Ui(),t={s:Bi(),b:Yi()};return en=e(t.s,t.b),en}var Gi=Vi();const zi=yn(Gi);var St={exports:{}},Wi=St.exports,Zn;function ji(){return Zn||(Zn=1,function(e,t){(function(n,r){e.exports=r()})(Wi,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",u="minute",a="hour",c="day",f="week",d="month",y="quarter",m="year",R="date",p="Invalid Date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(b){var E=["th","st","nd","rd"],g=b%100;return"["+b+(E[(g-20)%10]||E[g]||E[0])+"]"}},A=function(b,E,g){var _=String(b);return!_||_.length>=E?b:""+Array(E+1-_.length).join(g)+b},$={s:A,z:function(b){var E=-b.utcOffset(),g=Math.abs(E),_=Math.floor(g/60),v=g%60;return(E<=0?"+":"-")+A(_,2,"0")+":"+A(v,2,"0")},m:function b(E,g){if(E.date()<g.date())return-b(g,E);var _=12*(g.year()-E.year())+(g.month()-E.month()),v=E.clone().add(_,d),S=g-v<0,T=E.clone().add(_+(S?-1:1),d);return+(-(_+(g-v)/(S?v-T:T-v))||0)},a:function(b){return b<0?Math.ceil(b)||0:Math.floor(b)},p:function(b){return{M:d,y:m,w:f,d:c,D:R,h:a,m:u,s:o,ms:s,Q:y}[b]||String(b||"").toLowerCase().replace(/s$/,"")},u:function(b){return b===void 0}},P="en",x={};x[P]=w;var k="$isDayjsObject",C=function(b){return b instanceof O||!(!b||!b[k])},z=function b(E,g,_){var v;if(!E)return P;if(typeof E=="string"){var S=E.toLowerCase();x[S]&&(v=S),g&&(x[S]=g,v=S);var T=E.split("-");if(!v&&T.length>1)return b(T[0])}else{var L=E.name;x[L]=E,v=L}return!_&&v&&(P=v),v||!_&&P},M=function(b,E){if(C(b))return b.clone();var g=typeof E=="object"?E:{};return g.date=b,g.args=arguments,new O(g)},D=$;D.l=z,D.i=C,D.w=function(b,E){return M(b,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var O=function(){function b(g){this.$L=z(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[k]=!0}var E=b.prototype;return E.parse=function(g){this.$d=function(_){var v=_.date,S=_.utc;if(v===null)return new Date(NaN);if(D.u(v))return new Date;if(v instanceof Date)return new Date(v);if(typeof v=="string"&&!/Z$/i.test(v)){var T=v.match(l);if(T){var L=T[2]-1||0,U=(T[7]||"0").substring(0,3);return S?new Date(Date.UTC(T[1],L,T[3]||1,T[4]||0,T[5]||0,T[6]||0,U)):new Date(T[1],L,T[3]||1,T[4]||0,T[5]||0,T[6]||0,U)}}return new Date(v)}(g),this.init()},E.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},E.$utils=function(){return D},E.isValid=function(){return this.$d.toString()!==p},E.isSame=function(g,_){var v=M(g);return this.startOf(_)<=v&&v<=this.endOf(_)},E.isAfter=function(g,_){return M(g)<this.startOf(_)},E.isBefore=function(g,_){return this.endOf(_)<M(g)},E.$g=function(g,_,v){return D.u(g)?this[_]:this.set(v,g)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(g,_){var v=this,S=!!D.u(_)||_,T=D.p(g),L=function(ve,re){var he=D.w(v.$u?Date.UTC(v.$y,re,ve):new Date(v.$y,re,ve),v);return S?he:he.endOf(c)},U=function(ve,re){return D.w(v.toDate()[ve].apply(v.toDate("s"),(S?[0,0,0,0]:[23,59,59,999]).slice(re)),v)},G=this.$W,ee=this.$M,oe=this.$D,Le="set"+(this.$u?"UTC":"");switch(T){case m:return S?L(1,0):L(31,11);case d:return S?L(1,ee):L(0,ee+1);case f:var _e=this.$locale().weekStart||0,qe=(G<_e?G+7:G)-_e;return L(S?oe-qe:oe+(6-qe),ee);case c:case R:return U(Le+"Hours",0);case a:return U(Le+"Minutes",1);case u:return U(Le+"Seconds",2);case o:return U(Le+"Milliseconds",3);default:return this.clone()}},E.endOf=function(g){return this.startOf(g,!1)},E.$set=function(g,_){var v,S=D.p(g),T="set"+(this.$u?"UTC":""),L=(v={},v[c]=T+"Date",v[R]=T+"Date",v[d]=T+"Month",v[m]=T+"FullYear",v[a]=T+"Hours",v[u]=T+"Minutes",v[o]=T+"Seconds",v[s]=T+"Milliseconds",v)[S],U=S===c?this.$D+(_-this.$W):_;if(S===d||S===m){var G=this.clone().set(R,1);G.$d[L](U),G.init(),this.$d=G.set(R,Math.min(this.$D,G.daysInMonth())).$d}else L&&this.$d[L](U);return this.init(),this},E.set=function(g,_){return this.clone().$set(g,_)},E.get=function(g){return this[D.p(g)]()},E.add=function(g,_){var v,S=this;g=Number(g);var T=D.p(_),L=function(ee){var oe=M(S);return D.w(oe.date(oe.date()+Math.round(ee*g)),S)};if(T===d)return this.set(d,this.$M+g);if(T===m)return this.set(m,this.$y+g);if(T===c)return L(1);if(T===f)return L(7);var U=(v={},v[u]=r,v[a]=i,v[o]=n,v)[T]||1,G=this.$d.getTime()+g*U;return D.w(G,this)},E.subtract=function(g,_){return this.add(-1*g,_)},E.format=function(g){var _=this,v=this.$locale();if(!this.isValid())return v.invalidDate||p;var S=g||"YYYY-MM-DDTHH:mm:ssZ",T=D.z(this),L=this.$H,U=this.$m,G=this.$M,ee=v.weekdays,oe=v.months,Le=v.meridiem,_e=function(re,he,be,Ce){return re&&(re[he]||re(_,S))||be[he].slice(0,Ce)},qe=function(re){return D.s(L%12||12,re,"0")},ve=Le||function(re,he,be){var Ce=re<12?"AM":"PM";return be?Ce.toLowerCase():Ce};return S.replace(h,function(re,he){return he||function(be){switch(be){case"YY":return String(_.$y).slice(-2);case"YYYY":return D.s(_.$y,4,"0");case"M":return G+1;case"MM":return D.s(G+1,2,"0");case"MMM":return _e(v.monthsShort,G,oe,3);case"MMMM":return _e(oe,G);case"D":return _.$D;case"DD":return D.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return _e(v.weekdaysMin,_.$W,ee,2);case"ddd":return _e(v.weekdaysShort,_.$W,ee,3);case"dddd":return ee[_.$W];case"H":return String(L);case"HH":return D.s(L,2,"0");case"h":return qe(1);case"hh":return qe(2);case"a":return ve(L,U,!0);case"A":return ve(L,U,!1);case"m":return String(U);case"mm":return D.s(U,2,"0");case"s":return String(_.$s);case"ss":return D.s(_.$s,2,"0");case"SSS":return D.s(_.$ms,3,"0");case"Z":return T}return null}(re)||T.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(g,_,v){var S,T=this,L=D.p(_),U=M(g),G=(U.utcOffset()-this.utcOffset())*r,ee=this-U,oe=function(){return D.m(T,U)};switch(L){case m:S=oe()/12;break;case d:S=oe();break;case y:S=oe()/3;break;case f:S=(ee-G)/6048e5;break;case c:S=(ee-G)/864e5;break;case a:S=ee/i;break;case u:S=ee/r;break;case o:S=ee/n;break;default:S=ee}return v?S:D.a(S)},E.daysInMonth=function(){return this.endOf(d).$D},E.$locale=function(){return x[this.$L]},E.locale=function(g,_){if(!g)return this.$L;var v=this.clone(),S=z(g,_,!0);return S&&(v.$L=S),v},E.clone=function(){return D.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},b}(),J=O.prototype;return M.prototype=J,[["$ms",s],["$s",o],["$m",u],["$H",a],["$W",c],["$M",d],["$y",m],["$D",R]].forEach(function(b){J[b[1]]=function(E){return this.$g(E,b[0],b[1])}}),M.extend=function(b,E){return b.$i||(b(E,O,M),b.$i=!0),M},M.locale=z,M.isDayjs=C,M.unix=function(b){return M(1e3*b)},M.en=x[P],M.Ls=x,M.p={},M})}(St)),St.exports}var Zi=ji();const Ie=yn(Zi);var Tt={exports:{}},Xi=Tt.exports,Xn;function Ji(){return Xn||(Xn=1,function(e,t){(function(n,r){e.exports=r()})(Xi,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,u=/\d*[^-_:/,()\s\d]+/,a={},c=function(l){return(l=+l)+(l>68?1900:2e3)},f=function(l){return function(h){this[l]=+h}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(l){(this.zone||(this.zone={})).offset=function(h){if(!h||h==="Z")return 0;var w=h.match(/([+-]|\d\d)/g),A=60*w[1]+(+w[2]||0);return A===0?0:w[0]==="+"?-A:A}(l)}],y=function(l){var h=a[l];return h&&(h.indexOf?h:h.s.concat(h.f))},m=function(l,h){var w,A=a.meridiem;if(A){for(var $=1;$<=24;$+=1)if(l.indexOf(A($,0,h))>-1){w=$>12;break}}else w=l===(h?"pm":"PM");return w},R={A:[u,function(l){this.afternoon=m(l,!1)}],a:[u,function(l){this.afternoon=m(l,!0)}],Q:[i,function(l){this.month=3*(l-1)+1}],S:[i,function(l){this.milliseconds=100*+l}],SS:[s,function(l){this.milliseconds=10*+l}],SSS:[/\d{3}/,function(l){this.milliseconds=+l}],s:[o,f("seconds")],ss:[o,f("seconds")],m:[o,f("minutes")],mm:[o,f("minutes")],H:[o,f("hours")],h:[o,f("hours")],HH:[o,f("hours")],hh:[o,f("hours")],D:[o,f("day")],DD:[s,f("day")],Do:[u,function(l){var h=a.ordinal,w=l.match(/\d+/);if(this.day=w[0],h)for(var A=1;A<=31;A+=1)h(A).replace(/\[|\]/g,"")===l&&(this.day=A)}],w:[o,f("week")],ww:[s,f("week")],M:[o,f("month")],MM:[s,f("month")],MMM:[u,function(l){var h=y("months"),w=(y("monthsShort")||h.map(function(A){return A.slice(0,3)})).indexOf(l)+1;if(w<1)throw new Error;this.month=w%12||w}],MMMM:[u,function(l){var h=y("months").indexOf(l)+1;if(h<1)throw new Error;this.month=h%12||h}],Y:[/[+-]?\d+/,f("year")],YY:[s,function(l){this.year=c(l)}],YYYY:[/\d{4}/,f("year")],Z:d,ZZ:d};function p(l){var h,w;h=l,w=a&&a.formats;for(var A=(l=h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(M,D,O){var J=O&&O.toUpperCase();return D||w[O]||n[O]||w[J].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(b,E,g){return E||g.slice(1)})})).match(r),$=A.length,P=0;P<$;P+=1){var x=A[P],k=R[x],C=k&&k[0],z=k&&k[1];A[P]=z?{regex:C,parser:z}:x.replace(/^\[|\]$/g,"")}return function(M){for(var D={},O=0,J=0;O<$;O+=1){var b=A[O];if(typeof b=="string")J+=b.length;else{var E=b.regex,g=b.parser,_=M.slice(J),v=E.exec(_)[0];g.call(D,v),M=M.replace(v,"")}}return function(S){var T=S.afternoon;if(T!==void 0){var L=S.hours;T?L<12&&(S.hours+=12):L===12&&(S.hours=0),delete S.afternoon}}(D),D}}return function(l,h,w){w.p.customParseFormat=!0,l&&l.parseTwoDigitYear&&(c=l.parseTwoDigitYear);var A=h.prototype,$=A.parse;A.parse=function(P){var x=P.date,k=P.utc,C=P.args;this.$u=k;var z=C[1];if(typeof z=="string"){var M=C[2]===!0,D=C[3]===!0,O=M||D,J=C[2];D&&(J=C[2]),a=this.$locale(),!M&&J&&(a=w.Ls[J]),this.$d=function(_,v,S,T){try{if(["x","X"].indexOf(v)>-1)return new Date((v==="X"?1e3:1)*_);var L=p(v)(_),U=L.year,G=L.month,ee=L.day,oe=L.hours,Le=L.minutes,_e=L.seconds,qe=L.milliseconds,ve=L.zone,re=L.week,he=new Date,be=ee||(U||G?1:he.getDate()),Ce=U||he.getFullYear(),gt=0;U&&!G||(gt=G>0?G-1:he.getMonth());var vt,Ut=oe||0,Bt=Le||0,Yt=_e||0,Vt=qe||0;return ve?new Date(Date.UTC(Ce,gt,be,Ut,Bt,Yt,Vt+60*ve.offset*1e3)):S?new Date(Date.UTC(Ce,gt,be,Ut,Bt,Yt,Vt)):(vt=new Date(Ce,gt,be,Ut,Bt,Yt,Vt),re&&(vt=T(vt).week(re).toDate()),vt)}catch{return new Date("")}}(x,z,k,w),this.init(),J&&J!==!0&&(this.$L=this.locale(J).$L),O&&x!=this.format(z)&&(this.$d=new Date("")),a={}}else if(z instanceof Array)for(var b=z.length,E=1;E<=b;E+=1){C[1]=z[E-1];var g=w.apply(this,C);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}E===b&&(this.$d=new Date(""))}else $.call(this,P)}}})}(Tt)),Tt.exports}var Ki=Ji();const Qi=yn(Ki);Ie.extend(Qi);function es(e){switch(e){case Wt.FLOOR:return Ne.ROUND_FLOOR;case Wt.CEIL:return Ne.ROUND_CEIL;case Wt.BANKER_ROUND:return Ne.ROUND_HALF_EVEN;default:return Ne.ROUND_HALF_UP}}function ts(e,t){if(e==null)return"";const n=t.format,r=es(t.round),i=t.showZero===!1;switch(n){case ot.FIXED:{const s=t.precision;if(s==null||s<0)return e.toString();const o=typeof e=="number"?Z.of(e):e;return o.eq(0)&&i?"":o.toFixed(s,r)}case ot.THOUSAND:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":Z.toFormat(s,2,r,{groupSize:3})}case ot.TEN_THOUSAND:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":Z.toFormat(s,2,r,{groupSize:4})}case ot.DAXIE:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":zi.toMoney(s.toFixed(2,r),{outSymbol:!1})}case ot.PERCENTAGE:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":s.times(100).toFixed(2,Ne.ROUND_HALF_UP)+"%"}default:return typeof e=="number"?e==0&&i?"":e.toString():e.eq(0)&&i?"":e.toString()}}function ns(e,t){const n=t.format;return n==null?e:Ie(e).format(n)}function rs(e,t){const n=e.attributes;switch(e.display){case se.NUMBER:return ts(t,n);case se.DATE:return ns(t,n);default:return t}}const Jn=Object.create(null);var $t,Je;const ft=class ft{constructor(t){de(this,$t,dn(pn.PRINT_ELEMENT));de(this,Je,Object.create(null));I(this,"define");I(this,"children",[]);I(this,"atomized",!1);I(this,"extra",!1);I(this,"parent");I(this,"offsetTop",0);I(this,"offsetLeft",0);I(this,"offsetWidth",0);I(this,"offsetHeight",0);I(this,"element");I(this,"zIndex");I(this,"state",un.CREATED);I(this,"visibility",Se.PENDING);I(this,"value",{state:le.UNDEFINED});this.define=t,this.offsetTop=t.offsetTop,this.offsetLeft=t.offsetLeft,this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.zIndex=t.zIndex,Ye(this,"parent",null),Ye(this,"element",null)}static register(t,n){Jn[t]=n}static create(t){const n=Jn[t.type]??ft;return new n(t)}static isPrintElement(t){return t instanceof ft}get id(){return"@"+F(this,$t)}get type(){return this.define.type}get page(){let t=this.parent;for(;t;){if(t instanceof It)return t;t=t.parent}return null}get doc(){var t;return(t=this.page)==null?void 0:t.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const t=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return t+n}get pageNum(){var t;return((t=this.page)==null?void 0:t.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const t=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${t}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===_t.AUTO}get isOverflowScale(){return this.define.attributes.overflow===_t.SCALE}get isOverflowHidden(){const t=this.define.attributes.overflow;return t==null||t===_t.HIDDEN}get isProcessValueDone(){return this.value.state===le.DONE}get isUndefinedValue(){return this.value.state===le.UNDEFINED}get isHidden(){return this.visibility===Se.HIDDEN}async processValue(){var t,n,r;if(!this.isProcessValueDone)switch(this.value=await xi(this,(t=this.doc)==null?void 0:t.data),this.value.state){case le.DONE:(n=this.doc)==null||n.removeDependency(this);break;case le.PENDING:(r=this.doc)==null||r.addDependency(this,{state:le.PENDING});break}}getRawValue(){if(this.value.state===le.DONE)return this.value.raw}format(){return rs(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(t=>t.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const t=this.content;return xr(t)?null:Q("div",{class:"quickprint-content",children:Q("span",{children:this.content})})}async updateElement(){const t=this.parent;if(t==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await t.replaceChild(this,n)}async mountChild(t){var n;return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),await ze(),await t.mount(t.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(t,n){var r;return this.element==null||t.element==null?!1:(n==null?this.element.removeChild(t.element):this.element.replaceChild(n,t.element),await ze(),await t.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(t){t!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.state=un.MOUNDTED,this.element=t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),F(this,Je)[t.id]=t}clone(){const t=ft.create(this.define),n=this.children.map(r=>r.clone());return t.appendMany(n),t}checkOverflow(){if(this.element==null)return!1;const t=this.element.querySelector(".quickprint-content");if(t==null)return!1;const n=t.parentElement;return n==null?!1:n.offsetHeight<t.offsetHeight}processOverflow(){return this.isOverflowScale?gr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const t=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return t==null||(t.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(t){const n=F(this,Je)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}findElementFromDefine(t){return this.children.find(n=>n.define.id===t)}createElements(){it(this,Je,this.children.reduce((t,n)=>(t[n.id]=n,t),Object.create(null)))}checkVisibility(){var i,s,o;const t=this.define;if(t.visibility==null||t.visibility.type===In.VISIBLE)return Se.VISIBLE;if(t.visibility.type===In.HIDDEN)return Se.HIDDEN;const n=t.visibility.condition;if(et(n))return Se.VISIBLE;const r=mr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case le.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Se.VISIBLE:Se.HIDDEN;case le.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:le.PENDING}),Se.PENDING;default:return Se.PENDING}}};$t=new WeakMap,Je=new WeakMap;let W=ft;function yt(e,t){return t.exclude==null?!0:!t.exclude.includes(e)}function mt(e){var s;const t={};if(!Hi)return t;const n=e.define,r=n.style.fontFamily;return(r==null||r===rn.SONG)&&((s=n.style)==null?void 0:s.fontWeight)===700&&(t["quickprint-patch-song-blod"]=!0),t}function Er(e,t){const n=[];if(t&&t!=rn.DEFAULT&&n.push(`"${t}"`),e&&e!==rn.DEFAULT&&n.push(`"${e}"`),n.length!=0)return n.join(",")}function is(e){if(e.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:e.underlineStyle,textDecorationColor:e.underlineColor}}function ss(e){if(e==null)return{};const t=e.style??{},n={};return t.textAlign&&(n.textAlign=t.textAlign),t.textAlignLast&&(n.textAlignLast=t.textAlignLast),n}function os(e){if(e==null)return{};const t=e.style??{};return t.verticalAlign==Ln.MIDDLE||t.verticalAlign==null?{display:"flex",alignItems:"center"}:t.verticalAlign==Ln.BOTTOM?{display:"flex",alignItems:"end"}:{}}function us(e){if(e==null)return{};const t=e.style??{};if(t.padding==null)return{};const n={};return t.padding.top&&(n.paddingTop=t.padding.top),t.padding.right&&(n.paddingRight=t.padding.right),t.padding.bottom&&(n.paddingBottom=t.padding.bottom),t.padding.left&&(n.paddingLeft=t.padding.left),n}function cn(e){if(e==null)return{};const t=e.style??{};if(t.border==null||t.border===Ae.NONE)return{};const n={},r=t.borderWidth??1,i=t.borderStyle??kr.SOLID,s=t.borderColor??$r.BLACK;if(t.border==Ae.ALL||t.border&Ae.TOP){const o=t.borderTopWidth??r,u=t.borderTopStyle??i,a=t.borderTopColor??s;n.borderTop=`${o}px ${u} ${a}`}if(t.border==Ae.ALL||t.border&Ae.RIGHT){const o=t.borderRightWidth??r,u=t.borderRightStyle??i,a=t.borderRightColor??s;n.borderRight=`${o}px ${u} ${a}`}if(t.border==Ae.ALL||t.border&Ae.BOTTOM){const o=t.borderBottomWidth??r,u=t.borderBottomStyle??i,a=t.borderBottomColor??s;n.borderBottom=`${o}px ${u} ${a}`}if(t.border==Ae.ALL||t.border&Ae.LEFT){const o=t.borderLeftWidth??r,u=t.borderLeftStyle??i,a=t.borderLeftColor??s;n.borderLeft=`${o}px ${u} ${a}`}return n}function Nn(e,t={}){const n={},r=e.define.style??{},i=Er(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=is(r);return s&&lt(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),r.padding&&lt(n,us(e.define)),lt(n,ss(e.define)),lt(n,os(e.define)),n}function Dn(e,t={}){const n={};if(yt("top",t)&&(n.top=e.offsetTop+"px"),yt("left",t)&&(n.left=e.offsetLeft+"px"),yt("width",t)&&(n.width=e.offsetWidth+"px"),yt("height",t)){const r=e.define.attributes.overflow===_t.AUTO?"min-height":"height";n[r]=e.offsetHeight+"px"}return e.zIndex&&(n.zIndex=e.zIndex),n}function _n(e,t={}){return gn(Dn(e,t),Nn(e,t),cn(e.define))}class as extends W{get style(){return _n(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class ls extends W{get style(){return Dn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...mt(this)}}processConstNode(t){var i;const n=t.dataset.value;if(et(n))return;const r=wn(this,n,(i=this.doc)==null?void 0:i.data);t.textContent=r.raw}process(t){for(const n of Array.from(t.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return t}render(){if(this.isHidden)return null;const t=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=t,Q("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class cs extends W{get style(){return _n(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class fs extends W{get style(){return _n(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class wr extends W{constructor(){super(...arguments);I(this,"rendering",0)}get style(){return{...gn(Dn(this),Nn(this)),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>Q("col",{width:s}));return Q("div",{id:this.id,class:this.className,style:this.style,children:Q("table",{children:[Q("colgroup",{children:i}),Q("tbody",{})]})})}async mountChild(n){var i;if(n.element==null)return!1;const r=this.getTableBody();return r==null?!1:(r.appendChild(n.element),await ze(),await n.mount(n.element),this.offsetHeight=((i=this.element)==null?void 0:i.offsetHeight)??0,!0)}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await ze(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n),i=this.getTableBody();if(this.children.length=n,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class hs extends W{constructor(){super(...arguments);I(this,"repeatIndex",-1);I(this,"rowData");I(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return Q("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=un.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}}class bn extends W{get style(){var r;const t=cn((r=this.define.parent)==null?void 0:r.parent),n=cn(this.define);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-height":this.offsetHeight+"px",...lt(t,n)}}get className(){const t=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(t==null?void 0:t.isOverflowAuto)===!0,"quickprint-fixed-height":(t==null?void 0:t.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}get isCollapsed(){return this.define.attributes.colspan===0||this.define.attributes.rowspan===0}createContentStyle(){const t=[];let n=this;for(;W.isPrintElement(n);)t.unshift(Nn(n)),n=n.parent;return gn({},...t)}render(){if(this.isCollapsed)return null;const n=this.define.attributes,r=this.isHidden?null:Q("div",{class:"quickprint-layout",style:this.createContentStyle(),children:this.createContent()});return Q("td",{id:this.id,class:this.className,style:this.style,rowspan:n.rowspan,colspan:n.colspan,children:r})}}W.register(se.TEXT,as);W.register(se.PARAGRAPH,ls);W.register(se.NUMBER,cs);W.register(se.DATE,fs);W.register(se.TABLE,wr);W.register(se.TABLE_ROW,hs);W.register(se.TABLE_CELL,bn);function ds(e){return Number(e)}function ps(e){return Math.abs(e)}function ms(e){return Math.trunc(e)}function gs(...e){return Math.min(...e)}function vs(...e){return Math.max(...e)}function Es(e,t){return Z.round(e,t??0,Ne.ROUND_CEIL)}function ws(e,t){return Z.round(e,t??0,Ne.ROUND_FLOOR)}function ys(e,t,n){return Z.round(e,t??0,n??Ne.ROUND_HALF_UP)}function Ns(e){e.set("NUMBER",ds),e.set("ABS",ps),e.set("TRUNC",ms),e.set("MIN",gs),e.set("MAX",vs),e.set("CEIL",Es),e.set("FLOOR",ws),e.set("ROUND",ys)}function Ds(e){return String(e)}function _s(e){return String(e).length}function bs(e){return String(e).toLowerCase()}function As(e){return String(e).toUpperCase()}function Ss(e){const t=String(e);return t[0].toUpperCase()+t.slice(1)}function Ts(e){return String(e).trim()}function Rs(e,t,n){return String(e).replace(t,n)}function Os(e,t,n){return String(e).replaceAll(t,n)}function Ms(e,t,n){return String(e).slice(t,n)}function Is(e,t,n){return String(e).includes(String(t),n)}function Ls(e,t,n){return String(e).indexOf(String(t),n)}function Cs(e,t,n){return String(e).lastIndexOf(String(t),n)}function Ps(e,t,n){return String(e).startsWith(String(t),n)}function xs(e,t,n){return String(e).endsWith(String(t),n)}function ks(e){e.set("STRING",Ds),e.set("LENGTH",_s),e.set("LOWER",bs),e.set("UPPER",As),e.set("TRIM",Ts),e.set("UPPER_FIRST",Ss),e.set("REPLACE",Rs),e.set("REPLACE_ALL",Os),e.set("SLICE",Ms),e.set("INCLUDES",Is),e.set("INDEX_OF",Ls),e.set("LAST_INDEX_OF",Cs),e.set("STARTS_WITH",Ps),e.set("ENDS_WITH",xs)}function $s(e,t,n){return e?t:n}function qs(e,t){return Number.isNaN(e)?t:e}function Hs(e,t){return Number.isNaN(e)||e==null?t:e}function Fs(e,...t){for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];if(i===e)return s}return t.length%2===0?void 0:t[t.length-1]}function yr(e){return Number.isNaN(e)}function Us(e){return Number.isInteger(e)}function Nr(e){return typeof e=="number"}function Dr(e){return typeof e=="string"}function Bs(e){return typeof e=="boolean"}function _r(e){return e===null}function br(e){return e===void 0}function Ar(e){return _r(e)||br(e)}function Ys(e){return Ar(e)?!0:Dr(e)?e.length==0:Nr(e)?!yr(e):!1}function Vs(e){e.set("IF",$s),e.set("IFNA",qs),e.set("IFERROR",Hs),e.set("IS_NAN",yr),e.set("IS_INTEGER",Us),e.set("IS_NUMBER",Nr),e.set("IS_STRING",Dr),e.set("IS_BOOLEAN",Bs),e.set("IS_NULL",_r),e.set("IS_UNDEFINED",br),e.set("IS_NULLISH",Ar),e.set("IS_EMPTY",Ys),e.set("SWITCH",Fs)}const Gs=[ue.YEAR_MONTH,ue.YEAR_MONTH_CHS,ue.YEAR_MONTH_DAY,ue.YEAR_MONTH_DAY_CHS,ue.DATETIME_SHORT,ue.DATETIME_SHORT_CHS,ue.DATETIME,ue.DATETIME_CHS,ue.TIME,ue.TIME_SHORT,ue.YEAR,ue.MONTH,ue.DAY];function ke(e){if(e!=null){if(typeof e=="number")return Gs[e];if(typeof e=="string")return e}}function Sr(e,t,n){return e===null&&(e=void 0),Ie(e,ke(n)).format(ke(t)??ue.DATETIME)}function zs(e){return Sr(void 0,e)}function Ws(e,t){return e===null&&(e=void 0),Ie(e,ke(t)).year()}function js(e,t){return e===null&&(e=void 0),Ie(e,ke(t)).month()+1}function Zs(e,t){return e===null&&(e=void 0),Ie(e,ke(t)).date()}function Xs(e,t){return e===null&&(e=void 0),Ie(e,ke(t)).hour()}function Js(e,t){return e===null&&(e=void 0),Ie(e,ke(t)).minute()}function Ks(e,t){return e===null&&(e=void 0),Ie(e,ke(t)).second()}function Qs(e){e.set("DATE",Sr),e.set("NOW",zs),e.set("YEAR",Ws),e.set("MONTH",js),e.set("DAY",Zs),e.set("HOUR",Xs),e.set("MINUTE",Js),e.set("SECOND",Ks)}function Tr(e,t){return e.children.reduce((n,r)=>{const i=r.findElementFromDefine(t);if(i==null)return n;if(!i.isProcessValueDone)throw Ft();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(qr(o)?o:0),n},[])}function An(e,t){var r;const n=(r=e.parent)==null?void 0:r.parent;if(!(n==null||n.type!==se.TABLE))return Tr(n,t)}function Sn(e,t){var i,s;const n=(i=e.parent)==null?void 0:i.parent;if(n==null||n.type!==se.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,u)=>o.concat(u.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,u)=>o.concat(Tr(u,t)),[])}function eo(e,t){if(!e.doc.isPaged)throw Ft();const r=e.page,i=r.pageNum<r.pageTotal?An(e,t):Sn(e,t);return i==null||i.length==0?0:Z.sum(...i).toNumber()}function to(e,t){const n=e.element,r=e.value;if(!(n instanceof bn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();if(t===2)return eo(n,r);const s=t==1?An(n,r):Sn(n,r);return s==null||s.length==0?0:Z.sum(...s).toNumber()}function no(e,t){const n=e.element,r=e.value;if(!(n instanceof bn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();const s=t==1?An(n,r):Sn(n,r);return s==null||s.length==0?0:Z.sum(...s).div(s.length).toNumber()}function ro(e){e.set("COL_SUM",to),e.set("COL_AVG",no)}Ns(rt);ks(rt);Vs(rt);Qs(rt);ro(rt);const io=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-line;min-width:100%}.quickprint-content>span{background-color:var(--quickprint-variable-highlight-color, transparent)}",so="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song-blod{text-shadow:0 0 currentColor,0 0 currentColor}}";function Kn(){return io}function oo(){return so}var qt,Ke,dt,Fe,Ue,Be,$e,fn,hn;const Rn=class Rn{constructor(t,n){de(this,$e);de(this,qt,dn(pn.PRINT_DOCUMENT));de(this,Ke);de(this,dt);de(this,Fe,Object.create(null));de(this,Ue,0);I(this,"define");I(this,"data");I(this,"state");I(this,"pages",[]);I(this,"element");I(this,"rendering");I(this,"renderState",ce.CREATED);I(this,"devicePixelRatio",window.devicePixelRatio);de(this,Be,[]);const{promise:r,resolve:i}=Promise.withResolvers();it(this,dt,r),it(this,Ke,i),this.define=t,this.state=n,Ye(this,"element",null),Ye(this,"rendering",0),this.state.renderState=ce.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(t,n={}){const r=t instanceof sn?t:sn.create(t);return new Rn(r,n)}get id(){return"@"+F(this,qt)}get style(){const t=this.state.scale??100,n=this.define.style;return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":t/100,"--quickprint-paper-width":this.define.paper.width+"mm","--quickprint-paper-height":`calc(${this.define.paper.height}mm - 1px)`,fontFamily:Er(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get isPaged(){return this.renderState===ce.PAGED||this.renderState===ce.READY}get isFirstRount(){return F(this,Ue)===0}onCreated(){return Promise.allSettled(this.pages.map(t=>t.onCreated()))}onBeforeUnmount(t){F(this,Be).indexOf(t)>=0||F(this,Be).push(t)}unmount(){for(const t of F(this,Be))typeof t=="function"&&t();F(this,Be).length=0,this.renderState=ce.UNMOUNT,this.element=null}render(){return Q("div",{class:Te.DOCUMENT,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(t){return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),!0)}async mount(){this.state.total=this.pages.length;const t=this.pages.map(n=>n.onFinshed());await Promise.allSettled(t),st(this,$e,hn).call(this,ce.PAGED),await st(this,$e,fn).call(this),st(this,$e,hn).call(this,ce.READY),typeof F(this,Ke)=="function"&&(F(this,Ke).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(t){this.pages.push(t),t.setParent(this)}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}insert(t,n){this.pages.splice(n,0,t),t.setParent(this)}ready(){return F(this,dt)}injectElementStyle(){const t=document.createElement("style");t.textContent=Kn(),document.head.appendChild(t)}async print(){return await this.ready(),new Promise(t=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),t()})})}genPapeStyle(){const t=this.define;return`@page{ size: ${t.paper.width}mm ${t.paper.height}mm }`}genPrintHtml(){var r;const t=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${t}</title>`,`<style>${Kn()}</style>`,`<style>${oo()}</style>`,`<style>${this.genPapeStyle()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const t=this.state.scale??100,n=ut.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=ut[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const t=this.state.scale??100,n=ut.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n>=ut.length-1)return!1;const r=ut[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const t=100;this.state.scale=t,this.element.style.setProperty("--quickprint-doc-scale",`${t/100}`)}addDependency(t,n){F(this,Fe)[t.id]={element:t,...n}}removeDependency(t){delete F(this,Fe)[t.id]}watchDevicePixelRatio(){const t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);t.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{t.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}toggleDebug(){this.state.debug=this.state.debug!==!0,this.element!=null&&this.element.classList.toggle("quickprint-document-debug")}findElement(t){for(const n of this.pages){const r=n.findElement(t);if(r)return r}}};qt=new WeakMap,Ke=new WeakMap,dt=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,Be=new WeakMap,$e=new WeakSet,fn=async function(){for(const n of Object.values(F(this,Fe))){const r=n.element;await r.processValue(),r.isProcessValueDone&&(this.removeDependency(r),await r.updateElement())}if(Object.keys(F(this,Fe)).length==0){Hr.debug("Document",`已完成第计算, 共${F(this,Ue)+1}轮`);return}Mn(this,Ue)._++,!(F(this,Ue)>=100)&&await st(this,$e,fn).call(this)},hn=function(t){this.renderState=t,this.state.renderState=t};let Ct=Rn;function Pt(e){const t=W.create(e),n=e.children.map(r=>W.create(r));return t.appendMany(n),t}async function uo(e,t={}){const n=e.define.pages.map(c=>r(c));e.data=t,e.appendMany(n),await e.onCreated(),e.renderState=ce.RENDERING,e.state.renderState=ce.RENDERING;function r(c){const f=It.create(c,e.define.paper);i(f);for(const d of f.defines){const y=o(d);y.define.isFixed?f.appendToFixed(y):f.append(y)}return s(f),f.state=bt.INIT,f}function i(c){if(!(c.header.display!=!0||c.header.defines.length==0))for(const f of c.header.defines)c.appendToHeader(o(f))}function s(c){if(!(c.footer.display!=!0||c.footer.defines.length==0))for(const f of c.footer.defines)c.appendToFooter(o(f))}function o(c){switch(c.type){case"Table":return u(c);default:return W.create(c)}}function u(c){const f=W.create(c),d=c.children;for(const y of d){if(y.isRepeat){f.appendMany(a(y));continue}f.append(Pt(y))}return f}function a(c){const f=Qe(c.ds.value),d=ct(t,f.value);return Fr(d).map((y,m)=>{const R=Pt(c);return R.repeatIndex=m,R.rowData=y,R})}return e}function ao(e,t,n){let r=null,i=1;async function s(){const l=t.rendering,h=t.pages[l];return h==null?t.mount():(h.beginPaging(),h.createElement()==null?(t.rendering+=1,s()):(await t.mountChild(h),await u(h),await a(h),h.fid!==r&&(i=1),h.pageNum=i++,await h.onPaged(),t.rendering+=1,t.state.total=t.pages.length,s()))}function o(l,h){const w=l.children[l.rendering-1];return w==null?l.extra?l.header.offsetHeight+4:h.offsetTop:!w.isChanged||nn.isIsolated(w.define,h.define)?h.offsetTop:w.offsetBottom+h.define.top-w.define.top-w.define.height}async function u(l){const h=l.children[l.rendering];return h==null?void 0:(h.offsetTop=o(l,h),h.createElement()==null?(l.rendering+=1,u(l)):(await c(l,h),l.rendering+=1,u(l)))}async function a(l){for(const h of l.fixed)h.createElement(),await l.mountChild(h)}function c(l,h){switch(h.define.type){case se.TABLE:return m(l,h);case se.TEXT:return R(l,h);default:return p(l,h)}}async function f(l,h){const w=h.children[h.rendering];if(w==null)return;if(w.extra&&w.isUndefinedValue&&await w.onCreated(),w.createElement()==null)return h.rendering+=1,f(l,h);await h.mountChild(w);const $=Ur.mm_to_px(l.paper.offsetHeight)-l.footer.offsetHeight;if(h.offsetBottom>$){const P=d(l,h,$),x=h.children.filter(k=>k.extra);return t.insert(P,l.index+1),await Promise.allSettled(x.map(k=>k.onCreated())),await P.onCreated(),f(l,h)}return h.rendering+=1,f(l,h)}function d(l,h,w){const A=h.define.footer.map(M=>{const D=Pt(M);return D.extra=!0,D}),$=w-A.reduce((M,D)=>M+D.offsetHeight,0),P=y(h,$),x=h.splitRows(P);h.appendMany(A),h.atomized=!0,h.rendering=P;const k=l.clone(),C=new wr(h.define),z=h.define.header.map(M=>Pt(M));C.extra=!0,C.appendMany(z),C.appendMany(x),k.append(C);for(let M=l.rendering+1,D=l.children.length;M<D;M++){const O=l.children[M];nn.isIsolated(O.define,h.define)||(k.append(O),Reflect.set(l.children,M,null))}return l.children=l.children.filter(M=>M!=null),k}function y(l,h){let w=l.offsetTop;for(let A=0;A<l.children.length;A++){if(w+=l.children[A].offsetHeight,w==h)return A;if(w>h)return A-1}return l.children.length-1}async function m(l,h){return await l.mountChild(h),f(l,h)}async function R(l,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),l.mountChild(h)}async function p(l,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),l.mountChild(h)}return async function(){hi(),await ze(),await uo(t,n);const l=t.createElement();return l&&e.appendChild(l),r=t.pages[0].fid,s()}}function lo(e){const t=Date.now(),n=Ct.create(e.define,e.state);return ao(e.container,n,e.data??{})().then(()=>{n.state.renderTime=Date.now()-t}),n}const co=pt({__name:"DocState",props:{state:{type:Object,required:!0}},setup(e){const t=e,n=Re(()=>t.state.renderState===ce.READY),r=Re(()=>t.state.renderState===ce.READY?"已就绪":t.state.renderState===ce.RENDERING?`正在生成(${t.state.total??0}页)...`:"正在生成...");return(i,s)=>(Ve(),Ze("div",null,[s[0]||(s[0]=ae("span",null,"文档：",-1)),ae("span",{class:ie({[i.classes.finished]:n.value})},Rt(r.value),3)]))}}),fo="_finished_7h37m_2",ho={finished:fo},po={classes:ho},mo=Ht(co,[["__cssModules",po]]),go="_toolbar_3etac_1",vo="_button_3etac_9",Eo="_actived_3etac_33",wo="_divider_3etac_46",je={toolbar:go,button:vo,actived:Eo,divider:wo},yo=["viewMode","debug","space","print"],No=pt({props:{doc:{type:Ct},buttons:{type:Array,required:!0}},setup(e){function t(){var a;(a=e.doc)==null||a.print()}function n(){var a;(a=e.doc)==null||a.toggleViewMode()}function r(){var c;const a={[je.button]:!0,[je.actived]:((c=e.doc)==null?void 0:c.state.viewMode)==="multiple"};return j("button",{type:"button",title:"切换单页/多页视图",class:a,onClick:n},[j(on,{icon:"icon-multi-page"},null),j("span",null,[Ot("多页")])])}function i(){return j("button",{type:"button",class:je.button,onClick:t,title:"打印 Ctrl + P"},[j(on,{icon:"icon-printer"},null),j("span",null,[Ot("打印")])])}function s(){return j("div",{class:je.divider},null)}function o(){return j("div",{class:"quickprint-is-fill-w"},null)}function u(a){if(typeof a=="function")return a(je,e.doc);switch(a){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return j("div",{class:je.toolbar},[e.buttons.map(u)])}}}),Do={key:1,class:"quickprint-is-fill-w"},_o=pt({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return yo}}},emits:["mock"],setup(e,{emit:t}){const n=e,r=rr("classes"),i=Mt(),s=Mt(),o=ir({}),u=Re(()=>o.renderState===ce.READY),a=Re(()=>{const p=o.renderTime??0;if(p<=6e4)return`${p/1e3}秒`;const l=Math.floor(p/1e3),h=l%60,w=(l-h)/60;return h==0?`${w}分`:`${w}分${h}秒`}),c=Re(()=>o.total??"--"),f=Re(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function d(){var p;(p=s.value)==null||p.zoomIn()}function y(){var p;(p=s.value)==null||p.zoomOut()}function m(p){var l,h;p.deltaY>0?(l=s.value)==null||l.zoomIn():(h=s.value)==null||h.zoomOut()}function R(){var p;(p=s.value)==null||p.toggleDebug()}return ei(()=>{const p=lo({container:i.value,define:sn.create(n.define),state:o,data:n.data});s.value=p,document.title=p?`${p.define.name} - OpenPrint`:"OpenPrint"}),(p,l)=>{var h;return Ve(),Ze("div",{class:ie(K(r).preview),onWheel:ni(m,["ctrl","prevent"])},[ae("div",{class:ie([K(Te).PRINT_HIDDEN,K(r).header])},[ae("div",{class:ie(K(r).headerLeft)},[kn(p.$slots,"headerLeft")],2),j(K(No),{doc:s.value,buttons:e.buttons},null,8,["doc","buttons"]),ae("div",{class:ie(K(r).headerRight)},[kn(p.$slots,"headerRight")],2)],2),ae("div",{class:ie(f.value),ref_key:"containerRef",ref:i},null,2),ae("div",{class:ie([K(Te).PRINT_HIDDEN,K(r).footer])},[j(mo,{state:o,class:ie(K(r).status)},null,8,["state","class"]),u.value?(Ve(),Ze(ti,{key:0},[ae("div",{class:ie(K(r).status)},"用时："+Rt(a.value),3),l[0]||(l[0]=ae("div",{class:"quickprint-is-fill-w"},null,-1)),ae("button",{type:"button",class:ie({"quickprint-text-btn":!0,"quickprint-is-selected":(h=s.value)==null?void 0:h.state.debug}),title:"调试模式",onClick:R},[j(K(on),{icon:"icon-bug"})],2),l[1]||(l[1]=ae("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ae("div",{class:ie(K(r).divider)},null,2),ae("div",{class:ie(K(r).status)},"第1页，共"+Rt(c.value)+"页",3),ae("div",{class:ie(K(r).divider)},null,2)],64)):(Ve(),Ze("div",Do)),j(K(Br),{class:ie(K(r).zoom),scale:o.scale,onZoomIn:d,onZoomOut:y},null,8,["class","scale"])],2)],34)}}}),bo="_preview_1hc69_2",Ao="_header_1hc69_13",So="_headerLeft_1hc69_22",To="_headerRight_1hc69_28",Ro="_body_1hc69_34",Oo="_footer_1hc69_53",Mo="_status_1hc69_73",Io="_divider_1hc69_79",Lo="_zoom_1hc69_86",Co={preview:bo,header:Ao,headerLeft:So,headerRight:To,body:Ro,footer:Oo,status:Mo,divider:Io,zoom:Lo},Po={classes:Co},xo=Ht(_o,[["__cssModules",Po]]),ko=pt({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(e){const t=e,n=rr("classes"),r=Yr(),i=nr(t.local??[]),s=ir(t.ds.fields.map(c=>a(c))),o=[{label:"文本",value:me.STRING},{label:"数字",value:me.NUMBER},{label:"日期",value:me.DATE},{label:"对象",value:me.OBJECT},{label:"数组",value:me.ARRAY}],u=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(c,f){var y;const d=c[f.name];return((y=o.find(m=>m.value===d))==null?void 0:y.label)??d}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(c,f){if(c.type===me.OBJECT)return null;if(c.type===me.ARRAY)return $n(j("input",{type:"number","onUpdate:modelValue":y=>c.total=y,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[ii,c.total]]);const d=t.options.find(y=>y.classify===c.type);return d==null?null:$n(j("select",{"onUpdate:modelValue":y=>c.func=y,class:n.select},[j("option",{value:"",class:n.placeholder},[Ot("请选择")]),d.rules.map(y=>j("option",{value:y.func,key:y.func},[y.name]))]),[[si,c.func]])}}];function a(c,f){const d=f?`${f}.${c.name}`:c.name,y=c.children?c.children.map(R=>a(R,c.name)):void 0,m=i[d];return{type:c.type,name:c.name,title:c.title,children:y,$expand:!0,func:(m==null?void 0:m.func)??"",total:m==null?void 0:m.total}}return r==null||r.useHandle("confirm",()=>ri(s)),(c,f)=>(Ve(),Ze("div",{class:ie(K(n).ds)},[j(K(Vr),{columns:u,data:s},null,8,["data"])],2))}}),$o="_ds_6a9ph_2",qo="_placeholder_6a9ph_8",Ho="_select_6a9ph_12",Fo="_input_6a9ph_13",Uo={ds:$o,placeholder:qo,select:Ho,input:Fo},Bo={classes:Uo},Yo=Ht(ko,[["__cssModules",Bo]]);let Nt=null;const Qn=490;function Rr(){return Nt!=null?Promise.resolve(Nt):Wr(()=>import("./mock-DPhFfl2S.js"),__vite__mapDeps([0,1,2,3])).then(e=>(Nt=e.default,Nt))}function er(e,t){switch(t){case me.DATE:return e.randDate();case me.NUMBER:return e.randDecimal();case me.STRING:return e.randName();default:return null}}function Vo(e){if((e==null?void 0:e.total)==null)return Qn;const t=Number(e.total);return Number.isNaN(t)||!Number.isFinite(t)||t<=0?Qn:Math.round(t)}function tn(e,t,n){if(n==null||et(n.func))return er(e,t.type);const r=e[n.func];return typeof r!="function"?er(e,t.type):r(n)}const Go=Gr(function(e,t,n){const r={ds:t,options:e.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:jr.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return Zr("创建模拟数据",oi(Yo,r),i).promisify()});async function tr(e,t){if(e==null)return[];const n=await Rr(),r=await Go(n,e,t).catch(zr);return Array.isArray(r)?r:[]}async function Dt(e,t){if(e==null||!Array.isArray(t)||t.length==0)return{};const n=await Rr(),r=nr(t);return e.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===me.OBJECT){const u=s.children??[];return i[s.name]=u.reduce((a,c)=>{if(et(c.name))return a;const f=`${s.name}.${c.name}`;return a[c.name]=tn(n,c,r[f]),a},{}),i}if(s.type===me.ARRAY){const u=s.children??[],a=Vo(o),c=10+Math.round(Math.random()*a);return i[s.name]=Array(c).fill("").map(()=>u.reduce((f,d)=>{if(et(d.name))return f;const y=`${s.name}.${d.name}`;return f[d.name]=tn(n,d,r[y]),f},{})),i}return i[s.name]=tn(n,s,o),i},{})}const zo=pt({__name:"index",setup(e){const t={INIT:0,LOADED_CASE:1,LOADED_DATA:2,READY:3},n=Mt(),r=Mt(),i=jt(0),s=jt(!1),o=Re(()=>{var l;return`${((l=n.value)==null?void 0:l.id)??Date.now()}-${i.value}`}),u=jt(t.INIT),a=Re(()=>["viewMode","debug","space",s.value?m:null,"print"]),c=Re(()=>u.value===t.INIT?"正在加载...":u.value===t.LOADED_CASE?"已加载模板，正在准备数据...":u.value===t.LOADED_DATA?"开始渲染模板":"");function f(){const l=new URLSearchParams(window.location.search).get("id");return mn(l)&&(l==="local"||xn.some(h=>h.id===l))?l:xn[0].id}async function d(p){var A,$,P,x;if(p==null)return{};if(p.data)return s.value=!1,p.data;const l=Cn(p.id);if(Array.isArray(l)&&l.length>0)return Dt((A=p.define)==null?void 0:A.ds,l);const h=p.rules;if(Array.isArray(h)&&h.length>0)return Dt(($=p.define)==null?void 0:$.ds,h);const w=await tr((P=n.value)==null?void 0:P.ds);return Pn(w,p.id),Dt((x=p.define)==null?void 0:x.ds,w)}async function y(){if(n.value==null)return;const p=n.value.id;if(p==null||p=="")return;const l=Cn(p),h=await tr(n.value.ds,l);Pn(h,n.value.id),r.value=await Dt(n.value.ds,h),i.value++}function m(p){return j("button",{type:"button",class:p.button,onClick:y},[j("span",null,[Ot("模拟数据")])])}async function R(){u.value=t.INIT,s.value=!0;const p=await Xr(f());n.value=(p==null?void 0:p.define)??{},u.value=t.LOADED_CASE,r.value=await d(p),u.value=t.LOADED_DATA,u.value=t.READY}return R(),(p,l)=>u.value<=t.LOADED_DATA?(Ve(),Ze("div",{key:0,class:ie(p.classes.logs)},Rt(c.value),3)):(Ve(),ui(K(xo),{define:n.value,data:r.value,buttons:a.value,key:o.value,class:ie(p.classes.preview),onMock:y},null,8,["define","data","buttons","class"]))}}),Wo="_preview_17t3s_7",jo="_logs_17t3s_11",Zo={preview:Wo,logs:jo},Xo={classes:Zo},Jo=Ht(zo,[["__cssModules",Xo]]),Tn=ai(Jo),Ko=Jr();Tn.use(Kr,{zIndex:Ko});Tn.mount("#app");Qr(Tn._context);
