const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-Dftd_N4J.js","assets/vue-C4hvfNT6.js","assets/component-L55ah7FP.css","assets/component-Zou40yy-.js","assets/utils-WQPqYUHs.js","assets/utils-CgjH-QUk.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Oo=Object.defineProperty;var cl=n=>{throw TypeError(n)};var Mo=(n,e,t)=>e in n?Oo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var F=(n,e,t)=>Mo(n,typeof e!="symbol"?e+"":e,t),In=(n,e,t)=>e.has(n)||cl("Cannot "+t);var ke=(n,e,t)=>(In(n,e,"read from private field"),t?t.call(n):e.get(n)),ze=(n,e,t)=>e.has(n)?cl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),ut=(n,e,t,l)=>(In(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),we=(n,e,t)=>(In(n,e,"access private method"),t);import{D as ye,E as yt,N as Gt,a as pt,b as X,c as qe,P as Hn,d as Xt,e as ul,f as dn,g as fn,O as jt,h as te,i as en,j as pn,L as Ne,I as $,_ as B,k as Al,s as vn,l as Po,m as ce,n as Vo,B as Q,o as Bo,S as Gn,p as Wn,F as se,V as Ye,q as Yn,r as me,t as Fo,u as Ke,U as On,v as Xn,w as Je,x as mn,y as Qe,A as Ve,z as jn,C as ql,G as Dl,H as $l,J as ve,K as Ol,T as zo,M as Be,Q as Et,R as Oe,W as Kt,X as et,Y as Uo,Z as Ho,$ as Go,a0 as Zn,a1 as Kn,a2 as Wo,a3 as on,a4 as wt,a5 as hn,a6 as ht,a7 as be,a8 as Yo,a9 as sn,aa as Ct,ab as gt,ac as tt,ad as Xo,ae as Tt,af as Nt,ag as jo,ah as Zo,ai as Ko,aj as Jo,ak as Qo,al as es,am as Re,an as Ce,ao as Mt,ap as dl,aq as ts,ar as fl,as as xn,at as An,au as ns,av as ls,aw as rn,ax as os,ay as ss,az as is,aA as rs,aB as pl,aC as as,aD as cs}from"./utils-WQPqYUHs.js";import{r as ie,o as Jn,d as O,c as R,a as S,n as g,b as f,e as p,f as Pe,u as xe,s as de,g as $e,h as L,w as ee,i as y,j as Z,k as U,T as Ml,l as K,m as St,p as Jt,q as Pl,F as j,t as re,v as W,x as Pt,y as ml,z as Vl,A as Bl,B as _e,C as Ie,D as oe,E as ge,G as Vt,H as us,I as Fl,J as Qt,K as Qn,L as qn,M as Ge,N as ot,O as ds,P as fs,Q as ps,R as ms}from"./vue-C4hvfNT6.js";const zl="@quickprint_drag_mode",Ul="@quickprint_drop_data",bn="@quickprint_operate",Xe="@quickprint_element",el="@quickprint_element_type",Hl="@quickprint_resize_flag",_t=160,yn=32,Ut=[50,75,100,125,150,200,300,400];var Wt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Wt||{}),Rt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Rt||{});const st={SINGLE:0,MULTIPLE:1},Le=Object.freeze({INSERT:0,MOVE:1}),tl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),G=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),pe=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Gl=[{label:"固定值",value:ye.CONST},{label:"变量",value:ye.VARIABLE},{label:"公式",value:ye.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:ye.CODE,detail:"使用Javascript代码生成数据"}],hs=[{label:"显示",value:yt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:yt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:yt.CONDITION,detail:"元素只在满足指定条件后显示"}],gs=[{label:"四舍五入",value:Gt.ROUND},{label:"向下舍入",value:Gt.FLOOR},{label:"向上舍入",value:Gt.CEIL},{label:"四舍六入",value:Gt.BANKER_ROUND}],vs=[{label:"原始值",value:pt.NONE},{label:"固定位数",value:pt.FIXED},{label:"金额千位",value:pt.THOUSAND},{label:"金额万位",value:pt.TEN_THOUSAND},{label:"金额大写",value:pt.DAXIE},{label:"百分比",value:pt.PERCENTAGE}],bs=[{label:"显示",value:!0},{label:"隐藏",value:!1}],ys=[{label:"默认",value:void 0},{label:"文本",value:X.TEXT},{label:"数字",value:X.NUMBER},{label:"日期",value:X.DATE}],ae={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Wl=[{label:"年-月",value:qe.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:qe.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:qe.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:qe.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:qe.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:qe.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:qe.TIME,detail:"示例：12:00:00"},{label:"时:分",value:qe.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:qe.YEAR,detail:"示例：2024"},{label:"月",value:qe.MONTH,detail:"示例：12"},{label:"日",value:qe.DAY,detail:"示例：01"}];Wl.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const _s=[{label:"元素值",value:Hn.ELEMENT_VALUR}],Es=[{label:"基于纸张",value:Xt.PAPER},{label:"基于内容",value:Xt.CONTENT}],Yl=[{label:"纵向",value:ul.PORTRAIT},{label:"横向",value:ul.LANDSCAPE}],Ts=[{label:"当前位置",value:dn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:dn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Ss=[{label:"单次打印",value:fn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:fn.EACH,detail:"元素将每页打印一次"}],ks=[{label:"按内容调整高度",value:jt.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:jt.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:jt.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Mn=[{label:"页码",value:en.PAGE_NUMBER,type:te.NUMBER},{label:"总页数",value:en.PAGE_TOTAL,type:te.NUMBER},{label:"行序号",value:en.ROW_INDEX,type:te.NUMBER},{label:"当前时间",value:en.CURRENT_DATE,type:te.DATE}],ws=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function Xl(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Cs(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function jl(n){return n.isSelected?n.type===X.PARAGRAPH?52:n.type===X.TABLE?32:20:20}function Rs(){const n=ie(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),Jn(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class Ls{constructor(e,t,l){F(this,"originalEvent");F(this,"target");F(this,"ghost");F(this,"container");F(this,"paths",[]);F(this,"dropTarget");F(this,"top",0);F(this,"left",0);F(this,"deltaX");F(this,"deltaY");F(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const s=t.getBoundingClientRect();this.deltaX=s.left-e.clientX,this.deltaY=s.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var qt,Dt,rt,Zl,Kl,Jl;const bt=class bt extends pn{constructor(t={}){var l,s,o;super();ze(this,rt);F(this,"context",null);F(this,"selector");F(this,"scale");F(this,"onDragStart");ze(this,qt);ze(this,Dt);this.selector={container:((l=t.selector)==null?void 0:l.container)??G.PAGE,element:((s=t.selector)==null?void 0:s.element)??G.DRAGGABLE,droppable:((o=t.selector)==null?void 0:o.droppable)??G.DROPPABLE},this.onDragStart=we(this,rt,Zl).bind(this),this.scale=t.scale,ut(this,qt,we(this,rt,Kl).bind(this)),ut(this,Dt,we(this,rt,Jl).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",ke(this,qt)),window.removeEventListener("pointerup",ke(this,Dt)),this.context=null)}};qt=new WeakMap,Dt=new WeakMap,rt=new WeakSet,Zl=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Ne.warn(bt.TAG_NAME,"未找到的可拖拽元素");const s=this.selector.container,o=Xl(l,s);this.context=new Ls(t,l,o);const a=this.createEvent("before-dragstart",this.context);if(this.dispatch(a).defaultPrevented)return Ne.warn(bt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Ne.warn(bt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const r=this.createEvent("dragstart",this.context);if(this.dispatch(r).defaultPrevented)return Ne.warn(bt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",ke(this,qt)),window.addEventListener("pointerup",ke(this,Dt))},Kl=function(t){const l=this.context;if(l==null)return;const s=l.container.getBoundingClientRect(),o=document.elementsFromPoint(t.clientX,t.clientY),a=Array.from(o).filter(i=>!(i===l.ghost||i===l.target||l.ghost.contains(i))),r=this.normalizeScale();l.originalEvent=t,l.paths=a,l.dropTarget=a.find(i=>i.matches("."+G.DROPPABLE)),l.top=(t.clientY+l.deltaY-s.top)/r,l.left=(t.clientX+l.deltaX-s.left)/r,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},Jl=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("dragend",l);this.dispatch(s).defaultPrevented||this.reset()},F(bt,"TAG_NAME","quickprint-draggable");let Pn=bt;const Ns=["title"],Is=O({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(S(),R("span",{title:n.title,class:g(e.classes.help)},[f("span",null,[Pe(e.$slots,"default")]),p($,{icon:"icon-question-circle"})],10,Ns))}}),xs="_help_1l6l8_2",As={help:xs},qs={classes:As},Ds=B(Is,[["__cssModules",qs]]),$s=O({__name:"Popover",props:{width:{type:Number,default:null}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,s=t,o=xe("classes"),a=ie(!1),r=de(),i=de(),u=$e({minWidth:0,top:0,left:0,visible:!1}),d=L(()=>({minWidth:l.width==null?u.minWidth+"px":l.width+"px",top:u.top+"px",left:u.left+"px",visibility:u.visible?"visible":"hidden",zIndex:Al()}));async function m(){if(a.value)return h();a.value=!0,s("show"),await vn(),k()}function h(){x(),a.value=!1,s("close")}function _(C){if(!(C.target instanceof Node))return;const T=r.value;if(T&&T.contains(C.target))return C.preventDefault();const E=i.value;if(E&&E.contains(C.target))return C.preventDefault();h()}function v(){const C=r.value,T=i.value;if(T==null||C==null)return;const E=C.getBoundingClientRect(),N=T.getBoundingClientRect(),w=l.width==null?E.width:l.width;let I=E.bottom+1;I+N.height>window.innerHeight&&E.top>N.height&&(I=E.top-N.height-1);let A=E.left;A+N.width>window.innerWidth&&(A=window.innerWidth-N.width-2),u.minWidth=w,u.top=I,u.left=A,u.visible=!0}function c(C){const T=C.target;if(!(T instanceof HTMLElement))return;const E=r.value;E==null||!T.contains(E)||h()}function b(C){if(C.key!=="Escape")return;const T=i.value;if(T!=null){const E=T.style.zIndex;if(Number(E)<Po())return}C.preventDefault(),h()}function k(){window.addEventListener("click",_,{capture:!0}),window.addEventListener("contextmenu",h,{capture:!0}),window.addEventListener("scroll",c,{capture:!0,passive:!0}),window.addEventListener("resize",v),window.addEventListener("keydown",b)}function x(){window.removeEventListener("click",_,!0),window.removeEventListener("contextmenu",h,!0),window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",v),window.removeEventListener("keydown",b)}return e({close:h}),(C,T)=>(S(),R("div",{class:g(y(o).reference),onClick:ee(m,["stop"]),ref_key:"referenceRef",ref:r,tabindex:"0"},[Pe(C.$slots,"default"),a.value?(S(),Z(Ml,{key:0,to:"body"},[f("div",{class:g(y(o).popover),onVnodeMounted:v,onMousedown:T[0]||(T[0]=ee(()=>{},["prevent"])),style:K(d.value),ref_key:"popoverRef",ref:i},[Pe(C.$slots,"popover")],38)])):U("",!0)],2))}}),Os="_reference_1arli_2",Ms="_popover_1arli_7",Ps={reference:Os,popover:Ms},Vs={classes:Ps},Ql=B($s,[["__cssModules",Vs]]),Bs=["title","onKeydown"],Fs=["onMouseover","onClick"],zs=O({__name:"Select",props:St({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:St(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,s=xe("classes"),o=de(),a=de(),r=Jt(n,"modelValue"),i=ie(),u=ie(!1),d=$e({width:0,top:0,left:0,visible:!1,scrollable:!1}),m=L(()=>l.teleport==="none"),h=L(()=>l.teleport=="none"?"body":l.teleport),_=L(()=>{const D={label:"",options:[]},V=[D];for(const H of l.options){if(Array.isArray(H.options)){V.push({label:H.label,options:H.options});continue}D.options.push(H)}return V}),v=L(()=>_.value.reduce((D,V)=>D.concat(V.options),[])),c=L(()=>{if(l.multiple!==!0){const V=Ln();return V?V.label:l.button?l.title:ce(l.modelValue)?l.placeholder:l.modelValue}const D=Nn();return D.length>0?D.map(V=>V.label).join(","):l.button?l.title:l.placeholder}),b=L(()=>l.clearable!==!0?!1:l.modelValue!=null),k=L(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[s.mini]:l.size==="mini",[s.select]:!0,[s.appearance]:l.appearance!=="none"&&!b.value,[s.button]:l.button,[s.showClearIcon]:b.value,[s.text]:l.size==="text"})),x=L(()=>({width:l.width})),C=L(()=>d.visible?{width:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",top:d.top+"px",left:d.left+"px",visibility:"visible",zIndex:Al()}:{minWidth:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",visibility:"hidden"}),T=L(()=>({[s.content]:!0,[s.placeholder]:Vo(l.modelValue)}));async function E(){if(l.disabled)return;const D=v.value;if(D.length===0)return;if(u.value)return N();const V=o.value;V!=null&&(d.width=V.getBoundingClientRect().width,d.visible=!1,i.value=D.find(H=>H.value===l.modelValue),u.value=!0,await vn(),Do())}function N(){$o(),u.value=!1}function w(D){z(),ct()}function I(D){D.disabled!==!0&&(i.value=D)}function A(D){if(l.disabled==!0||D.disabled===!0)return;if(l.multiple!==!0){r.value=D.value,t("select",D),N();return}const V=Array.isArray(r.value)?r.value:[],H=V.findIndex(fe=>fe===D.value);H>=0?V.splice(H,1):V.push(D.value),r.value=V,t("select",V)}function M(D){if(!(D.target instanceof Node))return;const V=o.value;if(V&&V.contains(D.target))return D.preventDefault();const H=a.value;if(H&&H.contains(D.target))return D.preventDefault();N()}async function z(){const D=o.value,V=a.value;if(V==null||D==null)return;await Pt();const H=D.getBoundingClientRect(),fe=V.getBoundingClientRect();let he=H.bottom+1;he+fe.height>window.innerHeight&&H.top>fe.height&&(he=H.top-fe.height-1);let kt=H.left;kt+fe.width>window.innerWidth&&(kt=window.innerWidth-fe.width-2),d.width=fe.width,d.top=he,d.left=kt,d.visible=!0;const zt=V.querySelector("."+s.list);d.scrollable=zt?zt.scrollHeight>zt.clientHeight:!1}function P(D){const V=D.target;if(!(V instanceof HTMLElement))return;const H=o.value;H==null||!V.contains(H)||N()}function ne(){const D=v.value,V=ml(i.value);if(V==null){i.value=Ft(0),ct();return}const H=D.indexOf(V);if(H==0)return ue();const fe=Ft(H-1);fe!=null&&(i.value=fe,ct())}function Y(){const D=v.value,V=ml(i.value);if(V==null){i.value=Se(0),ct();return}const H=D.indexOf(V);if(H>=D.length-1){q();return}const fe=Ft(H+1);fe!=null&&(i.value=fe,ct())}function q(){i.value=Se(0),ct()}function ue(){const D=v.value;i.value=Ft(D.length-1),ct()}function le(){r.value=void 0,N()}function Se(D){const H=v.value[D];return H==null?null:H.disabled===!0?Se(D+1):H}function Ft(D){const H=v.value[D];return H==null?null:H.disabled===!0?Ft(D-1):H}function al(D){switch(D.key){case"Enter":D.preventDefault(),i.value&&A(i.value);return;case"Escape":D.preventDefault(),N();return;case"ArrowUp":D.preventDefault(),ne();return;case"ArrowDown":D.preventDefault(),Y();return;case"Home":D.preventDefault(),q();return;case"End":D.preventDefault(),ue();return}}function Ao(D){if(l.disabled)return;const V=o.value;V!=null&&document.activeElement===V&&(u.value||(D.stopPropagation(),E()))}function qo(D){if(l.multiple!==!0)return l.modelValue===D.value;const V=l.modelValue;return Array.isArray(V)?V.includes(D.value):!1}async function ct(){if(i.value==null)return;await Pt();const D=a.value;if(D==null)return;const V=D.querySelector("."+s.hover);V&&V.scrollIntoView({block:"nearest"})}function Ln(){const D=v.value,V=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return D.find(H=>H.value===V)}function Nn(){const D=v.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(H=>H).map(H=>{const fe=D.find(he=>he.value===H);return fe||{value:H,label:H}})}function Do(){window.addEventListener("mousedown",M,{capture:!0}),window.addEventListener("pointerdown",M,{capture:!0}),window.addEventListener("contextmenu",N,{capture:!0}),window.addEventListener("scroll",P,{capture:!0,passive:!0}),window.addEventListener("resize",z),window.addEventListener("keydown",al)}function $o(){window.removeEventListener("mousedown",M,!0),window.removeEventListener("pointerdown",M,!0),window.removeEventListener("contextmenu",N,!0),window.removeEventListener("scroll",P,!0),window.removeEventListener("resize",z),window.removeEventListener("keydown",al)}return(D,V)=>{var H;return S(),R("div",{class:g(k.value),title:n.title,style:K(x.value),onClick:ee(E,["stop"]),onKeydown:Pl(ee(Ao,["prevent"]),["enter"]),ref_key:"selectRef",ref:o,tabindex:"0"},[D.$slots.selected?Pe(D.$slots,"selected",{key:0,option:Ln(),options:Nn()}):Pe(D.$slots,"option",{key:1,option:Ln(),options:Nn()},()=>[f("div",{class:g(T.value)},[f("span",null,W(c.value),1),b.value?(S(),Z($,{key:0,icon:"icon-close",onClick:ee(le,["stop"]),size:"12px",class:g(y(s).clearIcon)},null,8,["class"])):U("",!0)],2)]),u.value?(S(),Z(Ml,{key:2,to:h.value,disabled:m.value},[f("div",{class:g(y(s).popover),onClick:V[0]||(V[0]=ee(()=>{},["stop"])),onVnodeMounted:w,onMousedown:V[1]||(V[1]=ee(()=>{},["prevent"])),style:K(C.value),ref_key:"popoverRef",ref:a},[f("div",{class:g(y(s).list)},[(S(!0),R(j,null,re(_.value,fe=>(S(),R(j,null,[fe.label?(S(),R("div",{key:0,class:g(y(s).groupLabel)},W(fe.label),3)):U("",!0),(S(!0),R(j,null,re(fe.options,he=>{var kt;return S(),R("div",{key:he.value,class:g({[y(s).option]:!0,[y(s).disabled]:he.disabled===!0,[y(s).selected]:qo(he),[y(s).hover]:((kt=i.value)==null?void 0:kt.value)==he.value}),style:K(he.style),onMouseover:zt=>I(he),onClick:zt=>A(he)},[Pe(D.$slots,"option",{option:he},()=>[f("div",{class:g(y(s).label)},[he.icon?(S(),Z($,{key:0,icon:he.icon,class:g(y(s).icon)},null,8,["icon","class"])):U("",!0),f("span",null,W(he.label),1)],2),he.short?(S(),R("div",{key:0,class:g(y(s).short)},W(he.short),3)):U("",!0)])],46,Fs)}),128))],64))),256))],2),(H=i.value)!=null&&H.detail&&d.visible?(S(),R("div",{key:0,class:g(y(s).detail)},W(i.value.detail),3)):U("",!0)],38)],8,["to","disabled"])):U("",!0)],46,Bs)}}}),Us="_button_1h82x_2",Hs="_select_1h82x_7",Gs="_appearance_1h82x_16",Ws="_content_1h82x_31",Ys="_placeholder_1h82x_37",Xs="_popover_1h82x_41",js="_list_1h82x_51",Zs="_option_1h82x_80",Ks="_label_1h82x_95",Js="_icon_1h82x_100",Qs="_hover_1h82x_104",ei="_detail_1h82x_115",ti="_short_1h82x_125",ni="_selected_1h82x_131",li="_disabled_1h82x_135",oi="_showClearIcon_1h82x_140",si="_clearIcon_1h82x_144",ii="_text_1h82x_157",ri="_mini_1h82x_169",ai="_groupLabel_1h82x_181",ci={button:Us,select:Hs,appearance:Gs,content:Ws,placeholder:Ys,popover:Xs,list:js,option:Zs,label:Ks,icon:Js,hover:Qs,detail:ei,short:ti,selected:ni,disabled:li,showClearIcon:oi,clearIcon:si,text:ii,mini:ri,groupLabel:ai},ui={classes:ci},J=B(zs,[["__cssModules",ui]]),di="_tree_1p28f_1",fi="_node_1p28f_5",pi="_content_1p28f_11",mi="_space_1p28f_27",hi="_expand_1p28f_28",gi="_active_1p28f_47",vi="_children_1p28f_55",je={tree:di,node:fi,content:pi,space:mi,expand:hi,active:gi,children:vi},eo=Symbol(),to=O({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Vl(eo),l=L(()=>Array.isArray(n.node.children)&&n.node.children.length>0),s=L({get(){const c=t==null?void 0:t.state[n.node.value];return c==null?!1:c.expand},set(c){const b=t==null?void 0:t.state[n.node.value];b!=null&&(b.expand=c)}});function o(c){c.preventDefault(),s.value=!s.value}function a(){if(!l.value)return p("div",{class:je.space},null);const c={[je.expand]:!0,[je.active]:s.value};return p("div",{onMousedown:v,onClick:o,class:c},[p($,{icon:"icon-right",size:"12px"},null)])}function r(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function i(){return p("div",{class:je.content,onClick:d,onMouseenter:h},[r()])}function u(){if(!l.value||!s.value)return;const c=n.node.children.map(b=>p(to,{node:b,onNodeClick:m,onNodeHover:_},null));return p("div",{class:je.children},[c])}function d(){e("nodeClick",n.node)}function m(c){e("nodeClick",c)}function h(){e("nodeHover",n.node)}function _(c){e("nodeHover",c)}function v(c){c.preventDefault()}return function(){return p("div",{class:je.subTree},[p("div",{class:je.node},[a(),i()]),u()])}}}),bi=O({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=a();function s(i){t("nodeClick",i)}function o(i){t("nodeHover",i)}function a(){const i=$e({}),u=function(d,m){for(const h of d)m[h.value]={expand:h.expand!==!1},h.children&&u(h.children,m)};return u(n.data,i),i}function r(i){return typeof e.default=="function"?e.default(i):null}return Bl(eo,{state:l,content:r}),function(){const i=n.data.map(u=>p(to,{node:u,onNodeClick:s,onNodeHover:o},null));return p("div",{class:je.tree},[i])}}});function yi(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function _i(n,e=0){let t=0,l=null;return function(...s){const o=Date.now();if(o-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,s),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,s),t=o}}function nl(n,e){const t=[];if(e&&e!=se.DEFAULT&&t.push(`"${e}"`),n&&n!==se.DEFAULT&&t.push(`"${n}"`),t.length!=0)return t.join(",")}function no(n){if(n.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:n.underlineStyle,textDecorationColor:n.underlineColor}}function lo(n,e={}){const t={},l=n.style??{},s=nl(l.fontFamily,l.enFontFamily);s&&(t.fontFamily=s);const o=no(l);return o&&Ke(t,o),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),Ti("border",e)&&l.border&&Ke(t,Vn(n)),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.padding&&Ke(t,ki(n)),Ke(t,Si(n)),Ke(t,oo(l.verticalAlign)),t}function Ei(n,e={}){const t=[];let l=n;for(;me.isDefineElement(l);)t.unshift(lo(l,e)),l=l.parent;return Fo({},...t)}function Ti(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}function Si(n){if(n==null)return{};const e=n.style??{},t={};return e.textAlign&&(t.textAlign=e.textAlign),e.textAlignLast&&(t.textAlignLast=e.textAlignLast),t}function oo(n){return n==null||n==Ye.MIDDLE?{display:"flex",alignItems:"center"}:n==Ye.BOTTOM?{display:"flex",alignItems:"end"}:{}}function ki(n){if(n==null)return{};const e=n.style??{};if(e.padding==null)return{};const t={};return e.padding.top&&(t.paddingTop=e.padding.top),e.padding.right&&(t.paddingRight=e.padding.right),e.padding.bottom&&(t.paddingBottom=e.padding.bottom),e.padding.left&&(t.paddingLeft=e.padding.left),t}function Vn(n){if(n==null)return{};const e=n.style??{};if(e.border==null||e.border===Q.NONE)return{};const t={},l=e.borderWidth??1,s=e.borderStyle??Bo.SOLID,o=e.borderColor??Gn.BLACK;if(e.border==Q.ALL||e.border&Q.TOP){const a=e.borderTopWidth??l,r=e.borderTopStyle??s,i=e.borderTopColor??o;t.borderTop=`${a}px ${r} ${i}`}if(e.border==Q.ALL||e.border&Q.RIGHT){const a=e.borderRightWidth??l,r=e.borderRightStyle??s,i=e.borderRightColor??o;t.borderRight=`${a}px ${r} ${i}`}if(e.border==Q.ALL||e.border&Q.BOTTOM){const a=e.borderBottomWidth??l,r=e.borderBottomStyle??s,i=e.borderBottomColor??o;t.borderBottom=`${a}px ${r} ${i}`}if(e.border==Q.ALL||e.border&Q.LEFT){const a=e.borderLeftWidth??l,r=e.borderLeftStyle??s,i=e.borderLeftColor??o;t.borderLeft=`${a}px ${r} ${i}`}return t}const vt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(vt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(vt.SPACE).filter(s=>Wn(s));return t.indexOf(e)>=0?n:(t.push(e),t.join(vt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(vt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(vt.SPACE))}};function We(n){if(ce(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=Yn(t)?t:null,s=ce(e[2])?null:e[2];return{num:l,unit:s}}function hl(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=We(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return On.pt_to_px(e.num);case"mm":return On.mm_to_px(e.num);default:return null}}function ll(n,e){const t=n.ds;if(t!=null)return t.type===ye.FORMULA?{type:t.type,content:ol(t.value,n.doc)}:t.type===ye.VARIABLE?{type:t.type,content:it(t.value,e)}:{type:t.type,content:t.value}}function it(n,e){var h,_,v;if(ce(n))return n;const t=Xn(n),l=t.path;if(l==null||l=="")return;const s=l.split(".");if(s.length==0)return l;const o=s[0];if(t.varType===Je.BUILTIN)return((h=Mn.find(c=>c.value===o))==null?void 0:h.label)??o;if(t.varType===Je.SPECIAL)return((_=_s.find(c=>c.value===o))==null?void 0:_.label)??o;if(e==null)return l;const r=(e.fields??[]).find(c=>c.name===o);if(r==null)return l;const i=s[1],u=ce(r.title)?r.name:r.title;if(i==null)return u;const d=(v=r.children)==null?void 0:v.find(c=>c.name===i);if(d==null)return`${u}.${i}`;const m=ce(d.title)?d.name:d.title;return`${u}.${m}`}function ol(n,e){return ce(n)?void 0:mn.tokenize(n).map(s=>s.type===Qe.VARIABLE?`[${it(s.value,e==null?void 0:e.ds)}]`:s.type===Qe.REFERENCE?`[${so(s.value,e)}]`:s.type===Qe.TEMPLATE?(Array.isArray(s.value)?s.value:[s.value]).map(a=>a.type===Qe.VARIABLE?`[${it(a.value,e==null?void 0:e.ds)}]`:a.value).join(""):mn.formatTokenValue(s)).join("")}function so(n,e){if(e){const t=e.findElement(n);if(t&&t.title)return"="+t.title}return"="+n}function wi(n){switch(Xn(n).dataType){case te.OBJECT:return"对象";case te.ARRAY:return"数组";case te.STRING:return"文本";case te.NUMBER:return"数字";case te.DATE:return"日期";case te.BOOLEAN:return"布尔";default:return"未知类型"}}function Ci(n){var e;return((e=Gl.find(t=>t.value===n))==null?void 0:e.label)??n}const Ri=["onClick"],Li=O({__name:"WindowHeader",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=Ve(),l=e;function s(o){l("update:modelValue",o.value)}return(o,a)=>(S(),R("div",{class:g(o.classes.header)},[f("div",{class:g(o.classes.headerLeft)},[Pe(o.$slots,"prefix"),f("div",{class:g(o.classes.tabs)},[(S(!0),R(j,null,re(n.tabs,r=>(S(),R("div",{key:r.value,class:g({[o.classes.tab]:!0,[o.classes.active]:n.modelValue===r.value}),onClick:i=>s(r),onPointerdown:a[0]||(a[0]=ee(()=>{},["stop","prevent"]))},[f("span",null,W(r.label),1)],42,Ri))),128))],2)],2),y(t)?(S(),Z(y(jn),{key:0,instance:y(t)},null,8,["instance"])):U("",!0)],2))}}),Ni="_header_1o09p_2",Ii="_headerLeft_1o09p_14",xi="_tabs_1o09p_27",Ai="_tab_1o09p_27",qi="_active_1o09p_69",Di={header:Ni,headerLeft:Ii,tabs:xi,tab:Ai,active:qi},$i={classes:Di},io=B(Li,[["__cssModules",$i]]),ro=ql(()=>Dl(()=>import("./component-Dftd_N4J.js"),__vite__mapDeps([0,1,2]))),Oi=["onClick","onMouseenter"],Mi=O({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=ie(Mn[0].value),s=L(()=>`builtin_${$l(l.value,"_").toLowerCase()}`);function o(r){t("select",r)}function a(r){l.value=r.value}return(r,i)=>(S(),R("div",{class:g(r.classes.builtin)},[f("div",{class:g(["quickprint-is-scrollable",r.classes.panel])},[(S(!0),R(j,null,re(y(Mn),u=>(S(),R("div",{class:g({[r.classes.param]:!0,[r.classes.active]:u.value===l.value}),onClick:d=>o(u),onMouseenter:d=>a(u)},[f("strong",null,W(u.label),1),f("span",null,W(u.value),1)],42,Oi))),256))],2),f("div",{class:g(["quickprint-is-scrollable",r.classes.desc])},[p(y(ro),{name:s.value},null,8,["name"])],2)],2))}}),Pi="_builtin_m1n0z_2",Vi="_panel_m1n0z_11",Bi="_desc_m1n0z_17",Fi="_param_m1n0z_24",zi="_active_m1n0z_34",Ui={builtin:Pi,panel:Vi,desc:Bi,param:Fi,active:zi},Hi={classes:Ui},Gi=B(Mi,[["__cssModules",Hi]]),gl=[{label:"文本",value:te.STRING},{label:"数字",value:te.NUMBER},{label:"日期",value:te.DATE},{label:"对象",value:te.OBJECT},{label:"数组",value:te.ARRAY}],Wi=O({emit:["select"],props:{doc:{type:ve,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=xe("classes"),s=Ve(),o=i(),a=r();function r(){const b=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(k,x,C){var T;if(n.readonly){const E=k[x.name],N=((T=gl.find(w=>w.value===E))==null?void 0:T.label)??E;return p("div",{class:C.classes.cell},[N])}return p("div",{class:C.classes.cell},[p(J,{options:gl,modelValue:k.type,"onUpdate:modelValue":_.bind(null,k),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(k,x,C){return n.readonly?p("div",{class:C.classes.cell},[k[x.name]]):p("div",{class:C.classes.cell},[_e(p("input",{"onUpdate:modelValue":T=>k.name=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Ie,k.name]])])}},{name:"title",title:"标题",width:180,render(k,x,C){return n.readonly?p("div",{class:C.classes.cell},[k[x.name]]):p("div",{class:C.classes.cell},[_e(p("input",{"onUpdate:modelValue":T=>k.title=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Ie,k.title]])])}}];return n.readonly!==!0&&b.push({name:"operate",title:"操作",width:200,render(k,x,C){const T=[p("button",{type:"button",class:"quickprint-text-btn",onClick:d.bind(null,k,C.parent)},[p($,{icon:"icon-subnode"},null),p("span",null,[oe("插入行")])])];return(k.type===te.ARRAY||k.type===te.OBJECT)&&T.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:h.bind(null,k)},[p($,{icon:"icon-sisternode"},null),p("span",null,[oe("插入子级")])])),T.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:m.bind(null,k,C.parent)},[p($,{icon:"icon-delete"},null),p("span",null,[oe("删除")])])),T}}),b}function i(){const b=Ol(n.doc.ds.fields??[]).map(x=>{const C=x.type;return{...x,$expand:C===te.ARRAY||C===te.OBJECT}}),k=ie(b);return k.value.length==0&&k.value.push(u()),k}function u(){return{type:te.STRING,name:"",title:""}}function d(b,k){if(k){const C=k.children??[],T=C.indexOf(b);T>=0&&C.splice(T+1,0,u());return}const x=o.value.indexOf(b);x>=0&&o.value.splice(x+1,0,u())}function m(b,k){if(k){const C=k.children??[],T=C.indexOf(b);T>=0&&C.splice(T,1);return}const x=o.value.indexOf(b);x>=0&&o.value.splice(x,1),o.value.length==0&&o.value.push(u())}function h(b){b.type!==te.ARRAY&&b.type!==te.OBJECT||(b.children==null&&(b.children=[]),b.children.push(u()))}function _(b,k){b.type=k,k===te.ARRAY||k===te.OBJECT?b.$expand=!0:b.children=void 0}function v(){return{fields:o.value.map(k=>ce(k.name)?null:k.type!==te.ARRAY&&k.type!==te.OBJECT?{type:k.type,name:k.name,title:k.title}:{type:k.type,name:k.name,title:k.title,children:(k.children??[]).map(x=>ce(k.name)?null:{type:x.type,name:x.name,title:x.title}).filter(x=>x!=null)}).filter(k=>k!=null)}}function c(b,k){n.readonly===!0&&t("select",b,k)}return s==null||s.useHandle("confirm",v),e({submit:v}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(zo,{columns:a,data:o.value,onSelect:c},null)])}}}),Yi="_form_6lybl_2",Xi="_readonly_6lybl_6",ji="_datasource_6lybl_11",Zi={form:Yi,readonly:Xi,datasource:ji},Ki={classes:Zi},ao=B(Wi,[["__cssModules",Ki]]),Ji={class:"quickprint-config-group"},Qi={class:"quickprint-config-section quickprint-config-inline"},er={class:"quickprint-config-content"},tr={class:"quickprint-config-section quickprint-config-inline"},nr={class:"quickprint-config-content"},lr={class:"quickprint-config-id"},or={class:"quickprint-config-section quickprint-config-inline"},sr={class:"quickprint-config-content"},ir={class:"quickprint-config-group"},rr={class:"quickprint-config-group-title"},ar=O({__name:"Detail",props:{element:{type:me,required:!0}},setup(n){const e=n,t=L(()=>{var l,s;return(s=ll(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:s.content});return(l,s)=>(S(),R("div",{class:g(l.classes.detail)},[f("div",Ji,[f("section",Qi,[s[0]||(s[0]=f("header",{class:"quickprint-config-header"},"类型",-1)),f("div",er,W(y(Zt)(n.element.type)),1)]),f("section",tr,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"标识",-1)),f("div",nr,[f("span",lr,W(n.element.id),1)])]),f("section",or,[s[2]||(s[2]=f("header",{class:"quickprint-config-header"},"标题",-1)),f("div",sr,W(n.element.title),1)])]),f("div",ir,[f("div",rr,[s[3]||(s[3]=f("span",null,"数据",-1)),f("span",{class:g(l.classes.type)},W(y(Ci)(n.element.ds.type)),3)]),f("div",null,W(t.value),1)])],2))}}),cr="_detail_11ox4_2",ur="_type_11ox4_10",dr={detail:cr,type:ur},fr={classes:dr},pr=B(ar,[["__cssModules",fr]]),mr=O({__name:"index",props:{doc:{type:ve,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,s=r(),o=ie();function a(h){return h.reduce((_,v)=>{const c=Array.isArray(v.children)?a(v.children):[];if(Wn(v.ds.value)||c.length>0){const b={value:v.id,label:v.title??v.id,data:v,children:c};return _.push(b),_}return _},[])}function r(){const h=l.doc.pages.reduce((v,c)=>v.concat(c.children),[]),_=a(h);return ie(_)}function i(h){o.value=h}function u(h){return h.title?h.title:Zt(h.type)}function d(h){return Uu(h.type)??"icon-zhanweifu"}function m(h){t("select",h.data)}return(h,_)=>(S(),R("div",{class:g(h.classes.reference)},[f("div",{class:g([h.classes.panel,"quickprint-is-scrollable"])},[p(y(bi),{data:y(s),onNodeHover:i,onNodeClick:m},{default:ge(({node:v})=>[p(y($),{icon:d(v.data)},null,8,["icon"]),f("span",{class:g(h.classes.title)},W(u(v.data)),3),f("span",{class:g(h.classes.id)},"<"+W(v.value)+">",3)]),_:1},8,["data"])],2),f("div",{class:g([h.classes.detail,"quickprint-is-scrollable"])},[o.value?(S(),Z(pr,{element:o.value.data,key:o.value.value},null,8,["element"])):U("",!0)],2)],2))}}),hr="_reference_1ekkx_2",gr="_panel_1ekkx_12",vr="_detail_1ekkx_20",br="_title_1ekkx_25",yr="_id_1ekkx_29",_r={reference:hr,panel:gr,detail:vr,title:br,id:yr},Er={classes:_r},Tr=B(mr,[["__cssModules",Er]]),Sr=O({__name:"index",props:{doc:{type:ve,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}}},setup(n){const e=n,t=[{label:"数据源",value:"ds"},{label:"内置变量",value:"builtin"},{label:"引用组件",value:"reference"}],l=Ve(),s=ie(d()),o=L(()=>t.filter(m=>e.include.includes(m.value)));function a(m,h){return m==null?null:h==null?`${Je.DS}.${m.type}.${m.name}`:`${Je.DS}.${m.type}.${h.name}.${m.name}`}function r(m,h){l==null||l.confirm({type:"ds",value:a(m,h),parent:h})}function i(m){l==null||l.confirm({type:"builtin",value:`${Je.BUILTIN}.${m.type}.${m.value}`})}function u(m){l==null||l.confirm({type:"reference",value:m.id})}function d(){const m=e.value;return m==null||m==""?"ds":Xn(m).varType===Je.BUILTIN?"builtin":"ds"}return(m,h)=>(S(),R("div",{class:g(m.classes.var)},[p(io,{modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=_=>s.value=_),tabs:o.value},{prefix:ge(()=>[p(y($),{icon:"icon-var",size:"16px"}),f("span",{class:g(m.classes.title)},"变量",2)]),_:1},8,["modelValue","tabs"]),s.value==="ds"?(S(),Z(ao,{key:0,doc:n.doc,onSelect:r,readonly:""},null,8,["doc"])):U("",!0),s.value==="builtin"?(S(),Z(Gi,{key:1,onSelect:i})):U("",!0),s.value==="reference"?(S(),Z(Tr,{key:2,doc:n.doc,onSelect:u},null,8,["doc"])):U("",!0)],2))}}),kr="_title_xcig2_10",wr={var:"_var_xcig2_2",title:kr},Cr={classes:wr},co=B(Sr,[["__cssModules",Cr]]),Rr=["onClick","onMouseenter"],Lr=O({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var i;const t=n,l=e,s=ie((i=t.options[0])==null?void 0:i.value),o=L(()=>`${t.type}_${s.value.toLowerCase()}`);function a(u){l("select",u.value)}function r(u){s.value=u.value}return(u,d)=>(S(),R("div",{class:g(u.classes.doc)},[f("div",{class:g(["quickprint-is-scrollable",u.classes.panel])},[(S(!0),R(j,null,re(n.options,m=>(S(),R("div",{key:m.value,class:g({[u.classes.option]:!0,[u.classes.active]:m.value===s.value}),onClick:h=>a(m),onMouseenter:h=>r(m)},[f("strong",null,W(m.label),1)],42,Rr))),128))],2),f("div",{class:g(["quickprint-is-scrollable",u.classes.desc])},[p(y(ro),{name:o.value},null,8,["name"])],2)],2))}}),Nr="_doc_1pdoc_2",Ir="_panel_1pdoc_10",xr="_desc_1pdoc_16",Ar="_option_1pdoc_23",qr="_active_1pdoc_33",Dr={doc:Nr,panel:Ir,desc:xr,option:Ar,active:qr},$r={classes:Dr},Ht=B(Lr,[["__cssModules",$r]]),Or=O({__name:"index",setup(n){const e=Ve(),t=ie("string"),l=[{label:"文本",value:"string"},{label:"数字",value:"number"},{label:"日期",value:"date"},{label:"逻辑",value:"logical"},{label:"聚合",value:"aggregate"}],s=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],o=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"}],a=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],r=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],i=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function u(d){return e==null?void 0:e.confirm({type:"function",value:`${d}()`})}return(d,m)=>(S(),R("div",{class:g(d.classes.function)},[p(io,{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=h=>t.value=h),tabs:l},{prefix:ge(()=>[p(y($),{icon:"icon-function",size:"16px"}),f("span",{class:g(d.classes.title)},"函数",2)]),_:1},8,["modelValue"]),t.value==="string"?(S(),Z(Ht,{options:s,onSelect:u,key:"string"})):U("",!0),t.value==="number"?(S(),Z(Ht,{options:o,onSelect:u,key:"number"})):U("",!0),t.value==="logical"?(S(),Z(Ht,{options:a,onSelect:u,key:"logical"})):U("",!0),t.value==="date"?(S(),Z(Ht,{options:r,onSelect:u,key:"date"})):U("",!0),t.value==="aggregate"?(S(),Z(Ht,{options:i,onSelect:u,key:"aggregate"})):U("",!0)],2))}}),Mr="_title_1bezq_11",Pr={function:"_function_1bezq_2",title:Mr},Vr={classes:Pr},Br=B(Or,[["__cssModules",Vr]]),Fr=["onMouseenter"],zr=["onClick"],Ur={key:1},Hr=O({__name:"Formula",props:{doc:{type:ve,default:null}},setup(n){const e=n,t=Ve(),l=[{id:"pageNumber",name:"页码",options:i(ws)}],s=ie(l[0]);function o(u){s.value=u}function a(u){return t==null?void 0:t.confirm({type:"formula",value:u})}function r(u){const d=mn.tokenize(u),m=e.doc;return d.reduce((h,_)=>{if(_.type===Qe.VARIABLE)return h.push({type:"highlight",value:it(_.value,m==null?void 0:m.ds)}),h;if(_.type===Qe.REFERENCE)return h.push({type:"highlight",value:so(_.value,m)}),h;if(_.type===Qe.TEMPLATE){const c=(Array.isArray(_.value)?_.value:[_.value]).map(b=>b.type===Qe.VARIABLE?{type:"highlight",value:it(b.value,m.ds)}:{type:"text",value:b.value});return h.concat(c)}return h.push({type:"text",value:mn.formatTokenValue(_)}),h},[])}function i(u){return u.map(d=>({nodes:r(d),value:d}))}return(u,d)=>(S(),R("div",{class:g(u.classes.formula)},[f("div",{class:g([u.classes.left,"quickprint-is-scrollable"])},[(S(),R(j,null,re(l,m=>f("div",{key:m.name,onMouseenter:h=>o(m),class:g({[u.classes.group]:!0,[u.classes.active]:m.id===s.value.id})},W(m.name),43,Fr)),64))],2),f("div",{class:g(u.classes.right)},[(S(!0),R(j,null,re(s.value.options,(m,h)=>(S(),R("div",{key:h,class:g(u.classes.code),onClick:_=>a(m.value)},[(S(!0),R(j,null,re(m.nodes,_=>(S(),R(j,null,[_.type==="highlight"?(S(),R("span",{key:0,class:g(u.classes.highlight)},"["+W(_.value)+"]",3)):(S(),R("span",Ur,W(_.value),1))],64))),256)),f("span",{class:g(u.classes.badge)},"插入",2)],10,zr))),128))],2)],2))}}),Gr="_formula_ms7c3_2",Wr="_left_ms7c3_12",Yr="_right_ms7c3_17",Xr="_group_ms7c3_24",jr="_active_ms7c3_34",Zr="_highlight_ms7c3_39",Kr="_code_ms7c3_43",Jr="_badge_ms7c3_65",Qr={formula:Gr,left:Wr,right:Yr,group:Xr,active:jr,highlight:Zr,code:Kr,badge:Jr},ea={classes:Qr},ta=B(Hr,[["__cssModules",ea]]),sl=Be(function(n){return Kt("变量",p(co,{doc:n.doc,value:n.value},null),{preset:"variable"}).promisify().catch(Oe)}),na=Be(function(n){return Et("数据源",p(ao,{doc:n},null),{preset:"variable",icon:p($,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Oe)}),la=Be(function(n){const e=["ds","builtin","reference"];return Kt("变量",p(co,{doc:n.doc,value:n.value,include:e},null),{preset:"variable"}).promisify().catch(Oe)}),oa=Be(function(){return Kt("函数",p(Br,null,null),{preset:"variable"}).promisify().catch(Oe)}),sa=Be(function(n){return Et("公式",p(ta,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Oe)}),ia={key:1},ra=O({__name:"Content",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Ee(),l=Vt("editorRef"),s=Vt("contentRef"),o=ie(!1),a=L(()=>{const d=e.element.type===X.TABLE_CELL?Ei(e.element,{exclude:["border"]}):lo(e.element);return d.color&&(d["--quickprint-element-var-color"]=d.color),o.value&&(d.alignItems="flex-start"),d}),r=L(()=>{const d=ll(e.element,t.doc.ds);return d==null||d.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:d.type===ye.CONST?"span":"strong",content:d.content},{tag:"span",content:e.element.attributes.suffix}]});async function i(){var _;const d=await sl({doc:t.doc,value:e.element.ds.value}).catch(et);if(d==null||(e.element.setDataSource(ye.VARIABLE,d.value),e.element.type!=X.TABLE_CELL||d.type!=="ds"))return;const m=e.element.parent;if(m==null||m.isBindVariable||((_=d.parent)==null?void 0:_.type)!==te.ARRAY)return;const h=d.parent;m.setDataSource(ye.VARIABLE,`${Je.DS}.${h.type}.${h.name}`)}function u(){const d=l.value,m=s.value;d==null||m==null||(o.value=m.offsetHeight>d.offsetHeight)}return(d,m)=>(S(),R("div",{class:"quickprint-is-element-editor",style:K(a.value),onVnodeMounted:u,ref_key:"editorRef",ref:l},[f("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:s},[f("span",{class:g({[d.classes.lineThrough]:n.element.style.lineThrough})},[(S(!0),R(j,null,re(r.value,(h,_)=>(S(),R(j,{key:_},[h.tag=="strong"?(S(),R("strong",{key:0,class:g(d.classes.highlight)},"["+W(h.content)+"]",3)):(S(),R("span",ia,W(h.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(S(),Z(y($),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:g(d.classes.dsIcon),onClick:i,onPointerdown:m[0]||(m[0]=ee(()=>{},["stop"]))},null,8,["class"])):U("",!0)],4))}}),aa="_dsIcon_ss96n_2",ca="_lineThrough_ss96n_10",ua="_highlight_ss96n_14",da={dsIcon:aa,lineThrough:ca,highlight:ua},fa={classes:da},_n=B(ra,[["__cssModules",fa]]),pa=O({__name:"TextEditor",props:{element:{type:Uo,required:!0}},setup(n){return(e,t)=>(S(),Z(_n,{element:n.element},null,8,["element"]))}}),En=Object.freeze({title:"文本",icon:"icon-text",type:X.TEXT,editor:pa,onCreate(){return me.create({type:X.TEXT,width:_t,height:yn})}}),ma=O({__name:"NumberEditor",props:{element:{type:Ho,required:!0}},setup(n){return(e,t)=>(S(),Z(_n,{element:n.element},null,8,["element"]))}}),ha=["value","disabled"],ga=O({__name:"RadioButton",props:St({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=Jt(n,"modelValue");return(t,l)=>(S(),R("div",{class:g({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(S(!0),R(j,null,re(n.options,s=>(S(),R("label",{class:g({[t.classes.radio]:!0,[t.classes.selected]:s.value===n.modelValue})},[_e(f("input",{type:"radio",value:s.value,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value=o),disabled:n.disabled},null,8,ha),[[us,e.value]]),f("span",null,W(s.label),1)],2))),256))],2))}}),va="_radioGroup_67myk_2",ba="_compacted_67myk_10",ya="_radio_67myk_2",_a="_selected_67myk_50",Ea="_disabled_67myk_56",Ta={radioGroup:va,compacted:ba,radio:ya,selected:_a,disabled:Ea},Sa={classes:Ta},It=B(ga,[["__cssModules",Sa]]),ka={class:"quickprint-config-section quickprint-config-inline"},wa={class:"quickprint-config-content"},Ca={class:"quickprint-config-section quickprint-config-inline"},Ra={class:"quickprint-config-content"},La={class:"quickprint-config-section quickprint-config-inline"},Na={class:"quickprint-config-content"},Ia={class:"quickprint-config-section quickprint-config-inline"},xa={class:"quickprint-config-content"},Aa=O({__name:"NumberConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t=L({get(){return e.element.attributes.showZero??!0},set(o){const a=e.element.attributes;a.showZero=o}}),l=L({get(){return e.element.attributes.round??Gt.ROUND},set(o){const a=e.element.attributes;a.round=o}}),s=L({get(){return e.element.attributes.format??pt.NONE},set(o){const a=e.element.attributes;a.format=o}});return(o,a)=>(S(),R(j,null,[f("section",ka,[a[4]||(a[4]=f("header",{class:"quickprint-config-header"},"小数位数",-1)),f("div",wa,[_e(f("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>n.element.attributes.precision=r),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ie,n.element.attributes.precision]])])]),f("section",Ca,[a[5]||(a[5]=f("header",{class:"quickprint-config-header"},"舍入规则",-1)),f("div",Ra,[p(y(J),{options:y(gs),modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=r=>l.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",La,[a[6]||(a[6]=f("header",{class:"quickprint-config-header"},"显示类型",-1)),f("div",Na,[p(y(J),{options:y(vs),modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=r=>s.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",Ia,[a[7]||(a[7]=f("header",{class:"quickprint-config-header"},"值为0时",-1)),f("div",xa,[p(It,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=r=>t.value=r),options:y(bs),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),Tn=Object.freeze({title:"数字",type:X.NUMBER,icon:"icon-number",editor:ma,config:{display:Aa},onCreate(){return me.create({type:X.NUMBER,width:_t,height:yn})}}),qa=O({__name:"DateEditor",props:{element:{type:Go,required:!0}},setup(n){return(e,t)=>(S(),Z(_n,{element:n.element},null,8,["element"]))}}),Da={class:"quickprint-config-section"},$a={class:"quickprint-config-content"},Oa=O({__name:"DateConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=L(()=>[{label:"原始值",value:t.NONE},...Wl]);function s(o){if(o.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=o.value}return(o,a)=>(S(),R("section",Da,[f("header",{class:g(["quickprint-config-header",o.classes.header])},[a[1]||(a[1]=f("span",null,"格式",-1)),p(y(J),{options:l.value,onSelect:s,class:g(o.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:ge(()=>[f("span",{class:g(o.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),f("div",$a,[_e(f("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=r=>n.element.attributes.format=r),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ie,n.element.attributes.format]])])]))}}),Ma="_header_79607_2",Pa="_picker_79607_8",Va="_placeholder_79607_15",Ba={header:Ma,picker:Pa,placeholder:Va},Fa={classes:Ba},za=B(Oa,[["__cssModules",Fa]]),Sn=Object.freeze({title:"日期",type:X.DATE,icon:"icon-date",editor:qa,config:{display:za},onCreate(){return me.create({type:X.DATE,width:_t,height:yn})}}),Ua=["colspan","rowspan"],Ha=O({__name:"TableCellEditor",props:{element:{type:Zn,required:!0}},setup(n){const e=n,t=L(()=>e.element.attributes.colspan===0||e.element.attributes.rowspan===0),l=Ee(),s=xe("classes"),o=L(()=>{var i;return{[s.cell]:!0,[G.SELECTED]:(i=e.element.state)==null?void 0:i.selected}}),a=L(()=>{var d;const i=Vn((d=e.element.parent)==null?void 0:d.parent),u=Vn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Ke(i,u)}});function r(i){i.button==0&&l.selectElement(e.element)}return(i,u)=>t.value?U("",!0):(S(),R("td",Fl({key:0,[`.${y(Xe)||""}`]:n.element,class:o.value,style:a.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:ee(r,["stop"])}),[p(_n,{element:n.element,class:g(y(s).content)},null,8,["element","class"])],48,Ua))}}),Ga="_cell_rp1x6_2",Wa="_content_rp1x6_31",Ya={cell:Ga,content:Wa},Xa={classes:Ya},uo=B(Ha,[["__cssModules",Xa]]);function fo(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}function ja(n,e){const t=e.getSelected(),l={menus:[{type:"menu",label:"选中表格",icon:"icon-aim",handler:e.selectTable}]};return t.length>=2&&l.menus.push({type:"menu",label:"合并",icon:"icon-merge-cells",handler:e.mergeCells}),t.some(s=>s.hasColSpan||s.hasRowSpan)&&l.menus.push({type:"menu",label:"拆分",icon:"icon-solit-cells",handler:e.splitCells}),l.menus.push({type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",handler:e.insertColumnLeft},{type:"menu",label:"右侧插入列",handler:e.insertColumnRight},{type:"menu",label:"上侧插入行",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",handler:e.inserRowBottom}]},{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:e.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:e.avgTableWidth},{type:"menu",label:"均分表格高度",handler:e.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:e.setOtherRowSameHeight,disabled(){return e.toArea(t).rowSpan!==1}},{type:"menu",label:"将其他列设为相同宽度",handler:e.setOtherColSameWidth,disabled(){return e.toArea(t).colSpan!==1}}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:e.deleteColumns},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]},{type:"divider"},fo(e.getDesignApi(),e.getTable())),Kn.open(n.clientX,n.clientY,l)}function Za(n,e){function t(){return n.element}function l(){const T=t();return e.getSelectedElements().filter(N=>{var I;if(N.type!==X.TABLE_CELL)return!1;const w=(I=N.parent)==null?void 0:I.parent;return w==null?!1:w.id==T.id}).sort(Zn.sort)}function s(T){var z,P,ne;const[E,...N]=T;let w=E.index,I=E.index,A=((z=E.parent)==null?void 0:z.index)??-1,M=((P=E.parent)==null?void 0:P.index)??-1;for(const Y of N){const q=((ne=Y.parent)==null?void 0:ne.index)??-1,ue=Y.index;ue>=0&&ue<w&&(w=ue),ue>=0&&ue>I&&(I=ue),q>=0&&q<A&&(A=q),q>=0&&q>M&&(M=q)}return{colStart:w,colEnd:I,rowStart:A,rowEnd:M,colSpan:I-w+1,rowSpan:M-A+1}}function o(){var N;const T=l()[0];if(T==null)return!1;const E=(N=T.parent)==null?void 0:N.parent;return E==null?!1:e.selectElement(E)}function a(){const T=l();if(T.length===0)return!1;const E=s(T);return t().insertColumn(E.colStart,0),e.createSnapshot(),!0}function r(){const T=l();if(T.length===0)return!1;const E=s(T);return t().insertColumn(E.colEnd,1),e.createSnapshot(),!0}function i(){const T=l();if(T.length===0)return!1;const E=s(T);return t().inserRow(E.rowStart,0),e.createSnapshot(),!0}function u(){const T=l();if(T.length===0)return!1;const E=s(T);return t().inserRow(E.rowEnd,1),e.createSnapshot(),!0}function d(){var q,ue;const T=t(),E=T.page;if(E==null)return;const N=T.doc,w=hl((q=N==null?void 0:N.margins)==null?void 0:q.left)??38,I=hl((ue=N==null?void 0:N.margins)==null?void 0:ue.right)??38,A=T.columns,M=A.reduce((le,Se)=>le+Se,0),z=On.mm_to_px(E.width)-w-I,P=[];for(const le of A){const Se=Math.round(le/M*z);P.push(Se)}const ne=P.reduce((le,Se)=>le+Se,0),Y=z-ne;P[P.length-1]+=Y,T.setColumns(P),T.updateBoxSize(),e.createSnapshot()}function m(){const T=t(),E=T.columns,N=E.reduce((M,z)=>M+z,0),w=Math.floor(N/E.length),I=new Array(E.length).fill(w),A=N-I.reduce((M,z)=>M+z,0);I[I.length-1]+=A,T.setColumns(I),T.updateBoxSize(),e.createSnapshot()}function h(){const T=t(),E=Math.round(T.height/T.children.length);T.children.forEach((N,w)=>T.setRowHeight(w,E)),T.updateBoxSize(),e.createSnapshot()}function _(){const T=e.getSelectedElements()[0];if(T==null)return;const E=T.parent;if(E==null||E.type!="TableRow")return;const N=t(),w=E.height;N.children.forEach(I=>I.setRowHeight(w)),N.updateBoxSize(),e.createSnapshot()}function v(){const T=e.getSelectedElements()[0];if(T==null)return;const E=t(),N=T.width,w=E.attributes.colgroup.map(I=>N);E.setColumns(w),E.updateBoxSize(),e.createSnapshot()}function c(){const T=l();if(T.length<2)return;const[E,...N]=T,w=s(T);for(const I of N)I.attributes.colspan=0,I.attributes.rowspan=0;E.attributes.colspan=w.colSpan,E.attributes.rowspan=w.rowSpan,E.attributes.range=N.map(I=>I.id),e.selectElement(E),e.createSnapshot()}function b(){const T=l();if(T.length!=0){for(const E of T)!E.hasColSpan&&!E.hasRowSpan||E.resetSpan();e.createSnapshot()}}function k(){const T=l()[0];if(T==null)return;t().removeColumn(T.index),e.createSnapshot()}function x(){const T=l()[0];if(T==null)return;const E=T.parent;if(E==null)return;t().removeRow(E.index),e.createSnapshot()}function C(){e.getSelectedElements().forEach(E=>E.resetDS()),e.createSnapshot()}return{getDesignApi(){return e},getTable:t,getSelected:l,selectTable:o,toArea:s,insertColumnLeft:a,insertColumnRight:r,insertRowTop:i,inserRowBottom:u,autoReiszeColumnByPaper:d,avgTableWidth:m,avgTableHeight:h,setOtherRowSameHeight:_,setOtherColSameWidth:v,mergeCells:c,splitCells:b,deleteColumns:k,deleteRows:x,deleteDataSource:C}}function Ka(n,e,t){const s={moved:!1,left:0,colIndex:0,target:null,container:null};function o(d){return d<=0?null:n.getTable().getColumnLeft(d-1)}function a(d){const m=n.getTable(),h=m.attributes.colgroup.length;return d>=h?null:m.getColumnLeft(d+1)}function r(d,m){if(!(d.target instanceof Element))return;const h=d.target.closest("."+e.colResize);if(h==null)return;const _=h.closest("."+e.layer);_!=null&&(d.stopPropagation(),d.preventDefault(),s.left=h.offsetLeft,s.colIndex=m,s.target=h,s.container=_,s.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",i),window.addEventListener("pointerup",u))}function i(d){if(s.target==null||s.container==null)return;const m=s.container.getBoundingClientRect(),h=o(s.colIndex),_=a(s.colIndex);let v=d.clientX-m.left;h!=null&&v<=h+4&&(v=h+4),_!=null&&v>=_-4&&(v=_-4),s.left=v,s.target.style.left=v+"px",s.moved=!0}function u(d){s.moved&&t.onResizeEnd(s.colIndex,Math.round(s.left)),s.left=0,s.target=null,s.container=null,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)}return r}function Ja(n,e,t){const s={moved:!1,top:0,rowIndex:0,target:null,container:null};function o(d){return d<=0?null:n.getTable().getRowTop(d-1)}function a(d){const m=n.getTable(),h=m.children.length;return d>=h?null:m.getRowTop(d+1)}function r(d,m){if(!(d.target instanceof Element))return;const h=d.target.closest("."+e.rowResize);if(h==null)return;const _=h.closest("."+e.layer);_!=null&&(d.stopPropagation(),d.preventDefault(),s.top=h.offsetTop,s.rowIndex=m,s.target=h,s.container=_,s.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",i),window.addEventListener("pointerup",u))}function i(d){if(s.target==null||s.container==null)return;const m=s.container.getBoundingClientRect(),h=o(s.rowIndex),_=a(s.rowIndex);let v=d.clientY-m.top;h!=null&&v<=h+4&&(v=h+4),_!=null&&v>=_-4&&(v=_-4),s.moved=!0,s.top=v,s.target.style.top=v+"px"}function u(d){s.moved&&t.onResizeEnd(s.rowIndex,Math.round(s.top)),s.top=0,s.target=null,s.container=null,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)}return r}const Qa=["width"],ec=["onClick"],tc=["onClick"],nc=O({__name:"TableEditor",props:{element:{type:Wo,required:!0}},setup(n){const e=n,t=Ee(),l=xe("classes"),s=Za(e,t),o=$e({colIndex:-1,rowIndex:-1,silence:!1}),a=L(()=>e.element.attributes.colgroup??[]),r=Ka(s,l,{onResizeEnd:k,onResizeStart:b}),i=Ja(s,l,{onResizeEnd:x,onResizeStart:b});function u(w){return{left:(e.element.attributes.colgroup??[]).slice(0,w).reduce((A,M)=>A+M,0)+"px"}}function d(w){return{top:(e.element.children??[]).slice(0,w).reduce((M,z)=>M+z.height,0)-1+"px"}}function m(w){const I=e.element.attributes.colgroup??[],A=I.slice(0,w).reduce((P,ne)=>P+ne,0),M=w===0?0:1,z=w>0&&w<I.length?-1:0;return{left:A+M+"px",width:I[w]+z+"px"}}function h(w){const I=e.element.children??[],A=I.slice(0,w).reduce((P,ne)=>P+ne.height,0),M=w===0?0:1,z=w>0&&w<I.length?-1:0;return{top:A+M+"px",height:I[w].height+z+"px"}}function _(w){t.selectElement(w)}function v(w){const I=[];for(const A of e.element.children){const M=A.children[w];M.isColCollapse||I.push(M)}t.multiSelectElements(I)}async function c(w){const I=w.target.closest("td");if(I==null)return;const A=Reflect.get(I,Xe);A!=null&&(t.state.selectMode==st.SINGLE&&(t.selectElement(A),await Pt()),ja(w,s))}function b(){o.silence=!0}function k(w,I){o.silence=!1;const A=e.element.attributes.colgroup??[];if(w==0){const Y=e.element.left,q=e.element.calculateCoord(Y+I),ue=A[0]-(q-Y);e.element.setLeft(q),e.element.setColWidth(0,ue),e.element.updateBoxSize(),t.createSnapshot();return}if(w==A.length){const Y=w-1,q=A.slice(0,Y).reduce((le,Se)=>le+Se,0),ue=I-q;e.element.setColWidth(w-1,ue),e.element.updateBoxSize(),t.createSnapshot();return}const M=w-1,z=A[M]+A[w],P=I-A.slice(0,M).reduce((Y,q)=>Y+q,0),ne=z-P;e.element.setColWidth(M,P),e.element.setColWidth(w,ne),e.element.updateBoxSize(),t.createSnapshot()}function x(w,I){o.silence=!1;const A=e.element.children;if(w==0){const Y=e.element.top,q=e.element.calculateCoord(Y+I),ue=A[0].height-(q-Y);e.element.setTop(q),e.element.setRowHeight(w,ue),e.element.updateBoxSize(),t.createSnapshot();return}if(w==A.length){const Y=w-1,q=A.slice(0,Y).reduce((le,Se)=>le+Se.height,0),ue=I-q;e.element.setRowHeight(w-1,ue),e.element.updateBoxSize(),t.createSnapshot();return}const M=w-1,z=A[M].height+A[w].height,P=I-A.slice(0,M).reduce((Y,q)=>Y+q.height,0),ne=z-P;e.element.setRowHeight(M,P),e.element.setRowHeight(w,ne),e.element.updateBoxSize(),t.createSnapshot()}function C(){o.rowIndex=-1,o.colIndex=-1}function T(w){if(o.silence)return;const I=w.target.closest("td");if(I==null)return;const A=Reflect.get(I,Xe);if(A==null||!(A instanceof Zn))return;const M=A.parent;if(M==null)return;const z=I.getBoundingClientRect(),P=w.clientY-z.top,Y=w.clientX-z.left<z.width/2,q=P<z.height/2;o.colIndex=Y?A.index:A.getNextColIndex(),o.rowIndex=q?M.index:A.getNextRowIndex()}function E(){const w=e.element;w.insertColumn(w.colSize-1,1)}function N(){const w=e.element;w.inserRow(w.rowSize-1,1)}return(w,I)=>(S(),R("div",{class:g(y(l).tableEditor),onContextmenu:ee(c,["stop","prevent"]),onClick:I[3]||(I[3]=ee(()=>{},["stop"])),onMouseleave:C},[f("table",{class:g(y(l).table),onMousemove:T},[f("colgroup",null,[(S(!0),R(j,null,re(a.value,(A,M)=>(S(),R("col",{key:M,width:A},null,8,Qa))),128))]),f("tbody",null,[(S(!0),R(j,null,re(n.element.children,A=>(S(),R("tr",{key:A.id,class:g({[y(G).SELECTED]:A.isSelected})},[(S(!0),R(j,null,re(A.children,M=>(S(),Z(uo,{key:M.id,element:M},null,8,["element"]))),128))],2))),128))])],34),f("div",{class:g(y(l).layer)},[o.colIndex>=0?(S(),R("div",{key:0,title:"调整列宽",class:g(y(l).colResize),style:K(u(o.colIndex)),onPointerdown:I[0]||(I[0]=ee(A=>y(r)(A,o.colIndex),["stop","prevent"]))},null,38)):U("",!0),o.rowIndex>=0?(S(),R("div",{key:1,title:"调整行高",class:g(y(l).rowResize),style:K(d(o.rowIndex)),onPointerdown:I[1]||(I[1]=ee(A=>y(i)(A,o.rowIndex),["stop","prevent"]))},null,38)):U("",!0),(S(!0),R(j,null,re(a.value,(A,M)=>(S(),R("div",{title:"选中此列",key:M,style:K(m(M)),class:g(y(l).colIndicator),onClick:ee(z=>v(M),["stop"])},null,14,ec))),128)),(S(!0),R(j,null,re(n.element.children,(A,M)=>(S(),R("div",{title:"选中此行",key:M,style:K(h(M)),class:g(y(l).rowIndicator),onClick:ee(z=>_(A),["stop"])},null,14,tc))),128)),n.element.isSelected?(S(),R("button",{key:2,type:"button",class:g(["quickprint-text-btn",y(l).addCol]),onClick:ee(E,["stop"]),title:"添加列"},[p(y($),{icon:"icon-plus",size:"14px"})],2)):U("",!0),n.element.isSelected?(S(),R("button",{key:3,type:"button",class:g(["quickprint-text-btn",y(l).addRow]),onClick:ee(N,["stop"]),title:"添加行"},[p(y($),{icon:"icon-plus",size:"14px"})],2)):U("",!0)],2),f("div",{class:g(y(l).indicator),onPointerdown:I[2]||(I[2]=(...A)=>y(t).onDragStart&&y(t).onDragStart(...A)),title:"选中/拖动表格"},null,34)],34))}}),lc="_tableEditor_5qbkt_2",oc="_table_5qbkt_2",sc="_layer_5qbkt_33",ic="_colResize_5qbkt_43",rc="_rowResize_5qbkt_66",ac="_colIndicator_5qbkt_89",cc="_rowIndicator_5qbkt_95",uc="_indicator_5qbkt_114",dc="_addCol_5qbkt_151",fc="_addRow_5qbkt_166",pc={tableEditor:lc,table:oc,layer:sc,colResize:ic,rowResize:rc,colIndicator:ac,rowIndicator:cc,indicator:uc,addCol:dc,addRow:fc},mc={classes:pc},hc=B(nc,[["__cssModules",mc]]),gc={class:"quickprint-config-section quickprint-config-inline"},vc={class:"quickprint-config-content"},bc=O({__name:"TableRowConfig",props:{element:{type:on,required:!0}},setup(n){const e=n,t=[{label:"表头",value:wt.HEADER},{label:"表体",value:wt.BODY},{label:"表尾",value:wt.FOOTER}],l=L({get(){return e.element.attributes.type??wt.BODY},set(s){switch(s){case wt.HEADER:e.element.asHeader();break;case wt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(s,o)=>(S(),R("section",gc,[o[1]||(o[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",vc,[p(y(J),{options:t,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=a=>l.value=a),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),kn=Object.freeze({title:"表格",type:X.TABLE,icon:"icon-table",editor:hc,config:{exclude:[ae.PREFIX,ae.SUFFIX,ae.DISPLAY,ae.OVERFLOW]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[_t,_t,_t],e=me.create({type:X.TABLE});return e.setColgroup(n),e.append(on.createDefault(n)),e.append(on.createDefault(n)),e.append(on.createDefault(n)),e.updateBoxSize(),e}}),po=Object.freeze({title:"表格行",type:X.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[ae.POSITION,ae.COORD,ae.OVERFLOW],attributes:bc}}),il=Object.freeze({title:"单元格",type:X.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:uo,config:{exclude:[ae.POSITION,ae.COORD]}});function tn(n,e){const t=Math.pow(10,Math.max(0,e));return Math.round(n*t)/t}const Dn={A:10,B:11,C:12,D:13,E:14,F:15},vl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function yc(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function _c(n){return typeof n=="string"&&n.includes("%")}function At(n,e){yc(n)&&(n="100%");const t=_c(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function dt(n){return n.length===2?(Dn[n[0].toUpperCase()]||+n[0])*16+(Dn[n[1].toUpperCase()]||+n[1]):Dn[n[1].toUpperCase()]||+n[1]}function bl(n,e,t){n=At(n,255),e=At(e,255),t=At(t,255);const l=Math.max(n,e,t),s=Math.min(n,e,t);let o;const a=l,r=l-s,i=l===0?0:r/l;if(l===s)o=0;else{switch(l){case n:{o=(e-t)/r+(e<t?6:0);break}case e:{o=(t-n)/r+2;break}case t:{o=(n-e)/r+4;break}}o/=6}return{h:o*360,s:i*100,v:a*100}}const Ec=function(n,e,t){e=e/100,t=t/100;let l=e;const s=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=s<=1?s:2-s;const o=(t+e)/2,a=t===0?2*l/(s+l):2*e/(t+e);return{h:n,s:a*100,v:o*100}},Tc=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function $n(n,e,t){n=At(n,360)*6,e=At(e,100),t=At(t,100);const l=Math.floor(n),s=n-l,o=t*(1-e),a=t*(1-s*e),r=t*(1-(1-s)*e),i=l%6,u=[t,a,o,o,r,t][i],d=[r,t,t,a,o,o][i],m=[o,o,r,t,t,a][i];return{r:Math.round(u*255),g:Math.round(d*255),b:Math.round(m*255)}}function an(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${vl[e]||e}${vl[t]||t}`}function Sc({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${an(n)}${an(e)}${an(t)}`}class wn{constructor(e){F(this,"h",0);F(this,"s",100);F(this,"v",100);F(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=tn(e,2)}setSaturation(e){this.s=tn(e,2)}setValue(e){this.v=tn(e,2)}setAlpha(e){this.a=tn(e,2)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(s=>s!=="").map((s,o)=>o>2?Number.parseFloat(s):Number.parseInt(s,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,s,o,a=100;t.length===3?(l=dt(t[0]+t[0]),s=dt(t[1]+t[1]),o=dt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=dt(t.slice(0,2)),s=dt(t.slice(2,4)),o=dt(t.slice(4,6))),t.length===8&&(a=dt(t.slice(6))/255*100);const{h:r,s:i,v:u}=bl(l,s,o);return{h:r,s:i,v:u,a}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:a}=bl(t[0],t[1],t[2]);return{h:s,s:o,v:a,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:a}=Ec(t[0],t[1],t[2]);return{h:s,s:o,v:a,a:l}}return null}toString(e){switch(e){case"hsl":{const t=Tc(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Sc($n(this.h,this.s,this.v))}${an(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:s}=$n(this.h,this.s,this.v);return`rgba(${t},${l},${s},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return $n(this.h,this.s,this.v)}}function mo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(a){const r=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().width/2;let d=a.clientX-r.left-e.offsetX;return d<-u&&(d=-u),d>r.width-u&&(d=r.width-u),d}function l(a){a.stopPropagation(),a.preventDefault();const r=a.target,i=a.currentTarget;origin==null||r==null||(e.container=i,e.target=r===i?r.firstElementChild:r,e.offsetX=r===i?e.target.offsetWidth/2:a.clientX-r.getBoundingClientRect().left,window.addEventListener("pointermove",s),window.addEventListener("pointerup",o))}function s(a){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(a.pointerId),e.init=!0);const r=t(a);e.target.style.left=r+"px",n("move",r)}function o(a){if(a.preventDefault(),a.stopPropagation(),e.container&&e.target){const r=t(a);n("end",r)}e.target&&e.target.releasePointerCapture(a.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",o)}return l}function kc(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let m=r.clientX-i.left-e.offsetX;return m<-d&&(m=-d),m>i.width-d&&(m=i.width-d),m}function l(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().height/2;let m=r.clientY-i.top-e.offsetY;return m<-d&&(m=-d),m>i.height-d&&(m=i.height-d),m}function s(r){r.stopPropagation(),r.preventDefault();const i=r.target,u=r.currentTarget;origin==null||i==null||(e.container=u,e.target=i===u?i.firstElementChild:i,e.offsetX=i===u?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,e.offsetY=i===u?e.target.offsetHeight/2:r.clientY-i.getBoundingClientRect().top,window.addEventListener("pointermove",o),window.addEventListener("pointerup",a))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r),u=l(r);e.target.style.left=i+"px",e.target.style.top=u+"px",n("move",{left:i,top:u})}function a(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r),u=l(r);n("end",{top:u,left:i})}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",a)}return s}const wc=O({__name:"SvPanel",props:{modelValue:{type:wn,required:!0}},setup(n){const e=n,t=de(),l=de(),s=$e(r()),o=L(()=>({left:s.left+"px",top:s.top+"px"})),a=kc((i,u)=>{i=="end"&&(s.top=u.top,s.left=u.left);const d=t.value,m=l.value,h=(u.left+m.offsetWidth/2)/d.offsetWidth*100,_=100-(u.top+m.offsetHeight)/d.offsetHeight*100;e.modelValue.setSaturation(h),e.modelValue.setValue(_)});function r(){const i=t.value,u=l.value;if(i==null||u==null)return{top:-6,left:-6};const d=e.modelValue.s,h=(100-e.modelValue.v)/100*i.offsetHeight,_=d/100*i.offsetWidth;return{top:h-u.offsetHeight/2,left:_-u.offsetWidth/2}}return Qt(()=>{const i=r();s.top=i.top,s.left=i.left}),(i,u)=>(S(),R("div",{class:g(i.classes.svPanel),onPointerdown:u[0]||(u[0]=(...d)=>y(a)&&y(a)(...d)),ref_key:"svPanelRef",ref:t},[f("div",{class:g(i.classes.thumb),style:K(o.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Cc="_svPanel_1sv6o_2",Rc="_thumb_1sv6o_10",Lc={svPanel:Cc,thumb:Rc},Nc={classes:Lc},Ic=B(wc,[["__cssModules",Nc]]),xc=O({__name:"HueSlider",props:{modelValue:{type:wn,required:!0}},setup(n){const e=n,t=ie(-6),l=de(),s=de(),o=mo((r,i)=>{r=="end"&&(t.value=i);const u=l.value,d=s.value,m=Math.round((i+d.offsetWidth/2)/u.offsetWidth*360);e.modelValue.setHue(m)});function a(){const r=l.value,i=s.value;if(r==null||i==null)return-6;const u=e.modelValue.h;return Math.round(u/360*r.offsetWidth)-i.offsetWidth/2}return Qt(()=>{t.value=a()}),(r,i)=>(S(),R("div",{class:g(r.classes.hue),onPointerdown:i[0]||(i[0]=(...u)=>y(o)&&y(o)(...u)),ref_key:"hueRef",ref:l},[f("div",{class:g(r.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),Ac="_hue_1ozoc_2",qc="_thumb_1ozoc_10",Dc={hue:Ac,thumb:qc},$c={classes:Dc},Oc=B(xc,[["__cssModules",$c]]),Mc=O({__name:"AlphaSlider",props:{modelValue:{type:wn,required:!0}},setup(n){const e=n,t=ie(-6),l=de(),s=de(),o=mo((r,i)=>{r=="end"&&(t.value=i);const u=l.value,d=s.value,m=Math.round((i+d.offsetWidth/2)/u.offsetWidth*100);e.modelValue.setAlpha(m)});function a(){const r=l.value,i=s.value;if(r==null||i==null)return-6;const u=e.modelValue.a;return Math.round(u/100*r.offsetWidth)-i.offsetWidth/2}return Qt(()=>{t.value=a()}),(r,i)=>(S(),R("div",{class:g(r.classes.alpha),onPointerdown:i[0]||(i[0]=(...u)=>y(o)&&y(o)(...u)),ref_key:"alphaRef",ref:l},[f("div",{class:g(r.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),Pc="_alpha_1x8jd_2",Vc="_thumb_1x8jd_26",Bc={alpha:Pc,thumb:Vc},Fc={classes:Bc},zc=B(Mc,[["__cssModules",Fc]]),Uc=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function Hc(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function Gc(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const yl={isSupport:Hc,open:Gc},Wc=["title","onClick"],Yc=["title","onClick"],_l="quickprint-recent-use-colors",Xc=O({__name:"index",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,s=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],o=ie(new wn(l.modelValue)),a=de(),r=de(),i=ie(x()),u=yl.isSupport(),d=ie("hex"),m=L(()=>{const E=l.modelValue;return E?{backgroundColor:E}:null}),h=L(()=>{const E=o.value,{r:N,g:w,b:I}=E.rgb();return{"--hue-channel-color":`hsl(${E.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${N}, ${w}, ${I}, 0)`,"--alpha-channel-color-b":`rgba(${N}, ${w}, ${I}, 1)`}}),_=L({get(){return o.value.toString(d.value)},set(E){o.value.setColor(E)}});function v(){var E;(E=a.value)==null||E.close()}function c(E){E!=null&&(t("update:modelValue",E),t("select",E),C(E),v())}function b(){t("update:modelValue",void 0),t("select",void 0),v()}function k(){yl.open().then(E=>c(E))}function x(){const E=localStorage.getItem(_l);if(E==null||E=="")return[];const N=hn(E);return N==null?[]:Array.isArray(N)?N:[]}function C(E){const N=i.value,w=N.indexOf(E);w>=0&&N.splice(w,1),N.length>10&&N.pop(),N.unshift(E),localStorage.setItem(_l,JSON.stringify(N))}function T(){t("update:modelValue",o.value.toString(d.value)),t("select",o.value.toString(d.value)),v()}return Qn(()=>l.modelValue,()=>o.value.setColor(l.modelValue)),(E,N)=>(S(),Z(y(Ql),{class:g(E.classes.colorPicker),onMousedown:N[7]||(N[7]=ee(()=>{},["prevent"])),ref_key:"popoverRef",ref:a},{popover:ge(()=>[f("div",{class:g(E.classes.colorPickerPanel)},[f("div",{class:g(E.classes.presetPanel)},[f("div",{class:g(E.classes.presetTools)},[f("button",{type:"button",class:g(E.classes.clearBtn),onClick:b},[f("span",{class:g(E.classes.none)},null,2),N[8]||(N[8]=f("span",null,"无颜色",-1))],2),y(u)?(S(),R("button",{key:0,type:"button",class:g(E.classes.indicator),onClick:k},[p(y($),{icon:"icon-eye-dropper"}),N[9]||(N[9]=f("span",null,"拾色器",-1))],2)):U("",!0)],2),f("div",{class:g(E.classes.colourAtla)},[(S(!0),R(j,null,re(y(Uc),w=>(S(),R("div",{style:K({backgroundColor:w}),title:w,class:g(E.classes.color),onClick:I=>c(w)},null,14,Wc))),256))],2),f("div",{class:g(E.classes.recentColors)},"最近使用",2),f("div",{class:g(E.classes.colourAtla)},[(S(),R(j,null,re(10,w=>f("div",{key:w,title:i.value[w-1],style:K({backgroundColor:i.value[w-1]}),class:g(E.classes.color),onClick:I=>c(i.value[w-1])},null,14,Yc)),64))],2)],2),f("div",{class:g(E.pacls.panel),style:K(h.value)},[p(Ic,{class:g(E.pacls.sv),modelValue:o.value,"onUpdate:modelValue":N[1]||(N[1]=w=>o.value=w)},null,8,["class","modelValue"]),f("div",{class:g(E.pacls.sliders)},[p(Oc,{class:g(E.pacls.hua),modelValue:o.value,"onUpdate:modelValue":N[2]||(N[2]=w=>o.value=w)},null,8,["class","modelValue"]),p(zc,{modelValue:o.value,"onUpdate:modelValue":N[3]||(N[3]=w=>o.value=w)},null,8,["modelValue"]),f("div",{class:g(E.pacls.preview)},[f("div",{class:g(E.pacls.previewColor),style:K({backgroundColor:o.value.toRGB()})},null,6)],2)],2),f("div",{class:g(E.pacls.tools)},[p(y(J),{options:s,teleport:"none",modelValue:d.value,"onUpdate:modelValue":N[4]||(N[4]=w=>d.value=w),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),_e(f("input",{type:"text","onUpdate:modelValue":N[5]||(N[5]=w=>_.value=w),onMousedown:N[6]||(N[6]=ee(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Ie,_.value]]),f("button",{type:"button",class:g(E.pacls.confirm),onClick:T},"确定",2)],2)],6)],2)]),default:ge(()=>[f("div",{class:g(E.classes.colorPickerInput),ref_key:"inputRef",ref:r},[Pe(E.$slots,"default",{},()=>[f("span",{class:g(E.classes.colorBlock),style:K(m.value)},null,6)]),n.showText?(S(),R("div",{key:0,class:g(E.classes.colorValue),onClick:N[0]||(N[0]=ee(()=>{},["stop"]))},W(n.modelValue),3)):U("",!0)],2)]),_:3},8,["class"]))}}),jc="_colorPicker_qpnrm_2",Zc="_colorPickerInput_qpnrm_6",Kc="_colorBlock_qpnrm_13",Jc="_colorValue_qpnrm_22",Qc="_colorPickerPanel_qpnrm_27",eu="_presetPanel_qpnrm_42",tu="_colourAtla_qpnrm_46",nu="_color_qpnrm_2",lu="_presetTools_qpnrm_73",ou="_clearBtn_qpnrm_79",su="_indicator_qpnrm_80",iu="_none_qpnrm_98",ru="_recentColors_qpnrm_129",au={colorPicker:jc,colorPickerInput:Zc,colorBlock:Kc,colorValue:Jc,colorPickerPanel:Qc,presetPanel:eu,colourAtla:tu,color:nu,presetTools:lu,clearBtn:ou,indicator:su,none:iu,recentColors:ru},cu="_panel_911zv_2",uu="_sv_911zv_7",du="_hua_911zv_11",fu="_sliders_911zv_15",pu="_tools_911zv_20",mu="_confirm_911zv_37 quickprint-text-btn",hu="_preview_911zv_44",gu="_previewColor_911zv_59",vu={panel:cu,sv:uu,hua:du,sliders:fu,tools:pu,confirm:mu,preview:hu,previewColor:gu},bu={classes:au,pacls:vu},lt=B(Xc,[["__cssModules",bu]]);class yu{constructor(e){F(this,"__v_skip",!0);F(this,"observer");F(this,"callbacks",[]);F(this,"handler");this.handler=yi((t,l)=>{for(const s of this.callbacks)s(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function _u(n,e){switch(n){case"fontSize":return e===be.DEFAULT?void 0:e;case"fontFamily":return e===se.DEFAULT?void 0:e;case"lineHeight":return e===ht.DEFAULT?void 0:e;default:return e}}const El="texteditor-const-node",Eu=Object.freeze({CONST:0});class Tu{constructor(e,t={}){F(this,"__v_skip",!0);F(this,"emitter",new pn);F(this,"container");F(this,"options");F(this,"observer");F(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new yu(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new pn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Yo(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ce(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await vn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=El,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,s=e[0],o=e[e.length-1];return!this.container.contains(s)||!this.container.contains(o)?!1:(t.removeAllRanges(),l.setStartBefore(s),l.setEndAfter(o),t.addRange(l),!0)}insertNode(e,t){var h;const l=this.getSelection();if(l==null)return!1;const{selection:s,range:o}=l;if(s.isCollapsed!=!0&&s.deleteFromDocument(),s.isCollapsed!=!0)return!1;const a=s.anchorNode;if(a==null)return!1;const r=this.container,i=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(i),a.parentNode===r||(h=a.parentNode)!=null&&h.contains(r))return o.insertNode(i),this.normalize(),this.focusAfterNode(i),!0;const u=a.parentNode;if(u==null)return!1;const d=u.textContent;if(d==null)return!1;if(s.anchorOffset==d.length)return r.insertBefore(i,u.nextSibling),this.normalize(),this.focusAfterNode(i),!0;const m=document.createElement("span");return m.textContent=d.slice(0,s.anchorOffset),u instanceof HTMLElement&&(m.style.cssText=u.style.cssText),u.textContent=d.slice(s.anchorOffset),r.insertBefore(i,u),r.insertBefore(m,i),this.normalize(),this.focusAfterNode(i),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:s}=t;return l.isCollapsed||l.deleteFromDocument(),s.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,s=e.endContainer,o={};return l===t?(o.startNode=t.childNodes[e.startOffset],o.startOffset=-1):(o.startNode=l.parentNode==t?l:l.parentNode,o.startOffset=e.startOffset),s===t?(o.endNode=t.childNodes[e.endOffset],o.endOffset=-1):(o.endNode=s.parentNode==t?s:s.parentNode,o.endOffset=e.endOffset),o}findNodesBetween(e,t){const l=[];let s=e.nextSibling;for(;s!=null&&s!==t;)l.push(s),s=s.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ce(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var d;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const s=t.range,{startNode:o,startOffset:a,endNode:r,endOffset:i}=this.normalizeRange(s);if(o===r){const m=o.textContent??"";if(o instanceof CharacterData){const v=document.createElement("span");return v.textContent=m.slice(a,i),s.deleteContents(),s.insertNode(v),[v]}const h=document.createElement("span");h.textContent=m.slice(0,a),this.inheritStyle(h,r);const _=document.createElement("span");return _.textContent=m.slice(a,i),this.inheritStyle(_,r),r.textContent=m.slice(i),e.insertBefore(_,r),e.insertBefore(h,_),[_]}const u=this.findNodesBetween(o,r);if(a>0){const m=o.textContent??"",h=document.createElement("span");h.textContent=m.slice(0,a),this.inheritStyle(h,o),o.textContent=m.slice(a),e.insertBefore(h,o)}if(i>=0&&i<=(((d=r.textContent)==null?void 0:d.length)??0)){const m=r.textContent??"";if(r instanceof HTMLElement){r.textContent=m.slice(0,i);const h=document.createElement("span");h.textContent=m.slice(i),this.inheritStyle(h,r),e.insertBefore(h,r.nextSibling),u.push(r)}else{const h=document.createElement("span");h.textContent=m.slice(0,i),e.replaceChild(h,r);const _=document.createTextNode(m.slice(i));e.insertBefore(_,r.nextSibling),u.push(h)}}return u.unshift(o),u}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let s=!0;const o=$l(e),a=_u(e,t);for(let r=0;r<l.length;r++){const i=l[r];if(i instanceof HTMLElement){this.matchElementStyle(i,o,a)||(s=!1);continue}const u=document.createElement("span");u.textContent=i.textContent,this.container.replaceChild(u,i),l[r]=u,s=!1}for(const r of l){if(s||a==null){this.removeElementStyle(r,o,a);continue}this.setElementStyle(r,o,a)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const s=e.style.getPropertyValue(t);return t==="text-decoration-line"?s.includes(l):s==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=vt.push(s,l);e.style.setProperty("text-decoration-line",o);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=vt.remove(s,l);ce(o)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",o);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+El)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const Su=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:se.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],ho=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],go=[{label:"默认",value:se.DEFAULT},...ho],Cn=[{label:"默认",value:se.DEFAULT},...Su,...ho],rl=[{label:"默认",value:be.DEFAULT},{label:"初号",value:be.SIZE_0+"pt",short:"56px"},{label:"小初",value:be.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:be.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:be.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:be.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:be.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:be.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:be.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:be.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:be.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:be.SIZE_5+"pt",short:"14px"},{label:"小五",value:be.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],vo=[{label:"默认",value:ht.DEFAULT},{label:"1.0",value:ht.TIMES_1,short:"单倍行距"},{label:"1.1",value:ht.TIMES_1_1},{label:"1.5",value:ht.TIMES_1_5},{label:"2.0",value:ht.TIMES_2,short:"两倍行距"}],ku=[{label:"无",value:sn.NONE},{label:"实线",value:Ct.SOLID},{label:"虚线",value:Ct.DASHED},{label:"点划线",value:Ct.DOTTED},{label:"双实线",value:Ct.DOUBLE},{label:"波浪线",value:Ct.WAVY}],wu=[{label:"默认",value:gt.AUTO},{label:"左对齐",value:gt.LEFT},{label:"居中对齐",value:gt.CENTER},{label:"右对齐",value:gt.RIGHT},{label:"两端对齐",value:gt.JUSTIFY}],Bn=[{label:"顶部对齐",value:Ye.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Ye.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Ye.BOTTOM,icon:"icon-vertical-align-bottom"}],Fn=[{label:"左对齐",value:tt.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:tt.CENTER,icon:"icon-align-center"},{label:"右对齐",value:tt.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:tt.JUSTIFY,icon:"icon-menu"}],Cu=O({__name:"ParagraphEditor",props:{element:{type:Xo,required:!0}},setup(n){const e=n,t=Ee(),l=de(),s=L(()=>e.element.isSelected!==!0?!1:t.state.selectMode===st.SINGLE);let o=null;const a=L(()=>Cn.map(E=>(E.style={fontFamily:E.value==se.DEFAULT?se.SONG:E.value},E)));function r(){}async function i(){if(o==null)return;const E=await sl({doc:t.doc}).catch(et);if(E==null)return;const N=it(E.value,t.doc.ds)??E.value,w={type:Eu.CONST,value:E.value,label:N};o.insertNode(w)}function u(){o==null||o.blur()}function d(){o==null||o.autosize()}function m(E){const N=e.element.ds.value,w=new Tu(E);return w.on("resize",I=>{var M;const A=(M=I.detail)==null?void 0:M.height;A!=null&&e.element.setHeight(A+2)}),w.watch(()=>{const I=w.getHTML(),A=e.element.ds.value;I!==A&&(e.element.ds.value=I,w.checkHeight())}),ce(N)||w.setHTML(N),w}function h(E){o==null||o.setStyle("fontFamily",E.value)}function _(E){o==null||o.setStyle("fontSize",E.value)}function v(E){o==null||o.setStyle("lineHeight",E.value)}function c(E){o==null||o.setStyle("backgroundColor",E)}function b(E){o==null||o.setStyle("color",E)}function k(){o==null||o.setStyle("fontWeight","700")}function x(){o==null||o.setStyle("fontStyle","italic")}function C(){o==null||o.setStyle("textDecorationLine","underline")}function T(){o==null||o.setStyle("textDecorationLine","line-through")}return Qn(()=>e.element.ds.value,E=>{o==null||o.getHTML()==E||o.setHTML(E)}),Qt(()=>{e.element.on("blur",u),o=m(l.value)}),Jn(()=>{e.element.off("blur",u),o&&o.cleanup()}),(E,N)=>(S(),R("div",{class:g(E.classes.paragraph),onPointerdown:N[2]||(N[2]=ee(()=>{},["stop"])),onContextmenu:ee(r,["stop","prevent"])},[f("div",{class:g(E.classes.indicator),onPointerdown:N[0]||(N[0]=(...w)=>y(t).onDragStart&&y(t).onDragStart(...w)),title:"选中/拖动段落"},null,34),s.value?(S(),R("div",{key:0,class:g(E.classes.toolbar),onMousedown:N[1]||(N[1]=ee(()=>{},["prevent"]))},[p(y(J),{onSelect:h,title:"字体",width:"60px",options:a.value,class:g(E.classes.tool),button:""},null,8,["options","class"]),p(y(J),{onSelect:_,title:"字号",width:"60px",options:y(rl),class:g(E.classes.tool),button:""},null,8,["options","class"]),p(y(J),{onSelect:v,title:"行高",width:"60px",options:y(vo),class:g(E.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),f("div",{class:g(E.classes.divider)},null,2),p(lt,{class:g(E.classes.tool),onSelect:c},{default:ge(()=>[f("div",{class:g(E.classes.colorIcon),title:"突出显示"},[p(y($),{icon:"icon-bg-color-b",size:"15px"}),f("div",{class:g(E.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(lt,{class:g(E.classes.tool),onSelect:b},{default:ge(()=>[f("div",{class:g(E.classes.colorIcon),title:"字体颜色"},[p(y($),{icon:"icon-font",size:"15px"}),f("div",{class:g(E.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),f("button",{onClick:k,type:"button",title:"加粗",class:g(["quickprint-text-btn",E.classes.tool])},[p(y($),{icon:"icon-font-bold",size:"16px"})],2),f("button",{onClick:x,type:"button",title:"斜体",class:g(["quickprint-text-btn",E.classes.tool])},[p(y($),{icon:"icon-italic",size:"16px"})],2),f("button",{onClick:C,type:"button",title:"下划线",class:g(["quickprint-text-btn",E.classes.tool])},[p(y($),{icon:"icon-underline",size:"16px"})],2),f("button",{onClick:T,type:"button",title:"删除线",class:g(["quickprint-text-btn",E.classes.tool])},[p(y($),{icon:"icon-through-line",size:"16px"})],2),f("div",{class:g(E.classes.divider)},null,2),f("button",{class:"quickprint-text-btn",type:"button",onClick:i},[p(y($),{icon:"icon-insert-var",size:"16px"}),N[3]||(N[3]=f("span",null,"插入变量",-1))]),f("button",{class:"quickprint-text-btn",type:"button",onClick:d},[p(y($),{icon:"icon-colum-height",size:"16px"}),N[4]||(N[4]=f("span",null,"调整高度",-1))])],34)):U("",!0),f("div",{ref_key:"editorRef",ref:l,class:g(E.classes.editor)},null,2)],34))}}),Ru="_paragraph_1v2pj_2",Lu="_indicator_1v2pj_6",Nu="_editor_1v2pj_18",Iu="_toolbar_1v2pj_44",xu="_tool_1v2pj_44",Au="_colorIcon_1v2pj_66",qu="_colorIndicator_1v2pj_86",Du="_divider_1v2pj_95",$u={paragraph:Ru,indicator:Lu,editor:Nu,toolbar:Iu,tool:xu,colorIcon:Au,colorIndicator:qu,divider:Du},Ou={classes:$u},Mu=B(Cu,[["__cssModules",Ou]]),Rn=Object.freeze({title:"段落",type:X.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:Mu,config:{exclude:[ae.DATASOURCE,ae.BASIC,ae.OVERFLOW]},onCreate(){return me.create({type:X.PARAGRAPH,width:_t*4,height:yn*6})}}),bo=[En,Tn,Sn,kn,il,po,Rn],Pu=[En,Tn,Sn,kn,Rn],Vu={[X.TEXT]:En.editor,[X.NUMBER]:Tn.editor,[X.DATE]:Sn.editor,[X.TABLE]:kn.editor,[X.TABLE_CELL]:il.editor,[X.PARAGRAPH]:Rn.editor},Bu={[X.TEXT]:En.config,[X.NUMBER]:Tn.config,[X.DATE]:Sn.config,[X.TABLE]:kn.config,[X.TABLE_CELL]:il.config,[X.TABLE_ROW]:po.config,[X.PARAGRAPH]:Rn.config},Bt=bo.reduce((n,e)=>(n[e.type]=e,n),{});function Fu(n){const e=bo.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function zu(n){return Reflect.get(Vu,n)}function Lt(n){return Reflect.get(Bu,n)}function Zt(n){var e;return((e=Bt[n])==null?void 0:e.title)??n}function Uu(n){var e;return(e=Bt[n])==null?void 0:e.icon}function Hu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function Gu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function Wu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Yu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Tl(n,e,t,l){const[s,o]=e.top>t.top?[t,e]:[e,t],a=s.top-l.top,r=o.bottom-s.top;return{top:a,left:n,height:r}}function Sl(n,e,t,l){const[s,o]=e.left>t.left?[t,e]:[e,t],a=s.left-l.left,r=o.right-s.left;return{top:n,left:a,width:r}}function kl(n,e){const t=n.find(i=>i.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,s=t.top+t.height,o=Math.min(t.top,e.top),r=Math.max(l,s)-o;t.top=o,t.height=r}function wl(n,e){const t=n.find(i=>i.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,s=t.left+t.width,o=Math.min(t.left,e.left),r=Math.max(l,s)-o;t.left=o,t.width=r}function Xu(n){const e=document.createElement("div");return n.appendChild(e),e}function ju(n,e){const t=[...e.querySelectorAll(":scope ."+G.GUIDE_LINE)];for(const l of n){const s=t.shift()??Xu(e);s.className=G.GUIDE_LINE,s.style.top=l.top+"px",s.style.left=l.left+"px",s.style.height=(l.height??1)+"px",s.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function Zu(n,e){const l=e.querySelectorAll(":scope ."+G.ELEMENT),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=[];for(const r of l){if(n==r)continue;const i=r.getBoundingClientRect();if(Math.abs(o.left-i.left)<=1||Math.abs(o.right-i.left)<=1){const u=i.left-s.left;kl(a,Tl(u,o,i,s))}if(Math.abs(o.left-i.right)<=1||Math.abs(o.right-i.right)<=1){const u=i.right-s.left;kl(a,Tl(u,o,i,s))}if(Math.abs(o.top-i.top)<=1||Math.abs(o.bottom-i.top)<=1){const u=i.top-s.top;wl(a,Sl(u,o,i,s))}if(Math.abs(o.bottom-i.bottom)<=1||Math.abs(o.top-i.bottom)<=1){const u=i.bottom-s.top;wl(a,Sl(u,o,i,s))}}ju(a,e)}function Ku(){const n=document.querySelectorAll("."+G.GUIDE_LINE);for(const e of n)e.remove()}const gn={create:_i(Zu,50),clean:Ku};async function Ju(n){await vn(),n&&Reflect.deleteProperty(n,bn)}async function Qu(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const o=document.createElement("div");o.className="quickprint-is-indicator",e.indicatorElement=o,document.body.appendChild(o)}const t=ed(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,s=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=s.left+"px",l.style.top=s.top-jl(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function ed(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Le.INSERT){const s=t.closest("."+G.PAGE);if(s==null)return null;const o=s.getBoundingClientRect();return{x:l?Nt(e.left-o.left):Math.round(e.left-o.left),y:l?Nt(e.top-o.top):Math.round(e.top-o.top),w:e.element.width,h:e.element.height}}return{x:l?Nt(e.left):Math.round(e.left),y:l?Nt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function td(n){return!(n.style.rotate&&!n.isSelected)}function nd(n){const e=new Pn({selector:{container:G.DROPPABLE},scale(t){return t.mode===Le.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,zl),o=Reflect.get(l.target,el);s===Le.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=s===Le.INSERT?s:Le.MOVE,l.elementType=o,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Le.INSERT){const o=Fu(l.elementType);l.element=o,l.ghost.style.width=o.width+"px",l.ghost.style.height=o.height+"px";return}const s=Reflect.get(l.target,Xe);if(s==null||!td(s))return t.preventDefault();l.element=s}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Le.INSERT&&(l.ghost.style.display="block"),l.mode===Le.MOVE&&Reflect.set(l.target,bn,tl.DRAG_ELEMENT),l.ghost.classList.add(G.DRAGGING),l.initDragElement=!0),Qu(n,l),l.dropTarget&&gn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;gn.clean(),l.ghost.classList.remove(G.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Le.INSERT&&(l.ghost.style.display="none"),l.mode==Le.MOVE&&Ju(l.target);const s=l.element;if(l.mode==Le.MOVE){s.setTop(l.top),s.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),n.selectElement(s),n.createSnapshot();return}if(l.dropTarget==null)return;const o=Reflect.get(l.dropTarget,Ul);if(o==null)return;const a=o instanceof Tt||o instanceof me?o:null;if(a==null)return;const r=l.dropTarget.getBoundingClientRect(),i=n.state.scale/100;s.setTop((l.top-r.top)/i),s.setLeft((l.left-r.left)/i),s.setWidth(s.width/i),s.setHeight(s.height/i),a.append(l.element),n.selectElement(s),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Cl="quickprint-history-0000",ld=1,Ze="snapshot",cn="health",Rl="owner",Ue="INDEX_OWNER",od=15*60*1e3,sd=10*60*1e3;function id(){const n={db:null,timer:null,promise:null};async function e(){const d=await i(cn,"readwrite");if(d==null)return n.timer=o(),!1;const m=[],h=d.openCursor();h.onsuccess=async function(_){const v=_.target.result;if(v==null){t(m),n.timer=o(),Ne.debug("History","已检查无效快照");return}const c=v.value;c!=null&&Date.now()-c.timestamp>od&&m.push(c),v.continue()},h.onerror=function(_){console.error(_),n.timer=o()}}async function t(d){const m=await Promise.allSettled(d.map(h=>l(h.owner)));for(let h=0;h<m.length;h++){const _=m[h];_.status==="rejected"||_.value!==!0||s(d[h].id)}}async function l(d){const m=await i(Ze,"readwrite");return m==null?!1:new Promise(h=>{const _=m.index(Ue).openCursor(IDBKeyRange.only(d));_.onsuccess=function(v){const c=v.target.result;if(c==null)return h(!0);c.delete(),c.continue()},_.onerror=function(v){console.error(v),h(!1)}})}async function s(d){const m=await i(cn,"readwrite");return m==null?!1:Yt(m.delete(d)).then(()=>!0).catch(h=>(console.log(h),!1))}function o(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),sd)}function a(){return new Promise(d=>{const m=indexedDB.open(Cl,ld);m.onupgradeneeded=h=>{const v=h.target.result,c=v.createObjectStore(cn,{keyPath:"id",autoIncrement:!0}),b=v.createObjectStore(Ze,{keyPath:"id",autoIncrement:!0});c.createIndex(Ue,Rl),b.createIndex(Ue,Rl)},m.onsuccess=h=>{const _=h.target;n.db=_.result,Ne.debug("History",`已连接数据库【${Cl}】`),d(n.db)},m.onerror=function(h){console.error(h),n.db=null,d(null)}})}function r(){return n.promise==null?Promise.resolve(n.db):n.promise}async function i(d,m="readonly"){const h=await r();if(h==null)return null;try{return h.transaction(d,m).objectStore(d)}catch(_){return console.error(_),null}}function u(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=a(),n.timer=o(),e(),{ready:r,findStore:i,cleanup:u}}function Yt(n){return new Promise((e,t)=>{n.onsuccess=function(l){const s=l.target;e(s.result)},n.onerror=function(l){console.error(l),t()}})}const rd=5*60*1e3,ft=id();var He,De,un,zn,yo;class ad{constructor(e,t={}){ze(this,De);F(this,"state");F(this,"owner");ze(this,He);this.state=e,this.owner=t.owner??jo(Zo.HISTORY_OWNER),we(this,De,zn).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await ft.findStore(Ze,"readwrite");if(l==null)return!1;await we(this,De,yo).call(this,l);const s=this.state.index+1,o={index:s,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await Yt(l.put(o)).catch(et)==null?!1:(this.state.index=s,this.state.count=s+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const s=await ft.findStore(Ze,"readwrite");return!(s==null||(l.data=JSON.stringify(e),await Yt(s.put(l)).catch(et)==null))}async getCurrentSnapshot(){const e=await ft.findStore(Ze);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=a=>{const r=a.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return s(i);r.continue()},o.onerror=function(a){console.error(a),s(null)}})}async getPrevSnapshot(){const e=await ft.findStore(Ze);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=a=>{const r=a.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return this.state.index=t,s(r.value);r.continue()},o.onerror=function(a){console.error(a),s(null)}})}async getNextSnapshot(){const e=await ft.findStore(Ze);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"next");o.onsuccess=a=>{const r=a.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return this.state.index=t,s(r.value);r.continue()},o.onerror=function(a){console.error(a),s(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await ft.findStore(Ze);if(e==null)return[];const t=this.owner;return new Promise(l=>{const s=e.index(Ue).openCursor(IDBKeyRange.only(t),"prev"),o=[];s.onsuccess=a=>{const r=a.target.result;if(r==null)return l(o);const i=r.value;if(i.owner!=t)return r.continue();o.push(i),r.continue()},s.onerror=function(a){console.error(a),l([])}})}cleanup(){ke(this,He)&&(clearTimeout(ke(this,He)),ut(this,He,null))}}He=new WeakMap,De=new WeakSet,un=function(){ut(this,He,setTimeout(()=>we(this,De,zn).call(this),rd))},zn=async function(){ke(this,He)&&clearTimeout(ke(this,He));const e=await ft.findStore(cn,"readwrite");if(e==null)return we(this,De,un).call(this);const t=await Yt(e.index(Ue).get(this.owner)).catch(et);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),we(this,De,un).call(this)}t.timestamp=Date.now(),await Yt(e.put(t)).catch(et),we(this,De,un).call(this)},yo=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const s=this.owner;return new Promise(o=>{const a=e.index(Ue).openCursor(IDBKeyRange.only(s),"prev");a.onsuccess=function(r){const i=r.target.result;if(i==null)return o(!0);const u=i.value;if(u.owner!=s)return i.continue();if(u.index>t){i.delete(),i.continue();return}o(!0)},a.onerror=function(r){console.error(r),o(!1)}})};function cd(n){const e=new ad($e({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function s(d){return e.createSnapshot(n.value,d)}function o(d){return e.replaceSnapshot(n.value,d)}async function a(){const d=await e.getPrevSnapshot();if(d==null)return!1;const m=hn(d.data);return m==null?!1:(n.value=ve.create(m),!0)}async function r(){const d=await e.getNextSnapshot();if(d==null)return!1;const m=hn(d.data);return m==null?!1:(n.value=ve.create(m),!0)}function i(){return e.list()}function u(){e.cleanup()}return s(),{allowRedo:l,allowUndo:t,createSnapshot:s,undo:a,redo:r,list:i,cleanup:u,replaceSnapshot:o}}class ud{constructor(e){F(this,"moved",!1);F(this,"position");F(this,"top",0);F(this,"left",0);F(this,"width",0);F(this,"height",0);F(this,"initX",0);F(this,"initY",0);F(this,"indicator");F(this,"container");F(this,"originalEvent");F(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var $t,Ot,at,_o,Eo,To;const Te=class Te extends pn{constructor(t={}){var l,s,o;super();ze(this,at);F(this,"context",null);F(this,"selector");F(this,"scale");F(this,"onResizeStart");ze(this,$t);ze(this,Ot);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??G.PAGE,element:((s=t.selector)==null?void 0:s.element)??G.RESIZEABLE,indicator:((o=t.selector)==null?void 0:o.indicator)??G.RESIZEABLE_INDICATOR},this.onResizeStart=we(this,at,_o).bind(this),ut(this,$t,we(this,at,Eo).bind(this)),ut(this,Ot,we(this,at,To).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",ke(this,$t)),window.removeEventListener("pointerup",ke(this,Ot)),this.context=null}};$t=new WeakMap,Ot=new WeakMap,at=new WeakSet,_o=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Ne.warn(Te.TAG_NAME,"未找到的可调整元素");const s=Reflect.get(l,Hl);if(s==null)return Ne.warn(Te.TAG_NAME,"未找到的可调整元素");const o=l.closest("."+this.selector.element);if(o==null)return Ne.warn(Te.TAG_NAME,"未找到的可调整元素");const a=Xl(o,this.selector.container);this.context=new ud({event:t,indicator:l,target:o,container:a,position:s});const r=this.createEvent("before-resizestart",this.context);if(this.dispatch(r).defaultPrevented)return Ne.warn(Te.TAG_NAME,"已取消调整");if(this.context.container==null)return Ne.warn(Te.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const i=this.createEvent("resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Ne.warn(Te.TAG_NAME,"已取消调整");window.addEventListener("pointermove",ke(this,$t)),window.addEventListener("pointerup",ke(this,Ot))},Eo=function(t){const l=this.context;if(l==null)return;const s=l.position,o=this.normalizeScale(),a=l.container.getBoundingClientRect(),r=l.target.getBoundingClientRect();if(s&Wt.TOP){const u=Math.max((r.bottom-t.clientY)/o,Te.MIN_LENGTH);l.top=(r.bottom-a.top)/o-u,l.height=u}if(s&Wt.BOTTOM&&(l.height=Math.max((t.clientY-r.top)/o,Te.MIN_LENGTH)),s&Wt.LEFT){const u=Math.max((r.right-t.clientX)/o,Te.MIN_LENGTH);l.left=(r.right-a.left)/o-u,l.width=u}s&Wt.RIGHT&&(l.width=Math.max((t.clientX-r.left)/o,Te.MIN_LENGTH));const i=this.createEvent("resizing",l);this.dispatch(i).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},To=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("resizeend",l);this.dispatch(s).defaultPrevented||this.reset()},F(Te,"TAG_NAME","quickprint-resizeable"),F(Te,"MIN_LENGTH",12);let Un=Te;async function dd(n,e){if(await Promise.resolve(),e.indicatorElement==null){const r=document.createElement("div");r.className="quickprint-is-indicator",e.indicatorElement=r,document.body.appendChild(r)}const t=n.doc.useGrid,l=t?Nt(e.width):Math.round(e.width),s=t?Nt(e.height):Math.round(e.height),o=e.indicatorElement,a=e.target.getBoundingClientRect();o.style.display="block",o.style.left=a.left+"px",o.style.top=a.top-jl(e.element)+"px",o.textContent=`x:${e.top},y:${e.left},w:${l},h:${s}`}function fd(n){const e=new Un({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,Xe);if(s==null)return t.preventDefault();l.element=s}),e.on("resizing",t=>{const l=t.detail;l!=null&&(dd(n,l),gn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const s=l.element;s.setTop(l.top),s.setLeft(l.left),s.setWidth(l.width),s.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),gn.clean()}),n.onResizeStart=e.onResizeStart,e}function pd(n){function e(a){const r=document.activeElement,i=a.target;return r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r.isContentEditable===!0||i.closest(".quickprint-text-editor")!=null}function t(){const a=n.doc.firstPage;if(n.state.selectMode===pe.PAGE){const r=n.state.selectedPage;return r==null?a:n.doc.findPage(r)??a}if(n.state.selectMode===pe.ELEMENT){const r=n.getSelectedElements()[0];return r==null?a:r.page??a}return a}function l(a){if(!(e(a)||Ko()))switch(a.key){case"Delete":case"Backspace":return a.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(a.ctrlKey)return a.preventDefault(),n.history.redo();case"Z":case"z":if(a.ctrlKey)return a.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const r=n.getSelectedElements();if(r.length==0)return;a.preventDefault(),a.stopPropagation();const i=a.key==="ArrowUp"?-1:1,u=r.map(d=>d.setTop(d.top+i,!0)?d:null).filter(d=>d!=null);u.length>0&&n.replaceSnapshot("top",u);return}case"ArrowLeft":case"ArrowRight":{const r=n.getSelectedElements();if(r.length==0)return;a.preventDefault(),a.stopPropagation();const i=a.key==="ArrowLeft"?-1:1,u=r.map(d=>d.setLeft(d.left+i,!0)?d:null).filter(d=>d!=null);u.length>0&&n.replaceSnapshot("left",u);return}case"P":case"p":if(a.ctrlKey)return a.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(a.ctrlKey)return a.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(a.ctrlKey){a.preventDefault();const i=n.doc.pages.reduce((u,d)=>u.concat(d.children),[]);return n.multiSelectElements(i)}case"C":case"c":{const r=n.getSelectedElements();if(a.ctrlKey&&r.length>0)return a.preventDefault(),n.clipboard.writeElement(r)}case"V":case"v":if(a.ctrlKey)return n.clipboard.readElement().then(r=>{if(r.length==0)return;const i=t();for(const u of r)u.setLeft(u.left+8),u.setTop(u.top+8),i.append(u);n.createSnapshot()})}}function s(){window.addEventListener("keydown",l)}function o(){window.removeEventListener("keydown",l)}return{enable:s,disable:o}}const nn="openprint:element,";function md(n){function e(){return navigator.clipboard.readText().catch(i=>(console.log(i),null))}function t(i){return navigator.clipboard.writeText(i).catch(u=>{console.log(u)})}async function l(){const i=await e();if(i==null||!i.startsWith(nn))return[];t("");const u=hn(Qo(i.slice(nn.length)),[]);return u.length===0?[]:u.map(d=>(delete d.id,me.create(d))).sort(me.sort)}function s(i){const u=`${nn}${Jo(JSON.stringify(i))}`;return t(u)}async function o(){const i=await e();return typeof i=="string"&&i.startsWith(nn)}function a(){}function r(i){}return{readElement:l,writeElement:s,hasElement:o,readStyle:a,writeStyle:r}}const So=Symbol();function hd(){return{panel:{left:!0,right:!0},scale:100,selectedType:pe.NONE,selectedPage:void 0,selectMode:st.SINGLE,selected:[]}}function gd(n,e){const t=$e(hd()),l=cd(n),o={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:i,selectPage:m,selectElement:h,resetSelectedElement:_,deleteSelectedElement:v,multiSelectElements:c,zoomIn:k,zoomOut:b,toggleBackground:x,toggleElementPanel:C,toggleConfigPanel:T,getSelectedElements:u,getSelectedPage:d,cleanup:N,replaceSnapshot:E},a=nd(o),r=fd(o);o.shortcut=pd(o),o.createSnapshot=l.createSnapshot,o.clipboard=md();function i(w){o.document.value=w,o.history.createSnapshot()}function u(){const w=t.selected;return w.length==0?[]:w.map(I=>o.doc.findElement(I)).filter(I=>I!=null)}function d(){var I;const w=t.selectedPage;if(w!=null)return(I=n.value)==null?void 0:I.findPage(w)}function m(w){return _(),t.selectedPage=w.id,t.selectedType=pe.PAGE,!0}function h(w){t.selectMode=st.SINGLE,t.selectedType=pe.ELEMENT,t.selectedPage=void 0;const I=u();for(const A of I)A.id!==w.id&&A.blur();return w.focus(),t.selected=[w.id],!0}function _(){const w=u();for(const I of w)I.blur();return t.selected=[],t.selectedType=pe.NONE,!0}function v(){if(t.selectedType!=pe.ELEMENT||t.selected.length==0)return!1;let w=!1;const I=u();for(const A of I)A.remove()&&(w=!0);return w&&o.history.createSnapshot(),!0}function c(w){t.selectMode=st.MULTIPLE,t.selectedType=pe.ELEMENT,t.selectedPage=void 0;const I=u();for(const A of I)A.blur();for(const A of w)A.focus();return t.selected=w.map(A=>A.id),!0}function b(){const w=t.scale??100,I=Ut.indexOf(w);return I<0?(t.scale=100,!1):I>=Ut.length-1?!1:(t.scale=Ut[I+1],!0)}function k(){const w=t.scale??100,I=Ut.indexOf(w);return I<0?(t.scale=100,!1):I==0?!1:(t.scale=Ut[I-1],!0)}function x(){const I=o.doc.attributes.grid==null?!0:void 0;o.doc.attributes.grid=I}function C(){o.state.panel.left=!o.state.panel.left}function T(){o.state.panel.right=!o.state.panel.right}function E(w,I){const A=I??o.doc,M=Array.isArray(A)?"element":A instanceof ve?"document":A instanceof Tt?"page":"element",z=Array.isArray(A)?A.map(ne=>ne.id).join(","):A.id,P=`${M}:${z}:${w}`;return l.replaceSnapshot({action:P})}function N(){a.cleanup(),r.cleanup(),l.cleanup(),o.shortcut.disable(),o.doc.cleanup()}return o.shortcut.enable(),o.selectPage(n.value.firstPage),Bl(So,o),Jn(N),o}function Ee(){return Vl(So)}const vd=O({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=xe("classes"),l=Ee(),s=L(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),o=L(()=>{const c=e.page.id,b=l.doc.pages.find(k=>k.id===c);return b==null?0:e.direction=="horizontal"?b.width:b.height}),a=L(()=>{const c=o.value,b=[];for(let k=0;k<=c;k+=10)b.push(k/10);return b}),r=L(()=>{const c=o.value,b=[];for(let k=0;k<=c;k+=2.5)b.push(k);return b}),i=L(()=>{const c=l.getSelectedElements();return c.length==1?c[0]:null}),u=L(()=>e.direction==="horizontal"?{height:"100%",width:o.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:o.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),d=L(()=>{const c=i.value;if(c==null)return 0;if(c.type==="TableCell"){const b=c.parent;if(b==null)return 0;const k=b.parent;return b==null?0:k.top+b.offsetTop}if(c.type==="TableRow"){const b=c.parent;return b==null?0:b.top+c.offsetTop}return c.top}),m=L(()=>{const c=i.value;if(c==null)return 0;if(c.type==="TableCell"){const b=c.parent;if(b==null)return 0;const k=b.parent;return b==null?0:k.left+c.offsetLeft}if(c.type==="TableRow"){const b=c.parent;return b==null?0:b.left}return c.left});function h(c,b){return e.direction==="horizontal"?{left:c*(e.scale/100)+"mm",height:(b-2)%4==0?"8px":"4px"}:{top:c*(e.scale/100)+"mm",width:(b-2)%4==0?"8px":"4px"}}function _(c){return e.direction==="horizontal"?{left:c*(e.scale/100)+"cm"}:{top:c*(e.scale/100)+"cm"}}function v(c){return e.direction==="horizontal"?{left:m.value*(e.scale/100)+"px",width:c.width*(e.scale/100)+"px",height:"100%"}:{top:d.value*(e.scale/100)+"px",height:c.height*(e.scale/100)+"px",width:"100%"}}return(c,b)=>(S(),R("div",{class:g(s.value)},[f("div",{class:g(y(t).ruler),style:K(u.value)},[i.value?(S(),R("div",{key:0,class:g(y(t).selected),style:K(v(i.value))},null,6)):U("",!0),(S(!0),R(j,null,re(r.value,(k,x)=>(S(),R("div",{key:k,class:g(y(t).scale),style:K(h(k,x))},null,6))),128)),(S(!0),R(j,null,re(a.value,k=>(S(),R("div",{class:g(y(t).number),style:K(_(k))},W(k),7))),256))],6)],2))}}),bd="_horizontalRuler_170u5_2",yd="_verticalRuler_170u5_15",_d="_ruler_170u5_27",Ed="_scale_170u5_32",Td="_number_170u5_46",Sd="_selected_170u5_71",kd={horizontalRuler:bd,verticalRuler:yd,ruler:_d,scale:Ed,number:Td,selected:Sd},wd={classes:kd},Ll=B(vd,[["__cssModules",wd]]),Cd=["title"],ln=8,Rd=O({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,s=xe("classes"),o={},a=Ee(),r=L(()=>({top:Math.round(t.top*t.zoom)+"px"}));function i(h){if(h.button!=0||t.disabled===!0)return;const _=h.target.closest("."+s.dragLine);_!=null&&(h.stopPropagation(),o.init=!1,o.target=_,o.parent=_.offsetParent,o.target.setPointerCapture(h.pointerId),window.addEventListener("pointermove",u),window.addEventListener("pointerup",d))}function u(h){h.preventDefault();const _=m(o.parent);let v=h.clientY-_.top;v<0&&(v=0),v>_.height&&(v=_.height),t.min>0&&v<t.min+ln&&(v=t.min+ln),t.max>0&&v>t.max-ln&&(v=t.max-ln),o.target.style.top=v/(a.state.scale/100)+"px",o.top=v,o.init=!0}function d(h){o.init===!0&&l("move",{top:o.top/(a.state.scale/100)}),o.target.releasePointerCapture(h.pointerId),window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",d)}function m(h){return h instanceof HTMLElement?h.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(h,_)=>(S(),R("div",{class:g({[y(s).dragLine]:!0,[y(s).disabled]:n.disabled}),style:K(r.value),onPointerdown:ee(i,["stop"]),title:n.title},null,46,Cd))}}),Ld="_dragLine_1m7rt_2",Nd="_disabled_1m7rt_26",Id={dragLine:Ld,disabled:Nd},xd={classes:Id},Nl=B(Rd,[["__cssModules",xd]]),Ad=O({__name:"Selection",setup(n,{expose:e}){const t=de(),l=de(),s=Vt("selectionRef"),o=de(),a=Ee();let r=[];function i(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function u(){const v=[],c=l.value;if(c==null)return v;const b=d(c);if(b.length==0)return v;const k=s.value;return b.forEach(x=>{if(!Cs(x,k)){x.classList.remove(G.SELECTED);return}const C=Reflect.get(x,Xe);C instanceof me&&(x.classList.add(G.SELECTED),v.push(C))}),v}function d(v){if(v.matches("."+G.ELEMENT)){const c=Reflect.get(v,Xe);if(c&&c.type===X.TABLE)return v.querySelectorAll(":scope td")}return v.querySelectorAll(`:scope .${G.PAGE} > .${G.SELECTABLE}`)}function m(v,c){const b=c.closest("."+G.PAPER);if(b==null)return;v.stopPropagation(),v.preventDefault();const k=i(),x=b.getBoundingClientRect();k.initialX=v.clientX,k.initialY=v.clientY,k.top=v.clientY-x.top,k.left=v.clientX-x.left,l.value=c,o.value=k,t.value=b,r=[],window.addEventListener("pointermove",h),window.addEventListener("pointerup",_)}function h(v){const c=o.value;if(c==null)return;v.stopPropagation(),v.preventDefault();const b=s.value;if(c.init!==!0){if(Math.abs(v.clientX-c.initialX)<4&&Math.abs(v.clientY-c.initialY)<4)return;b.setPointerCapture(v.pointerId),b.style.display="block",c.init=!0}const k=Math.abs(v.clientX-c.initialX),x=Math.abs(v.clientY-c.initialY),C=v.clientX<c.initialX?-k:0,T=v.clientY<c.initialY?-x:0;b.style.top=c.top+T+"px",b.style.left=c.left+C+"px",b.style.width=k+"px",b.style.height=x+"px",r=u()}function _(v){const c=o.value;if(c==null)return;c.init&&(v.stopPropagation(),v.preventDefault()),r.length>0&&a.multiSelectElements(r);const b=s.value;b.releasePointerCapture(v.pointerId),b.style.display="none",o.value=void 0,window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",_)}return e({onSelectStart:m}),(v,c)=>(S(),R("div",{ref_key:"selectionRef",ref:s,class:g(v.classes.selection),onClick:c[0]||(c[0]=ee(()=>{},["stop"]))},null,2))}}),qd="_selection_10jfe_2",Dd={selection:qd},$d={classes:Dd},Od=B(Ad,[["__cssModules",$d]]),Md={class:"quickprint-is-row"},Pd=["onClick"],Vd=O({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=xe("classes"),s=e,o=n,a=de(),r=L(()=>({height:o.height})),i=L({get(){return We(o.modelValue).num??void 0},set(v){if(v==""||es(v)||v<0){m(void 0);return}const c=We(o.modelValue);m(`${v}${c.unit}`)}}),u=L({get(){return We(o.modelValue).unit??Re.PX},set(v){const c=We(o.modelValue);m(`${c.num}${v}`)}});function d(v){const c=v===be.DEFAULT?void 0:v;s("update:modelValue",c)}function m(v){s("update:modelValue",v),_()}function h(v){const c=o.modelValue;return c==null&&v.value===be.DEFAULT?!0:c===v.value}async function _(){await Pt();const v=document.querySelector("."+l.fontSelected);v&&v.scrollIntoView({block:"nearest"})}return(v,c)=>(S(),R("div",{class:g(y(l).fontSize),style:K(r.value)},[f("div",Md,[_e(f("input",{type:"number",placeholder:"请输入",class:g(["quickprint-form-control",y(l).input]),min:0,"onUpdate:modelValue":c[0]||(c[0]=b=>i.value=b)},null,2),[[Ie,i.value]]),p(y(J),{width:"54px",options:t,modelValue:u.value,"onUpdate:modelValue":c[1]||(c[1]=b=>u.value=b)},null,8,["modelValue"])]),f("div",{class:g(["quickprint-is-fill-h quickprint-is-scrollable",y(l).fonts]),ref_key:"scrollRef",ref:a},[(S(!0),R(j,null,re(y(rl),b=>(S(),R("div",{key:b.value,class:g({[y(l).option]:!0,[y(l).fontSelected]:h(b)}),onClick:k=>d(b.value)},[f("span",null,W(b.label),1)],10,Pd))),128))],2)],6))}}),Bd="_input_9oh9n_2",Fd="_fontSize_9oh9n_8",zd="_fonts_9oh9n_13",Ud="_option_9oh9n_25",Hd="_fontSelected_9oh9n_34",Gd={input:Bd,fontSize:Fd,fonts:zd,option:Ud,fontSelected:Hd},Wd={classes:Gd},ko=B(Vd,[["__cssModules",Wd]]),Yd=["title"],Xd={key:0},jd="中文字体 AbBbCc",Zd=O({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=L(()=>Cn.map(c=>(c.style={fontFamily:c.value==se.DEFAULT?se.SONG:c.value},c))),l=L(()=>go.map(c=>(c.style={fontFamily:c.value==se.DEFAULT?se.SONG:c.value},c))),s=L({get(){const c=e.options.style.fontFamily;return ce(c)?se.DEFAULT:c},set(c){e.options.style.fontFamily=c==se.DEFAULT?void 0:c}}),o=L({get(){const c=e.options.style.enFontFamily;return ce(c)?se.DEFAULT:c},set(c){e.options.style.enFontFamily=c==se.DEFAULT?void 0:c}}),a=L({get(){const c=e.options.style.color;return ce(c)?Ce.DEFAULT:c},set(c){e.options.style.color=c==Ce.DEFAULT?void 0:c}}),r=L({get(){const c=e.options.style.highlightColor;return ce(c)?Ce.DEFAULT:c},set(c){e.options.style.highlightColor=c==Ce.DEFAULT?void 0:c}}),i=L({get(){return e.options.style.fontSize},set(c){const b=ce(c)?void 0:c;e.options.style.fontSize=b}}),u=L({get(){return e.options.style.fontWeight===700},set(c){e.options.style.fontWeight=c?700:void 0}}),d=L({get(){return e.options.style.fontStyle==="italic"},set(c){e.options.style.fontStyle=c?"italic":void 0}}),m=L({get(){return e.options.style.lineThrough===!0},set(c){e.options.style.lineThrough=c?!0:void 0}}),h=L({get(){const c=e.options.style.underline;if(c==null||c===!1)return sn.NONE;const b=e.options.style.underlineStyle;return ce(b)?Ct.SOLID:b},set(c){if(c===sn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=c}}),_=L({get(){const c=e.options.style.underlineColor;return ce(c)?Ce.DEFAULT:c},set(c){e.options.style.underlineColor=c==Ce.DEFAULT?void 0:c}}),v=L(()=>{const c=e.options.style,b={},k=nl(c.fontFamily,c.enFontFamily);k&&(b.fontFamily=k);const x=no(c);return x&&Ke(b,x),c.fontSize&&(b.fontSize=c.fontSize),c.fontWeight&&(b.fontWeight=c.fontWeight),c.color&&(b.color=c.color),c.fontStyle&&(b.fontStyle=c.fontStyle),c.highlightColor&&(b["--quickprint-variable-highlight-color"]=c.highlightColor),b});return(c,b)=>(S(),R("div",{class:g(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.font])},[f("div",{class:g(c.classes.fontFamily)},[f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"中文字体",2),f("div",{class:g(c.classes.content)},[p(y(J),{options:t.value,modelValue:s.value,"onUpdate:modelValue":b[0]||(b[0]=k=>s.value=k)},null,8,["options","modelValue"])],2)],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"颜色",2),p(lt,{modelValue:a.value,"onUpdate:modelValue":b[1]||(b[1]=k=>a.value=k)},{default:ge(()=>[f("div",{class:g(c.classes.indicator)},[f("div",{class:g({[c.classes.colorBlock]:!0,[c.classes.colorNone]:a.value===y(Ce).DEFAULT}),style:K({backgroundColor:a.value})},null,6),f("div",{class:g(c.classes.colorValue)},W(a.value==y(Ce).DEFAULT?"默认":a.value),3)],2)]),_:1},8,["modelValue"])],2),f("div",{class:g([c.classes.config,c.classes.fontSize])},[f("div",{class:g(c.classes.title)},"字号",2),p(ko,{modelValue:i.value,"onUpdate:modelValue":b[2]||(b[2]=k=>i.value=k),height:"144px"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"西文字体",2),f("div",{class:g(c.classes.content)},[p(y(J),{options:l.value,modelValue:o.value,"onUpdate:modelValue":b[3]||(b[3]=k=>o.value=k)},null,8,["options","modelValue"])],2)],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"前景色",2),p(lt,{modelValue:r.value,"onUpdate:modelValue":b[4]||(b[4]=k=>r.value=k)},{default:ge(()=>[f("div",{class:g(c.classes.indicator)},[f("div",{class:g({[c.classes.colorBlock]:!0,[c.classes.colorNone]:r.value===y(Ce).DEFAULT}),style:K({backgroundColor:r.value})},null,6),f("div",{class:g(c.classes.colorValue)},W(r.value==y(Ce).DEFAULT?"默认":r.value),3)],2)]),_:1},8,["modelValue"])],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"下划线",2),f("div",{class:g(c.classes.content)},[p(y(J),{modelValue:h.value,"onUpdate:modelValue":b[5]||(b[5]=k=>h.value=k),options:y(ku),width:"138px"},{option:ge(({option:k})=>[f("div",{title:k.label,class:g(c.classes.option)},[k.value==y(sn).NONE?(S(),R("div",Xd,W(k.label),1)):(S(),R("div",{key:1,class:g(c.classes.line),style:K({textDecorationStyle:k.value})},"--",6))],10,Yd)]),_:1},8,["modelValue","options"])],2)],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"线条颜色",2),f("div",{class:g(c.classes.content)},[p(lt,{modelValue:_.value,"onUpdate:modelValue":b[6]||(b[6]=k=>_.value=k),class:"quickprint-w-full"},{default:ge(()=>[f("div",{class:g(c.classes.indicator)},[f("div",{class:g({[c.classes.colorBlock]:!0,[c.classes.colorNone]:_.value===y(Ce).DEFAULT}),style:K({backgroundColor:_.value})},null,6),f("div",{class:g(c.classes.colorValue)},W(_.value==y(Ce).DEFAULT?"默认":_.value),3)],2)]),_:1},8,["modelValue"])],2)],2)],2),f("div",{class:g(c.classes.fieldset)},[b[13]||(b[13]=f("header",null,"效果",-1)),f("div",{class:g(c.classes.configs)},[f("label",{class:g(c.classes.checkbox)},[_e(f("input",{type:"checkbox","onUpdate:modelValue":b[7]||(b[7]=k=>u.value=k)},null,512),[[qn,u.value]]),b[10]||(b[10]=f("span",null,"粗体",-1))],2),f("label",{class:g(c.classes.checkbox)},[_e(f("input",{type:"checkbox","onUpdate:modelValue":b[8]||(b[8]=k=>d.value=k)},null,512),[[qn,d.value]]),b[11]||(b[11]=f("span",null,"斜体",-1))],2),f("label",{class:g(c.classes.checkbox)},[_e(f("input",{type:"checkbox","onUpdate:modelValue":b[9]||(b[9]=k=>m.value=k)},null,512),[[qn,m.value]]),b[12]||(b[12]=f("span",null,"删除线",-1))],2)],2)],2),f("div",{class:g(c.classes.fieldset)},[b[14]||(b[14]=f("header",null,"预览",-1)),f("div",{class:g(c.classes.preview)},[f("span",{style:K(v.value)},[f("span",{class:g({[c.classes.lineThrough]:n.options.style.lineThrough})},W(jd),2)],4)],2)],2)],2))}}),Kd="_font_16792_2",Jd="_fontFamily_16792_7",Qd="_config_16792_14",ef="_fontSize_16792_19",tf="_fieldset_16792_23",nf="_title_16792_39",lf="_content_16792_44",of="_indicator_16792_49",sf="_colorBlock_16792_69",rf="_colorValue_16792_80",af="_colorNone_16792_87",cf="_configs_16792_98",uf="_checkbox_16792_104",df="_option_16792_119",ff="_line_16792_127",pf="_preview_16792_138",mf="_lineThrough_16792_153",hf={font:Kd,fontFamily:Jd,config:Qd,fontSize:ef,fieldset:tf,title:nf,content:lf,indicator:of,colorBlock:sf,colorValue:rf,colorNone:af,configs:cf,checkbox:uf,option:df,line:ff,preview:pf,lineThrough:mf},gf={classes:hf},vf=B(Zd,[["__cssModules",gf]]),bf=["placeholder","min"],yf=O({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,s=L(()=>{const i=l.defaultUnit;return l.options.some(u=>u.value===i)?i:l.options[0].value}),o=L({get(){return We(l.modelValue).num},set(i){if(Yn(i)){const d=We(l.modelValue).unit??s.value;return r(`${i}${d}`)}r()}}),a=L({get(){return We(l.modelValue).unit??s.value},set(i){const d=We(l.modelValue).num??l.min;r(`${d}${i}`)}});function r(i=void 0){t("update:modelValue",i)}return(i,u)=>(S(),R("div",{class:g(i.classes.input)},[_e(f("input",{type:"number","onUpdate:modelValue":u[0]||(u[0]=d=>o.value=d),class:"quickprint-form-control",placeholder:n.placeholder,min:n.min},null,8,bf),[[Ie,o.value]]),p(y(J),{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=d=>a.value=d),class:g(i.classes.unit),options:n.options,width:"auto",border:"none"},null,8,["modelValue","class","options"])],2))}}),_f="_input_gtdaq_2",Ef="_unit_gtdaq_14",Tf={input:_f,unit:Ef},Sf={classes:Tf},mt=B(yf,[["__cssModules",Sf]]),kf="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",wf=O({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Re.NONE},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],l=[{label:"字符",value:Re.EM},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],s=[{label:"毫米",value:Re.MM},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],o=L({get(){return e.options.style.textAlign??tt.LEFT},set(c){const b=c===tt.LEFT?void 0:c;e.options.style.textAlign=b}}),a=L({get(){return e.options.style.textAlignLast??gt.AUTO},set(c){const b=c===gt.AUTO?void 0:c;e.options.style.textAlignLast=b}}),r=L({get(){return e.options.style.verticalAlign??Ye.MIDDLE},set(c){const b=c===Ye.MIDDLE?void 0:c;e.options.style.verticalAlign=b}}),i=v("top"),u=v("bottom"),d=v("left"),m=v("right"),h=L(()=>{const c=e.options.style,b={};return c.textAlign&&(b.textAlign=c.textAlign),c.textAlignLast&&(b.textAlignLast=c.textAlignLast),c.textIndent&&(b.textIndent=c.textIndent),c.lineHeight&&(b.lineHeight=c.lineHeight),Ke(b,oo(c.verticalAlign)),b}),_=L(()=>{var k,x,C,T;const c=e.options.style,b={};return b["--openprint-paragraph-preview-padding-top"]=((k=c.padding)==null?void 0:k.top)??"2px",b["--openprint-paragraph-preview-padding-right"]=((x=c.padding)==null?void 0:x.right)??"2px",b["--openprint-paragraph-preview-padding-bottom"]=((C=c.padding)==null?void 0:C.bottom)??"2px",b["--openprint-paragraph-preview-padding-left"]=((T=c.padding)==null?void 0:T.left)??"2px",b});function v(c){return L({get(){var b;return(b=e.options.style.padding)==null?void 0:b[c]},set(b){e.options.style.padding==null&&(e.options.style.padding={});const k=ce(b)?void 0:b;e.options.style.padding[c]=k}})}return(c,b)=>(S(),R("div",{class:g(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.paragraph])},[f("div",{class:g(c.classes.textAlign)},[f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"文本对齐",2),p(y(J),{options:y(Fn),modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=k=>o.value=k)},null,8,["options","modelValue"])],2),f("div",{class:g(c.classes.alignLast)},[f("div",{class:g(c.classes.configItemLabel)},"最后一行",2),p(y(J),{options:y(wu),modelValue:a.value,"onUpdate:modelValue":b[1]||(b[1]=k=>a.value=k)},null,8,["options","modelValue"])],2)],2),f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"垂直对齐",2),p(y(J),{options:y(Bn),modelValue:r.value,"onUpdate:modelValue":b[2]||(b[2]=k=>r.value=k)},null,8,["options","modelValue"])],2),f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"首行缩进",2),p(mt,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":b[3]||(b[3]=k=>n.options.style.textIndent=k),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"行高",2),p(mt,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":b[4]||(b[4]=k=>n.options.style.lineHeight=k),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.fieldset)},[b[9]||(b[9]=f("header",null,"内边距",-1)),f("div",{class:g(c.classes.padding)},[f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"上边距",2),p(mt,{modelValue:y(i),"onUpdate:modelValue":b[5]||(b[5]=k=>Ge(i)?i.value=k:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"下边距",2),p(mt,{modelValue:y(u),"onUpdate:modelValue":b[6]||(b[6]=k=>Ge(u)?u.value=k:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"左边距",2),p(mt,{modelValue:y(d),"onUpdate:modelValue":b[7]||(b[7]=k=>Ge(d)?d.value=k:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"右边距",2),p(mt,{modelValue:y(m),"onUpdate:modelValue":b[8]||(b[8]=k=>Ge(m)?m.value=k:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),f("div",{class:g(c.classes.fieldset)},[b[10]||(b[10]=f("header",null,"预览",-1)),f("div",{class:g(c.classes.preview),style:K(h.value)},[f("div",{style:K(_.value),class:g(c.classes.previewText)},[oe(W(kf)+" "),f("div",{class:g(c.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),Cf="_paragraph_1ex97_2",Rf="_fieldset_1ex97_7",Lf="_preview_1ex97_23",Nf="_textAlign_1ex97_34 quickprint-is-row",If="_configItem_1ex97_39 quickprint-is-row",xf="_alignLast_1ex97_44 quickprint-is-row",Af="_configItemLabel_1ex97_54",qf="_padding_1ex97_59",Df="_paddingItem_1ex97_66",$f="_paddingItemLabel_1ex97_72",Of="_previewText_1ex97_77",Mf="_paddingPreview_1ex97_86",Pf={paragraph:Cf,fieldset:Rf,preview:Lf,textAlign:Nf,configItem:If,alignLast:xf,configItemLabel:Af,padding:qf,paddingItem:Df,paddingItemLabel:$f,previewText:Of,paddingPreview:Mf},Vf={classes:Pf},Bf=B(wf,[["__cssModules",Vf]]),Ff=["onClick"],zf=O({__name:"Tabs",props:{active:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["switch"],setup(n,{emit:e}){const t=e;function l(s){t("switch",s)}return(s,o)=>(S(),R("div",{class:g(s.classes.tabs)},[(S(!0),R(j,null,re(n.tabs,a=>(S(),R("div",{key:a.value,class:g({[s.classes.tab]:!0,[s.classes.active]:n.active===a.value}),onClick:r=>l(a),onPointerdown:o[0]||(o[0]=ee(()=>{},["stop","prevent"]))},[f("span",null,W(a.label),1)],42,Ff))),128))],2))}}),Uf="_tabs_109u2_2",Hf="_tab_109u2_2",Gf="_active_109u2_41",Wf={tabs:Uf,tab:Hf,active:Gf},Yf={classes:Wf},wo=B(zf,[["__cssModules",Yf]]),Xf=O({__name:"index",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=Ve(),l=ie("font"),s=[{label:"字体",value:"font"},{label:"段落",value:"paragraph"}];function o(i){l.value=i.value}function a(){t==null||t.confirm(e.options)}function r(){t==null||t.cancel()}return(i,u)=>(S(),R("div",{class:g(i.classes.setting)},[f("div",{class:g(i.classes.header)},[f("div",{class:g(i.classes.headerLeft)},[p(y($),{icon:"icon-setting",size:"14px"}),f("span",{class:g(i.classes.title)},"元素",2),p(wo,{tabs:s,active:l.value,onSwitch:o},null,8,["active"])],2),y(t)?(S(),Z(y(jn),{key:0,instance:y(t)},null,8,["instance"])):U("",!0)],2),l.value==="font"?(S(),Z(vf,{key:0,options:e.options},null,8,["options"])):U("",!0),l.value==="paragraph"?(S(),Z(Bf,{key:1,options:e.options},null,8,["options"])):U("",!0),f("div",{class:g(i.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:a},"确定")],2)],2))}}),jf="_setting_16zk2_2",Zf="_header_16zk2_10",Kf="_headerLeft_16zk2_22",Jf="_title_16zk2_35",Qf="_tabs_16zk2_42",ep="_footer_16zk2_47",tp={setting:jf,header:Zf,headerLeft:Kf,title:Jf,tabs:Qf,footer:ep},np={classes:tp},lp=B(Xf,[["__cssModules",np]]);function op(n){return $e({style:Ol(n.style??{})})}function sp(n,e){n.style=Object.assign({},n.style,e.style)}const ip=Be(function(n){return Kt("元素设置",p(lp,{options:op(n)},null),{preset:"setting"}).promisify().then(e=>sp(n,e)).catch(Oe)});function rp(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){ip(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},fo(t,e.element)),Kn.open(n.clientX,n.clientY,{menus:l})}const ap=O({props:{element:{type:me,required:!0}},setup(n){const e=xe("classes"),t=Ee(),l=L(()=>{const m=n.element;m.state.key;const h={"--quickprint-element-top":m.top+"px","--quickprint-element-left":m.left+"px","--quickprint-element-width":m.width+"px","--quickprint-element-height":m.height+"px","z-index":m.zIndex};return a()&&(h.transform=`rotate(${m.style.rotate}deg)`),h}),s={TOP:[e.resizeTop,Rt.TOP],BOTTOM:[e.resizeBottom,Rt.BOTTOM],LEFT:[e.resizeLeft,Rt.LEFT],RIGHT:[e.resizeRight,Rt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Rt.BOTTOM_RIGHT]},o=[s.TOP,s.BOTTOM,s.LEFT,s.RIGHT,s.BOTTOM_RIGHT];function a(){const m=n.element;return m.style.rotate==0||m.style.rotate==null?!1:t.state.selectMode===st.SINGLE?!m.isSelected:!0}function r(m){const h=zu(m.type);if(h==null)return p("div",{class:e.unknown},[p("span",null,[oe("未知的打印元素")])]);const _={element:m,key:m.id+"_"+m.state.key};return Gu(m.type)?(_.onContextmenu=u,ot(h,_)):ot(h,_)}function i(m,h){h.stopPropagation();const _=h.target.closest("."+G.ELEMENT);_&&Reflect.get(_,bn)===tl.DRAG_ELEMENT||t.selectElement(m)}function u(m){m.stopPropagation(),m.preventDefault(),rp(m,n,t)}function d(){return!Wu(n.element.type)||a()?null:o.map(m=>{const h={class:[G.RESIZEABLE_INDICATOR,m[0]],["."+Hl]:m[1]};return p("div",ds(h,{onPointerdown:t.onResizeStart}),null)})}return function(){const m=n.element,h={["."+Xe]:m,["."+el]:m.type,key:m.id,class:{[G.ELEMENT]:!0,[G.DRAGGABLE]:!0,[G.RESIZEABLE]:!0,[G.SELECTED]:m.state.selected,[G.SELECTABLE]:Hu(m.type),["quickprint-is-"+m.type.toLowerCase()]:!0},style:l.value,onClick:i.bind(null,m)};return p("div",h,[r(m),d()])}}}),cp="_unknown_za8zh_2",up="_resizeTop_za8zh_12",dp="_resizeBottom_za8zh_20",fp="_resizeLeft_za8zh_28",pp="_resizeRight_za8zh_36",mp="_resizeBottomRight_za8zh_44",hp={unknown:cp,resizeTop:up,resizeBottom:dp,resizeLeft:fp,resizeRight:pp,resizeBottomRight:mp},gp={classes:hp},vp=B(ap,[["__cssModules",gp]]),Co=ql(()=>Dl(()=>import("./component-Zou40yy-.js"),__vite__mapDeps([3,4,1,5,6]))),bp=O({__name:"DocJson",props:{doc:{type:ve,required:!0}},setup(n){const e=n,t=Ve(),l=ie(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(s,o)=>(S(),Z(y(Co),{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=a=>l.value=a),language:"json",class:g(s.classes.json)},null,8,["modelValue","class"]))}}),yp="_json_9crpe_2",_p={json:yp},Ep={classes:_p},Tp=B(bp,[["__cssModules",Ep]]),Sp=Be(function(n){return Et("调试",p(Tp,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(et)});async function kp(n,e,t){const l=[];await t.clipboard.hasElement()&&l.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const o=n.target.closest("."+G.PAGE);if(o==null)return;const a=await t.clipboard.readElement();if(a.length==0)return;const r=o.getBoundingClientRect(),i=n.clientX-r.left-a[0].left,u=n.clientY-r.top-a[0].top;for(const d of a)d.setLeft(d.left+i),d.setTop(d.top+u),e.page.append(d);t.createSnapshot()}});const s=t.getSelectedElements();s.length>0&&l.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),l.length>0&&l.push({type:"divider"}),l.push({type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const o=e.page.children??[];t.multiSelectElements(o)}},{type:"divider"},{type:"menu",label:"调试",icon:"icon-bug",handler(){Sp(t).then(o=>{if(o==null)return;const a=ve.create(o);t.setDocument(a)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),Kn.open(n.clientX,n.clientY,{menus:l})}const wp=O({props:{doc:{type:ve,required:!0},page:{type:Tt,required:!0}},setup(n){const e=xe("classes"),t=Ee(),l=Vt("selectionRef"),s=Vt("paperRef"),o=ie(0),a=L(()=>n.page.width),r=L(()=>n.page.height);function i(x){x.stopPropagation();const C=x.target.closest("."+G.PAPER);C&&Reflect.get(C,bn)===tl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function u(){if(n.page.header.display===!1)return null;const x=n.page.header.height,C="page_header_"+o.value;return p(Nl,{title:"页眉",top:x,onMove:m,key:C},null)}function d(){if(n.page.footer.display===!1)return null;const x=Mt(r.value)-n.page.footer.height,C="page_footer_"+o.value;return p(Nl,{title:"页脚",top:x,onMove:h,key:C},null)}function m(x){n.page.setHeaderHeight(x.top),o.value++}function h(x){n.page.setFooterHeight(Mt(r.value)-x.top),o.value++}function _(x){x.stopPropagation(),x.preventDefault(),kp(x,n,t)}function v(){const x=n.doc.margins;if(x==null)return null;const C=[];return x.top&&C.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:x.top+"px"}},null)),x.bottom&&C.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:x.bottom+"px"}},null)),x.left&&C.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:x.left+"px"}},null)),x.right&&C.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:x.right+"px"}},null)),C.length>0?C:null}function c(){const x={["."+Ul]:n.page,key:n.page.id,style:{width:a.value+"mm",height:r.value+"mm"},class:{[G.PAGE]:!0,[G.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:_},C=n.page.children.map(T=>p(vp,{element:T},null));return p("div",x,[u(),C,d(),v()])}function b(x){if(x.button!==0)return;x.stopPropagation(),x.preventDefault();const T=x.target.closest("."+G.ELEMENT);if(T==null)return k(x,s.value);const E=Reflect.get(T,Xe);return E==null?k(x,s.value):E.type===X.TABLE?k(x,T):Yu(E.type)?t.onDragStart(x):k(x,s.value)}function k(x,C){var T;(T=l.value)==null||T.onSelectStart(x,C)}return function(){const x=t.state.scale/100,C={id:"@"+n.page.id,ref:"paperRef",class:{[G.PAPER]:!0,[G.SELECTED]:t.state.selectedPage===n.page.id},style:{width:a.value*x+"mm",height:r.value*x+"mm"},onPointerdown:b,onClick:i};return p("div",C,[c(),p(Od,{ref:"selectionRef"},null)])}}}),Cp="_paper_fdphx_2",Rp="_grid_fdphx_12",Lp="_marginHorizontalGuide_fdphx_21",Np="_marginVerticalGuide_fdphx_29",Ip={paper:Cp,grid:Rp,marginHorizontalGuide:Lp,marginVerticalGuide:Np},xp={classes:Ip},Ap=B(wp,[["__cssModules",xp]]),qp={class:"quickprint-is-fill-h quickprint-is-scrollable"},Dp="icon-zhanweifu",$p=O({__name:"Element",setup(n){const e=Ee();return(t,l)=>(S(),R("div",{class:g(t.classes.panel)},[f("div",{class:g(t.classes.header)},"可打印元素",2),f("div",qp,[f("div",{class:g(t.classes.grid)},[(S(!0),R(j,null,re(y(Pu),s=>(S(),R("div",Fl({key:s.type,class:[y(G).DRAGGABLE,t.classes.element],[`.${y(zl)||""}`]:y(Le).INSERT,[`.${y(el)||""}`]:s.type,onPointerdown:l[0]||(l[0]=(...o)=>y(e).onDragStart&&y(e).onDragStart(...o))}),[p(y($),{icon:s.icon??Dp,size:"16px",class:g(t.classes.icon)},null,8,["icon","class"]),f("span",null,W(s.title),1)],48))),128))],2)])],2))}}),Op="_panel_1p36j_2",Mp="_header_1p36j_8",Pp="_grid_1p36j_18",Vp="_element_1p36j_30",Bp="_icon_1p36j_45",Fp={panel:Op,header:Mp,grid:Pp,element:Vp,icon:Bp},zp={classes:Fp},Up=B($p,[["__cssModules",zp]]),Hp=["onClick"],Gp=O({__name:"SelectPath",setup(n){const e=Ee(),t=L(()=>{const o=e.state,a=[{id:e.doc.id,title:"文档",type:"document"}];if(o.selectedType===pe.PAGE){const r=e.getSelectedPage();if(r!=null){const i="页面"+(r.index+1);a.push({id:r.id,title:i,type:"page",data:r})}return a}if(o.selectedType===pe.ELEMENT){if(o.selectMode===st.MULTIPLE){const u=e.getSelectedElements();if(u.length===0)return a;let d=u[0];for(;d.parent;){const m=d.parent;if(m instanceof Tt){const h="页面"+(m.index+1);return a.push({id:m.id,title:h,type:"page",data:m}),a}d=m}return a}let r=e.getSelectedElements()[0];if(r==null)return a;const i=[{id:r.id,title:Zt(r.type),type:"element",data:r}];for(;r.parent;){const u=r.parent;if(u instanceof Tt){const d="页面"+(u.index+1);return i.unshift({id:u.id,title:d,type:"page",data:u}),a.concat(i)}i.unshift({id:u.id,title:Zt(u.type),type:"element",data:u}),r=u}}return a}),l=L(()=>{if(e.state.selectedType!=pe.ELEMENT)return;const a=e.getSelectedElements();if(a.length!=1)return;const r=a[0],i=ll(r,e.doc.ds);if(!(i==null||!i.content))return i.type===ye.VARIABLE||i.type===ye.FORMULA?`[${i.content}]`:i.content});function s(o){if(o.type==="element")return e.selectElement(o.data);if(o.type==="page")return e.selectPage(o.data)}return(o,a)=>(S(),R("div",{class:g(o.classes.paths)},[(S(!0),R(j,null,re(t.value,(r,i)=>(S(),R(j,{key:r.id},[i>0?(S(),Z(y($),{key:0,class:g(o.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):U("",!0),f("div",{class:g(o.classes.path),onClick:u=>s(r)},W(r.title),11,Hp)],64))),128)),l.value?(S(),R(j,{key:0},[p(y($),{class:g(o.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),f("div",{class:g(o.classes.content)},W(l.value),3)],64)):U("",!0)],2))}}),Wp="_paths_fuk62_2",Yp="_path_fuk62_2",Xp="_icon_fuk62_28",jp="_content_fuk62_33",Zp={paths:Wp,path:Yp,icon:Xp,content:jp},Kp={classes:Zp},Jp=B(Gp,[["__cssModules",Kp]]),Qp=["min","readonly","placeholder"],em=O({__name:"LabelNumber",props:St({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=Jt(n,"modelValue");function l(s){const a=s.target.value;if(t==null||a===""){const i=e.min?e.min:e.defaultValue;t.value=i;return}const r=Number(a);if(!Number.isNaN(r)&&(e.min!=null&&r<e.min&&(t.value=e.min),e.precision!=null)){const i=Math.pow(10,e.precision);t.value=Math.round(r*i)/i}}return(s,o)=>(S(),R("label",{class:g({[s.classes.labelNumber]:!0,[s.classes.readonly]:n.readonly})},[_e(f("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":o[0]||(o[0]=a=>t.value=a),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Qp),[[Ie,t.value]]),f("span",{class:g(s.classes.label)},W(n.label),3)],2))}}),tm="_labelNumber_1aifb_2",nm="_label_1aifb_2",lm="_readonly_1aifb_25",om={labelNumber:tm,label:nm,readonly:lm},sm={classes:om},xt=B(em,[["__cssModules",sm]]),im={class:"quickprint-config"},rm={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},am={class:"quickprint-config-group"},cm={class:"quickprint-config-section quickprint-config-inline"},um={class:"quickprint-config-content quickprint-config-inline"},dm={class:"quickprint-config-section quickprint-config-inline"},fm={class:"quickprint-config-content quickprint-config-inline"},pm={class:"quickprint-config-section quickprint-config-inline"},mm={class:"quickprint-config-content quickprint-form-inline"},hm={key:0,class:"quickprint-config-section quickprint-config-inline"},gm={class:"quickprint-config-content quickprint-form-inline"},vm={class:"quickprint-config-section quickprint-config-inline"},bm={class:"quickprint-config-content quickprint-form-inline"},ym=O({__name:"PageConfig",props:{page:{type:Tt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=L({get(){return e.page.size.type},set(r){e.page.size.type=r,r===Xt.CONTENT&&(e.page.size.orientation=void 0)}}),s=L({get(){return e.page.orientation},set(r){e.page.size.orientation=r}}),o=L(()=>e.page.width),a=L({get(){return e.page.height},set(r){const i=Number(r);!Yn(i)||i<0||(e.page.size.height=i)}});return(r,i)=>(S(),R("div",im,[i[11]||(i[11]=f("div",{class:"quickprint-config-title"},"页面配置",-1)),f("div",rm,[f("div",am,[i[10]||(i[10]=f("div",{class:"quickprint-config-group-title"},"布局",-1)),f("section",cm,[i[5]||(i[5]=f("header",{class:"quickprint-config-header"},"页眉",-1)),f("div",um,[p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(It,{modelValue:n.page.header.display,"onUpdate:modelValue":i[0]||(i[0]=u=>n.page.header.display=u),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",dm,[i[6]||(i[6]=f("header",{class:"quickprint-config-header"},"页脚",-1)),f("div",fm,[p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(It,{modelValue:n.page.footer.display,"onUpdate:modelValue":i[1]||(i[1]=u=>n.page.footer.display=u),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",pm,[i[7]||(i[7]=f("header",{class:"quickprint-config-header"},"尺寸",-1)),f("div",mm,[p(It,{modelValue:l.value,"onUpdate:modelValue":i[2]||(i[2]=u=>l.value=u),options:y(Es),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===y(Xt).CONTENT?(S(),R("section",hm,[i[8]||(i[8]=f("header",{class:"quickprint-config-header"},"内容",-1)),f("div",gm,[p(xt,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,readonly:""},null,8,["modelValue"]),p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:a.value,"onUpdate:modelValue":i[3]||(i[3]=u=>a.value=u)},null,8,["modelValue"])])])):U("",!0),f("section",vm,[i[9]||(i[9]=f("header",{class:"quickprint-config-header"},"方向",-1)),f("div",bm,[p(It,{modelValue:s.value,"onUpdate:modelValue":i[4]||(i[4]=u=>s.value=u),class:"quickprint-w-full",options:y(Yl),disabled:n.page.size.type===y(Xt).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),_m={},Em={class:"quickprint-config"};function Tm(n,e){return S(),R("div",Em,e[0]||(e[0]=[f("div",{class:"quickprint-config-title"},"多选配置",-1),f("div",{class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},"TODO:",-1)]))}const Sm=B(_m,[["render",Tm]]),km=["value","placeholder"],wm=O({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,s=Vt("inputRef"),o=L({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?dl(t.modelValue):t.standard==="mm"&&t.target==="px"?Mt(t.modelValue):0},set(d){if(t.standard===t.target)return l("update:modelValue",d);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Mt(d));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",dl(d))}}),a=L(()=>t.clearable&&o.value!=null);function r(d){const h=d.target.value;if(o==null||h===""){if(t.clearable)return;const v=t.min?t.min:t.defaultValue;o.value=v;return}const _=Number(h);if(!Number.isNaN(_)){if(t.min!=null&&_<t.min){o.value=t.min;return}if(t.standard==="px"){o.value=Math.round(_);return}o.value=_}}function i(){l("update:modelValue",void 0)}function u(){var d;(d=s.value)==null||d.blur(),setTimeout(()=>{var m;return(m=s.value)==null?void 0:m.focus()},50)}return(d,m)=>(S(),R("label",{class:g({[d.classes.inputUnit]:!0,[d.classes.withClear]:n.clearable})},[f("span",{class:g(d.classes.label)},W(n.label),3),f("input",{ref_key:"inputRef",ref:s,class:"quickprint-form-control",type:"number",value:o.value,placeholder:n.placeholder,onBlur:r,onKeydown:Pl(u,["enter"])},null,40,km),a.value?(S(),R("span",{key:0,class:g(d.classes.clearBtn),onClick:ee(i,["stop"])},[p(y($),{icon:"icon-close",size:"11px"})],2)):U("",!0)],2))}}),Cm="_inputUnit_2ymft_2",Rm="_clearBtn_2ymft_7",Lm="_label_2ymft_11",Nm="_withClear_2ymft_31",Im={inputUnit:Cm,clearBtn:Rm,label:Lm,withClear:Nm},xm={classes:Im},nt=B(wm,[["__cssModules",xm]]),Am=O({__name:"UnitSelect",props:St({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=Jt(n,"modelValue"),s=L(()=>{var o;return((o=e.find(a=>a.value===t.modelValue))==null?void 0:o.label)??t.modelValue});return(o,a)=>(S(),R("span",{class:g(o.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(y(J),{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=r=>l.value=r),options:e,class:g(o.classes.select),appearance:"none",border:"none"},{selected:ge(()=>[f("span",{class:g(o.classes.text)},W(s.value),3)]),_:1},8,["modelValue","class"])],2))}}),qm="_unit_135mn_2",Dm="_text_135mn_8",$m="_select_135mn_25",Om={unit:qm,text:Dm,select:$m},Mm={classes:Om},Ro=B(Am,[["__cssModules",Mm]]),Pm=O({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=ie(!1);function s(){t("copy",async function(a){await navigator.clipboard.writeText(a).catch(ts)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(o,a)=>(S(),R("button",{type:"button",class:g(["quickprint-text-btn",o.classes.btn]),title:"复制",onClick:s},[p(y($),{icon:"icon-copy"}),p(fs,{name:"quickprint-fade"},{default:ge(()=>[l.value?(S(),R("span",{key:0,class:g(o.classes.message)},"已复制",2)):U("",!0)]),_:1})],2))}}),Vm="_btn_v9scw_2",Bm="_message_v9scw_6",Fm={btn:Vm,message:Bm},zm={classes:Fm},Um=B(Pm,[["__cssModules",zm]]),Hm=O({__name:"window",props:{code:{type:String,default:""},doc:{type:ve,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=Ve(),l=ie(e.code),s=de();function o(){return l.value}function a(){e.doc!=null&&la({doc:e.doc}).then(m=>{var _;if(m==null)return;const h=m.type=="reference"?`[=${m.value}]`:`[${m.value}]`;(_=s.value)==null||_.insert(h)})}function r(m){var h;return it(m,(h=e.doc)==null?void 0:h.ds)}function i(){var m;(m=s.value)==null||m.insert(`[2.6.${Hn.ELEMENT_VALUR}]`)}function u(){oa().then(m=>{var h;m!=null&&((h=s.value)==null||h.insert(m.value))})}function d(){sa({doc:e.doc}).then(m=>{var h;m!=null&&((h=s.value)==null||h.insert(m.value))})}return t==null||t.useHandle("confirm",o),(m,h)=>(S(),R("div",{class:g(m.classes.window)},[n.mode!=="code"?(S(),R("div",{key:0,class:g(m.classes.toolbar)},[n.mode=="condition"?(S(),R(j,{key:0},[f("button",{type:"button",class:"quickprint-text-btn",onClick:i},[p(y($),{icon:"icon-number-sign"}),h[1]||(h[1]=f("span",null,"插入元素值",-1))]),f("div",{class:g(m.classes.divider)},null,2)],64)):U("",!0),f("button",{type:"button",onClick:a,class:"quickprint-text-btn"},[p(y($),{icon:"icon-insert-var"}),h[2]||(h[2]=f("span",null,"插入变量",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:u},[p(y($),{icon:"icon-function"}),h[3]||(h[3]=f("span",null,"插入函数",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:d},[p(y($),{icon:"icon-formula"}),h[4]||(h[4]=f("span",null,"插入公式",-1))])],2)):U("",!0),p(y(Co),{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=_=>l.value=_),language:"javascript",class:g(m.classes.code),formatVariable:r,autofocus:"",ref_key:"codeRef",ref:s},null,8,["modelValue","class"])],2))}}),Gm="_window_n935p_2",Wm="_toolbar_n935p_11",Ym="_code_n935p_22",Xm="_divider_n935p_27",jm={window:Gm,toolbar:Wm,code:Ym,divider:Xm},Zm={classes:jm},Lo=B(Hm,[["__cssModules",Zm]]),No=Be(function(n){return Et("公式",p(Lo,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Oe)}),Km=Be(function(n,e){return Et(n,p(Lo,{code:e},null),{preset:"editor"}).promisify().catch(Oe)}),Jm={class:"quickprint-config-section quickprint-config-inline"},Qm={class:"quickprint-config-content"},eh=["value"],th=O({__name:"Visibility",props:{element:{type:me,required:!0}},setup(n){const e=n,t=L({get(){var r;return((r=e.element.visibility)==null?void 0:r.type)??yt.VISIBLE},set(r){e.element.visibility==null&&(e.element.visibility={}),r!==yt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=r}}),l=L({get(){var r;return((r=e.element.visibility)==null?void 0:r.condition)??""},set(r){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=r}}),s=L(()=>{var r;return ol((r=e.element.visibility)==null?void 0:r.condition,e.element.doc)}),o=L(()=>{var r;return t.value!==yt.CONDITION?!1:!((r=e.element.visibility)!=null&&r.condition)});function a(){const r=l.value||`[2.6.${Hn.ELEMENT_VALUR}]`;No({code:r,doc:e.element.doc,mode:"condition"}).then(i=>{i!=null&&(l.value=i)})}return(r,i)=>(S(),R(j,null,[f("section",Jm,[i[1]||(i[1]=f("header",{class:"quickprint-config-header"},"可见性",-1)),f("div",Qm,[p(y(J),{class:"quickprint-w-full",options:y(hs),modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=u=>t.value=u)},null,8,["options","modelValue"])])]),t.value===y(yt).CONDITION?(S(),R("div",{key:0,class:g([r.classes.condition,"quickprint-config-section"]),onClick:a},[f("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,eh),o.value?(S(),Z(y($),{key:0,icon:"icon-open-new",size:"14px"})):U("",!0)],2)):U("",!0)],64))}}),nh="_condition_siopf_2",lh={condition:nh},oh={classes:lh},sh=B(th,[["__cssModules",oh]]);function ih(n){return L({get(){return n.element.attributes.position??dn.DEFAULT},set(e){const t=e===dn.DEFAULT?void 0:e;n.element.attributes.position=t}})}function rh(n){return L({get(){return n.element.attributes.printMode??fn.ONCE},set(e){const t=e===fn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function ah(n){return L({get(){return n.element.attributes.overflow??jt.HIDDEN},set(e){const t=e===jt.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function ch(n){return L({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function uh(n){return L({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function dh(n){return L({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function fh(n){return L({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const ph=O({__name:"Const",props:{element:{type:me,required:!0}},setup(n){const e=n,t=L({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,s)=>_e((S(),R("textarea",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Ie,t.value]])}}),mh={class:"quickprint-config-ds-var-type"},hh=["title"],gh=O({__name:"Variable",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Ee(),l=L(()=>ce(e.element.ds.value)),s=L(()=>it(e.element.ds.value,t.doc.ds));function o(r){r.stopPropagation(),e.element.ds.value=void 0}async function a(){var d;const r=await sl({doc:t.doc,value:e.element.ds.value}).catch(et);if(r==null||(e.element.setDataSource(ye.VARIABLE,r.value),e.element.type!=X.TABLE_CELL||r.type!=="ds"))return;const i=e.element.parent;if(i==null||i.isBindVariable||((d=r.parent)==null?void 0:d.type)!==te.ARRAY)return;const u=r.parent;i.setDataSource(ye.VARIABLE,`${Je.DS}.${u.type}.${u.name}`)}return(r,i)=>(S(),R("div",{class:"quickprint-config-ds-variable",onClick:a},[l.value?(S(),R(j,{key:0},[i[0]||(i[0]=f("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(y($),{icon:"icon-open-new",size:"14px"})],64)):(S(),R(j,{key:1},[f("span",mh,"<"+W(y(wi)(e.element.ds.value))+">",1),f("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:s.value},W(s.value),9,hh),f("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:o},[p(y($),{icon:"icon-close",size:"12px"})])],64))]))}}),vh=["value"],bh=O({__name:"Code",props:{element:{type:me,required:!0}},setup(n){const e=n,t=L(()=>ce(e.element.ds.value));function l(){return Wn(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function s(){Km("自定义",l()).then(o=>{o!=null&&(e.element.ds.value=o)})}return(o,a)=>(S(),R("div",{onClick:s,class:g(o.classes.code)},[f("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,vh),t.value?(S(),Z(y($),{key:0,icon:"icon-open-new",size:"14px"})):U("",!0)],2))}}),yh="_code_1az68_2",_h={code:yh},Eh={classes:_h},Th=B(bh,[["__cssModules",Eh]]),Sh=["value"],kh=O({__name:"Formula",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Ee(),l=L(()=>ce(e.element.ds.value)),s=L(()=>ol(e.element.ds.value,e.element.doc));function o(){const a=e.element.ds.value;No({code:a,doc:t.doc,mode:"formula"}).then(r=>{r!=null&&(e.element.ds.value=r)})}return(a,r)=>(S(),R("div",{onClick:o,class:g(a.classes.code)},[f("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Sh),l.value?(S(),Z(y($),{key:0,icon:"icon-open-new",size:"14px"})):U("",!0)],2))}}),wh="_code_ipm2q_2",Ch={code:wh},Rh={classes:Ch},Lh=B(kh,[["__cssModules",Rh]]);function Nh(n){switch(n.ds.type){case ye.CONST:return p(ph,{element:n},null);case ye.VARIABLE:return p(gh,{element:n},null);case ye.CODE:return p(Th,{element:n},null);case ye.FORMULA:return p(Lh,{element:n},null);default:return null}}const Il=O({props:{element:{type:me,required:!0}},setup(n){const e=L(()=>Zt(n.element.type)),t=L(()=>ys.filter(C=>C.value!=n.element.type)),l=ie("px"),s=ch(n),o=uh(n),a=ah(n),r=ih(n),i=rh(n),u=dh(n),d=fh(n),m=L(()=>{const C=n.element,T=C.parent;if(T===null||!(T instanceof Tt))return!1;const E=T.header;if(E.display&&C.bottom<=(E.height??0))return!1;const N=T.parent;if(N==null)return!1;const w=T.footer;return!(w.display&&C.top>=Math.floor(Mt(N.paper.height))-(w.height??0))});function h(C,T){return T==null?!1:!!T.includes(C)}function _(){const C=Lt(n.element.type);if(h(ae.LAYOUT,C==null?void 0:C.exclude))return null;const T=n.element,E=h(ae.COORD,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(nt,{class:"quickprint-form-inline-item",label:"左",modelValue:T.left,"onUpdate:modelValue":z=>T.left=z,target:l.value},null),p(nt,{class:"quickprint-form-inline-item",label:"上",modelValue:T.top,"onUpdate:modelValue":z=>T.top=z,target:l.value},null)])]),N=h(ae.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[oe("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(nt,{class:"quickprint-form-inline-item",label:"宽",modelValue:s.value,"onUpdate:modelValue":z=>s.value=z,target:l.value},null),p(nt,{class:"quickprint-form-inline-item",label:"高",modelValue:o.value,"onUpdate:modelValue":z=>o.value=z,target:l.value},null)])]),w=h(ae.VISIBILITY,C==null?void 0:C.exclude)?null:p(sh,{element:T},null),I=h(ae.OVERFLOW,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("溢出时")]),p("div",{class:"quickprint-config-content"},[p(J,{modelValue:a.value,"onUpdate:modelValue":z=>a.value=z,options:ks,class:"quickprint-w-full"},null)])]),A=h(ae.PRINT_MODE,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[oe("打印模式")]),p("div",{class:"quickprint-config-content"},[p(J,{modelValue:i.value,"onUpdate:modelValue":z=>i.value=z,options:Ss,class:"quickprint-w-full"},null)])]),M=h(ae.POSITION,C==null?void 0:C.exclude)||!m.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("定位模式")]),p("div",{class:"quickprint-config-content"},[p(J,{modelValue:r.value,"onUpdate:modelValue":z=>r.value=z,options:Ts,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[oe("布局")]),p("span",null,[oe("单位：")]),p(Ro,{modelValue:l.value,"onUpdate:modelValue":z=>l.value=z},null)]),E,N,w,I,A,M])}function v(){const C=Lt(n.element.type);if(h(ae.BASIC,C==null?void 0:C.exclude))return null;const T=n.element,E=h(ae.PREFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("前缀")]),p("div",{class:"quickprint-config-content"},[_e(p("input",{"onUpdate:modelValue":I=>T.attributes.prefix=I,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ie,T.attributes.prefix]])])]),N=h(ae.SUFFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("后缀")]),p("div",{class:"quickprint-config-content"},[_e(p("input",{"onUpdate:modelValue":I=>T.attributes.suffix=I,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ie,T.attributes.suffix]])])]),w=h(ae.DISPLAY,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("数据类型")]),p("div",{class:"quickprint-config-content"},[p(J,{options:t.value,modelValue:u.value,"onUpdate:modelValue":I=>u.value=I,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[oe("基础")]),E,N,w])}function c(){const C=Lt(n.element.display);return(C==null?void 0:C.display)==null?null:ot(C.display,{element:n.element})}function b(){const C=Lt(n.element.type);if(h(ae.ATTRIBUTES,C==null?void 0:C.exclude))return null;const T=C!=null&&C.attributes?ot(C.attributes,{element:n.element}):null,E=c();if(T==null&&E==null)return null;const N=E!=null&&T!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[oe("属性")]),E,N,T])}function k(){const C=Lt(n.element.type);return h(ae.DATASOURCE,C==null?void 0:C.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[oe("数据")]),p(J,{options:Gl,modelValue:d.value,"onUpdate:modelValue":T=>d.value=T},null),Nh(n.element)])}function x(C){C(n.element.id)}return function(){const T=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,oe("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[T.id]),p(Um,{onCopy:x},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[oe("标题")]),p("div",{class:"quickprint-config-content"},[_e(p("input",{type:"text","onUpdate:modelValue":E=>T.title=E,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ie,T.title]])])])]),_(),v(),b(),k()])])}}}),Ih=O({setup(){const n=Ee();function e(){return p("div",null,[oe("未知的打印元素")])}function t(){return p("div",null,[oe("请先选择元素")])}function l(){return p("div",null,[oe("请先选择页面")])}return function(){const s=n.state;if(s.selectedType===pe.PAGE){const o=n.getSelectedPage();return o==null?l():p(ym,{page:o},null)}if(s.selectMode===st.SINGLE){const o=n.getSelectedElements()[0];return o==null?t():ot(Il,{element:o,key:o.id})}if(s.selected.length==1){const o=n.getSelectedElements()[0];return Lt(o.type)==null?e():ot(Il,{element:o,key:o.id})}return p(Sm,null,null)}}});function Fe(n,e){if(n.state.selectedType!==pe.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ae(n,e,t){if(n.state.selectedType!==pe.ELEMENT)return;const s=n.getSelectedElements();if(s.length!=0){for(const o of s)o.setStyle(e,t);n.createSnapshot()}}function Me(n,e){if(n.state.selectedType!==pe.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const s of l)s.removeStyle(e);n.createSnapshot()}}function xh(n){const e="underline";return L({get(){if(n.state.selectedType!==pe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ae(n,e,t):Me(n,e)}})}function Ah(n){const e="lineThrough";return L({get(){if(n.state.selectedType!==pe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ae(n,e,t):Me(n,e)}})}function qh(n){const e="lineHeight";return L({get(){return Fe(n,e)},set(t){t===ht.DEFAULT?Me(n,e):Ae(n,e,t)}})}function Dh(n){const e="highlightColor";return L({get(){return Fe(n,e)??Gn.BLACK},set(t){t===""?Me(n,e):Ae(n,e,t)}})}function $h(n){const e="backgroundColor";return L({get(){return Fe(n,e)??Gn.BLACK},set(t){t===""?Me(n,e):Ae(n,e,t)}})}function Oh(n){const e="fontStyle";return L({get(){return Fe(n,e)===fl.ITALIC},set(t){t?Ae(n,e,fl.ITALIC):Me(n,e)}})}function Mh(n){const e="textAlign";return L({get(){return Fe(n,e)??tt.LEFT},set(t){t===tt.LEFT?Me(n,e):Ae(n,e,t)}})}function Ph(n){const e="verticalAlign";return L({get(){return Fe(n,e)??Ye.MIDDLE},set(t){t===Ye.MIDDLE?Me(n,e):Ae(n,e,t)}})}function Vh(n){const e="fontFamily";return L({get(){return Fe(n,e)},set(t){t===se.DEFAULT?Me(n,e):Ae(n,e,t)}})}function Bh(n){const e="fontSize";return L({get(){return Fe(n,e)},set(t){t===be.DEFAULT?Me(n,e):Ae(n,e,t)}})}function Fh(n){const e="color";return L({get(){return Fe(n,e)??Ce.REGULAR},set(t){Ae(n,e,t)}})}function zh(n){const e="fontWeight";return L({get(){return Fe(n,e)===700},set(t){t?Ae(n,e,700):Me(n,e)}})}const Uh=["title","onClick"],Hh=O({__name:"BorderSelect",setup(n){const e=[Q.ALL,Q.NONE,Q.INSIDE,Q.OUTSIDE],t=Ee(),l=L(()=>{if(t.state.selectedType!==pe.ELEMENT)return null;const u=t.getSelectedElements();if(u.length!==1)return null;const m=u[0].getStyle("border");if(m==null||m===Q.NONE)return null;if(m===Q.ALL)return{borderStyle:"solid"};const h={};return m&Q.TOP&&(h.borderTopStyle="solid"),m&Q.RIGHT&&(h.borderRightStyle="solid"),m&Q.BOTTOM&&(h.borderBottomStyle="solid"),m&Q.LEFT&&(h.borderLeftStyle="solid"),h}),s=[{label:"上框线",value:Q.TOP,icon:"icon-border-top"},{label:"下框线",value:Q.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:Q.LEFT,icon:"icon-border-left"},{label:"右框线",value:Q.RIGHT,icon:"icon-border-right"}];function o(i){if(t.state.selectedType!==pe.ELEMENT)return!1;const d=t.getSelectedElements();if(d.length!==1)return!1;const h=d[0].getStyle("border");return h==null?!1:e.includes(i)?h==i:h&i}function a(i){if(t.state.selectedType!==pe.ELEMENT)return;const d=t.getSelectedElements();if(d.length!=0){for(const m of d){const h=m.getStyle("border");if(h==null){m.setStyle("border",i);continue}if(h===Q.ALL){m.setStyle("border",i===Q.ALL?Q.NONE:i);continue}if(e.includes(i)){m.setStyle("border",i);continue}if(e.includes(h)){m.setStyle("border",i);continue}m.setStyle("border",h^i)}t.createSnapshot()}}function r(){if(t.state.selectedType!==pe.ELEMENT)return;const u=t.getSelectedElements();if(u.length!=0){for(const d of u)d.setStyle("border",void 0);t.createSnapshot()}}return(i,u)=>(S(),Z(y(Ql),null,{popover:ge(()=>[f("div",{class:g(i.classes.popover)},[f("div",null,[(S(),R("button",{type:"button",title:"全部框线",key:y(Q).ALL,class:g({"quickprint-text-btn":!0,[i.classes.tool]:!0,"quickprint-is-selected":o(y(Q).ALL)}),onClick:u[0]||(u[0]=d=>a(y(Q).ALL))},[p(y($),{icon:"icon-border",size:"16px"})],2)),(S(),R("button",{type:"button",title:"无框线",key:y(Q).ALL,class:g({"quickprint-text-btn":!0,[i.classes.tool]:!0}),onClick:r},[p(y($),{icon:"icon-border-none",size:"16px"})],2))]),f("div",{class:g(i.classes.divider)},[(S(),R(j,null,re(s,d=>f("button",{type:"button",title:d.label,key:d.value,class:g({"quickprint-text-btn":!0,[i.classes.tool]:!0,"quickprint-is-selected":o(d.value)}),onClick:m=>a(d.value)},[p(y($),{icon:d.icon,size:"16px"},null,8,["icon"])],10,Uh)),64))],2)],2)]),default:ge(()=>[f("div",{class:g(["quickprint-text-btn",i.classes.borderSelect]),title:"边框"},[f("div",{class:g({[i.classes.border]:!0}),style:K(l.value)},null,6)],2)]),_:1}))}}),Gh="_border_rprfx_2",Wh="_borderSelect_rprfx_10",Yh="_popover_rprfx_14",Xh="_divider_rprfx_18",jh={border:Gh,borderSelect:Wh,popover:Yh,divider:Xh},Zh={classes:jh},Kh=B(Hh,[["__cssModules",Zh]]),Jh={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Qh={class:"quickprint-config-section"},eg={class:"quickprint-form-inline"},tg={class:"quickprint-config-section quickprint-config-inline"},ng={class:"quickprint-config-section"},lg={class:"quickprint-config-header quickprint-is-row"},og={class:"quickprint-is-fill-w"},sg={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},ig={class:"quickprint-config-content quickprint-form-inline"},rg=O({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=ie("px"),l=h("top"),s=h("bottom"),o=h("left"),a=h("right"),r=L(()=>xn.map(_=>({label:_.size===An.CUSTOM?"自定义":`${_.size}(${_.width}mm ✕ ${_.height}mm)`,value:_.size})));function i(_){e.config.width=_,m()}function u(_){e.config.height=_,m()}function d(_){const v=xn.find(c=>c.size===_);v!=null&&(e.config.width=v.width,e.config.height=v.height,e.config.orientation=v.orientation,e.config.margins=v.margins,e.config.size=v.size)}function m(){const _=e.config,v=xn.find(c=>c.size===An.CUSTOM?!1:c.orientation===_.orientation&&c.width===_.width&&c.height===_.height);if(v==null){_.size=An.CUSTOM;return}_.size=v.size}function h(_){return L({get(){var v;return(v=e.config.margins)==null?void 0:v[_]},set(v){e.config.margins==null&&(e.config.margins={}),e.config.margins[_]=v}})}return(_,v)=>(S(),R("div",Jh,[f("section",Qh,[v[6]||(v[6]=f("header",{class:"quickprint-config-header"},[f("span",null,"尺寸")],-1)),p(y(J),{options:r.value,modelValue:n.config.size,"onUpdate:modelValue":d,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),f("div",eg,[p(xt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":i},null,8,["modelValue"]),p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":u},null,8,["modelValue"])])]),f("section",tg,[v[7]||(v[7]=f("header",{class:"quickprint-config-header"},"方向",-1)),p(It,{modelValue:n.config.orientation,"onUpdate:modelValue":v[0]||(v[0]=c=>n.config.orientation=c),options:y(Yl)},null,8,["modelValue","options"])]),f("section",ng,[f("header",lg,[f("span",og,[p(y(Ds),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:ge(()=>v[8]||(v[8]=[oe("参考边距")])),_:1})]),v[9]||(v[9]=f("span",null,"单位：",-1)),p(Ro,{modelValue:t.value,"onUpdate:modelValue":v[1]||(v[1]=c=>t.value=c)},null,8,["modelValue"])]),f("div",sg,[p(nt,{class:"quickprint-form-inline-item",label:"上",modelValue:y(l),"onUpdate:modelValue":v[2]||(v[2]=c=>Ge(l)?l.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(nt,{class:"quickprint-form-inline-item",label:"下",modelValue:y(s),"onUpdate:modelValue":v[3]||(v[3]=c=>Ge(s)?s.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),f("div",ig,[p(nt,{class:"quickprint-form-inline-item",label:"左",modelValue:y(o),"onUpdate:modelValue":v[4]||(v[4]=c=>Ge(o)?o.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(nt,{class:"quickprint-form-inline-item",label:"右",modelValue:y(a),"onUpdate:modelValue":v[5]||(v[5]=c=>Ge(a)?a.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),ag={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},cg={class:"quickprint-is-fill-h"},ug={class:"quickprint-is-fill-h"},dg=O({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Re.NONE},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],l=L(()=>Cn.map(u=>(u.style={fontFamily:u.value==se.DEFAULT?se.SONG:u.value},u))),s=L(()=>go.map(u=>(u.style={fontFamily:u.value==se.DEFAULT?se.SONG:u.value},u))),o=L({get(){return e.config.style.fontFamily??se.DEFAULT},set(u){const d=u===se.DEFAULT?void 0:u;e.config.style.fontFamily=d}}),a=L({get(){return e.config.style.enFontFamily??se.DEFAULT},set(u){const d=u===se.DEFAULT?void 0:u;e.config.style.enFontFamily=d}}),r=L({get(){return e.config.style.fontSize},set(u){const d=ce(u)?void 0:u;e.config.style.fontSize=d}}),i=L({get(){return e.config.style.lineHeight},set(u){e.config.style.lineHeight=u}});return(u,d)=>(S(),R("div",ag,[f("section",{class:g(u.classes.font)},[f("div",{class:g(u.classes.zhFont)},[f("div",{class:g(u.classes.title)},"中文字体",2),f("div",cg,[p(y(J),{options:l.value,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=m=>o.value=m)},null,8,["options","modelValue"])])],2),f("div",{class:g(u.classes.enFont)},[f("div",{class:g(u.classes.title)},"西文字体",2),f("div",ug,[p(y(J),{options:s.value,modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=m=>a.value=m)},null,8,["options","modelValue"])])],2),f("div",{class:g(u.classes.lineHeight)},[f("div",{class:g(u.classes.title)},"行高",2),p(mt,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=m=>i.value=m),options:t},null,8,["modelValue"])],2),f("div",{class:g(u.classes.fontSize)},[f("div",{class:g(u.classes.title)},"字号",2),p(ko,{modelValue:r.value,"onUpdate:modelValue":d[3]||(d[3]=m=>r.value=m),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),fg="_font_145qf_2",pg="_zhFont_145qf_9",mg="_enFont_145qf_16",hg="_lineHeight_145qf_23",gg="_fontSize_145qf_30",vg="_title_145qf_45",bg={font:fg,zhFont:pg,enFont:mg,lineHeight:hg,fontSize:gg,title:vg},yg={classes:bg},_g=B(dg,[["__cssModules",yg]]),Eg=O({__name:"index",props:{doc:{type:ve,required:!0}},setup(n){const e=n,t=Ve(),l=$e(a()),s=ie("paper"),o=[{label:"纸张",value:"paper"},{label:"字体",value:"font"}];function a(){const d=e.doc;return{size:d.paper.size,width:d.paper.width,height:d.paper.height,orientation:d.paper.orientation,margins:d.margins?{...d.margins}:void 0,style:{...d.style}}}function r(d){s.value=d.value}function i(){t==null||t.confirm(l)}function u(){t==null||t.cancel()}return(d,m)=>(S(),R("div",{class:g(d.classes.setting)},[f("div",{class:g(d.classes.header)},[f("div",{class:g(d.classes.headerLeft)},[p(y($),{icon:"icon-setting",size:"14px"}),f("span",{class:g(d.classes.title)},"文档",2),p(wo,{tabs:o,active:s.value,onSwitch:r},null,8,["active"])],2),y(t)?(S(),Z(y(jn),{key:0,instance:y(t)},null,8,["instance"])):U("",!0)],2),s.value=="paper"?(S(),Z(rg,{key:0,config:l},null,8,["config"])):U("",!0),s.value=="font"?(S(),Z(_g,{key:1,config:l},null,8,["config"])):U("",!0),f("div",{class:g(d.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:u},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:i},"确定")],2)],2))}}),Tg="_setting_nhkf0_2",Sg="_header_nhkf0_11",kg="_headerLeft_nhkf0_23",wg="_title_nhkf0_36",Cg="_tabs_nhkf0_43",Rg="_footer_nhkf0_48",Lg={setting:Tg,header:Sg,headerLeft:kg,title:wg,tabs:Cg,footer:Rg},Ng={classes:Lg},Ig=B(Eg,[["__cssModules",Ng]]),xg=Be(function(n){return Kt("文档设置",p(Ig,{doc:n},null),{preset:"setting"}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Oe)}),Ag=O({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Ee(),t=xe("classes"),l=Vh(e),s=Bh(e),o=qh(e),a=$h(e),r=Dh(e),i=Fh(e),u=zh(e),d=Oh(e),m=xh(e),h=Ah(e),_=Mh(e),v=Ph(e),c=L(()=>Cn.map(P=>(P.style={fontFamily:P.value==se.DEFAULT?se.SONG:P.value},P)));function b(P){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>P.handler(e)},[P.icon&&p($,{icon:P.icon},null),p("span",null,[P.label])])}function k(P){P.preventDefault()}function x(){u.value=!u.value}function C(){d.value=!d.value}function T(){m.value=!m.value}function E(){h.value=!h.value}function N(){const P=e.getSelectedElements();if(P.length==0)return;const ne=Math.min(...P.map(Y=>Y.left));for(const Y of P)Y.setLeft(ne,!0);e.createSnapshot()}function w(){const P=e.getSelectedElements();if(P.length==0)return;const ne=P[0].page;if(ne==null)return;const Y=Mt(ne.width);for(const q of P)q.setLeft((Y-q.width)/2);e.createSnapshot()}function I(){const P=e.getSelectedElements();if(P.length==0)return;const ne=Math.max(...P.map(Y=>Y.left+Y.width));for(const Y of P)Y.setLeft(ne-Y.width,!0);e.createSnapshot()}async function A(){const P=await na(e.doc);P!=null&&(e.doc.ds=e.doc.createDS(P))}function M(){xg(e.doc)}function z(P){var ne,Y;if(typeof P=="function")return P(e,t);if(typeof P=="object")return b(P);if(typeof P!="string")return null;switch(P){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const q=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:q,onClick:e.history.undo},[p($,{icon:"icon-undo"},null)])}case"redo":{const q=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:q,onClick:e.history.redo},[p($,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p($,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(J,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":q=>l.value=q,options:c.value,class:t.tool,button:!0},null);case"fontSize":return p(J,{title:"字号",width:"60px",modelValue:s.value,"onUpdate:modelValue":q=>s.value=q,options:rl,class:t.tool,button:!0},null);case"lineHeight":return p(J,{title:"行高",width:"60px",modelValue:o.value,"onUpdate:modelValue":q=>o.value=q,options:vo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(lt,{modelValue:a.value,"onUpdate:modelValue":q=>a.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p($,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"highlightColor":return p(lt,{modelValue:r.value,"onUpdate:modelValue":q=>r.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p($,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"fontColor":return p(lt,{modelValue:i.value,"onUpdate:modelValue":q=>i.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p($,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontWeight":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":u.value};return p("button",{type:"button",title:"加粗",class:q,onClick:x},[p($,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":d.value};return p("button",{type:"button",title:"斜体",class:q,onClick:C},[p($,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":m.value};return p("button",{type:"button",title:"下划线",class:q,onClick:T},[p($,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":h.value};return p("button",{type:"button",title:"删除线",class:q,onClick:E},[p($,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(Kh,null,null);case"textAlign":{const q=((ne=Fn.find(le=>le.value===_.value))==null?void 0:ne.label)??"水平对齐",ue={selected({option:le}){return p($,{icon:le==null?void 0:le.icon,class:"quickprint-is-self-center"},null)}};return p(J,{modelValue:_.value,"onUpdate:modelValue":le=>_.value=le,options:Fn,title:q,class:t.tool,width:"36px",size:"mini",button:!0},ue)}case"verticalAlign":{const q=((Y=Bn.find(le=>le.value===v.value))==null?void 0:Y.label)??"垂直对齐",ue={selected({option:le}){return p($,{icon:le==null?void 0:le.icon,class:"quickprint-is-self-center"},null)}};return p(J,{modelValue:v.value,"onUpdate:modelValue":le=>v.value=le,options:Bn,title:q,class:t.tool,width:"36px",size:"mini",button:!0},ue)}case"alignLeft":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:q,onClick:N},[p($,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:q,onClick:w},[p($,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:q,onClick:I},[p($,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:q,onClick:e.toggleBackground},[p($,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:q,onClick:e.toggleElementPanel},[p($,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:q,onClick:e.toggleConfigPanel},[p($,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:A},[p($,{icon:"icon-datasource"},null),p("span",null,[oe("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:M},[p($,{icon:"icon-file-text"},null),p("span",null,[oe("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:k},[n.toolbar.map(z)])}}}),qg="_toolbar_1bhq2_2",Dg="_divider_1bhq2_8",$g="_tool_1bhq2_2",Og="_colorIcon_1bhq2_18",Mg="_colorIndicator_1bhq2_38",Pg={toolbar:qg,divider:Dg,tool:$g,colorIcon:Og,colorIndicator:Mg},Vg={classes:Pg},Bg=B(Ag,[["__cssModules",Vg]]);function Fg(n){let e=null;const t=de(),l=$e({width:0,height:0,scrollTop:0,scrollLeft:0}),s=de(),o=$e({id:"",top:0,left:0,width:0,height:0});async function a(){await Pt();const _=t.value;_!=null&&(l.width=_.offsetWidth,l.height=_.offsetHeight)}function r(_){const v=_.target;l.scrollLeft=v.scrollLeft,l.scrollTop=v.scrollTop}function i(_){const c=_.target.closest("."+G.PAPER);c!=null&&(s.value=c,d(c),u())}async function u(){await Pt();const _=s.value;_!=null&&(o.id=_.id.slice(1),o.width=_.offsetWidth,o.height=_.offsetHeight,o.top=_.offsetTop,o.left=_.offsetLeft)}function d(_){_!=null&&(s.value&&(e==null||e.unobserve(s.value)),e==null||e.observe(_))}function m(){const _=n.doc.firstPage;if(_==null)return;const v=document.querySelector("#\\@"+_.id);s.value=v,e&&v&&e.observe(v),u()}function h(_){_.some(v=>v.target.matches("."+G.CANVAS))&&(a(),u()),_.some(v=>v.target.matches("."+G.PAPER))&&(a(),u())}return Qn(()=>n.state.scale,()=>u()),Qt(()=>{e=new ResizeObserver(h),e.observe(t.value),m(),a()}),ps(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:o,onScroll:r,onSelectPage:i}}const Io=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),zg=O({__name:"index",props:St({modelValue:{type:ve,required:!0},toolbar:{type:Array,default(){return Io}}},{modelValue:{required:!0},modelModifiers:{}}),emits:St(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=de(),s=de(),o=Rs(),a=Jt(n,"modelValue"),r=gd(a,{queryElement:k,dispatchEvent:x}),{canvasRef:i,canvasRect:u,pageRect:d,onScroll:m,onSelectPage:h}=Fg(r),_=L(()=>({"--quickprint-page-scale":r.state.scale/100,"--quickprint-dpr":o.value})),v=L(()=>{const T=r.doc.style;return{fontFamily:nl(T==null?void 0:T.fontFamily,T==null?void 0:T.enFontFamily),fontSize:T==null?void 0:T.fontSize,lineHeight:T==null?void 0:T.lineHeight}});function c(){r.state.panel.left=!1}function b(){r.state.panel.right=!1}function k(T){switch(T){case"ghost":return s.value;case"root":return l.value;default:return}}function x(T,...E){t(T,...E)}function C(T){T.deltaY>0?r.zoomIn():r.zoomOut()}return(T,E)=>(S(),R("div",{class:g(T.classes.designer),ref_key:"rootRef",ref:l,style:K(_.value)},[f("div",{class:g(T.classes.header)},[Pe(T.$slots,"headerLeft"),p(Bg,{class:g(T.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),Pe(T.$slots,"headerRight")],2),f("div",{class:g(T.classes.main)},[y(r).state.panel.left?(S(),R("div",{key:0,class:g(T.classes.left)},[f("button",{type:"button",onClick:c,class:g(["quickprint-text-btn",T.classes.closePanelBtn])},[p(y($),{icon:"icon-close",size:"12px"})],2),p(Up)],2)):U("",!0),f("div",{class:g([T.classes.center,y(G).CANVAS]),onWheelPassive:ee(C,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:i},[p(Ll,{canvas:y(u),page:y(d),scale:y(r).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Ll,{canvas:y(u),page:y(d),scale:y(r).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),f("div",{class:g([y(G).SCROLLABLE,T.classes.canvas]),style:K(v.value),onScroll:E[0]||(E[0]=(...N)=>y(m)&&y(m)(...N)),onClickCapture:E[1]||(E[1]=(...N)=>y(h)&&y(h)(...N))},[(S(!0),R(j,null,re(a.value.pages,N=>(S(),Z(Ap,{key:N.id,doc:a.value,page:N},null,8,["doc","page"]))),128))],38),f("div",{class:g(T.classes.footer)},[p(Jp),p(y(ns),{scale:y(r).state.scale,onZoomIn:y(r).zoomIn,onZoomOut:y(r).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),y(r).state.panel.right?(S(),R("div",{key:1,class:g(T.classes.right)},[f("button",{type:"button",onClick:b,class:g(["quickprint-text-btn",T.classes.closePanelBtn])},[p(y($),{icon:"icon-close",size:"12px"})],2),p(y(Ih))],2)):U("",!0)],2),f("div",{ref_key:"ghostRef",ref:s,class:g(T.classes.ghost)},null,2),p(y(ls))],6))}}),Ug="_designer_grxxm_2",Hg="_header_grxxm_17",Gg="_toolbar_grxxm_25",Wg="_footer_grxxm_31",Yg="_main_grxxm_47",Xg="_left_grxxm_55",jg="_center_grxxm_63",Zg="_right_grxxm_75",Kg="_canvas_grxxm_83",Jg="_closePanelBtn_grxxm_96",Qg="_ghost_grxxm_103",ev={designer:Ug,header:Hg,toolbar:Gg,footer:Wg,main:Yg,left:Xg,center:jg,right:Zg,canvas:Kg,closePanelBtn:Jg,ghost:Qg},tv={classes:ev},nv=B(zg,[["__cssModules",tv]]),lv={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:rn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Oe)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:rn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:rn.DISABLED}};function ov(n,e={}){const t=os(e.zIndexManager);n.use(ss,{zIndex:t,presets:lv}),is(n._context)}const sv="0.0.0",iv={version:sv,install:ov},rv=["onClick"],av=O({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=Ve();function l(s){t==null||t.confirm(s)}return(s,o)=>(S(),R("div",{class:g(s.classes.panel)},[(S(!0),R(j,null,re(y(rs),(a,r)=>(S(),R("div",{key:a.id,class:g(s.classes.item),onClick:i=>l(a)},[f("div",null,[f("span",null,W(r+1)+". ",1),f("span",null,W(a.name),1)])],10,rv))),128))],2))}}),cv="_panel_1he7q_2",uv="_item_1he7q_9",dv={panel:cv,item:uv},fv={classes:dv},pv=B(av,[["__cssModules",fv]]),mv="local",xl="quickprint-local-define",hv=O({__name:"index",setup(n){const e=xe("classes"),t=_(),l="20250821",s=[{label:"新建",icon:"icon-file-text",handler:d},{label:"加载示例",icon:"icon-import",handler:i},"---",...Io];function o(){const v=JSON.stringify(t.value);localStorage.setItem(xl,v)}function a(){o()}function r(){const v=t.value.id,c=v.startsWith("case_")?v:mv,b=`${window.location.origin}/preview.html?id=${c}`;o(),Et("文档预览",ot("iframe",{src:b,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(k){window.open(b,"_blank"),k.close()}}]})}function i(){const v={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:rn.DISABLED};Et("选择示例",ot(pv),v).promisify().then(c=>u(c.id)).catch(Oe)}async function u(v){const c=await pl(v,!1);c!=null&&(as(v),t.value=ve.create(c.define),m())}function d(){const v=ve.createNormalDocument();t.value=v,m()}function m(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function h(){const v=localStorage.getItem(xl);if(v!=null)return ve.create(v);const c=cs(),b=await pl(c.id,!1);return b==null?ve.createNormalDocument():ve.create(b.define)}function _(){const v=ie();return h().then(c=>{v.value=c,m()}),v}return(v,c)=>y(t)?(S(),Z(y(nv),{modelValue:y(t),"onUpdate:modelValue":c[0]||(c[0]=b=>Ge(t)?t.value=b:null),toolbar:s,class:g(y(e).main),key:y(t).id,onSave:a,onPreview:r},{headerLeft:ge(()=>[f("div",{class:g(y(e).logo)},[c[1]||(c[1]=f("h1",null,"OpenPrint",-1)),f("div",{class:g(y(e).dev)},"DEV_"+W(y(l)),3)],2)]),headerRight:ge(()=>[f("div",{class:g(y(e).operate)},[f("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:r},[p(y($),{icon:"icon-run"}),c[2]||(c[2]=f("span",null,"预览",-1))]),f("button",{type:"button",onClick:o,class:"quickprint-text-btn",title:"保存"},[p(y($),{icon:"icon-save"}),c[3]||(c[3]=f("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):U("",!0)}}),gv="_main_he2u6_2",vv="_iframe_he2u6_6",bv="_divider_he2u6_14",yv="_logo_he2u6_20",_v="_dev_he2u6_39",Ev="_operate_he2u6_51",Tv={main:gv,iframe:vv,divider:bv,logo:yv,dev:_v,operate:Ev},Sv={classes:Tv},kv=B(hv,[["__cssModules",Sv]]),xo=ms(kv);xo.use(iv);xo.mount("#app");
