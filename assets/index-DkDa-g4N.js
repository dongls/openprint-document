const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-BsS9gCht.js","assets/vue-CUY5VN2t.js","assets/component-B099-0hV.js","assets/utils-D4MIW8h4.js","assets/utils-BWxIAY5I.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var bs=Object.defineProperty;var Al=n=>{throw TypeError(n)};var ys=(n,e,t)=>e in n?bs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var J=(n,e,t)=>ys(n,typeof e!="symbol"?e+"":e,t),fl=(n,e,t)=>e.has(n)||Al("Cannot "+t);var He=(n,e,t)=>(fl(n,e,"read from private field"),t?t.call(n):e.get(n)),dt=(n,e,t)=>e.has(n)?Al("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),xt=(n,e,t,l)=>(fl(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),Ge=(n,e,t)=>(fl(n,e,"access private method"),t);import{D as we,E as zt,N as vn,a as At,b as F,c as Je,P as kl,d as _n,e as $l,f as yl,g as zn,h as Fn,O as En,i as ue,j as pn,S as Zt,Q as Tn,B as Qe,k as Un,L as Ze,I as G,_ as U,l as co,s as Zn,m as _s,n as ve,o as uo,p as Hn,C as We,q as me,r as Kn,t as po,u as Ft,v as Es,w as Ts,x as Ss,y as Rs,z as Rt,A as fo,V as Ut,F as Gn,G as wt,H as mo,J as go,K as ho,M as Ce,R as at,T as Sn,U as ws,W as Me,X as bt,Y as Ne,Z as nt,$ as gt,a0 as ks,a1 as Ls,a2 as Cs,a3 as Ve,a4 as Rn,a5 as K,a6 as ce,a7 as Ee,a8 as $e,a9 as $t,aa as Dn,ab as Yt,ac as ie,ad as Bt,ae as ht,af as kt,ag as Is,ah as Lt,ai as de,aj as vo,ak as Pe,al as Jt,am as Xe,an as mt,ao as St,ap as fn,aq as qn,ar as Xt,as as Os,at as Ns,au as xs,av as bo,aw as Ms,ax as yo,ay as An,az as _o,aA as Ds,aB as Ht,aC as Kt,aD as qs,aE as As,aF as $s,aG as Bs,aH as Ps,aI as Cn,aJ as Vs,aK as Bl,aL as Le,aM as ml,aN as In,aO as zs,aP as Fs,aQ as Us,aR as Hs,aS as Gs,aT as Ws,aU as Xs,aV as Pl,aW as Ys,aX as js}from"./utils-D4MIW8h4.js";import{d as A,c as I,o as w,a as d,b as g,r as it,n as m,u as De,e as Te,s as be,f as ze,g as k,w as pe,h as b,i as le,j as Y,T as Eo,k as Z,m as Gt,l as kn,p as To,F as se,q as fe,t as te,v as rn,x as Vl,y as So,z as Ro,A as an,B as Ll,C as he,D as xe,E as Ue,G as Jn,H as ye,I as Zs,J as wo,K as gl,L as Be,M as Wn,N as st,O as Ks,P as Js,Q as Qs,R as ei}from"./vue-CUY5VN2t.js";const ko="@quickprint_drag_mode",Lo="@quickprint_drop_data",Qn="@quickprint_operate",rt="@quickprint_element",Cl="@quickprint_element_type",Co="@quickprint_resize_flag",et=160,el=32,mn=[50,75,100,125,150,200,300,400];var bn=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(bn||{}),jt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(jt||{});const vt={SINGLE:0,MULTIPLE:1},Ye=Object.freeze({INSERT:0,MOVE:1}),Il=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),ne=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),Se=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Io=[{label:"固定值",value:we.CONST},{label:"变量",value:we.VARIABLE},{label:"公式",value:we.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:we.CODE,detail:"使用Javascript代码生成数据"}],ti=[{label:"显示",value:zt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:zt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:zt.CONDITION,detail:"元素只在满足指定条件后显示"}],ni=[{label:"四舍五入",value:vn.ROUND},{label:"向下舍入",value:vn.FLOOR},{label:"向上舍入",value:vn.CEIL},{label:"四舍六入",value:vn.BANKER_ROUND}],li=[{label:"原始值",value:At.NONE},{label:"固定位数",value:At.FIXED},{label:"金额千位",value:At.THOUSAND},{label:"金额万位",value:At.TEN_THOUSAND},{label:"金额大写",value:At.DAXIE},{label:"百分比",value:At.PERCENTAGE}],oi=[{label:"显示",value:!0},{label:"隐藏",value:!1}],si=[{label:"默认",value:void 0},{label:"文本",value:F.TEXT},{label:"数字",value:F.NUMBER},{label:"日期",value:F.DATE}],_e={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Oo=[{label:"年-月",value:Je.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:Je.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:Je.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:Je.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:Je.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:Je.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:Je.TIME,detail:"示例：12:00:00"},{label:"时:分",value:Je.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:Je.YEAR,detail:"示例：2024"},{label:"月",value:Je.MONTH,detail:"示例：12"},{label:"日",value:Je.DAY,detail:"示例：01"}];Oo.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const ii=[{label:"元素值",value:kl.ELEMENT_VALUR}],ri=[{label:"基于纸张",value:_n.PAPER},{label:"基于内容",value:_n.CONTENT}],No=[{label:"纵向",value:$l.PORTRAIT},{label:"横向",value:$l.LANDSCAPE}],ai=[{label:"不分页",value:yl.NONE},{label:"按纸张分页",value:yl.PAPER}],ci=[{label:"当前位置",value:zn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:zn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],ui=[{label:"单次打印",value:Fn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:Fn.EACH,detail:"元素将每页打印一次"}],di=[{label:"按内容调整高度",value:En.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:En.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:En.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],_l=[{label:"页码",value:pn.PAGE_NUMBER,type:ue.NUMBER},{label:"总页数",value:pn.PAGE_TOTAL,type:ue.NUMBER},{label:"行序号",value:pn.ROW_INDEX,type:ue.NUMBER},{label:"数据序号",value:pn.DATA_INDEX,type:ue.NUMBER},{label:"当前时间",value:pn.CURRENT_DATE,type:ue.DATE}],pi=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"],fi=[{label:"原始尺寸",value:Zt.NATURAL,detail:"图片原始尺寸"},{label:"填充",value:Zt.FILL,detail:"不保持纵横比缩放图片，图片填满容器"},{label:"裁切",value:Zt.COVER,detail:"保持纵横比缩放图片，只保证图片的短边能完全显示出来，可能会裁切图片"},{label:"包含",value:Zt.CONTAIN,detail:"保持纵横比缩放图片，使图片的长边能完全显示出来，可保证图片完整显示"}],mi=[{label:"快速响应码",short:"QR Code",value:Tn.QRCODE,detail:"最常见的二维码形式"},{label:"汉信码",short:"Han Xin Code",value:Tn.HANXIN},{label:"数据矩阵码",short:"Data Matrix Code",value:Tn.DATA_MATRIX}],gi=[{label:"EAN-8",value:Qe.EAN_8},{label:"EAN-13",value:Qe.EAN_13},{label:"UPC-A",value:Qe.UPC_A},{label:"UPC-E",value:Qe.UPC_E},{label:"CODE-39",value:Qe.CODE_39},{label:"CODE-128",value:Qe.CODE_128},{label:"ITF-14",value:Qe.ITF_14},{label:"GS1-128",value:Qe.GS1_128},{label:"Codabar",value:Qe.CODABAR,short:"库德巴码"},{label:"Interleaved 2 of 5",value:Qe.INTERLEAVED2OF5,short:"交叉25码"}],hi=[{label:"显示",value:!0},{label:"隐藏",value:!1}];function xo(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function vi(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function Mo(n){return n.isSelected?n.type===F.PARAGRAPH?52:n.type===F.TABLE?32:20:20}class bi{constructor(e,t,l){J(this,"originalEvent");J(this,"target");J(this,"ghost");J(this,"container");J(this,"paths",[]);J(this,"dropTarget");J(this,"top",0);J(this,"left",0);J(this,"deltaX");J(this,"deltaY");J(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var nn,ln,Ot,Do,qo,Ao;const Vt=class Vt extends Un{constructor(t={}){var l,o,s;super();dt(this,Ot);J(this,"context",null);J(this,"selector");J(this,"scale");J(this,"onDragStart");dt(this,nn);dt(this,ln);this.selector={container:((l=t.selector)==null?void 0:l.container)??ne.PAGE,element:((o=t.selector)==null?void 0:o.element)??ne.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??ne.DROPPABLE},this.onDragStart=Ge(this,Ot,Do).bind(this),this.scale=t.scale,xt(this,nn,Ge(this,Ot,qo).bind(this)),xt(this,ln,Ge(this,Ot,Ao).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",He(this,nn)),window.removeEventListener("pointerup",He(this,ln)),this.context=null)}};nn=new WeakMap,ln=new WeakMap,Ot=new WeakSet,Do=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Ze.warn(Vt.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=xo(l,o);this.context=new bi(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return Ze.warn(Vt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Ze.warn(Vt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return Ze.warn(Vt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",He(this,nn)),window.addEventListener("pointerup",He(this,ln))},qo=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(a=>!(a===l.ghost||a===l.target||l.ghost.contains(a))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(a=>a.matches("."+ne.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},Ao=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},J(Vt,"TAG_NAME","quickprint-draggable");let El=Vt;const yi=["title"],_i=A({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(w(),I("span",{title:n.title,class:m(e.classes.help)},[d("span",null,[it(e.$slots,"default")]),g(G,{icon:"icon-question-circle"})],10,yi))}}),Ei="_help_1l6l8_2",Ti={help:Ei},Si={classes:Ti},Ri=U(_i,[["__cssModules",Si]]),wi=A({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=De("classes"),r=Te(!1),i=be(),a=be(),c=ze({minWidth:0,top:0,left:0,visible:!1}),p=k(()=>({minWidth:l.width==null?c.minWidth+"px":l.width+"px",top:c.top+"px",left:c.left+"px",visibility:c.visible?"visible":"hidden",zIndex:co()}));async function f(){if(r.value)return h();l.disabled||(r.value=!0,o("show"),await Zn(),R())}function h(){N(),r.value=!1,o("close")}function E(D){if(!(D.target instanceof Node))return;const M=i.value;if(M&&M.contains(D.target))return D.preventDefault();const O=a.value;if(O&&O.contains(D.target))return D.preventDefault();h()}function S(){const D=i.value,M=a.value;if(M==null||D==null)return;const O=D.getBoundingClientRect(),C=M.getBoundingClientRect(),q=l.width==null?O.width:l.width;let Q=O.bottom+1;Q+C.height>window.innerHeight&&O.top>C.height&&(Q=O.top-C.height-1);let oe=O.left;oe+C.width>window.innerWidth&&(oe=window.innerWidth-C.width-2),c.minWidth=q,c.top=Q,c.left=oe,c.visible=!0}function u(D){const M=D.target;if(!(M instanceof HTMLElement))return;const O=i.value;O==null||!M.contains(O)||h()}function v(D){if(D.key!=="Escape")return;const M=a.value;if(M!=null){const O=M.style.zIndex;if(Number(O)<_s())return}D.preventDefault(),h()}function R(){window.addEventListener("click",E,{capture:!0}),window.addEventListener("contextmenu",h,{capture:!0}),window.addEventListener("scroll",u,{capture:!0,passive:!0}),window.addEventListener("resize",S),window.addEventListener("keydown",v)}function N(){window.removeEventListener("click",E,!0),window.removeEventListener("contextmenu",h,!0),window.removeEventListener("scroll",u,!0),window.removeEventListener("resize",S),window.removeEventListener("keydown",v)}return e({close:h}),(D,M)=>(w(),I("div",{class:m(b(s).reference),onClick:pe(f,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[it(D.$slots,"default"),r.value?(w(),le(Eo,{key:0,to:"body"},[d("div",{class:m(b(s).popover),onVnodeMounted:S,onMousedown:M[0]||(M[0]=pe(()=>{},["prevent"])),style:Z(p.value),ref_key:"popoverRef",ref:a},[it(D.$slots,"popover")],38)])):Y("",!0)],2))}}),ki="_reference_1arli_2",Li="_popover_1arli_7",Ci={reference:ki,popover:Li},Ii={classes:Ci},$o=U(wi,[["__cssModules",Ii]]),Oi=["title","onKeydown"],Ni=["onMouseover","onClick"],xi=A({__name:"Select",props:Gt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:Gt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=De("classes"),s=be(),r=be(),i=kn(n,"modelValue"),a=Te(),c=Te(!1),p=ze({width:0,top:0,left:0,visible:!1,scrollable:!1}),f=k(()=>l.teleport==="none"),h=k(()=>l.teleport=="none"?"body":l.teleport),E=k(()=>{const V={label:"",options:[]},j=[V];for(const ee of l.options){if(Array.isArray(ee.options)){j.push({label:ee.label,options:ee.options});continue}V.options.push(ee)}return j}),S=k(()=>E.value.reduce((V,j)=>V.concat(j.options),[])),u=k(()=>{if(l.multiple!==!0){const j=qe();return j?j.label:l.button?l.title:ve(l.modelValue)?l.placeholder:l.modelValue}const V=Ae();return V.length>0?V.map(j=>j.label).join(","):l.button?l.title:l.placeholder}),v=k(()=>l.clearable!==!0?!1:l.modelValue!=null),R=k(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!v.value,[o.button]:l.button,[o.showClearIcon]:v.value,[o.text]:l.size==="text"})),N=k(()=>({width:l.width})),D=k(()=>p.visible?{width:l.popoverWidth==null?p.width+"px":l.popoverWidth+"px",top:p.top+"px",left:p.left+"px",visibility:"visible",zIndex:co()}:{minWidth:l.popoverWidth==null?p.width+"px":l.popoverWidth+"px",visibility:"hidden"}),M=k(()=>({[o.content]:!0,[o.placeholder]:uo(l.modelValue)}));async function O(){if(l.disabled)return;const V=S.value;if(V.length===0)return;if(c.value)return C();const j=s.value;j!=null&&(p.width=j.getBoundingClientRect().width,p.visible=!1,a.value=V.find(ee=>ee.value===l.modelValue),c.value=!0,await Zn(),ot())}function C(){ut(),c.value=!1}function q(V){X(),ge()}function Q(V){V.disabled!==!0&&(a.value=V)}function oe(V){if(l.disabled==!0||V.disabled===!0)return;if(l.multiple!==!0){i.value=V.value,t("select",V),C();return}const j=Array.isArray(i.value)?i.value:[],ee=j.findIndex(ke=>ke===V.value);ee>=0?j.splice(ee,1):j.push(V.value),i.value=j,t("select",j)}function W(V){if(!(V.target instanceof Node))return;const j=s.value;if(j&&j.contains(V.target))return V.preventDefault();const ee=r.value;if(ee&&ee.contains(V.target))return V.preventDefault();C()}async function X(){const V=s.value,j=r.value;if(j==null||V==null)return;await rn();const ee=V.getBoundingClientRect(),ke=j.getBoundingClientRect();let Ie=ee.bottom+1;Ie+ke.height>window.innerHeight&&ee.top>ke.height&&(Ie=ee.top-ke.height-1);let Wt=ee.left;Wt+ke.width>window.innerWidth&&(Wt=window.innerWidth-ke.width-2),p.width=ke.width,p.top=Ie,p.left=Wt,p.visible=!0;const dn=j.querySelector("."+o.list);p.scrollable=dn?dn.scrollHeight>dn.clientHeight:!1}function z(V){const j=V.target;if(!(j instanceof HTMLElement))return;const ee=s.value;ee==null||!j.contains(ee)||C()}function T(){const V=S.value,j=Vl(a.value);if(j==null){a.value=H(0),ge();return}const ee=V.indexOf(j);if(ee==0)return L();const ke=H(ee-1);ke!=null&&(a.value=ke,ge())}function y(){const V=S.value,j=Vl(a.value);if(j==null){a.value=$(0),ge();return}const ee=V.indexOf(j);if(ee>=V.length-1){_();return}const ke=H(ee+1);ke!=null&&(a.value=ke,ge())}function _(){a.value=$(0),ge()}function L(){const V=S.value;a.value=H(V.length-1),ge()}function x(){i.value=void 0,C()}function $(V){const ee=S.value[V];return ee==null?null:ee.disabled===!0?$(V+1):ee}function H(V){const ee=S.value[V];return ee==null?null:ee.disabled===!0?H(V-1):ee}function B(V){switch(V.key){case"Enter":V.preventDefault(),a.value&&oe(a.value);return;case"Escape":V.preventDefault(),C();return;case"ArrowUp":V.preventDefault(),T();return;case"ArrowDown":V.preventDefault(),y();return;case"Home":V.preventDefault(),_();return;case"End":V.preventDefault(),L();return}}function P(V){if(l.disabled)return;const j=s.value;j!=null&&document.activeElement===j&&(c.value||(V.stopPropagation(),O()))}function ae(V){if(l.multiple!==!0)return l.modelValue===V.value;const j=l.modelValue;return Array.isArray(j)?j.includes(V.value):!1}async function ge(){if(a.value==null)return;await rn();const V=r.value;if(V==null)return;const j=V.querySelector("."+o.hover);j&&j.scrollIntoView({block:"nearest"})}function qe(){const V=S.value,j=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return V.find(ee=>ee.value===j)}function Ae(){const V=S.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(ee=>ee).map(ee=>{const ke=V.find(Ie=>Ie.value===ee);return ke||{value:ee,label:ee}})}function ot(){window.addEventListener("mousedown",W,{capture:!0}),window.addEventListener("pointerdown",W,{capture:!0}),window.addEventListener("contextmenu",C,{capture:!0}),window.addEventListener("scroll",z,{capture:!0,passive:!0}),window.addEventListener("resize",X),window.addEventListener("keydown",B)}function ut(){window.removeEventListener("mousedown",W,!0),window.removeEventListener("pointerdown",W,!0),window.removeEventListener("contextmenu",C,!0),window.removeEventListener("scroll",z,!0),window.removeEventListener("resize",X),window.removeEventListener("keydown",B)}return(V,j)=>{var ee;return w(),I("div",{class:m(R.value),title:n.title,style:Z(N.value),onClick:pe(O,["stop"]),onKeydown:To(pe(P,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[V.$slots.selected?it(V.$slots,"selected",{key:0,option:qe(),options:Ae()}):it(V.$slots,"option",{key:1,option:qe(),options:Ae()},()=>[d("div",{class:m(M.value)},[d("span",null,te(u.value),1),v.value?(w(),le(G,{key:0,icon:"icon-close",onClick:pe(x,["stop"]),size:"12px",class:m(b(o).clearIcon)},null,8,["class"])):Y("",!0)],2)]),c.value?(w(),le(Eo,{key:2,to:h.value,disabled:f.value},[d("div",{class:m(b(o).popover),onClick:j[0]||(j[0]=pe(()=>{},["stop"])),onVnodeMounted:q,onMousedown:j[1]||(j[1]=pe(()=>{},["prevent"])),style:Z(D.value),ref_key:"popoverRef",ref:r},[d("div",{class:m(b(o).list)},[(w(!0),I(se,null,fe(E.value,ke=>(w(),I(se,null,[ke.label?(w(),I("div",{key:0,class:m(b(o).groupLabel)},te(ke.label),3)):Y("",!0),(w(!0),I(se,null,fe(ke.options,Ie=>{var Wt;return w(),I("div",{key:Ie.value,class:m({[b(o).option]:!0,[b(o).disabled]:Ie.disabled===!0,[b(o).selected]:ae(Ie),[b(o).hover]:((Wt=a.value)==null?void 0:Wt.value)==Ie.value}),style:Z(Ie.style),onMouseover:dn=>Q(Ie),onClick:dn=>oe(Ie)},[it(V.$slots,"option",{option:Ie},()=>[d("div",{class:m(b(o).label)},[Ie.icon?(w(),le(G,{key:0,icon:Ie.icon,class:m(b(o).icon)},null,8,["icon","class"])):Y("",!0),d("span",null,te(Ie.label),1)],2),Ie.short?(w(),I("div",{key:0,class:m(b(o).short)},te(Ie.short),3)):Y("",!0)])],46,Ni)}),128))],64))),256))],2),(ee=a.value)!=null&&ee.detail&&p.visible?(w(),I("div",{key:0,class:m(b(o).detail)},te(a.value.detail),3)):Y("",!0)],38)],8,["to","disabled"])):Y("",!0)],46,Oi)}}}),Mi="_button_g23yb_2",Di="_select_g23yb_7",qi="_appearance_g23yb_16",Ai="_content_g23yb_31",$i="_placeholder_g23yb_37",Bi="_popover_g23yb_41",Pi="_list_g23yb_51",Vi="_option_g23yb_80",zi="_label_g23yb_95",Fi="_icon_g23yb_102",Ui="_hover_g23yb_106",Hi="_detail_g23yb_117",Gi="_short_g23yb_127",Wi="_selected_g23yb_133",Xi="_disabled_g23yb_137",Yi="_showClearIcon_g23yb_142",ji="_clearIcon_g23yb_146",Zi="_text_g23yb_159",Ki="_mini_g23yb_171",Ji="_groupLabel_g23yb_183",Qi={button:Mi,select:Di,appearance:qi,content:Ai,placeholder:$i,popover:Bi,list:Pi,option:Vi,label:zi,icon:Fi,hover:Ui,detail:Hi,short:Gi,selected:Wi,disabled:Xi,showClearIcon:Yi,clearIcon:ji,text:Zi,mini:Ki,groupLabel:Ji},er={classes:Qi},re=U(xi,[["__cssModules",er]]),tr="_tree_1p28f_1",nr="_node_1p28f_5",lr="_content_1p28f_11",or="_space_1p28f_27",sr="_expand_1p28f_28",ir="_active_1p28f_47",rr="_children_1p28f_55",Et={tree:tr,node:nr,content:lr,space:or,expand:sr,active:ir,children:rr},Bo=Symbol(),Po=A({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=So(Bo),l=k(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=k({get(){const u=t==null?void 0:t.state[n.node.value];return u==null?!1:u.expand},set(u){const v=t==null?void 0:t.state[n.node.value];v!=null&&(v.expand=u)}});function s(u){u.preventDefault(),o.value=!o.value}function r(){if(!l.value)return g("div",{class:Et.space},null);const u={[Et.expand]:!0,[Et.active]:o.value};return g("div",{onMousedown:S,onClick:s,class:u},[g(G,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):g("span",null,[n.node.label])}function a(){return g("div",{class:Et.content,onClick:p,onMouseenter:h},[i()])}function c(){if(!l.value||!o.value)return;const u=n.node.children.map(v=>g(Po,{node:v,onNodeClick:f,onNodeHover:E},null));return g("div",{class:Et.children},[u])}function p(){e("nodeClick",n.node)}function f(u){e("nodeClick",u)}function h(){e("nodeHover",n.node)}function E(u){e("nodeHover",u)}function S(u){u.preventDefault()}return function(){return g("div",{class:Et.subTree},[g("div",{class:Et.node},[r(),a()]),c()])}}}),ar=A({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(a){t("nodeClick",a)}function s(a){t("nodeHover",a)}function r(){const a=ze({}),c=function(p,f){for(const h of p)f[h.value]={expand:h.expand!==!1},h.children&&c(h.children,f)};return c(n.data,a),a}function i(a){return typeof e.default=="function"?e.default(a):null}return Ro(Bo,{state:l,content:i}),function(){const a=n.data.map(c=>g(Po,{node:c,onNodeClick:o,onNodeHover:s},null));return g("div",{class:Et.tree},[a])}}});function On(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const hl={A:10,B:11,C:12,D:13,E:14,F:15},zl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function cr(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function ur(n){return typeof n=="string"&&n.includes("%")}function Qt(n,e){cr(n)&&(n="100%");const t=ur(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function Mt(n){return n.length===2?(hl[n[0].toUpperCase()]||+n[0])*16+(hl[n[1].toUpperCase()]||+n[1]):hl[n[1].toUpperCase()]||+n[1]}function Fl(n,e,t){n=Qt(n,255),e=Qt(e,255),t=Qt(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,a=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:a*100,v:r*100}}const dr=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},pr=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function vl(n,e,t){n=Qt(n,360)*6,e=Qt(e,100),t=Qt(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),a=l%6,c=[t,r,s,s,i,t][a],p=[i,t,t,r,s,s][a],f=[s,s,i,t,t,r][a];return{r:Math.round(c*255),g:Math.round(p*255),b:Math.round(f*255)}}function $n(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${zl[e]||e}${zl[t]||t}`}function fr({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${$n(n)}${$n(e)}${$n(t)}`}class tl{constructor(e){J(this,"h",0);J(this,"s",100);J(this,"v",100);J(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=On(e)}setSaturation(e){this.s=On(e)}setValue(e){this.v=On(e)}setAlpha(e){this.a=On(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=Mt(t[0]+t[0]),o=Mt(t[1]+t[1]),s=Mt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=Mt(t.slice(0,2)),o=Mt(t.slice(2,4)),s=Mt(t.slice(4,6))),t.length===8&&(r=Mt(t.slice(6))/255*100);const{h:i,s:a,v:c}=Fl(l,o,s);return{h:i,s:a,v:c,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Fl(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=dr(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=pr(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${fr(vl(this.h,this.s,this.v))}${$n(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=vl(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return vl(this.h,this.s,this.v)}}function Vo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),c=e.target.getBoundingClientRect().width/2;let p=r.clientX-i.left-e.offsetX;return p<-c&&(p=-c),p>i.width-c&&(p=i.width-c),p}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,a=r.currentTarget;origin==null||i==null||(e.container=a,e.target=i===a?i.firstElementChild:i,e.offsetX=i===a?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function mr(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const a=e.container.getBoundingClientRect(),p=e.target.getBoundingClientRect().width/2;let f=i.clientX-a.left-e.offsetX;return f<-p&&(f=-p),f>a.width-p&&(f=a.width-p),f}function l(i){const a=e.container.getBoundingClientRect(),p=e.target.getBoundingClientRect().height/2;let f=i.clientY-a.top-e.offsetY;return f<-p&&(f=-p),f>a.height-p&&(f=a.height-p),f}function o(i){i.stopPropagation(),i.preventDefault();const a=i.target,c=i.currentTarget;origin==null||a==null||(e.container=c,e.target=a===c?a.firstElementChild:a,e.offsetX=a===c?e.target.offsetWidth/2:i.clientX-a.getBoundingClientRect().left,e.offsetY=a===c?e.target.offsetHeight/2:i.clientY-a.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const a=t(i),c=l(i);e.target.style.left=a+"px",e.target.style.top=c+"px",n("move",{left:a,top:c})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const a=t(i),c=l(i);n("end",{top:c,left:a})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const gr=A({__name:"SvPanel",props:{modelValue:{type:tl,required:!0}},setup(n){const e=n,t=be(),l=be(),o=ze(i()),s=k(()=>({left:o.left+"px",top:o.top+"px"})),r=mr((a,c)=>{a=="end"&&(o.top=c.top,o.left=c.left);const p=t.value,f=l.value,h=(c.left+f.offsetWidth/2)/p.offsetWidth*100,E=100-(c.top+f.offsetHeight)/p.offsetHeight*100;e.modelValue.setSaturation(h),e.modelValue.setValue(E)});function i(){const a=t.value,c=l.value;if(a==null||c==null)return{top:-6,left:-6};const p=e.modelValue.s,h=(100-e.modelValue.v)/100*a.offsetHeight,E=p/100*a.offsetWidth;return{top:h-c.offsetHeight/2,left:E-c.offsetWidth/2}}return an(()=>{const a=i();o.top=a.top,o.left=a.left}),(a,c)=>(w(),I("div",{class:m(a.classes.svPanel),onPointerdown:c[0]||(c[0]=(...p)=>b(r)&&b(r)(...p)),ref_key:"svPanelRef",ref:t},[d("div",{class:m(a.classes.thumb),style:Z(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),hr="_svPanel_1sv6o_2",vr="_thumb_1sv6o_10",br={svPanel:hr,thumb:vr},yr={classes:br},_r=U(gr,[["__cssModules",yr]]),Er=A({__name:"HueSlider",props:{modelValue:{type:tl,required:!0}},setup(n){const e=n,t=Te(-6),l=be(),o=be(),s=Vo((i,a)=>{i=="end"&&(t.value=a);const c=l.value,p=o.value,f=Math.round((a+p.offsetWidth/2)/c.offsetWidth*360);e.modelValue.setHue(f)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const c=e.modelValue.h;return Math.round(c/360*i.offsetWidth)-a.offsetWidth/2}return an(()=>{t.value=r()}),(i,a)=>(w(),I("div",{class:m(i.classes.hue),onPointerdown:a[0]||(a[0]=(...c)=>b(s)&&b(s)(...c)),ref_key:"hueRef",ref:l},[d("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Tr="_hue_1ozoc_2",Sr="_thumb_1ozoc_10",Rr={hue:Tr,thumb:Sr},wr={classes:Rr},kr=U(Er,[["__cssModules",wr]]),Lr=A({__name:"AlphaSlider",props:{modelValue:{type:tl,required:!0}},setup(n){const e=n,t=Te(-6),l=be(),o=be(),s=Vo((i,a)=>{i=="end"&&(t.value=a);const c=l.value,p=o.value,f=Math.round((a+p.offsetWidth/2)/c.offsetWidth*100);e.modelValue.setAlpha(f)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const c=e.modelValue.a;return Math.round(c/100*i.offsetWidth)-a.offsetWidth/2}return an(()=>{t.value=r()}),(i,a)=>(w(),I("div",{class:m(i.classes.alpha),onPointerdown:a[0]||(a[0]=(...c)=>b(s)&&b(s)(...c)),ref_key:"alphaRef",ref:l},[d("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Cr="_alpha_1x8jd_2",Ir="_thumb_1x8jd_26",Or={alpha:Cr,thumb:Ir},Nr={classes:Or},xr=U(Lr,[["__cssModules",Nr]]),Mr=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function Dr(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function qr(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const Ul={isSupport:Dr,open:qr},Ar=["title","onClick"],$r=["title","onClick"],Hl="quickprint-recent-use-colors",Br=A({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=Te(new tl(l.modelValue)),r=be(),i=be(),a=Te(N()),c=Ul.isSupport(),p=Te("hex"),f=k(()=>{const O=l.modelValue;return O?{backgroundColor:O}:null}),h=k(()=>{const O=s.value,{r:C,g:q,b:Q}=O.rgb();return{"--hue-channel-color":`hsl(${O.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${C}, ${q}, ${Q}, 0)`,"--alpha-channel-color-b":`rgba(${C}, ${q}, ${Q}, 1)`}}),E=k({get(){return s.value.toString(p.value)},set(O){s.value.setColor(O)}});function S(){var O;(O=r.value)==null||O.close()}function u(O){O!=null&&(t("update:modelValue",O),t("select",O),D(O),S())}function v(){t("update:modelValue",void 0),t("select",void 0),S()}function R(){Ul.open().then(O=>u(O))}function N(){const O=localStorage.getItem(Hl);if(O==null||O=="")return[];const C=Hn(O);return C==null?[]:Array.isArray(C)?C:[]}function D(O){const C=a.value,q=C.indexOf(O);q>=0&&C.splice(q,1),C.length>10&&C.pop(),C.unshift(O),localStorage.setItem(Hl,JSON.stringify(C))}function M(){t("update:modelValue",s.value.toString(p.value)),t("select",s.value.toString(p.value)),S()}return Ll(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(O,C)=>(w(),le($o,{class:m(O.classes.colorPicker),onMousedown:C[7]||(C[7]=pe(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:he(()=>[d("div",{class:m(O.classes.colorPickerPanel)},[d("div",{class:m(O.classes.presetPanel)},[d("div",{class:m(O.classes.presetTools)},[d("button",{type:"button",class:m(O.classes.clearBtn),onClick:v},[d("span",{class:m(O.classes.none)},null,2),C[8]||(C[8]=d("span",null,"无颜色",-1))],2),b(c)?(w(),I("button",{key:0,type:"button",class:m(O.classes.indicator),onClick:R},[g(G,{icon:"icon-eye-dropper"}),C[9]||(C[9]=d("span",null,"拾色器",-1))],2)):Y("",!0)],2),d("div",{class:m(O.classes.colourAtla)},[(w(!0),I(se,null,fe(b(Mr),q=>(w(),I("div",{style:Z({backgroundColor:q}),title:q,class:m(O.classes.color),onClick:Q=>u(q)},null,14,Ar))),256))],2),d("div",{class:m(O.classes.recentColors)},"最近使用",2),d("div",{class:m(O.classes.colourAtla)},[(w(),I(se,null,fe(10,q=>d("div",{key:q,title:a.value[q-1],style:Z({backgroundColor:a.value[q-1]}),class:m(O.classes.color),onClick:Q=>u(a.value[q-1])},null,14,$r)),64))],2)],2),d("div",{class:m(O.pacls.panel),style:Z(h.value)},[g(_r,{class:m(O.pacls.sv),modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=q=>s.value=q)},null,8,["class","modelValue"]),d("div",{class:m(O.pacls.sliders)},[g(kr,{class:m(O.pacls.hua),modelValue:s.value,"onUpdate:modelValue":C[2]||(C[2]=q=>s.value=q)},null,8,["class","modelValue"]),g(xr,{modelValue:s.value,"onUpdate:modelValue":C[3]||(C[3]=q=>s.value=q)},null,8,["modelValue"]),d("div",{class:m(O.pacls.preview)},[d("div",{class:m(O.pacls.previewColor),style:Z({backgroundColor:s.value.toRGB()})},null,6)],2)],2),d("div",{class:m(O.pacls.tools)},[g(re,{options:o,teleport:"none",modelValue:p.value,"onUpdate:modelValue":C[4]||(C[4]=q=>p.value=q),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),xe(d("input",{type:"text","onUpdate:modelValue":C[5]||(C[5]=q=>E.value=q),onMousedown:C[6]||(C[6]=pe(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Ue,E.value]]),d("button",{type:"button",class:m(O.pacls.confirm),onClick:M},"确定",2)],2)],6)],2)]),default:he(()=>[d("div",{class:m({[O.classes.colorPickerInput]:!0,[O.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[it(O.$slots,"default",{},()=>[d("span",{class:m(O.classes.colorBlock),style:Z(f.value)},null,6)]),n.showText?(w(),I("div",{key:0,class:m(O.classes.colorValue),onClick:C[0]||(C[0]=pe(()=>{},["stop"]))},te(n.modelValue),3)):Y("",!0)],2)]),_:3},8,["class","disabled"]))}}),Pr="_colorPicker_1egpm_2",Vr="_disabled_1egpm_6",zr="_colorPickerInput_1egpm_10",Fr="_colorBlock_1egpm_17",Ur="_colorValue_1egpm_26",Hr="_colorPickerPanel_1egpm_31",Gr="_presetPanel_1egpm_45",Wr="_colourAtla_1egpm_49",Xr="_color_1egpm_2",Yr="_presetTools_1egpm_76",jr="_clearBtn_1egpm_82",Zr="_indicator_1egpm_83",Kr="_none_1egpm_101",Jr="_recentColors_1egpm_132",Qr={colorPicker:Pr,disabled:Vr,colorPickerInput:zr,colorBlock:Fr,colorValue:Ur,colorPickerPanel:Hr,presetPanel:Gr,colourAtla:Wr,color:Xr,presetTools:Yr,clearBtn:jr,indicator:Zr,none:Kr,recentColors:Jr},ea="_panel_911zv_2",ta="_sv_911zv_7",na="_hua_911zv_11",la="_sliders_911zv_15",oa="_tools_911zv_20",sa="_confirm_911zv_37 quickprint-text-btn",ia="_preview_911zv_44",ra="_previewColor_911zv_59",aa={panel:ea,sv:ta,hua:na,sliders:la,tools:oa,confirm:sa,preview:ia,previewColor:ra},ca={classes:Qr,pacls:aa},en=U(Br,[["__cssModules",ca]]),ua=A({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=k({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=k(()=>{const i=l.modelValue;return uo(i)||i===We.INHERIT});function r(i){t("select",i)}return(i,a)=>(w(),le(en,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=c=>o.value=c),disabled:n.disabled,onSelect:r},{default:he(()=>[d("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[d("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:Z({backgroundColor:o.value})},null,6),d("div",{class:m(i.classes.colorValue)},te(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),da="_indicator_14ypk_2",pa="_disabled_14ypk_8",fa="_colorBlock_14ypk_27",ma="_colorValue_14ypk_38",ga="_colorNone_14ypk_45",ha={indicator:da,disabled:pa,colorBlock:fa,colorValue:ma,colorNone:ga},va={classes:ha},tn=U(ua,[["__cssModules",va]]);function zo(){const n=Te(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),Jn(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}function Ln(n,e={}){const t={},l=n.style??{},o=Kn(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=po(l);return s&&Object.assign(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.writingMode&&(t.writingMode=l.writingMode),bl("border",e)&&Object.assign(t,Ft(n)),bl("align",e)&&Object.assign(t,Es(n)),bl("padding",e)&&Object.assign(t,Ts(n)),t["--quickprint-content-transform"]=Ss(n),Object.assign(t,Rs(n)),t}function Ol(n,e={}){const t=[];let l=n;for(;me.isDefineElement(l);)t.unshift(Ln(l,e)),l=l.parent;return Object.assign({},...t)}function bl(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const Pt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(Pt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(Pt.SPACE).filter(o=>Rt(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(Pt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(Pt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(Pt.SPACE))}};function Dt(n){switch(n){case"top":case 0:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case"right":case 1:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case"bottom":case 2:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case"left":case 3:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function nl(n){var t;const e=n.ds;if(e!=null)return e.type===we.FORMULA?{type:e.type,content:Nl(e.value,n.doc)}:e.type===we.VARIABLE?{type:e.type,content:yt(e.value,(t=n.doc)==null?void 0:t.ds)}:e.type===we.CODE?{type:e.type,content:"自定义"}:{type:e.type,content:e.value}}function yt(n,e){var h,E,S;if(ve(n))return n;const t=fo(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===Ut.BUILTIN)return((h=_l.find(u=>u.value===s))==null?void 0:h.label)??s;if(t.varType===Ut.SPECIAL)return((E=ii.find(u=>u.value===s))==null?void 0:E.label)??s;if(e==null)return l;const i=(e.fields??[]).find(u=>u.name===s);if(i==null)return l;const a=o[1],c=ve(i.title)?i.name:i.title;if(a==null)return c;const p=(S=i.children)==null?void 0:S.find(u=>u.name===a);if(p==null)return`${c}.${a}`;const f=ve(p.title)?p.name:p.title;return`${c}.${f}`}function Nl(n,e){return ve(n)?void 0:Gn.tokenize(n).map(o=>o.type===wt.VARIABLE?`[${yt(o.value,e==null?void 0:e.ds)}]`:o.type===wt.REFERENCE?`[${Fo(o.value,e)}]`:o.type===wt.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===wt.VARIABLE?`[${yt(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):Gn.formatTokenValue(o)).join("")}function Fo(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===we.VARIABLE&&t.ds.value?yt(t.ds.value,e.ds):"="+n}function ba(n){switch(fo(n).dataType){case ue.OBJECT:return"对象";case ue.ARRAY:return"数组";case ue.STRING:return"文本";case ue.NUMBER:return"数字";case ue.DATE:return"日期";case ue.BOOLEAN:return"布尔";default:return"未知类型"}}function ya(n){var e;return((e=Io.find(t=>t.value===n))==null?void 0:e.label)??n}const Uo=mo(()=>go(()=>import("./component-BsS9gCht.js"),__vite__mapDeps([0,1]))),_a=["onClick","onMouseenter"],Ea=A({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=Te(_l[0].value),o=k(()=>`builtin_${ho(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,a)=>(w(),I("div",{class:m(i.classes.builtin)},[d("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(w(!0),I(se,null,fe(b(_l),c=>(w(),I("div",{class:m({[i.classes.param]:!0,[i.classes.active]:c.value===l.value}),onClick:p=>s(c),onMouseenter:p=>r(c)},[d("strong",null,te(c.label),1),d("span",null,te(c.value),1)],42,_a))),256))],2),d("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[g(b(Uo),{name:o.value},null,8,["name"])],2)],2))}}),Ta="_builtin_m1n0z_2",Sa="_panel_m1n0z_11",Ra="_desc_m1n0z_17",wa="_param_m1n0z_24",ka="_active_m1n0z_34",La={builtin:Ta,panel:Sa,desc:Ra,param:wa,active:ka},Ca={classes:La},Ia=U(Ea,[["__cssModules",Ca]]),Gl=[{label:"文本",value:ue.STRING},{label:"数字",value:ue.NUMBER},{label:"日期",value:ue.DATE},{label:"对象",value:ue.OBJECT},{label:"数组",value:ue.ARRAY}],Oa=A({emit:["select"],props:{doc:{type:Ce,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=De("classes"),o=at(),s=a(),r=i();function i(){const v=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(R,N,D){var M;if(n.readonly){const O=R[N.name],C=((M=Gl.find(q=>q.value===O))==null?void 0:M.label)??O;return g("div",{class:D.classes.cell},[C])}return g("div",{class:D.classes.cell},[g(re,{options:Gl,modelValue:R.type,"onUpdate:modelValue":E.bind(null,R),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(R,N,D){return n.readonly?g("div",{class:D.classes.cell},[R[N.name]]):g("div",{class:D.classes.cell},[xe(g("input",{"onUpdate:modelValue":M=>R.name=M,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Ue,R.name]])])}},{name:"title",title:"标题",width:180,render(R,N,D){return n.readonly?g("div",{class:D.classes.cell},[R[N.name]]):g("div",{class:D.classes.cell},[xe(g("input",{"onUpdate:modelValue":M=>R.title=M,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Ue,R.title]])])}}];return n.readonly!==!0&&v.push({name:"operate",title:"操作",width:200,render(R,N,D){const M=[g("button",{type:"button",class:"quickprint-text-btn",onClick:p.bind(null,R,D.parent)},[g(G,{icon:"icon-subnode"},null),g("span",null,[ye("插入行")])])];return(R.type===ue.ARRAY||R.type===ue.OBJECT)&&M.push(g("button",{type:"button",class:"quickprint-text-btn",onClick:h.bind(null,R)},[g(G,{icon:"icon-sisternode"},null),g("span",null,[ye("插入子级")])])),M.push(g("button",{type:"button",class:"quickprint-text-btn",onClick:f.bind(null,R,D.parent)},[g(G,{icon:"icon-delete"},null),g("span",null,[ye("删除")])])),M}}),v}function a(){const v=Sn(n.doc.ds.fields??[]).map(N=>{const D=N.type;return{...N,$expand:D===ue.ARRAY||D===ue.OBJECT}}),R=Te(v);return R.value.length==0&&R.value.push(c()),R}function c(){return{type:ue.STRING,name:"",title:""}}function p(v,R){if(R){const D=R.children??[],M=D.indexOf(v);M>=0&&D.splice(M+1,0,c());return}const N=s.value.indexOf(v);N>=0&&s.value.splice(N+1,0,c())}function f(v,R){if(R){const D=R.children??[],M=D.indexOf(v);M>=0&&D.splice(M,1);return}const N=s.value.indexOf(v);N>=0&&s.value.splice(N,1),s.value.length==0&&s.value.push(c())}function h(v){v.type!==ue.ARRAY&&v.type!==ue.OBJECT||(v.children==null&&(v.children=[]),v.children.push(c()))}function E(v,R){v.type=R,R===ue.ARRAY||R===ue.OBJECT?v.$expand=!0:v.children=void 0}function S(){return{fields:s.value.map(R=>ve(R.name)?null:R.type!==ue.ARRAY&&R.type!==ue.OBJECT?{type:R.type,name:R.name,title:R.title}:{type:R.type,name:R.name,title:R.title,children:(R.children??[]).map(N=>ve(R.name)?null:{type:N.type,name:N.name,title:N.title}).filter(N=>N!=null)}).filter(R=>R!=null)}}function u(v,R){n.readonly===!0&&t("select",v,R)}return o==null||o.useHandle("confirm",S),e({submit:S}),function(){return g("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[g(ws,{columns:r,data:s.value,onSelect:u},null)])}}}),Na="_form_6lybl_2",xa="_readonly_6lybl_6",Ma="_datasource_6lybl_11",Da={form:Na,readonly:xa,datasource:Ma},qa={classes:Da},Ho=U(Oa,[["__cssModules",qa]]),Aa={class:"quickprint-config-group"},$a={class:"quickprint-config-section quickprint-config-inline"},Ba={class:"quickprint-config-content"},Pa={class:"quickprint-config-section quickprint-config-inline"},Va={class:"quickprint-config-content"},za={class:"quickprint-config-id"},Fa={class:"quickprint-config-section quickprint-config-inline"},Ua={class:"quickprint-config-content"},Ha={class:"quickprint-config-group"},Ga={class:"quickprint-config-group-title"},Wa=A({__name:"Detail",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k(()=>{var l;return(l=nl(e.element))==null?void 0:l.content});return(l,o)=>(w(),I("div",{class:m(l.classes.detail)},[d("div",Aa,[d("section",$a,[o[0]||(o[0]=d("header",{class:"quickprint-config-header"},"类型",-1)),d("div",Ba,te(b(wn)(n.element.type)),1)]),d("section",Pa,[o[1]||(o[1]=d("header",{class:"quickprint-config-header"},"标识",-1)),d("div",Va,[d("span",za,te(n.element.id),1)])]),d("section",Fa,[o[2]||(o[2]=d("header",{class:"quickprint-config-header"},"标题",-1)),d("div",Ua,te(n.element.title),1)])]),d("div",Ha,[d("div",Ga,[o[3]||(o[3]=d("span",null,"数据",-1)),d("span",{class:m(l.classes.type)},te(b(ya)(n.element.ds.type)),3)]),d("div",null,te(t.value),1)])],2))}}),Xa="_detail_11ox4_2",Ya="_type_11ox4_10",ja={detail:Xa,type:Ya},Za={classes:ja},Ka=U(Wa,[["__cssModules",Za]]),Ja=A({__name:"index",props:{doc:{type:Ce,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=Te();function r(h){return h.reduce((E,S)=>{const u=Array.isArray(S.children)?r(S.children):[];if(Rt(S.ds.value)||u.length>0){const v={value:S.id,label:S.title??S.id,data:S,children:u};return E.push(v),E}return E},[])}function i(){const h=l.doc.pages.reduce((S,u)=>S.concat(u.children),[]),E=r(h);return Te(E)}function a(h){s.value=h}function c(h){return h.title?h.title:wn(h.type)}function p(h){return Yg(h.type)??"icon-zhanweifu"}function f(h){t("select",h.data)}return(h,E)=>(w(),I("div",{class:m(h.classes.reference)},[d("div",{class:m([h.classes.panel,"quickprint-is-scrollable"])},[g(b(ar),{data:b(o),onNodeHover:a,onNodeClick:f},{default:he(({node:S})=>[g(b(G),{icon:p(S.data)},null,8,["icon"]),d("span",{class:m(h.classes.title)},te(c(S.data)),3),d("span",{class:m(h.classes.id)},"<"+te(S.value)+">",3)]),_:1},8,["data"])],2),d("div",{class:m([h.classes.detail,"quickprint-is-scrollable"])},[s.value?(w(),le(Ka,{element:s.value.data,key:s.value.value},null,8,["element"])):Y("",!0)],2)],2))}}),Qa="_reference_1ekkx_2",ec="_panel_1ekkx_12",tc="_detail_1ekkx_20",nc="_title_1ekkx_25",lc="_id_1ekkx_29",oc={reference:Qa,panel:ec,detail:tc,title:nc,id:lc},sc={classes:oc},ic=U(Ja,[["__cssModules",sc]]),rc=A({__name:"index",props:{doc:{type:Ce,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=at();function t(r,i){return r==null?null:i==null?`${Ut.DS}.${r.type}.${r.name}`:`${Ut.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${Ut.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(w(),I("div",{class:m(r.classes.var)},[n.active==="ds"?(w(),le(Ho,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):Y("",!0),n.active==="builtin"?(w(),le(Ia,{key:1,onSelect:o})):Y("",!0),n.active==="reference"?(w(),le(ic,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):Y("",!0)],2))}}),ac={var:"_var_12wxd_2"},cc={classes:ac},Go=U(rc,[["__cssModules",cc]]),uc=["onClick","onMouseenter"],dc=A({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var a;const t=n,l=e,o=Te((a=t.options[0])==null?void 0:a.value),s=k(()=>`${t.type}_${o.value.toLowerCase()}`);function r(c){l("select",c.value)}function i(c){o.value=c.value}return(c,p)=>(w(),I("div",{class:m(c.classes.doc)},[d("div",{class:m(["quickprint-is-scrollable",c.classes.panel])},[(w(!0),I(se,null,fe(n.options,f=>(w(),I("div",{key:f.value,class:m({[c.classes.option]:!0,[c.classes.active]:f.value===o.value}),onClick:h=>r(f),onMouseenter:h=>i(f)},[d("strong",null,te(f.label),1)],42,uc))),128))],2),d("div",{class:m(["quickprint-is-scrollable",c.classes.desc])},[g(b(Uo),{name:s.value},null,8,["name"])],2)],2))}}),pc="_doc_1pdoc_2",fc="_panel_1pdoc_10",mc="_desc_1pdoc_16",gc="_option_1pdoc_23",hc="_active_1pdoc_33",vc={doc:pc,panel:fc,desc:mc,option:gc,active:hc},bc={classes:vc},gn=U(dc,[["__cssModules",bc]]),yc=A({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=at(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(a){return e==null?void 0:e.confirm({type:"function",value:`${a}()`})}return(a,c)=>(w(),I("div",{class:m(a.classes.function)},[n.active==="string"?(w(),le(gn,{options:t,onSelect:i,key:"string"})):Y("",!0),n.active==="number"?(w(),le(gn,{options:l,onSelect:i,key:"number"})):Y("",!0),n.active==="logical"?(w(),le(gn,{options:o,onSelect:i,key:"logical"})):Y("",!0),n.active==="date"?(w(),le(gn,{options:s,onSelect:i,key:"date"})):Y("",!0),n.active==="aggregate"?(w(),le(gn,{options:r,onSelect:i,key:"aggregate"})):Y("",!0)],2))}}),_c={function:"_function_19szx_2"},Ec={classes:_c},Tc=U(yc,[["__cssModules",Ec]]),Sc=["onMouseenter"],Rc=["onClick"],wc={key:1},kc=A({__name:"Formula",props:{doc:{type:Ce,default:null}},setup(n){const e=n,t=at(),l=[{id:"pageNumber",name:"页码",options:a(pi)}],o=Te(l[0]);function s(c){o.value=c}function r(c){return t==null?void 0:t.confirm({type:"formula",value:c})}function i(c){const p=Gn.tokenize(c),f=e.doc;return p.reduce((h,E)=>{if(E.type===wt.VARIABLE)return h.push({type:"highlight",value:yt(E.value,f==null?void 0:f.ds)}),h;if(E.type===wt.REFERENCE)return h.push({type:"highlight",value:Fo(E.value,f)}),h;if(E.type===wt.TEMPLATE){const u=(Array.isArray(E.value)?E.value:[E.value]).map(v=>v.type===wt.VARIABLE?{type:"highlight",value:yt(v.value,f.ds)}:{type:"text",value:v.value});return h.concat(u)}return h.push({type:"text",value:Gn.formatTokenValue(E)}),h},[])}function a(c){return c.map(p=>({nodes:i(p),value:p}))}return(c,p)=>(w(),I("div",{class:m(c.classes.formula)},[d("div",{class:m([c.classes.left,"quickprint-is-scrollable"])},[(w(),I(se,null,fe(l,f=>d("div",{key:f.name,onMouseenter:h=>s(f),class:m({[c.classes.group]:!0,[c.classes.active]:f.id===o.value.id})},te(f.name),43,Sc)),64))],2),d("div",{class:m(c.classes.right)},[(w(!0),I(se,null,fe(o.value.options,(f,h)=>(w(),I("div",{key:h,class:m(c.classes.code),onClick:E=>r(f.value)},[(w(!0),I(se,null,fe(f.nodes,E=>(w(),I(se,null,[E.type==="highlight"?(w(),I("span",{key:0,class:m(c.classes.highlight)},"["+te(E.value)+"]",3)):(w(),I("span",wc,te(E.value),1))],64))),256)),d("span",{class:m(c.classes.badge)},"插入",2)],10,Rc))),128))],2)],2))}}),Lc="_formula_ms7c3_2",Cc="_left_ms7c3_12",Ic="_right_ms7c3_17",Oc="_group_ms7c3_24",Nc="_active_ms7c3_34",xc="_highlight_ms7c3_39",Mc="_code_ms7c3_43",Dc="_badge_ms7c3_65",qc={formula:Lc,left:Cc,right:Ic,group:Oc,active:Nc,highlight:xc,code:Mc,badge:Dc},Ac={classes:qc},$c=U(kc,[["__cssModules",Ac]]),xl=Me(function(n){return nt("变量",(e,t)=>g(Go,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Ne)}),Bc=Me(function(n){return bt("数据源",g(Ho,{doc:n},null),{preset:"variable",icon:g(G,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Ne)}),Pc=Me(function(n){const e=["ds","builtin","reference"];return nt("变量",(t,l)=>g(Go,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Ne)}),Vc=Me(function(){return nt("函数",(n,e)=>g(Tc,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(Ne)}),zc=Me(function(n){return bt("公式",g($c,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Ne)}),Fc={key:1},Uc=A({__name:"Content",props:{element:{type:me,required:!0},showDS:{type:Boolean,default:!0}},setup(n){const e=n,t=Oe(),l=be(),o=be(),s=Te(!1),r=k(()=>{const p=e.element.type===F.TABLE_CELL?Ol(e.element,{exclude:["border"]}):Ln(e.element);return p.color&&(p["--quickprint-element-var-color"]=p.color),s.value&&(p.alignItems="flex-start"),p}),i=k(()=>{const p=nl(e.element);return p==null||p.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:p.type===we.CONST?"span":"strong",content:p.content},{tag:"span",content:e.element.attributes.suffix}]});async function a(){var E;const p=await xl({doc:t.doc,value:e.element.ds.value}).catch(gt);if(p==null||(e.element.setDataSource(we.VARIABLE,p.value),e.element.type!=F.TABLE_CELL||p.type!=="ds"))return;const f=e.element.parent;if(f==null||f.isBindVariable||((E=p.parent)==null?void 0:E.type)!==ue.ARRAY)return;const h=p.parent;f.setDataSource(we.VARIABLE,`${Ut.DS}.${h.type}.${h.name}`)}function c(){const p=l.value,f=o.value;p==null||f==null||(s.value=f.offsetHeight>p.offsetHeight)}return(p,f)=>(w(),I("div",{class:"quickprint-is-element-editor",style:Z(r.value),onVnodeMounted:c,ref_key:"editorRef",ref:l},[d("span",{ref_key:"contentRef",ref:o,class:m(["quickprint-is-content",{[p.classes.lineThrough]:n.element.style.lineThrough}])},[(w(!0),I(se,null,fe(i.value,(h,E)=>(w(),I(se,{key:E},[h.tag=="strong"?(w(),I("strong",{key:0,class:m(p.classes.highlight)},"["+te(h.content)+"]",3)):h.tag=="span"&&h.content?(w(),I("span",Fc,te(h.content),1)):Y("",!0)],64))),128))],2),n.showDS&&n.element.isBindVariable?(w(),le(b(G),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(p.classes.dsIcon),onClick:a,onPointerdown:f[0]||(f[0]=pe(()=>{},["stop"]))},null,8,["class"])):Y("",!0)],4))}}),Hc="_dsIcon_1d2si_2",Gc="_lineThrough_1d2si_11",Wc="_highlight_1d2si_15",Xc={dsIcon:Hc,lineThrough:Gc,highlight:Wc},Yc={classes:Xc},cn=U(Uc,[["__cssModules",Yc]]),jc=A({__name:"TextEditor",props:{element:{type:ks,required:!0}},setup(n){return(e,t)=>(w(),le(cn,{element:n.element},null,8,["element"]))}}),ll=Object.freeze({title:"文本",icon:"icon-text",type:F.TEXT,editor:jc,onCreate(){return me.create({type:F.TEXT,width:et,height:el})}}),Zc=A({__name:"NumberEditor",props:{element:{type:Ls,required:!0}},setup(n){return(e,t)=>(w(),le(cn,{element:n.element},null,8,["element"]))}}),Kc=["value","disabled"],Jc=A({__name:"RadioButton",props:Gt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=kn(n,"modelValue");return(t,l)=>(w(),I("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(w(!0),I(se,null,fe(n.options,o=>(w(),I("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[xe(d("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,Kc),[[Zs,e.value]]),d("span",null,te(o.label),1)],2))),256))],2))}}),Qc="_radioGroup_67myk_2",eu="_compacted_67myk_10",tu="_radio_67myk_2",nu="_selected_67myk_50",lu="_disabled_67myk_56",ou={radioGroup:Qc,compacted:eu,radio:tu,selected:nu,disabled:lu},su={classes:ou},Ct=U(Jc,[["__cssModules",su]]),iu={class:"quickprint-config-section quickprint-config-inline"},ru={class:"quickprint-config-content"},au={class:"quickprint-config-section quickprint-config-inline"},cu={class:"quickprint-config-content"},uu={class:"quickprint-config-section quickprint-config-inline"},du={class:"quickprint-config-content"},pu={class:"quickprint-config-section quickprint-config-inline"},fu={class:"quickprint-config-content"},mu=A({__name:"NumberConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=k({get(){return e.element.attributes.round??vn.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=k({get(){return e.element.attributes.format??At.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(w(),I(se,null,[d("section",iu,[r[4]||(r[4]=d("header",{class:"quickprint-config-header"},"小数位数",-1)),d("div",ru,[xe(d("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",step:"1",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ue,n.element.attributes.precision]])])]),d("section",au,[r[5]||(r[5]=d("header",{class:"quickprint-config-header"},"舍入规则",-1)),d("div",cu,[g(b(re),{options:b(ni),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),d("section",uu,[r[6]||(r[6]=d("header",{class:"quickprint-config-header"},"显示类型",-1)),d("div",du,[g(b(re),{options:b(li),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),d("section",pu,[r[7]||(r[7]=d("header",{class:"quickprint-config-header"},"值为0时",-1)),d("div",fu,[g(Ct,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:b(oi),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),ol=Object.freeze({title:"数字",type:F.NUMBER,icon:"icon-number",editor:Zc,config:{display:mu},onCreate(){return me.create({type:F.NUMBER,width:et,height:el})}}),gu=A({__name:"DateEditor",props:{element:{type:Cs,required:!0}},setup(n){return(e,t)=>(w(),le(cn,{element:n.element},null,8,["element"]))}}),hu={class:"quickprint-config-section"},vu={class:"quickprint-config-content"},bu=A({__name:"DateConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=k(()=>[{label:"原始值",value:t.NONE},...Oo]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(w(),I("section",hu,[d("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=d("span",null,"格式",-1)),g(b(re),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:he(()=>[d("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),d("div",vu,[xe(d("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ue,n.element.attributes.format]])])]))}}),yu="_header_79607_2",_u="_picker_79607_8",Eu="_placeholder_79607_15",Tu={header:yu,picker:_u,placeholder:Eu},Su={classes:Tu},Ru=U(bu,[["__cssModules",Su]]),sl=Object.freeze({title:"日期",type:F.DATE,icon:"icon-date",editor:gu,config:{display:Ru},onCreate(){return me.create({type:F.DATE,width:et,height:el})}}),wu=["x1","y1","x2","y2"],ku=A({__name:"Diagonal",props:{mode:{type:Number,default:0},labels:{type:Array,default:null},width:{type:Number,default:null},height:{type:Number,default:null}},setup(n){const e=De("classes"),t=n,l=k(()=>t.mode===Ve.TL_BR?{x1:"0",y1:"0",x2:"100%",y2:"100%"}:t.mode===Ve.TR_BL?{x1:"100%",y1:"0",x2:"0",y2:"100%"}:null),o=k(()=>({[e.biagonal]:!0,[e.tlbr]:t.mode===Ve.TL_BR,[e.trbl]:t.mode===Ve.TR_BL})),s=k(()=>({width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"})),r=k(()=>{var a,c;return(c=(a=t.labels)==null?void 0:a[0])==null?void 0:c.text}),i=k(()=>{var a,c;return(c=(a=t.labels)==null?void 0:a[1])==null?void 0:c.text});return(a,c)=>(w(),I("div",{class:m(o.value),style:Z(s.value)},[l.value?(w(),I("svg",{key:0,class:m(b(e).line)},[d("line",{x1:l.value.x1,y1:l.value.y1,x2:l.value.x2,y2:l.value.y2},null,8,wu)],2)):Y("",!0),r.value?(w(),I("div",{key:1,class:m(b(e).firstLabel)},te(r.value),3)):Y("",!0),i.value?(w(),I("div",{key:2,class:m(b(e).secondLabel)},te(i.value),3)):Y("",!0)],6))}}),Lu="_biagonal_17a80_2",Cu="_firstLabel_17a80_9",Iu="_secondLabel_17a80_10",Ou="_tlbr_17a80_15",Nu="_trbl_17a80_26",xu="_line_17a80_37",Mu={biagonal:Lu,firstLabel:Cu,secondLabel:Iu,tlbr:Ou,trbl:Nu,line:xu},Du={classes:Mu},Xn=U(ku,[["__cssModules",Du]]),qu=["colspan","rowspan"],Au=A({__name:"TableCellEditor",props:{element:{type:Rn,required:!0}},setup(n){const e=n,t=k(()=>e.element.isCollapsed),l=k(()=>{const h=e.element.attributes.diagonalMode;return h==null?!1:h!==Ve.NONE}),o=Oe(),s=De("classes"),r=k(()=>{const h=e.element,E=h.parent;return{[s.cell]:!0,[ne.SELECTED]:(E==null?void 0:E.isSelected)||h.isSelected}}),i=k(()=>{var u;const h=Ft((u=e.element.parent)==null?void 0:u.parent),E=Ft(e.element.parent),S=Ft(e.element);return{...p(e.element),...f(e.element),...Object.assign(h,E,S)}}),a=k(()=>{const h=Ol(e.element,{exclude:["border","padding"]});return h.color&&(h["--quickprint-element-var-color"]=h.color),h});function c(h){h.button==0&&(h.ctrlKey?o.toggleMultiSelectedElement(e.element):o.selectElement(e.element))}function p(h){const E=h.findPrevDisplayedCell(),S=h.findNextDisplayedCell(),u=h.table,v=K(h,"left")??K(h.parent,"left")??K(u,"left"),R=K(E,"right")??K(E==null?void 0:E.parent,"right")??K(u,"right"),N=K(h,"right")??K(h.parent,"right")??K(u,"right"),D=K(S,"left")??K(S==null?void 0:S.parent,"left")??K(u,"left"),M=Math.max(ce.processLengthToPX(v)??1,ce.processLengthToPX(R)??1),O=Math.max(ce.processLengthToPX(N)??1,ce.processLengthToPX(D)??1);return{"--quickprint-cell-width":e.element.offsetWidth+"px","--quickprint-cell-border-left-width":M+"px","--quickprint-cell-border-right-width":O+"px"}}function f(h){var q,Q;const E=h.index,S=h.table,u=(q=h.findPrevDisplayedRow())==null?void 0:q.children[E],v=(Q=h.findNextDisplayedRow())==null?void 0:Q.children[E],R=K(h,"top")??K(h.parent,"top")??K(S,"top"),N=K(u,"bottom")??K(u==null?void 0:u.parent,"bottom")??K(S,"bottom"),D=K(h,"bottom")??K(h.parent,"bottom")??K(S,"bottom"),M=K(v,"top")??K(v==null?void 0:v.parent,"top")??K(S,"top"),O=Math.max(ce.processLengthToPX(R)??1,ce.processLengthToPX(N)??1),C=Math.max(ce.processLengthToPX(D)??1,ce.processLengthToPX(M)??1);return{"--quickprint-cell-height":h.offsetHeight+"px","--quickprint-cell-border-top-width":O+"px","--quickprint-cell-border-bottom-width":C+"px"}}return(h,E)=>t.value?Y("",!0):(w(),I("td",wo({key:0,[`.${b(rt)||""}`]:n.element,class:r.value,style:i.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:pe(c,["stop"])}),[l.value?(w(),le(Xn,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight,style:Z(a.value)},null,8,["mode","labels","width","height","style"])):(w(),le(cn,{key:1,element:n.element,class:m(b(s).content)},null,8,["element","class"]))],48,qu))}}),$u="_cell_bnxf6_2",Bu="_content_bnxf6_32",Pu={cell:$u,content:Bu},Vu={classes:Pu},Wo=U(Au,[["__cssModules",Vu]]);function Xo(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const zu=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:Ee.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],Yo=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],jo=[{label:"默认",value:Ee.DEFAULT},...Yo],il=[{label:"默认",value:Ee.DEFAULT},...zu,...Yo],Ml=[{label:"默认",value:$e.DEFAULT},{label:"初号",value:$e.SIZE_0+"pt",short:"56px"},{label:"小初",value:$e.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:$e.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:$e.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:$e.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:$e.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:$e.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:$e.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:$e.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:$e.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:$e.SIZE_5+"pt",short:"14px"},{label:"小五",value:$e.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],Zo=[{label:"默认",value:$t.DEFAULT},{label:"1.0",value:$t.TIMES_1,short:"单倍行距"},{label:"1.1",value:$t.TIMES_1_1},{label:"1.5",value:$t.TIMES_1_5},{label:"2.0",value:$t.TIMES_2,short:"两倍行距"}],Fu=[{label:"无",value:Dn.NONE},{label:"实线",value:Yt.SOLID},{label:"虚线",value:Yt.DASHED},{label:"点划线",value:Yt.DOTTED},{label:"双实线",value:Yt.DOUBLE},{label:"波浪线",value:Yt.WAVY}],Uu=[{label:"无",value:ie.NONE},{label:"实线",value:ie.SOLID},{label:"虚线",value:ie.DASHED},{label:"点划线",value:ie.DOTTED},{label:"双实线",value:ie.DOUBLE}],Hu=[{label:"默认",value:Bt.AUTO},{label:"左对齐",value:Bt.LEFT},{label:"居中对齐",value:Bt.CENTER},{label:"右对齐",value:Bt.RIGHT},{label:"两端对齐",value:Bt.JUSTIFY}],Tl=[{label:"顶部对齐",value:ht.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:ht.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:ht.BOTTOM,icon:"icon-vertical-align-bottom"}],Sl=[{label:"左对齐",value:kt.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:kt.CENTER,icon:"icon-align-center"},{label:"右对齐",value:kt.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:kt.JUSTIFY,icon:"icon-menu"}],Gu={class:"quickprint-is-row"},Wu=["onClick"],Xu=A({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=De("classes"),o=e,s=n,r=be(),i=k(()=>({height:s.height})),a=k({get(){return Lt(s.modelValue).num??void 0},set(S){if(S==""||Is(S)||S<0){f(void 0);return}const u=Lt(s.modelValue);f(`${S}${u.unit}`)}}),c=k({get(){return Lt(s.modelValue).unit??de.PX},set(S){const u=Lt(s.modelValue);f(`${u.num}${S}`)}});function p(S){const u=S===$e.DEFAULT?void 0:S;o("update:modelValue",u)}function f(S){o("update:modelValue",S),E()}function h(S){const u=s.modelValue;return u==null&&S.value===$e.DEFAULT?!0:u===S.value}async function E(){await rn();const S=document.querySelector("."+l.fontSelected);S&&S.scrollIntoView({block:"nearest"})}return(S,u)=>(w(),I("div",{class:m(b(l).fontSize),style:Z(i.value)},[d("div",Gu,[xe(d("input",{type:"number",step:"any",placeholder:"请输入",class:m(["quickprint-form-control",b(l).input]),min:0,"onUpdate:modelValue":u[0]||(u[0]=v=>a.value=v)},null,2),[[Ue,a.value]]),g(b(re),{width:"54px",options:t,modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=v=>c.value=v)},null,8,["modelValue"])]),d("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(l).fonts]),ref_key:"scrollRef",ref:r},[(w(!0),I(se,null,fe(b(Ml),v=>(w(),I("div",{key:v.value,class:m({[b(l).option]:!0,[b(l).fontSelected]:h(v)}),onClick:R=>p(v.value)},[d("span",null,te(v.label),1)],10,Wu))),128))],2)],6))}}),Yu="_input_9oh9n_2",ju="_fontSize_9oh9n_8",Zu="_fonts_9oh9n_13",Ku="_option_9oh9n_25",Ju="_fontSelected_9oh9n_34",Qu={input:Yu,fontSize:ju,fonts:Zu,option:Ku,fontSelected:Ju},ed={classes:Qu},Ko=U(Xu,[["__cssModules",ed]]),td=["title"],nd={key:0},ld="中文字体 AbBbCc",od=A({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k(()=>il.map(u=>(u.style={fontFamily:u.value==Ee.DEFAULT?Ee.SONG:u.value},u))),l=k(()=>jo.map(u=>(u.style={fontFamily:u.value==Ee.DEFAULT?Ee.SONG:u.value},u))),o=k({get(){const u=e.options.style.fontFamily;return ve(u)?Ee.DEFAULT:u},set(u){e.options.style.fontFamily=u==Ee.DEFAULT?void 0:u}}),s=k({get(){const u=e.options.style.enFontFamily;return ve(u)?Ee.DEFAULT:u},set(u){e.options.style.enFontFamily=u==Ee.DEFAULT?void 0:u}}),r=k({get(){const u=e.options.style.color;return ve(u)?We.INHERIT:u},set(u){e.options.style.color=u==We.INHERIT?void 0:u}}),i=k({get(){const u=e.options.style.highlightColor;return ve(u)?We.INHERIT:u},set(u){e.options.style.highlightColor=u==We.INHERIT?void 0:u}}),a=k({get(){return e.options.style.fontSize},set(u){const v=ve(u)?void 0:u;e.options.style.fontSize=v}}),c=k({get(){return e.options.style.fontWeight===700},set(u){e.options.style.fontWeight=u?700:void 0}}),p=k({get(){return e.options.style.fontStyle==="italic"},set(u){e.options.style.fontStyle=u?"italic":void 0}}),f=k({get(){return e.options.style.lineThrough===!0},set(u){e.options.style.lineThrough=u?!0:void 0}}),h=k({get(){const u=e.options.style.underline;if(u==null||u===!1)return Dn.NONE;const v=e.options.style.underlineStyle;return ve(v)?Yt.SOLID:v},set(u){if(u===Dn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=u}}),E=k({get(){const u=e.options.style.underlineColor;return ve(u)?We.INHERIT:u},set(u){e.options.style.underlineColor=u==We.INHERIT?void 0:u}}),S=k(()=>{const u=e.options.style,v={},R=Kn(u.fontFamily,u.enFontFamily);R&&(v.fontFamily=R);const N=po(u);return N&&Object.assign(v,N),u.fontSize&&(v.fontSize=u.fontSize),u.fontWeight&&(v.fontWeight=u.fontWeight),u.color&&(v.color=u.color),u.fontStyle&&(v.fontStyle=u.fontStyle),u.highlightColor&&(v["--quickprint-variable-highlight-color"]=u.highlightColor),v});return(u,v)=>(w(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",u.classes.font])},[d("div",{class:m(u.classes.fontFamily)},[d("div",{class:m(u.classes.config)},[d("div",{class:m(u.classes.title)},"中文字体",2),d("div",{class:m(u.classes.content)},[g(b(re),{options:t.value,modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=R=>o.value=R)},null,8,["options","modelValue"])],2)],2),d("div",{class:m(u.classes.config)},[d("div",{class:m(u.classes.title)},"颜色",2),g(b(tn),{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=R=>r.value=R)},null,8,["modelValue"])],2),d("div",{class:m([u.classes.config,u.classes.fontSize])},[d("div",{class:m(u.classes.title)},"字号",2),g(Ko,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=R=>a.value=R),height:"144px"},null,8,["modelValue"])],2),d("div",{class:m(u.classes.config)},[d("div",{class:m(u.classes.title)},"西文字体",2),d("div",{class:m(u.classes.content)},[g(b(re),{options:l.value,modelValue:s.value,"onUpdate:modelValue":v[3]||(v[3]=R=>s.value=R)},null,8,["options","modelValue"])],2)],2),d("div",{class:m(u.classes.config)},[d("div",{class:m(u.classes.title)},"前景色",2),g(b(tn),{modelValue:i.value,"onUpdate:modelValue":v[4]||(v[4]=R=>i.value=R)},null,8,["modelValue"])],2),d("div",{class:m(u.classes.config)},[d("div",{class:m(u.classes.title)},"下划线",2),d("div",{class:m(u.classes.content)},[g(b(re),{modelValue:h.value,"onUpdate:modelValue":v[5]||(v[5]=R=>h.value=R),options:b(Fu),width:"138px"},{option:he(({option:R})=>[d("div",{title:R.label,class:m(u.classes.option)},[R.value==b(Dn).NONE?(w(),I("div",nd,te(R.label),1)):(w(),I("div",{key:1,class:m(u.classes.line),style:Z({textDecorationStyle:R.value})},"--",6))],10,td)]),_:1},8,["modelValue","options"])],2)],2),d("div",{class:m(u.classes.config)},[d("div",{class:m(u.classes.title)},"线条颜色",2),d("div",{class:m(u.classes.content)},[g(b(tn),{modelValue:E.value,"onUpdate:modelValue":v[6]||(v[6]=R=>E.value=R),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),d("div",{class:m(u.classes.fieldset)},[v[13]||(v[13]=d("header",null,"效果",-1)),d("div",{class:m(u.classes.configs)},[d("label",{class:m(u.classes.checkbox)},[xe(d("input",{type:"checkbox","onUpdate:modelValue":v[7]||(v[7]=R=>c.value=R)},null,512),[[gl,c.value]]),v[10]||(v[10]=d("span",null,"粗体",-1))],2),d("label",{class:m(u.classes.checkbox)},[xe(d("input",{type:"checkbox","onUpdate:modelValue":v[8]||(v[8]=R=>p.value=R)},null,512),[[gl,p.value]]),v[11]||(v[11]=d("span",null,"斜体",-1))],2),d("label",{class:m(u.classes.checkbox)},[xe(d("input",{type:"checkbox","onUpdate:modelValue":v[9]||(v[9]=R=>f.value=R)},null,512),[[gl,f.value]]),v[12]||(v[12]=d("span",null,"删除线",-1))],2)],2)],2),d("div",{class:m(u.classes.fieldset)},[v[14]||(v[14]=d("header",null,"预览",-1)),d("div",{class:m(u.classes.preview)},[d("span",{style:Z(S.value)},[d("span",{class:m({[u.classes.lineThrough]:n.options.style.lineThrough})},te(ld),2)],4)],2)],2)],2))}}),sd="_grid2_7i8m3_1",id="_item_7i8m3_1",rd="_itemLabel_7i8m3_1",ad="_fieldset_7i8m3_1",cd="_font_7i8m3_4",ud="_fontFamily_7i8m3_9",dd="_config_7i8m3_16",pd="_fontSize_7i8m3_21",fd="_title_7i8m3_25",md="_configs_7i8m3_30",gd="_checkbox_7i8m3_36",hd="_option_7i8m3_51",vd="_line_7i8m3_59",bd="_preview_7i8m3_70",yd="_lineThrough_7i8m3_85",_d={grid2:sd,item:id,itemLabel:rd,fieldset:ad,font:cd,fontFamily:ud,config:dd,fontSize:pd,title:fd,configs:md,checkbox:gd,option:hd,line:vd,preview:bd,lineThrough:yd},Ed={classes:_d},Td=U(od,[["__cssModules",Ed]]),Sd=["placeholder","min","disabled"],Rd=A({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=k(()=>{const a=l.defaultUnit;return l.options.some(c=>c.value===a)?a:l.options[0].value}),s=k({get(){return Lt(l.modelValue).num},set(a){if(vo(a)){const p=Lt(l.modelValue).unit??o.value;return i(`${a}${p}`)}i()}}),r=k({get(){return Lt(l.modelValue).unit??o.value},set(a){const p=Lt(l.modelValue).num??l.min;i(`${p}${a}`)}});function i(a=void 0){t("update:modelValue",a)}return(a,c)=>(w(),I("div",{class:m(a.classes.input)},[xe(d("input",{type:"number",step:"any","onUpdate:modelValue":c[0]||(c[0]=p=>s.value=p),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,Sd),[[Ue,s.value]]),g(b(re),{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=p=>r.value=p),class:m(a.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),wd="_input_gtdaq_2",kd="_unit_gtdaq_14",Ld={input:wd,unit:kd},Cd={classes:Ld},Re=U(Rd,[["__cssModules",Cd]]),Id="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",Od=A({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:de.NONE},{label:"磅",value:de.PT},{label:"像素",value:de.PX}],l=[{label:"字符",value:de.EM},{label:"磅",value:de.PT},{label:"像素",value:de.PX}],o=[{label:"毫米",value:de.MM},{label:"磅",value:de.PT},{label:"像素",value:de.PX}],s=k({get(){return e.options.style.textAlign??kt.LEFT},set(v){const R=v===kt.LEFT?void 0:v;e.options.style.textAlign=R}}),r=k({get(){return e.options.style.textAlignLast??Bt.AUTO},set(v){const R=v===Bt.AUTO?void 0:v;e.options.style.textAlignLast=R}}),i=k({get(){return e.options.style.verticalAlign??ht.MIDDLE},set(v){const R=v===ht.MIDDLE?void 0:v;e.options.style.verticalAlign=R}}),a=S("paddingTop"),c=S("paddingBottom"),p=S("paddingLeft"),f=S("paddingRight"),h=k(()=>{const v=e.options.style,R={};return v.textAlign&&(R.textAlign=v.textAlign),v.textAlignLast&&(R.textAlignLast=v.textAlignLast),v.textIndent&&(R.textIndent=v.textIndent),v.lineHeight&&(R.lineHeight=v.lineHeight),Object.assign(R,u(v.verticalAlign)),R}),E=k(()=>{const v=e.options.style,R={};return R["--openprint-paragraph-preview-padding-top"]=v.paddingTop??"2px",R["--openprint-paragraph-preview-padding-right"]=v.paddingRight??"2px",R["--openprint-paragraph-preview-padding-bottom"]=v.paddingBottom??"2px",R["--openprint-paragraph-preview-padding-left"]=v.paddingLeft??"2px",R});function S(v){return k({get(){return e.options.style[v]},set(R){const N=ve(R)?void 0:R;e.options.style[v]=N}})}function u(v){return v==null?{}:v==ht.MIDDLE||v==null?{display:"flex",alignItems:"center"}:v==ht.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(v,R)=>(w(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",v.classes.paragraph])},[d("div",{class:m(v.classes.textAlign)},[d("div",{class:m(v.classes.configItem)},[d("div",{class:m(v.classes.configItemLabel)},"文本对齐",2),g(b(re),{options:b(Sl),modelValue:s.value,"onUpdate:modelValue":R[0]||(R[0]=N=>s.value=N)},null,8,["options","modelValue"])],2),d("div",{class:m(v.classes.alignLast)},[d("div",{class:m(v.classes.configItemLabel)},"最后一行",2),g(b(re),{options:b(Hu),modelValue:r.value,"onUpdate:modelValue":R[1]||(R[1]=N=>r.value=N)},null,8,["options","modelValue"])],2)],2),d("div",{class:m(v.classes.configItem)},[d("div",{class:m(v.classes.configItemLabel)},"垂直对齐",2),g(b(re),{options:b(Tl),modelValue:i.value,"onUpdate:modelValue":R[2]||(R[2]=N=>i.value=N)},null,8,["options","modelValue"])],2),d("div",{class:m(v.classes.configItem)},[d("div",{class:m(v.classes.configItemLabel)},"首行缩进",2),g(Re,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":R[3]||(R[3]=N=>n.options.style.textIndent=N),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(v.classes.configItem)},[d("div",{class:m(v.classes.configItemLabel)},"行高",2),g(Re,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":R[4]||(R[4]=N=>n.options.style.lineHeight=N),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(v.classes.fieldset)},[R[9]||(R[9]=d("header",null,"内边距",-1)),d("div",{class:m(v.classes.padding)},[d("div",{class:m(v.classes.paddingItem)},[d("label",{class:m(v.classes.paddingItemLabel)},"上边距",2),g(Re,{modelValue:b(a),"onUpdate:modelValue":R[5]||(R[5]=N=>Be(a)?a.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(v.classes.paddingItem)},[d("label",{class:m(v.classes.paddingItemLabel)},"下边距",2),g(Re,{modelValue:b(c),"onUpdate:modelValue":R[6]||(R[6]=N=>Be(c)?c.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(v.classes.paddingItem)},[d("label",{class:m(v.classes.paddingItemLabel)},"左边距",2),g(Re,{modelValue:b(p),"onUpdate:modelValue":R[7]||(R[7]=N=>Be(p)?p.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(v.classes.paddingItem)},[d("label",{class:m(v.classes.paddingItemLabel)},"右边距",2),g(Re,{modelValue:b(f),"onUpdate:modelValue":R[8]||(R[8]=N=>Be(f)?f.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),d("div",{class:m(v.classes.fieldset)},[R[10]||(R[10]=d("header",null,"预览",-1)),d("div",{class:m(v.classes.preview),style:Z(h.value)},[d("div",{style:Z(E.value),class:m(v.classes.previewText)},[ye(te(Id)+" "),d("div",{class:m(v.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),Nd="_grid2_6gzjg_1",xd="_item_6gzjg_1",Md="_itemLabel_6gzjg_1",Dd="_fieldset_6gzjg_1",qd="_paragraph_6gzjg_4",Ad="_preview_6gzjg_9",$d="_textAlign_6gzjg_25 quickprint-is-row",Bd="_configItem_6gzjg_30 quickprint-is-row",Pd="_alignLast_6gzjg_35 quickprint-is-row",Vd="_configItemLabel_6gzjg_45",zd="_padding_6gzjg_50",Fd="_paddingItem_6gzjg_57",Ud="_paddingItemLabel_6gzjg_63",Hd="_previewText_6gzjg_68",Gd="_paddingPreview_6gzjg_77",Wd={grid2:Nd,item:xd,itemLabel:Md,fieldset:Dd,paragraph:qd,preview:Ad,textAlign:$d,configItem:Bd,alignLast:Pd,configItemLabel:Vd,padding:zd,paddingItem:Fd,paddingItemLabel:Ud,previewText:Hd,paddingPreview:Gd},Xd={classes:Wd},Yd=U(Od,[["__cssModules",Xd]]),jd=["title","onClick"],Zd={key:0},Kd=A({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=De("classes"),t=n,l=[{label:"像素",value:de.PX},{label:"毫米",value:de.MM},{label:"磅",value:de.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=Te(),i=k(()=>{const T=r.value;return T==null?"全部边框":s[T]}),a=k(()=>{const T=r.value;return T==null?!0:T<=o.BORDER_LEFT}),c=k(()=>{const T=r.value;return T==null?!0:T>=o.RADIUS_TOP_LEFT}),p=k(()=>{const T=r.value;return{[e.box]:!0,[e.highlightTopLeft]:T==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:T==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:T==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:T==o.RADIUS_BOTTOM_RIGHT}}),f=k(()=>({...N(o.BORDER_TOP),...N(o.BORDER_RIGHT),...N(o.BORDER_BOTTOM),...N(o.BORDER_LEFT),...R()})),h=k({get(){var L;const T=t.options.style,y=r.value;if(y==null||y>o.BORDER_LEFT)return T.borderWidth;const _=(L=Dt(y))==null?void 0:L.width;if(_!=null)return Reflect.get(T,_)},set(T){const y=t.options.style,_=r.value,L=T??void 0;if(_==null||_>o.BORDER_LEFT){y.borderWidth=L;return}const x=Dt(_);x!=null&&Reflect.set(y,x.width,L)}}),E=k({get(){var L;const T=t.options.style,y=r.value;if(y==null||y>o.BORDER_LEFT)return T.borderStyle??ie.NONE;const _=(L=Dt(y))==null?void 0:L.style;return _==null?ie.NONE:Reflect.get(T,_)??ie.NONE},set(T){const y=t.options.style,_=r.value,L=T==null||T==ie.NONE?void 0:T;if(_==null||_>o.BORDER_LEFT){y.borderStyle=L;return}const x=Dt(_);x!=null&&Reflect.set(y,x.style,L)}}),S=k({get(){var L;const T=t.options.style,y=r.value;if(y==null||y>o.BORDER_LEFT)return T.borderColor;const _=(L=Dt(y))==null?void 0:L.color;return _==null?We.INHERIT:Reflect.get(T,_)??We.INHERIT},set(T){const y=t.options.style,_=r.value,L=T??void 0;if(_==null||_>o.BORDER_LEFT){y.borderColor=L;return}const x=Dt(_);x!=null&&Reflect.set(y,x.color,L)}}),u=k({get(){const T=t.options.style,y=r.value;if(y==null||y<=o.BORDER_LEFT)return T.borderRadius;const _=v(y);if(_!=null)return Reflect.get(T,_)},set(T){const y=t.options.style,_=r.value,L=T??void 0;if(_==null||_<=o.BORDER_LEFT){y.borderRadius=L;return}const x=v(_);x!=null&&Reflect.set(y,x,L)}});function v(T){switch(T){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function R(){const T=t.options.style;return{borderTopLeftRadius:T.borderTopLeftRadius??T.borderRadius,borderTopRightRadius:T.borderTopRightRadius??T.borderRadius,borderBottomRightRadius:T.borderBottomRightRadius??T.borderRadius,borderBottomLeftRadius:T.borderBottomLeftRadius??T.borderRadius}}function N(T){const y=t.options.style;if(T==null||T>o.BORDER_LEFT){const x=y.borderStyle;return x==null||x==ie.NONE?{borderStyle:ie.NONE}:{}}const _=Dt(T);if(_==null)return{};const L=Reflect.get(y,_.style)??Reflect.get(y,"borderStyle");return L==null||L===ie.NONE?{}:{[_.style]:L??y.borderStyle,[_.width]:Reflect.get(y,_.width)??y.borderWidth,[_.color]:Reflect.get(y,_.color)??y.borderColor??We.BLACK}}function D(T){E.value=T}function M(T){r.value=T===r.value?void 0:T}function O(){const T=t.options.style;T.borderStyle=void 0,T.borderColor=void 0,T.borderWidth=void 0,T.borderTopStyle=void 0,T.borderTopColor=void 0,T.borderTopWidth=void 0,T.borderRightStyle=void 0,T.borderRightColor=void 0,T.borderRightWidth=void 0,T.borderBottomStyle=void 0,T.borderBottomColor=void 0,T.borderBottomWidth=void 0,T.borderLeftStyle=void 0,T.borderLeftColor=void 0,T.borderLeftWidth=void 0}function C(){const T=t.options.style;T.borderTopStyle==ie.NONE&&(T.borderTopStyle=void 0),T.borderRightStyle==ie.NONE&&(T.borderRightStyle=void 0),T.borderBottomStyle==ie.NONE&&(T.borderBottomStyle=void 0),T.borderLeftStyle==ie.NONE&&(T.borderLeftStyle=void 0),T.borderStyle=ie.SOLID}function q(){const T=t.options.style;T.borderStyle=void 0,T.borderRightStyle=void 0,T.borderRightColor=void 0,T.borderRightWidth=void 0,T.borderLeftStyle=void 0,T.borderLeftColor=void 0,T.borderLeftWidth=void 0,T.borderTopStyle=ie.SOLID,T.borderBottomStyle=ie.SOLID}function Q(T){const y=t.options.style,_=v(T)??"borderRadius",L=Reflect.get(y,_);return Pe(L)}function oe(){const T=t.options.style;return Pe(T.borderRadius)??0}function W(T){const y=Math.min(Math.max(12,Q(T)??oe(),X(T)),36),_={width:y+"px",height:y+"px"};return r.value==T&&(_.backgroundColor="var(--radius-highlight-background-color)"),T==o.RADIUS_TOP_LEFT&&(_.top="-6px",_.left="-6px"),T==o.RADIUS_TOP_RIGHT&&(_.top="-6px",_.right="-6px"),T==o.RADIUS_BOTTOM_RIGHT&&(_.bottom="-6px",_.right="-6px"),T==o.RADIUS_BOTTOM_LEFT&&(_.bottom="-6px",_.left="-6px"),_}function X(T){const y=t.options.style;switch(T){case o.RADIUS_TOP_LEFT:{const _=y.borderTopStyle==null||y.borderTopStyle==ie.NONE?0:Pe(y.borderTopWidth),L=y.borderLeftStyle==null||y.borderLeftStyle==ie.NONE?0:Pe(y.borderLeftWidth);return Math.max(_??0,L??0)}case o.RADIUS_TOP_RIGHT:{const _=y.borderTopStyle==null||y.borderTopStyle==ie.NONE?0:Pe(y.borderTopWidth),L=y.borderRightStyle==null||y.borderRightStyle==ie.NONE?0:Pe(y.borderRightWidth);return Math.max(_??0,L??0)}case o.RADIUS_BOTTOM_RIGHT:{const _=y.borderBottomStyle==null||y.borderBottomStyle==ie.NONE?0:Pe(y.borderBottomWidth),L=y.borderRightStyle==null||y.borderRightStyle==ie.NONE?0:Pe(y.borderRightWidth);return Math.max(_??0,L??0)}case o.RADIUS_BOTTOM_LEFT:{const _=y.borderBottomStyle==null||y.borderBottomStyle==ie.NONE?0:Pe(y.borderBottomWidth),L=y.borderLeftStyle==null||y.borderLeftStyle==ie.NONE?0:Pe(y.borderLeftWidth);return Math.max(_??0,L??0)}default:return 0}}function z(T){const y=t.options.style;switch(T){case o.BORDER_TOP:{const _=Math.max(6,Math.min(Q(o.RADIUS_TOP_LEFT)??oe()-6,32)),L=Math.max(6,Math.min(Q(o.RADIUS_TOP_RIGHT)??oe()-6,32)),x={left:_+"px",right:L+"px",top:"-6px",height:"12px"};if(r.value===T&&(x.backgroundColor="var(--border-highlight-background-color)"),y.borderTopStyle==null||y.borderTopStyle==ie.NONE)return x;const $=Pe(y.borderTopWidth);return $==null||(x.height=12+$+"px",x.top=-6-$+"px"),x}case o.BORDER_BOTTOM:{const _=Math.max(6,Math.min(Q(o.RADIUS_BOTTOM_LEFT)??oe()-6,32)),L=Math.max(6,Math.min(Q(o.RADIUS_BOTTOM_RIGHT)??oe()-6,32)),x={left:_+"px",right:L+"px",bottom:"-6px",height:"12px"};if(r.value===T&&(x.backgroundColor="var(--border-highlight-background-color)"),y.borderBottomStyle==null||y.borderBottomStyle==ie.NONE)return x;const $=Pe(y.borderBottomWidth);return $==null||(x.height=12+$+"px",x.bottom=-6-$+"px"),x}case o.BORDER_LEFT:{const _=Math.max(6,Math.min(Q(o.RADIUS_TOP_LEFT)??oe()-6,32)),L=Math.max(6,Math.min(Q(o.RADIUS_BOTTOM_LEFT)??oe()-6,32)),x={top:_+"px",bottom:L+"px",left:"-6px",width:"12px"};if(r.value===T&&(x.backgroundColor="var(--border-highlight-background-color)"),y.borderLeftStyle==null||y.borderLeftStyle==ie.NONE)return x;const $=Pe(y.borderLeftWidth);return $==null||(x.width=12+$+"px",x.left=-6-$+"px"),x}case o.BORDER_RIGHT:{const _=Math.max(6,Math.min(Q(o.RADIUS_TOP_RIGHT)??oe()-6,32)),L=Math.max(6,Math.min(Q(o.RADIUS_BOTTOM_RIGHT)??oe()-6,32)),x={top:_+"px",bottom:L+"px",right:"-6px",width:"12px"};if(r.value===T&&(x.backgroundColor="var(--border-highlight-background-color)"),y.borderRightStyle==null||y.borderRightStyle==ie.NONE)return x;const $=Pe(y.borderRightWidth);return $==null||(x.width=12+$+"px",x.right=-6-$+"px"),x}}}return(T,y)=>(w(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",b(e).settings])},[d("div",{class:m(b(e).presets)},[y[15]||(y[15]=d("span",null,"预设",-1)),d("button",{type:"button",class:"quickprint-text-btn",onClick:O},[d("div",{class:m(b(e).noBorder)},null,2),y[12]||(y[12]=d("span",null,"无边框",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:C},[d("div",{class:m(b(e).outerBorder)},null,2),y[13]||(y[13]=d("span",null,"外部边框",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:q},[d("div",{class:m(b(e).topBottomBorder)},null,2),y[14]||(y[14]=d("span",null,"上下边框",-1))])],2),d("div",{class:m(p.value),style:Z(f.value),onClick:y[8]||(y[8]=pe(()=>{},["stop"]))},[d("div",{class:m(b(e).borderRadius),style:Z(W(o.RADIUS_TOP_LEFT)),onClick:y[0]||(y[0]=_=>M(o.RADIUS_TOP_LEFT))},null,6),d("div",{class:m(b(e).borderRadius),style:Z(W(o.RADIUS_TOP_RIGHT)),onClick:y[1]||(y[1]=_=>M(o.RADIUS_TOP_RIGHT))},null,6),d("div",{class:m(b(e).borderRadius),style:Z(W(o.RADIUS_BOTTOM_LEFT)),onClick:y[2]||(y[2]=_=>M(o.RADIUS_BOTTOM_LEFT))},null,6),d("div",{class:m(b(e).borderRadius),style:Z(W(o.RADIUS_BOTTOM_RIGHT)),onClick:y[3]||(y[3]=_=>M(o.RADIUS_BOTTOM_RIGHT))},null,6),d("div",{class:m(b(e).border),style:Z(z(o.BORDER_TOP)),onClick:y[4]||(y[4]=_=>M(o.BORDER_TOP))},null,6),d("div",{class:m(b(e).border),style:Z(z(o.BORDER_BOTTOM)),onClick:y[5]||(y[5]=_=>M(o.BORDER_BOTTOM))},null,6),d("div",{class:m(b(e).border),style:Z(z(o.BORDER_RIGHT)),onClick:y[6]||(y[6]=_=>M(o.BORDER_RIGHT))},null,6),d("div",{class:m(b(e).border),style:Z(z(o.BORDER_LEFT)),onClick:y[7]||(y[7]=_=>M(o.BORDER_LEFT))},null,6),d("div",{class:m(b(e).borderTitle)},te(i.value),3)],6),d("div",{class:m(b(e).borderSetting)},[d("div",{class:m(b(e).borderStyle)},[d("label",{class:m(b(e).borderStyleTitle)},"线型",2),d("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(e).borderStyleOptions])},[(w(!0),I(se,null,fe(b(Uu),_=>(w(),I("div",{key:_.value,title:_.label,class:m({[b(e).option]:!0,[b(e).selected]:_.value===E.value}),onClick:L=>D(_.value)},[_.value==b(ie).NONE?(w(),I("div",Zd,te(_.label),1)):(w(),I("div",{key:1,class:m(b(e).line),style:Z({textDecorationStyle:_.value})},"--",6))],10,jd))),128))],2)],2),d("div",{class:m(b(e).borderSettingRight)},[d("div",{class:m(b(e).borderItem)},[d("label",{class:m(b(e).borderItemLabel)},"颜色",2),g(b(tn),{modelValue:S.value,"onUpdate:modelValue":y[9]||(y[9]=_=>S.value=_),disabled:!a.value},null,8,["modelValue","disabled"])],2),d("div",{class:m(b(e).borderItem)},[d("label",{class:m(b(e).borderItemLabel)},"宽度",2),g(Re,{modelValue:h.value,"onUpdate:modelValue":y[10]||(y[10]=_=>h.value=_),options:l,disabled:!a.value},null,8,["modelValue","disabled"])],2),d("div",{class:m(b(e).borderItem)},[d("label",{class:m(b(e).borderItemLabel)},"圆角",2),g(Re,{modelValue:u.value,"onUpdate:modelValue":y[11]||(y[11]=_=>u.value=_),options:l,disabled:!c.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),Jd="_settings_60quh_2",Qd="_box_60quh_7",ep="_border_60quh_18",tp="_borderTitle_60quh_29",np="_borderRadius_60quh_38",lp="_borderItem_60quh_49",op="_borderItemLabel_60quh_58",sp="_borderSetting_60quh_64",ip="_borderSettingRight_60quh_69",rp="_borderStyle_60quh_75",ap="_borderStyleOptions_60quh_80",cp="_borderStyleTitle_60quh_87",up="_option_60quh_94",dp="_line_60quh_113",pp="_selected_60quh_124",fp="_presets_60quh_130",mp="_noBorder_60quh_141",gp="_outerBorder_60quh_142",hp="_topBottomBorder_60quh_143",vp={settings:Jd,box:Qd,border:ep,borderTitle:tp,borderRadius:np,borderItem:lp,borderItemLabel:op,borderSetting:sp,borderSettingRight:ip,borderStyle:rp,borderStyleOptions:ap,borderStyleTitle:cp,option:up,line:dp,selected:pp,presets:fp,noBorder:mp,outerBorder:gp,topBottomBorder:hp},bp={classes:vp},yp=U(Kd,[["__cssModules",bp]]),_p=A({__name:"QRCode",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"毫米",value:de.MM},{label:"磅",value:de.PT},{label:"像素",value:de.PX}],l=a("paddingTop"),o=a("paddingBottom"),s=a("paddingLeft"),r=a("paddingRight"),i=k({get(){var c;return(c=e.options.qrcode)==null?void 0:c.barcolor},set(c){e.options.qrcode==null&&(e.options.qrcode={}),e.options.qrcode.barcolor=c}});function a(c){return k({get(){return e.options.style[c]},set(p){const f=ve(p)?void 0:p;e.options.style[c]=f}})}return(c,p)=>(w(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.qrcode])},[d("div",{class:m(c.classes.grid2)},[d("div",{class:m(c.classes.item)},[d("label",{class:m(c.classes.itemLabel)},"码颜色",2),g(b(tn),{modelValue:i.value,"onUpdate:modelValue":p[0]||(p[0]=f=>i.value=f),class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2),d("div",{class:m(c.classes.fieldset)},[p[5]||(p[5]=d("header",null,"内边距",-1)),d("div",{class:m(c.classes.padding)},[d("div",{class:m(c.classes.paddingItem)},[d("label",{class:m(c.classes.paddingItemLabel)},"上边距",2),g(Re,{modelValue:b(l),"onUpdate:modelValue":p[1]||(p[1]=f=>Be(l)?l.value=f:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(c.classes.paddingItem)},[d("label",{class:m(c.classes.paddingItemLabel)},"下边距",2),g(Re,{modelValue:b(o),"onUpdate:modelValue":p[2]||(p[2]=f=>Be(o)?o.value=f:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(c.classes.paddingItem)},[d("label",{class:m(c.classes.paddingItemLabel)},"左边距",2),g(Re,{modelValue:b(s),"onUpdate:modelValue":p[3]||(p[3]=f=>Be(s)?s.value=f:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(c.classes.paddingItem)},[d("label",{class:m(c.classes.paddingItemLabel)},"右边距",2),g(Re,{modelValue:b(r),"onUpdate:modelValue":p[4]||(p[4]=f=>Be(r)?r.value=f:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2)],2))}}),Ep="_grid2_59uck_1",Tp="_item_59uck_1",Sp="_itemLabel_59uck_1",Rp="_fieldset_59uck_1",wp="_qrcode_59uck_4",kp="_padding_59uck_9",Lp="_paddingItem_59uck_16",Cp="_paddingItemLabel_59uck_22",Ip={grid2:Ep,item:Tp,itemLabel:Sp,fieldset:Rp,qrcode:wp,padding:kp,paddingItem:Lp,paddingItemLabel:Cp},Op={classes:Ip},Np=U(_p,[["__cssModules",Op]]),xp=A({__name:"Barcode",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"毫米",value:de.MM},{label:"磅",value:de.PT},{label:"像素",value:de.PX}],l=p("paddingTop"),o=p("paddingBottom"),s=p("paddingLeft"),r=p("paddingRight"),i=k({get(){var f;return(f=e.options.qrcode)==null?void 0:f.barcolor},set(f){e.options.qrcode==null&&(e.options.qrcode={}),e.options.qrcode.barcolor=f}}),a=k({get(){var f;return(f=e.options.barcode)==null?void 0:f.width},set(f){e.options.barcode==null&&(e.options.barcode={}),e.options.barcode.width=f}}),c=k({get(){var f;return(f=e.options.barcode)==null?void 0:f.height},set(f){e.options.barcode==null&&(e.options.barcode={}),e.options.barcode.height=f}});function p(f){return k({get(){return e.options.style[f]},set(h){const E=ve(h)?void 0:h;e.options.style[f]=E}})}return(f,h)=>(w(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",f.classes.qrcode])},[d("div",{class:m(f.classes.grid2)},[d("div",{class:m(f.classes.item)},[d("label",{class:m(f.classes.itemLabel)},"宽度",2),g(Re,{modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=E=>a.value=E),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(f.classes.item)},[d("label",{class:m(f.classes.itemLabel)},"高度",2),g(Re,{modelValue:c.value,"onUpdate:modelValue":h[1]||(h[1]=E=>c.value=E),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(f.classes.item)},[d("label",{class:m(f.classes.itemLabel)},"码颜色",2),g(b(tn),{modelValue:i.value,"onUpdate:modelValue":h[2]||(h[2]=E=>i.value=E),class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2),d("div",{class:m(f.classes.fieldset)},[h[7]||(h[7]=d("header",null,"内边距",-1)),d("div",{class:m(f.classes.padding)},[d("div",{class:m(f.classes.paddingItem)},[d("label",{class:m(f.classes.paddingItemLabel)},"上边距",2),g(Re,{modelValue:b(l),"onUpdate:modelValue":h[3]||(h[3]=E=>Be(l)?l.value=E:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(f.classes.paddingItem)},[d("label",{class:m(f.classes.paddingItemLabel)},"下边距",2),g(Re,{modelValue:b(o),"onUpdate:modelValue":h[4]||(h[4]=E=>Be(o)?o.value=E:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(f.classes.paddingItem)},[d("label",{class:m(f.classes.paddingItemLabel)},"左边距",2),g(Re,{modelValue:b(s),"onUpdate:modelValue":h[5]||(h[5]=E=>Be(s)?s.value=E:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(f.classes.paddingItem)},[d("label",{class:m(f.classes.paddingItemLabel)},"右边距",2),g(Re,{modelValue:b(r),"onUpdate:modelValue":h[6]||(h[6]=E=>Be(r)?r.value=E:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2)],2))}}),Mp="_grid2_59uck_1",Dp="_item_59uck_1",qp="_itemLabel_59uck_1",Ap="_fieldset_59uck_1",$p="_qrcode_59uck_4",Bp="_padding_59uck_9",Pp="_paddingItem_59uck_16",Vp="_paddingItemLabel_59uck_22",zp={grid2:Mp,item:Dp,itemLabel:qp,fieldset:Ap,qrcode:$p,padding:Bp,paddingItem:Pp,paddingItemLabel:Vp},Fp={classes:zp},Up=U(xp,[["__cssModules",Fp]]),Hp="_itemLabel_ivr7p_1",Gp="_fieldset_ivr7p_7",Wp="_item_ivr7p_1",Xp="_grid_ivr7p_37",Yn={itemLabel:Hp,fieldset:Gp,item:Wp,grid:Xp};function Yp(n,e){var l,o;const t={width:n.width??"54px"};return g("label",{class:Yn.item},[g("span",{class:Yn.itemLabel,style:t},[n.label]),(o=(l=e.slots).default)==null?void 0:o.call(l)])}function jp(n,e){var l,o;const t=n.desc?g(Ri,{title:n.desc},null):null;return g("div",{class:Yn.fieldset},[g("header",null,[g("span",null,[n.header]),t]),(o=(l=e.slots).default)==null?void 0:o.call(l)])}function Zp(n,e){var l,o;const t={gridTemplateColumns:`repeat(${n.columns}, 1fr)`,rowGap:n.rowGap,columnGap:n.columnGap};return g("div",{class:Yn.grid,style:t},[(o=(l=e.slots).default)==null?void 0:o.call(l)])}const je={Item:Yp,Fieldset:jp,Grid:Zp},Kp=["min","readonly","placeholder"],Jp=A({__name:"InputNumber",props:Gt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=kn(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const a=e.min?e.min:e.defaultValue;t.value=a;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const a=Math.pow(10,e.precision);t.value=Math.round(i*a)/a}}return(o,s)=>(w(),I("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[xe(d("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),step:"any",min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Kp),[[Ue,t.value]]),n.label?(w(),I("span",{key:0,class:m(o.classes.label)},te(n.label),3)):Y("",!0)],2))}}),Qp="_labelNumber_1aifb_2",ef="_label_1aifb_2",tf="_readonly_1aifb_25",nf={labelNumber:Qp,label:ef,readonly:tf},lf={classes:nf},It=U(Jp,[["__cssModules",lf]]),of=A({__name:"Transform",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k({get(){return e.options.style.scaleX},set(o){e.options.style.scaleX=o}}),l=k({get(){return e.options.style.scaleY},set(o){e.options.style.scaleY=o}});return(o,s)=>(w(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",o.classes.transform])},[g(b(je).Fieldset,{header:"文字缩放",desc:"可以将文字进行缩放。如果只指定X轴缩放，则Y轴将使用X轴的值。"},{default:he(()=>[g(b(je).Grid,{columns:2,columnGap:"24px",rowGap:"4px"},{default:he(()=>[g(b(je).Item,{label:"X轴缩放"},{default:he(()=>[g(It,{modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),"default-value":1,min:0,label:"倍",class:"quickprint-is-fill-w"},null,8,["modelValue"])]),_:1}),g(b(je).Item,{label:"Y轴缩放"},{default:he(()=>[g(It,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=r=>l.value=r),"default-value":1,min:0,label:"倍",class:"quickprint-is-fill-w"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})],2))}}),sf="_transform_1z0nd_2",rf={transform:sf},af={classes:rf},cf=U(of,[["__cssModules",af]]),uf=A({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=at();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(w(),I("div",{class:m(s.classes.setting)},[n.active==="font"?(w(),le(Td,{key:0,options:e.options},null,8,["options"])):Y("",!0),n.active==="paragraph"?(w(),le(Yd,{key:1,options:e.options},null,8,["options"])):Y("",!0),n.active==="border"?(w(),le(yp,{key:2,options:e.options},null,8,["options"])):Y("",!0),n.active=="qrcode"?(w(),le(Np,{key:3,options:e.options},null,8,["options"])):Y("",!0),n.active=="barcode"?(w(),le(Up,{key:4,options:e.options},null,8,["options"])):Y("",!0),n.active=="transform"?(w(),le(cf,{key:5,options:e.options},null,8,["options"])):Y("",!0),d("div",{class:m(s.classes.footer)},[d("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),d("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),df="_setting_1v5ya_2",pf="_footer_1v5ya_9",ff={setting:df,footer:pf},mf={classes:ff},un=U(uf,[["__cssModules",mf]]),gf=A({__name:"Footer",emits:["confirm"],setup(n,{emit:e}){const t=e,l=at();function o(){t("confirm",function(i){l==null||l.confirm(i)})}function s(){l==null||l.cancel()}return(r,i)=>(w(),I("div",{class:m(r.classes.footer)},[d("button",{type:"button",class:"quickprint-text-btn",onClick:s},"取消"),d("button",{type:"button",class:"quickprint-text-btn",onClick:o},"确定")],2))}}),hf="_footer_1ux18_2",vf={footer:hf},bf={classes:vf},Jo=U(gf,[["__cssModules",bf]]),yf=A({__name:"Diagonal",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k({get(){return e.options.diagonalMode??Ve.NONE},set(i){const a=i==Ve.NONE?void 0:i;e.options.diagonalMode=a}}),l=k({get(){var i,a;return(a=(i=e.options.diagonalLabels)==null?void 0:i[0])==null?void 0:a.text},set(i){const a=e.options;a.diagonalLabels==null&&(a.diagonalLabels=[]),a.diagonalLabels[0]==null&&(a.diagonalLabels[0]={}),a.diagonalLabels[0].text=i}}),o=k({get(){var i,a;return(a=(i=e.options.diagonalLabels)==null?void 0:i[1])==null?void 0:a.text},set(i){const a=e.options;a.diagonalLabels==null&&(a.diagonalLabels=[]),a.diagonalLabels[1]==null&&(a.diagonalLabels[1]={}),a.diagonalLabels[1].text=i}});function s(i){t.value=i}function r(i){i(e.options)}return(i,a)=>(w(),I("div",{class:m(i.classes.setting)},[d("div",{class:m(i.classes.main)},[d("div",{class:m(["quickprint-is-row",i.classes.diagonal])},[d("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Ve).NONE}),onClick:a[0]||(a[0]=c=>s(b(Ve).NONE))},null,2),d("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Ve).TL_BR}),onClick:a[1]||(a[1]=c=>s(b(Ve).TL_BR))},[g(Xn,{mode:b(Ve).TL_BR,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2),d("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Ve).TR_BL}),onClick:a[2]||(a[2]=c=>s(b(Ve).TR_BL))},[g(Xn,{mode:b(Ve).TR_BL,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2)],2),d("div",{class:m(i.classes.label)},[d("div",{class:m(i.classes.text)},"顶部文本",2),xe(d("input",{"onUpdate:modelValue":a[3]||(a[3]=c=>l.value=c),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Ue,l.value]])],2),d("div",{class:m(i.classes.label)},[d("div",{class:m(i.classes.text)},"底部文本",2),xe(d("input",{"onUpdate:modelValue":a[4]||(a[4]=c=>o.value=c),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Ue,o.value]])],2)],2),g(Jo,{onConfirm:r})],2))}}),_f="_setting_1u7dq_2",Ef="_main_1u7dq_6",Tf="_cell_1u7dq_10",Sf="_diagonal_1u7dq_25",Rf="_selected_1u7dq_29",wf="_label_1u7dq_34",kf="_text_1u7dq_41",Lf={setting:_f,main:Ef,cell:Tf,diagonal:Sf,selected:Rf,label:wf,text:kf},Cf={classes:Lf},If=U(yf,[["__cssModules",Cf]]);function Qo(n){return ze({style:Sn(n.style??{})})}function Of(n,e){n.style=Object.assign({},n.style,e.style)}function es(n){if(Array.isArray(n)&&n.length>1)return ze({style:{}});const e=Array.isArray(n)?n[0]:n;return ze({width:e.width,height:e.height,diagonalMode:e.attributes.diagonalMode,diagonalLabels:Sn(e.attributes.diagonalLabels??[]),style:Sn(e.style??{})})}const Nf=Me(function(n){return nt("表格",(e,t)=>g(un,{options:Qo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>Of(n,e)).catch(Ne)}),xf=Me(function(n){return nt("表格行",(e,t)=>g(un,{options:Qo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(Ne)}),Mf=Me(function(n){return nt("单元格",(e,t)=>g(un,{options:es(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"},{label:"变换",name:"transform"}]}).promisify().catch(Ne)}),Df=Me(function(n){return bt("斜线表头",g(If,{options:es(n)},null),{width:"360px",top:"15vh",resizeMode:Jt.DISABLED}).promisify().catch(Ne)}),qf={style:{overflow:"hidden"}},Af=A({__name:"TextDirection",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k(()=>e.options.style.writingMode??Xe.HORIZONTAL_TB);function l(s){e.options.style.writingMode=s===Xe.HORIZONTAL_TB?void 0:s}function o(s){s(e.options)}return(s,r)=>(w(),I("div",qf,[d("div",{class:m(s.classes.textDirection)},[d("div",{class:m(s.classes.grid)},[d("div",{title:"水平排版，从左到右",class:m({[s.classes.horizontalTb]:!0,[s.classes.selected]:t.value===b(Xe).HORIZONTAL_TB}),onClick:r[0]||(r[0]=i=>l(b(Xe).HORIZONTAL_TB))},r[5]||(r[5]=[d("p",null,"文字abc",-1)]),2),d("div",{title:"垂直排版，从上到下，从左到右",class:m({[s.classes.verticalLr]:!0,[s.classes.selected]:t.value===b(Xe).VERTICAL_LR}),onClick:r[1]||(r[1]=i=>l(b(Xe).VERTICAL_LR))},r[6]||(r[6]=[d("p",null,"文字abc文字abc",-1),d("p",null,"文字abc→",-1)]),2),d("div",{title:"垂直排版，从上到下，从右到左",class:m({[s.classes.verticalRl]:!0,[s.classes.selected]:t.value===b(Xe).VERTICAL_RL}),onClick:r[2]||(r[2]=i=>l(b(Xe).VERTICAL_RL))},r[7]||(r[7]=[d("p",null,"文字abc文字abc",-1),d("p",null,"文字abc→",-1)]),2),d("div",{title:"垂直排版，从上到下，从右到左",class:m({[s.classes.sidewaysRl]:!0,[s.classes.selected]:t.value===b(Xe).SIDEWAYS_RL}),onClick:r[3]||(r[3]=i=>l(b(Xe).SIDEWAYS_RL))},r[8]||(r[8]=[d("p",null,"文字abc文字abc",-1),d("p",null,"文字abc→",-1)]),2),d("div",{title:"垂直排版，从下到上，从左到右",class:m({[s.classes.sidewaysLr]:!0,[s.classes.selected]:t.value===b(Xe).SIDEWAYS_LR}),onClick:r[4]||(r[4]=i=>l(b(Xe).SIDEWAYS_LR))},r[9]||(r[9]=[d("p",null,"文字abc文字abc",-1),d("p",null,"文字abc→",-1)]),2)],2),d("div",{class:m(s.classes.preview)},r[10]||(r[10]=[d("p",null,"文字abc文字abc",-1),d("p",null,"文字abc文字abc",-1),d("p",null,"文字abc→",-1)]),2)],2),g(Jo,{onConfirm:o})]))}}),$f="_textDirection_qsmbx_2",Bf="_grid_qsmbx_16",Pf="_item_qsmbx_24",Vf="_horizontalTb_qsmbx_36 _item_qsmbx_24",zf="_verticalLr_qsmbx_45 _item_qsmbx_24",Ff="_verticalRl_qsmbx_54 _item_qsmbx_24",Uf="_sidewaysRl_qsmbx_63 _item_qsmbx_24",Hf="_sidewaysLr_qsmbx_72 _item_qsmbx_24",Gf="_preview_qsmbx_81",Wf="_selected_qsmbx_89",Xf={textDirection:$f,grid:Bf,item:Pf,horizontalTb:Vf,verticalLr:zf,verticalRl:Ff,sidewaysRl:Uf,sidewaysLr:Hf,preview:Gf,selected:Wf},Yf={classes:Xf},jf=U(Af,[["__cssModules",Yf]]);function rl(n){if(n.length!==1)return ze({style:{}});const e=n[0],t={style:Sn(e.style??{})};return e.type===F.QRCODE&&(t.qrcode={barcolor:e.attributes.barcolor}),e.type===F.BARCODE&&(t.barcode={barcolor:e.attributes.barcolor,scale:e.attributes.scale,width:e.attributes.width,height:e.attributes.height}),ze(t)}const Zf=Me(function(n){const e=Array.isArray(n)?n:[n],t=rs(e[0].type)??"元素";return nt(t,(l,o)=>g(un,{options:rl(e),active:o},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"},{label:"变换",name:"transform"}]}).promisify()}),ts=Me(function(n){const e=Array.isArray(n)?n:[n];return bt("文字方向",g(jf,{options:rl(e)},null),{width:"424px",height:"285px",top:"15vh",resizeMode:Jt.DISABLED}).promisify()}),Kf=Me(function(n){const e=Array.isArray(n)?n:[n];return nt("二维码属性",(t,l)=>g(un,{options:rl(e),active:l},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"qrcode",active:!0},{label:"边框",name:"border"}]}).promisify()}),Jf=Me(function(n){const e=Array.isArray(n)?n:[n];return nt("条形码属性",(t,l)=>g(un,{options:rl(e),active:l},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"barcode",active:!0},{label:"边框",name:"border"}]}).promisify()});function Qf(n,e){const t=n.parent;return t==null||!t.hasRepeatGroup?[]:[{type:"menu",label:"循环组",icon:"icon-retweet",submenu:[{type:"menu",label:"退出组",disabled(){if(!t.hasRepeatGroup)return!0;const o=e.getTable().children.filter(s=>s.repeatGroup===t.repeatGroup);return o[o.length-1].id!==t.id},handler(){e.exitRepeatGroup(t),e.createSnapshot()}},{type:"menu",label:"删除组",handler(){e.removeRepeatGroup([t]),e.createSnapshot()}}]}]}function em(n,e){const t=n.parent,l=e.getSelectedCells(),o=[];for(const s of l){const r=s.parent;r!=null&&(o.some(i=>i.id===r.id)||o.push(r))}return[{type:"menu",label:"循环组",icon:"icon-retweet",submenu:[{type:"menu",label:"创建组",disabled(){return o.length<2},handler(){e.createRepeatGroup(o),e.createSnapshot()}},{type:"menu",label:"加入组",disabled(){return!!(n.parent.hasRepeatGroup||new Set(o.filter(i=>i.hasRepeatGroup).map(i=>i.repeatGroup)).size!==1)},handler(){e.addRepeatGroup(o),e.createSnapshot()}},{type:"menu",label:"退出组",disabled(){if(!t.hasRepeatGroup)return!0;const r=e.getTable().children.filter(i=>i.repeatGroup===t.repeatGroup);return r[r.length-1].id!==t.id},handler(){e.exitRepeatGroup(t),e.createSnapshot()}},{type:"menu",label:"删除组",disabled(){return o.every(s=>!s.hasRepeatGroup)},handler(){e.removeRepeatGroup(o),e.createSnapshot()}}]}]}function tm(n,e,t){const l={menus:[...ns(e),{type:"divider"},ls(e),Dl(e)]},o=Qf(t,e);o.length>0&&(l.menus.push({type:"divider"}),l.menus.push(...o)),l.menus.push({type:"divider"},os(e),Xo(e.getDesignApi(),e.getTable())),mt.open(n.clientX,n.clientY,l)}function nm(n,e,t,l){const o={menus:[{type:"menu",label:"循环组",icon:"icon-retweet",submenu:[{type:"menu",label:"创建组",handler(){const s=e.createRepeatGroup(t);e.getDesignApi().multiSelectElements(s),e.createSnapshot()}},{type:"menu",label:"加入组",disabled(){return!!(l.parent.hasRepeatGroup||new Set(t.filter(i=>i.hasRepeatGroup).map(i=>i.repeatGroup)).size!==1)},handler(){e.addRepeatGroup(t),e.createSnapshot()}},{type:"menu",label:"删除组",disabled(){return t.every(s=>!s.hasRepeatGroup)},handler(){e.removeRepeatGroup(t),e.createSnapshot()}}]},Dl(e,!0)]};mt.open(n.clientX,n.clientY,o)}function lm(n,e,t){const l=e.getSelectedCells(),o={menus:[...ns(e),{type:"menu",label:"单元格设置",icon:"icon-border",handler(){Mf(l).then(r=>{if(r!=null)for(const i of l)i.style=Object.assign({},i.style,r.style)})}},{type:"divider"}]},s=[];return l.length>=2&&s.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells,disabled(){const r=l.map(c=>c.parent).filter(c=>c!=null);return new Set(r.map(c=>c.repeatGroup)).size>1||new Set(r.map(c=>c.attributes.type)).size>1?!0:new Set(r.map(c=>c.ds.value).filter(c=>Rt(c))).size>1}}),l.some(r=>r.hasSpan)&&s.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),l.length===1&&l[0].noSpan&&s.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),s.length>0&&o.menus.push(...s,{type:"divider"}),o.menus.push(ls(e),Dl(e),{type:"divider"},{type:"menu",label:"斜线表头",icon:"icon-diagonal",handler(){Df(l).then(r=>{if(r!=null)for(const i of l)r.diagonalMode&&(i.attributes.diagonalMode=r.diagonalMode),r.diagonalLabels&&(i.attributes.diagonalLabels=r.diagonalLabels)})}},{type:"menu",label:"文字方向",icon:"icon-text-direction",handler(){ts(l)}},...em(t,e),{type:"divider"},os(e),Xo(e.getDesignApi(),e.getTable())),mt.open(n.clientX,n.clientY,o)}function ns(n){return[{type:"menu",label:"选中表格",icon:"icon-aim",handler:n.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",handler(){Nf(n.getTable())}},{type:"menu",label:"行设置",icon:"icon-table-row",handler(){const e=n.getSelectedElements(),t=e[0];t!=null&&xf(t).then(l=>{if(l!=null)for(const o of e)o.style=Object.assign({},o.style,l.style)})}}]}function ls(n){return{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:n.insertColumnLeft,disabled:n.isSelectTableRow},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:n.insertColumnRight,disabled:n.isSelectTableRow},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:n.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:n.inserRowBottom}]}}function Dl(n,e=!1){return{type:"menu",label:"删除",icon:"icon-delete",submenu:[e?null:{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:n.deleteColumns,disabled:n.isSelectTableRow},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:n.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:n.deleteDataSource}]}}function os(n){return{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:n.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:n.avgTableWidth},{type:"menu",label:"均分表格高度",handler:n.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:n.setOtherRowSameHeight,disabled(){const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:n.setOtherColSameWidth,disabled(){if(n.isSelectTableRow())return!0;const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasColSpan)}}]}}function om(n,e){function t(){return n.element}function l(){return e.getSelectedElements(t())}function o(){return e.createSnapshot()}function s(){const y=t();return l().filter(L=>{var $;if(L.type!==F.TABLE_CELL)return!1;const x=($=L.parent)==null?void 0:$.parent;return x==null?!1:x.id==y.id}).sort(Rn.sort)}function r(){return e.selectElement(t())}function i(){const y=s();if(y.length===0)return!1;const _=St.toArea(y);return t().insertColumn(_.colStart,0),e.createSnapshot(),!0}function a(){const y=s();if(y.length===0)return!1;const _=St.toArea(y);return t().insertColumn(_.colEnd,1),e.createSnapshot(),!0}function c(){if(q()){const L=l()[0];return t().inserRow(L.index,0),e.createSnapshot(),!0}const y=s();if(y.length===0)return!1;const _=St.toArea(y);return t().inserRow(_.rowStart,0),e.createSnapshot(),!0}function p(){const y=t();if(q()){const H=l()[0],B=y.inserRow(H.index,1);return H.hasRepeatGroup&&(B.attributes.repeatGroup=H.repeatGroup),e.createSnapshot(),!0}const _=s();if(_.length===0)return!1;const L=St.toArea(_),x=y.inserRow(L.rowEnd,1),$=y.children[L.rowEnd];return $!=null&&$.hasRepeatGroup&&(x.attributes.repeatGroup=$.repeatGroup),e.createSnapshot(),!0}function f(){var Ae,ot;const y=t(),_=y.page;if(_==null)return;const L=y.doc,x=Pe((Ae=L==null?void 0:L.margins)==null?void 0:Ae.left)??38,$=Pe((ot=L==null?void 0:L.margins)==null?void 0:ot.right)??38,H=y.columns,B=H.reduce((ut,V)=>ut+V,0),P=ce.mm_to_px(_.width)-x-$,ae=[];for(const ut of H){const V=Math.round(ut/B*P);ae.push(V)}const ge=ae.reduce((ut,V)=>ut+V,0),qe=P-ge;ae[ae.length-1]+=qe,y.setColumns(ae),y.updateBoxSize(),e.createSnapshot()}function h(){const y=t(),_=y.columns,L=_.reduce((B,P)=>B+P,0),x=Math.floor(L/_.length),$=new Array(_.length).fill(x),H=L-$.reduce((B,P)=>B+P,0);$[$.length-1]+=H,y.setColumns($),y.updateBoxSize(),e.createSnapshot()}function E(){const y=t(),_=Math.round(y.height/y.children.length);y.children.forEach((L,x)=>y.setRowHeight(x,_)),y.updateBoxSize(),e.createSnapshot()}function S(){const y=l()[0];if(y==null)return;const _=y.type===F.TABLE_ROW?y:y.parent;if(!me.isDefineElement(_)||_.type!=F.TABLE_ROW)return;const L=t(),x=_.height;L.children.forEach($=>$.setRowHeight(x)),L.updateBoxSize(),e.createSnapshot()}function u(){const y=l()[0];if(y==null)return;const _=t(),L=y.width,x=_.attributes.colgroup.map($=>L);_.setColumns(x),_.updateBoxSize(),e.createSnapshot()}function v(){const y=s();if(y.length<2)return;const L=t().mergeCells(y);e.selectElement(L),e.createSnapshot()}function R(){const y=s();if(y.length==0)return;t().splitCells(y),e.createSnapshot()}function N(){const y=s()[0];if(y==null)return;t().removeColumn(y.index),e.resetSelectedElement(),e.createSnapshot()}function D(){if(q()){const x=l(),$=t();for(const H of x){if(H.isFirstRepeatRow){const B=$.children.filter(P=>P.repeatGroup==H.repeatGroup&&P.id!==H.id);W(B)}$.removeRow(H.index)}e.resetSelectedElement(),e.createSnapshot();return}const y=s();if(y.length==0)return;const _=St.toArea(y),L=t();for(let x=_.rowEnd;x>=_.rowStart;x--){const $=L.children[x];if($.isFirstRepeatRow){const H=L.children.filter(B=>B.repeatGroup==$.repeatGroup&&B.id!==$.id);W(H)}L.removeRow(x)}e.resetSelectedElement(),e.createSnapshot()}function M(){l().forEach(_=>_.resetDS()),e.createSnapshot()}function O(){const y=l();if(y.length!=1)return;const _=y[0];if(_.hasSpan)return;const L=_.index,x=t();x.insertColumn(L,1,!0);for(const $ of x.children){const H=$.children[L];if(H.id===_.id)continue;const B=$.children[L+1];if(H.hasSpan){x.mergeRightCell(H,B);continue}if(H.isCollapsed){const P=x.find(H.attributes.control);P&&x.mergeRightCell(P,B);continue}x.mergeCells([H,B])}e.selectElement(_),e.createSnapshot()}function C(){const y=l();if(y.length!=1)return;const _=y[0];if(_.hasSpan)return;const L=_.parent;if(L==null)return;const x=t();x.inserRow(L.index,1);const $=x.children[L.index+1];for(let H=0;H<L.children.length;H++){const B=L.children[H];if(B.id===_.id)continue;const P=$.children[H];if(B.hasSpan){x.mergeBottomCell(B,P);continue}if(B.isCollapsed){const ae=x.find(B.attributes.control);ae&&x.mergeBottomCell(ae,P);continue}x.mergeCells([B,P])}e.selectElement(_),e.createSnapshot()}function q(y){const _=y??l();return _.length==1&&_[0].type==F.TABLE_ROW?!0:_.length>1?_.every(L=>L.type==F.TABLE_ROW):!1}function Q(y,_,L){const x=Math.min(...y.map(B=>B.index)),$=Math.max(...y.map(B=>B.hasRowSpan?B.index+B.rowspan-1:B.index));if(x>L||$<_)return;const H=t();if(x>=_&&$<=L){H.removeRepeatGroup(y[0]);return}if($>_&&$<=L){for(let B=_;B<=$;B++){const P=B-x,ae=y[P];ae.attributes.repeatGroup=void 0}return}if(x<=L&&$>L){for(let P=L;P<=L;P++){const ae=P-x,ge=y[ae];ge.attributes.repeatGroup=void 0}const B=y.slice(L-x+1);oe(B);return}}function oe(y){const _=y[0];for(const L of y)L.attributes.repeatGroup=_.id}function W(y){const _=t(),L=y.sort((P,ae)=>P.index-ae.index),x=Math.min(...L.map(P=>P.index)),$=Math.max(...L.map(P=>P.hasRowSpan?P.index+P.rowspan-1:P.index)),H=_.children.slice(x,$+1),B=new Set(H.filter(P=>P.hasRepeatGroup).map(P=>P.repeatGroup));for(const P of B){const ae=_.children.filter(ge=>ge.repeatGroup===P);ae.length!=0&&Q(ae,x,$)}return oe(H),H}function X(y){const _=t(),L=y.sort((P,ae)=>P.index-ae.index),x=Math.min(...L.map(P=>P.index)),$=Math.max(...L.map(P=>P.hasRowSpan?P.index+P.rowspan-1:P.index)),H=_.children.slice(x,$+1),B=H.find(P=>P.hasRepeatGroup);if(B!=null)for(const P of H)P.attributes.repeatGroup=B.repeatGroup}function z(y){y.attributes.repeatGroup=void 0}function T(y){var _;for(const L of y)(_=L.parent)==null||_.removeRepeatGroup(L)}return{getDesignApi(){return e},getTable:t,getSelectedElements:l,getSelectedCells:s,createSnapshot:o,selectTable:r,insertColumnLeft:i,insertColumnRight:a,insertRowTop:c,inserRowBottom:p,autoReiszeColumnByPaper:f,avgTableWidth:h,avgTableHeight:E,setOtherRowSameHeight:S,setOtherColSameWidth:u,mergeCells:v,splitCells:R,splitByColumn:O,splitByRow:C,deleteColumns:N,deleteRows:D,deleteDataSource:M,isSelectTableRow:q,createRepeatGroup:W,addRepeatGroup:X,exitRepeatGroup:z,removeRepeatGroup:T}}function sm(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(p){return p<=0?null:n.getTable().getColumnLeft(p-1)}function r(p){const f=n.getTable(),h=f.attributes.colgroup.length;return p>=h?null:f.getColumnLeft(p+1)}function i(p,f){if(!(p.target instanceof Element))return;const h=p.target.closest("."+e.colResize);if(h==null)return;const E=h.closest("."+e.layer);E!=null&&(p.stopPropagation(),p.preventDefault(),o.left=h.offsetLeft,o.colIndex=f,o.target=h,o.container=E,o.target.setPointerCapture(p.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",c))}function a(p){if(o.target==null||o.container==null)return;const f=o.container.getBoundingClientRect(),h=n.getDesignApi().state.scale/100,E=s(o.colIndex),S=r(o.colIndex);let u=p.clientX-f.left;E!=null&&u<=E*h+4&&(u=E*h+4),S!=null&&u>=S*h-4&&(u=S*h-4),o.left=u/h,o.target.style.left=u/h+"px",o.moved=!0}function c(p){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",c)}return i}function im(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(p){return p<=0?null:n.getTable().getRowTop(p-1)}function r(p){const f=n.getTable(),h=f.children.length;return p>=h?null:f.getRowTop(p+1)}function i(p,f){if(!(p.target instanceof Element))return;const h=p.target.closest("."+e.rowResize);if(h==null)return;const E=h.closest("."+e.layer);E!=null&&(p.stopPropagation(),p.preventDefault(),o.top=h.offsetTop,o.rowIndex=f,o.target=h,o.container=E,o.target.setPointerCapture(p.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",c))}function a(p){if(o.target==null||o.container==null)return;const f=n.getDesignApi().state.scale/100,h=o.container.getBoundingClientRect(),E=s(o.rowIndex),S=r(o.rowIndex);let u=p.clientY-h.top;E!=null&&u<=E*f+4&&(u=E*f+4),S!=null&&u>=S*f-4&&(u=S*f-4),o.moved=!0,o.top=u/f,o.target.style.top=u/f+"px"}function c(p){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",c)}return i}function rm(n,e,t){const l={moved:!1,width:0,height:0,target:null,container:null};function o(i){if(!(i.target instanceof Element))return;const a=i.target.closest("."+e.resize);if(a==null)return;const c=a.closest("."+e.layer);c!=null&&(i.stopPropagation(),i.preventDefault(),l.width=a.offsetWidth,l.height=a.offsetHeight,l.target=a,l.container=c,l.target.setPointerCapture(i.pointerId),l.target.classList.add(e.resizeActive),window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(l.target==null||l.container==null)return;const a=n.getDesignApi().state.scale/100,c=l.container.getBoundingClientRect(),p=n.getTable(),f=p.attributes.colgroup.length*4,h=p.children.length*4*a;let E=i.clientY-c.top,S=i.clientX-c.left;E<=h&&(E=h),S<=f&&(S=f),l.moved=!0,l.width=S/a,l.height=E/a,l.target.style.width=l.width+"px",l.target.style.height=l.height+"px"}function r(i){l.moved&&t.onResizeEnd(Math.round(l.width),Math.round(l.height)),l.target&&(l.target.classList.remove(e.resizeActive),l.target.style.removeProperty("width"),l.target.style.removeProperty("height")),l.width=0,l.height=0,l.target=null,l.container=null,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const am=["width"],cm=["onClick"],um=["onClick"],dm=A({__name:"TableEditor",props:{element:{type:St,required:!0}},setup(n){const e=n,t=Oe(),l=De("classes"),o=om(e,t),s=ze({colIndex:-1,rowIndex:-1,silence:!1,top:-1,left:-1}),r=k(()=>e.element.attributes.colgroup??[]),i=["#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF"],a=sm(o,l,{onResizeEnd:M,onResizeStart:D}),c=im(o,l,{onResizeEnd:O,onResizeStart:D}),p=rm(o,l,{onResizeEnd:oe,onResizeStart:D}),f=k(()=>({top:`calc(${Math.round(s.top)-2}px / var(--quickprint-page-scale, 1))`})),h=k(()=>({left:`calc(${Math.round(s.left)-1}px / var(--quickprint-page-scale, 1))`}));function E(T){const y=e.element.attributes.colgroup??[],_=y.slice(0,T).reduce(($,H)=>$+H,0),L=T===0?0:1,x=T>0&&T<y.length?-1:0;return{left:_+L+"px",width:y[T]+x+"px"}}function S(T){const y=e.element.children??[],_=y.slice(0,T).reduce(($,H)=>$+H.height,0),L=T===0?0:1,x=T>0&&T<y.length?-1:0;return{top:_+L+"px",height:y[T].height+x+"px"}}function u(T){const y={},_=e.element.find(T.repeatGroup);if(_!=null){const L=_.index%i.length;y["--quickprint-repeat-group-color"]=i[L]}return y}function v(T,y){if(T.ctrlKey)return t.toggleMultiSelectedElement(y);t.selectElement(y)}function R(T){const y=[];for(const _ of e.element.children){const L=_.children[T];L.isColCollapsed||y.push(L)}t.multiSelectElements(y)}async function N(T){const y=T.target.closest("td");if(y==null)return;const _=Reflect.get(y,rt);if(_==null)return;const L=t.getSelectedElements(e.element);if(o.isSelectTableRow(L))return L.length>1?nm(T,o,L,_):tm(T,o,_);(L.length==0||L.length==1&&L[0].type===F.TABLE_CELL||L.length>1&&L.findIndex(x=>x.id===_.id)<0)&&(t.selectElement(_),await rn()),lm(T,o,_)}function D(){s.silence=!0}function M(T,y){s.silence=!1;const _=e.element.attributes.colgroup??[];if(T==0){const B=e.element.left,P=e.element.calculateCoord(B+y),ae=_[0]-(P-B);e.element.setLeft(P),e.element.setColWidth(0,ae),e.element.updateBoxSize(),t.createSnapshot();return}if(T==_.length){const B=T-1,P=_.slice(0,B).reduce((ge,qe)=>ge+qe,0),ae=y-P;e.element.setColWidth(T-1,ae),e.element.updateBoxSize(),t.createSnapshot();return}const L=T-1,x=_[L]+_[T],$=y-_.slice(0,L).reduce((B,P)=>B+P,0),H=x-$;e.element.setColWidth(L,$),e.element.setColWidth(T,H),e.element.updateBoxSize(),t.createSnapshot()}function O(T,y){s.silence=!1;const _=e.element.children;if(T==0){const B=e.element.top,P=e.element.calculateCoord(B+y),ae=_[0].height-(P-B);e.element.setTop(P),e.element.setRowHeight(T,ae),e.element.updateBoxSize(),t.createSnapshot();return}if(T==_.length){const B=T-1,P=_.slice(0,B).reduce((ge,qe)=>ge+qe.height,0),ae=y-P;e.element.setRowHeight(T-1,ae),e.element.updateBoxSize(),t.createSnapshot();return}const L=T-1,x=_[L].height+_[T].height,$=y-_.slice(0,L).reduce((B,P)=>B+P.height,0),H=x-$;e.element.setRowHeight(L,$),e.element.setRowHeight(T,H),e.element.updateBoxSize(),t.createSnapshot()}function C(){s.rowIndex=-1,s.top=0,s.colIndex=-1,s.left=0}function q(T){const y=T.target.closest("td"),_=T.target.closest("."+l.tableEditor);if(y==null||_==null)return;const L=Reflect.get(y,rt);if(L==null||!(L instanceof Rn))return;const x=_.getBoundingClientRect(),$=y.getBoundingClientRect(),H=T.clientX-$.left,B=L.index;if(!L.hasColSpan){s.colIndex=H<$.width/2?B:L.getNextColIndex(),s.left=(s.colIndex===B?$.left:$.right)-x.left;return}const P=e.element.attributes.colgroup,ae=P[B]/2;if(H>=0&&H<=ae){s.colIndex=B,s.left=$.left-x.left;return}const ge=L.offsetWidth,qe=ge-P[B+L.colspan-1]/2;if(H>=qe&&H<=ge){s.colIndex=L.getNextColIndex(),s.left=(s.colIndex===B?$.left:$.right)-x.left;return}s.colIndex=-1,s.left=0}function Q(T){const y=T.target.closest("td"),_=T.target.closest("."+l.tableEditor);if(y==null||_==null)return;const L=Reflect.get(y,rt);if(L==null||!(L instanceof Rn))return;const x=L.parent;if(x==null)return;const $=_.getBoundingClientRect(),H=y.getBoundingClientRect(),B=T.clientY-H.top,P=x.index;if(!L.hasRowSpan){s.rowIndex=B<H.height/2?P:L.getNextRowIndex(),s.top=(s.rowIndex===P?H.top:H.bottom)-$.top;return}const ae=x.height/2;if(B>=0&&B<=ae){s.rowIndex=P,s.top=H.top-$.top;return}const ge=e.element.children.slice(x.index,x.index+L.rowspan),qe=ge.reduce((ot,ut)=>ot+ut.height,0),Ae=qe-ge[ge.length-1].height;if(B>=Ae&&B<=qe){s.rowIndex=L.getNextRowIndex(),s.top=(s.rowIndex===P?H.top:H.bottom)-$.top;return}s.rowIndex=-1,s.top=0}function oe(T,y){const _=e.element,L=_.calculateCoord(T),x=_.calculateCoord(y),$=L/_.width,B=_.attributes.colgroup.map(Ae=>Math.round(Ae*$)),P=B.reduce((Ae,ot)=>Ae+ot,0)-L;B[B.length-1]-=P,_.setColgroup(B),_.updateBoxSize();const ae=x/_.height;_.children.forEach(Ae=>Ae.setRowHeight(Math.round(Ae.height*ae)));const ge=_.children.reduce((Ae,ot)=>Ae+ot.height,0)-x,qe=_.children[_.children.length-1];qe.setRowHeight(qe.height-ge),_.updateBoxSize(),t.createSnapshot()}function W(T){s.silence||(q(T),Q(T))}function X(){const T=e.element;T.insertColumn(T.colSize-1,1)}function z(){const T=e.element;T.inserRow(T.rowSize-1,1)}return(T,y)=>(w(),I("div",{class:m(b(l).tableEditor),onContextmenu:pe(N,["stop","prevent"]),onClick:y[4]||(y[4]=pe(()=>{},["stop"])),onMouseleave:C},[d("table",{class:m(b(l).table),onMousemove:W},[d("colgroup",null,[(w(!0),I(se,null,fe(r.value,(_,L)=>(w(),I("col",{key:L,width:_},null,8,am))),128))]),d("tbody",null,[(w(!0),I(se,null,fe(n.element.children,_=>(w(),I("tr",{key:_.id,class:m({[b(l).repeatGroup]:_.hasRepeatGroup}),style:Z(u(_))},[(w(!0),I(se,null,fe(_.children,L=>(w(),le(Wo,{key:L.id,element:L},null,8,["element"]))),128))],6))),128))])],34),d("div",{class:m(b(l).layer)},[s.colIndex>=0?(w(),I("div",{key:0,title:"调整列宽",class:m(b(l).colResize),style:Z(h.value),onPointerdown:y[0]||(y[0]=pe(_=>b(a)(_,s.colIndex),["stop","prevent"]))},null,38)):Y("",!0),s.rowIndex>=0?(w(),I("div",{key:1,title:"调整行高",class:m(b(l).rowResize),style:Z(f.value),onPointerdown:y[1]||(y[1]=pe(_=>b(c)(_,s.rowIndex),["stop","prevent"]))},null,38)):Y("",!0),(w(!0),I(se,null,fe(r.value,(_,L)=>(w(),I("div",{title:"选中此列",key:L,style:Z(E(L)),class:m(b(l).colIndicator),onClick:pe(x=>R(L),["stop"])},null,14,cm))),128)),(w(!0),I(se,null,fe(n.element.children,(_,L)=>(w(),I("div",{title:"选中此行",key:L,style:Z(S(L)),class:m(b(l).rowIndicator),onClick:pe(x=>v(x,_),["stop"])},null,14,um))),128)),n.element.isSelected?(w(),I("button",{key:2,onClick:pe(X,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addCol]),title:"添加列"},[g(b(G),{icon:"icon-plus",size:"14px"})],2)):Y("",!0),n.element.isSelected?(w(),I("button",{key:3,onClick:pe(z,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addRow]),title:"添加行"},[g(b(G),{icon:"icon-plus",size:"14px"})],2)):Y("",!0),d("div",{class:m(b(l).resize),onPointerdown:y[2]||(y[2]=pe((..._)=>b(p)&&b(p)(..._),["stop","prevent"]))},[d("div",{class:m(b(l).resizeIndicator)},null,2)],34)],2),d("div",{class:m(b(l).indicator),onPointerdown:y[3]||(y[3]=(..._)=>b(t).onDragStart&&b(t).onDragStart(..._)),title:"选中/拖动表格"},null,34)],34))}}),pm="_tableEditor_1alkz_2",fm="_table_1alkz_2",mm="_layer_1alkz_31",gm="_colResize_1alkz_41",hm="_rowResize_1alkz_64",vm="_colIndicator_1alkz_87",bm="_rowIndicator_1alkz_95",ym="_indicator_1alkz_116",_m="_addCol_1alkz_153",Em="_addRow_1alkz_168",Tm="_repeatGroup_1alkz_183",Sm="_resize_1alkz_195",Rm="_resizeIndicator_1alkz_205",wm="_resizeActive_1alkz_220",km={tableEditor:pm,table:fm,layer:mm,colResize:gm,rowResize:hm,colIndicator:vm,rowIndicator:bm,indicator:ym,addCol:_m,addRow:Em,repeatGroup:Tm,resize:Sm,resizeIndicator:Rm,resizeActive:wm},Lm={classes:km},Cm=U(dm,[["__cssModules",Lm]]),Im={class:"quickprint-config-section quickprint-config-inline"},Om={class:"quickprint-config-content"},Nm=A({__name:"TableConfig",props:{element:{type:St,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.rowMode??fn.CONST},set(o){e.element.attributes.rowMode=o===fn.CONST?void 0:o}}),l=[{label:"固定行数",value:fn.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:fn.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:fn.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(w(),I("section",Im,[s[1]||(s[1]=d("header",{class:"quickprint-config-header"},"行模式",-1)),d("div",Om,[g(b(re),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),xm={class:"quickprint-config-section quickprint-config-inline"},Mm={class:"quickprint-config-content"},Dm=A({__name:"TableRowConfig",props:{element:{type:qn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:Xt.HEADER},{label:"表体",value:Xt.BODY},{label:"表尾",value:Xt.FOOTER}],l=k({get(){return e.element.attributes.type??Xt.BODY},set(o){switch(o){case Xt.HEADER:e.element.asHeader();break;case Xt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(w(),I("section",xm,[s[1]||(s[1]=d("header",{class:"quickprint-config-header"},"行模式",-1)),d("div",Mm,[g(b(re),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),qm=["colspan","rowspan"],Am=A({__name:"TableCellDummy",props:{element:{type:Rn,required:!0}},setup(n){const e=n,t=k(()=>e.element.isCollapsed),l=k(()=>{const p=e.element.attributes.diagonalMode;return p==null?!1:p!==Ve.NONE}),o=De("classes"),s=k(()=>{const p=e.element,f=p.parent;return{[o.cell]:!0,[ne.SELECTED]:(f==null?void 0:f.isSelected)||p.isSelected}}),r=k(()=>{var E;const p=Ft((E=e.element.parent)==null?void 0:E.parent),f=Ft(e.element.parent),h=Ft(e.element);return{...a(e.element),...c(e.element),...Object.assign(p,f,h)}}),i=k(()=>{const p=Ol(e.element,{exclude:["border","padding"]});return p.color&&(p["--quickprint-element-var-color"]=p.color),p});function a(p){const f=p.findPrevDisplayedCell(),h=p.findNextDisplayedCell(),E=p.table,S=K(p,"left")??K(p.parent,"left")??K(E,"left"),u=K(f,"right")??K(f==null?void 0:f.parent,"right")??K(E,"right"),v=K(p,"right")??K(p.parent,"right")??K(E,"right"),R=K(h,"left")??K(h==null?void 0:h.parent,"left")??K(E,"left"),N=Math.max(ce.processLengthToPX(S)??0,ce.processLengthToPX(u)??0),D=Math.max(ce.processLengthToPX(v)??0,ce.processLengthToPX(R)??0);return{"--quickprint-cell-width":e.element.offsetWidth+"px","--quickprint-cell-border-left-width":N+"px","--quickprint-cell-border-right-width":D+"px"}}function c(p){var O,C;const f=p.index,h=p.table,E=(O=p.findPrevDisplayedRow())==null?void 0:O.children[f],S=(C=p.findNextDisplayedRow())==null?void 0:C.children[f],u=K(p,"top")??K(p.parent,"top")??K(h,"top"),v=K(E,"bottom")??K(E==null?void 0:E.parent,"bottom")??K(h,"bottom"),R=K(p,"bottom")??K(p.parent,"bottom")??K(h,"bottom"),N=K(S,"top")??K(S==null?void 0:S.parent,"top")??K(h,"top"),D=Math.max(ce.processLengthToPX(u)??0,ce.processLengthToPX(v)??0),M=Math.max(ce.processLengthToPX(R)??0,ce.processLengthToPX(N)??0);return{"--quickprint-cell-height":p.offsetHeight+"px","--quickprint-cell-border-top-width":D+"px","--quickprint-cell-border-bottom-width":M+"px"}}return(p,f)=>t.value?Y("",!0):(w(),I("td",{key:0,class:m(s.value),style:Z(r.value),colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan},[l.value?(w(),le(Xn,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight,style:Z(i.value)},null,8,["mode","labels","width","height","style"])):(w(),le(cn,{key:1,element:n.element,class:m(b(o).content),showDS:!1},null,8,["element","class"]))],14,qm))}}),$m="_cell_bnxf6_2",Bm="_content_bnxf6_32",Pm={cell:$m,content:Bm},Vm={classes:Pm},zm=U(Am,[["__cssModules",Vm]]),Fm=["width"],Um=A({__name:"TableDummy",props:{element:{type:St,required:!0}},setup(n){const e=n,t=k(()=>e.element.attributes.colgroup??[]);return(l,o)=>(w(),I("table",{class:m(l.classes.table)},[d("colgroup",null,[(w(!0),I(se,null,fe(t.value,(s,r)=>(w(),I("col",{key:r,width:s},null,8,Fm))),128))]),d("tbody",null,[(w(!0),I(se,null,fe(n.element.children,s=>(w(),I("tr",{key:s.id},[(w(!0),I(se,null,fe(s.children,r=>(w(),le(zm,{key:r.id,element:r},null,8,["element"]))),128))]))),128))])],2))}}),Hm="_table_ni79p_2",Gm={table:Hm},Wm={classes:Gm},Xm=U(Um,[["__cssModules",Wm]]),al=Object.freeze({title:"表格",type:F.TABLE,icon:"icon-table",dummy:Xm,editor:Cm,config:{attributes:Nm,exclude:[_e.DISPLAY,_e.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[et,et,et],e=me.create({type:F.TABLE});return e.style.borderStyle=ie.SOLID,e.setColgroup(n),e.append(qn.createDefault(n)),e.append(qn.createDefault(n)),e.append(qn.createDefault(n)),e.updateBoxSize(),e}}),ss=Object.freeze({title:"表格行",type:F.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[_e.POSITION,_e.COORD,_e.OVERFLOW],attributes:Dm}}),ql=Object.freeze({title:"单元格",type:F.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:Wo,config:{exclude:[_e.POSITION,_e.COORD]}});class Ym{constructor(e){J(this,"__v_skip",!0);J(this,"observer");J(this,"callbacks",[]);J(this,"handler");this.handler=Os((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function jm(n,e){switch(n){case"fontSize":return e===$e.DEFAULT?void 0:e;case"fontFamily":return e===Ee.DEFAULT?void 0:e;case"lineHeight":return e===$t.DEFAULT?void 0:e;default:return e}}const Wl="texteditor-const-node",Zm=Object.freeze({CONST:0});class Km{constructor(e,t={}){J(this,"__v_skip",!0);J(this,"emitter",new Un);J(this,"container");J(this,"options");J(this,"observer");J(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new Ym(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new Un}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Ns(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ve(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await Zn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=Wl,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var h;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,a=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(a),r.parentNode===i||(h=r.parentNode)!=null&&h.contains(i))return s.insertNode(a),this.normalize(),this.focusAfterNode(a),!0;const c=r.parentNode;if(c==null)return!1;const p=c.textContent;if(p==null)return!1;if(o.anchorOffset==p.length)return i.insertBefore(a,c.nextSibling),this.normalize(),this.focusAfterNode(a),!0;const f=document.createElement("span");return f.textContent=p.slice(0,o.anchorOffset),c instanceof HTMLElement&&(f.style.cssText=c.style.cssText),c.textContent=p.slice(o.anchorOffset),i.insertBefore(a,c),i.insertBefore(f,a),this.normalize(),this.focusAfterNode(a),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ve(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var p;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:a}=this.normalizeRange(o);if(s===i){const f=s.textContent??"";if(s instanceof CharacterData){const S=document.createElement("span");return S.textContent=f.slice(r,a),o.deleteContents(),o.insertNode(S),[S]}const h=document.createElement("span");h.textContent=f.slice(0,r),this.inheritStyle(h,i);const E=document.createElement("span");return E.textContent=f.slice(r,a),this.inheritStyle(E,i),i.textContent=f.slice(a),e.insertBefore(E,i),e.insertBefore(h,E),[E]}const c=this.findNodesBetween(s,i);if(r>0){const f=s.textContent??"",h=document.createElement("span");h.textContent=f.slice(0,r),this.inheritStyle(h,s),s.textContent=f.slice(r),e.insertBefore(h,s)}if(a>=0&&a<=(((p=i.textContent)==null?void 0:p.length)??0)){const f=i.textContent??"";if(i instanceof HTMLElement){i.textContent=f.slice(0,a);const h=document.createElement("span");h.textContent=f.slice(a),this.inheritStyle(h,i),e.insertBefore(h,i.nextSibling),c.push(i)}else{const h=document.createElement("span");h.textContent=f.slice(0,a),e.replaceChild(h,i);const E=document.createTextNode(f.slice(a));e.insertBefore(E,i.nextSibling),c.push(h)}}return c.unshift(s),c}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=ho(e),r=jm(e,t);for(let i=0;i<l.length;i++){const a=l[i];if(a instanceof HTMLElement){this.matchElementStyle(a,s,r)||(o=!1);continue}const c=document.createElement("span");c.textContent=a.textContent,this.container.replaceChild(c,a),l[i]=c,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=Pt.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=Pt.remove(o,l);ve(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+Wl)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const Jm=A({__name:"ParagraphEditor",props:{element:{type:xs,required:!0}},setup(n){const e=n,t=Oe(),l=be(),o=k(()=>e.element.isSelected!==!0?!1:t.state.selectMode===vt.SINGLE);let s=null;const r=k(()=>il.map(O=>(O.style={fontFamily:O.value==Ee.DEFAULT?Ee.SONG:O.value},O)));function i(){}async function a(){if(s==null)return;const O=await xl({doc:t.doc}).catch(gt);if(O==null)return;const C=yt(O.value,t.doc.ds)??O.value,q={type:Zm.CONST,value:O.value,label:C};s.insertNode(q)}function c(){s==null||s.blur()}function p(){s==null||s.autosize()}function f(O){const C=e.element.ds.value,q=new Km(O);return q.on("resize",Q=>{var W;const oe=(W=Q.detail)==null?void 0:W.height;oe!=null&&e.element.setHeight(oe+2)}),q.watch(()=>{const Q=q.getHTML(),oe=e.element.ds.value;Q!==oe&&(e.element.ds.value=Q,q.checkHeight())}),ve(C)||q.setHTML(C),q}function h(O){s==null||s.setStyle("fontFamily",O.value)}function E(O){s==null||s.setStyle("fontSize",O.value)}function S(O){s==null||s.setStyle("lineHeight",O.value)}function u(O){s==null||s.setStyle("backgroundColor",O)}function v(O){s==null||s.setStyle("color",O)}function R(){s==null||s.setStyle("fontWeight","700")}function N(){s==null||s.setStyle("fontStyle","italic")}function D(){s==null||s.setStyle("textDecorationLine","underline")}function M(){s==null||s.setStyle("textDecorationLine","line-through")}return Ll(()=>e.element.ds.value,O=>{s==null||s.getHTML()==O||s.setHTML(O)}),an(()=>{e.element.on("blur",c),s=f(l.value)}),Jn(()=>{e.element.off("blur",c),s&&s.cleanup()}),(O,C)=>(w(),I("div",{class:m(O.classes.paragraph),onPointerdown:C[2]||(C[2]=pe(()=>{},["stop"])),onContextmenu:pe(i,["stop","prevent"])},[d("div",{class:m(O.classes.indicator),onPointerdown:C[0]||(C[0]=(...q)=>b(t).onDragStart&&b(t).onDragStart(...q)),title:"选中/拖动段落"},null,34),o.value?(w(),I("div",{key:0,class:m(O.classes.toolbar),onMousedown:C[1]||(C[1]=pe(()=>{},["prevent"]))},[g(b(re),{onSelect:h,title:"字体",width:"60px",options:r.value,class:m(O.classes.tool),button:""},null,8,["options","class"]),g(b(re),{onSelect:E,title:"字号",width:"60px",options:b(Ml),class:m(O.classes.tool),button:""},null,8,["options","class"]),g(b(re),{onSelect:S,title:"行高",width:"60px",options:b(Zo),class:m(O.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),d("div",{class:m(O.classes.divider)},null,2),g(b(en),{class:m(O.classes.tool),onSelect:u},{default:he(()=>[d("div",{class:m(O.classes.colorIcon),title:"突出显示"},[g(b(G),{icon:"icon-bg-color-b",size:"15px"}),d("div",{class:m(O.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),g(b(en),{class:m(O.classes.tool),onSelect:v},{default:he(()=>[d("div",{class:m(O.classes.colorIcon),title:"字体颜色"},[g(b(G),{icon:"icon-font",size:"15px"}),d("div",{class:m(O.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),d("button",{onClick:R,type:"button",title:"加粗",class:m(["quickprint-text-btn",O.classes.tool])},[g(b(G),{icon:"icon-font-bold",size:"16px"})],2),d("button",{onClick:N,type:"button",title:"斜体",class:m(["quickprint-text-btn",O.classes.tool])},[g(b(G),{icon:"icon-italic",size:"16px"})],2),d("button",{onClick:D,type:"button",title:"下划线",class:m(["quickprint-text-btn",O.classes.tool])},[g(b(G),{icon:"icon-underline",size:"16px"})],2),d("button",{onClick:M,type:"button",title:"删除线",class:m(["quickprint-text-btn",O.classes.tool])},[g(b(G),{icon:"icon-through-line",size:"16px"})],2),d("div",{class:m(O.classes.divider)},null,2),d("button",{class:"quickprint-text-btn",type:"button",onClick:a},[g(b(G),{icon:"icon-insert-var",size:"16px"}),C[3]||(C[3]=d("span",null,"插入变量",-1))]),d("button",{class:"quickprint-text-btn",type:"button",onClick:p},[g(b(G),{icon:"icon-colum-height",size:"16px"}),C[4]||(C[4]=d("span",null,"调整高度",-1))])],34)):Y("",!0),d("div",{ref_key:"editorRef",ref:l,class:m(O.classes.editor)},null,2)],34))}}),Qm="_paragraph_1v2pj_2",eg="_indicator_1v2pj_6",tg="_editor_1v2pj_18",ng="_toolbar_1v2pj_44",lg="_tool_1v2pj_44",og="_colorIcon_1v2pj_66",sg="_colorIndicator_1v2pj_86",ig="_divider_1v2pj_95",rg={paragraph:Qm,indicator:eg,editor:tg,toolbar:ng,tool:lg,colorIcon:og,colorIndicator:sg,divider:ig},ag={classes:rg},cg=U(Jm,[["__cssModules",ag]]),cl=Object.freeze({title:"段落",type:F.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:cg,config:{exclude:[_e.DATASOURCE,_e.BASIC,_e.OVERFLOW]},onCreate(){return me.create({type:F.PARAGRAPH,width:et*4,height:el*6})}}),ug=["src"],dg=A({__name:"ImageEditor",props:{element:{type:bo,required:!0}},setup(n){const e=n;Oe();const t=k(()=>{var i;const r=e.element.ds;return ve(r.value)?{type:"placeholder",value:"请上传图片"}:r.type===we.CONST?s(r.value)?{type:"image",value:r.value}:{type:"placeholder",value:"无效的图片"}:{type:"content",value:(i=nl(e.element))==null?void 0:i.content}}),l=k(()=>Ln(e.element)),o=k(()=>Ms(e.element.attributes.size));function s(r){return!!(/^https?:\/\//.test(r)||/^data:image\/(.+);base64,/.test(r))}return(r,i)=>(w(),I("div",{class:m(r.classes.editor),style:Z(l.value)},[t.value.type==="placeholder"?(w(),I("div",{key:0,class:m(r.classes.placeholder)},te(t.value.value),3)):Y("",!0),t.value.type==="content"?(w(),I("span",{key:1,class:m(r.classes.highlight)},"["+te(t.value.value)+"]",3)):Y("",!0),t.value.type==="image"?(w(),I("img",{key:2,src:t.value.value,style:Z(o.value),class:m(r.classes.image)},null,14,ug)):Y("",!0)],6))}}),pg="_editor_154e6_2",fg="_image_154e6_10",mg="_highlight_154e6_14",gg="_placeholder_154e6_30",hg={editor:pg,image:fg,highlight:mg,placeholder:gg},vg={classes:hg},Xl=U(dg,[["__cssModules",vg]]),bg={class:"quickprint-config-section quickprint-config-inline"},yg={class:"quickprint-config-content"},_g=A({__name:"ImageConfig",props:{element:{type:bo,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.size??Zt.NATURAL},set(l){const o=l===Zt.NATURAL?void 0:l;e.element.attributes.size=o}});return(l,o)=>(w(),I("section",bg,[o[1]||(o[1]=d("header",{class:"quickprint-config-header"},"缩放模式",-1)),d("div",yg,[g(b(re),{options:b(fi),modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-w-full"},null,8,["options","modelValue"])])]))}}),ul=Object.freeze({title:"图片",icon:"icon-image",type:F.IMAGE,editor:Xl,dummy:Xl,config:{attributes:_g,exclude:[_e.BASIC,_e.OVERFLOW]},contextmenu(){return["auto-resize","---","copy","delete","---","z-index"]},onCreate(){return me.create({type:F.IMAGE,width:et,height:et})}}),Eg=["innerHTML"],Yl="",Tg=A({__name:"BarcodeEditor",props:{element:{type:yo,required:!0}},setup(n){const e=n,t=De("classes"),l=k(()=>{const r=e.element.attributes,i=Rt(r.width)||Rt(r.height);return{"quickprint-is-element-editor":!0,[t.editor]:!0,[t.fixed]:i,[t.contain]:!i}}),o=k(()=>{const r=e.element.attributes,i=Ln(e.element);return r.width&&(i["--quickprint-barcode-width"]=r.width),r.height&&(i["--quickprint-barcode-height"]=r.height),i}),s=k(()=>{const r=e.element.ds,i=e.element.attributes,a={barcolor:i.barcolor,includetext:i.showText===!0,width:ce.processLengthToMM(i.width),height:ce.processLengthToMM(i.height)};if(r.type===we.CONST&&Rt(r.value)){const p=An.barcode(i.mode,r.value,a);if(Rt(p))return p}const c=An.genDefaultBarcode(i.mode);return c==null?Yl:An.barcode(i.mode,c,a)??Yl});return(r,i)=>(w(),I("div",{class:m(l.value),style:Z(o.value)},[d("span",{innerHTML:s.value,class:m(b(t).barcode)},null,10,Eg)],6))}}),Sg="_editor_qkqvg_2",Rg="_barcode_qkqvg_10",wg="_fixed_qkqvg_14",kg="_contain_qkqvg_21",Lg={editor:Sg,barcode:Rg,fixed:wg,contain:kg},Cg={classes:Lg},jl=U(Tg,[["__cssModules",Cg]]),Ig={class:"quickprint-config-section quickprint-config-inline"},Og={class:"quickprint-config-content"},Ng={class:"quickprint-config-section quickprint-config-inline"},xg={class:"quickprint-config-content"},Mg=A({__name:"BarcodeConfig",props:{element:{type:yo,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.mode},set(o){e.element.attributes.mode=o}}),l=k({get(){return e.element.attributes.showText===!0},set(o){e.element.attributes.showText=o}});return(o,s)=>(w(),I(se,null,[d("section",Ig,[s[2]||(s[2]=d("header",{class:"quickprint-config-header"},"码制",-1)),d("div",Og,[g(b(re),{options:b(gi),modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),d("section",Ng,[s[3]||(s[3]=d("header",{class:"quickprint-config-header"},"显示文本",-1)),d("div",xg,[g(Ct,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=r=>l.value=r),options:b(hi),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),dl=Object.freeze({title:"条形码",icon:"icon-barcode",type:F.BARCODE,editor:jl,dummy:jl,config:{attributes:Mg},contextmenu(){return["barcode-setting","auto-resize","---","copy","delete","---","z-index"]},onCreate(){return me.create({type:F.BARCODE,width:155,height:112,attributes:{mode:Qe.EAN_13,showText:!0}})}}),Dg=["innerHTML"],Zl="0",qg=A({__name:"QRCodeEditor",props:{element:{type:_o,required:!0}},setup(n){const e=n,t=k(()=>e.element.ds.type===we.CONST&&e.element.ds.value||Zl),l=k(()=>{const s=t.value,r=e.element.attributes.mode,i=e.element.attributes.barcolor;return An.qrcode(r,s,{barcolor:i})??""}),o=k(()=>Ln(e.element,{exclude:["align"]}));return(s,r)=>(w(),I("div",{class:m(s.classes.editor),style:Z(o.value)},[d("span",{innerHTML:l.value,class:m(s.classes.qrcode)},null,10,Dg)],6))}}),Ag="_editor_ymcu8_2",$g="_qrcode_ymcu8_19",Bg={editor:Ag,qrcode:$g},Pg={classes:Bg},Kl=U(qg,[["__cssModules",Pg]]),Vg={class:"quickprint-config-section quickprint-config-inline"},zg={class:"quickprint-config-content"},Fg=A({__name:"QRCodeConfig",props:{element:{type:_o,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.mode??Tn.QRCODE},set(l){const o=l===Tn.QRCODE?void 0:l;e.element.attributes.mode=o}});return(l,o)=>(w(),I("section",Vg,[o[1]||(o[1]=d("header",{class:"quickprint-config-header"},"码制",-1)),d("div",zg,[g(b(re),{options:b(mi),modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-w-full"},null,8,["options","modelValue"])])]))}}),pl=Object.freeze({title:"二维码",icon:"icon-qrcode",type:F.QRCODE,editor:Kl,dummy:Kl,config:{attributes:Fg},contextmenu(){return["qrcode-setting","auto-resize","---","copy","delete","---","z-index"]},onCreate(){return me.create({type:F.QRCODE,width:et,height:et})}}),is=[ll,ol,sl,al,ql,ss,cl,ul,dl,pl],Ug=[ll,ol,sl,al,cl,ul,dl,pl],Hg={[F.TEXT]:ll.editor,[F.NUMBER]:ol.editor,[F.DATE]:sl.editor,[F.TABLE]:al.editor,[F.TABLE_CELL]:ql.editor,[F.PARAGRAPH]:cl.editor,[F.IMAGE]:ul.editor,[F.BARCODE]:dl.editor,[F.QRCODE]:pl.editor},Gg={[F.TEXT]:ll.config,[F.NUMBER]:ol.config,[F.DATE]:sl.config,[F.TABLE]:al.config,[F.TABLE_CELL]:ql.config,[F.TABLE_ROW]:ss.config,[F.PARAGRAPH]:cl.config,[F.IMAGE]:ul.config,[F.BARCODE]:dl.config,[F.QRCODE]:pl.config},_t=is.reduce((n,e)=>(n[e.type]=e,n),{});function Wg(n){const e=is.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function Xg(n){return Reflect.get(Hg,n)}function hn(n){return Reflect.get(Gg,n)}function Jl(n){var e;return(e=_t[n])==null?void 0:e.contextmenu}function wn(n){var e;return((e=_t[n])==null?void 0:e.title)??n}function Yg(n){var e;return(e=_t[n])==null?void 0:e.icon}function jg(n){var e,t;return((t=(e=_t[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function Zg(n){var e,t;return((t=(e=_t[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function Kg(n){var e,t;return((t=(e=_t[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Jg(n){var e,t;return((t=(e=_t[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Qg(n){var e;return(e=_t[n])==null?void 0:e.dummy}function rs(n){var e;return(e=_t[n])==null?void 0:e.title}function Ql(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function eo(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function to(n,e){const t=n.find(a=>a.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function no(n,e){const t=n.find(a=>a.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function eh(n){const e=document.createElement("div");return n.appendChild(e),e}function th(n,e){const t=[...e.querySelectorAll(":scope ."+ne.GUIDE_LINE)];for(const l of n){const o=t.shift()??eh(e);o.className=ne.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function nh(n,e){const l=e.querySelectorAll(":scope ."+ne.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const a=i.getBoundingClientRect();if(Math.abs(s.left-a.left)<=1||Math.abs(s.right-a.left)<=1){const c=a.left-o.left;to(r,Ql(c,s,a,o))}if(Math.abs(s.left-a.right)<=1||Math.abs(s.right-a.right)<=1){const c=a.right-o.left;to(r,Ql(c,s,a,o))}if(Math.abs(s.top-a.top)<=1||Math.abs(s.bottom-a.top)<=1){const c=a.top-o.top;no(r,eo(c,s,a,o))}if(Math.abs(s.bottom-a.bottom)<=1||Math.abs(s.top-a.bottom)<=1){const c=a.bottom-o.top;no(r,eo(c,s,a,o))}}th(r,e)}function lh(){const n=document.querySelectorAll("."+ne.GUIDE_LINE);for(const e of n)e.remove()}const jn={create:Ds(nh,50),clean:lh};async function oh(n){await Zn(),n&&Reflect.deleteProperty(n,Qn)}async function sh(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=ih(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-Mo(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function ih(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Ye.INSERT){const o=t.closest("."+ne.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?Kt(e.left-s.left):Math.round(e.left-s.left),y:l?Kt(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?Kt(e.left):Math.round(e.left),y:l?Kt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function rh(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function ah(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function ch(n){return!(n.style.rotate&&!n.isSelected)}function uh(n){const e=new El({selector:{container:ne.DROPPABLE},scale(t){return t.mode===Ye.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,ko),s=Reflect.get(l.target,Cl);o===Ye.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===Ye.INSERT?o:Ye.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Ye.INSERT){const s=Wg(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,rt);if(o==null||!ch(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Ye.INSERT&&(l.ghost.style.display="block"),l.mode===Ye.MOVE&&Reflect.set(l.target,Qn,Il.DRAG_ELEMENT),l.ghost.classList.add(ne.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,sh(n,l),rh(n,l),l.dropTarget&&jn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;jn.clean(),l.ghost.classList.remove(ne.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Ye.INSERT&&(l.ghost.style.display="none"),l.mode==Ye.MOVE&&oh(l.target);const o=l.element;if(l.mode==Ye.MOVE){const c=o.left,p=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-c,l.diffY=o.top-p,ah(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,Lo);if(s==null)return;const r=s instanceof Ht||s instanceof me?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),a=n.state.scale/100;o.setTop((l.top-i.top)/a),o.setLeft((l.left-i.left)/a),o.setWidth(o.width/a),o.setHeight(o.height/a),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const lo="quickprint-history-0000",dh=1,Tt="snapshot",Bn="health",oo="owner",pt="INDEX_OWNER",ph=15*60*1e3,fh=10*60*1e3;function mh(){const n={db:null,timer:null,promise:null};async function e(){const p=await a(Bn,"readwrite");if(p==null)return n.timer=s(),!1;const f=[],h=p.openCursor();h.onsuccess=async function(E){const S=E.target.result;if(S==null){t(f),n.timer=s(),Ze.debug("History","已检查无效快照");return}const u=S.value;u!=null&&Date.now()-u.timestamp>ph&&f.push(u),S.continue()},h.onerror=function(E){console.error(E),n.timer=s()}}async function t(p){const f=await Promise.allSettled(p.map(h=>l(h.owner)));for(let h=0;h<f.length;h++){const E=f[h];E.status==="rejected"||E.value!==!0||o(p[h].id)}}async function l(p){const f=await a(Tt,"readwrite");return f==null?!1:new Promise(h=>{const E=f.index(pt).openCursor(IDBKeyRange.only(p));E.onsuccess=function(S){const u=S.target.result;if(u==null)return h(!0);u.delete(),u.continue()},E.onerror=function(S){console.error(S),h(!1)}})}async function o(p){const f=await a(Bn,"readwrite");return f==null?!1:yn(f.delete(p)).then(()=>!0).catch(h=>(console.log(h),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),fh)}function r(){return new Promise(p=>{const f=indexedDB.open(lo,dh);f.onupgradeneeded=h=>{const S=h.target.result,u=S.createObjectStore(Bn,{keyPath:"id",autoIncrement:!0}),v=S.createObjectStore(Tt,{keyPath:"id",autoIncrement:!0});u.createIndex(pt,oo),v.createIndex(pt,oo)},f.onsuccess=h=>{const E=h.target;n.db=E.result,Ze.debug("History",`已连接数据库【${lo}】`),p(n.db)},f.onerror=function(h){console.error(h),n.db=null,p(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function a(p,f="readonly"){const h=await i();if(h==null)return null;try{return h.transaction(p,f).objectStore(p)}catch(E){return console.error(E),null}}function c(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:a,cleanup:c}}function yn(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const gh=5*60*1e3,qt=mh();var ft,tt,Pn,Rl,as;class hh{constructor(e,t={}){dt(this,tt);J(this,"state");J(this,"owner");dt(this,ft);this.state=e,this.owner=t.owner??qs(As.HISTORY_OWNER),Ge(this,tt,Rl).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await qt.findStore(Tt,"readwrite");if(l==null)return!1;await Ge(this,tt,as).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await yn(l.put(s)).catch(gt)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await qt.findStore(Tt,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await yn(o.put(l)).catch(gt)==null))}async getCurrentSnapshot(){const e=await qt.findStore(Tt);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(pt).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return o(a);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await qt.findStore(Tt);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(pt).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await qt.findStore(Tt);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(pt).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await qt.findStore(Tt);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(pt).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const a=i.value;if(a.owner!=t)return i.continue();s.push(a),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){He(this,ft)&&(clearTimeout(He(this,ft)),xt(this,ft,null))}}ft=new WeakMap,tt=new WeakSet,Pn=function(){xt(this,ft,setTimeout(()=>Ge(this,tt,Rl).call(this),gh))},Rl=async function(){He(this,ft)&&clearTimeout(He(this,ft));const e=await qt.findStore(Bn,"readwrite");if(e==null)return Ge(this,tt,Pn).call(this);const t=await yn(e.index(pt).get(this.owner)).catch(gt);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),Ge(this,tt,Pn).call(this)}t.timestamp=Date.now(),await yn(e.put(t)).catch(gt),Ge(this,tt,Pn).call(this)},as=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(pt).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const a=i.target.result;if(a==null)return s(!0);const c=a.value;if(c.owner!=o)return a.continue();if(c.index>t){a.delete(),a.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function vh(n){const e=new hh(ze({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(p){return e.createSnapshot(n.value,p)}function s(p){return e.replaceSnapshot(n.value,p)}async function r(){const p=await e.getPrevSnapshot();if(p==null)return!1;const f=Hn(p.data);return f==null?!1:(n.value=Ce.create(f),!0)}async function i(){const p=await e.getNextSnapshot();if(p==null)return!1;const f=Hn(p.data);return f==null?!1:(n.value=Ce.create(f),!0)}function a(){return e.list()}function c(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:a,cleanup:c,replaceSnapshot:s}}class bh{constructor(e){J(this,"moved",!1);J(this,"position");J(this,"top",0);J(this,"left",0);J(this,"width",0);J(this,"height",0);J(this,"initX",0);J(this,"initY",0);J(this,"indicator");J(this,"container");J(this,"originalEvent");J(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var on,sn,Nt,cs,us,ds;const Fe=class Fe extends Un{constructor(t={}){var l,o,s;super();dt(this,Nt);J(this,"context",null);J(this,"selector");J(this,"scale");J(this,"onResizeStart");dt(this,on);dt(this,sn);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??ne.PAGE,element:((o=t.selector)==null?void 0:o.element)??ne.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??ne.RESIZEABLE_INDICATOR},this.onResizeStart=Ge(this,Nt,cs).bind(this),xt(this,on,Ge(this,Nt,us).bind(this)),xt(this,sn,Ge(this,Nt,ds).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",He(this,on)),window.removeEventListener("pointerup",He(this,sn)),this.context=null}};on=new WeakMap,sn=new WeakMap,Nt=new WeakSet,cs=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Ze.warn(Fe.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,Co);if(o==null)return Ze.warn(Fe.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return Ze.warn(Fe.TAG_NAME,"未找到的可调整元素");const r=xo(s,this.selector.container);this.context=new bh({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Ze.warn(Fe.TAG_NAME,"已取消调整");if(this.context.container==null)return Ze.warn(Fe.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const a=this.createEvent("resizestart",this.context);if(this.dispatch(a).defaultPrevented)return Ze.warn(Fe.TAG_NAME,"已取消调整");window.addEventListener("pointermove",He(this,on)),window.addEventListener("pointerup",He(this,sn))},us=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&bn.TOP){const c=Math.max((i.bottom-t.clientY)/s,Fe.MIN_LENGTH);l.top=(i.bottom-r.top)/s-c,l.height=c}if(o&bn.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Fe.MIN_LENGTH)),o&bn.LEFT){const c=Math.max((i.right-t.clientX)/s,Fe.MIN_LENGTH);l.left=(i.right-r.left)/s-c,l.width=c}o&bn.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Fe.MIN_LENGTH));const a=this.createEvent("resizing",l);this.dispatch(a).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},ds=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},J(Fe,"TAG_NAME","quickprint-resizeable"),J(Fe,"MIN_LENGTH",12);let wl=Fe;async function yh(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?Kt(e.width):Math.round(e.width),o=t?Kt(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-Mo(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function _h(n){const e=new wl({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,rt);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(yh(n,l),jn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),jn.clean()}),n.onResizeStart=e.onResizeStart,e}function Eh(n){function e(r){const i=document.activeElement,a=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||a.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===Se.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===Se.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||$s()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowUp"?-1:1,c=i.map(p=>p.setTop(p.top+a,!0)?p:null).filter(p=>p!=null);c.length>0&&n.replaceSnapshot("top",c);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowLeft"?-1:1,c=i.map(p=>p.setLeft(p.left+a,!0)?p:null).filter(p=>p!=null);c.length>0&&n.replaceSnapshot("left",c);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const a=n.doc.pages.reduce((c,p)=>c.concat(p.children),[]);return n.multiSelectElements(a)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const a=t();for(const c of i)c.setLeft(c.left+8),c.setTop(c.top+8),a.append(c);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const Nn="openprint:element,";function Th(n){function e(){return navigator.clipboard.readText().catch(a=>(console.log(a),null))}function t(a){return navigator.clipboard.writeText(a).catch(c=>{console.log(c)})}async function l(){const a=await e();if(a==null||!a.startsWith(Nn))return[];t("");const c=Hn(Ps(a.slice(Nn.length)),[]);return c.length===0?[]:c.map(p=>(delete p.id,me.create(p))).sort(me.sort)}function o(a){const c=`${Nn}${Bs(JSON.stringify(a))}`;return t(c)}async function s(){const a=await e();return typeof a=="string"&&a.startsWith(Nn)}function r(){}function i(a){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const ps=Symbol();function Sh(){return{panel:{left:!0,right:!0},scale:100,selectedType:Se.NONE,selectedPage:void 0,selectMode:vt.SINGLE,selected:[]}}function Rh(n,e){const t=ze(Sh()),l=vh(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:a,selectPage:f,selectElement:h,resetSelectedElement:E,deleteSelectedElement:S,multiSelectElements:u,toggleMultiSelectedElement:v,isSingleSelectedElement:q,isNoSelectedElement:Q,zoomIn:N,zoomOut:R,toggleBackground:D,toggleElementPanel:M,toggleConfigPanel:O,getSelectedElements:c,getSelectedPage:p,cleanup:oe,replaceSnapshot:C},r=uh(s),i=_h(s);s.shortcut=Eh(s),s.createSnapshot=l.createSnapshot,s.clipboard=Th();function a(W){s.document.value=W,s.history.createSnapshot()}function c(W){if(s.state.selectedType!==Se.ELEMENT)return[];const X=t.selected;if(X.length==0)return[];const z=X.map(T=>s.doc.findElement(T)).filter(T=>T!=null);return W==null?z:z.filter(T=>W.contains(T))}function p(){var X;const W=t.selectedPage;if(W!=null)return(X=n.value)==null?void 0:X.findPage(W)}function f(W){return E(),t.selectedPage=W.id,t.selectedType=Se.PAGE,!0}function h(W){t.selectMode=vt.SINGLE,t.selectedType=Se.ELEMENT,t.selectedPage=void 0;const X=c();for(const z of X)z.id!==W.id&&z.blur();return W.focus(),t.selected=[W.id],!0}function E(){const W=c();for(const X of W)X.blur();return t.selected=[],t.selectedType=Se.NONE,!0}function S(){if(t.selectedType!=Se.ELEMENT||t.selected.length==0)return!1;let W=!1;const X=c();for(const z of X)z.remove()&&(W=!0);return W&&s.history.createSnapshot(),!0}function u(W){t.selectMode=vt.MULTIPLE,t.selectedType=Se.ELEMENT,t.selectedPage=void 0;const X=c(),z=[];for(const T of X){if(W.some(y=>y.id===T.id)){z.push(T.id);continue}T.blur()}for(const T of W)z.includes(T.id)||T.focus();return t.selected=W.map(T=>T.id),!0}function v(W){let X=c();const z=X.findIndex(T=>T.id===W.id);return W.type===F.TABLE_ROW?(X.some(T=>T.type!==F.TABLE_ROW)&&(X=[]),z>=0?X.splice(z,1):X.push(W),u(X)):W.type===F.TABLE_CELL?(X.some(T=>T.type!==F.TABLE_CELL)&&(X=[]),z>=0?X.splice(z,1):X.push(W),u(X)):(X.some(T=>T.type===F.TABLE_CELL||T.type===F.TABLE_ROW)&&(X=[]),z>=0?X.splice(z,1):X.push(W),u(X))}function R(){const W=t.scale??100,X=mn.indexOf(W);return X<0?(t.scale=100,!1):X>=mn.length-1?!1:(t.scale=mn[X+1],!0)}function N(){const W=t.scale??100,X=mn.indexOf(W);return X<0?(t.scale=100,!1):X==0?!1:(t.scale=mn[X-1],!0)}function D(){const X=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=X}function M(){s.state.panel.left=!s.state.panel.left}function O(){s.state.panel.right=!s.state.panel.right}function C(W,X){const z=X??s.doc,T=Array.isArray(z)?"element":z instanceof Ce?"document":z instanceof Ht?"page":"element",y=Array.isArray(z)?z.map(L=>L.id).join(","):z.id,_=`${T}:${y}:${W}`;return l.replaceSnapshot({action:_})}function q(){return s.state.selectedType!==Se.ELEMENT?!1:s.state.selectMode==vt.SINGLE||s.state.selectMode==vt.MULTIPLE&&s.state.selected.length==1}function Q(){return s.state.selectedType!==Se.ELEMENT?!0:s.state.selected.length==0}function oe(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),Ro(ps,s),Jn(oe),s}function Oe(){return So(ps)}const wh=A({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=De("classes"),l=Oe(),o=k(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=k(()=>{const u=e.page.id,v=l.doc.pages.find(R=>R.id===u);return v==null?0:e.direction=="horizontal"?v.width:v.height}),r=k(()=>{const u=s.value,v=[];for(let R=0;R<=u;R+=10)v.push(R/10);return v}),i=k(()=>{const u=s.value,v=[];for(let R=0;R<=u;R+=2.5)v.push(R);return v}),a=k(()=>{const u=l.getSelectedElements();return u.length==1?u[0]:null}),c=k(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),p=k(()=>{const u=a.value;if(u==null)return 0;if(u.type==="TableCell"){const v=u.parent;if(v==null)return 0;const R=v.parent;return v==null?0:R.top+v.offsetTop}if(u.type==="TableRow"){const v=u.parent;return v==null?0:v.top+u.offsetTop}return u.top}),f=k(()=>{const u=a.value;if(u==null)return 0;if(u.type==="TableCell"){const v=u.parent;if(v==null)return 0;const R=v.parent;return v==null?0:R.left+u.offsetLeft}if(u.type==="TableRow"){const v=u.parent;return v==null?0:v.left}return u.left});function h(u,v){return e.direction==="horizontal"?{left:u*(e.scale/100)+"mm",height:(v-2)%4==0?"8px":"4px"}:{top:u*(e.scale/100)+"mm",width:(v-2)%4==0?"8px":"4px"}}function E(u){return e.direction==="horizontal"?{left:u*(e.scale/100)+"cm"}:{top:u*(e.scale/100)+"cm"}}function S(u){return e.direction==="horizontal"?{left:f.value*(e.scale/100)+"px",width:u.width*(e.scale/100)+"px",height:"100%"}:{top:p.value*(e.scale/100)+"px",height:u.height*(e.scale/100)+"px",width:"100%"}}return(u,v)=>(w(),I("div",{class:m(o.value)},[d("div",{class:m(b(t).ruler),style:Z(c.value)},[a.value?(w(),I("div",{key:0,class:m(b(t).selected),style:Z(S(a.value))},null,6)):Y("",!0),(w(!0),I(se,null,fe(i.value,(R,N)=>(w(),I("div",{key:R,class:m(b(t).scale),style:Z(h(R,N))},null,6))),128)),(w(!0),I(se,null,fe(r.value,R=>(w(),I("div",{class:m(b(t).number),style:Z(E(R))},te(R),7))),256))],6)],2))}}),kh="_horizontalRuler_170u5_2",Lh="_verticalRuler_170u5_15",Ch="_ruler_170u5_27",Ih="_scale_170u5_32",Oh="_number_170u5_46",Nh="_selected_170u5_71",xh={horizontalRuler:kh,verticalRuler:Lh,ruler:Ch,scale:Ih,number:Oh,selected:Nh},Mh={classes:xh},so=U(wh,[["__cssModules",Mh]]),Dh=["title"],xn=8,qh=A({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=De("classes"),s={},r=Oe(),i=k(()=>({top:Math.round(t.top*t.zoom)+"px"}));function a(h){if(h.button!=0||t.disabled===!0)return;const E=h.target.closest("."+o.dragLine);E!=null&&(h.stopPropagation(),s.init=!1,s.target=E,s.parent=E.offsetParent,s.target.setPointerCapture(h.pointerId),window.addEventListener("pointermove",c),window.addEventListener("pointerup",p))}function c(h){h.preventDefault();const E=f(s.parent);let S=h.clientY-E.top;S<0&&(S=0),S>E.height&&(S=E.height),t.min>0&&S<t.min+xn&&(S=t.min+xn),t.max>0&&S>t.max-xn&&(S=t.max-xn),s.target.style.top=S/(r.state.scale/100)+"px",s.top=S,s.init=!0}function p(h){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(h.pointerId),window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",p)}function f(h){return h instanceof HTMLElement?h.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(h,E)=>(w(),I("div",{class:m({[b(o).dragLine]:!0,[b(o).disabled]:n.disabled}),style:Z(i.value),onPointerdown:pe(a,["stop"]),title:n.title},null,46,Dh))}}),Ah="_dragLine_1m7rt_2",$h="_disabled_1m7rt_26",Bh={dragLine:Ah,disabled:$h},Ph={classes:Bh},io=U(qh,[["__cssModules",Ph]]),Vh=A({__name:"Selection",setup(n,{expose:e}){const t=be(),l=be(),o=Wn("selectionRef"),s=be(),r=Oe();let i=[];function a(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function c(){const S=[],u=l.value;if(u==null)return S;const v=p(u);if(v.length==0)return S;const R=o.value;return v.forEach(N=>{if(!vi(N,R)){N.classList.remove(ne.SELECTED);return}const D=Reflect.get(N,rt);D instanceof me&&(N.classList.add(ne.SELECTED),S.push(D))}),S}function p(S){if(S.matches("."+ne.ELEMENT)){const u=Reflect.get(S,rt);if(u&&u.type===F.TABLE)return S.querySelectorAll(":scope td")}return S.querySelectorAll(`:scope .${ne.PAGE} > .${ne.SELECTABLE}`)}function f(S,u){const v=u.closest("."+ne.PAPER);if(v==null)return;S.stopPropagation(),S.preventDefault();const R=a(),N=v.getBoundingClientRect();R.initialX=S.clientX,R.initialY=S.clientY,R.top=S.clientY-N.top,R.left=S.clientX-N.left,l.value=u,s.value=R,t.value=v,i=[],window.addEventListener("pointermove",h),window.addEventListener("pointerup",E)}function h(S){const u=s.value;if(u==null)return;S.stopPropagation(),S.preventDefault();const v=o.value;if(u.init!==!0){if(Math.abs(S.clientX-u.initialX)<4&&Math.abs(S.clientY-u.initialY)<4)return;v.setPointerCapture(S.pointerId),v.style.display="block",u.init=!0}const R=Math.abs(S.clientX-u.initialX),N=Math.abs(S.clientY-u.initialY),D=S.clientX<u.initialX?-R:0,M=S.clientY<u.initialY?-N:0;v.style.top=u.top+M+"px",v.style.left=u.left+D+"px",v.style.width=R+"px",v.style.height=N+"px",i=c()}function E(S){const u=s.value;if(u==null)return;u.init&&(S.stopPropagation(),S.preventDefault()),i.length>0&&r.multiSelectElements(i);const v=o.value;v.releasePointerCapture(S.pointerId),v.style.display="none",s.value=void 0,window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",E)}return e({onSelectStart:f}),(S,u)=>(w(),I("div",{ref_key:"selectionRef",ref:o,class:m(S.classes.selection),onClick:u[0]||(u[0]=pe(()=>{},["stop"]))},null,2))}}),zh="_selection_10jfe_2",Fh={selection:zh},Uh={classes:Fh},Hh=U(Vh,[["__cssModules",Uh]]);function Gh(n,e,t){e.element.isSelected||t.selectElement(e.element);const l=t.getSelectedElements();if(l.length<=1){const a=Jl(e.element.type);if(typeof a!="function")return mt.open(n.clientX,n.clientY,{menus:ro(e,t)});const p=a(e.element).map(f=>Vn(f,t,[e.element],e.element)).filter(f=>f!=null);return mt.open(n.clientX,n.clientY,{menus:p})}if(new Set(l.map(a=>a.type)).size>1){const c=["copy","delete","---","z-index"].map(p=>Vn(p,t,l,e.element)).filter(p=>p!=null);return mt.open(n.clientX,n.clientY,{menus:c})}const s=Jl(e.element.type);if(typeof s!="function")return mt.open(n.clientX,n.clientY,{menus:ro(e,t)});const i=s(e.element).map(a=>Vn(a,t,l,e.element)).filter(a=>a!=null);return mt.open(n.clientX,n.clientY,{menus:i})}function ro(n,e){return["setting","text-direction","---","copy","delete","---","z-index"].map(l=>Vn(l,e,e.getSelectedElements(),n.element)).filter(l=>l!=null)}function Wh(n){const e=document.querySelector("#"+n.id);if(e==null)return!1;const t=e.querySelector("img,svg");if(t==null)return!1;const l=t.getBoundingClientRect(),o=ce.processLengthToPX(K(n,"top"))??1,s=ce.processLengthToPX(K(n,"bottom"))??1,r=ce.processLengthToPX(K(n,"left"))??1,i=ce.processLengthToPX(K(n,"right"))??1,a=ce.processLengthToPX(n.getStyle("paddingTop"))??0,c=ce.processLengthToPX(n.getStyle("paddingBottom"))??0,p=ce.processLengthToPX(n.getStyle("paddingLeft"))??0,f=ce.processLengthToPX(n.getStyle("paddingRight"))??0;return n.setWidth(l.width+r+i+p+f,!0),n.setHeight(l.height+o+s+a+c,!0),!0}function Vn(n,e,t,l){if(typeof n!="string")return n;switch(n){case"---":case"divider":return{type:"divider"};case"copy":return{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){e.clipboard.writeElement(t)}};case"delete":return{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){t.forEach(o=>o.remove()),e.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){t.forEach(o=>o.resetDS()),e.createSnapshot()}}]};case"z-index":return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){for(const o of t)o.id!==l.id&&o.moveToTop();l.moveToTop(),e.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){t.forEach(o=>o.moveUp()),e.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){t.forEach(o=>o.moveDown()),e.createSnapshot()}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){t.forEach(o=>o.moveToBottom()),e.createSnapshot()}}]};case"setting":return{type:"menu",label:(rs(t[0].type)??"元素")+"属性",icon:"icon-setting",handler(){Zf(t).then(s=>{for(const r of t)r.style=Object.assign({},r.style,s.style);e.createSnapshot()}).catch(Ne)}};case"text-direction":return{type:"menu",label:"文字方向",icon:"icon-text-direction",handler(){ts(t).then(o=>{for(const s of t)s.style=Object.assign({},s.style,o.style);e.createSnapshot()}).catch(Ne)}};case"qrcode-setting":return{type:"menu",label:"二维码属性",icon:"icon-qrcode",handler(){Kf(t).then(o=>{var s;for(const r of t)r.style=Object.assign({},r.style,o.style),r.attributes.barcolor=(s=o.qrcode)==null?void 0:s.barcolor;e.createSnapshot()}).catch(Ne)}};case"barcode-setting":return{type:"menu",label:"条形码属性",icon:"icon-barcode",handler(){Jf(t).then(o=>{var s,r,i;for(const a of t)a.style=Object.assign({},a.style,o.style),a.attributes.barcolor=(s=o.barcode)==null?void 0:s.barcolor,a.attributes.width=(r=o.barcode)==null?void 0:r.width,a.attributes.height=(i=o.barcode)==null?void 0:i.height;e.createSnapshot()}).catch(Ne)}};case"auto-resize":return{type:"menu",label:"自动调整尺寸",icon:"icon-resize",handler(){t.map(s=>Wh(s)).some(Boolean)&&e.createSnapshot()}};default:return null}}const Xh=A({props:{element:{type:me,required:!0}},setup(n){const e=De("classes"),t=Oe(),l=k(()=>{n.element.state.key;const f=n.element,h={"--quickprint-element-top":f.top+"px","--quickprint-element-left":f.left+"px","--quickprint-element-width":f.width+"px","--quickprint-element-height":f.height+"px","z-index":f.zIndex};return r()&&(h.transform=`rotate(${f.style.rotate}deg)`),h}),o={TOP:[e.resizeTop,jt.TOP],BOTTOM:[e.resizeBottom,jt.BOTTOM],LEFT:[e.resizeLeft,jt.LEFT],RIGHT:[e.resizeRight,jt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,jt.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const f=n.element;return f.style.rotate==0||f.style.rotate==null?!1:t.state.selectMode===vt.SINGLE?!f.isSelected:!0}function i(f){const h=Xg(f.type);if(h==null)return g("div",{class:e.unknown},[g("span",null,[ye("未知的打印元素")])]);const E={element:f,key:f.id+"_"+f.state.key};return Zg(f.type)?(E.onContextmenu=c,st(h,E)):st(h,E)}function a(f,h){h.stopPropagation();const E=h.target.closest("."+ne.ELEMENT);E&&Reflect.get(E,Qn)===Il.DRAG_ELEMENT||(h.ctrlKey?t.toggleMultiSelectedElement(f):t.selectElement(f))}function c(f){f.stopPropagation(),f.preventDefault(),Gh(f,n,t)}function p(){return!Kg(n.element.type)||r()?null:s.map(f=>{const h={class:[ne.RESIZEABLE_INDICATOR,f[0]],["."+Co]:f[1]};return g("div",Ks(h,{onPointerdown:t.onResizeStart}),null)})}return function(){const f=n.element,h={["."+rt]:f,["."+Cl]:f.type,id:f.id,key:f.id,class:{[ne.ELEMENT]:!0,[ne.DRAGGABLE]:!0,[ne.RESIZEABLE]:!0,[ne.SELECTED]:f.state.selected,[ne.SELECTABLE]:jg(f.type),["quickprint-is-"+f.type.toLowerCase()]:!0},style:l.value,onClick:a.bind(null,f)};return g("div",h,[i(f),p()])}}}),Yh="_unknown_za8zh_2",jh="_resizeTop_za8zh_12",Zh="_resizeBottom_za8zh_20",Kh="_resizeLeft_za8zh_28",Jh="_resizeRight_za8zh_36",Qh="_resizeBottomRight_za8zh_44",ev={unknown:Yh,resizeTop:jh,resizeBottom:Zh,resizeLeft:Kh,resizeRight:Jh,resizeBottomRight:Qh},tv={classes:ev},nv=U(Xh,[["__cssModules",tv]]),fs=mo(()=>go(()=>import("./component-B099-0hV.js"),__vite__mapDeps([2,3,1,4,5]))),lv=A({__name:"DocJson",props:{doc:{type:Ce,required:!0}},setup(n){const e=n,t=at(),l=Te(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(w(),le(b(fs),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),ov="_json_9crpe_2",sv={json:ov},iv={classes:sv},rv=U(lv,[["__cssModules",iv]]),av=Me(function(n){return bt("调试",g(rv,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(gt)});async function cv(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+ne.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const a=r.getBoundingClientRect(),c=n.clientX-a.left-i[0].left,p=n.clientY-a.top-i[0].top;for(const f of i)f.setLeft(f.left+c),f.setTop(f.top+p),e.page.append(f);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){av(t).then(r=>{if(r==null)return;const i=Ce.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),mt.open(n.clientX,n.clientY,{menus:l})}const uv=A({props:{doc:{type:Ce,required:!0},page:{type:Ht,required:!0}},setup(n){const e=De("classes"),t=Oe(),l=Wn("selectionRef"),o=Wn("paperRef"),s=Te(0),r=k(()=>n.page.width),i=k(()=>n.page.height);function a(N){N.stopPropagation();const D=N.target.closest("."+ne.PAPER);D&&Reflect.get(D,Qn)===Il.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function c(){if(n.page.header.display===!1)return null;const N=n.page.header.height,D="page_header_"+s.value;return g(io,{title:"页眉",top:N,onMove:f,key:D},null)}function p(){if(n.page.footer.display===!1)return null;const N=ce.mm_to_px(i.value)-n.page.footer.height,D="page_footer_"+s.value;return g(io,{title:"页脚",top:N,onMove:h,key:D},null)}function f(N){n.page.setHeaderHeight(N.top),s.value++}function h(N){n.page.setFooterHeight(ce.mm_to_px(i.value)-N.top),s.value++}function E(N){N.stopPropagation(),N.preventDefault(),cv(N,n,t)}function S(){const N=n.doc.margins;if(N==null)return null;const D=[];return N.top&&D.push(g("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:N.top}},null)),N.bottom&&D.push(g("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:N.bottom}},null)),N.left&&D.push(g("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:N.left}},null)),N.right&&D.push(g("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:N.right}},null)),D.length>0?D:null}function u(){const N={["."+Lo]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[ne.PAGE]:!0,[ne.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:E},D=n.page.children.map(M=>g(nv,{element:M},null));return g("div",N,[c(),D,p(),S()])}function v(N){if(N.button!==0)return;N.stopPropagation(),N.preventDefault();const M=N.target.closest("."+ne.ELEMENT);if(M==null)return R(N,o.value);const O=Reflect.get(M,rt);return O==null?R(N,o.value):O.type===F.TABLE?R(N,M):Jg(O.type)?t.onDragStart(N):R(N,o.value)}function R(N,D){var M;(M=l.value)==null||M.onSelectStart(N,D)}return function(){const N=t.state.scale/100,D={id:"@"+n.page.id,ref:"paperRef",class:{[ne.PAPER]:!0,[ne.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*N+"mm",height:i.value*N+"mm"},onPointerdown:v,onClick:a};return g("div",D,[u(),g(Hh,{ref:"selectionRef"},null)])}}}),dv="_paper_1eq2b_2",pv="_grid_1eq2b_12",fv="_marginHorizontalGuide_1eq2b_19",mv="_marginVerticalGuide_1eq2b_27",gv={paper:dv,grid:pv,marginHorizontalGuide:fv,marginVerticalGuide:mv},hv={classes:gv},vv=U(uv,[["__cssModules",hv]]),bv={class:"quickprint-is-fill-h quickprint-is-scrollable"},yv="icon-zhanweifu",_v=A({__name:"Element",setup(n){const e=Oe();return(t,l)=>(w(),I("div",{class:m(t.classes.panel)},[d("div",{class:m(t.classes.header)},"可打印元素",2),d("div",bv,[d("div",{class:m(t.classes.grid)},[(w(!0),I(se,null,fe(b(Ug),o=>(w(),I("div",wo({key:o.type,class:[b(ne).DRAGGABLE,t.classes.element],[`.${b(ko)||""}`]:b(Ye).INSERT,[`.${b(Cl)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>b(e).onDragStart&&b(e).onDragStart(...s))}),[g(b(G),{icon:o.icon??yv,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),d("span",null,te(o.title),1)],48))),128))],2)])],2))}}),Ev="_panel_1p36j_2",Tv="_header_1p36j_8",Sv="_grid_1p36j_18",Rv="_element_1p36j_30",wv="_icon_1p36j_45",kv={panel:Ev,header:Tv,grid:Sv,element:Rv,icon:wv},Lv={classes:kv},Cv=U(_v,[["__cssModules",Lv]]),Iv=["onClick"],Ov=A({__name:"SelectPath",setup(n){const e=Oe(),t=k(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===Se.PAGE){const i=e.getSelectedPage();if(i!=null){const a="页面"+(i.index+1);r.push({id:i.id,title:a,type:"page",data:i})}return r}if(s.selectedType===Se.ELEMENT){if(s.selectMode===vt.MULTIPLE){const c=e.getSelectedElements();if(c.length===0)return r;let p=c[0];for(;p.parent;){const f=p.parent;if(f instanceof Ht){const h="页面"+(f.index+1);return r.push({id:f.id,title:h,type:"page",data:f}),r}p=f}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const a=[{id:i.id,title:wn(i.type),type:"element",data:i}];for(;i.parent;){const c=i.parent;if(c instanceof Ht){const p="页面"+(c.index+1);return a.unshift({id:c.id,title:p,type:"page",data:c}),r.concat(a)}a.unshift({id:c.id,title:wn(c.type),type:"element",data:c}),i=c}}return r}),l=k(()=>{if(e.state.selectedType!=Se.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],a=nl(i);if(!(a==null||!a.content))return a.type===we.VARIABLE||a.type===we.FORMULA?`[${a.content}]`:a.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(w(),I("div",{class:m(s.classes.paths)},[(w(!0),I(se,null,fe(t.value,(i,a)=>(w(),I(se,{key:i.id},[a>0?(w(),le(b(G),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):Y("",!0),d("div",{class:m(s.classes.path),onClick:c=>o(i)},te(i.title),11,Iv)],64))),128)),l.value?(w(),I(se,{key:0},[g(b(G),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),d("div",{class:m(s.classes.content)},te(l.value),3)],64)):Y("",!0)],2))}}),Nv="_paths_fuk62_2",xv="_path_fuk62_2",Mv="_icon_fuk62_28",Dv="_content_fuk62_33",qv={paths:Nv,path:xv,icon:Mv,content:Dv},Av={classes:qv},$v=U(Ov,[["__cssModules",Av]]),Bv={class:"quickprint-config"},Pv={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},Vv={class:"quickprint-config-group"},zv={class:"quickprint-config-section quickprint-config-inline"},Fv={class:"quickprint-config-content quickprint-config-inline"},Uv={class:"quickprint-config-group"},Hv={class:"quickprint-config-section quickprint-config-inline"},Gv={class:"quickprint-config-content quickprint-config-inline"},Wv={class:"quickprint-config-section quickprint-config-inline"},Xv={class:"quickprint-config-content quickprint-form-inline"},Yv={class:"quickprint-config-group"},jv={class:"quickprint-config-section quickprint-config-inline"},Zv={class:"quickprint-config-content quickprint-form-inline"},Kv={key:0,class:"quickprint-config-section quickprint-config-inline"},Jv={class:"quickprint-config-content quickprint-form-inline"},Qv={class:"quickprint-config-section quickprint-config-inline"},eb={class:"quickprint-config-content quickprint-form-inline"},tb=A({__name:"PageConfig",props:{page:{type:Ht,required:!0}},setup(n){const e=n,t=Oe(),l=[{label:"显示",value:!0},{label:"隐藏",value:!1}],o=[{label:"禁止",value:Cn.NONE},{label:"跟随表格",value:Cn.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],s=k({get(){return e.page.size.type},set(p){e.page.size.type!==p&&(e.page.size.type=p,p===_n.CONTENT&&(e.page.size.orientation=void 0),t.createSnapshot())}}),r=k({get(){return e.page.orientation},set(p){e.page.size.orientation!==p&&(e.page.size.orientation=p,t.createSnapshot())}}),i=k(()=>e.page.width),a=k({get(){return e.page.height},set(p){if(e.page.size.height===p)return;const f=Number(p);!vo(f)||f<0||(e.page.size.height=f,t.createSnapshot())}}),c=k({get(){return e.page.footer.flow??Cn.NONE},set(p){e.page.footer.flow!==p&&(e.page.footer.flow=p===Cn.NONE?void 0:p,t.createSnapshot())}});return(p,f)=>(w(),I("div",Bv,[f[15]||(f[15]=d("div",{class:"quickprint-config-title"},"页面配置",-1)),d("div",Pv,[d("div",Vv,[f[7]||(f[7]=d("div",{class:"quickprint-config-group-title"},"页眉",-1)),d("section",zv,[f[6]||(f[6]=d("header",{class:"quickprint-config-header"},"位置",-1)),d("div",Fv,[g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),g(Ct,{modelValue:n.page.header.display,"onUpdate:modelValue":f[0]||(f[0]=h=>n.page.header.display=h),options:l,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),d("div",Uv,[f[10]||(f[10]=d("div",{class:"quickprint-config-group-title"},"页脚",-1)),d("section",Hv,[f[8]||(f[8]=d("header",{class:"quickprint-config-header"},"位置",-1)),d("div",Gv,[g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),g(Ct,{modelValue:n.page.footer.display,"onUpdate:modelValue":f[1]||(f[1]=h=>n.page.footer.display=h),options:l,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),d("section",Wv,[f[9]||(f[9]=d("header",{class:"quickprint-config-header"},"跟随",-1)),d("div",Xv,[g(b(re),{modelValue:c.value,"onUpdate:modelValue":f[2]||(f[2]=h=>c.value=h),options:o},null,8,["modelValue"])])])]),d("div",Yv,[f[14]||(f[14]=d("div",{class:"quickprint-config-group-title"},"画布",-1)),d("section",jv,[f[11]||(f[11]=d("header",{class:"quickprint-config-header"},"尺寸",-1)),d("div",Zv,[g(Ct,{modelValue:s.value,"onUpdate:modelValue":f[3]||(f[3]=h=>s.value=h),options:b(ri),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===b(_n).CONTENT?(w(),I("section",Kv,[f[12]||(f[12]=d("header",{class:"quickprint-config-header"},"内容",-1)),d("div",Jv,[g(It,{class:"quickprint-form-inline-item",label:"宽",modelValue:i.value,readonly:""},null,8,["modelValue"]),g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:a.value,"onUpdate:modelValue":f[4]||(f[4]=h=>a.value=h)},null,8,["modelValue"])])])):Y("",!0),d("section",Qv,[f[13]||(f[13]=d("header",{class:"quickprint-config-header"},"方向",-1)),d("div",eb,[g(Ct,{modelValue:r.value,"onUpdate:modelValue":f[5]||(f[5]=h=>r.value=h),class:"quickprint-w-full",options:b(No),disabled:n.page.size.type===b(_n).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),nb=["value","placeholder","disabled"],lb=A({__name:"InputWithLabel",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=Wn("inputRef"),s=k({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?ce.px_to_mm(t.modelValue):t.standard==="mm"&&t.target==="px"?ce.mm_to_px(t.modelValue):0},set(p){if(!t.disabled){if(t.standard===t.target)return l("update:modelValue",p);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Math.round(ce.mm_to_px(p)));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",ce.px_to_mm(p))}}}),r=k(()=>t.disabled!==!0&&t.clearable&&s.value!=null);function i(p){if(t.disabled)return;const h=p.target.value;if(s==null||h===""){if(t.clearable)return;const S=t.min?t.min:t.defaultValue;s.value=S;return}const E=Number(h);if(!Number.isNaN(E)){if(t.min!=null&&E<t.min){s.value=t.min;return}s.value=E}}function a(){t.disabled||l("update:modelValue",void 0)}function c(){var p;t.disabled||((p=o.value)==null||p.blur(),setTimeout(()=>{var f;return(f=o.value)==null?void 0:f.focus()},50))}return(p,f)=>(w(),I("label",{class:m({[p.classes.inputWithLabel]:!0,[p.classes.withClear]:n.clearable})},[d("span",{class:m(p.classes.label)},te(n.label),3),d("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",step:"any",value:s.value,placeholder:n.placeholder,disabled:n.disabled,onBlur:i,onKeydown:To(c,["enter"])},null,40,nb),r.value?(w(),I("span",{key:0,class:m(p.classes.clearBtn),onClick:pe(a,["stop"])},[g(b(G),{icon:"icon-close",size:"11px"})],2)):Y("",!0)],2))}}),ob="_inputWithLabel_1k5y2_2",sb="_clearBtn_1k5y2_7",ib="_label_1k5y2_11",rb="_withClear_1k5y2_31",ab={inputWithLabel:ob,clearBtn:sb,label:ib,withClear:rb},cb={classes:ab},Mn=U(lb,[["__cssModules",cb]]),ub=A({__name:"UnitSelect",props:Gt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=kn(n,"modelValue"),o=k(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(w(),I("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[g(b(re),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:he(()=>[d("span",{class:m(s.classes.text)},te(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),db="_unit_135mn_2",pb="_text_135mn_8",fb="_select_135mn_25",mb={unit:db,text:pb,select:fb},gb={classes:mb},hb=U(ub,[["__cssModules",gb]]),vb=A({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=Te(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch(Vs)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(w(),I("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[g(b(G),{icon:"icon-copy"}),g(Js,{name:"quickprint-fade"},{default:he(()=>[l.value?(w(),I("span",{key:0,class:m(s.classes.message)},"已复制",2)):Y("",!0)]),_:1})],2))}}),bb="_btn_v9scw_2",yb="_message_v9scw_6",_b={btn:bb,message:yb},Eb={classes:_b},Tb=U(vb,[["__cssModules",Eb]]),Sb=A({__name:"window",props:{code:{type:String,default:""},doc:{type:Ce,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=at(),l=Te(e.code),o=be();function s(){return l.value}function r(){e.doc!=null&&Pc({doc:e.doc}).then(f=>{var E;if(f==null)return;const h=f.type=="reference"?`[=${f.value}]`:`[${f.value}]`;(E=o.value)==null||E.insert(h)})}function i(f){var h;return yt(f,(h=e.doc)==null?void 0:h.ds)}function a(){var f;(f=o.value)==null||f.insert(`[2.6.${kl.ELEMENT_VALUR}]`)}function c(){Vc().then(f=>{var h;f!=null&&((h=o.value)==null||h.insert(f.value))})}function p(){zc({doc:e.doc}).then(f=>{var h;f!=null&&((h=o.value)==null||h.insert(f.value))})}return t==null||t.useHandle("confirm",s),(f,h)=>(w(),I("div",{class:m(f.classes.window)},[n.mode!=="code"?(w(),I("div",{key:0,class:m(f.classes.toolbar)},[n.mode=="condition"?(w(),I(se,{key:0},[d("button",{type:"button",class:"quickprint-text-btn",onClick:a},[g(b(G),{icon:"icon-number-sign"}),h[1]||(h[1]=d("span",null,"插入元素值",-1))]),d("div",{class:m(f.classes.divider)},null,2)],64)):Y("",!0),d("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[g(b(G),{icon:"icon-insert-var"}),h[2]||(h[2]=d("span",null,"插入变量",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:c},[g(b(G),{icon:"icon-function"}),h[3]||(h[3]=d("span",null,"插入函数",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:p},[g(b(G),{icon:"icon-formula"}),h[4]||(h[4]=d("span",null,"插入公式",-1))])],2)):Y("",!0),g(b(fs),{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=E=>l.value=E),language:"javascript",class:m(f.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),Rb="_window_n935p_2",wb="_toolbar_n935p_11",kb="_code_n935p_22",Lb="_divider_n935p_27",Cb={window:Rb,toolbar:wb,code:kb,divider:Lb},Ib={classes:Cb},ms=U(Sb,[["__cssModules",Ib]]),gs=Me(function(n){return bt("公式",g(ms,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Ne)}),Ob=Me(function(n,e){return bt(n,g(ms,{code:e},null),{preset:"editor"}).promisify().catch(Ne)}),Nb={class:"quickprint-config-section quickprint-config-inline"},xb={class:"quickprint-config-content"},Mb=["value"],Db=A({__name:"Visibility",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??zt.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==zt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=k({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=k(()=>{var i;return Nl((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=k(()=>{var i;return t.value!==zt.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${kl.ELEMENT_VALUR}]`;gs({code:i,doc:e.element.doc,mode:"condition"}).then(a=>{a!=null&&(l.value=a)})}return(i,a)=>(w(),I(se,null,[d("section",Nb,[a[1]||(a[1]=d("header",{class:"quickprint-config-header"},"可见性",-1)),d("div",xb,[g(b(re),{class:"quickprint-w-full",options:b(ti),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=c=>t.value=c)},null,8,["options","modelValue"])])]),t.value===b(zt).CONDITION?(w(),I("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[d("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Mb),s.value?(w(),le(b(G),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2)):Y("",!0)],64))}}),qb="_condition_siopf_2",Ab={condition:qb},$b={classes:Ab},Bb=U(Db,[["__cssModules",$b]]);function Pb(n,e){return k({get(){return n.element.attributes.position??zn.DEFAULT},set(t){if(n.element.attributes.position===t)return;const l=t===zn.DEFAULT?void 0:t;n.element.attributes.position=l,e.createSnapshot()}})}function Vb(n,e){return k({get(){return n.element.attributes.printMode??Fn.ONCE},set(t){if(n.element.attributes.printMode===t)return;const l=t===Fn.ONCE?void 0:t;n.element.attributes.printMode=l,e.createSnapshot()}})}function zb(n,e){return k({get(){return n.element.attributes.overflow??En.HIDDEN},set(t){if(n.element.attributes.overflow===t)return;const l=t===En.HIDDEN?void 0:t;n.element.attributes.overflow=l,e.createSnapshot()}})}function Fb(n,e){return k({get(){const t=n.element;return t.type!==F.TABLE_CELL?n.element.width:t.hasColSpan?t.offsetWidth:t.width},set(t){n.element.width===t||n.element.type===F.TABLE_ROW||(n.element.setWidth(t,!0),e.createSnapshot())}})}function Ub(n,e){return k({get(){const t=n.element;return t.type!==F.TABLE_CELL?n.element.height:t.hasRowSpan?t.offsetHeight:t.height},set(t){n.element.height!==t&&(n.element.setHeight(t,!0),e.createSnapshot())}})}function Hb(n,e){return k({get(){return n.element.attributes.display},set(t){n.element.attributes.display!==t&&(n.element.attributes.display=t??void 0,e.createSnapshot())}})}function Gb(n,e){return k({get(){return n.element.ds.type},set(t){n.element.ds.type!==t&&(n.element.ds.type=t,n.element.ds.value=void 0,e.createSnapshot())}})}const Wb=A({__name:"ImageUpload",emits:["upload"],setup(n,{emit:e}){const t=e,l=be();function o(){const r=l.value;r!=null&&(r.value="",r.click())}function s(r){var p;const i=r.target;if(i==null)return;const a=(p=i.files)==null?void 0:p[0];if(a==null)return;const c=new FileReader;c.readAsDataURL(a),c.onload=function(f){var E;const h=(E=f.target)==null?void 0:E.result;typeof h=="string"&&t("upload",h)}}return(r,i)=>(w(),I("div",{class:m(r.classes.upload)},[d("button",{type:"button",onClick:o,class:"quickprint-text-btn"},[g(b(G),{icon:"icon-upload"}),i[0]||(i[0]=d("span",null,"上传本地图片",-1))]),d("input",{type:"file",ref_key:"inputRef",ref:l,onChange:s,accept:"image/*",class:m(r.classes.input)},null,34)],2))}}),Xb="_upload_1tbfz_2",Yb="_input_1tbfz_9",jb={upload:Xb,input:Yb},Zb={classes:jb},Kb=U(Wb,[["__cssModules",Zb]]),Jb=A({__name:"Const",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k(()=>e.element.type===F.IMAGE),l=k({get(){return e.element.ds.value},set(s){e.element.ds.value=s}});function o(s){l.value=s}return(s,r)=>(w(),I("div",{class:m(s.classes.const)},[xe(d("textarea",{"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"5",placeholder:"请输入"},null,512),[[Ue,l.value]]),t.value?(w(),I("div",{key:0,class:m(s.classes.upload)},[g(Kb,{onUpload:o})],2)):Y("",!0)],2))}}),Qb="_upload_bqfbo_6",ey={const:"_const_bqfbo_2",upload:Qb},ty={classes:ey},ny=U(Jb,[["__cssModules",ty]]),ly={class:"quickprint-config-ds-var-type"},oy=["title"],sy=A({__name:"Variable",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Oe(),l=k(()=>ve(e.element.ds.value)),o=k(()=>yt(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var p;const i=await xl({doc:t.doc,value:e.element.ds.value}).catch(gt);if(i==null||(e.element.setDataSource(we.VARIABLE,i.value),e.element.type!=F.TABLE_CELL||i.type!=="ds"))return;const a=e.element.parent;if(a==null||a.isBindVariable||((p=i.parent)==null?void 0:p.type)!==ue.ARRAY)return;const c=i.parent;a.setDataSource(we.VARIABLE,`${Ut.DS}.${c.type}.${c.name}`)}return(i,a)=>(w(),I("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(w(),I(se,{key:0},[a[0]||(a[0]=d("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),g(b(G),{icon:"icon-open-new",size:"14px"})],64)):(w(),I(se,{key:1},[d("span",ly,"<"+te(b(ba)(e.element.ds.value))+">",1),d("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},te(o.value),9,oy),d("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[g(b(G),{icon:"icon-close",size:"12px"})])],64))]))}}),iy=["value"],ry=A({__name:"Code",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k(()=>ve(e.element.ds.value));function l(){return Rt(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){Ob("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(w(),I("div",{onClick:o,class:m(s.classes.code)},[d("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,iy),t.value?(w(),le(b(G),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2))}}),ay="_code_1az68_2",cy={code:ay},uy={classes:cy},dy=U(ry,[["__cssModules",uy]]),py=["value"],fy=A({__name:"Formula",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Oe(),l=k(()=>ve(e.element.ds.value)),o=k(()=>Nl(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;gs({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(w(),I("div",{onClick:s,class:m(r.classes.code)},[d("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,py),l.value?(w(),le(b(G),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2))}}),my="_code_ipm2q_2",gy={code:my},hy={classes:gy},vy=U(fy,[["__cssModules",hy]]);function by(n){switch(n.ds.type){case we.CONST:return g(ny,{element:n},null);case we.VARIABLE:return g(sy,{element:n},null);case we.CODE:return g(dy,{element:n},null);case we.FORMULA:return g(vy,{element:n},null);default:return null}}const yy=A({props:{element:{type:me,required:!0}},setup(n){const e=Oe(),t=k(()=>wn(n.element.type)),l=k(()=>si.filter(C=>C.value!=n.element.type)),o=Te("px"),s=Fb(n,e),r=Ub(n,e),i=zb(n,e),a=Pb(n,e),c=Vb(n,e),p=Hb(n,e),f=Gb(n,e),h=k(()=>{const C=n.element;return C.type===F.TABLE_ROW||C.type===F.TABLE?!0:C.type!==F.TABLE_CELL?!1:C.hasColSpan}),E=k(()=>{const C=n.element;return C.type===F.TABLE_ROW||C.type===F.TABLE?!0:C.type!==F.TABLE_CELL?!1:C.hasRowSpan}),S=k(()=>{const C=n.element,q=C.parent;if(q===null||!(q instanceof Ht))return!1;const Q=q.header;if(Q.display&&C.bottom<=(Q.height??0))return!1;const oe=q.parent;if(oe==null)return!1;const W=q.footer;return!(W.display&&C.top>=Math.floor(ce.mm_to_px(oe.paper.height))-(W.height??0))});function u(C,q){return q==null?!1:!!q.includes(C)}function v(){const C=hn(n.element.type);if(u(_e.LAYOUT,C==null?void 0:C.exclude))return null;const q=n.element,Q=u(_e.COORD,C==null?void 0:C.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("位置")]),g("div",{class:"quickprint-config-content quickprint-form-inline"},[g(Mn,{class:"quickprint-form-inline-item",label:"左",modelValue:q.left,"onUpdate:modelValue":y=>q.left=y,target:o.value},null),g(Mn,{class:"quickprint-form-inline-item",label:"上",modelValue:q.top,"onUpdate:modelValue":y=>q.top=y,target:o.value},null)])]),oe=u(_e.SIZE)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[g("span",null,[ye("尺寸")])]),g("div",{class:"quickprint-config-content quickprint-form-inline"},[g(Mn,{class:"quickprint-form-inline-item",label:"宽",modelValue:s.value,"onUpdate:modelValue":y=>s.value=y,target:o.value,disabled:h.value},null),g(Mn,{class:"quickprint-form-inline-item",label:"高",modelValue:r.value,"onUpdate:modelValue":y=>r.value=y,target:o.value,disabled:E.value},null)])]),W=u(_e.VISIBILITY,C==null?void 0:C.exclude)?null:g(Bb,{element:q},null),X=u(_e.OVERFLOW,C==null?void 0:C.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("溢出时")]),g("div",{class:"quickprint-config-content"},[g(re,{modelValue:i.value,"onUpdate:modelValue":y=>i.value=y,options:di,class:"quickprint-w-full"},null)])]),z=u(_e.PRINT_MODE,C==null?void 0:C.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("打印模式")]),g("div",{class:"quickprint-config-content"},[g(re,{modelValue:c.value,"onUpdate:modelValue":y=>c.value=y,options:ui,class:"quickprint-w-full"},null)])]),T=u(_e.POSITION,C==null?void 0:C.exclude)||!S.value?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("定位模式")]),g("div",{class:"quickprint-config-content"},[g(re,{modelValue:a.value,"onUpdate:modelValue":y=>a.value=y,options:ci,class:"quickprint-w-full"},null)])]);return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title quickprint-is-row"},[g("span",{class:"quickprint-is-fill-w"},[ye("布局")]),g("span",null,[ye("单位：")]),g(hb,{modelValue:o.value,"onUpdate:modelValue":y=>o.value=y},null)]),Q,oe,W,X,z,T])}function R(){const C=hn(n.element.type);if(u(_e.BASIC,C==null?void 0:C.exclude))return null;const q=n.element,Q=u(_e.PREFIX,C==null?void 0:C.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("前缀")]),g("div",{class:"quickprint-config-content"},[xe(g("input",{"onUpdate:modelValue":X=>q.attributes.prefix=X,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ue,q.attributes.prefix]])])]),oe=u(_e.SUFFIX,C==null?void 0:C.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("后缀")]),g("div",{class:"quickprint-config-content"},[xe(g("input",{"onUpdate:modelValue":X=>q.attributes.suffix=X,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ue,q.attributes.suffix]])])]),W=u(_e.DISPLAY,C==null?void 0:C.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("数据类型")]),g("div",{class:"quickprint-config-content"},[g(re,{options:l.value,modelValue:p.value,"onUpdate:modelValue":X=>p.value=X,class:"quickprint-w-full"},null)])]);return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[ye("基础")]),Q,oe,W])}function N(){const C=hn(n.element.display);return(C==null?void 0:C.display)==null?null:st(C.display,{element:n.element})}function D(){const C=hn(n.element.type);if(u(_e.ATTRIBUTES,C==null?void 0:C.exclude))return null;const q=C!=null&&C.attributes?st(C.attributes,{element:n.element}):null,Q=N();if(q==null&&Q==null)return null;const oe=Q!=null&&q!=null?g("div",{class:"quickprint-config-divider"},null):null;return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[ye("属性")]),Q,oe,q])}function M(){const C=hn(n.element.type);return u(_e.DATASOURCE,C==null?void 0:C.exclude)?null:g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[ye("数据")]),g(re,{options:Io,modelValue:f.value,"onUpdate:modelValue":q=>f.value=q},null),by(n.element)])}function O(C){C(n.element.id)}return function(){const q=n.element;return g("div",{class:"quickprint-config"},[g("div",{class:"quickprint-config-title"},[g("span",null,[t.value,ye("配置")]),null]),g("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[g("div",{class:"quickprint-config-group"},[g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("标识")]),g("div",{class:"quickprint-config-content"},[g("span",{class:"quickprint-config-id"},[q.id]),g(Tb,{onCopy:O},null)])]),g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[ye("标题")]),g("div",{class:"quickprint-config-content"},[xe(g("input",{type:"text","onUpdate:modelValue":Q=>q.title=Q,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ue,q.title]])])])]),v(),R(),D(),M()])])}}}),_y=A({setup(){const n=Oe(),e=De("classes");function t(){return g("div",{class:e.tip},[ye("未知的打印元素")])}function l(){return g("div",{class:e.tip},[ye("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return g(tb,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(F).includes(i.type)===!1?t():st(yy,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==Se.ELEMENT?!1:i.selectMode===vt.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),Ey="_tip_cdonk_2",Ty={tip:Ey},Sy={classes:Ty},Ry=U(_y,[["__cssModules",Sy]]);function ct(n,e){if(n.state.selectedType!==Se.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ke(n,e,t){if(n.state.selectedType!==Se.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function lt(n,e){if(n.state.selectedType!==Se.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function wy(n){const e="underline";return k({get(){if(n.state.selectedType!==Se.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ke(n,e,t):lt(n,e)}})}function ky(n){const e="lineThrough";return k({get(){if(n.state.selectedType!==Se.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ke(n,e,t):lt(n,e)}})}function Ly(n){const e="lineHeight";return k({get(){return ct(n,e)},set(t){t===$t.DEFAULT?lt(n,e):Ke(n,e,t)}})}function Cy(n){const e="highlightColor";return k({get(){return ct(n,e)??We.BLACK},set(t){t===""?lt(n,e):Ke(n,e,t)}})}function Iy(n){const e="backgroundColor";return k({get(){return ct(n,e)??We.BLACK},set(t){t===""?lt(n,e):Ke(n,e,t)}})}function Oy(n){const e="fontStyle";return k({get(){return ct(n,e)===Bl.ITALIC},set(t){t?Ke(n,e,Bl.ITALIC):lt(n,e)}})}function Ny(n){const e="textAlign";return k({get(){return ct(n,e)??kt.LEFT},set(t){t===kt.LEFT?lt(n,e):Ke(n,e,t)}})}function xy(n){const e="verticalAlign";return k({get(){return ct(n,e)??ht.MIDDLE},set(t){t===ht.MIDDLE?lt(n,e):Ke(n,e,t)}})}function My(n){const e="fontFamily";return k({get(){return ct(n,e)},set(t){t===Ee.DEFAULT?lt(n,e):Ke(n,e,t)}})}function Dy(n){const e="fontSize";return k({get(){return ct(n,e)},set(t){t===$e.DEFAULT?lt(n,e):Ke(n,e,t)}})}function qy(n){const e="color";return k({get(){return ct(n,e)??We.BLACK},set(t){Ke(n,e,t)}})}function Ay(n){const e="fontWeight";return k({get(){return ct(n,e)===700},set(t){t?Ke(n,e,700):lt(n,e)}})}const $y=["title","onClick"],By=A({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=Oe(),l=k(()=>{if(t.state.selectedType!==Se.ELEMENT)return null;const S=t.getSelectedElements();if(S.length!==1)return null;const u=S[0],v={};return Le(u,"top")&&(v.borderTopStyle="solid"),Le(u,"right")&&(v.borderRightStyle="solid"),Le(u,"bottom")&&(v.borderBottomStyle="solid"),Le(u,"left")&&(v.borderLeftStyle="solid"),v}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(E){if(t.state.selectedType!==Se.ELEMENT)return!1;const u=t.getSelectedElements();if(u.length!==1)return!1;const v=u[0];switch(E){case e.TOP:return Le(v,"top");case e.RIGHT:return Le(v,"right");case e.BOTTOM:return Le(v,"bottom");case e.LEFT:return Le(v,"left");case e.ALL:return Le(v,"top")&&Le(v,"right")&&Le(v,"bottom")&&Le(v,"left");default:return!1}}function r(E){if(t.state.selectedType!==Se.ELEMENT)return;const u=t.getSelectedElements();if(u.length!=0){switch(E){case e.TOP:return a(u);case e.BOTTOM:return p(u);case e.LEFT:return f(u);case e.RIGHT:return c(u);case e.ALL:return h(u)}t.createSnapshot()}}function i(){if(t.state.selectedType!==Se.ELEMENT)return;const S=t.getSelectedElements();if(S.length!=0){for(const u of S)u.setStyle("borderStyle",void 0),u.setStyle("borderTopStyle",void 0),u.setStyle("borderRightStyle",void 0),u.setStyle("borderBottomStyle",void 0),u.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function a(E){const S=!E.every(u=>Le(u,"top"));for(const u of E)S?u.setStyle("borderTopStyle",ie.SOLID):u.removeStyle("borderTopStyle")}function c(E){const S=!E.every(u=>Le(u,"right"));for(const u of E)S?u.setStyle("borderRightStyle",ie.SOLID):u.removeStyle("borderRightStyle")}function p(E){const S=!E.every(u=>Le(u,"bottom"));for(const u of E)S?u.setStyle("borderBottomStyle",ie.SOLID):u.removeStyle("borderBottomStyle")}function f(E){const S=!E.every(u=>Le(u,"left"));for(const u of E)S?u.setStyle("borderLeftStyle",ie.SOLID):u.removeStyle("borderLeftStyle")}function h(E){const S=!E.every(u=>Le(u,"top")&&Le(u,"right")&&Le(u,"bottom")&&Le(u,"left"));for(const u of E){if(S){u.setStyle("borderStyle",S?"solid":void 0);continue}u.removeStyle("borderStyle"),u.removeStyle("borderTopStyle"),u.removeStyle("borderRightStyle"),u.removeStyle("borderBottomStyle"),u.removeStyle("borderLeftStyle")}}return(E,S)=>(w(),le(b($o),null,{popover:he(()=>[d("div",{class:m(E.classes.popover)},[d("div",null,[(w(),I("button",{type:"button",title:"全部框线",key:b(e).ALL,class:m({"quickprint-text-btn":!0,[E.classes.tool]:!0,"quickprint-is-selected":s(b(e).ALL)}),onClick:S[0]||(S[0]=u=>r(b(e).ALL))},[g(b(G),{icon:"icon-border",size:"16px"})],2)),(w(),I("button",{type:"button",title:"无框线",key:b(e).NONE,class:m({"quickprint-text-btn":!0,[E.classes.tool]:!0}),onClick:i},[g(b(G),{icon:"icon-border-none",size:"16px"})],2))]),d("div",{class:m(E.classes.divider)},[(w(),I(se,null,fe(o,u=>d("button",{type:"button",title:u.label,key:u.value,class:m({"quickprint-text-btn":!0,[E.classes.tool]:!0,"quickprint-is-selected":s(u.value)}),onClick:v=>r(u.value)},[g(b(G),{icon:u.icon,size:"16px"},null,8,["icon"])],10,$y)),64))],2)],2)]),default:he(()=>[d("div",{class:m(["quickprint-text-btn",E.classes.borderSelect]),title:"边框"},[d("div",{class:m({[E.classes.border]:!0}),style:Z(l.value)},null,6)],2)]),_:1}))}}),Py="_border_rprfx_2",Vy="_borderSelect_rprfx_10",zy="_popover_rprfx_14",Fy="_divider_rprfx_18",Uy={border:Py,borderSelect:Vy,popover:zy,divider:Fy},Hy={classes:Uy},Gy=U(By,[["__cssModules",Hy]]),Wy={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Xy={class:"quickprint-config-section"},Yy={class:"quickprint-form-inline"},jy=A({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"磅",value:de.PT},{label:"像素",value:de.PX},{label:"毫米",value:de.MM}],l=E("top"),o=E("bottom"),s=E("left"),r=E("right"),i=k(()=>ml.map(u=>({label:u.size===In.CUSTOM?"自定义":`${u.size}`,value:u.size,short:u.size===In.CUSTOM?void 0:`${u.width}mm ✕ ${u.height}mm`}))),a=k({get(){return e.config.paginate??yl.PAPER},set(u){e.config.paginate=u}});function c(u){e.config.width=u,h()}function p(u){e.config.height=u,h()}function f(u){const v=ml.find(R=>R.size===u);v!=null&&(e.config.width=v.width,e.config.height=v.height,e.config.orientation=v.orientation,e.config.margins=v.margins,e.config.size=v.size)}function h(){const u=e.config,v=ml.find(R=>R.size===In.CUSTOM?!1:R.orientation===u.orientation&&R.width===u.width&&R.height===u.height);if(v==null){u.size=In.CUSTOM;return}u.size=v.size}function E(u){return k({get(){var v;return(v=e.config.margins)==null?void 0:v[u]},set(v){e.config.margins==null&&(e.config.margins={}),e.config.margins[u]=v}})}function S(){const u=e.config.width;e.config.width=e.config.height,e.config.height=u,h()}return(u,v)=>(w(),I("div",Wy,[d("section",Xy,[v[6]||(v[6]=d("header",{class:"quickprint-config-header"},[d("span",null,"尺寸")],-1)),g(b(re),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":f,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),d("div",Yy,[g(It,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":c,title:"单位:毫米"},null,8,["modelValue"]),d("button",{type:"button",class:m(["quickprint-text-btn",u.classes.swap]),onClick:S,title:"交换"},[g(b(G),{icon:"icon-swap"})],2),g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":p,title:"单位:毫米"},null,8,["modelValue"])])]),g(b(je).Item,{label:"方向",class:"quickprint-mt-2"},{default:he(()=>[v[7]||(v[7]=d("div",{class:"quickprint-is-fill-w"},null,-1)),g(Ct,{modelValue:n.config.orientation,"onUpdate:modelValue":v[0]||(v[0]=R=>n.config.orientation=R),options:b(No)},null,8,["modelValue","options"])]),_:1}),g(b(je).Item,{label:"分页"},{default:he(()=>[v[8]||(v[8]=d("div",{class:"quickprint-is-fill-w"},null,-1)),g(Ct,{modelValue:a.value,"onUpdate:modelValue":v[1]||(v[1]=R=>a.value=R),options:b(ai)},null,8,["modelValue","options"])]),_:1}),g(b(je).Fieldset,{header:"参考边距",desc:"可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:he(()=>[g(b(je).Grid,{columns:2,columnGap:"24px",rowGap:"4px"},{default:he(()=>[g(b(je).Item,{label:"上边距"},{default:he(()=>[g(Re,{modelValue:b(l),"onUpdate:modelValue":v[2]||(v[2]=R=>Be(l)?l.value=R:null),options:t,defaultUnit:b(de).MM},null,8,["modelValue","defaultUnit"])]),_:1}),g(b(je).Item,{label:"下边距"},{default:he(()=>[g(Re,{modelValue:b(o),"onUpdate:modelValue":v[3]||(v[3]=R=>Be(o)?o.value=R:null),options:t,defaultUnit:b(de).MM},null,8,["modelValue","defaultUnit"])]),_:1}),g(b(je).Item,{label:"左边距"},{default:he(()=>[g(Re,{modelValue:b(s),"onUpdate:modelValue":v[4]||(v[4]=R=>Be(s)?s.value=R:null),options:t,defaultUnit:b(de).MM},null,8,["modelValue","defaultUnit"])]),_:1}),g(b(je).Item,{label:"右边距"},{default:he(()=>[g(Re,{modelValue:b(r),"onUpdate:modelValue":v[5]||(v[5]=R=>Be(r)?r.value=R:null),options:t,defaultUnit:b(de).MM},null,8,["modelValue","defaultUnit"])]),_:1})]),_:1})]),_:1})]))}}),Zy="_swap_1wk2q_2",Ky={swap:Zy},Jy={classes:Ky},Qy=U(jy,[["__cssModules",Jy]]),e_={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},t_={class:"quickprint-is-fill-h"},n_={class:"quickprint-is-fill-h"},l_=A({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:de.NONE},{label:"磅",value:de.PT},{label:"像素",value:de.PX}],l=k(()=>il.map(c=>(c.style={fontFamily:c.value==Ee.DEFAULT?Ee.SONG:c.value},c))),o=k(()=>jo.map(c=>(c.style={fontFamily:c.value==Ee.DEFAULT?Ee.SONG:c.value},c))),s=k({get(){return e.config.style.fontFamily??Ee.DEFAULT},set(c){const p=c===Ee.DEFAULT?void 0:c;e.config.style.fontFamily=p}}),r=k({get(){return e.config.style.enFontFamily??Ee.DEFAULT},set(c){const p=c===Ee.DEFAULT?void 0:c;e.config.style.enFontFamily=p}}),i=k({get(){return e.config.style.fontSize},set(c){const p=ve(c)?void 0:c;e.config.style.fontSize=p}}),a=k({get(){return e.config.style.lineHeight},set(c){e.config.style.lineHeight=c}});return(c,p)=>(w(),I("div",e_,[d("section",{class:m(c.classes.font)},[d("div",{class:m(c.classes.zhFont)},[d("div",{class:m(c.classes.title)},"中文字体",2),d("div",t_,[g(b(re),{options:l.value,modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=f=>s.value=f)},null,8,["options","modelValue"])])],2),d("div",{class:m(c.classes.enFont)},[d("div",{class:m(c.classes.title)},"西文字体",2),d("div",n_,[g(b(re),{options:o.value,modelValue:r.value,"onUpdate:modelValue":p[1]||(p[1]=f=>r.value=f)},null,8,["options","modelValue"])])],2),d("div",{class:m(c.classes.lineHeight)},[d("div",{class:m(c.classes.title)},"行高",2),g(Re,{modelValue:a.value,"onUpdate:modelValue":p[2]||(p[2]=f=>a.value=f),options:t},null,8,["modelValue"])],2),d("div",{class:m(c.classes.fontSize)},[d("div",{class:m(c.classes.title)},"字号",2),g(Ko,{modelValue:i.value,"onUpdate:modelValue":p[3]||(p[3]=f=>i.value=f),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),o_="_font_145qf_2",s_="_zhFont_145qf_9",i_="_enFont_145qf_16",r_="_lineHeight_145qf_23",a_="_fontSize_145qf_30",c_="_title_145qf_45",u_={font:o_,zhFont:s_,enFont:i_,lineHeight:r_,fontSize:a_,title:c_},d_={classes:u_},p_=U(l_,[["__cssModules",d_]]),f_=A({__name:"index",props:{doc:{type:Ce,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=at(),l=ze(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,paginate:i.attributes.paginate,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,a)=>(w(),I("div",{class:m(i.classes.setting)},[n.active=="paper"?(w(),le(Qy,{key:0,config:l},null,8,["config"])):Y("",!0),n.active=="font"?(w(),le(p_,{key:1,config:l},null,8,["config"])):Y("",!0),d("div",{class:m(i.classes.footer)},[d("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),d("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),m_="_setting_h98ws_2",g_="_footer_h98ws_10",h_={setting:m_,footer:g_},v_={classes:h_},b_=U(f_,[["__cssModules",v_]]),y_=Me(function(n){return nt("文档",(e,t)=>g(b_,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,n.attributes.paginate=e.paginate,e)).catch(Ne)}),__=A({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Oe(),t=De("classes"),l=My(e),o=Dy(e),s=Ly(e),r=Iy(e),i=Cy(e),a=qy(e),c=Ay(e),p=Oy(e),f=wy(e),h=ky(e),E=Ny(e),S=xy(e),u=k(()=>il.map(z=>(z.style={fontFamily:z.value==Ee.DEFAULT?Ee.SONG:z.value},z)));function v(z){return g("button",{type:"button",class:"quickprint-text-btn",onClick:()=>z.handler(e)},[z.icon&&g(G,{icon:z.icon},null),g("span",null,[z.label])])}function R(z){z.preventDefault()}function N(){c.value=!c.value}function D(){p.value=!p.value}function M(){f.value=!f.value}function O(){h.value=!h.value}function C(){const z=e.getSelectedElements();if(z.length==0)return;const T=Math.min(...z.map(y=>y.left));for(const y of z)y.setLeft(T,!0);e.createSnapshot()}function q(){const z=e.getSelectedElements();if(z.length==0)return;const T=z[0].page;if(T==null)return;const y=ce.mm_to_px(T.width);for(const _ of z)_.setLeft((y-_.width)/2);e.createSnapshot()}function Q(){const z=e.getSelectedElements();if(z.length==0)return;const T=Math.max(...z.map(y=>y.left+y.width));for(const y of z)y.setLeft(T-y.width,!0);e.createSnapshot()}async function oe(){const z=await Bc(e.doc);z!=null&&(e.doc.ds=e.doc.createDS(z))}function W(){y_(e.doc)}function X(z){var T,y;if(typeof z=="function")return z(e,t);if(typeof z=="object")return v(z);if(typeof z!="string")return null;switch(z){case"divider":case"---":return g("div",{class:t.divider},null);case"space":return g("div",{class:"quickprint-is-fill-w"},null);case"undo":{const _=!e.history.allowUndo();return g("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:_,onClick:e.history.undo},[g(G,{icon:"icon-undo"},null)])}case"redo":{const _=!e.history.allowRedo();return g("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:_,onClick:e.history.redo},[g(G,{icon:"icon-redo"},null)])}case"delete":return g("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[g(G,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return g(re,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":_=>l.value=_,options:u.value,class:t.tool,button:!0},null);case"fontSize":return g(re,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":_=>o.value=_,options:Ml,class:t.tool,button:!0},null);case"lineHeight":return g(re,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":_=>s.value=_,options:Zo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return g(en,{modelValue:r.value,"onUpdate:modelValue":_=>r.value=_,class:t.tool},{default:()=>[g("div",{class:t.colorIcon,title:"背景色"},[g(G,{icon:"icon-bg-color-a",size:"15px"},null),g("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return g(en,{modelValue:i.value,"onUpdate:modelValue":_=>i.value=_,class:t.tool},{default:()=>[g("div",{class:t.colorIcon,title:"突出显示"},[g(G,{icon:"icon-bg-color-b",size:"15px"},null),g("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return g(en,{modelValue:a.value,"onUpdate:modelValue":_=>a.value=_,class:t.tool},{default:()=>[g("div",{class:t.colorIcon,title:"字体颜色"},[g(G,{icon:"icon-font",size:"15px"},null),g("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"fontWeight":{const _={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":c.value};return g("button",{type:"button",title:"加粗",class:_,onClick:N},[g(G,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const _={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":p.value};return g("button",{type:"button",title:"斜体",class:_,onClick:D},[g(G,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const _={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":f.value};return g("button",{type:"button",title:"下划线",class:_,onClick:M},[g(G,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const _={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":h.value};return g("button",{type:"button",title:"删除线",class:_,onClick:O},[g(G,{icon:"icon-through-line",size:"16px"},null)])}case"border":return g(Gy,null,null);case"textAlign":{const _=((T=Sl.find(x=>x.value===E.value))==null?void 0:T.label)??"水平对齐",L={selected({option:x}){return g(G,{icon:x==null?void 0:x.icon,class:"quickprint-is-self-center"},null)}};return g(re,{modelValue:E.value,"onUpdate:modelValue":x=>E.value=x,options:Sl,title:_,class:t.tool,width:"36px",size:"mini",button:!0},L)}case"verticalAlign":{const _=((y=Tl.find(x=>x.value===S.value))==null?void 0:y.label)??"垂直对齐",L={selected({option:x}){return g(G,{icon:x==null?void 0:x.icon,class:"quickprint-is-self-center"},null)}};return g(re,{modelValue:S.value,"onUpdate:modelValue":x=>S.value=x,options:Tl,title:_,class:t.tool,width:"36px",size:"mini",button:!0},L)}case"alignLeft":{const _={"quickprint-text-btn":!0,[t.tool]:!0};return g("button",{type:"button",title:"左侧对齐",class:_,onClick:C},[g(G,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const _={"quickprint-text-btn":!0,[t.tool]:!0};return g("button",{type:"button",title:"水平居中",class:_,onClick:q},[g(G,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const _={"quickprint-text-btn":!0,[t.tool]:!0};return g("button",{type:"button",title:"右侧对齐",class:_,onClick:Q},[g(G,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const _={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return g("button",{type:"button",title:"网格",class:_,onClick:e.toggleBackground},[g(G,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const _={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return g("button",{type:"button",title:"元素面板",class:_,onClick:e.toggleElementPanel},[g(G,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const _={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return g("button",{type:"button",title:"配置面板",class:_,onClick:e.toggleConfigPanel},[g(G,{icon:"icon-config",size:"16px"},null)])}case"datasource":return g("button",{type:"button",class:"quickprint-text-btn",onClick:oe},[g(G,{icon:"icon-datasource"},null),g("span",null,[ye("数据源")])]);case"document":return g("button",{type:"button",class:"quickprint-text-btn",onClick:W},[g(G,{icon:"icon-file-text"},null),g("span",null,[ye("文档配置")])]);default:return null}}return function(){return g("div",{class:t.toolbar,onMousedown:R},[n.toolbar.map(X)])}}}),E_="_toolbar_1bhq2_2",T_="_divider_1bhq2_8",S_="_tool_1bhq2_2",R_="_colorIcon_1bhq2_18",w_="_colorIndicator_1bhq2_38",k_={toolbar:E_,divider:T_,tool:S_,colorIcon:R_,colorIndicator:w_},L_={classes:k_},C_=U(__,[["__cssModules",L_]]);function I_(n){let e=null;const t=be(),l=ze({width:0,height:0,scrollTop:0,scrollLeft:0}),o=be(),s=ze({id:"",top:0,left:0,width:0,height:0});async function r(){await rn();const E=t.value;E!=null&&(l.width=E.offsetWidth,l.height=E.offsetHeight)}function i(E){const S=E.target;l.scrollLeft=S.scrollLeft,l.scrollTop=S.scrollTop}function a(E){const u=E.target.closest("."+ne.PAPER);u!=null&&(o.value=u,p(u),c())}async function c(){await rn();const E=o.value;E!=null&&(s.id=E.id.slice(1),s.width=E.offsetWidth,s.height=E.offsetHeight,s.top=E.offsetTop,s.left=E.offsetLeft)}function p(E){E!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(E))}function f(){const E=n.doc.firstPage;if(E==null)return;const S=document.querySelector("#\\@"+E.id);o.value=S,e&&S&&e.observe(S),c()}function h(E){E.some(S=>S.target.matches("."+ne.CANVAS))&&(r(),c()),E.some(S=>S.target.matches("."+ne.PAPER))&&(r(),c())}return Ll(()=>n.state.scale,()=>c()),an(()=>{e=new ResizeObserver(h),e.observe(t.value),f(),r()}),Qs(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:a}}const hs=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),O_=A({__name:"index",props:Gt({modelValue:{type:Ce,required:!0},toolbar:{type:Array,default(){return hs}}},{modelValue:{required:!0},modelModifiers:{}}),emits:Gt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=be(),o=be(),s=zo(),r=kn(n,"modelValue"),i=Rh(r,{queryElement:R,dispatchEvent:N}),{canvasRef:a,canvasRect:c,pageRect:p,onScroll:f,onSelectPage:h}=I_(i),E=k(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),S=k(()=>{const M=i.doc.style;return{fontFamily:Kn(M==null?void 0:M.fontFamily,M==null?void 0:M.enFontFamily),fontSize:M==null?void 0:M.fontSize,lineHeight:M==null?void 0:M.lineHeight}});function u(){i.state.panel.left=!1}function v(){i.state.panel.right=!1}function R(M){switch(M){case"ghost":return o.value;case"root":return l.value;default:return}}function N(M,...O){t(M,...O)}function D(M){M.deltaY>0?i.zoomIn():i.zoomOut()}return(M,O)=>(w(),I("div",{class:m(M.classes.designer),ref_key:"rootRef",ref:l,style:Z(E.value)},[d("div",{class:m(M.classes.header)},[it(M.$slots,"headerLeft"),g(C_,{class:m(M.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),it(M.$slots,"headerRight")],2),d("div",{class:m(M.classes.main)},[b(i).state.panel.left?(w(),I("div",{key:0,class:m(M.classes.left)},[d("button",{type:"button",onClick:u,class:m(["quickprint-text-btn",M.classes.closePanelBtn])},[g(b(G),{icon:"icon-close",size:"12px"})],2),g(Cv)],2)):Y("",!0),d("div",{class:m([M.classes.center,b(ne).CANVAS]),onWheel:pe(D,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:a},[g(so,{canvas:b(c),page:b(p),scale:b(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),g(so,{canvas:b(c),page:b(p),scale:b(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),d("div",{class:m([b(ne).SCROLLABLE,M.classes.canvas]),style:Z(S.value),onScroll:O[0]||(O[0]=(...C)=>b(f)&&b(f)(...C)),onClickCapture:O[1]||(O[1]=(...C)=>b(h)&&b(h)(...C))},[(w(!0),I(se,null,fe(r.value.pages,C=>(w(),le(vv,{key:C.id,doc:r.value,page:C},null,8,["doc","page"]))),128))],38),d("div",{class:m(M.classes.footer)},[g($v),g(b(zs),{scale:b(i).state.scale,onZoomIn:b(i).zoomIn,onZoomOut:b(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),b(i).state.panel.right?(w(),I("div",{key:1,class:m(M.classes.right)},[d("button",{type:"button",onClick:v,class:m(["quickprint-text-btn",M.classes.closePanelBtn])},[g(b(G),{icon:"icon-close",size:"12px"})],2),g(Ry)],2)):Y("",!0)],2),d("div",{ref_key:"ghostRef",ref:o,class:m(M.classes.ghost)},null,2),g(b(Fs))],6))}}),N_="_designer_grxxm_2",x_="_header_grxxm_17",M_="_toolbar_grxxm_25",D_="_footer_grxxm_31",q_="_main_grxxm_47",A_="_left_grxxm_55",$_="_center_grxxm_63",B_="_right_grxxm_75",P_="_canvas_grxxm_83",V_="_closePanelBtn_grxxm_96",z_="_ghost_grxxm_103",F_={designer:N_,header:x_,toolbar:M_,footer:D_,main:q_,left:A_,center:$_,right:B_,canvas:P_,closePanelBtn:V_,ghost:z_},U_={classes:F_},H_=U(O_,[["__cssModules",U_]]),G_={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:Jt.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Ne)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:Jt.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:Jt.DISABLED}},W_=A({__name:"Block",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k(()=>{e.element.state.key;const l=e.element;return{"--quickprint-element-top":l.top+"px","--quickprint-element-left":l.left+"px","--quickprint-element-width":l.width+"px","--quickprint-element-height":l.height+"px","z-index":l.zIndex}});return(l,o)=>(w(),I("div",{style:Z(t.value),class:m(l.classes.element)},null,6))}}),X_="_element_1hint_2",Y_={element:X_},j_={classes:Y_},Z_=U(W_,[["__cssModules",j_]]),K_=A({__name:"Element",props:{element:{type:me,required:!0}},setup(n){const e=n,t=k(()=>{e.element.state.key;const l=e.element;return{"--quickprint-element-top":l.top+"px","--quickprint-element-left":l.left+"px","--quickprint-element-width":l.width+"px","--quickprint-element-height":l.height+"px","z-index":l.zIndex}});return(l,o)=>(w(),I("div",{style:Z(t.value),class:m(l.classes.element)},[it(l.$slots,"default")],6))}}),J_="_element_1l75c_2",Q_={element:J_},eE={classes:Q_},tE=U(K_,[["__cssModules",eE]]),nE=A({props:{define:{type:Ce,required:!0},blocky:{type:Boolean,default:!1}},setup(n){const e=De("classes"),t=Te(1),l=Te(!1),o=be();let s;const r=k(()=>{const c=n.define.firstPage,p=n.define.style,f={width:`${c.width}mm`,height:`${c.height}mm`,fontFamily:Kn(p==null?void 0:p.fontFamily,p==null?void 0:p.enFontFamily),fontSize:p==null?void 0:p.fontSize,lineHeight:p==null?void 0:p.lineHeight};return l.value&&(f.transform=`scale(${t.value})`),f});function i(c){if(n.blocky)return g(Z_,{element:c,key:c.id},null);const p=Qg(c.type);return g(tE,{element:c,key:c.id},{default:()=>[p?st(p,{element:c,key:c.id}):g(cn,{element:c,showDS:!1,key:c.id},null)]})}function a(){const c=o.value;if(c==null||c.parentElement==null)return;const p=c.parentElement;t.value=Math.min(p.offsetWidth/c.offsetWidth,p.offsetHeight/c.offsetHeight)}return an(()=>{const c=o.value;c==null||c.parentElement==null||(l.value=!0,s=new ResizeObserver(()=>a()),s.observe(c.parentElement))}),Jn(()=>{s&&(s.disconnect(),s=void 0)}),function(){return g("div",{class:e.minimap},[g("div",{style:r.value,ref:o,class:e.paper},[n.define.firstPage.children.map(i)])])}}}),lE="_minimap_l3glz_2",oE="_paper_l3glz_21",sE={minimap:lE,paper:oE},iE={classes:sE},rE=U(nE,[["__cssModules",iE]]);function aE(n,e={}){const t=Us(e.zIndexManager);n.use(Hs,{zIndex:t,presets:G_}),Gs(n._context)}const cE="0.0.0",uE={version:cE,install:aE},dE=["onClick"],pE=A({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=at(),l=r(),o=zo(),s=k(()=>({"--quickprint-dpr":o.value}));function r(){return ze(Ws.map(c=>({id:c.id,name:c.name,define:null})))}function i(c){t==null||t.confirm(c)}function a(){for(const c of l)Xs(c.id).then(p=>{c.define=Ce.create(p==null?void 0:p.define)})}return a(),(c,p)=>(w(),I("div",{class:m([c.classes.panel,"quickprint-is-scrollable"]),style:Z(s.value)},[(w(!0),I(se,null,fe(b(l),f=>(w(),I("div",{key:f.id,class:m(c.classes.item),onClick:h=>i(f)},[d("div",{class:m(c.classes.card)},[f.define?(w(),le(b(rE),{key:0,define:f.define,class:m(c.classes.minimap)},null,8,["define","class"])):(w(),I("div",{key:1,class:m(c.classes.loading)},"加载中...",2))],2),d("p",{class:m(c.classes.name)},te(f.name),3)],10,dE))),128))],6))}}),fE="_panel_1gnat_2",mE="_item_1gnat_16",gE="_card_1gnat_21",hE="_name_1gnat_36",vE="_loading_1gnat_47",bE={panel:fE,item:mE,card:gE,name:hE,loading:vE},yE={classes:bE},_E=U(pE,[["__cssModules",yE]]),EE='<div class="quickprint-md"><ul><li>feat: <code>Select</code>组件支持搜索，改进选中样式</li></ul></div>',TE=["innerHTML"],SE=A({__name:"Todo",setup(n){return(e,t)=>(w(),I("div",{innerHTML:b(EE),class:m(e.classes.doc)},null,10,TE))}}),RE="_doc_1ri3b_2",wE={doc:RE},kE={classes:wE},LE=U(SE,[["__cssModules",kE]]),CE='<div class="quickprint-md"><h2>v0.1.4</h2><ul><li>feat: 表格行支持多选</li><li>feat: 表格行支持创建循环组</li><li>feat: 支持文字缩放</li><li>feat: [示例]外卖单</li><li>feat: [设计器]表格右下角支持调整大小</li><li>fix: 合并行时需要检测是否存在循环组</li><li>fix: 表格行列指示器位置错误</li><li>fix: 表格行调整高度时，同步调整单元格高度</li></ul><h2>v0.1.3</h2><ul><li>feat: [设计器]模板预览</li><li>feat: [预览]滚动时调整页码</li><li>feat: [示例]测试页</li><li>feat: [示例]草稿纸</li><li>feat: 支持分页模式</li><li>feat: 补全纸张尺寸</li></ul><h2>v0.1.2</h2><ul><li>feat: [示例]银行叫号</li><li>feat: [元素]图片</li><li>feat: [元素]二维码</li><li>feat: [元素]条形码</li><li>feat: [预览]支持监听事件</li><li>feat: [设计器]支持自动调整图片、二维码、条形码的尺寸</li><li>fix: 改进图片空白提示</li></ul><h2>v0.1.1</h2><ul><li>feat: 支持设置文字方向</li><li>feat: 支持设置斜线表头</li><li>feat: 调整元素对齐方式</li><li>feat: 调试模式</li><li>feat: 单元格的宽、高会将边框尺寸计算在内</li><li>feat: [设计器]支持按<code>Ctrl</code>多选元素</li><li>fix: 修复<em>每页打印</em>选项不生效</li><li>fix: 修复表格存在行合并时，渲染有误</li></ul></div>',IE=["innerHTML"],OE=A({__name:"ChangeLog",setup(n){return(e,t)=>(w(),I("div",{innerHTML:b(CE),class:m(e.classes.doc)},null,10,IE))}}),NE="_doc_19r5b_2",xE={doc:NE},ME={classes:xE},DE=U(OE,[["__cssModules",ME]]),qE="local",ao="quickprint-local-define",AE=A({__name:"index",setup(n){const e=De("classes"),t=E(),l="20260119",o=[{label:"新建",icon:"icon-file-text",handler:p},{label:"加载示例",icon:"icon-import",handler:a},"---",...hs];function s(){const u=JSON.stringify(t.value);localStorage.setItem(ao,u)}function r(){s()}function i(){const u=t.value.id,v=u.startsWith("case_")?u:qE,R=`${window.location.origin}/preview.html?id=${v}`;s(),bt("文档预览",st("iframe",{src:R,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(N){window.open(R,"_blank"),N.close()}}]})}function a(){const u={mask:!0,top:"5vh",width:"90vw",height:"90vh",resizeMode:Jt.DISABLED};bt("请选择示例",st(_E),u).promisify().then(v=>c(v.id)).catch(Ne)}async function c(u){const v=await Pl(u,!1);v!=null&&(Ys(u),t.value=Ce.create(v.define),f())}function p(){const u=Ce.createNormalDocument();t.value=u,f()}function f(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function h(){const u=localStorage.getItem(ao);if(u!=null)return Ce.create(u);const v=js(),R=await Pl(v.id,!1);return R==null?Ce.createNormalDocument():Ce.create(R.define)}function E(){const u=Te();return h().then(v=>{u.value=v,f()}),u}const S=Me(function(){return nt("OpenPrint",(u,v)=>v==="done"?st(DE):st(LE),{height:"480px",tabs:[{label:"进行中",name:"todo"},{label:"更新日志",name:"done"}]}).promisify().catch(gt)});return(u,v)=>b(t)?(w(),le(b(H_),{modelValue:b(t),"onUpdate:modelValue":v[1]||(v[1]=R=>Be(t)?t.value=R:null),toolbar:o,class:m(b(e).main),key:b(t).id,onSave:r,onPreview:i},{headerLeft:he(()=>[d("div",{class:m(b(e).logo)},[v[2]||(v[2]=d("h1",null,"OpenPrint",-1)),d("div",{class:m(b(e).dev),onClick:v[0]||(v[0]=(...R)=>b(S)&&b(S)(...R))},"DEV_"+te(b(l)),3)],2)]),headerRight:he(()=>[d("div",{class:m(b(e).operate)},[d("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[g(b(G),{icon:"icon-run"}),v[3]||(v[3]=d("span",null,"预览",-1))]),d("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[g(b(G),{icon:"icon-save"}),v[4]||(v[4]=d("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):Y("",!0)}}),$E="_main_14ojw_2",BE="_iframe_14ojw_6",PE="_divider_14ojw_14",VE="_logo_14ojw_20",zE="_dev_14ojw_39",FE="_operate_14ojw_52",UE={main:$E,iframe:BE,divider:PE,logo:VE,dev:zE,operate:FE},HE={classes:UE},GE=U(AE,[["__cssModules",HE]]),vs=ei(GE);vs.use(uE);vs.mount("#app");
