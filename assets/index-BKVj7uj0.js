const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-COO2kQp2.js","assets/vue-C4hvfNT6.js","assets/component-L55ah7FP.css","assets/component-CWbnBpag.js","assets/utils-gqE_J1O5.js","assets/utils-CgjH-QUk.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var qo=Object.defineProperty;var cl=n=>{throw TypeError(n)};var Mo=(n,e,t)=>e in n?qo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>Mo(n,typeof e!="symbol"?e+"":e,t),In=(n,e,t)=>e.has(n)||cl("Cannot "+t);var Se=(n,e,t)=>(In(n,e,"read from private field"),t?t.call(n):e.get(n)),ze=(n,e,t)=>e.has(n)?cl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),ut=(n,e,t,l)=>(In(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),we=(n,e,t)=>(In(n,e,"access private method"),t);import{D as ye,E as yt,N as Gt,a as pt,b as Y,c as Ae,P as Hn,d as Xt,e as ul,f as dn,g as fn,O as jt,h as te,i as en,j as pn,L as Le,I as D,_ as V,k as Al,s as vn,l as Po,m as ae,n as Vo,B as Q,o as Bo,S as Gn,p as Wn,F as le,V as Ye,q as Yn,r as pe,t as Fo,u as Ke,U as qn,v as Xn,w as Je,x as mn,y as Qe,A as Pe,z as jn,C as Dl,G as $l,H as Ol,J as ve,K as ql,T as zo,M as Ve,Q as Et,R as Oe,W as Kt,X as et,Y as Uo,Z as Ho,$ as Go,a0 as Zn,a1 as Kn,a2 as Wo,a3 as on,a4 as kt,a5 as hn,a6 as ht,a7 as be,a8 as Yo,a9 as sn,aa as Ct,ab as gt,ac as tt,ad as Xo,ae as Tt,af as Nt,ag as jo,ah as Zo,ai as Ko,aj as Jo,ak as Qo,al as es,am as Ce,an as ke,ao as Mt,ap as dl,aq as ts,ar as fl,as as xn,at as An,au as ns,av as ls,aw as rn,ax as os,ay as ss,az as is,aA as rs,aB as pl,aC as as,aD as cs}from"./utils-gqE_J1O5.js";import{r as se,o as Jn,d as $,c as L,a as S,n as g,b as f,e as p,f as Me,u as Ie,s as ue,g as $e,h as N,w as oe,i as _,j as Z,k as z,T as Ml,l as K,m as St,p as Jt,q as Pl,F as X,t as ie,v as H,x as Pt,y as ml,z as Vl,A as Bl,B as _e,C as Ne,D as ne,E as ge,G as Vt,H as us,I as Fl,J as Qt,K as Qn,L as Dn,M as Ge,N as ot,O as ds,P as fs,Q as ps,R as ms}from"./vue-C4hvfNT6.js";const zl="@quickprint_drag_mode",Ul="@quickprint_drop_data",bn="@quickprint_operate",Xe="@quickprint_element",el="@quickprint_element_type",Hl="@quickprint_resize_flag",_t=160,yn=32,Ut=[50,75,100,125,150,200,300,400];var Wt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Wt||{}),Rt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Rt||{});const st={SINGLE:0,MULTIPLE:1},Re=Object.freeze({INSERT:0,MOVE:1}),tl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),U=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),fe=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Gl=[{label:"固定值",value:ye.CONST},{label:"变量",value:ye.VARIABLE},{label:"公式",value:ye.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:ye.CODE,detail:"使用Javascript代码生成数据"}],hs=[{label:"显示",value:yt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:yt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:yt.CONDITION,detail:"元素只在满足指定条件后显示"}],gs=[{label:"四舍五入",value:Gt.ROUND},{label:"向下舍入",value:Gt.FLOOR},{label:"向上舍入",value:Gt.CEIL},{label:"四舍六入",value:Gt.BANKER_ROUND}],vs=[{label:"原始值",value:pt.NONE},{label:"固定位数",value:pt.FIXED},{label:"金额千位",value:pt.THOUSAND},{label:"金额万位",value:pt.TEN_THOUSAND},{label:"金额大写",value:pt.DAXIE},{label:"百分比",value:pt.PERCENTAGE}],bs=[{label:"显示",value:!0},{label:"隐藏",value:!1}],ys=[{label:"默认",value:void 0},{label:"文本",value:Y.TEXT},{label:"数字",value:Y.NUMBER},{label:"日期",value:Y.DATE}],re={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Wl=[{label:"年-月",value:Ae.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:Ae.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:Ae.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:Ae.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:Ae.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:Ae.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:Ae.TIME,detail:"示例：12:00:00"},{label:"时:分",value:Ae.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:Ae.YEAR,detail:"示例：2024"},{label:"月",value:Ae.MONTH,detail:"示例：12"},{label:"日",value:Ae.DAY,detail:"示例：01"}];Wl.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const _s=[{label:"元素值",value:Hn.ELEMENT_VALUR}],Es=[{label:"基于纸张",value:Xt.PAPER},{label:"基于内容",value:Xt.CONTENT}],Yl=[{label:"纵向",value:ul.PORTRAIT},{label:"横向",value:ul.LANDSCAPE}],Ts=[{label:"当前位置",value:dn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:dn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Ss=[{label:"单次打印",value:fn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:fn.EACH,detail:"元素将每页打印一次"}],ws=[{label:"按内容调整高度",value:jt.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:jt.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:jt.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Mn=[{label:"页码",value:en.PAGE_NUMBER,type:te.NUMBER},{label:"总页数",value:en.PAGE_TOTAL,type:te.NUMBER},{label:"行序号",value:en.ROW_INDEX,type:te.NUMBER},{label:"当前时间",value:en.CURRENT_DATE,type:te.DATE}],ks=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function Xl(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Cs(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function jl(n){return n.isSelected?n.type===Y.PARAGRAPH?52:n.type===Y.TABLE?32:20:20}function Rs(){const n=se(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),Jn(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class Ls{constructor(e,t,l){B(this,"originalEvent");B(this,"target");B(this,"ghost");B(this,"container");B(this,"paths",[]);B(this,"dropTarget");B(this,"top",0);B(this,"left",0);B(this,"deltaX");B(this,"deltaY");B(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const s=t.getBoundingClientRect();this.deltaX=s.left-e.clientX,this.deltaY=s.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var Dt,$t,rt,Zl,Kl,Jl;const bt=class bt extends pn{constructor(t={}){var l,s,o;super();ze(this,rt);B(this,"context",null);B(this,"selector");B(this,"scale");B(this,"onDragStart");ze(this,Dt);ze(this,$t);this.selector={container:((l=t.selector)==null?void 0:l.container)??U.PAGE,element:((s=t.selector)==null?void 0:s.element)??U.DRAGGABLE,droppable:((o=t.selector)==null?void 0:o.droppable)??U.DROPPABLE},this.onDragStart=we(this,rt,Zl).bind(this),this.scale=t.scale,ut(this,Dt,we(this,rt,Kl).bind(this)),ut(this,$t,we(this,rt,Jl).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",Se(this,Dt)),window.removeEventListener("pointerup",Se(this,$t)),this.context=null)}};Dt=new WeakMap,$t=new WeakMap,rt=new WeakSet,Zl=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Le.warn(bt.TAG_NAME,"未找到的可拖拽元素");const s=this.selector.container,o=Xl(l,s);this.context=new Ls(t,l,o);const a=this.createEvent("before-dragstart",this.context);if(this.dispatch(a).defaultPrevented)return Le.warn(bt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Le.warn(bt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const r=this.createEvent("dragstart",this.context);if(this.dispatch(r).defaultPrevented)return Le.warn(bt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",Se(this,Dt)),window.addEventListener("pointerup",Se(this,$t))},Kl=function(t){const l=this.context;if(l==null)return;const s=l.container.getBoundingClientRect(),o=document.elementsFromPoint(t.clientX,t.clientY),a=Array.from(o).filter(i=>!(i===l.ghost||i===l.target||l.ghost.contains(i))),r=this.normalizeScale();l.originalEvent=t,l.paths=a,l.dropTarget=a.find(i=>i.matches("."+U.DROPPABLE)),l.top=(t.clientY+l.deltaY-s.top)/r,l.left=(t.clientX+l.deltaX-s.left)/r,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},Jl=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("dragend",l);this.dispatch(s).defaultPrevented||this.reset()},B(bt,"TAG_NAME","quickprint-draggable");let Pn=bt;const Ns=["title"],Is=$({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(S(),L("span",{title:n.title,class:g(e.classes.help)},[f("span",null,[Me(e.$slots,"default")]),p(D,{icon:"icon-question-circle"})],10,Ns))}}),xs="_help_1l6l8_2",As={help:xs},Ds={classes:As},$s=V(Is,[["__cssModules",Ds]]),Os=$({__name:"Popover",props:{width:{type:Number,default:null}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,s=t,o=Ie("classes"),a=se(!1),r=ue(),i=ue(),u=$e({minWidth:0,top:0,left:0,visible:!1}),d=N(()=>({minWidth:l.width==null?u.minWidth+"px":l.width+"px",top:u.top+"px",left:u.left+"px",visibility:u.visible?"visible":"hidden",zIndex:Al()}));async function m(){if(a.value)return h();a.value=!0,s("show"),await vn(),w()}function h(){x(),a.value=!1,s("close")}function E(R){if(!(R.target instanceof Node))return;const T=r.value;if(T&&T.contains(R.target))return R.preventDefault();const v=i.value;if(v&&v.contains(R.target))return R.preventDefault();h()}function b(){const R=r.value,T=i.value;if(T==null||R==null)return;const v=R.getBoundingClientRect(),k=T.getBoundingClientRect(),C=l.width==null?v.width:l.width;let I=v.bottom+1;I+k.height>window.innerHeight&&v.top>k.height&&(I=v.top-k.height-1);let q=v.left;q+k.width>window.innerWidth&&(q=window.innerWidth-k.width-2),u.minWidth=C,u.top=I,u.left=q,u.visible=!0}function c(R){const T=R.target;if(!(T instanceof HTMLElement))return;const v=r.value;v==null||!T.contains(v)||h()}function y(R){if(R.key!=="Escape")return;const T=i.value;if(T!=null){const v=T.style.zIndex;if(Number(v)<Po())return}R.preventDefault(),h()}function w(){window.addEventListener("click",E,{capture:!0}),window.addEventListener("contextmenu",h,{capture:!0}),window.addEventListener("scroll",c,{capture:!0,passive:!0}),window.addEventListener("resize",b),window.addEventListener("keydown",y)}function x(){window.removeEventListener("click",E,!0),window.removeEventListener("contextmenu",h,!0),window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",b),window.removeEventListener("keydown",y)}return e({close:h}),(R,T)=>(S(),L("div",{class:g(_(o).reference),onClick:oe(m,["stop"]),ref_key:"referenceRef",ref:r,tabindex:"0"},[Me(R.$slots,"default"),a.value?(S(),Z(Ml,{key:0,to:"body"},[f("div",{class:g(_(o).popover),onVnodeMounted:b,onMousedown:T[0]||(T[0]=oe(()=>{},["prevent"])),style:K(d.value),ref_key:"popoverRef",ref:i},[Me(R.$slots,"popover")],38)])):z("",!0)],2))}}),qs="_reference_1arli_2",Ms="_popover_1arli_7",Ps={reference:qs,popover:Ms},Vs={classes:Ps},Ql=V(Os,[["__cssModules",Vs]]),Bs=["title","onKeydown"],Fs=["onMouseover","onClick"],zs=$({__name:"Select",props:St({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:St(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,s=Ie("classes"),o=ue(),a=ue(),r=Jt(n,"modelValue"),i=se(),u=se(!1),d=$e({width:0,top:0,left:0,visible:!1,scrollable:!1}),m=N(()=>l.teleport==="none"),h=N(()=>l.teleport=="none"?"body":l.teleport),E=N(()=>{const A={label:"",options:[]},P=[A];for(const F of l.options){if(Array.isArray(F.options)){P.push({label:F.label,options:F.options});continue}A.options.push(F)}return P}),b=N(()=>E.value.reduce((A,P)=>A.concat(P.options),[])),c=N(()=>{if(l.multiple!==!0){const P=Ln();return P?P.label:l.button?l.title:ae(l.modelValue)?l.placeholder:l.modelValue}const A=Nn();return A.length>0?A.map(P=>P.label).join(","):l.button?l.title:l.placeholder}),y=N(()=>l.clearable!==!0?!1:l.modelValue!=null),w=N(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[s.mini]:l.size==="mini",[s.select]:!0,[s.appearance]:l.appearance!=="none"&&!y.value,[s.button]:l.button,[s.showClearIcon]:y.value,[s.text]:l.size==="text"})),x=N(()=>({width:l.width})),R=N(()=>d.visible?{width:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",top:d.top+"px",left:d.left+"px",visibility:"visible",zIndex:Al()}:{minWidth:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",visibility:"hidden"}),T=N(()=>({[s.content]:!0,[s.placeholder]:Vo(l.modelValue)}));async function v(){if(l.disabled)return;const A=b.value;if(A.length===0)return;if(u.value)return k();const P=o.value;P!=null&&(d.width=P.getBoundingClientRect().width,d.visible=!1,i.value=A.find(F=>F.value===l.modelValue),u.value=!0,await vn(),$o())}function k(){Oo(),u.value=!1}function C(A){G(),ct()}function I(A){A.disabled!==!0&&(i.value=A)}function q(A){if(l.disabled==!0||A.disabled===!0)return;if(l.multiple!==!0){r.value=A.value,t("select",A),k();return}const P=Array.isArray(r.value)?r.value:[],F=P.findIndex(de=>de===A.value);F>=0?P.splice(F,1):P.push(A.value),r.value=P,t("select",P)}function W(A){if(!(A.target instanceof Node))return;const P=o.value;if(P&&P.contains(A.target))return A.preventDefault();const F=a.value;if(F&&F.contains(A.target))return A.preventDefault();k()}async function G(){const A=o.value,P=a.value;if(P==null||A==null)return;await Pt();const F=A.getBoundingClientRect(),de=P.getBoundingClientRect();let he=F.bottom+1;he+de.height>window.innerHeight&&F.top>de.height&&(he=F.top-de.height-1);let wt=F.left;wt+de.width>window.innerWidth&&(wt=window.innerWidth-de.width-2),d.width=de.width,d.top=he,d.left=wt,d.visible=!0;const zt=P.querySelector("."+s.list);d.scrollable=zt?zt.scrollHeight>zt.clientHeight:!1}function O(A){const P=A.target;if(!(P instanceof HTMLElement))return;const F=o.value;F==null||!P.contains(F)||k()}function j(){const A=b.value,P=ml(i.value);if(P==null){i.value=Ft(0),ct();return}const F=A.indexOf(P);if(F==0)return me();const de=Ft(F-1);de!=null&&(i.value=de,ct())}function ee(){const A=b.value,P=ml(i.value);if(P==null){i.value=Fe(0),ct();return}const F=A.indexOf(P);if(F>=A.length-1){M();return}const de=Ft(F+1);de!=null&&(i.value=de,ct())}function M(){i.value=Fe(0),ct()}function me(){const A=b.value;i.value=Ft(A.length-1),ct()}function ce(){r.value=void 0,k()}function Fe(A){const F=b.value[A];return F==null?null:F.disabled===!0?Fe(A+1):F}function Ft(A){const F=b.value[A];return F==null?null:F.disabled===!0?Ft(A-1):F}function al(A){switch(A.key){case"Enter":A.preventDefault(),i.value&&q(i.value);return;case"Escape":A.preventDefault(),k();return;case"ArrowUp":A.preventDefault(),j();return;case"ArrowDown":A.preventDefault(),ee();return;case"Home":A.preventDefault(),M();return;case"End":A.preventDefault(),me();return}}function Ao(A){if(l.disabled)return;const P=o.value;P!=null&&document.activeElement===P&&(u.value||(A.stopPropagation(),v()))}function Do(A){if(l.multiple!==!0)return l.modelValue===A.value;const P=l.modelValue;return Array.isArray(P)?P.includes(A.value):!1}async function ct(){if(i.value==null)return;await Pt();const A=a.value;if(A==null)return;const P=A.querySelector("."+s.hover);P&&P.scrollIntoView({block:"nearest"})}function Ln(){const A=b.value,P=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return A.find(F=>F.value===P)}function Nn(){const A=b.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(F=>F).map(F=>{const de=A.find(he=>he.value===F);return de||{value:F,label:F}})}function $o(){window.addEventListener("mousedown",W,{capture:!0}),window.addEventListener("pointerdown",W,{capture:!0}),window.addEventListener("contextmenu",k,{capture:!0}),window.addEventListener("scroll",O,{capture:!0,passive:!0}),window.addEventListener("resize",G),window.addEventListener("keydown",al)}function Oo(){window.removeEventListener("mousedown",W,!0),window.removeEventListener("pointerdown",W,!0),window.removeEventListener("contextmenu",k,!0),window.removeEventListener("scroll",O,!0),window.removeEventListener("resize",G),window.removeEventListener("keydown",al)}return(A,P)=>{var F;return S(),L("div",{class:g(w.value),title:n.title,style:K(x.value),onClick:oe(v,["stop"]),onKeydown:Pl(oe(Ao,["prevent"]),["enter"]),ref_key:"selectRef",ref:o,tabindex:"0"},[A.$slots.selected?Me(A.$slots,"selected",{key:0,option:Ln(),options:Nn()}):Me(A.$slots,"option",{key:1,option:Ln(),options:Nn()},()=>[f("div",{class:g(T.value)},[f("span",null,H(c.value),1),y.value?(S(),Z(D,{key:0,icon:"icon-close",onClick:oe(ce,["stop"]),size:"12px",class:g(_(s).clearIcon)},null,8,["class"])):z("",!0)],2)]),u.value?(S(),Z(Ml,{key:2,to:h.value,disabled:m.value},[f("div",{class:g(_(s).popover),onClick:P[0]||(P[0]=oe(()=>{},["stop"])),onVnodeMounted:C,onMousedown:P[1]||(P[1]=oe(()=>{},["prevent"])),style:K(R.value),ref_key:"popoverRef",ref:a},[f("div",{class:g(_(s).list)},[(S(!0),L(X,null,ie(E.value,de=>(S(),L(X,null,[de.label?(S(),L("div",{key:0,class:g(_(s).groupLabel)},H(de.label),3)):z("",!0),(S(!0),L(X,null,ie(de.options,he=>{var wt;return S(),L("div",{key:he.value,class:g({[_(s).option]:!0,[_(s).disabled]:he.disabled===!0,[_(s).selected]:Do(he),[_(s).hover]:((wt=i.value)==null?void 0:wt.value)==he.value}),style:K(he.style),onMouseover:zt=>I(he),onClick:zt=>q(he)},[Me(A.$slots,"option",{option:he},()=>[f("div",{class:g(_(s).label)},[he.icon?(S(),Z(D,{key:0,icon:he.icon,class:g(_(s).icon)},null,8,["icon","class"])):z("",!0),f("span",null,H(he.label),1)],2),he.short?(S(),L("div",{key:0,class:g(_(s).short)},H(he.short),3)):z("",!0)])],46,Fs)}),128))],64))),256))],2),(F=i.value)!=null&&F.detail&&d.visible?(S(),L("div",{key:0,class:g(_(s).detail)},H(i.value.detail),3)):z("",!0)],38)],8,["to","disabled"])):z("",!0)],46,Bs)}}}),Us="_button_1h82x_2",Hs="_select_1h82x_7",Gs="_appearance_1h82x_16",Ws="_content_1h82x_31",Ys="_placeholder_1h82x_37",Xs="_popover_1h82x_41",js="_list_1h82x_51",Zs="_option_1h82x_80",Ks="_label_1h82x_95",Js="_icon_1h82x_100",Qs="_hover_1h82x_104",ei="_detail_1h82x_115",ti="_short_1h82x_125",ni="_selected_1h82x_131",li="_disabled_1h82x_135",oi="_showClearIcon_1h82x_140",si="_clearIcon_1h82x_144",ii="_text_1h82x_157",ri="_mini_1h82x_169",ai="_groupLabel_1h82x_181",ci={button:Us,select:Hs,appearance:Gs,content:Ws,placeholder:Ys,popover:Xs,list:js,option:Zs,label:Ks,icon:Js,hover:Qs,detail:ei,short:ti,selected:ni,disabled:li,showClearIcon:oi,clearIcon:si,text:ii,mini:ri,groupLabel:ai},ui={classes:ci},J=V(zs,[["__cssModules",ui]]),di="_tree_1p28f_1",fi="_node_1p28f_5",pi="_content_1p28f_11",mi="_space_1p28f_27",hi="_expand_1p28f_28",gi="_active_1p28f_47",vi="_children_1p28f_55",je={tree:di,node:fi,content:pi,space:mi,expand:hi,active:gi,children:vi},eo=Symbol(),to=$({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Vl(eo),l=N(()=>Array.isArray(n.node.children)&&n.node.children.length>0),s=N({get(){const c=t==null?void 0:t.state[n.node.value];return c==null?!1:c.expand},set(c){const y=t==null?void 0:t.state[n.node.value];y!=null&&(y.expand=c)}});function o(c){c.preventDefault(),s.value=!s.value}function a(){if(!l.value)return p("div",{class:je.space},null);const c={[je.expand]:!0,[je.active]:s.value};return p("div",{onMousedown:b,onClick:o,class:c},[p(D,{icon:"icon-right",size:"12px"},null)])}function r(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function i(){return p("div",{class:je.content,onClick:d,onMouseenter:h},[r()])}function u(){if(!l.value||!s.value)return;const c=n.node.children.map(y=>p(to,{node:y,onNodeClick:m,onNodeHover:E},null));return p("div",{class:je.children},[c])}function d(){e("nodeClick",n.node)}function m(c){e("nodeClick",c)}function h(){e("nodeHover",n.node)}function E(c){e("nodeHover",c)}function b(c){c.preventDefault()}return function(){return p("div",{class:je.subTree},[p("div",{class:je.node},[a(),i()]),u()])}}}),bi=$({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=a();function s(i){t("nodeClick",i)}function o(i){t("nodeHover",i)}function a(){const i=$e({}),u=function(d,m){for(const h of d)m[h.value]={expand:h.expand!==!1},h.children&&u(h.children,m)};return u(n.data,i),i}function r(i){return typeof e.default=="function"?e.default(i):null}return Bl(eo,{state:l,content:r}),function(){const i=n.data.map(u=>p(to,{node:u,onNodeClick:s,onNodeHover:o},null));return p("div",{class:je.tree},[i])}}});function yi(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function _i(n,e=0){let t=0,l=null;return function(...s){const o=Date.now();if(o-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,s),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,s),t=o}}function nl(n,e){const t=[];if(e&&e!=le.DEFAULT&&t.push(`"${e}"`),n&&n!==le.DEFAULT&&t.push(`"${n}"`),t.length!=0)return t.join(",")}function no(n){if(n.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:n.underlineStyle,textDecorationColor:n.underlineColor}}function lo(n,e={}){const t={},l=n.style??{},s=nl(l.fontFamily,l.enFontFamily);s&&(t.fontFamily=s);const o=no(l);return o&&Ke(t,o),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),Ti("border",e)&&l.border&&Ke(t,Vn(n)),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.padding&&Ke(t,wi(n)),Ke(t,Si(n)),Ke(t,oo(l.verticalAlign)),t}function Ei(n,e={}){const t=[];let l=n;for(;pe.isDefineElement(l);)t.unshift(lo(l,e)),l=l.parent;return Fo({},...t)}function Ti(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}function Si(n){if(n==null)return{};const e=n.style??{},t={};return e.textAlign&&(t.textAlign=e.textAlign),e.textAlignLast&&(t.textAlignLast=e.textAlignLast),t}function oo(n){return n==null||n==Ye.MIDDLE?{display:"flex",alignItems:"center"}:n==Ye.BOTTOM?{display:"flex",alignItems:"end"}:{}}function wi(n){if(n==null)return{};const e=n.style??{};if(e.padding==null)return{};const t={};return e.padding.top&&(t.paddingTop=e.padding.top),e.padding.right&&(t.paddingRight=e.padding.right),e.padding.bottom&&(t.paddingBottom=e.padding.bottom),e.padding.left&&(t.paddingLeft=e.padding.left),t}function Vn(n){if(n==null)return{};const e=n.style??{};if(e.border==null||e.border===Q.NONE)return{};const t={},l=e.borderWidth??1,s=e.borderStyle??Bo.SOLID,o=e.borderColor??Gn.BLACK;if(e.border==Q.ALL||e.border&Q.TOP){const a=e.borderTopWidth??l,r=e.borderTopStyle??s,i=e.borderTopColor??o;t.borderTop=`${a}px ${r} ${i}`}if(e.border==Q.ALL||e.border&Q.RIGHT){const a=e.borderRightWidth??l,r=e.borderRightStyle??s,i=e.borderRightColor??o;t.borderRight=`${a}px ${r} ${i}`}if(e.border==Q.ALL||e.border&Q.BOTTOM){const a=e.borderBottomWidth??l,r=e.borderBottomStyle??s,i=e.borderBottomColor??o;t.borderBottom=`${a}px ${r} ${i}`}if(e.border==Q.ALL||e.border&Q.LEFT){const a=e.borderLeftWidth??l,r=e.borderLeftStyle??s,i=e.borderLeftColor??o;t.borderLeft=`${a}px ${r} ${i}`}return t}const vt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(vt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(vt.SPACE).filter(s=>Wn(s));return t.indexOf(e)>=0?n:(t.push(e),t.join(vt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(vt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(vt.SPACE))}};function We(n){if(ae(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=Yn(t)?t:null,s=ae(e[2])?null:e[2];return{num:l,unit:s}}function hl(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=We(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return qn.pt_to_px(e.num);case"mm":return qn.mm_to_px(e.num);default:return null}}function ll(n,e){const t=n.ds;if(t!=null)return t.type===ye.FORMULA?{type:t.type,content:ol(t.value,n.doc)}:t.type===ye.VARIABLE?{type:t.type,content:it(t.value,e)}:{type:t.type,content:t.value}}function it(n,e){var h,E,b;if(ae(n))return n;const t=Xn(n),l=t.path;if(l==null||l=="")return;const s=l.split(".");if(s.length==0)return l;const o=s[0];if(t.varType===Je.BUILTIN)return((h=Mn.find(c=>c.value===o))==null?void 0:h.label)??o;if(t.varType===Je.SPECIAL)return((E=_s.find(c=>c.value===o))==null?void 0:E.label)??o;if(e==null)return l;const r=(e.fields??[]).find(c=>c.name===o);if(r==null)return l;const i=s[1],u=ae(r.title)?r.name:r.title;if(i==null)return u;const d=(b=r.children)==null?void 0:b.find(c=>c.name===i);if(d==null)return`${u}.${i}`;const m=ae(d.title)?d.name:d.title;return`${u}.${m}`}function ol(n,e){return ae(n)?void 0:mn.tokenize(n).map(s=>s.type===Qe.VARIABLE?`[${it(s.value,e==null?void 0:e.ds)}]`:s.type===Qe.REFERENCE?`[${so(s.value,e)}]`:s.type===Qe.TEMPLATE?(Array.isArray(s.value)?s.value:[s.value]).map(a=>a.type===Qe.VARIABLE?`[${it(a.value,e==null?void 0:e.ds)}]`:a.value).join(""):mn.formatTokenValue(s)).join("")}function so(n,e){if(e){const t=e.findElement(n);if(t&&t.title)return"="+t.title}return"="+n}function ki(n){switch(Xn(n).dataType){case te.OBJECT:return"对象";case te.ARRAY:return"数组";case te.STRING:return"文本";case te.NUMBER:return"数字";case te.DATE:return"日期";case te.BOOLEAN:return"布尔";default:return"未知类型"}}function Ci(n){var e;return((e=Gl.find(t=>t.value===n))==null?void 0:e.label)??n}const Ri=["onClick"],Li=$({__name:"WindowHeader",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=Pe(),l=e;function s(o){l("update:modelValue",o.value)}return(o,a)=>(S(),L("div",{class:g(o.classes.header)},[f("div",{class:g(o.classes.headerLeft)},[Me(o.$slots,"prefix"),f("div",{class:g(o.classes.tabs)},[(S(!0),L(X,null,ie(n.tabs,r=>(S(),L("div",{key:r.value,class:g({[o.classes.tab]:!0,[o.classes.active]:n.modelValue===r.value}),onClick:i=>s(r),onPointerdown:a[0]||(a[0]=oe(()=>{},["stop","prevent"]))},[f("span",null,H(r.label),1)],42,Ri))),128))],2)],2),_(t)?(S(),Z(_(jn),{key:0,instance:_(t)},null,8,["instance"])):z("",!0)],2))}}),Ni="_header_1o09p_2",Ii="_headerLeft_1o09p_14",xi="_tabs_1o09p_27",Ai="_tab_1o09p_27",Di="_active_1o09p_69",$i={header:Ni,headerLeft:Ii,tabs:xi,tab:Ai,active:Di},Oi={classes:$i},io=V(Li,[["__cssModules",Oi]]),ro=Dl(()=>$l(()=>import("./component-COO2kQp2.js"),__vite__mapDeps([0,1,2]))),qi=["onClick","onMouseenter"],Mi=$({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=se(Mn[0].value),s=N(()=>`builtin_${Ol(l.value,"_").toLowerCase()}`);function o(r){t("select",r)}function a(r){l.value=r.value}return(r,i)=>(S(),L("div",{class:g(r.classes.builtin)},[f("div",{class:g(["quickprint-is-scrollable",r.classes.panel])},[(S(!0),L(X,null,ie(_(Mn),u=>(S(),L("div",{class:g({[r.classes.param]:!0,[r.classes.active]:u.value===l.value}),onClick:d=>o(u),onMouseenter:d=>a(u)},[f("strong",null,H(u.label),1),f("span",null,H(u.value),1)],42,qi))),256))],2),f("div",{class:g(["quickprint-is-scrollable",r.classes.desc])},[p(_(ro),{name:s.value},null,8,["name"])],2)],2))}}),Pi="_builtin_m1n0z_2",Vi="_panel_m1n0z_11",Bi="_desc_m1n0z_17",Fi="_param_m1n0z_24",zi="_active_m1n0z_34",Ui={builtin:Pi,panel:Vi,desc:Bi,param:Fi,active:zi},Hi={classes:Ui},Gi=V(Mi,[["__cssModules",Hi]]),gl=[{label:"文本",value:te.STRING},{label:"数字",value:te.NUMBER},{label:"日期",value:te.DATE},{label:"对象",value:te.OBJECT},{label:"数组",value:te.ARRAY}],Wi=$({emit:["select"],props:{doc:{type:ve,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Ie("classes"),s=Pe(),o=i(),a=r();function r(){const y=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(w,x,R){var T;if(n.readonly){const v=w[x.name],k=((T=gl.find(C=>C.value===v))==null?void 0:T.label)??v;return p("div",{class:R.classes.cell},[k])}return p("div",{class:R.classes.cell},[p(J,{options:gl,modelValue:w.type,"onUpdate:modelValue":E.bind(null,w),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(w,x,R){return n.readonly?p("div",{class:R.classes.cell},[w[x.name]]):p("div",{class:R.classes.cell},[_e(p("input",{"onUpdate:modelValue":T=>w.name=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Ne,w.name]])])}},{name:"title",title:"标题",width:180,render(w,x,R){return n.readonly?p("div",{class:R.classes.cell},[w[x.name]]):p("div",{class:R.classes.cell},[_e(p("input",{"onUpdate:modelValue":T=>w.title=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Ne,w.title]])])}}];return n.readonly!==!0&&y.push({name:"operate",title:"操作",width:200,render(w,x,R){const T=[p("button",{type:"button",class:"quickprint-text-btn",onClick:d.bind(null,w,R.parent)},[p(D,{icon:"icon-subnode"},null),p("span",null,[ne("插入行")])])];return(w.type===te.ARRAY||w.type===te.OBJECT)&&T.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:h.bind(null,w)},[p(D,{icon:"icon-sisternode"},null),p("span",null,[ne("插入子级")])])),T.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:m.bind(null,w,R.parent)},[p(D,{icon:"icon-delete"},null),p("span",null,[ne("删除")])])),T}}),y}function i(){const y=ql(n.doc.ds.fields??[]).map(x=>{const R=x.type;return{...x,$expand:R===te.ARRAY||R===te.OBJECT}}),w=se(y);return w.value.length==0&&w.value.push(u()),w}function u(){return{type:te.STRING,name:"",title:""}}function d(y,w){if(w){const R=w.children??[],T=R.indexOf(y);T>=0&&R.splice(T+1,0,u());return}const x=o.value.indexOf(y);x>=0&&o.value.splice(x+1,0,u())}function m(y,w){if(w){const R=w.children??[],T=R.indexOf(y);T>=0&&R.splice(T,1);return}const x=o.value.indexOf(y);x>=0&&o.value.splice(x,1),o.value.length==0&&o.value.push(u())}function h(y){y.type!==te.ARRAY&&y.type!==te.OBJECT||(y.children==null&&(y.children=[]),y.children.push(u()))}function E(y,w){y.type=w,w===te.ARRAY||w===te.OBJECT?y.$expand=!0:y.children=void 0}function b(){return{fields:o.value.map(w=>ae(w.name)?null:w.type!==te.ARRAY&&w.type!==te.OBJECT?{type:w.type,name:w.name,title:w.title}:{type:w.type,name:w.name,title:w.title,children:(w.children??[]).map(x=>ae(w.name)?null:{type:x.type,name:x.name,title:x.title}).filter(x=>x!=null)}).filter(w=>w!=null)}}function c(y,w){n.readonly===!0&&t("select",y,w)}return s==null||s.useHandle("confirm",b),e({submit:b}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(zo,{columns:a,data:o.value,onSelect:c},null)])}}}),Yi="_form_6lybl_2",Xi="_readonly_6lybl_6",ji="_datasource_6lybl_11",Zi={form:Yi,readonly:Xi,datasource:ji},Ki={classes:Zi},ao=V(Wi,[["__cssModules",Ki]]),Ji={class:"quickprint-config-group"},Qi={class:"quickprint-config-section quickprint-config-inline"},er={class:"quickprint-config-content"},tr={class:"quickprint-config-section quickprint-config-inline"},nr={class:"quickprint-config-content"},lr={class:"quickprint-config-id"},or={class:"quickprint-config-section quickprint-config-inline"},sr={class:"quickprint-config-content"},ir={class:"quickprint-config-group"},rr={class:"quickprint-config-group-title"},ar=$({__name:"Detail",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N(()=>{var l,s;return(s=ll(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:s.content});return(l,s)=>(S(),L("div",{class:g(l.classes.detail)},[f("div",Ji,[f("section",Qi,[s[0]||(s[0]=f("header",{class:"quickprint-config-header"},"类型",-1)),f("div",er,H(_(Zt)(n.element.type)),1)]),f("section",tr,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"标识",-1)),f("div",nr,[f("span",lr,H(n.element.id),1)])]),f("section",or,[s[2]||(s[2]=f("header",{class:"quickprint-config-header"},"标题",-1)),f("div",sr,H(n.element.title),1)])]),f("div",ir,[f("div",rr,[s[3]||(s[3]=f("span",null,"数据",-1)),f("span",{class:g(l.classes.type)},H(_(Ci)(n.element.ds.type)),3)]),f("div",null,H(t.value),1)])],2))}}),cr="_detail_11ox4_2",ur="_type_11ox4_10",dr={detail:cr,type:ur},fr={classes:dr},pr=V(ar,[["__cssModules",fr]]),mr=$({__name:"index",props:{doc:{type:ve,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,s=r(),o=se();function a(h){return h.reduce((E,b)=>{const c=Array.isArray(b.children)?a(b.children):[];if(Wn(b.ds.value)||c.length>0){const y={value:b.id,label:b.title??b.id,data:b,children:c};return E.push(y),E}return E},[])}function r(){const h=l.doc.pages.reduce((b,c)=>b.concat(c.children),[]),E=a(h);return se(E)}function i(h){o.value=h}function u(h){return h.title?h.title:Zt(h.type)}function d(h){return Fu(h.type)??"icon-zhanweifu"}function m(h){t("select",h.data)}return(h,E)=>(S(),L("div",{class:g(h.classes.reference)},[f("div",{class:g([h.classes.panel,"quickprint-is-scrollable"])},[p(_(bi),{data:_(s),onNodeHover:i,onNodeClick:m},{default:ge(({node:b})=>[p(_(D),{icon:d(b.data)},null,8,["icon"]),f("span",{class:g(h.classes.title)},H(u(b.data)),3),f("span",{class:g(h.classes.id)},"<"+H(b.value)+">",3)]),_:1},8,["data"])],2),f("div",{class:g([h.classes.detail,"quickprint-is-scrollable"])},[o.value?(S(),Z(pr,{element:o.value.data,key:o.value.value},null,8,["element"])):z("",!0)],2)],2))}}),hr="_reference_1ekkx_2",gr="_panel_1ekkx_12",vr="_detail_1ekkx_20",br="_title_1ekkx_25",yr="_id_1ekkx_29",_r={reference:hr,panel:gr,detail:vr,title:br,id:yr},Er={classes:_r},Tr=V(mr,[["__cssModules",Er]]),Sr=$({__name:"index",props:{doc:{type:ve,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}}},setup(n){const e=n,t=[{label:"数据源",value:"ds"},{label:"内置变量",value:"builtin"},{label:"引用组件",value:"reference"}],l=Pe(),s=se(d()),o=N(()=>t.filter(m=>e.include.includes(m.value)));function a(m,h){return m==null?null:h==null?`${Je.DS}.${m.type}.${m.name}`:`${Je.DS}.${m.type}.${h.name}.${m.name}`}function r(m,h){l==null||l.confirm({type:"ds",value:a(m,h),parent:h})}function i(m){l==null||l.confirm({type:"builtin",value:`${Je.BUILTIN}.${m.type}.${m.value}`})}function u(m){l==null||l.confirm({type:"reference",value:m.id})}function d(){const m=e.value;return m==null||m==""?"ds":Xn(m).varType===Je.BUILTIN?"builtin":"ds"}return(m,h)=>(S(),L("div",{class:g(m.classes.var)},[p(io,{modelValue:s.value,"onUpdate:modelValue":h[0]||(h[0]=E=>s.value=E),tabs:o.value},{prefix:ge(()=>[p(_(D),{icon:"icon-var",size:"16px"}),f("span",{class:g(m.classes.title)},"变量",2)]),_:1},8,["modelValue","tabs"]),s.value==="ds"?(S(),Z(ao,{key:0,doc:n.doc,onSelect:r,readonly:""},null,8,["doc"])):z("",!0),s.value==="builtin"?(S(),Z(Gi,{key:1,onSelect:i})):z("",!0),s.value==="reference"?(S(),Z(Tr,{key:2,doc:n.doc,onSelect:u},null,8,["doc"])):z("",!0)],2))}}),wr="_title_xcig2_10",kr={var:"_var_xcig2_2",title:wr},Cr={classes:kr},co=V(Sr,[["__cssModules",Cr]]),Rr=["onClick","onMouseenter"],Lr=$({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var i;const t=n,l=e,s=se((i=t.options[0])==null?void 0:i.value),o=N(()=>`${t.type}_${s.value.toLowerCase()}`);function a(u){l("select",u.value)}function r(u){s.value=u.value}return(u,d)=>(S(),L("div",{class:g(u.classes.doc)},[f("div",{class:g(["quickprint-is-scrollable",u.classes.panel])},[(S(!0),L(X,null,ie(n.options,m=>(S(),L("div",{key:m.value,class:g({[u.classes.option]:!0,[u.classes.active]:m.value===s.value}),onClick:h=>a(m),onMouseenter:h=>r(m)},[f("strong",null,H(m.label),1)],42,Rr))),128))],2),f("div",{class:g(["quickprint-is-scrollable",u.classes.desc])},[p(_(ro),{name:o.value},null,8,["name"])],2)],2))}}),Nr="_doc_1pdoc_2",Ir="_panel_1pdoc_10",xr="_desc_1pdoc_16",Ar="_option_1pdoc_23",Dr="_active_1pdoc_33",$r={doc:Nr,panel:Ir,desc:xr,option:Ar,active:Dr},Or={classes:$r},Ht=V(Lr,[["__cssModules",Or]]),qr=$({__name:"index",setup(n){const e=Pe(),t=se("string"),l=[{label:"文本",value:"string"},{label:"数字",value:"number"},{label:"日期",value:"date"},{label:"逻辑",value:"logical"},{label:"聚合",value:"aggregate"}],s=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],o=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"}],a=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],r=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],i=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function u(d){return e==null?void 0:e.confirm({type:"function",value:`${d}()`})}return(d,m)=>(S(),L("div",{class:g(d.classes.function)},[p(io,{modelValue:t.value,"onUpdate:modelValue":m[0]||(m[0]=h=>t.value=h),tabs:l},{prefix:ge(()=>[p(_(D),{icon:"icon-function",size:"16px"}),f("span",{class:g(d.classes.title)},"函数",2)]),_:1},8,["modelValue"]),t.value==="string"?(S(),Z(Ht,{options:s,onSelect:u,key:"string"})):z("",!0),t.value==="number"?(S(),Z(Ht,{options:o,onSelect:u,key:"number"})):z("",!0),t.value==="logical"?(S(),Z(Ht,{options:a,onSelect:u,key:"logical"})):z("",!0),t.value==="date"?(S(),Z(Ht,{options:r,onSelect:u,key:"date"})):z("",!0),t.value==="aggregate"?(S(),Z(Ht,{options:i,onSelect:u,key:"aggregate"})):z("",!0)],2))}}),Mr="_title_1bezq_11",Pr={function:"_function_1bezq_2",title:Mr},Vr={classes:Pr},Br=V(qr,[["__cssModules",Vr]]),Fr=["onMouseenter"],zr=["onClick"],Ur={key:1},Hr=$({__name:"Formula",props:{doc:{type:ve,default:null}},setup(n){const e=n,t=Pe(),l=[{id:"pageNumber",name:"页码",options:i(ks)}],s=se(l[0]);function o(u){s.value=u}function a(u){return t==null?void 0:t.confirm({type:"formula",value:u})}function r(u){const d=mn.tokenize(u),m=e.doc;return d.reduce((h,E)=>{if(E.type===Qe.VARIABLE)return h.push({type:"highlight",value:it(E.value,m==null?void 0:m.ds)}),h;if(E.type===Qe.REFERENCE)return h.push({type:"highlight",value:so(E.value,m)}),h;if(E.type===Qe.TEMPLATE){const c=(Array.isArray(E.value)?E.value:[E.value]).map(y=>y.type===Qe.VARIABLE?{type:"highlight",value:it(y.value,m.ds)}:{type:"text",value:y.value});return h.concat(c)}return h.push({type:"text",value:mn.formatTokenValue(E)}),h},[])}function i(u){return u.map(d=>({nodes:r(d),value:d}))}return(u,d)=>(S(),L("div",{class:g(u.classes.formula)},[f("div",{class:g([u.classes.left,"quickprint-is-scrollable"])},[(S(),L(X,null,ie(l,m=>f("div",{key:m.name,onMouseenter:h=>o(m),class:g({[u.classes.group]:!0,[u.classes.active]:m.id===s.value.id})},H(m.name),43,Fr)),64))],2),f("div",{class:g(u.classes.right)},[(S(!0),L(X,null,ie(s.value.options,(m,h)=>(S(),L("div",{key:h,class:g(u.classes.code),onClick:E=>a(m.value)},[(S(!0),L(X,null,ie(m.nodes,E=>(S(),L(X,null,[E.type==="highlight"?(S(),L("span",{key:0,class:g(u.classes.highlight)},"["+H(E.value)+"]",3)):(S(),L("span",Ur,H(E.value),1))],64))),256)),f("span",{class:g(u.classes.badge)},"插入",2)],10,zr))),128))],2)],2))}}),Gr="_formula_ms7c3_2",Wr="_left_ms7c3_12",Yr="_right_ms7c3_17",Xr="_group_ms7c3_24",jr="_active_ms7c3_34",Zr="_highlight_ms7c3_39",Kr="_code_ms7c3_43",Jr="_badge_ms7c3_65",Qr={formula:Gr,left:Wr,right:Yr,group:Xr,active:jr,highlight:Zr,code:Kr,badge:Jr},ea={classes:Qr},ta=V(Hr,[["__cssModules",ea]]),sl=Ve(function(n){return Kt("变量",p(co,{doc:n.doc,value:n.value},null),{preset:"variable"}).promisify().catch(Oe)}),na=Ve(function(n){return Et("数据源",p(ao,{doc:n},null),{preset:"variable",icon:p(D,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Oe)}),la=Ve(function(n){const e=["ds","builtin","reference"];return Kt("变量",p(co,{doc:n.doc,value:n.value,include:e},null),{preset:"variable"}).promisify().catch(Oe)}),oa=Ve(function(){return Kt("函数",p(Br,null,null),{preset:"variable"}).promisify().catch(Oe)}),sa=Ve(function(n){return Et("公式",p(ta,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Oe)}),ia={key:1},ra=$({__name:"Content",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Ee(),l=Vt("editorRef"),s=Vt("contentRef"),o=se(!1),a=N(()=>{const d=e.element.type===Y.TABLE_CELL?Ei(e.element,{exclude:["border"]}):lo(e.element);return d.color&&(d["--quickprint-element-var-color"]=d.color),o.value&&(d.alignItems="flex-start"),d}),r=N(()=>{const d=ll(e.element,t.doc.ds);return d==null||d.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:d.type===ye.CONST?"span":"strong",content:d.content},{tag:"span",content:e.element.attributes.suffix}]});async function i(){var E;const d=await sl({doc:t.doc,value:e.element.ds.value}).catch(et);if(d==null||(e.element.setDataSource(ye.VARIABLE,d.value),e.element.type!=Y.TABLE_CELL||d.type!=="ds"))return;const m=e.element.parent;if(m==null||m.isBindVariable||((E=d.parent)==null?void 0:E.type)!==te.ARRAY)return;const h=d.parent;m.setDataSource(ye.VARIABLE,`${Je.DS}.${h.type}.${h.name}`)}function u(){const d=l.value,m=s.value;d==null||m==null||(o.value=m.offsetHeight>d.offsetHeight)}return(d,m)=>(S(),L("div",{class:"quickprint-is-element-editor",style:K(a.value),onVnodeMounted:u,ref_key:"editorRef",ref:l},[f("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:s},[f("span",{class:g({[d.classes.lineThrough]:n.element.style.lineThrough})},[(S(!0),L(X,null,ie(r.value,(h,E)=>(S(),L(X,{key:E},[h.tag=="strong"?(S(),L("strong",{key:0,class:g(d.classes.highlight)},"["+H(h.content)+"]",3)):(S(),L("span",ia,H(h.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(S(),Z(_(D),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:g(d.classes.dsIcon),onClick:i,onPointerdown:m[0]||(m[0]=oe(()=>{},["stop"]))},null,8,["class"])):z("",!0)],4))}}),aa="_dsIcon_ss96n_2",ca="_lineThrough_ss96n_10",ua="_highlight_ss96n_14",da={dsIcon:aa,lineThrough:ca,highlight:ua},fa={classes:da},_n=V(ra,[["__cssModules",fa]]),pa=$({__name:"TextEditor",props:{element:{type:Uo,required:!0}},setup(n){return(e,t)=>(S(),Z(_n,{element:n.element},null,8,["element"]))}}),En=Object.freeze({title:"文本",icon:"icon-text",type:Y.TEXT,editor:pa,onCreate(){return pe.create({type:Y.TEXT,width:_t,height:yn})}}),ma=$({__name:"NumberEditor",props:{element:{type:Ho,required:!0}},setup(n){return(e,t)=>(S(),Z(_n,{element:n.element},null,8,["element"]))}}),ha=["value","disabled"],ga=$({__name:"RadioButton",props:St({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=Jt(n,"modelValue");return(t,l)=>(S(),L("div",{class:g({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(S(!0),L(X,null,ie(n.options,s=>(S(),L("label",{class:g({[t.classes.radio]:!0,[t.classes.selected]:s.value===n.modelValue})},[_e(f("input",{type:"radio",value:s.value,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value=o),disabled:n.disabled},null,8,ha),[[us,e.value]]),f("span",null,H(s.label),1)],2))),256))],2))}}),va="_radioGroup_67myk_2",ba="_compacted_67myk_10",ya="_radio_67myk_2",_a="_selected_67myk_50",Ea="_disabled_67myk_56",Ta={radioGroup:va,compacted:ba,radio:ya,selected:_a,disabled:Ea},Sa={classes:Ta},It=V(ga,[["__cssModules",Sa]]),wa={class:"quickprint-config-section quickprint-config-inline"},ka={class:"quickprint-config-content"},Ca={class:"quickprint-config-section quickprint-config-inline"},Ra={class:"quickprint-config-content"},La={class:"quickprint-config-section quickprint-config-inline"},Na={class:"quickprint-config-content"},Ia={class:"quickprint-config-section quickprint-config-inline"},xa={class:"quickprint-config-content"},Aa=$({__name:"NumberConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N({get(){return e.element.attributes.showZero??!0},set(o){const a=e.element.attributes;a.showZero=o}}),l=N({get(){return e.element.attributes.round??Gt.ROUND},set(o){const a=e.element.attributes;a.round=o}}),s=N({get(){return e.element.attributes.format??pt.NONE},set(o){const a=e.element.attributes;a.format=o}});return(o,a)=>(S(),L(X,null,[f("section",wa,[a[4]||(a[4]=f("header",{class:"quickprint-config-header"},"小数位数",-1)),f("div",ka,[_e(f("input",{"onUpdate:modelValue":a[0]||(a[0]=r=>n.element.attributes.precision=r),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ne,n.element.attributes.precision]])])]),f("section",Ca,[a[5]||(a[5]=f("header",{class:"quickprint-config-header"},"舍入规则",-1)),f("div",Ra,[p(_(J),{options:_(gs),modelValue:l.value,"onUpdate:modelValue":a[1]||(a[1]=r=>l.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",La,[a[6]||(a[6]=f("header",{class:"quickprint-config-header"},"显示类型",-1)),f("div",Na,[p(_(J),{options:_(vs),modelValue:s.value,"onUpdate:modelValue":a[2]||(a[2]=r=>s.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",Ia,[a[7]||(a[7]=f("header",{class:"quickprint-config-header"},"值为0时",-1)),f("div",xa,[p(It,{modelValue:t.value,"onUpdate:modelValue":a[3]||(a[3]=r=>t.value=r),options:_(bs),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),Tn=Object.freeze({title:"数字",type:Y.NUMBER,icon:"icon-number",editor:ma,config:{display:Aa},onCreate(){return pe.create({type:Y.NUMBER,width:_t,height:yn})}}),Da=$({__name:"DateEditor",props:{element:{type:Go,required:!0}},setup(n){return(e,t)=>(S(),Z(_n,{element:n.element},null,8,["element"]))}}),$a={class:"quickprint-config-section"},Oa={class:"quickprint-config-content"},qa=$({__name:"DateConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=N(()=>[{label:"原始值",value:t.NONE},...Wl]);function s(o){if(o.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=o.value}return(o,a)=>(S(),L("section",$a,[f("header",{class:g(["quickprint-config-header",o.classes.header])},[a[1]||(a[1]=f("span",null,"格式",-1)),p(_(J),{options:l.value,onSelect:s,class:g(o.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:ge(()=>[f("span",{class:g(o.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),f("div",Oa,[_e(f("input",{type:"text","onUpdate:modelValue":a[0]||(a[0]=r=>n.element.attributes.format=r),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ne,n.element.attributes.format]])])]))}}),Ma="_header_79607_2",Pa="_picker_79607_8",Va="_placeholder_79607_15",Ba={header:Ma,picker:Pa,placeholder:Va},Fa={classes:Ba},za=V(qa,[["__cssModules",Fa]]),Sn=Object.freeze({title:"日期",type:Y.DATE,icon:"icon-date",editor:Da,config:{display:za},onCreate(){return pe.create({type:Y.DATE,width:_t,height:yn})}}),Ua=["colspan","rowspan"],Ha=$({__name:"TableCellEditor",props:{element:{type:Zn,required:!0}},setup(n){const e=n,t=N(()=>e.element.attributes.colspan===0||e.element.attributes.rowspan===0),l=Ee(),s=Ie("classes"),o=N(()=>{var i;return{[s.cell]:!0,[U.SELECTED]:(i=e.element.state)==null?void 0:i.selected}}),a=N(()=>{var d;const i=Vn((d=e.element.parent)==null?void 0:d.parent),u=Vn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Ke(i,u)}});function r(i){i.button==0&&l.selectElement(e.element)}return(i,u)=>t.value?z("",!0):(S(),L("td",Fl({key:0,[`.${_(Xe)||""}`]:n.element,class:o.value,style:a.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:oe(r,["stop"])}),[p(_n,{element:n.element,class:g(_(s).content)},null,8,["element","class"])],48,Ua))}}),Ga="_cell_rp1x6_2",Wa="_content_rp1x6_31",Ya={cell:Ga,content:Wa},Xa={classes:Ya},uo=V(Ha,[["__cssModules",Xa]]);function fo(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}function ja(n,e){const t=e.getSelected(),l={menus:[{type:"menu",label:"选中表格",icon:"icon-aim",handler:e.selectTable}]};return t.length>=2&&l.menus.push({type:"menu",label:"合并",icon:"icon-merge-cells",handler:e.mergeCells}),t.some(s=>s.hasColSpan||s.hasRowSpan)&&l.menus.push({type:"menu",label:"拆分",icon:"icon-solit-cells",handler:e.splitCells}),l.menus.push({type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",handler:e.insertColumnLeft},{type:"menu",label:"右侧插入列",handler:e.insertColumnRight},{type:"menu",label:"上侧插入行",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",handler:e.inserRowBottom}]},{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:e.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:e.avgTableWidth},{type:"menu",label:"均分表格高度",handler:e.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:e.setOtherRowSameHeight,disabled(){return e.toArea(t).rowSpan!==1}},{type:"menu",label:"将其他列设为相同宽度",handler:e.setOtherColSameWidth,disabled(){return e.toArea(t).colSpan!==1}}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:e.deleteColumns},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]},{type:"divider"},fo(e.getDesignApi(),e.getTable())),Kn.open(n.clientX,n.clientY,l)}function Za(n,e){function t(){return n.element}function l(){const T=t();return e.getSelectedElements().filter(k=>{var I;if(k.type!==Y.TABLE_CELL)return!1;const C=(I=k.parent)==null?void 0:I.parent;return C==null?!1:C.id==T.id}).sort(Zn.sort)}function s(T){var G,O,j;const[v,...k]=T;let C=v.index,I=v.index,q=((G=v.parent)==null?void 0:G.index)??-1,W=((O=v.parent)==null?void 0:O.index)??-1;for(const ee of k){const M=((j=ee.parent)==null?void 0:j.index)??-1,me=ee.index;me>=0&&me<C&&(C=me),me>=0&&me>I&&(I=me),M>=0&&M<q&&(q=M),M>=0&&M>W&&(W=M)}return{colStart:C,colEnd:I,rowStart:q,rowEnd:W,colSpan:I-C+1,rowSpan:W-q+1}}function o(){var k;const T=l()[0];if(T==null)return!1;const v=(k=T.parent)==null?void 0:k.parent;return v==null?!1:e.selectElement(v)}function a(){const T=l();if(T.length===0)return!1;const v=s(T);return t().insertColumn(v.colStart,0),e.createSnapshot(),!0}function r(){const T=l();if(T.length===0)return!1;const v=s(T);return t().insertColumn(v.colEnd,1),e.createSnapshot(),!0}function i(){const T=l();if(T.length===0)return!1;const v=s(T);return t().inserRow(v.rowStart,0),e.createSnapshot(),!0}function u(){const T=l();if(T.length===0)return!1;const v=s(T);return t().inserRow(v.rowEnd,1),e.createSnapshot(),!0}function d(){var M,me;const T=t(),v=T.page;if(v==null)return;const k=T.doc,C=hl((M=k==null?void 0:k.margins)==null?void 0:M.left)??38,I=hl((me=k==null?void 0:k.margins)==null?void 0:me.right)??38,q=T.columns,W=q.reduce((ce,Fe)=>ce+Fe,0),G=qn.mm_to_px(v.width)-C-I,O=[];for(const ce of q){const Fe=Math.round(ce/W*G);O.push(Fe)}const j=O.reduce((ce,Fe)=>ce+Fe,0),ee=G-j;O[O.length-1]+=ee,T.setColumns(O),T.updateBoxSize(),e.createSnapshot()}function m(){const T=t(),v=T.columns,k=v.reduce((W,G)=>W+G,0),C=Math.floor(k/v.length),I=new Array(v.length).fill(C),q=k-I.reduce((W,G)=>W+G,0);I[I.length-1]+=q,T.setColumns(I),T.updateBoxSize(),e.createSnapshot()}function h(){const T=t(),v=Math.round(T.height/T.children.length);T.children.forEach((k,C)=>T.setRowHeight(C,v)),T.updateBoxSize(),e.createSnapshot()}function E(){const T=e.getSelectedElements()[0];if(T==null)return;const v=T.parent;if(v==null||v.type!="TableRow")return;const k=t(),C=v.height;k.children.forEach(I=>I.setRowHeight(C)),k.updateBoxSize(),e.createSnapshot()}function b(){const T=e.getSelectedElements()[0];if(T==null)return;const v=t(),k=T.width,C=v.attributes.colgroup.map(I=>k);v.setColumns(C),v.updateBoxSize(),e.createSnapshot()}function c(){const T=l();if(T.length<2)return;const[v,...k]=T,C=s(T);for(const I of k)I.attributes.colspan=0,I.attributes.rowspan=0;v.attributes.colspan=C.colSpan,v.attributes.rowspan=C.rowSpan,v.attributes.range=k.map(I=>I.id),e.selectElement(v),e.createSnapshot()}function y(){const T=l();if(T.length!=0){for(const v of T)!v.hasColSpan&&!v.hasRowSpan||v.resetSpan();e.createSnapshot()}}function w(){const T=l()[0];if(T==null)return;t().removeColumn(T.index),e.createSnapshot()}function x(){const T=l()[0];if(T==null)return;const v=T.parent;if(v==null)return;t().removeRow(v.index),e.createSnapshot()}function R(){e.getSelectedElements().forEach(v=>v.resetDS()),e.createSnapshot()}return{getDesignApi(){return e},getTable:t,getSelected:l,selectTable:o,toArea:s,insertColumnLeft:a,insertColumnRight:r,insertRowTop:i,inserRowBottom:u,autoReiszeColumnByPaper:d,avgTableWidth:m,avgTableHeight:h,setOtherRowSameHeight:E,setOtherColSameWidth:b,mergeCells:c,splitCells:y,deleteColumns:w,deleteRows:x,deleteDataSource:R}}function Ka(n,e,t){const s={moved:!1,left:0,colIndex:0,target:null,container:null};function o(d){return d<=0?null:n.getTable().getColumnLeft(d-1)}function a(d){const m=n.getTable(),h=m.attributes.colgroup.length;return d>=h?null:m.getColumnLeft(d+1)}function r(d,m){if(!(d.target instanceof Element))return;const h=d.target.closest("."+e.colResize);if(h==null)return;const E=h.closest("."+e.layer);E!=null&&(d.stopPropagation(),d.preventDefault(),s.left=h.offsetLeft,s.colIndex=m,s.target=h,s.container=E,s.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",i),window.addEventListener("pointerup",u))}function i(d){if(s.target==null||s.container==null)return;const m=s.container.getBoundingClientRect(),h=o(s.colIndex),E=a(s.colIndex);let b=d.clientX-m.left;h!=null&&b<=h+4&&(b=h+4),E!=null&&b>=E-4&&(b=E-4),s.left=b,s.target.style.left=b+"px",s.moved=!0}function u(d){s.moved&&t.onResizeEnd(s.colIndex,Math.round(s.left)),s.left=0,s.target=null,s.container=null,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)}return r}function Ja(n,e,t){const s={moved:!1,top:0,rowIndex:0,target:null,container:null};function o(d){return d<=0?null:n.getTable().getRowTop(d-1)}function a(d){const m=n.getTable(),h=m.children.length;return d>=h?null:m.getRowTop(d+1)}function r(d,m){if(!(d.target instanceof Element))return;const h=d.target.closest("."+e.rowResize);if(h==null)return;const E=h.closest("."+e.layer);E!=null&&(d.stopPropagation(),d.preventDefault(),s.top=h.offsetTop,s.rowIndex=m,s.target=h,s.container=E,s.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",i),window.addEventListener("pointerup",u))}function i(d){if(s.target==null||s.container==null)return;const m=s.container.getBoundingClientRect(),h=o(s.rowIndex),E=a(s.rowIndex);let b=d.clientY-m.top;h!=null&&b<=h+4&&(b=h+4),E!=null&&b>=E-4&&(b=E-4),s.moved=!0,s.top=b,s.target.style.top=b+"px"}function u(d){s.moved&&t.onResizeEnd(s.rowIndex,Math.round(s.top)),s.top=0,s.target=null,s.container=null,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)}return r}const Qa=["width"],ec=["onClick"],tc=["onClick"],nc=$({__name:"TableEditor",props:{element:{type:Wo,required:!0}},setup(n){const e=n,t=Ee(),l=Ie("classes"),s=Za(e,t),o=$e({colIndex:-1,rowIndex:-1,silence:!1}),a=N(()=>e.element.attributes.colgroup??[]),r=Ka(s,l,{onResizeEnd:w,onResizeStart:y}),i=Ja(s,l,{onResizeEnd:x,onResizeStart:y});function u(v){return{left:(e.element.attributes.colgroup??[]).slice(0,v).reduce((C,I)=>C+I,0)+"px"}}function d(v){return{top:(e.element.children??[]).slice(0,v).reduce((I,q)=>I+q.height,0)-1+"px"}}function m(v){const k=e.element.attributes.colgroup??[],C=k.slice(0,v).reduce((W,G)=>W+G,0),I=v===0?0:1,q=v>0&&v<k.length?-1:0;return{left:C+I+"px",width:k[v]+q+"px"}}function h(v){const k=e.element.children??[],C=k.slice(0,v).reduce((W,G)=>W+G.height,0),I=v===0?0:1,q=v>0&&v<k.length?-1:0;return{top:C+I+"px",height:k[v].height+q+"px"}}function E(v){t.selectElement(v)}function b(v){const k=[];for(const C of e.element.children){const I=C.children[v];I.isColCollapse||k.push(I)}t.multiSelectElements(k)}async function c(v){const k=v.target.closest("td");if(k==null)return;const C=Reflect.get(k,Xe);C!=null&&(t.state.selectMode==st.SINGLE&&(t.selectElement(C),await Pt()),ja(v,s))}function y(){o.silence=!0}function w(v,k){o.silence=!1;const C=e.element.attributes.colgroup??[];if(v==0){const O=e.element.left,j=e.element.calculateCoord(O+k),ee=C[0]-(j-O);e.element.setLeft(j),e.element.setColWidth(0,ee),e.element.updateBoxSize(),t.createSnapshot();return}if(v==C.length){const O=v-1,j=C.slice(0,O).reduce((M,me)=>M+me,0),ee=k-j;e.element.setColWidth(v-1,ee),e.element.updateBoxSize(),t.createSnapshot();return}const I=v-1,q=C[I]+C[v],W=k-C.slice(0,I).reduce((O,j)=>O+j,0),G=q-W;e.element.setColWidth(I,W),e.element.setColWidth(v,G),e.element.updateBoxSize(),t.createSnapshot()}function x(v,k){o.silence=!1;const C=e.element.children;if(v==0){const O=e.element.top,j=e.element.calculateCoord(O+k),ee=C[0].height-(j-O);e.element.setTop(j),e.element.setRowHeight(v,ee),e.element.updateBoxSize(),t.createSnapshot();return}if(v==C.length){const O=v-1,j=C.slice(0,O).reduce((M,me)=>M+me.height,0),ee=k-j;e.element.setRowHeight(v-1,ee),e.element.updateBoxSize(),t.createSnapshot();return}const I=v-1,q=C[I].height+C[v].height,W=k-C.slice(0,I).reduce((O,j)=>O+j.height,0),G=q-W;e.element.setRowHeight(I,W),e.element.setRowHeight(v,G),e.element.updateBoxSize(),t.createSnapshot()}function R(){o.rowIndex=-1,o.colIndex=-1}function T(v){if(o.silence)return;const k=v.target.closest("td");if(k==null)return;const C=Reflect.get(k,Xe);if(C==null||!(C instanceof Zn))return;const I=C.parent;if(I==null)return;const q=k.getBoundingClientRect(),W=v.clientY-q.top,O=v.clientX-q.left<q.width/2,j=W<q.height/2;o.colIndex=O?C.index:C.getNextColIndex(),o.rowIndex=j?I.index:C.getNextRowIndex()}return(v,k)=>(S(),L("div",{class:g(_(l).tableEditor),onContextmenu:oe(c,["stop","prevent"]),onClick:k[3]||(k[3]=oe(()=>{},["stop"])),onMouseleave:R},[f("table",{class:g(_(l).table),onMousemove:T},[f("colgroup",null,[(S(!0),L(X,null,ie(a.value,(C,I)=>(S(),L("col",{key:I,width:C},null,8,Qa))),128))]),f("tbody",null,[(S(!0),L(X,null,ie(n.element.children,C=>(S(),L("tr",{key:C.id,class:g({[_(U).SELECTED]:C.isSelected})},[(S(!0),L(X,null,ie(C.children,I=>(S(),Z(uo,{key:I.id,element:I},null,8,["element"]))),128))],2))),128))])],34),f("div",{class:g(_(l).layer)},[o.colIndex>=0?(S(),L("div",{key:0,title:"调整列宽",class:g(_(l).colResize),style:K(u(o.colIndex)),onPointerdown:k[0]||(k[0]=oe(C=>_(r)(C,o.colIndex),["stop","prevent"]))},null,38)):z("",!0),o.rowIndex>=0?(S(),L("div",{key:1,title:"调整行高",class:g(_(l).rowResize),style:K(d(o.rowIndex)),onPointerdown:k[1]||(k[1]=oe(C=>_(i)(C,o.rowIndex),["stop","prevent"]))},null,38)):z("",!0),(S(!0),L(X,null,ie(a.value,(C,I)=>(S(),L("div",{title:"选中此列",key:I,style:K(m(I)),class:g(_(l).colIndicator),onClick:oe(q=>b(I),["stop"])},null,14,ec))),128)),(S(!0),L(X,null,ie(n.element.children,(C,I)=>(S(),L("div",{title:"选中此行",key:I,style:K(h(I)),class:g(_(l).rowIndicator),onClick:oe(q=>E(C),["stop"])},null,14,tc))),128))],2),f("div",{class:g(_(l).indicator),onPointerdown:k[2]||(k[2]=(...C)=>_(t).onDragStart&&_(t).onDragStart(...C)),title:"选中/拖动表格"},null,34)],34))}}),lc="_tableEditor_8j9wo_2",oc="_table_8j9wo_2",sc="_layer_8j9wo_33",ic="_colResize_8j9wo_43",rc="_rowResize_8j9wo_66",ac="_colIndicator_8j9wo_89",cc="_rowIndicator_8j9wo_95",uc="_indicator_8j9wo_114",dc={tableEditor:lc,table:oc,layer:sc,colResize:ic,rowResize:rc,colIndicator:ac,rowIndicator:cc,indicator:uc},fc={classes:dc},pc=V(nc,[["__cssModules",fc]]),mc={class:"quickprint-config-section quickprint-config-inline"},hc={class:"quickprint-config-content"},gc=$({__name:"TableRowConfig",props:{element:{type:on,required:!0}},setup(n){const e=n,t=[{label:"表头",value:kt.HEADER},{label:"表体",value:kt.BODY},{label:"表尾",value:kt.FOOTER}],l=N({get(){return e.element.attributes.type??kt.BODY},set(s){switch(s){case kt.HEADER:e.element.asHeader();break;case kt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(s,o)=>(S(),L("section",mc,[o[1]||(o[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",hc,[p(_(J),{options:t,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=a=>l.value=a),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),wn=Object.freeze({title:"表格",type:Y.TABLE,icon:"icon-table",editor:pc,config:{exclude:[re.PREFIX,re.SUFFIX,re.DISPLAY,re.OVERFLOW]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[_t,_t,_t],e=pe.create({type:Y.TABLE});return e.setColgroup(n),e.append(on.createDefault(n)),e.append(on.createDefault(n)),e.append(on.createDefault(n)),e.updateBoxSize(),e}}),po=Object.freeze({title:"表格行",type:Y.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[re.POSITION,re.COORD,re.OVERFLOW],attributes:gc}}),il=Object.freeze({title:"单元格",type:Y.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:uo,config:{exclude:[re.POSITION,re.COORD]}});function tn(n,e){const t=Math.pow(10,Math.max(0,e));return Math.round(n*t)/t}const $n={A:10,B:11,C:12,D:13,E:14,F:15},vl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function vc(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function bc(n){return typeof n=="string"&&n.includes("%")}function At(n,e){vc(n)&&(n="100%");const t=bc(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function dt(n){return n.length===2?($n[n[0].toUpperCase()]||+n[0])*16+($n[n[1].toUpperCase()]||+n[1]):$n[n[1].toUpperCase()]||+n[1]}function bl(n,e,t){n=At(n,255),e=At(e,255),t=At(t,255);const l=Math.max(n,e,t),s=Math.min(n,e,t);let o;const a=l,r=l-s,i=l===0?0:r/l;if(l===s)o=0;else{switch(l){case n:{o=(e-t)/r+(e<t?6:0);break}case e:{o=(t-n)/r+2;break}case t:{o=(n-e)/r+4;break}}o/=6}return{h:o*360,s:i*100,v:a*100}}const yc=function(n,e,t){e=e/100,t=t/100;let l=e;const s=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=s<=1?s:2-s;const o=(t+e)/2,a=t===0?2*l/(s+l):2*e/(t+e);return{h:n,s:a*100,v:o*100}},_c=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function On(n,e,t){n=At(n,360)*6,e=At(e,100),t=At(t,100);const l=Math.floor(n),s=n-l,o=t*(1-e),a=t*(1-s*e),r=t*(1-(1-s)*e),i=l%6,u=[t,a,o,o,r,t][i],d=[r,t,t,a,o,o][i],m=[o,o,r,t,t,a][i];return{r:Math.round(u*255),g:Math.round(d*255),b:Math.round(m*255)}}function an(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${vl[e]||e}${vl[t]||t}`}function Ec({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${an(n)}${an(e)}${an(t)}`}class kn{constructor(e){B(this,"h",0);B(this,"s",100);B(this,"v",100);B(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=tn(e,2)}setSaturation(e){this.s=tn(e,2)}setValue(e){this.v=tn(e,2)}setAlpha(e){this.a=tn(e,2)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(s=>s!=="").map((s,o)=>o>2?Number.parseFloat(s):Number.parseInt(s,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,s,o,a=100;t.length===3?(l=dt(t[0]+t[0]),s=dt(t[1]+t[1]),o=dt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=dt(t.slice(0,2)),s=dt(t.slice(2,4)),o=dt(t.slice(4,6))),t.length===8&&(a=dt(t.slice(6))/255*100);const{h:r,s:i,v:u}=bl(l,s,o);return{h:r,s:i,v:u,a}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:a}=bl(t[0],t[1],t[2]);return{h:s,s:o,v:a,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:a}=yc(t[0],t[1],t[2]);return{h:s,s:o,v:a,a:l}}return null}toString(e){switch(e){case"hsl":{const t=_c(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Ec(On(this.h,this.s,this.v))}${an(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:s}=On(this.h,this.s,this.v);return`rgba(${t},${l},${s},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return On(this.h,this.s,this.v)}}function mo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(a){const r=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().width/2;let d=a.clientX-r.left-e.offsetX;return d<-u&&(d=-u),d>r.width-u&&(d=r.width-u),d}function l(a){a.stopPropagation(),a.preventDefault();const r=a.target,i=a.currentTarget;origin==null||r==null||(e.container=i,e.target=r===i?r.firstElementChild:r,e.offsetX=r===i?e.target.offsetWidth/2:a.clientX-r.getBoundingClientRect().left,window.addEventListener("pointermove",s),window.addEventListener("pointerup",o))}function s(a){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(a.pointerId),e.init=!0);const r=t(a);e.target.style.left=r+"px",n("move",r)}function o(a){if(a.preventDefault(),a.stopPropagation(),e.container&&e.target){const r=t(a);n("end",r)}e.target&&e.target.releasePointerCapture(a.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",o)}return l}function Tc(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let m=r.clientX-i.left-e.offsetX;return m<-d&&(m=-d),m>i.width-d&&(m=i.width-d),m}function l(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().height/2;let m=r.clientY-i.top-e.offsetY;return m<-d&&(m=-d),m>i.height-d&&(m=i.height-d),m}function s(r){r.stopPropagation(),r.preventDefault();const i=r.target,u=r.currentTarget;origin==null||i==null||(e.container=u,e.target=i===u?i.firstElementChild:i,e.offsetX=i===u?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,e.offsetY=i===u?e.target.offsetHeight/2:r.clientY-i.getBoundingClientRect().top,window.addEventListener("pointermove",o),window.addEventListener("pointerup",a))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r),u=l(r);e.target.style.left=i+"px",e.target.style.top=u+"px",n("move",{left:i,top:u})}function a(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r),u=l(r);n("end",{top:u,left:i})}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",a)}return s}const Sc=$({__name:"SvPanel",props:{modelValue:{type:kn,required:!0}},setup(n){const e=n,t=ue(),l=ue(),s=$e(r()),o=N(()=>({left:s.left+"px",top:s.top+"px"})),a=Tc((i,u)=>{i=="end"&&(s.top=u.top,s.left=u.left);const d=t.value,m=l.value,h=(u.left+m.offsetWidth/2)/d.offsetWidth*100,E=100-(u.top+m.offsetHeight)/d.offsetHeight*100;e.modelValue.setSaturation(h),e.modelValue.setValue(E)});function r(){const i=t.value,u=l.value;if(i==null||u==null)return{top:-6,left:-6};const d=e.modelValue.s,h=(100-e.modelValue.v)/100*i.offsetHeight,E=d/100*i.offsetWidth;return{top:h-u.offsetHeight/2,left:E-u.offsetWidth/2}}return Qt(()=>{const i=r();s.top=i.top,s.left=i.left}),(i,u)=>(S(),L("div",{class:g(i.classes.svPanel),onPointerdown:u[0]||(u[0]=(...d)=>_(a)&&_(a)(...d)),ref_key:"svPanelRef",ref:t},[f("div",{class:g(i.classes.thumb),style:K(o.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),wc="_svPanel_1sv6o_2",kc="_thumb_1sv6o_10",Cc={svPanel:wc,thumb:kc},Rc={classes:Cc},Lc=V(Sc,[["__cssModules",Rc]]),Nc=$({__name:"HueSlider",props:{modelValue:{type:kn,required:!0}},setup(n){const e=n,t=se(-6),l=ue(),s=ue(),o=mo((r,i)=>{r=="end"&&(t.value=i);const u=l.value,d=s.value,m=Math.round((i+d.offsetWidth/2)/u.offsetWidth*360);e.modelValue.setHue(m)});function a(){const r=l.value,i=s.value;if(r==null||i==null)return-6;const u=e.modelValue.h;return Math.round(u/360*r.offsetWidth)-i.offsetWidth/2}return Qt(()=>{t.value=a()}),(r,i)=>(S(),L("div",{class:g(r.classes.hue),onPointerdown:i[0]||(i[0]=(...u)=>_(o)&&_(o)(...u)),ref_key:"hueRef",ref:l},[f("div",{class:g(r.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),Ic="_hue_1ozoc_2",xc="_thumb_1ozoc_10",Ac={hue:Ic,thumb:xc},Dc={classes:Ac},$c=V(Nc,[["__cssModules",Dc]]),Oc=$({__name:"AlphaSlider",props:{modelValue:{type:kn,required:!0}},setup(n){const e=n,t=se(-6),l=ue(),s=ue(),o=mo((r,i)=>{r=="end"&&(t.value=i);const u=l.value,d=s.value,m=Math.round((i+d.offsetWidth/2)/u.offsetWidth*100);e.modelValue.setAlpha(m)});function a(){const r=l.value,i=s.value;if(r==null||i==null)return-6;const u=e.modelValue.a;return Math.round(u/100*r.offsetWidth)-i.offsetWidth/2}return Qt(()=>{t.value=a()}),(r,i)=>(S(),L("div",{class:g(r.classes.alpha),onPointerdown:i[0]||(i[0]=(...u)=>_(o)&&_(o)(...u)),ref_key:"alphaRef",ref:l},[f("div",{class:g(r.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),qc="_alpha_1x8jd_2",Mc="_thumb_1x8jd_26",Pc={alpha:qc,thumb:Mc},Vc={classes:Pc},Bc=V(Oc,[["__cssModules",Vc]]),Fc=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function zc(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function Uc(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const yl={isSupport:zc,open:Uc},Hc=["title","onClick"],Gc=["title","onClick"],_l="quickprint-recent-use-colors",Wc=$({__name:"index",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,s=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],o=se(new kn(l.modelValue)),a=ue(),r=ue(),i=se(x()),u=yl.isSupport(),d=se("hex"),m=N(()=>{const v=l.modelValue;return v?{backgroundColor:v}:null}),h=N(()=>{const v=o.value,{r:k,g:C,b:I}=v.rgb();return{"--hue-channel-color":`hsl(${v.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${k}, ${C}, ${I}, 0)`,"--alpha-channel-color-b":`rgba(${k}, ${C}, ${I}, 1)`}}),E=N({get(){return o.value.toString(d.value)},set(v){o.value.setColor(v)}});function b(){var v;(v=a.value)==null||v.close()}function c(v){v!=null&&(t("update:modelValue",v),t("select",v),R(v),b())}function y(){t("update:modelValue",void 0),t("select",void 0),b()}function w(){yl.open().then(v=>c(v))}function x(){const v=localStorage.getItem(_l);if(v==null||v=="")return[];const k=hn(v);return k==null?[]:Array.isArray(k)?k:[]}function R(v){const k=i.value,C=k.indexOf(v);C>=0&&k.splice(C,1),k.length>10&&k.pop(),k.unshift(v),localStorage.setItem(_l,JSON.stringify(k))}function T(){t("update:modelValue",o.value.toString(d.value)),t("select",o.value.toString(d.value)),b()}return Qn(()=>l.modelValue,()=>o.value.setColor(l.modelValue)),(v,k)=>(S(),Z(_(Ql),{class:g(v.classes.colorPicker),onMousedown:k[7]||(k[7]=oe(()=>{},["prevent"])),ref_key:"popoverRef",ref:a},{popover:ge(()=>[f("div",{class:g(v.classes.colorPickerPanel)},[f("div",{class:g(v.classes.presetPanel)},[f("div",{class:g(v.classes.presetTools)},[f("button",{type:"button",class:g(v.classes.clearBtn),onClick:y},[f("span",{class:g(v.classes.none)},null,2),k[8]||(k[8]=f("span",null,"无颜色",-1))],2),_(u)?(S(),L("button",{key:0,type:"button",class:g(v.classes.indicator),onClick:w},[p(_(D),{icon:"icon-eye-dropper"}),k[9]||(k[9]=f("span",null,"拾色器",-1))],2)):z("",!0)],2),f("div",{class:g(v.classes.colourAtla)},[(S(!0),L(X,null,ie(_(Fc),C=>(S(),L("div",{style:K({backgroundColor:C}),title:C,class:g(v.classes.color),onClick:I=>c(C)},null,14,Hc))),256))],2),f("div",{class:g(v.classes.recentColors)},"最近使用",2),f("div",{class:g(v.classes.colourAtla)},[(S(),L(X,null,ie(10,C=>f("div",{key:C,title:i.value[C-1],style:K({backgroundColor:i.value[C-1]}),class:g(v.classes.color),onClick:I=>c(i.value[C-1])},null,14,Gc)),64))],2)],2),f("div",{class:g(v.pacls.panel),style:K(h.value)},[p(Lc,{class:g(v.pacls.sv),modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=C=>o.value=C)},null,8,["class","modelValue"]),f("div",{class:g(v.pacls.sliders)},[p($c,{class:g(v.pacls.hua),modelValue:o.value,"onUpdate:modelValue":k[2]||(k[2]=C=>o.value=C)},null,8,["class","modelValue"]),p(Bc,{modelValue:o.value,"onUpdate:modelValue":k[3]||(k[3]=C=>o.value=C)},null,8,["modelValue"]),f("div",{class:g(v.pacls.preview)},[f("div",{class:g(v.pacls.previewColor),style:K({backgroundColor:o.value.toRGB()})},null,6)],2)],2),f("div",{class:g(v.pacls.tools)},[p(_(J),{options:s,teleport:"none",modelValue:d.value,"onUpdate:modelValue":k[4]||(k[4]=C=>d.value=C),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),_e(f("input",{type:"text","onUpdate:modelValue":k[5]||(k[5]=C=>E.value=C),onMousedown:k[6]||(k[6]=oe(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Ne,E.value]]),f("button",{type:"button",class:g(v.pacls.confirm),onClick:T},"确定",2)],2)],6)],2)]),default:ge(()=>[f("div",{class:g(v.classes.colorPickerInput),ref_key:"inputRef",ref:r},[Me(v.$slots,"default",{},()=>[f("span",{class:g(v.classes.colorBlock),style:K(m.value)},null,6)]),n.showText?(S(),L("div",{key:0,class:g(v.classes.colorValue),onClick:k[0]||(k[0]=oe(()=>{},["stop"]))},H(n.modelValue),3)):z("",!0)],2)]),_:3},8,["class"]))}}),Yc="_colorPicker_qpnrm_2",Xc="_colorPickerInput_qpnrm_6",jc="_colorBlock_qpnrm_13",Zc="_colorValue_qpnrm_22",Kc="_colorPickerPanel_qpnrm_27",Jc="_presetPanel_qpnrm_42",Qc="_colourAtla_qpnrm_46",eu="_color_qpnrm_2",tu="_presetTools_qpnrm_73",nu="_clearBtn_qpnrm_79",lu="_indicator_qpnrm_80",ou="_none_qpnrm_98",su="_recentColors_qpnrm_129",iu={colorPicker:Yc,colorPickerInput:Xc,colorBlock:jc,colorValue:Zc,colorPickerPanel:Kc,presetPanel:Jc,colourAtla:Qc,color:eu,presetTools:tu,clearBtn:nu,indicator:lu,none:ou,recentColors:su},ru="_panel_911zv_2",au="_sv_911zv_7",cu="_hua_911zv_11",uu="_sliders_911zv_15",du="_tools_911zv_20",fu="_confirm_911zv_37 quickprint-text-btn",pu="_preview_911zv_44",mu="_previewColor_911zv_59",hu={panel:ru,sv:au,hua:cu,sliders:uu,tools:du,confirm:fu,preview:pu,previewColor:mu},gu={classes:iu,pacls:hu},lt=V(Wc,[["__cssModules",gu]]);class vu{constructor(e){B(this,"__v_skip",!0);B(this,"observer");B(this,"callbacks",[]);B(this,"handler");this.handler=yi((t,l)=>{for(const s of this.callbacks)s(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function bu(n,e){switch(n){case"fontSize":return e===be.DEFAULT?void 0:e;case"fontFamily":return e===le.DEFAULT?void 0:e;case"lineHeight":return e===ht.DEFAULT?void 0:e;default:return e}}const El="texteditor-const-node",yu=Object.freeze({CONST:0});class _u{constructor(e,t={}){B(this,"__v_skip",!0);B(this,"emitter",new pn);B(this,"container");B(this,"options");B(this,"observer");B(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new vu(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new pn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Yo(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ae(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await vn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=El,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,s=e[0],o=e[e.length-1];return!this.container.contains(s)||!this.container.contains(o)?!1:(t.removeAllRanges(),l.setStartBefore(s),l.setEndAfter(o),t.addRange(l),!0)}insertNode(e,t){var h;const l=this.getSelection();if(l==null)return!1;const{selection:s,range:o}=l;if(s.isCollapsed!=!0&&s.deleteFromDocument(),s.isCollapsed!=!0)return!1;const a=s.anchorNode;if(a==null)return!1;const r=this.container,i=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(i),a.parentNode===r||(h=a.parentNode)!=null&&h.contains(r))return o.insertNode(i),this.normalize(),this.focusAfterNode(i),!0;const u=a.parentNode;if(u==null)return!1;const d=u.textContent;if(d==null)return!1;if(s.anchorOffset==d.length)return r.insertBefore(i,u.nextSibling),this.normalize(),this.focusAfterNode(i),!0;const m=document.createElement("span");return m.textContent=d.slice(0,s.anchorOffset),u instanceof HTMLElement&&(m.style.cssText=u.style.cssText),u.textContent=d.slice(s.anchorOffset),r.insertBefore(i,u),r.insertBefore(m,i),this.normalize(),this.focusAfterNode(i),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:s}=t;return l.isCollapsed||l.deleteFromDocument(),s.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,s=e.endContainer,o={};return l===t?(o.startNode=t.childNodes[e.startOffset],o.startOffset=-1):(o.startNode=l.parentNode==t?l:l.parentNode,o.startOffset=e.startOffset),s===t?(o.endNode=t.childNodes[e.endOffset],o.endOffset=-1):(o.endNode=s.parentNode==t?s:s.parentNode,o.endOffset=e.endOffset),o}findNodesBetween(e,t){const l=[];let s=e.nextSibling;for(;s!=null&&s!==t;)l.push(s),s=s.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ae(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var d;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const s=t.range,{startNode:o,startOffset:a,endNode:r,endOffset:i}=this.normalizeRange(s);if(o===r){const m=o.textContent??"";if(o instanceof CharacterData){const b=document.createElement("span");return b.textContent=m.slice(a,i),s.deleteContents(),s.insertNode(b),[b]}const h=document.createElement("span");h.textContent=m.slice(0,a),this.inheritStyle(h,r);const E=document.createElement("span");return E.textContent=m.slice(a,i),this.inheritStyle(E,r),r.textContent=m.slice(i),e.insertBefore(E,r),e.insertBefore(h,E),[E]}const u=this.findNodesBetween(o,r);if(a>0){const m=o.textContent??"",h=document.createElement("span");h.textContent=m.slice(0,a),this.inheritStyle(h,o),o.textContent=m.slice(a),e.insertBefore(h,o)}if(i>=0&&i<=(((d=r.textContent)==null?void 0:d.length)??0)){const m=r.textContent??"";if(r instanceof HTMLElement){r.textContent=m.slice(0,i);const h=document.createElement("span");h.textContent=m.slice(i),this.inheritStyle(h,r),e.insertBefore(h,r.nextSibling),u.push(r)}else{const h=document.createElement("span");h.textContent=m.slice(0,i),e.replaceChild(h,r);const E=document.createTextNode(m.slice(i));e.insertBefore(E,r.nextSibling),u.push(h)}}return u.unshift(o),u}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let s=!0;const o=Ol(e),a=bu(e,t);for(let r=0;r<l.length;r++){const i=l[r];if(i instanceof HTMLElement){this.matchElementStyle(i,o,a)||(s=!1);continue}const u=document.createElement("span");u.textContent=i.textContent,this.container.replaceChild(u,i),l[r]=u,s=!1}for(const r of l){if(s||a==null){this.removeElementStyle(r,o,a);continue}this.setElementStyle(r,o,a)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const s=e.style.getPropertyValue(t);return t==="text-decoration-line"?s.includes(l):s==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=vt.push(s,l);e.style.setProperty("text-decoration-line",o);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=vt.remove(s,l);ae(o)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",o);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+El)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const Eu=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:le.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],ho=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],go=[{label:"默认",value:le.DEFAULT},...ho],Cn=[{label:"默认",value:le.DEFAULT},...Eu,...ho],rl=[{label:"默认",value:be.DEFAULT},{label:"初号",value:be.SIZE_0+"pt",short:"56px"},{label:"小初",value:be.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:be.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:be.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:be.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:be.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:be.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:be.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:be.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:be.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:be.SIZE_5+"pt",short:"14px"},{label:"小五",value:be.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],vo=[{label:"默认",value:ht.DEFAULT},{label:"1.0",value:ht.TIMES_1,short:"单倍行距"},{label:"1.1",value:ht.TIMES_1_1},{label:"1.5",value:ht.TIMES_1_5},{label:"2.0",value:ht.TIMES_2,short:"两倍行距"}],Tu=[{label:"无",value:sn.NONE},{label:"实线",value:Ct.SOLID},{label:"虚线",value:Ct.DASHED},{label:"点划线",value:Ct.DOTTED},{label:"双实线",value:Ct.DOUBLE},{label:"波浪线",value:Ct.WAVY}],Su=[{label:"默认",value:gt.AUTO},{label:"左对齐",value:gt.LEFT},{label:"居中对齐",value:gt.CENTER},{label:"右对齐",value:gt.RIGHT},{label:"两端对齐",value:gt.JUSTIFY}],Bn=[{label:"顶部对齐",value:Ye.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Ye.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Ye.BOTTOM,icon:"icon-vertical-align-bottom"}],Fn=[{label:"左对齐",value:tt.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:tt.CENTER,icon:"icon-align-center"},{label:"右对齐",value:tt.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:tt.JUSTIFY,icon:"icon-menu"}],wu=$({__name:"ParagraphEditor",props:{element:{type:Xo,required:!0}},setup(n){const e=n,t=Ee(),l=ue(),s=N(()=>e.element.isSelected!==!0?!1:t.state.selectMode===st.SINGLE);let o=null;const a=N(()=>Cn.map(v=>(v.style={fontFamily:v.value==le.DEFAULT?le.SONG:v.value},v)));function r(){}async function i(){if(o==null)return;const v=await sl({doc:t.doc}).catch(et);if(v==null)return;const k=it(v.value,t.doc.ds)??v.value,C={type:yu.CONST,value:v.value,label:k};o.insertNode(C)}function u(){o==null||o.blur()}function d(){o==null||o.autosize()}function m(v){const k=e.element.ds.value,C=new _u(v);return C.on("resize",I=>{var W;const q=(W=I.detail)==null?void 0:W.height;q!=null&&e.element.setHeight(q+2)}),C.watch(()=>{const I=C.getHTML(),q=e.element.ds.value;I!==q&&(e.element.ds.value=I,C.checkHeight())}),ae(k)||C.setHTML(k),C}function h(v){o==null||o.setStyle("fontFamily",v.value)}function E(v){o==null||o.setStyle("fontSize",v.value)}function b(v){o==null||o.setStyle("lineHeight",v.value)}function c(v){o==null||o.setStyle("backgroundColor",v)}function y(v){o==null||o.setStyle("color",v)}function w(){o==null||o.setStyle("fontWeight","700")}function x(){o==null||o.setStyle("fontStyle","italic")}function R(){o==null||o.setStyle("textDecorationLine","underline")}function T(){o==null||o.setStyle("textDecorationLine","line-through")}return Qn(()=>e.element.ds.value,v=>{o==null||o.getHTML()==v||o.setHTML(v)}),Qt(()=>{e.element.on("blur",u),o=m(l.value)}),Jn(()=>{e.element.off("blur",u),o&&o.cleanup()}),(v,k)=>(S(),L("div",{class:g(v.classes.paragraph),onPointerdown:k[2]||(k[2]=oe(()=>{},["stop"])),onContextmenu:oe(r,["stop","prevent"])},[f("div",{class:g(v.classes.indicator),onPointerdown:k[0]||(k[0]=(...C)=>_(t).onDragStart&&_(t).onDragStart(...C)),title:"选中/拖动段落"},null,34),s.value?(S(),L("div",{key:0,class:g(v.classes.toolbar),onMousedown:k[1]||(k[1]=oe(()=>{},["prevent"]))},[p(_(J),{onSelect:h,title:"字体",width:"60px",options:a.value,class:g(v.classes.tool),button:""},null,8,["options","class"]),p(_(J),{onSelect:E,title:"字号",width:"60px",options:_(rl),class:g(v.classes.tool),button:""},null,8,["options","class"]),p(_(J),{onSelect:b,title:"行高",width:"60px",options:_(vo),class:g(v.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),f("div",{class:g(v.classes.divider)},null,2),p(lt,{class:g(v.classes.tool),onSelect:c},{default:ge(()=>[f("div",{class:g(v.classes.colorIcon),title:"突出显示"},[p(_(D),{icon:"icon-bg-color-b",size:"15px"}),f("div",{class:g(v.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(lt,{class:g(v.classes.tool),onSelect:y},{default:ge(()=>[f("div",{class:g(v.classes.colorIcon),title:"字体颜色"},[p(_(D),{icon:"icon-font",size:"15px"}),f("div",{class:g(v.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),f("button",{onClick:w,type:"button",title:"加粗",class:g(["quickprint-text-btn",v.classes.tool])},[p(_(D),{icon:"icon-font-bold",size:"16px"})],2),f("button",{onClick:x,type:"button",title:"斜体",class:g(["quickprint-text-btn",v.classes.tool])},[p(_(D),{icon:"icon-italic",size:"16px"})],2),f("button",{onClick:R,type:"button",title:"下划线",class:g(["quickprint-text-btn",v.classes.tool])},[p(_(D),{icon:"icon-underline",size:"16px"})],2),f("button",{onClick:T,type:"button",title:"删除线",class:g(["quickprint-text-btn",v.classes.tool])},[p(_(D),{icon:"icon-through-line",size:"16px"})],2),f("div",{class:g(v.classes.divider)},null,2),f("button",{class:"quickprint-text-btn",type:"button",onClick:i},[p(_(D),{icon:"icon-insert-var",size:"16px"}),k[3]||(k[3]=f("span",null,"插入变量",-1))]),f("button",{class:"quickprint-text-btn",type:"button",onClick:d},[p(_(D),{icon:"icon-colum-height",size:"16px"}),k[4]||(k[4]=f("span",null,"调整高度",-1))])],34)):z("",!0),f("div",{ref_key:"editorRef",ref:l,class:g(v.classes.editor)},null,2)],34))}}),ku="_paragraph_1v2pj_2",Cu="_indicator_1v2pj_6",Ru="_editor_1v2pj_18",Lu="_toolbar_1v2pj_44",Nu="_tool_1v2pj_44",Iu="_colorIcon_1v2pj_66",xu="_colorIndicator_1v2pj_86",Au="_divider_1v2pj_95",Du={paragraph:ku,indicator:Cu,editor:Ru,toolbar:Lu,tool:Nu,colorIcon:Iu,colorIndicator:xu,divider:Au},$u={classes:Du},Ou=V(wu,[["__cssModules",$u]]),Rn=Object.freeze({title:"段落",type:Y.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:Ou,config:{exclude:[re.DATASOURCE,re.BASIC,re.OVERFLOW]},onCreate(){return pe.create({type:Y.PARAGRAPH,width:_t*4,height:yn*6})}}),bo=[En,Tn,Sn,wn,il,po,Rn],qu=[En,Tn,Sn,wn,Rn],Mu={[Y.TEXT]:En.editor,[Y.NUMBER]:Tn.editor,[Y.DATE]:Sn.editor,[Y.TABLE]:wn.editor,[Y.TABLE_CELL]:il.editor,[Y.PARAGRAPH]:Rn.editor},Pu={[Y.TEXT]:En.config,[Y.NUMBER]:Tn.config,[Y.DATE]:Sn.config,[Y.TABLE]:wn.config,[Y.TABLE_CELL]:il.config,[Y.TABLE_ROW]:po.config,[Y.PARAGRAPH]:Rn.config},Bt=bo.reduce((n,e)=>(n[e.type]=e,n),{});function Vu(n){const e=bo.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function Bu(n){return Reflect.get(Mu,n)}function Lt(n){return Reflect.get(Pu,n)}function Zt(n){var e;return((e=Bt[n])==null?void 0:e.title)??n}function Fu(n){var e;return(e=Bt[n])==null?void 0:e.icon}function zu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function Uu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function Hu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Gu(n){var e,t;return((t=(e=Bt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Tl(n,e,t,l){const[s,o]=e.top>t.top?[t,e]:[e,t],a=s.top-l.top,r=o.bottom-s.top;return{top:a,left:n,height:r}}function Sl(n,e,t,l){const[s,o]=e.left>t.left?[t,e]:[e,t],a=s.left-l.left,r=o.right-s.left;return{top:n,left:a,width:r}}function wl(n,e){const t=n.find(i=>i.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,s=t.top+t.height,o=Math.min(t.top,e.top),r=Math.max(l,s)-o;t.top=o,t.height=r}function kl(n,e){const t=n.find(i=>i.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,s=t.left+t.width,o=Math.min(t.left,e.left),r=Math.max(l,s)-o;t.left=o,t.width=r}function Wu(n){const e=document.createElement("div");return n.appendChild(e),e}function Yu(n,e){const t=[...e.querySelectorAll(":scope ."+U.GUIDE_LINE)];for(const l of n){const s=t.shift()??Wu(e);s.className=U.GUIDE_LINE,s.style.top=l.top+"px",s.style.left=l.left+"px",s.style.height=(l.height??1)+"px",s.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function Xu(n,e){const l=e.querySelectorAll(":scope ."+U.ELEMENT),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),a=[];for(const r of l){if(n==r)continue;const i=r.getBoundingClientRect();if(Math.abs(o.left-i.left)<=1||Math.abs(o.right-i.left)<=1){const u=i.left-s.left;wl(a,Tl(u,o,i,s))}if(Math.abs(o.left-i.right)<=1||Math.abs(o.right-i.right)<=1){const u=i.right-s.left;wl(a,Tl(u,o,i,s))}if(Math.abs(o.top-i.top)<=1||Math.abs(o.bottom-i.top)<=1){const u=i.top-s.top;kl(a,Sl(u,o,i,s))}if(Math.abs(o.bottom-i.bottom)<=1||Math.abs(o.top-i.bottom)<=1){const u=i.bottom-s.top;kl(a,Sl(u,o,i,s))}}Yu(a,e)}function ju(){const n=document.querySelectorAll("."+U.GUIDE_LINE);for(const e of n)e.remove()}const gn={create:_i(Xu,50),clean:ju};async function Zu(n){await vn(),n&&Reflect.deleteProperty(n,bn)}async function Ku(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const o=document.createElement("div");o.className="quickprint-is-indicator",e.indicatorElement=o,document.body.appendChild(o)}const t=Ju(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,s=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=s.left+"px",l.style.top=s.top-jl(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function Ju(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Re.INSERT){const s=t.closest("."+U.PAGE);if(s==null)return null;const o=s.getBoundingClientRect();return{x:l?Nt(e.left-o.left):Math.round(e.left-o.left),y:l?Nt(e.top-o.top):Math.round(e.top-o.top),w:e.element.width,h:e.element.height}}return{x:l?Nt(e.left):Math.round(e.left),y:l?Nt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function Qu(n){return!(n.style.rotate&&!n.isSelected)}function ed(n){const e=new Pn({selector:{container:U.DROPPABLE},scale(t){return t.mode===Re.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,zl),o=Reflect.get(l.target,el);s===Re.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=s===Re.INSERT?s:Re.MOVE,l.elementType=o,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Re.INSERT){const o=Vu(l.elementType);l.element=o,l.ghost.style.width=o.width+"px",l.ghost.style.height=o.height+"px";return}const s=Reflect.get(l.target,Xe);if(s==null||!Qu(s))return t.preventDefault();l.element=s}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Re.INSERT&&(l.ghost.style.display="block"),l.mode===Re.MOVE&&Reflect.set(l.target,bn,tl.DRAG_ELEMENT),l.ghost.classList.add(U.DRAGGING),l.initDragElement=!0),Ku(n,l),l.dropTarget&&gn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;gn.clean(),l.ghost.classList.remove(U.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Re.INSERT&&(l.ghost.style.display="none"),l.mode==Re.MOVE&&Zu(l.target);const s=l.element;if(l.mode==Re.MOVE){s.setTop(l.top),s.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),n.selectElement(s),n.createSnapshot();return}if(l.dropTarget==null)return;const o=Reflect.get(l.dropTarget,Ul);if(o==null)return;const a=o instanceof Tt||o instanceof pe?o:null;if(a==null)return;const r=l.dropTarget.getBoundingClientRect(),i=n.state.scale/100;s.setTop((l.top-r.top)/i),s.setLeft((l.left-r.left)/i),s.setWidth(s.width/i),s.setHeight(s.height/i),a.append(l.element),n.selectElement(s),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Cl="quickprint-history-0000",td=1,Ze="snapshot",cn="health",Rl="owner",Ue="INDEX_OWNER",nd=15*60*1e3,ld=10*60*1e3;function od(){const n={db:null,timer:null,promise:null};async function e(){const d=await i(cn,"readwrite");if(d==null)return n.timer=o(),!1;const m=[],h=d.openCursor();h.onsuccess=async function(E){const b=E.target.result;if(b==null){t(m),n.timer=o(),Le.debug("History","已检查无效快照");return}const c=b.value;c!=null&&Date.now()-c.timestamp>nd&&m.push(c),b.continue()},h.onerror=function(E){console.error(E),n.timer=o()}}async function t(d){const m=await Promise.allSettled(d.map(h=>l(h.owner)));for(let h=0;h<m.length;h++){const E=m[h];E.status==="rejected"||E.value!==!0||s(d[h].id)}}async function l(d){const m=await i(Ze,"readwrite");return m==null?!1:new Promise(h=>{const E=m.index(Ue).openCursor(IDBKeyRange.only(d));E.onsuccess=function(b){const c=b.target.result;if(c==null)return h(!0);c.delete(),c.continue()},E.onerror=function(b){console.error(b),h(!1)}})}async function s(d){const m=await i(cn,"readwrite");return m==null?!1:Yt(m.delete(d)).then(()=>!0).catch(h=>(console.log(h),!1))}function o(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),ld)}function a(){return new Promise(d=>{const m=indexedDB.open(Cl,td);m.onupgradeneeded=h=>{const b=h.target.result,c=b.createObjectStore(cn,{keyPath:"id",autoIncrement:!0}),y=b.createObjectStore(Ze,{keyPath:"id",autoIncrement:!0});c.createIndex(Ue,Rl),y.createIndex(Ue,Rl)},m.onsuccess=h=>{const E=h.target;n.db=E.result,Le.debug("History",`已连接数据库【${Cl}】`),d(n.db)},m.onerror=function(h){console.error(h),n.db=null,d(null)}})}function r(){return n.promise==null?Promise.resolve(n.db):n.promise}async function i(d,m="readonly"){const h=await r();if(h==null)return null;try{return h.transaction(d,m).objectStore(d)}catch(E){return console.error(E),null}}function u(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=a(),n.timer=o(),e(),{ready:r,findStore:i,cleanup:u}}function Yt(n){return new Promise((e,t)=>{n.onsuccess=function(l){const s=l.target;e(s.result)},n.onerror=function(l){console.error(l),t()}})}const sd=5*60*1e3,ft=od();var He,De,un,zn,yo;class id{constructor(e,t={}){ze(this,De);B(this,"state");B(this,"owner");ze(this,He);this.state=e,this.owner=t.owner??jo(Zo.HISTORY_OWNER),we(this,De,zn).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await ft.findStore(Ze,"readwrite");if(l==null)return!1;await we(this,De,yo).call(this,l);const s=this.state.index+1,o={index:s,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await Yt(l.put(o)).catch(et)==null?!1:(this.state.index=s,this.state.count=s+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const s=await ft.findStore(Ze,"readwrite");return!(s==null||(l.data=JSON.stringify(e),await Yt(s.put(l)).catch(et)==null))}async getCurrentSnapshot(){const e=await ft.findStore(Ze);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=a=>{const r=a.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return s(i);r.continue()},o.onerror=function(a){console.error(a),s(null)}})}async getPrevSnapshot(){const e=await ft.findStore(Ze);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=a=>{const r=a.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return this.state.index=t,s(r.value);r.continue()},o.onerror=function(a){console.error(a),s(null)}})}async getNextSnapshot(){const e=await ft.findStore(Ze);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"next");o.onsuccess=a=>{const r=a.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return this.state.index=t,s(r.value);r.continue()},o.onerror=function(a){console.error(a),s(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await ft.findStore(Ze);if(e==null)return[];const t=this.owner;return new Promise(l=>{const s=e.index(Ue).openCursor(IDBKeyRange.only(t),"prev"),o=[];s.onsuccess=a=>{const r=a.target.result;if(r==null)return l(o);const i=r.value;if(i.owner!=t)return r.continue();o.push(i),r.continue()},s.onerror=function(a){console.error(a),l([])}})}cleanup(){Se(this,He)&&(clearTimeout(Se(this,He)),ut(this,He,null))}}He=new WeakMap,De=new WeakSet,un=function(){ut(this,He,setTimeout(()=>we(this,De,zn).call(this),sd))},zn=async function(){Se(this,He)&&clearTimeout(Se(this,He));const e=await ft.findStore(cn,"readwrite");if(e==null)return we(this,De,un).call(this);const t=await Yt(e.index(Ue).get(this.owner)).catch(et);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),we(this,De,un).call(this)}t.timestamp=Date.now(),await Yt(e.put(t)).catch(et),we(this,De,un).call(this)},yo=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const s=this.owner;return new Promise(o=>{const a=e.index(Ue).openCursor(IDBKeyRange.only(s),"prev");a.onsuccess=function(r){const i=r.target.result;if(i==null)return o(!0);const u=i.value;if(u.owner!=s)return i.continue();if(u.index>t){i.delete(),i.continue();return}o(!0)},a.onerror=function(r){console.error(r),o(!1)}})};function rd(n){const e=new id($e({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function s(d){return e.createSnapshot(n.value,d)}function o(d){return e.replaceSnapshot(n.value,d)}async function a(){const d=await e.getPrevSnapshot();if(d==null)return!1;const m=hn(d.data);return m==null?!1:(n.value=ve.create(m),!0)}async function r(){const d=await e.getNextSnapshot();if(d==null)return!1;const m=hn(d.data);return m==null?!1:(n.value=ve.create(m),!0)}function i(){return e.list()}function u(){e.cleanup()}return s(),{allowRedo:l,allowUndo:t,createSnapshot:s,undo:a,redo:r,list:i,cleanup:u,replaceSnapshot:o}}class ad{constructor(e){B(this,"moved",!1);B(this,"position");B(this,"top",0);B(this,"left",0);B(this,"width",0);B(this,"height",0);B(this,"initX",0);B(this,"initY",0);B(this,"indicator");B(this,"container");B(this,"originalEvent");B(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Ot,qt,at,_o,Eo,To;const Te=class Te extends pn{constructor(t={}){var l,s,o;super();ze(this,at);B(this,"context",null);B(this,"selector");B(this,"scale");B(this,"onResizeStart");ze(this,Ot);ze(this,qt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??U.PAGE,element:((s=t.selector)==null?void 0:s.element)??U.RESIZEABLE,indicator:((o=t.selector)==null?void 0:o.indicator)??U.RESIZEABLE_INDICATOR},this.onResizeStart=we(this,at,_o).bind(this),ut(this,Ot,we(this,at,Eo).bind(this)),ut(this,qt,we(this,at,To).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",Se(this,Ot)),window.removeEventListener("pointerup",Se(this,qt)),this.context=null}};Ot=new WeakMap,qt=new WeakMap,at=new WeakSet,_o=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Le.warn(Te.TAG_NAME,"未找到的可调整元素");const s=Reflect.get(l,Hl);if(s==null)return Le.warn(Te.TAG_NAME,"未找到的可调整元素");const o=l.closest("."+this.selector.element);if(o==null)return Le.warn(Te.TAG_NAME,"未找到的可调整元素");const a=Xl(o,this.selector.container);this.context=new ad({event:t,indicator:l,target:o,container:a,position:s});const r=this.createEvent("before-resizestart",this.context);if(this.dispatch(r).defaultPrevented)return Le.warn(Te.TAG_NAME,"已取消调整");if(this.context.container==null)return Le.warn(Te.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const i=this.createEvent("resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Le.warn(Te.TAG_NAME,"已取消调整");window.addEventListener("pointermove",Se(this,Ot)),window.addEventListener("pointerup",Se(this,qt))},Eo=function(t){const l=this.context;if(l==null)return;const s=l.position,o=this.normalizeScale(),a=l.container.getBoundingClientRect(),r=l.target.getBoundingClientRect();if(s&Wt.TOP){const u=Math.max((r.bottom-t.clientY)/o,Te.MIN_LENGTH);l.top=(r.bottom-a.top)/o-u,l.height=u}if(s&Wt.BOTTOM&&(l.height=Math.max((t.clientY-r.top)/o,Te.MIN_LENGTH)),s&Wt.LEFT){const u=Math.max((r.right-t.clientX)/o,Te.MIN_LENGTH);l.left=(r.right-a.left)/o-u,l.width=u}s&Wt.RIGHT&&(l.width=Math.max((t.clientX-r.left)/o,Te.MIN_LENGTH));const i=this.createEvent("resizing",l);this.dispatch(i).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},To=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("resizeend",l);this.dispatch(s).defaultPrevented||this.reset()},B(Te,"TAG_NAME","quickprint-resizeable"),B(Te,"MIN_LENGTH",12);let Un=Te;async function cd(n,e){if(await Promise.resolve(),e.indicatorElement==null){const r=document.createElement("div");r.className="quickprint-is-indicator",e.indicatorElement=r,document.body.appendChild(r)}const t=n.doc.useGrid,l=t?Nt(e.width):Math.round(e.width),s=t?Nt(e.height):Math.round(e.height),o=e.indicatorElement,a=e.target.getBoundingClientRect();o.style.display="block",o.style.left=a.left+"px",o.style.top=a.top-jl(e.element)+"px",o.textContent=`x:${e.top},y:${e.left},w:${l},h:${s}`}function ud(n){const e=new Un({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,Xe);if(s==null)return t.preventDefault();l.element=s}),e.on("resizing",t=>{const l=t.detail;l!=null&&(cd(n,l),gn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const s=l.element;s.setTop(l.top),s.setLeft(l.left),s.setWidth(l.width),s.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),gn.clean()}),n.onResizeStart=e.onResizeStart,e}function dd(n){function e(a){const r=document.activeElement,i=a.target;return r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r.isContentEditable===!0||i.closest(".quickprint-text-editor")!=null}function t(){const a=n.doc.firstPage;if(n.state.selectMode===fe.PAGE){const r=n.state.selectedPage;return r==null?a:n.doc.findPage(r)??a}if(n.state.selectMode===fe.ELEMENT){const r=n.getSelectedElements()[0];return r==null?a:r.page??a}return a}function l(a){if(!(e(a)||Ko()))switch(a.key){case"Delete":case"Backspace":return a.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(a.ctrlKey)return a.preventDefault(),n.history.redo();case"Z":case"z":if(a.ctrlKey)return a.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const r=n.getSelectedElements();if(r.length==0)return;a.preventDefault(),a.stopPropagation();const i=a.key==="ArrowUp"?-1:1,u=r.map(d=>d.setTop(d.top+i,!0)?d:null).filter(d=>d!=null);u.length>0&&n.replaceSnapshot("top",u);return}case"ArrowLeft":case"ArrowRight":{const r=n.getSelectedElements();if(r.length==0)return;a.preventDefault(),a.stopPropagation();const i=a.key==="ArrowLeft"?-1:1,u=r.map(d=>d.setLeft(d.left+i,!0)?d:null).filter(d=>d!=null);u.length>0&&n.replaceSnapshot("left",u);return}case"P":case"p":if(a.ctrlKey)return a.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(a.ctrlKey)return a.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(a.ctrlKey){a.preventDefault();const i=n.doc.pages.reduce((u,d)=>u.concat(d.children),[]);return n.multiSelectElements(i)}case"C":case"c":{const r=n.getSelectedElements();if(a.ctrlKey&&r.length>0)return a.preventDefault(),n.clipboard.writeElement(r)}case"V":case"v":if(a.ctrlKey)return n.clipboard.readElement().then(r=>{if(r.length==0)return;const i=t();for(const u of r)u.setLeft(u.left+8),u.setTop(u.top+8),i.append(u);n.createSnapshot()})}}function s(){window.addEventListener("keydown",l)}function o(){window.removeEventListener("keydown",l)}return{enable:s,disable:o}}const nn="openprint:element,";function fd(n){function e(){return navigator.clipboard.readText().catch(i=>(console.log(i),null))}function t(i){return navigator.clipboard.writeText(i).catch(u=>{console.log(u)})}async function l(){const i=await e();if(i==null||!i.startsWith(nn))return[];t("");const u=hn(Qo(i.slice(nn.length)),[]);return u.length===0?[]:u.map(d=>(delete d.id,pe.create(d))).sort(pe.sort)}function s(i){const u=`${nn}${Jo(JSON.stringify(i))}`;return t(u)}async function o(){const i=await e();return typeof i=="string"&&i.startsWith(nn)}function a(){}function r(i){}return{readElement:l,writeElement:s,hasElement:o,readStyle:a,writeStyle:r}}const So=Symbol();function pd(){return{panel:{left:!0,right:!0},scale:100,selectedType:fe.NONE,selectedPage:void 0,selectMode:st.SINGLE,selected:[]}}function md(n,e){const t=$e(pd()),l=rd(n),o={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:i,selectPage:m,selectElement:h,resetSelectedElement:E,deleteSelectedElement:b,multiSelectElements:c,zoomIn:w,zoomOut:y,toggleBackground:x,toggleElementPanel:R,toggleConfigPanel:T,getSelectedElements:u,getSelectedPage:d,cleanup:k,replaceSnapshot:v},a=ed(o),r=ud(o);o.shortcut=dd(o),o.createSnapshot=l.createSnapshot,o.clipboard=fd();function i(C){o.document.value=C,o.history.createSnapshot()}function u(){const C=t.selected;return C.length==0?[]:C.map(I=>o.doc.findElement(I)).filter(I=>I!=null)}function d(){var I;const C=t.selectedPage;if(C!=null)return(I=n.value)==null?void 0:I.findPage(C)}function m(C){return E(),t.selectedPage=C.id,t.selectedType=fe.PAGE,!0}function h(C){t.selectMode=st.SINGLE,t.selectedType=fe.ELEMENT,t.selectedPage=void 0;const I=u();for(const q of I)q.id!==C.id&&q.blur();return C.focus(),t.selected=[C.id],!0}function E(){const C=u();for(const I of C)I.blur();return t.selected=[],t.selectedType=fe.NONE,!0}function b(){if(t.selectedType!=fe.ELEMENT||t.selected.length==0)return!1;let C=!1;const I=u();for(const q of I)q.remove()&&(C=!0);return C&&o.history.createSnapshot(),!0}function c(C){t.selectMode=st.MULTIPLE,t.selectedType=fe.ELEMENT,t.selectedPage=void 0;const I=u();for(const q of I)q.blur();for(const q of C)q.focus();return t.selected=C.map(q=>q.id),!0}function y(){const C=t.scale??100,I=Ut.indexOf(C);return I<0?(t.scale=100,!1):I>=Ut.length-1?!1:(t.scale=Ut[I+1],!0)}function w(){const C=t.scale??100,I=Ut.indexOf(C);return I<0?(t.scale=100,!1):I==0?!1:(t.scale=Ut[I-1],!0)}function x(){const I=o.doc.attributes.grid==null?!0:void 0;o.doc.attributes.grid=I}function R(){o.state.panel.left=!o.state.panel.left}function T(){o.state.panel.right=!o.state.panel.right}function v(C,I){const q=I??o.doc,W=Array.isArray(q)?"element":q instanceof ve?"document":q instanceof Tt?"page":"element",G=Array.isArray(q)?q.map(j=>j.id).join(","):q.id,O=`${W}:${G}:${C}`;return l.replaceSnapshot({action:O})}function k(){a.cleanup(),r.cleanup(),l.cleanup(),o.shortcut.disable(),o.doc.cleanup()}return o.shortcut.enable(),o.selectPage(n.value.firstPage),Bl(So,o),Jn(k),o}function Ee(){return Vl(So)}const hd=$({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Ie("classes"),l=Ee(),s=N(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),o=N(()=>{const c=e.page.id,y=l.doc.pages.find(w=>w.id===c);return y==null?0:e.direction=="horizontal"?y.width:y.height}),a=N(()=>{const c=o.value,y=[];for(let w=0;w<=c;w+=10)y.push(w/10);return y}),r=N(()=>{const c=o.value,y=[];for(let w=0;w<=c;w+=2.5)y.push(w);return y}),i=N(()=>{const c=l.getSelectedElements();return c.length==1?c[0]:null}),u=N(()=>e.direction==="horizontal"?{height:"100%",width:o.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:o.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),d=N(()=>{const c=i.value;if(c==null)return 0;if(c.type==="TableCell"){const y=c.parent;if(y==null)return 0;const w=y.parent;return y==null?0:w.top+y.offsetTop}if(c.type==="TableRow"){const y=c.parent;return y==null?0:y.top+c.offsetTop}return c.top}),m=N(()=>{const c=i.value;if(c==null)return 0;if(c.type==="TableCell"){const y=c.parent;if(y==null)return 0;const w=y.parent;return y==null?0:w.left+c.offsetLeft}if(c.type==="TableRow"){const y=c.parent;return y==null?0:y.left}return c.left});function h(c,y){return e.direction==="horizontal"?{left:c*(e.scale/100)+"mm",height:(y-2)%4==0?"8px":"4px"}:{top:c*(e.scale/100)+"mm",width:(y-2)%4==0?"8px":"4px"}}function E(c){return e.direction==="horizontal"?{left:c*(e.scale/100)+"cm"}:{top:c*(e.scale/100)+"cm"}}function b(c){return e.direction==="horizontal"?{left:m.value*(e.scale/100)+"px",width:c.width*(e.scale/100)+"px",height:"100%"}:{top:d.value*(e.scale/100)+"px",height:c.height*(e.scale/100)+"px",width:"100%"}}return(c,y)=>(S(),L("div",{class:g(s.value)},[f("div",{class:g(_(t).ruler),style:K(u.value)},[i.value?(S(),L("div",{key:0,class:g(_(t).selected),style:K(b(i.value))},null,6)):z("",!0),(S(!0),L(X,null,ie(r.value,(w,x)=>(S(),L("div",{key:w,class:g(_(t).scale),style:K(h(w,x))},null,6))),128)),(S(!0),L(X,null,ie(a.value,w=>(S(),L("div",{class:g(_(t).number),style:K(E(w))},H(w),7))),256))],6)],2))}}),gd="_horizontalRuler_170u5_2",vd="_verticalRuler_170u5_15",bd="_ruler_170u5_27",yd="_scale_170u5_32",_d="_number_170u5_46",Ed="_selected_170u5_71",Td={horizontalRuler:gd,verticalRuler:vd,ruler:bd,scale:yd,number:_d,selected:Ed},Sd={classes:Td},Ll=V(hd,[["__cssModules",Sd]]),wd=["title"],ln=8,kd=$({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,s=Ie("classes"),o={},a=Ee(),r=N(()=>({top:Math.round(t.top*t.zoom)+"px"}));function i(h){if(h.button!=0||t.disabled===!0)return;const E=h.target.closest("."+s.dragLine);E!=null&&(h.stopPropagation(),o.init=!1,o.target=E,o.parent=E.offsetParent,o.target.setPointerCapture(h.pointerId),window.addEventListener("pointermove",u),window.addEventListener("pointerup",d))}function u(h){h.preventDefault();const E=m(o.parent);let b=h.clientY-E.top;b<0&&(b=0),b>E.height&&(b=E.height),t.min>0&&b<t.min+ln&&(b=t.min+ln),t.max>0&&b>t.max-ln&&(b=t.max-ln),o.target.style.top=b/(a.state.scale/100)+"px",o.top=b,o.init=!0}function d(h){o.init===!0&&l("move",{top:o.top/(a.state.scale/100)}),o.target.releasePointerCapture(h.pointerId),window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",d)}function m(h){return h instanceof HTMLElement?h.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(h,E)=>(S(),L("div",{class:g({[_(s).dragLine]:!0,[_(s).disabled]:n.disabled}),style:K(r.value),onPointerdown:oe(i,["stop"]),title:n.title},null,46,wd))}}),Cd="_dragLine_1m7rt_2",Rd="_disabled_1m7rt_26",Ld={dragLine:Cd,disabled:Rd},Nd={classes:Ld},Nl=V(kd,[["__cssModules",Nd]]),Id=$({__name:"Selection",setup(n,{expose:e}){const t=ue(),l=ue(),s=Vt("selectionRef"),o=ue(),a=Ee();let r=[];function i(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function u(){const b=[],c=l.value;if(c==null)return b;const y=d(c);if(y.length==0)return b;const w=s.value;return y.forEach(x=>{if(!Cs(x,w)){x.classList.remove(U.SELECTED);return}const R=Reflect.get(x,Xe);R instanceof pe&&(x.classList.add(U.SELECTED),b.push(R))}),b}function d(b){if(b.matches("."+U.ELEMENT)){const c=Reflect.get(b,Xe);if(c&&c.type===Y.TABLE)return b.querySelectorAll(":scope td")}return b.querySelectorAll(`:scope .${U.PAGE} > .${U.SELECTABLE}`)}function m(b,c){const y=c.closest("."+U.PAPER);if(y==null)return;b.stopPropagation(),b.preventDefault();const w=i(),x=y.getBoundingClientRect();w.initialX=b.clientX,w.initialY=b.clientY,w.top=b.clientY-x.top,w.left=b.clientX-x.left,l.value=c,o.value=w,t.value=y,r=[],window.addEventListener("pointermove",h),window.addEventListener("pointerup",E)}function h(b){const c=o.value;if(c==null)return;b.stopPropagation(),b.preventDefault();const y=s.value;if(c.init!==!0){if(Math.abs(b.clientX-c.initialX)<4&&Math.abs(b.clientY-c.initialY)<4)return;y.setPointerCapture(b.pointerId),y.style.display="block",c.init=!0}const w=Math.abs(b.clientX-c.initialX),x=Math.abs(b.clientY-c.initialY),R=b.clientX<c.initialX?-w:0,T=b.clientY<c.initialY?-x:0;y.style.top=c.top+T+"px",y.style.left=c.left+R+"px",y.style.width=w+"px",y.style.height=x+"px",r=u()}function E(b){const c=o.value;if(c==null)return;c.init&&(b.stopPropagation(),b.preventDefault()),r.length>0&&a.multiSelectElements(r);const y=s.value;y.releasePointerCapture(b.pointerId),y.style.display="none",o.value=void 0,window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",E)}return e({onSelectStart:m}),(b,c)=>(S(),L("div",{ref_key:"selectionRef",ref:s,class:g(b.classes.selection),onClick:c[0]||(c[0]=oe(()=>{},["stop"]))},null,2))}}),xd="_selection_10jfe_2",Ad={selection:xd},Dd={classes:Ad},$d=V(Id,[["__cssModules",Dd]]),Od={class:"quickprint-is-row"},qd=["onClick"],Md=$({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Ie("classes"),s=e,o=n,a=ue(),r=N(()=>({height:o.height})),i=N({get(){return We(o.modelValue).num??void 0},set(b){if(b==""||es(b)||b<0){m(void 0);return}const c=We(o.modelValue);m(`${b}${c.unit}`)}}),u=N({get(){return We(o.modelValue).unit??Ce.PX},set(b){const c=We(o.modelValue);m(`${c.num}${b}`)}});function d(b){const c=b===be.DEFAULT?void 0:b;s("update:modelValue",c)}function m(b){s("update:modelValue",b),E()}function h(b){const c=o.modelValue;return c==null&&b.value===be.DEFAULT?!0:c===b.value}async function E(){await Pt();const b=document.querySelector("."+l.fontSelected);b&&b.scrollIntoView({block:"nearest"})}return(b,c)=>(S(),L("div",{class:g(_(l).fontSize),style:K(r.value)},[f("div",Od,[_e(f("input",{type:"number",placeholder:"请输入",class:g(["quickprint-form-control",_(l).input]),min:0,"onUpdate:modelValue":c[0]||(c[0]=y=>i.value=y)},null,2),[[Ne,i.value]]),p(_(J),{width:"54px",options:t,modelValue:u.value,"onUpdate:modelValue":c[1]||(c[1]=y=>u.value=y)},null,8,["modelValue"])]),f("div",{class:g(["quickprint-is-fill-h quickprint-is-scrollable",_(l).fonts]),ref_key:"scrollRef",ref:a},[(S(!0),L(X,null,ie(_(rl),y=>(S(),L("div",{key:y.value,class:g({[_(l).option]:!0,[_(l).fontSelected]:h(y)}),onClick:w=>d(y.value)},[f("span",null,H(y.label),1)],10,qd))),128))],2)],6))}}),Pd="_input_9oh9n_2",Vd="_fontSize_9oh9n_8",Bd="_fonts_9oh9n_13",Fd="_option_9oh9n_25",zd="_fontSelected_9oh9n_34",Ud={input:Pd,fontSize:Vd,fonts:Bd,option:Fd,fontSelected:zd},Hd={classes:Ud},wo=V(Md,[["__cssModules",Hd]]),Gd=["title"],Wd={key:0},Yd="中文字体 AbBbCc",Xd=$({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=N(()=>Cn.map(c=>(c.style={fontFamily:c.value==le.DEFAULT?le.SONG:c.value},c))),l=N(()=>go.map(c=>(c.style={fontFamily:c.value==le.DEFAULT?le.SONG:c.value},c))),s=N({get(){const c=e.options.style.fontFamily;return ae(c)?le.DEFAULT:c},set(c){e.options.style.fontFamily=c==le.DEFAULT?void 0:c}}),o=N({get(){const c=e.options.style.enFontFamily;return ae(c)?le.DEFAULT:c},set(c){e.options.style.enFontFamily=c==le.DEFAULT?void 0:c}}),a=N({get(){const c=e.options.style.color;return ae(c)?ke.DEFAULT:c},set(c){e.options.style.color=c==ke.DEFAULT?void 0:c}}),r=N({get(){const c=e.options.style.highlightColor;return ae(c)?ke.DEFAULT:c},set(c){e.options.style.highlightColor=c==ke.DEFAULT?void 0:c}}),i=N({get(){return e.options.style.fontSize},set(c){const y=ae(c)?void 0:c;e.options.style.fontSize=y}}),u=N({get(){return e.options.style.fontWeight===700},set(c){e.options.style.fontWeight=c?700:void 0}}),d=N({get(){return e.options.style.fontStyle==="italic"},set(c){e.options.style.fontStyle=c?"italic":void 0}}),m=N({get(){return e.options.style.lineThrough===!0},set(c){e.options.style.lineThrough=c?!0:void 0}}),h=N({get(){const c=e.options.style.underline;if(c==null||c===!1)return sn.NONE;const y=e.options.style.underlineStyle;return ae(y)?Ct.SOLID:y},set(c){if(c===sn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=c}}),E=N({get(){const c=e.options.style.underlineColor;return ae(c)?ke.DEFAULT:c},set(c){e.options.style.underlineColor=c==ke.DEFAULT?void 0:c}}),b=N(()=>{const c=e.options.style,y={},w=nl(c.fontFamily,c.enFontFamily);w&&(y.fontFamily=w);const x=no(c);return x&&Ke(y,x),c.fontSize&&(y.fontSize=c.fontSize),c.fontWeight&&(y.fontWeight=c.fontWeight),c.color&&(y.color=c.color),c.fontStyle&&(y.fontStyle=c.fontStyle),c.highlightColor&&(y["--quickprint-variable-highlight-color"]=c.highlightColor),y});return(c,y)=>(S(),L("div",{class:g(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.font])},[f("div",{class:g(c.classes.fontFamily)},[f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"中文字体",2),f("div",{class:g(c.classes.content)},[p(_(J),{options:t.value,modelValue:s.value,"onUpdate:modelValue":y[0]||(y[0]=w=>s.value=w)},null,8,["options","modelValue"])],2)],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"颜色",2),p(lt,{modelValue:a.value,"onUpdate:modelValue":y[1]||(y[1]=w=>a.value=w)},{default:ge(()=>[f("div",{class:g(c.classes.indicator)},[f("div",{class:g({[c.classes.colorBlock]:!0,[c.classes.colorNone]:a.value===_(ke).DEFAULT}),style:K({backgroundColor:a.value})},null,6),f("div",{class:g(c.classes.colorValue)},H(a.value==_(ke).DEFAULT?"默认":a.value),3)],2)]),_:1},8,["modelValue"])],2),f("div",{class:g([c.classes.config,c.classes.fontSize])},[f("div",{class:g(c.classes.title)},"字号",2),p(wo,{modelValue:i.value,"onUpdate:modelValue":y[2]||(y[2]=w=>i.value=w),height:"144px"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"西文字体",2),f("div",{class:g(c.classes.content)},[p(_(J),{options:l.value,modelValue:o.value,"onUpdate:modelValue":y[3]||(y[3]=w=>o.value=w)},null,8,["options","modelValue"])],2)],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"前景色",2),p(lt,{modelValue:r.value,"onUpdate:modelValue":y[4]||(y[4]=w=>r.value=w)},{default:ge(()=>[f("div",{class:g(c.classes.indicator)},[f("div",{class:g({[c.classes.colorBlock]:!0,[c.classes.colorNone]:r.value===_(ke).DEFAULT}),style:K({backgroundColor:r.value})},null,6),f("div",{class:g(c.classes.colorValue)},H(r.value==_(ke).DEFAULT?"默认":r.value),3)],2)]),_:1},8,["modelValue"])],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"下划线",2),f("div",{class:g(c.classes.content)},[p(_(J),{modelValue:h.value,"onUpdate:modelValue":y[5]||(y[5]=w=>h.value=w),options:_(Tu),width:"138px"},{option:ge(({option:w})=>[f("div",{title:w.label,class:g(c.classes.option)},[w.value==_(sn).NONE?(S(),L("div",Wd,H(w.label),1)):(S(),L("div",{key:1,class:g(c.classes.line),style:K({textDecorationStyle:w.value})},"--",6))],10,Gd)]),_:1},8,["modelValue","options"])],2)],2),f("div",{class:g(c.classes.config)},[f("div",{class:g(c.classes.title)},"线条颜色",2),f("div",{class:g(c.classes.content)},[p(lt,{modelValue:E.value,"onUpdate:modelValue":y[6]||(y[6]=w=>E.value=w),class:"quickprint-w-full"},{default:ge(()=>[f("div",{class:g(c.classes.indicator)},[f("div",{class:g({[c.classes.colorBlock]:!0,[c.classes.colorNone]:E.value===_(ke).DEFAULT}),style:K({backgroundColor:E.value})},null,6),f("div",{class:g(c.classes.colorValue)},H(E.value==_(ke).DEFAULT?"默认":E.value),3)],2)]),_:1},8,["modelValue"])],2)],2)],2),f("div",{class:g(c.classes.fieldset)},[y[13]||(y[13]=f("header",null,"效果",-1)),f("div",{class:g(c.classes.configs)},[f("label",{class:g(c.classes.checkbox)},[_e(f("input",{type:"checkbox","onUpdate:modelValue":y[7]||(y[7]=w=>u.value=w)},null,512),[[Dn,u.value]]),y[10]||(y[10]=f("span",null,"粗体",-1))],2),f("label",{class:g(c.classes.checkbox)},[_e(f("input",{type:"checkbox","onUpdate:modelValue":y[8]||(y[8]=w=>d.value=w)},null,512),[[Dn,d.value]]),y[11]||(y[11]=f("span",null,"斜体",-1))],2),f("label",{class:g(c.classes.checkbox)},[_e(f("input",{type:"checkbox","onUpdate:modelValue":y[9]||(y[9]=w=>m.value=w)},null,512),[[Dn,m.value]]),y[12]||(y[12]=f("span",null,"删除线",-1))],2)],2)],2),f("div",{class:g(c.classes.fieldset)},[y[14]||(y[14]=f("header",null,"预览",-1)),f("div",{class:g(c.classes.preview)},[f("span",{style:K(b.value)},[f("span",{class:g({[c.classes.lineThrough]:n.options.style.lineThrough})},H(Yd),2)],4)],2)],2)],2))}}),jd="_font_16792_2",Zd="_fontFamily_16792_7",Kd="_config_16792_14",Jd="_fontSize_16792_19",Qd="_fieldset_16792_23",ef="_title_16792_39",tf="_content_16792_44",nf="_indicator_16792_49",lf="_colorBlock_16792_69",of="_colorValue_16792_80",sf="_colorNone_16792_87",rf="_configs_16792_98",af="_checkbox_16792_104",cf="_option_16792_119",uf="_line_16792_127",df="_preview_16792_138",ff="_lineThrough_16792_153",pf={font:jd,fontFamily:Zd,config:Kd,fontSize:Jd,fieldset:Qd,title:ef,content:tf,indicator:nf,colorBlock:lf,colorValue:of,colorNone:sf,configs:rf,checkbox:af,option:cf,line:uf,preview:df,lineThrough:ff},mf={classes:pf},hf=V(Xd,[["__cssModules",mf]]),gf=["placeholder","min"],vf=$({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,s=N(()=>{const i=l.defaultUnit;return l.options.some(u=>u.value===i)?i:l.options[0].value}),o=N({get(){return We(l.modelValue).num},set(i){if(Yn(i)){const d=We(l.modelValue).unit??s.value;return r(`${i}${d}`)}r()}}),a=N({get(){return We(l.modelValue).unit??s.value},set(i){const d=We(l.modelValue).num??l.min;r(`${d}${i}`)}});function r(i=void 0){t("update:modelValue",i)}return(i,u)=>(S(),L("div",{class:g(i.classes.input)},[_e(f("input",{type:"number","onUpdate:modelValue":u[0]||(u[0]=d=>o.value=d),class:"quickprint-form-control",placeholder:n.placeholder,min:n.min},null,8,gf),[[Ne,o.value]]),p(_(J),{modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=d=>a.value=d),class:g(i.classes.unit),options:n.options,width:"auto",border:"none"},null,8,["modelValue","class","options"])],2))}}),bf="_input_gtdaq_2",yf="_unit_gtdaq_14",_f={input:bf,unit:yf},Ef={classes:_f},mt=V(vf,[["__cssModules",Ef]]),Tf="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",Sf=$({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Ce.NONE},{label:"磅",value:Ce.PT},{label:"像素",value:Ce.PX}],l=[{label:"字符",value:Ce.EM},{label:"磅",value:Ce.PT},{label:"像素",value:Ce.PX}],s=[{label:"毫米",value:Ce.MM},{label:"磅",value:Ce.PT},{label:"像素",value:Ce.PX}],o=N({get(){return e.options.style.textAlign??tt.LEFT},set(c){const y=c===tt.LEFT?void 0:c;e.options.style.textAlign=y}}),a=N({get(){return e.options.style.textAlignLast??gt.AUTO},set(c){const y=c===gt.AUTO?void 0:c;e.options.style.textAlignLast=y}}),r=N({get(){return e.options.style.verticalAlign??Ye.MIDDLE},set(c){const y=c===Ye.MIDDLE?void 0:c;e.options.style.verticalAlign=y}}),i=b("top"),u=b("bottom"),d=b("left"),m=b("right"),h=N(()=>{const c=e.options.style,y={};return c.textAlign&&(y.textAlign=c.textAlign),c.textAlignLast&&(y.textAlignLast=c.textAlignLast),c.textIndent&&(y.textIndent=c.textIndent),c.lineHeight&&(y.lineHeight=c.lineHeight),Ke(y,oo(c.verticalAlign)),y}),E=N(()=>{var w,x,R,T;const c=e.options.style,y={};return y["--openprint-paragraph-preview-padding-top"]=((w=c.padding)==null?void 0:w.top)??"2px",y["--openprint-paragraph-preview-padding-right"]=((x=c.padding)==null?void 0:x.right)??"2px",y["--openprint-paragraph-preview-padding-bottom"]=((R=c.padding)==null?void 0:R.bottom)??"2px",y["--openprint-paragraph-preview-padding-left"]=((T=c.padding)==null?void 0:T.left)??"2px",y});function b(c){return N({get(){var y;return(y=e.options.style.padding)==null?void 0:y[c]},set(y){e.options.style.padding==null&&(e.options.style.padding={});const w=ae(y)?void 0:y;e.options.style.padding[c]=w}})}return(c,y)=>(S(),L("div",{class:g(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.paragraph])},[f("div",{class:g(c.classes.textAlign)},[f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"文本对齐",2),p(_(J),{options:_(Fn),modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=w=>o.value=w)},null,8,["options","modelValue"])],2),f("div",{class:g(c.classes.alignLast)},[f("div",{class:g(c.classes.configItemLabel)},"最后一行",2),p(_(J),{options:_(Su),modelValue:a.value,"onUpdate:modelValue":y[1]||(y[1]=w=>a.value=w)},null,8,["options","modelValue"])],2)],2),f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"垂直对齐",2),p(_(J),{options:_(Bn),modelValue:r.value,"onUpdate:modelValue":y[2]||(y[2]=w=>r.value=w)},null,8,["options","modelValue"])],2),f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"首行缩进",2),p(mt,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":y[3]||(y[3]=w=>n.options.style.textIndent=w),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.configItem)},[f("div",{class:g(c.classes.configItemLabel)},"行高",2),p(mt,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":y[4]||(y[4]=w=>n.options.style.lineHeight=w),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.fieldset)},[y[9]||(y[9]=f("header",null,"内边距",-1)),f("div",{class:g(c.classes.padding)},[f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"上边距",2),p(mt,{modelValue:_(i),"onUpdate:modelValue":y[5]||(y[5]=w=>Ge(i)?i.value=w:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"下边距",2),p(mt,{modelValue:_(u),"onUpdate:modelValue":y[6]||(y[6]=w=>Ge(u)?u.value=w:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"左边距",2),p(mt,{modelValue:_(d),"onUpdate:modelValue":y[7]||(y[7]=w=>Ge(d)?d.value=w:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:g(c.classes.paddingItem)},[f("label",{class:g(c.classes.paddingItemLabel)},"右边距",2),p(mt,{modelValue:_(m),"onUpdate:modelValue":y[8]||(y[8]=w=>Ge(m)?m.value=w:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),f("div",{class:g(c.classes.fieldset)},[y[10]||(y[10]=f("header",null,"预览",-1)),f("div",{class:g(c.classes.preview),style:K(h.value)},[f("div",{style:K(E.value),class:g(c.classes.previewText)},[ne(H(Tf)+" "),f("div",{class:g(c.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),wf="_paragraph_1ex97_2",kf="_fieldset_1ex97_7",Cf="_preview_1ex97_23",Rf="_textAlign_1ex97_34 quickprint-is-row",Lf="_configItem_1ex97_39 quickprint-is-row",Nf="_alignLast_1ex97_44 quickprint-is-row",If="_configItemLabel_1ex97_54",xf="_padding_1ex97_59",Af="_paddingItem_1ex97_66",Df="_paddingItemLabel_1ex97_72",$f="_previewText_1ex97_77",Of="_paddingPreview_1ex97_86",qf={paragraph:wf,fieldset:kf,preview:Cf,textAlign:Rf,configItem:Lf,alignLast:Nf,configItemLabel:If,padding:xf,paddingItem:Af,paddingItemLabel:Df,previewText:$f,paddingPreview:Of},Mf={classes:qf},Pf=V(Sf,[["__cssModules",Mf]]),Vf=["onClick"],Bf=$({__name:"Tabs",props:{active:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["switch"],setup(n,{emit:e}){const t=e;function l(s){t("switch",s)}return(s,o)=>(S(),L("div",{class:g(s.classes.tabs)},[(S(!0),L(X,null,ie(n.tabs,a=>(S(),L("div",{key:a.value,class:g({[s.classes.tab]:!0,[s.classes.active]:n.active===a.value}),onClick:r=>l(a),onPointerdown:o[0]||(o[0]=oe(()=>{},["stop","prevent"]))},[f("span",null,H(a.label),1)],42,Vf))),128))],2))}}),Ff="_tabs_109u2_2",zf="_tab_109u2_2",Uf="_active_109u2_41",Hf={tabs:Ff,tab:zf,active:Uf},Gf={classes:Hf},ko=V(Bf,[["__cssModules",Gf]]),Wf=$({__name:"index",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=Pe(),l=se("font"),s=[{label:"字体",value:"font"},{label:"段落",value:"paragraph"}];function o(i){l.value=i.value}function a(){t==null||t.confirm(e.options)}function r(){t==null||t.cancel()}return(i,u)=>(S(),L("div",{class:g(i.classes.setting)},[f("div",{class:g(i.classes.header)},[f("div",{class:g(i.classes.headerLeft)},[p(_(D),{icon:"icon-setting",size:"14px"}),f("span",{class:g(i.classes.title)},"元素",2),p(ko,{tabs:s,active:l.value,onSwitch:o},null,8,["active"])],2),_(t)?(S(),Z(_(jn),{key:0,instance:_(t)},null,8,["instance"])):z("",!0)],2),l.value==="font"?(S(),Z(hf,{key:0,options:e.options},null,8,["options"])):z("",!0),l.value==="paragraph"?(S(),Z(Pf,{key:1,options:e.options},null,8,["options"])):z("",!0),f("div",{class:g(i.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:a},"确定")],2)],2))}}),Yf="_setting_16zk2_2",Xf="_header_16zk2_10",jf="_headerLeft_16zk2_22",Zf="_title_16zk2_35",Kf="_tabs_16zk2_42",Jf="_footer_16zk2_47",Qf={setting:Yf,header:Xf,headerLeft:jf,title:Zf,tabs:Kf,footer:Jf},ep={classes:Qf},tp=V(Wf,[["__cssModules",ep]]);function np(n){return $e({style:ql(n.style??{})})}function lp(n,e){n.style=Object.assign({},n.style,e.style)}const op=Ve(function(n){return Kt("元素设置",p(tp,{options:np(n)},null),{preset:"setting"}).promisify().then(e=>lp(n,e)).catch(Oe)});function sp(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){op(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},fo(t,e.element)),Kn.open(n.clientX,n.clientY,{menus:l})}const ip=$({props:{element:{type:pe,required:!0}},setup(n){const e=Ie("classes"),t=Ee(),l=N(()=>{const m=n.element;m.state.key;const h={"--quickprint-element-top":m.top+"px","--quickprint-element-left":m.left+"px","--quickprint-element-width":m.width+"px","--quickprint-element-height":m.height+"px","z-index":m.zIndex};return a()&&(h.transform=`rotate(${m.style.rotate}deg)`),h}),s={TOP:[e.resizeTop,Rt.TOP],BOTTOM:[e.resizeBottom,Rt.BOTTOM],LEFT:[e.resizeLeft,Rt.LEFT],RIGHT:[e.resizeRight,Rt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Rt.BOTTOM_RIGHT]},o=[s.TOP,s.BOTTOM,s.LEFT,s.RIGHT,s.BOTTOM_RIGHT];function a(){const m=n.element;return m.style.rotate==0||m.style.rotate==null?!1:t.state.selectMode===st.SINGLE?!m.isSelected:!0}function r(m){const h=Bu(m.type);if(h==null)return p("div",{class:e.unknown},[p("span",null,[ne("未知的打印元素")])]);const E={element:m,key:m.id+"_"+m.state.key};return Uu(m.type)?(E.onContextmenu=u,ot(h,E)):ot(h,E)}function i(m,h){h.stopPropagation();const E=h.target.closest("."+U.ELEMENT);E&&Reflect.get(E,bn)===tl.DRAG_ELEMENT||t.selectElement(m)}function u(m){m.stopPropagation(),m.preventDefault(),sp(m,n,t)}function d(){return!Hu(n.element.type)||a()?null:o.map(m=>{const h={class:[U.RESIZEABLE_INDICATOR,m[0]],["."+Hl]:m[1]};return p("div",ds(h,{onPointerdown:t.onResizeStart}),null)})}return function(){const m=n.element,h={["."+Xe]:m,["."+el]:m.type,key:m.id,class:{[U.ELEMENT]:!0,[U.DRAGGABLE]:!0,[U.RESIZEABLE]:!0,[U.SELECTED]:m.state.selected,[U.SELECTABLE]:zu(m.type),["quickprint-is-"+m.type.toLowerCase()]:!0},style:l.value,onClick:i.bind(null,m)};return p("div",h,[r(m),d()])}}}),rp="_unknown_za8zh_2",ap="_resizeTop_za8zh_12",cp="_resizeBottom_za8zh_20",up="_resizeLeft_za8zh_28",dp="_resizeRight_za8zh_36",fp="_resizeBottomRight_za8zh_44",pp={unknown:rp,resizeTop:ap,resizeBottom:cp,resizeLeft:up,resizeRight:dp,resizeBottomRight:fp},mp={classes:pp},hp=V(ip,[["__cssModules",mp]]),Co=Dl(()=>$l(()=>import("./component-CWbnBpag.js"),__vite__mapDeps([3,4,1,5,6]))),gp=$({__name:"DocJson",props:{doc:{type:ve,required:!0}},setup(n){const e=n,t=Pe(),l=se(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(s,o)=>(S(),Z(_(Co),{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=a=>l.value=a),language:"json",class:g(s.classes.json)},null,8,["modelValue","class"]))}}),vp="_json_9crpe_2",bp={json:vp},yp={classes:bp},_p=V(gp,[["__cssModules",yp]]),Ep=Ve(function(n){return Et("调试",p(_p,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(et)});async function Tp(n,e,t){const l=[];await t.clipboard.hasElement()&&l.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const o=n.target.closest("."+U.PAGE);if(o==null)return;const a=await t.clipboard.readElement();if(a.length==0)return;const r=o.getBoundingClientRect(),i=n.clientX-r.left-a[0].left,u=n.clientY-r.top-a[0].top;for(const d of a)d.setLeft(d.left+i),d.setTop(d.top+u),e.page.append(d);t.createSnapshot()}});const s=t.getSelectedElements();s.length>0&&l.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),l.length>0&&l.push({type:"divider"}),l.push({type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const o=e.page.children??[];t.multiSelectElements(o)}},{type:"divider"},{type:"menu",label:"调试",icon:"icon-bug",handler(){Ep(t).then(o=>{if(o==null)return;const a=ve.create(o);t.setDocument(a)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),Kn.open(n.clientX,n.clientY,{menus:l})}const Sp=$({props:{doc:{type:ve,required:!0},page:{type:Tt,required:!0}},setup(n){const e=Ie("classes"),t=Ee(),l=Vt("selectionRef"),s=Vt("paperRef"),o=se(0),a=N(()=>n.page.width),r=N(()=>n.page.height);function i(x){x.stopPropagation();const R=x.target.closest("."+U.PAPER);R&&Reflect.get(R,bn)===tl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function u(){if(n.page.header.display===!1)return null;const x=n.page.header.height,R="page_header_"+o.value;return p(Nl,{title:"页眉",top:x,onMove:m,key:R},null)}function d(){if(n.page.footer.display===!1)return null;const x=Mt(r.value)-n.page.footer.height,R="page_footer_"+o.value;return p(Nl,{title:"页脚",top:x,onMove:h,key:R},null)}function m(x){n.page.setHeaderHeight(x.top),o.value++}function h(x){n.page.setFooterHeight(Mt(r.value)-x.top),o.value++}function E(x){x.stopPropagation(),x.preventDefault(),Tp(x,n,t)}function b(){const x=n.doc.margins;if(x==null)return null;const R=[];return x.top&&R.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:x.top+"px"}},null)),x.bottom&&R.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:x.bottom+"px"}},null)),x.left&&R.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:x.left+"px"}},null)),x.right&&R.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:x.right+"px"}},null)),R.length>0?R:null}function c(){const x={["."+Ul]:n.page,key:n.page.id,style:{width:a.value+"mm",height:r.value+"mm"},class:{[U.PAGE]:!0,[U.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:E},R=n.page.children.map(T=>p(hp,{element:T},null));return p("div",x,[u(),R,d(),b()])}function y(x){if(x.button!==0)return;x.stopPropagation(),x.preventDefault();const T=x.target.closest("."+U.ELEMENT);if(T==null)return w(x,s.value);const v=Reflect.get(T,Xe);return v==null?w(x,s.value):v.type===Y.TABLE?w(x,T):Gu(v.type)?t.onDragStart(x):w(x,s.value)}function w(x,R){var T;(T=l.value)==null||T.onSelectStart(x,R)}return function(){const x=t.state.scale/100,R={id:"@"+n.page.id,ref:"paperRef",class:{[U.PAPER]:!0,[U.SELECTED]:t.state.selectedPage===n.page.id},style:{width:a.value*x+"mm",height:r.value*x+"mm"},onPointerdown:y,onClick:i};return p("div",R,[c(),p($d,{ref:"selectionRef"},null)])}}}),wp="_paper_fdphx_2",kp="_grid_fdphx_12",Cp="_marginHorizontalGuide_fdphx_21",Rp="_marginVerticalGuide_fdphx_29",Lp={paper:wp,grid:kp,marginHorizontalGuide:Cp,marginVerticalGuide:Rp},Np={classes:Lp},Ip=V(Sp,[["__cssModules",Np]]),xp={class:"quickprint-is-fill-h quickprint-is-scrollable"},Ap="icon-zhanweifu",Dp=$({__name:"Element",setup(n){const e=Ee();return(t,l)=>(S(),L("div",{class:g(t.classes.panel)},[f("div",{class:g(t.classes.header)},"可打印元素",2),f("div",xp,[f("div",{class:g(t.classes.grid)},[(S(!0),L(X,null,ie(_(qu),s=>(S(),L("div",Fl({key:s.type,class:[_(U).DRAGGABLE,t.classes.element],[`.${_(zl)||""}`]:_(Re).INSERT,[`.${_(el)||""}`]:s.type,onPointerdown:l[0]||(l[0]=(...o)=>_(e).onDragStart&&_(e).onDragStart(...o))}),[p(_(D),{icon:s.icon??Ap,size:"16px",class:g(t.classes.icon)},null,8,["icon","class"]),f("span",null,H(s.title),1)],48))),128))],2)])],2))}}),$p="_panel_1p36j_2",Op="_header_1p36j_8",qp="_grid_1p36j_18",Mp="_element_1p36j_30",Pp="_icon_1p36j_45",Vp={panel:$p,header:Op,grid:qp,element:Mp,icon:Pp},Bp={classes:Vp},Fp=V(Dp,[["__cssModules",Bp]]),zp=["onClick"],Up=$({__name:"SelectPath",setup(n){const e=Ee(),t=N(()=>{const o=e.state,a=[{id:e.doc.id,title:"文档",type:"document"}];if(o.selectedType===fe.PAGE){const r=e.getSelectedPage();if(r!=null){const i="页面"+(r.index+1);a.push({id:r.id,title:i,type:"page",data:r})}return a}if(o.selectedType===fe.ELEMENT){if(o.selectMode===st.MULTIPLE){const u=e.getSelectedElements();if(u.length===0)return a;let d=u[0];for(;d.parent;){const m=d.parent;if(m instanceof Tt){const h="页面"+(m.index+1);return a.push({id:m.id,title:h,type:"page",data:m}),a}d=m}return a}let r=e.getSelectedElements()[0];if(r==null)return a;const i=[{id:r.id,title:Zt(r.type),type:"element",data:r}];for(;r.parent;){const u=r.parent;if(u instanceof Tt){const d="页面"+(u.index+1);return i.unshift({id:u.id,title:d,type:"page",data:u}),a.concat(i)}i.unshift({id:u.id,title:Zt(u.type),type:"element",data:u}),r=u}}return a}),l=N(()=>{if(e.state.selectedType!=fe.ELEMENT)return;const a=e.getSelectedElements();if(a.length!=1)return;const r=a[0],i=ll(r,e.doc.ds);if(!(i==null||!i.content))return i.type===ye.VARIABLE||i.type===ye.FORMULA?`[${i.content}]`:i.content});function s(o){if(o.type==="element")return e.selectElement(o.data);if(o.type==="page")return e.selectPage(o.data)}return(o,a)=>(S(),L("div",{class:g(o.classes.paths)},[(S(!0),L(X,null,ie(t.value,(r,i)=>(S(),L(X,{key:r.id},[i>0?(S(),Z(_(D),{key:0,class:g(o.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):z("",!0),f("div",{class:g(o.classes.path),onClick:u=>s(r)},H(r.title),11,zp)],64))),128)),l.value?(S(),L(X,{key:0},[p(_(D),{class:g(o.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),f("div",{class:g(o.classes.content)},H(l.value),3)],64)):z("",!0)],2))}}),Hp="_paths_fuk62_2",Gp="_path_fuk62_2",Wp="_icon_fuk62_28",Yp="_content_fuk62_33",Xp={paths:Hp,path:Gp,icon:Wp,content:Yp},jp={classes:Xp},Zp=V(Up,[["__cssModules",jp]]),Kp=["min","readonly","placeholder"],Jp=$({__name:"LabelNumber",props:St({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=Jt(n,"modelValue");function l(s){const a=s.target.value;if(t==null||a===""){const i=e.min?e.min:e.defaultValue;t.value=i;return}const r=Number(a);if(!Number.isNaN(r)&&(e.min!=null&&r<e.min&&(t.value=e.min),e.precision!=null)){const i=Math.pow(10,e.precision);t.value=Math.round(r*i)/i}}return(s,o)=>(S(),L("label",{class:g({[s.classes.labelNumber]:!0,[s.classes.readonly]:n.readonly})},[_e(f("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":o[0]||(o[0]=a=>t.value=a),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Kp),[[Ne,t.value]]),f("span",{class:g(s.classes.label)},H(n.label),3)],2))}}),Qp="_labelNumber_1aifb_2",em="_label_1aifb_2",tm="_readonly_1aifb_25",nm={labelNumber:Qp,label:em,readonly:tm},lm={classes:nm},xt=V(Jp,[["__cssModules",lm]]),om={class:"quickprint-config"},sm={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},im={class:"quickprint-config-group"},rm={class:"quickprint-config-section quickprint-config-inline"},am={class:"quickprint-config-content quickprint-config-inline"},cm={class:"quickprint-config-section quickprint-config-inline"},um={class:"quickprint-config-content quickprint-config-inline"},dm={class:"quickprint-config-section quickprint-config-inline"},fm={class:"quickprint-config-content quickprint-form-inline"},pm={key:0,class:"quickprint-config-section quickprint-config-inline"},mm={class:"quickprint-config-content quickprint-form-inline"},hm={class:"quickprint-config-section quickprint-config-inline"},gm={class:"quickprint-config-content quickprint-form-inline"},vm=$({__name:"PageConfig",props:{page:{type:Tt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=N({get(){return e.page.size.type},set(r){e.page.size.type=r,r===Xt.CONTENT&&(e.page.size.orientation=void 0)}}),s=N({get(){return e.page.orientation},set(r){e.page.size.orientation=r}}),o=N(()=>e.page.width),a=N({get(){return e.page.height},set(r){const i=Number(r);!Yn(i)||i<0||(e.page.size.height=i)}});return(r,i)=>(S(),L("div",om,[i[11]||(i[11]=f("div",{class:"quickprint-config-title"},"页面配置",-1)),f("div",sm,[f("div",im,[i[10]||(i[10]=f("div",{class:"quickprint-config-group-title"},"布局",-1)),f("section",rm,[i[5]||(i[5]=f("header",{class:"quickprint-config-header"},"页眉",-1)),f("div",am,[p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(It,{modelValue:n.page.header.display,"onUpdate:modelValue":i[0]||(i[0]=u=>n.page.header.display=u),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",cm,[i[6]||(i[6]=f("header",{class:"quickprint-config-header"},"页脚",-1)),f("div",um,[p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(It,{modelValue:n.page.footer.display,"onUpdate:modelValue":i[1]||(i[1]=u=>n.page.footer.display=u),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",dm,[i[7]||(i[7]=f("header",{class:"quickprint-config-header"},"尺寸",-1)),f("div",fm,[p(It,{modelValue:l.value,"onUpdate:modelValue":i[2]||(i[2]=u=>l.value=u),options:_(Es),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===_(Xt).CONTENT?(S(),L("section",pm,[i[8]||(i[8]=f("header",{class:"quickprint-config-header"},"内容",-1)),f("div",mm,[p(xt,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,readonly:""},null,8,["modelValue"]),p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:a.value,"onUpdate:modelValue":i[3]||(i[3]=u=>a.value=u)},null,8,["modelValue"])])])):z("",!0),f("section",hm,[i[9]||(i[9]=f("header",{class:"quickprint-config-header"},"方向",-1)),f("div",gm,[p(It,{modelValue:s.value,"onUpdate:modelValue":i[4]||(i[4]=u=>s.value=u),options:_(Yl),class:"quickprint-w-full",disabled:n.page.size.type===_(Xt).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),bm={},ym={class:"quickprint-config"};function _m(n,e){return S(),L("div",ym,e[0]||(e[0]=[f("div",{class:"quickprint-config-title"},"多选配置",-1),f("div",{class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},"TODO:",-1)]))}const Em=V(bm,[["render",_m]]),Tm=["value","placeholder"],Sm=$({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,s=Vt("inputRef"),o=N({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?dl(t.modelValue):t.standard==="mm"&&t.target==="px"?Mt(t.modelValue):0},set(d){if(t.standard===t.target)return l("update:modelValue",d);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Mt(d));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",dl(d))}}),a=N(()=>t.clearable&&o.value!=null);function r(d){const h=d.target.value;if(o==null||h===""){if(t.clearable)return;const b=t.min?t.min:t.defaultValue;o.value=b;return}const E=Number(h);if(!Number.isNaN(E)){if(t.min!=null&&E<t.min){o.value=t.min;return}if(t.standard==="px"){o.value=Math.round(E);return}o.value=E}}function i(){l("update:modelValue",void 0)}function u(){var d;(d=s.value)==null||d.blur(),setTimeout(()=>{var m;return(m=s.value)==null?void 0:m.focus()},50)}return(d,m)=>(S(),L("label",{class:g({[d.classes.inputUnit]:!0,[d.classes.withClear]:n.clearable})},[f("span",{class:g(d.classes.label)},H(n.label),3),f("input",{ref_key:"inputRef",ref:s,class:"quickprint-form-control",type:"number",value:o.value,placeholder:n.placeholder,onBlur:r,onKeydown:Pl(u,["enter"])},null,40,Tm),a.value?(S(),L("span",{key:0,class:g(d.classes.clearBtn),onClick:oe(i,["stop"])},[p(_(D),{icon:"icon-close",size:"11px"})],2)):z("",!0)],2))}}),wm="_inputUnit_2ymft_2",km="_clearBtn_2ymft_7",Cm="_label_2ymft_11",Rm="_withClear_2ymft_31",Lm={inputUnit:wm,clearBtn:km,label:Cm,withClear:Rm},Nm={classes:Lm},nt=V(Sm,[["__cssModules",Nm]]),Im=$({__name:"UnitSelect",props:St({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=Jt(n,"modelValue"),s=N(()=>{var o;return((o=e.find(a=>a.value===t.modelValue))==null?void 0:o.label)??t.modelValue});return(o,a)=>(S(),L("span",{class:g(o.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(_(J),{modelValue:l.value,"onUpdate:modelValue":a[0]||(a[0]=r=>l.value=r),options:e,class:g(o.classes.select),appearance:"none",border:"none"},{selected:ge(()=>[f("span",{class:g(o.classes.text)},H(s.value),3)]),_:1},8,["modelValue","class"])],2))}}),xm="_unit_135mn_2",Am="_text_135mn_8",Dm="_select_135mn_25",$m={unit:xm,text:Am,select:Dm},Om={classes:$m},Ro=V(Im,[["__cssModules",Om]]),qm=$({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=se(!1);function s(){t("copy",async function(a){await navigator.clipboard.writeText(a).catch(ts)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(o,a)=>(S(),L("button",{type:"button",class:g(["quickprint-text-btn",o.classes.btn]),title:"复制",onClick:s},[p(_(D),{icon:"icon-copy"}),p(fs,{name:"quickprint-fade"},{default:ge(()=>[l.value?(S(),L("span",{key:0,class:g(o.classes.message)},"已复制",2)):z("",!0)]),_:1})],2))}}),Mm="_btn_v9scw_2",Pm="_message_v9scw_6",Vm={btn:Mm,message:Pm},Bm={classes:Vm},Fm=V(qm,[["__cssModules",Bm]]),zm=$({__name:"window",props:{code:{type:String,default:""},doc:{type:ve,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=Pe(),l=se(e.code),s=ue();function o(){return l.value}function a(){e.doc!=null&&la({doc:e.doc}).then(m=>{var E;if(m==null)return;const h=m.type=="reference"?`[=${m.value}]`:`[${m.value}]`;(E=s.value)==null||E.insert(h)})}function r(m){var h;return it(m,(h=e.doc)==null?void 0:h.ds)}function i(){var m;(m=s.value)==null||m.insert(`[2.6.${Hn.ELEMENT_VALUR}]`)}function u(){oa().then(m=>{var h;m!=null&&((h=s.value)==null||h.insert(m.value))})}function d(){sa({doc:e.doc}).then(m=>{var h;m!=null&&((h=s.value)==null||h.insert(m.value))})}return t==null||t.useHandle("confirm",o),(m,h)=>(S(),L("div",{class:g(m.classes.window)},[n.mode!=="code"?(S(),L("div",{key:0,class:g(m.classes.toolbar)},[n.mode=="condition"?(S(),L(X,{key:0},[f("button",{type:"button",class:"quickprint-text-btn",onClick:i},[p(_(D),{icon:"icon-number-sign"}),h[1]||(h[1]=f("span",null,"插入元素值",-1))]),f("div",{class:g(m.classes.divider)},null,2)],64)):z("",!0),f("button",{type:"button",onClick:a,class:"quickprint-text-btn"},[p(_(D),{icon:"icon-insert-var"}),h[2]||(h[2]=f("span",null,"插入变量",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:u},[p(_(D),{icon:"icon-function"}),h[3]||(h[3]=f("span",null,"插入函数",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:d},[p(_(D),{icon:"icon-formula"}),h[4]||(h[4]=f("span",null,"插入公式",-1))])],2)):z("",!0),p(_(Co),{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=E=>l.value=E),language:"javascript",class:g(m.classes.code),formatVariable:r,autofocus:"",ref_key:"codeRef",ref:s},null,8,["modelValue","class"])],2))}}),Um="_window_n935p_2",Hm="_toolbar_n935p_11",Gm="_code_n935p_22",Wm="_divider_n935p_27",Ym={window:Um,toolbar:Hm,code:Gm,divider:Wm},Xm={classes:Ym},Lo=V(zm,[["__cssModules",Xm]]),No=Ve(function(n){return Et("公式",p(Lo,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Oe)}),jm=Ve(function(n,e){return Et(n,p(Lo,{code:e},null),{preset:"editor"}).promisify().catch(Oe)}),Zm={class:"quickprint-config-section quickprint-config-inline"},Km={class:"quickprint-config-content"},Jm=["value"],Qm=$({__name:"Visibility",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N({get(){var r;return((r=e.element.visibility)==null?void 0:r.type)??yt.VISIBLE},set(r){e.element.visibility==null&&(e.element.visibility={}),r!==yt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=r}}),l=N({get(){var r;return((r=e.element.visibility)==null?void 0:r.condition)??""},set(r){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=r}}),s=N(()=>{var r;return ol((r=e.element.visibility)==null?void 0:r.condition,e.element.doc)}),o=N(()=>{var r;return t.value!==yt.CONDITION?!1:!((r=e.element.visibility)!=null&&r.condition)});function a(){const r=l.value||`[2.6.${Hn.ELEMENT_VALUR}]`;No({code:r,doc:e.element.doc,mode:"condition"}).then(i=>{i!=null&&(l.value=i)})}return(r,i)=>(S(),L(X,null,[f("section",Zm,[i[1]||(i[1]=f("header",{class:"quickprint-config-header"},"可见性",-1)),f("div",Km,[p(_(J),{class:"quickprint-w-full",options:_(hs),modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=u=>t.value=u)},null,8,["options","modelValue"])])]),t.value===_(yt).CONDITION?(S(),L("div",{key:0,class:g([r.classes.condition,"quickprint-config-section"]),onClick:a},[f("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Jm),o.value?(S(),Z(_(D),{key:0,icon:"icon-open-new",size:"14px"})):z("",!0)],2)):z("",!0)],64))}}),eh="_condition_siopf_2",th={condition:eh},nh={classes:th},lh=V(Qm,[["__cssModules",nh]]);function oh(n){return N({get(){return n.element.attributes.position??dn.DEFAULT},set(e){const t=e===dn.DEFAULT?void 0:e;n.element.attributes.position=t}})}function sh(n){return N({get(){return n.element.attributes.printMode??fn.ONCE},set(e){const t=e===fn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function ih(n){return N({get(){return n.element.attributes.overflow??jt.HIDDEN},set(e){const t=e===jt.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function rh(n){return N({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function ah(n){return N({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function ch(n){return N({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function uh(n){return N({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const dh=$({__name:"Const",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,s)=>_e((S(),L("textarea",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Ne,t.value]])}}),fh={class:"quickprint-config-ds-var-type"},ph=["title"],mh=$({__name:"Variable",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Ee(),l=N(()=>ae(e.element.ds.value)),s=N(()=>it(e.element.ds.value,t.doc.ds));function o(r){r.stopPropagation(),e.element.ds.value=void 0}async function a(){var d;const r=await sl({doc:t.doc,value:e.element.ds.value}).catch(et);if(r==null||(e.element.setDataSource(ye.VARIABLE,r.value),e.element.type!=Y.TABLE_CELL||r.type!=="ds"))return;const i=e.element.parent;if(i==null||i.isBindVariable||((d=r.parent)==null?void 0:d.type)!==te.ARRAY)return;const u=r.parent;i.setDataSource(ye.VARIABLE,`${Je.DS}.${u.type}.${u.name}`)}return(r,i)=>(S(),L("div",{class:"quickprint-config-ds-variable",onClick:a},[l.value?(S(),L(X,{key:0},[i[0]||(i[0]=f("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(_(D),{icon:"icon-open-new",size:"14px"})],64)):(S(),L(X,{key:1},[f("span",fh,"<"+H(_(ki)(e.element.ds.value))+">",1),f("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:s.value},H(s.value),9,ph),f("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:o},[p(_(D),{icon:"icon-close",size:"12px"})])],64))]))}}),hh=["value"],gh=$({__name:"Code",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N(()=>ae(e.element.ds.value));function l(){return Wn(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function s(){jm("自定义",l()).then(o=>{o!=null&&(e.element.ds.value=o)})}return(o,a)=>(S(),L("div",{onClick:s,class:g(o.classes.code)},[f("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,hh),t.value?(S(),Z(_(D),{key:0,icon:"icon-open-new",size:"14px"})):z("",!0)],2))}}),vh="_code_1az68_2",bh={code:vh},yh={classes:bh},_h=V(gh,[["__cssModules",yh]]),Eh=["value"],Th=$({__name:"Formula",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Ee(),l=N(()=>ae(e.element.ds.value)),s=N(()=>ol(e.element.ds.value,e.element.doc));function o(){const a=e.element.ds.value;No({code:a,doc:t.doc,mode:"formula"}).then(r=>{r!=null&&(e.element.ds.value=r)})}return(a,r)=>(S(),L("div",{onClick:o,class:g(a.classes.code)},[f("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Eh),l.value?(S(),Z(_(D),{key:0,icon:"icon-open-new",size:"14px"})):z("",!0)],2))}}),Sh="_code_ipm2q_2",wh={code:Sh},kh={classes:wh},Ch=V(Th,[["__cssModules",kh]]);function Rh(n){switch(n.ds.type){case ye.CONST:return p(dh,{element:n},null);case ye.VARIABLE:return p(mh,{element:n},null);case ye.CODE:return p(_h,{element:n},null);case ye.FORMULA:return p(Ch,{element:n},null);default:return null}}const Il=$({props:{element:{type:pe,required:!0}},setup(n){const e=N(()=>Zt(n.element.type)),t=N(()=>ys.filter(R=>R.value!=n.element.type)),l=se("px"),s=rh(n),o=ah(n),a=ih(n),r=oh(n),i=sh(n),u=ch(n),d=uh(n),m=N(()=>{const R=n.element,T=R.parent;if(T===null||!(T instanceof Tt))return!1;const v=T.header;if(v.display&&R.bottom<=(v.height??0))return!1;const k=T.parent;if(k==null)return!1;const C=T.footer;return!(C.display&&R.top>=Math.floor(Mt(k.paper.height))-(C.height??0))});function h(R,T){return T==null?!1:!!T.includes(R)}function E(){const R=Lt(n.element.type);if(h(re.LAYOUT,R==null?void 0:R.exclude))return null;const T=n.element,v=h(re.COORD,R==null?void 0:R.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(nt,{class:"quickprint-form-inline-item",label:"左",modelValue:T.left,"onUpdate:modelValue":G=>T.left=G,target:l.value},null),p(nt,{class:"quickprint-form-inline-item",label:"上",modelValue:T.top,"onUpdate:modelValue":G=>T.top=G,target:l.value},null)])]),k=h(re.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[ne("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(nt,{class:"quickprint-form-inline-item",label:"宽",modelValue:s.value,"onUpdate:modelValue":G=>s.value=G,target:l.value},null),p(nt,{class:"quickprint-form-inline-item",label:"高",modelValue:o.value,"onUpdate:modelValue":G=>o.value=G,target:l.value},null)])]),C=h(re.VISIBILITY,R==null?void 0:R.exclude)?null:p(lh,{element:T},null),I=h(re.OVERFLOW,R==null?void 0:R.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("溢出时")]),p("div",{class:"quickprint-config-content"},[p(J,{modelValue:a.value,"onUpdate:modelValue":G=>a.value=G,options:ws,class:"quickprint-w-full"},null)])]),q=h(re.PRINT_MODE,R==null?void 0:R.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[ne("打印模式")]),p("div",{class:"quickprint-config-content"},[p(J,{modelValue:i.value,"onUpdate:modelValue":G=>i.value=G,options:Ss,class:"quickprint-w-full"},null)])]),W=h(re.POSITION,R==null?void 0:R.exclude)||!m.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("定位模式")]),p("div",{class:"quickprint-config-content"},[p(J,{modelValue:r.value,"onUpdate:modelValue":G=>r.value=G,options:Ts,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[ne("布局")]),p("span",null,[ne("单位：")]),p(Ro,{modelValue:l.value,"onUpdate:modelValue":G=>l.value=G},null)]),v,k,C,I,q,W])}function b(){const R=Lt(n.element.type);if(h(re.BASIC,R==null?void 0:R.exclude))return null;const T=n.element,v=h(re.PREFIX,R==null?void 0:R.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("前缀")]),p("div",{class:"quickprint-config-content"},[_e(p("input",{"onUpdate:modelValue":I=>T.attributes.prefix=I,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ne,T.attributes.prefix]])])]),k=h(re.SUFFIX,R==null?void 0:R.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("后缀")]),p("div",{class:"quickprint-config-content"},[_e(p("input",{"onUpdate:modelValue":I=>T.attributes.suffix=I,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ne,T.attributes.suffix]])])]),C=h(re.DISPLAY,R==null?void 0:R.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("数据类型")]),p("div",{class:"quickprint-config-content"},[p(J,{options:t.value,modelValue:u.value,"onUpdate:modelValue":I=>u.value=I,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ne("基础")]),v,k,C])}function c(){const R=Lt(n.element.display);return(R==null?void 0:R.display)==null?null:ot(R.display,{element:n.element})}function y(){const R=Lt(n.element.type);if(h(re.ATTRIBUTES,R==null?void 0:R.exclude))return null;const T=R!=null&&R.attributes?ot(R.attributes,{element:n.element}):null,v=c();if(T==null&&v==null)return null;const k=v!=null&&T!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ne("属性")]),v,k,T])}function w(){const R=Lt(n.element.type);return h(re.DATASOURCE,R==null?void 0:R.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ne("数据")]),p(J,{options:Gl,modelValue:d.value,"onUpdate:modelValue":T=>d.value=T},null),Rh(n.element)])}function x(R){R(n.element.id)}return function(){const T=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,ne("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[T.id]),p(Fm,{onCopy:x},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("标题")]),p("div",{class:"quickprint-config-content"},[_e(p("input",{type:"text","onUpdate:modelValue":v=>T.title=v,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ne,T.title]])])])]),E(),b(),y(),w()])])}}}),Lh=$({setup(){const n=Ee();function e(){return p("div",null,[ne("未知的打印元素")])}function t(){return p("div",null,[ne("请先选择元素")])}function l(){return p("div",null,[ne("请先选择页面")])}return function(){const s=n.state;if(s.selectedType===fe.PAGE){const o=n.getSelectedPage();return o==null?l():p(vm,{page:o},null)}if(s.selectMode===st.SINGLE){const o=n.getSelectedElements()[0];return o==null?t():ot(Il,{element:o,key:o.id})}if(s.selected.length==1){const o=n.getSelectedElements()[0];return Lt(o.type)==null?e():ot(Il,{element:o,key:o.id})}return p(Em,null,null)}}});function Be(n,e){if(n.state.selectedType!==fe.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function xe(n,e,t){if(n.state.selectedType!==fe.ELEMENT)return;const s=n.getSelectedElements();if(s.length!=0){for(const o of s)o.setStyle(e,t);n.createSnapshot()}}function qe(n,e){if(n.state.selectedType!==fe.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const s of l)s.removeStyle(e);n.createSnapshot()}}function Nh(n){const e="underline";return N({get(){if(n.state.selectedType!==fe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?xe(n,e,t):qe(n,e)}})}function Ih(n){const e="lineThrough";return N({get(){if(n.state.selectedType!==fe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?xe(n,e,t):qe(n,e)}})}function xh(n){const e="lineHeight";return N({get(){return Be(n,e)},set(t){t===ht.DEFAULT?qe(n,e):xe(n,e,t)}})}function Ah(n){const e="highlightColor";return N({get(){return Be(n,e)??Gn.BLACK},set(t){t===""?qe(n,e):xe(n,e,t)}})}function Dh(n){const e="backgroundColor";return N({get(){return Be(n,e)??Gn.BLACK},set(t){t===""?qe(n,e):xe(n,e,t)}})}function $h(n){const e="fontStyle";return N({get(){return Be(n,e)===fl.ITALIC},set(t){t?xe(n,e,fl.ITALIC):qe(n,e)}})}function Oh(n){const e="textAlign";return N({get(){return Be(n,e)??tt.LEFT},set(t){t===tt.LEFT?qe(n,e):xe(n,e,t)}})}function qh(n){const e="verticalAlign";return N({get(){return Be(n,e)??Ye.MIDDLE},set(t){t===Ye.MIDDLE?qe(n,e):xe(n,e,t)}})}function Mh(n){const e="fontFamily";return N({get(){return Be(n,e)},set(t){t===le.DEFAULT?qe(n,e):xe(n,e,t)}})}function Ph(n){const e="fontSize";return N({get(){return Be(n,e)},set(t){t===be.DEFAULT?qe(n,e):xe(n,e,t)}})}function Vh(n){const e="color";return N({get(){return Be(n,e)??ke.REGULAR},set(t){xe(n,e,t)}})}function Bh(n){const e="fontWeight";return N({get(){return Be(n,e)===700},set(t){t?xe(n,e,700):qe(n,e)}})}const Fh=["title","onClick"],zh=$({__name:"BorderSelect",setup(n){const e=[Q.ALL,Q.NONE,Q.INSIDE,Q.OUTSIDE],t=Ee(),l=N(()=>{if(t.state.selectedType!==fe.ELEMENT)return null;const u=t.getSelectedElements();if(u.length!==1)return null;const m=u[0].getStyle("border");if(m==null||m===Q.NONE)return null;if(m===Q.ALL)return{borderStyle:"solid"};const h={};return m&Q.TOP&&(h.borderTopStyle="solid"),m&Q.RIGHT&&(h.borderRightStyle="solid"),m&Q.BOTTOM&&(h.borderBottomStyle="solid"),m&Q.LEFT&&(h.borderLeftStyle="solid"),h}),s=[{label:"上框线",value:Q.TOP,icon:"icon-border-top"},{label:"下框线",value:Q.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:Q.LEFT,icon:"icon-border-left"},{label:"右框线",value:Q.RIGHT,icon:"icon-border-right"}];function o(i){if(t.state.selectedType!==fe.ELEMENT)return!1;const d=t.getSelectedElements();if(d.length!==1)return!1;const h=d[0].getStyle("border");return h==null?!1:e.includes(i)?h==i:h&i}function a(i){if(t.state.selectedType!==fe.ELEMENT)return;const d=t.getSelectedElements();if(d.length!=0){for(const m of d){const h=m.getStyle("border");if(h==null){m.setStyle("border",i);continue}if(h===Q.ALL){m.setStyle("border",i===Q.ALL?Q.NONE:i);continue}if(e.includes(i)){m.setStyle("border",i);continue}if(e.includes(h)){m.setStyle("border",i);continue}m.setStyle("border",h^i)}t.createSnapshot()}}function r(){if(t.state.selectedType!==fe.ELEMENT)return;const u=t.getSelectedElements();if(u.length!=0){for(const d of u)d.setStyle("border",void 0);t.createSnapshot()}}return(i,u)=>(S(),Z(_(Ql),null,{popover:ge(()=>[f("div",{class:g(i.classes.popover)},[f("div",null,[(S(),L("button",{type:"button",title:"全部框线",key:_(Q).ALL,class:g({"quickprint-text-btn":!0,[i.classes.tool]:!0,"quickprint-is-selected":o(_(Q).ALL)}),onClick:u[0]||(u[0]=d=>a(_(Q).ALL))},[p(_(D),{icon:"icon-border",size:"16px"})],2)),(S(),L("button",{type:"button",title:"无框线",key:_(Q).ALL,class:g({"quickprint-text-btn":!0,[i.classes.tool]:!0}),onClick:r},[p(_(D),{icon:"icon-border-none",size:"16px"})],2))]),f("div",{class:g(i.classes.divider)},[(S(),L(X,null,ie(s,d=>f("button",{type:"button",title:d.label,key:d.value,class:g({"quickprint-text-btn":!0,[i.classes.tool]:!0,"quickprint-is-selected":o(d.value)}),onClick:m=>a(d.value)},[p(_(D),{icon:d.icon,size:"16px"},null,8,["icon"])],10,Fh)),64))],2)],2)]),default:ge(()=>[f("div",{class:g(["quickprint-text-btn",i.classes.borderSelect]),title:"边框"},[f("div",{class:g({[i.classes.border]:!0}),style:K(l.value)},null,6)],2)]),_:1}))}}),Uh="_border_rprfx_2",Hh="_borderSelect_rprfx_10",Gh="_popover_rprfx_14",Wh="_divider_rprfx_18",Yh={border:Uh,borderSelect:Hh,popover:Gh,divider:Wh},Xh={classes:Yh},jh=V(zh,[["__cssModules",Xh]]),Zh={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Kh={class:"quickprint-config-section"},Jh={class:"quickprint-form-inline"},Qh={class:"quickprint-config-section quickprint-config-inline"},eg={class:"quickprint-config-section"},tg={class:"quickprint-config-header quickprint-is-row"},ng={class:"quickprint-is-fill-w"},lg={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},og={class:"quickprint-config-content quickprint-form-inline"},sg=$({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=se("px"),l=h("top"),s=h("bottom"),o=h("left"),a=h("right"),r=N(()=>xn.map(E=>({label:E.size===An.CUSTOM?"自定义":`${E.size}(${E.width}mm ✕ ${E.height}mm)`,value:E.size})));function i(E){e.config.width=E,m()}function u(E){e.config.height=E,m()}function d(E){const b=xn.find(c=>c.size===E);b!=null&&(e.config.width=b.width,e.config.height=b.height,e.config.orientation=b.orientation,e.config.margins=b.margins,e.config.size=b.size)}function m(){const E=e.config,b=xn.find(c=>c.size===An.CUSTOM?!1:c.orientation===E.orientation&&c.width===E.width&&c.height===E.height);if(b==null){E.size=An.CUSTOM;return}E.size=b.size}function h(E){return N({get(){var b;return(b=e.config.margins)==null?void 0:b[E]},set(b){e.config.margins==null&&(e.config.margins={}),e.config.margins[E]=b}})}return(E,b)=>(S(),L("div",Zh,[f("section",Kh,[b[6]||(b[6]=f("header",{class:"quickprint-config-header"},[f("span",null,"尺寸")],-1)),p(_(J),{options:r.value,modelValue:n.config.size,"onUpdate:modelValue":d,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),f("div",Jh,[p(xt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":i},null,8,["modelValue"]),p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":u},null,8,["modelValue"])])]),f("section",Qh,[b[7]||(b[7]=f("header",{class:"quickprint-config-header"},"方向",-1)),p(It,{modelValue:n.config.orientation,"onUpdate:modelValue":b[0]||(b[0]=c=>n.config.orientation=c),options:_(Yl)},null,8,["modelValue","options"])]),f("section",eg,[f("header",tg,[f("span",ng,[p(_($s),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:ge(()=>b[8]||(b[8]=[ne("参考边距")])),_:1})]),b[9]||(b[9]=f("span",null,"单位：",-1)),p(Ro,{modelValue:t.value,"onUpdate:modelValue":b[1]||(b[1]=c=>t.value=c)},null,8,["modelValue"])]),f("div",lg,[p(nt,{class:"quickprint-form-inline-item",label:"上",modelValue:_(l),"onUpdate:modelValue":b[2]||(b[2]=c=>Ge(l)?l.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(nt,{class:"quickprint-form-inline-item",label:"下",modelValue:_(s),"onUpdate:modelValue":b[3]||(b[3]=c=>Ge(s)?s.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),f("div",og,[p(nt,{class:"quickprint-form-inline-item",label:"左",modelValue:_(o),"onUpdate:modelValue":b[4]||(b[4]=c=>Ge(o)?o.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(nt,{class:"quickprint-form-inline-item",label:"右",modelValue:_(a),"onUpdate:modelValue":b[5]||(b[5]=c=>Ge(a)?a.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),ig={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},rg={class:"quickprint-is-fill-h"},ag={class:"quickprint-is-fill-h"},cg=$({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Ce.NONE},{label:"磅",value:Ce.PT},{label:"像素",value:Ce.PX}],l=N(()=>Cn.map(u=>(u.style={fontFamily:u.value==le.DEFAULT?le.SONG:u.value},u))),s=N(()=>go.map(u=>(u.style={fontFamily:u.value==le.DEFAULT?le.SONG:u.value},u))),o=N({get(){return e.config.style.fontFamily??le.DEFAULT},set(u){const d=u===le.DEFAULT?void 0:u;e.config.style.fontFamily=d}}),a=N({get(){return e.config.style.enFontFamily??le.DEFAULT},set(u){const d=u===le.DEFAULT?void 0:u;e.config.style.enFontFamily=d}}),r=N({get(){return e.config.style.fontSize},set(u){const d=ae(u)?void 0:u;e.config.style.fontSize=d}}),i=N({get(){return e.config.style.lineHeight},set(u){e.config.style.lineHeight=u}});return(u,d)=>(S(),L("div",ig,[f("section",{class:g(u.classes.font)},[f("div",{class:g(u.classes.zhFont)},[f("div",{class:g(u.classes.title)},"中文字体",2),f("div",rg,[p(_(J),{options:l.value,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=m=>o.value=m)},null,8,["options","modelValue"])])],2),f("div",{class:g(u.classes.enFont)},[f("div",{class:g(u.classes.title)},"西文字体",2),f("div",ag,[p(_(J),{options:s.value,modelValue:a.value,"onUpdate:modelValue":d[1]||(d[1]=m=>a.value=m)},null,8,["options","modelValue"])])],2),f("div",{class:g(u.classes.lineHeight)},[f("div",{class:g(u.classes.title)},"行高",2),p(mt,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=m=>i.value=m),options:t},null,8,["modelValue"])],2),f("div",{class:g(u.classes.fontSize)},[f("div",{class:g(u.classes.title)},"字号",2),p(wo,{modelValue:r.value,"onUpdate:modelValue":d[3]||(d[3]=m=>r.value=m),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),ug="_font_145qf_2",dg="_zhFont_145qf_9",fg="_enFont_145qf_16",pg="_lineHeight_145qf_23",mg="_fontSize_145qf_30",hg="_title_145qf_45",gg={font:ug,zhFont:dg,enFont:fg,lineHeight:pg,fontSize:mg,title:hg},vg={classes:gg},bg=V(cg,[["__cssModules",vg]]),yg=$({__name:"index",props:{doc:{type:ve,required:!0}},setup(n){const e=n,t=Pe(),l=$e(a()),s=se("paper"),o=[{label:"纸张",value:"paper"},{label:"字体",value:"font"}];function a(){const d=e.doc;return{size:d.paper.size,width:d.paper.width,height:d.paper.height,orientation:d.paper.orientation,margins:d.margins?{...d.margins}:void 0,style:{...d.style}}}function r(d){s.value=d.value}function i(){t==null||t.confirm(l)}function u(){t==null||t.cancel()}return(d,m)=>(S(),L("div",{class:g(d.classes.setting)},[f("div",{class:g(d.classes.header)},[f("div",{class:g(d.classes.headerLeft)},[p(_(D),{icon:"icon-setting",size:"14px"}),f("span",{class:g(d.classes.title)},"文档",2),p(ko,{tabs:o,active:s.value,onSwitch:r},null,8,["active"])],2),_(t)?(S(),Z(_(jn),{key:0,instance:_(t)},null,8,["instance"])):z("",!0)],2),s.value=="paper"?(S(),Z(sg,{key:0,config:l},null,8,["config"])):z("",!0),s.value=="font"?(S(),Z(bg,{key:1,config:l},null,8,["config"])):z("",!0),f("div",{class:g(d.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:u},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:i},"确定")],2)],2))}}),_g="_setting_nhkf0_2",Eg="_header_nhkf0_11",Tg="_headerLeft_nhkf0_23",Sg="_title_nhkf0_36",wg="_tabs_nhkf0_43",kg="_footer_nhkf0_48",Cg={setting:_g,header:Eg,headerLeft:Tg,title:Sg,tabs:wg,footer:kg},Rg={classes:Cg},Lg=V(yg,[["__cssModules",Rg]]),Ng=Ve(function(n){return Kt("文档设置",p(Lg,{doc:n},null),{preset:"setting"}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Oe)}),Ig=$({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Ee(),t=Ie("classes"),l=Mh(e),s=Ph(e),o=xh(e),a=Dh(e),r=Ah(e),i=Vh(e),u=Bh(e),d=$h(e),m=Nh(e),h=Ih(e),E=Oh(e),b=qh(e),c=N(()=>Cn.map(O=>(O.style={fontFamily:O.value==le.DEFAULT?le.SONG:O.value},O)));function y(O){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>O.handler(e)},[O.icon&&p(D,{icon:O.icon},null),p("span",null,[O.label])])}function w(O){O.preventDefault()}function x(){u.value=!u.value}function R(){d.value=!d.value}function T(){m.value=!m.value}function v(){h.value=!h.value}function k(){const O=e.getSelectedElements();if(O.length==0)return;const j=Math.min(...O.map(ee=>ee.left));for(const ee of O)ee.setLeft(j,!0);e.createSnapshot()}function C(){const O=e.getSelectedElements();if(O.length==0)return;const j=O[0].page;if(j==null)return;const ee=Mt(j.width);for(const M of O)M.setLeft((ee-M.width)/2);e.createSnapshot()}function I(){const O=e.getSelectedElements();if(O.length==0)return;const j=Math.max(...O.map(ee=>ee.left+ee.width));for(const ee of O)ee.setLeft(j-ee.width,!0);e.createSnapshot()}async function q(){const O=await na(e.doc);O!=null&&(e.doc.ds=e.doc.createDS(O))}function W(){Ng(e.doc)}function G(O){var j,ee;if(typeof O=="function")return O(e,t);if(typeof O=="object")return y(O);if(typeof O!="string")return null;switch(O){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const M=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:M,onClick:e.history.undo},[p(D,{icon:"icon-undo"},null)])}case"redo":{const M=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:M,onClick:e.history.redo},[p(D,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(D,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(J,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":M=>l.value=M,options:c.value,class:t.tool,button:!0},null);case"fontSize":return p(J,{title:"字号",width:"60px",modelValue:s.value,"onUpdate:modelValue":M=>s.value=M,options:rl,class:t.tool,button:!0},null);case"lineHeight":return p(J,{title:"行高",width:"60px",modelValue:o.value,"onUpdate:modelValue":M=>o.value=M,options:vo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(lt,{modelValue:a.value,"onUpdate:modelValue":M=>a.value=M,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(D,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"highlightColor":return p(lt,{modelValue:r.value,"onUpdate:modelValue":M=>r.value=M,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(D,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"fontColor":return p(lt,{modelValue:i.value,"onUpdate:modelValue":M=>i.value=M,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(D,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontWeight":{const M={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":u.value};return p("button",{type:"button",title:"加粗",class:M,onClick:x},[p(D,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const M={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":d.value};return p("button",{type:"button",title:"斜体",class:M,onClick:R},[p(D,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const M={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":m.value};return p("button",{type:"button",title:"下划线",class:M,onClick:T},[p(D,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const M={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":h.value};return p("button",{type:"button",title:"删除线",class:M,onClick:v},[p(D,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(jh,null,null);case"textAlign":{const M=((j=Fn.find(ce=>ce.value===E.value))==null?void 0:j.label)??"水平对齐",me={selected({option:ce}){return p(D,{icon:ce==null?void 0:ce.icon,class:"quickprint-is-self-center"},null)}};return p(J,{modelValue:E.value,"onUpdate:modelValue":ce=>E.value=ce,options:Fn,title:M,class:t.tool,width:"36px",size:"mini",button:!0},me)}case"verticalAlign":{const M=((ee=Bn.find(ce=>ce.value===b.value))==null?void 0:ee.label)??"垂直对齐",me={selected({option:ce}){return p(D,{icon:ce==null?void 0:ce.icon,class:"quickprint-is-self-center"},null)}};return p(J,{modelValue:b.value,"onUpdate:modelValue":ce=>b.value=ce,options:Bn,title:M,class:t.tool,width:"36px",size:"mini",button:!0},me)}case"alignLeft":{const M={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:M,onClick:k},[p(D,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const M={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:M,onClick:C},[p(D,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const M={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:M,onClick:I},[p(D,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const M={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:M,onClick:e.toggleBackground},[p(D,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const M={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:M,onClick:e.toggleElementPanel},[p(D,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const M={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:M,onClick:e.toggleConfigPanel},[p(D,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:q},[p(D,{icon:"icon-datasource"},null),p("span",null,[ne("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:W},[p(D,{icon:"icon-file-text"},null),p("span",null,[ne("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:w},[n.toolbar.map(G)])}}}),xg="_toolbar_1bhq2_2",Ag="_divider_1bhq2_8",Dg="_tool_1bhq2_2",$g="_colorIcon_1bhq2_18",Og="_colorIndicator_1bhq2_38",qg={toolbar:xg,divider:Ag,tool:Dg,colorIcon:$g,colorIndicator:Og},Mg={classes:qg},Pg=V(Ig,[["__cssModules",Mg]]);function Vg(n){let e=null;const t=ue(),l=$e({width:0,height:0,scrollTop:0,scrollLeft:0}),s=ue(),o=$e({id:"",top:0,left:0,width:0,height:0});async function a(){await Pt();const E=t.value;E!=null&&(l.width=E.offsetWidth,l.height=E.offsetHeight)}function r(E){const b=E.target;l.scrollLeft=b.scrollLeft,l.scrollTop=b.scrollTop}function i(E){const c=E.target.closest("."+U.PAPER);c!=null&&(s.value=c,d(c),u())}async function u(){await Pt();const E=s.value;E!=null&&(o.id=E.id.slice(1),o.width=E.offsetWidth,o.height=E.offsetHeight,o.top=E.offsetTop,o.left=E.offsetLeft)}function d(E){E!=null&&(s.value&&(e==null||e.unobserve(s.value)),e==null||e.observe(E))}function m(){const E=n.doc.firstPage;if(E==null)return;const b=document.querySelector("#\\@"+E.id);s.value=b,e&&b&&e.observe(b),u()}function h(E){E.some(b=>b.target.matches("."+U.CANVAS))&&(a(),u()),E.some(b=>b.target.matches("."+U.PAPER))&&(a(),u())}return Qn(()=>n.state.scale,()=>u()),Qt(()=>{e=new ResizeObserver(h),e.observe(t.value),m(),a()}),ps(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:o,onScroll:r,onSelectPage:i}}const Io=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),Bg=$({__name:"index",props:St({modelValue:{type:ve,required:!0},toolbar:{type:Array,default(){return Io}}},{modelValue:{required:!0},modelModifiers:{}}),emits:St(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=ue(),s=ue(),o=Rs(),a=Jt(n,"modelValue"),r=md(a,{queryElement:w,dispatchEvent:x}),{canvasRef:i,canvasRect:u,pageRect:d,onScroll:m,onSelectPage:h}=Vg(r),E=N(()=>({"--quickprint-page-scale":r.state.scale/100,"--quickprint-dpr":o.value})),b=N(()=>{const T=r.doc.style;return{fontFamily:nl(T==null?void 0:T.fontFamily,T==null?void 0:T.enFontFamily),fontSize:T==null?void 0:T.fontSize,lineHeight:T==null?void 0:T.lineHeight}});function c(){r.state.panel.left=!1}function y(){r.state.panel.right=!1}function w(T){switch(T){case"ghost":return s.value;case"root":return l.value;default:return}}function x(T,...v){t(T,...v)}function R(T){T.deltaY>0?r.zoomIn():r.zoomOut()}return(T,v)=>(S(),L("div",{class:g(T.classes.designer),ref_key:"rootRef",ref:l,style:K(E.value)},[f("div",{class:g(T.classes.header)},[Me(T.$slots,"headerLeft"),p(Pg,{class:g(T.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),Me(T.$slots,"headerRight")],2),f("div",{class:g(T.classes.main)},[_(r).state.panel.left?(S(),L("div",{key:0,class:g(T.classes.left)},[f("button",{type:"button",onClick:c,class:g(["quickprint-text-btn",T.classes.closePanelBtn])},[p(_(D),{icon:"icon-close",size:"12px"})],2),p(Fp)],2)):z("",!0),f("div",{class:g([T.classes.center,_(U).CANVAS]),onWheelPassive:oe(R,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:i},[p(Ll,{canvas:_(u),page:_(d),scale:_(r).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Ll,{canvas:_(u),page:_(d),scale:_(r).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),f("div",{class:g([_(U).SCROLLABLE,T.classes.canvas]),style:K(b.value),onScroll:v[0]||(v[0]=(...k)=>_(m)&&_(m)(...k)),onClickCapture:v[1]||(v[1]=(...k)=>_(h)&&_(h)(...k))},[(S(!0),L(X,null,ie(a.value.pages,k=>(S(),Z(Ip,{key:k.id,doc:a.value,page:k},null,8,["doc","page"]))),128))],38),f("div",{class:g(T.classes.footer)},[p(Zp),p(_(ns),{scale:_(r).state.scale,onZoomIn:_(r).zoomIn,onZoomOut:_(r).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),_(r).state.panel.right?(S(),L("div",{key:1,class:g(T.classes.right)},[f("button",{type:"button",onClick:y,class:g(["quickprint-text-btn",T.classes.closePanelBtn])},[p(_(D),{icon:"icon-close",size:"12px"})],2),p(_(Lh))],2)):z("",!0)],2),f("div",{ref_key:"ghostRef",ref:s,class:g(T.classes.ghost)},null,2),p(_(ls))],6))}}),Fg="_designer_grxxm_2",zg="_header_grxxm_17",Ug="_toolbar_grxxm_25",Hg="_footer_grxxm_31",Gg="_main_grxxm_47",Wg="_left_grxxm_55",Yg="_center_grxxm_63",Xg="_right_grxxm_75",jg="_canvas_grxxm_83",Zg="_closePanelBtn_grxxm_96",Kg="_ghost_grxxm_103",Jg={designer:Fg,header:zg,toolbar:Ug,footer:Hg,main:Gg,left:Wg,center:Yg,right:Xg,canvas:jg,closePanelBtn:Zg,ghost:Kg},Qg={classes:Jg},ev=V(Bg,[["__cssModules",Qg]]),tv={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:rn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Oe)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:rn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:rn.DISABLED}};function nv(n,e={}){const t=os(e.zIndexManager);n.use(ss,{zIndex:t,presets:tv}),is(n._context)}const lv="0.0.0",ov={version:lv,install:nv},sv=["onClick"],iv=$({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=Pe();function l(s){t==null||t.confirm(s)}return(s,o)=>(S(),L("div",{class:g(s.classes.panel)},[(S(!0),L(X,null,ie(_(rs),(a,r)=>(S(),L("div",{key:a.id,class:g(s.classes.item),onClick:i=>l(a)},[f("div",null,[f("span",null,H(r+1)+". ",1),f("span",null,H(a.name),1)])],10,sv))),128))],2))}}),rv="_panel_1he7q_2",av="_item_1he7q_9",cv={panel:rv,item:av},uv={classes:cv},dv=V(iv,[["__cssModules",uv]]),fv="local",xl="quickprint-local-define",pv=$({__name:"index",setup(n){const e=Ie("classes"),t=E(),l="20250820",s=[{label:"新建",icon:"icon-file-text",handler:d},{label:"加载示例",icon:"icon-import",handler:i},"---",...Io];function o(){const b=JSON.stringify(t.value);localStorage.setItem(xl,b)}function a(){o()}function r(){const b=t.value.id,c=b.startsWith("case_")?b:fv,y=`${window.location.origin}/preview.html?id=${c}`;o(),Et("文档预览",ot("iframe",{src:y,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(w){window.open(y,"_blank"),w.close()}}]})}function i(){const b={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:rn.DISABLED};Et("选择示例",ot(dv),b).promisify().then(c=>u(c.id)).catch(Oe)}async function u(b){const c=await pl(b,!1);c!=null&&(as(b),t.value=ve.create(c.define),m())}function d(){const b=ve.createNormalDocument();t.value=b,m()}function m(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function h(){const b=localStorage.getItem(xl);if(b!=null)return ve.create(b);const c=cs(),y=await pl(c.id,!1);return y==null?ve.createNormalDocument():ve.create(y.define)}function E(){const b=se();return h().then(c=>{b.value=c,m()}),b}return(b,c)=>_(t)?(S(),Z(_(ev),{modelValue:_(t),"onUpdate:modelValue":c[0]||(c[0]=y=>Ge(t)?t.value=y:null),toolbar:s,class:g(_(e).main),key:_(t).id,onSave:a,onPreview:r},{headerLeft:ge(()=>[f("div",{class:g(_(e).logo)},[c[1]||(c[1]=f("h1",null,"OpenPrint",-1)),f("div",{class:g(_(e).dev)},"DEV_"+H(_(l)),3)],2)]),headerRight:ge(()=>[f("div",{class:g(_(e).operate)},[f("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:r},[p(_(D),{icon:"icon-run"}),c[2]||(c[2]=f("span",null,"预览",-1))]),f("button",{type:"button",onClick:o,class:"quickprint-text-btn",title:"保存"},[p(_(D),{icon:"icon-save"}),c[3]||(c[3]=f("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):z("",!0)}}),mv="_main_he2u6_2",hv="_iframe_he2u6_6",gv="_divider_he2u6_14",vv="_logo_he2u6_20",bv="_dev_he2u6_39",yv="_operate_he2u6_51",_v={main:mv,iframe:hv,divider:gv,logo:vv,dev:bv,operate:yv},Ev={classes:_v},Tv=V(pv,[["__cssModules",Ev]]),xo=ms(Tv);xo.use(ov);xo.mount("#app");
