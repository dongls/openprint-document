const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-CyWGPfye.js","assets/utils-BI6Y8M4J.js","assets/vue-C4hvfNT6.js","assets/utils-BaImnbvp.css"])))=>i.map(i=>d[i]);
var Or=Object.defineProperty;var Rn=e=>{throw TypeError(e)};var Mr=(e,t,n)=>t in e?Or(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var O=(e,t,n)=>Mr(e,typeof t!="symbol"?t+"":t,n),Gt=(e,t,n)=>t.has(e)||Rn("Cannot "+n);var U=(e,t,n)=>(Gt(e,t,"read from private field"),n?n.call(e):t.get(e)),he=(e,t,n)=>t.has(e)?Rn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),it=(e,t,n,r)=>(Gt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),st=(e,t,n)=>(Gt(e,t,"access private method"),n);var On=(e,t,n,r)=>({set _(i){it(e,t,i,n)},get _(){return U(e,t,r)}});import{C as Ir,af as dn,ag as pn,aB as Be,J as nn,al as Lr,aC as Y,w as Ee,p as mn,t as Qe,i as vt,b as se,P as Pr,m as et,D as Et,v as Cr,u as zt,aD as ct,a as ot,N as jt,O as _t,n as xr,E as Mn,aE as tr,F as rn,r as lt,B as je,o as kr,S as $r,V as In,c as ue,q as qr,G as sn,L as Hr,aF as Fr,U as Ur,_ as Ht,I as on,ar as Br,A as Yr,aG as nr,h as me,T as Vr,K as Gr,W as zr,z as jr,at as Wr,M as Zr,aH as Ln,aI as Pn,ay as Xr,ax as Cn,au as Jr,av as Kr,aw as Qr}from"./utils-BI6Y8M4J.js";import{d as dt,h as Se,c as Ze,a as Ye,b as ae,n as ie,v as St,e as j,D as Rt,u as rr,s as Ot,g as ir,J as ei,i as K,f as xn,F as ti,w as ni,y as ri,B as kn,C as ii,S as si,N as oi,r as Wt,j as ui,R as ai}from"./vue-C4hvfNT6.js";const le=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),Dt=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),un=Object.freeze({CREATED:0,MOUNDTED:1}),pe={UNDEFINED:0,PENDING:1,DONE:2},Te={PENDING:-1,HIDDEN:0,VISIBLE:1},ut=[25,50,75,100,125,150,200,300,400],li=["class","className","style"],be=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDDE_LINE:"quickprint-guide-line"}),$n=Promise.resolve(),ci=2e3,fi=48;let an=0,At=0;function hi(){an=0,At=0}function Ge(){return an<=ci?(an++,$n):At<fi?(At++,$n):new Promise(e=>{At=0,setTimeout(e)})}function di(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)}function pi(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123}function ln(e){return e==null?"":typeof e=="string"?e.trim():Array.isArray(e)?e.map(ln).join(" "):typeof e=="object"?Object.keys(e).filter(t=>e[t]).join(" "):""}function sr(e,t){if(t!=null){if(t instanceof Element){e.appendChild(t);return}if(Array.isArray(t)){for(const n of t)sr(e,n);return}e.textContent+=t}}function mi(e,t){if(!(t==null||typeof t!="object"))for(const n of Object.keys(t)){const r=t[n];if(r==null)continue;const i=Ir(n);e.style.setProperty(i,r)}}function gi(e,t){if(ln(t)=="")return;const r=e.className==""?"":" ";e.className+=r+ln(t)}function or(e,t,n){switch(t){case"class":case"className":gi(e,n);break;case"style":mi(e,n);break;case"children":n!=null&&sr(e,n);break;case"innerHTML":break;default:if(t[0]==="@")return vi(e,t,n);t in e&&(e[t]=n),n==null?e.removeAttribute(t):e.setAttribute(t,n)}}function vi(e,t,n){Reflect.set(e,t.slice(1),n)}function Ei(e,t,n){const r=e(t);if(r==null)return null;for(const i of Object.keys(t??{}))(di(i)||pi(i)||li.includes(i))&&or(r,i,t[i]);return r}function wi(e,t,n){const r=document.createElement(e);if(r==null)return null;for(const i of Object.keys(t??{}))or(r,i,t[i]);return r}function Q(e,t,n){return typeof e=="function"?Ei(e,t):wi(e,t)}function qn(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var Ct,Ce;const xt=class xt{constructor(t,n,r){he(this,Ct,dn(pn.PRINT_PAGE));he(this,Ce,Object.create(null));O(this,"fid");O(this,"define");O(this,"pageNum",-1);O(this,"pageTotal",-1);O(this,"extra",!1);O(this,"paper");O(this,"header");O(this,"footer");O(this,"children",[]);O(this,"fixed",[]);O(this,"parent");O(this,"element");O(this,"rendering");O(this,"state",Dt.CREATED);this.fid=r,this.define=t,this.paper=this.createPaper(t,n),this.header=this.createHeader(),this.footer=this.createFooter(),Be(this,"parent",null),Be(this,"element",null),Be(this,"rendering",0)}static create(t,n,r="0000"){return new xt(t,n,r)}get id(){return"@"+U(this,Ct)}get index(){return this.parent==null?-1:this.parent.pages.findIndex(t=>t.id===this.id)}get defines(){const t=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>t.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>t.add(i.id)),this.define.children.filter(i=>!t.has(i.id)).sort(nn.sort)}get style(){const{offsetWidth:t,offsetHeight:n}=this.paper;return{width:t+"px",height:n+"px"}}createPageHeader(){const t=this.header;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[be.GUIDDE_LINE,be.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}createPageFooter(){const t=this.footer;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[be.GUIDDE_LINE,be.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}render(){return Q("div",{id:this.id,class:be.PAGE,"data-index":this.index+1,children:Q("div",{class:be.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(t){this.state=Dt.PAGED,await this.onPaged()}async mountChild(t){if(this.element==null||t.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(t.element),await Ge(),await t.mount(t.element),!0)}async replaceChild(t,n){if(this.element==null||t.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null?r.removeChild(t.element):r.replaceChild(n,t.element),await Ge(),await t.mount(n),!0)}beginPaging(){this.state=Dt.PAGING}onCreated(){const t=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(t.map(n=>n.onCreated()))}onPaged(){const t=this.children.map(n=>typeof n.onPaged=="function"?n.onPaged():Promise.resolve());return Promise.allSettled(t)}onFinshed(){const t=this.children.map(n=>typeof n.onFinished=="function"?n.onFinished():Promise.resolve());return Promise.allSettled(t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),U(this,Ce)[t.id]=t}appendToHeader(t){t.setParent(this),this.header.children.push(t),U(this,Ce)[t.id]=t}appendToFooter(t){t.setParent(this),this.footer.children.push(t),U(this,Ce)[t.id]=t}appendToFixed(t){t.setParent(this),this.fixed.push(t),U(this,Ce)[t.id]=t}createPaper(t,n){return{size:n.size,width:n.width,height:n.height,orientation:t.orientation,offsetWidth:Math.round(n.width),offsetHeight:Math.round(n.height)}}createHeader(){const t=this.define.header;if(t.display!==!0)return qn();const n=t.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const t=this.define.footer;if(t.display!==!0)return qn();const n=t.height??0,i=Math.floor(Lr(this.paper.height))-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const t=new xt(this.define,this.paper,this.fid);t.rendering=0;for(const n of this.header.children){const r=n.clone();t.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();t.appendToFooter(r)}return t}findElement(t){const n=U(this,Ce)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}filterElement(t){const n=typeof t=="string"?t:t.id;return this.children.filter(r=>r.define.id===n)}};Ct=new WeakMap,Ce=new WeakMap;let Mt=xt;var tt=1e9,yi={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vn,G=!0,ge="[DecimalError] ",Ve=ge+"Invalid argument: ",gn=ge+"Exponent out of range: ",nt=Math.floor,qe=Math.pow,Ni=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,ce,ne=1e7,V=7,ur=9007199254740991,It=nt(ur/V),y={};y.absoluteValue=y.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};y.comparedTo=y.cmp=function(e){var t,n,r,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(r=s.d.length,i=e.d.length,t=0,n=r<i?r:i;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};y.decimalPlaces=y.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*V;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};y.dividedBy=y.div=function(e){return Oe(this,new this.constructor(e))};y.dividedToIntegerBy=y.idiv=function(e){var t=this,n=t.constructor;return F(Oe(t,new n(e),0,1),n.precision)};y.equals=y.eq=function(e){return!this.cmp(e)};y.exponent=function(){return Z(this)};y.greaterThan=y.gt=function(e){return this.cmp(e)>0};y.greaterThanOrEqualTo=y.gte=function(e){return this.cmp(e)>=0};y.isInteger=y.isint=function(){return this.e>this.d.length-2};y.isNegative=y.isneg=function(){return this.s<0};y.isPositive=y.ispos=function(){return this.s>0};y.isZero=function(){return this.s===0};y.lessThan=y.lt=function(e){return this.cmp(e)<0};y.lessThanOrEqualTo=y.lte=function(e){return this.cmp(e)<1};y.logarithm=y.log=function(e){var t,n=this,r=n.constructor,i=r.precision,s=i+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(ce))throw Error(ge+"NaN");if(n.s<1)throw Error(ge+(n.s?"NaN":"-Infinity"));return n.eq(ce)?new r(0):(G=!1,t=Oe(ft(n,s),ft(e,s),s),G=!0,F(t,i))};y.minus=y.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?cr(t,e):ar(t,(e.s=-e.s,e))};y.modulo=y.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(e=new r(e),!e.s)throw Error(ge+"NaN");return n.s?(G=!1,t=Oe(n,e,0,1).times(e),G=!0,n.minus(t)):F(new r(n),i)};y.naturalExponential=y.exp=function(){return lr(this)};y.naturalLogarithm=y.ln=function(){return ft(this)};y.negated=y.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};y.plus=y.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ar(t,e):cr(t,(e.s=-e.s,e))};y.precision=y.sd=function(e){var t,n,r,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ve+e);if(t=Z(i)+1,r=i.d.length-1,n=r*V+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};y.squareRoot=y.sqrt=function(){var e,t,n,r,i,s,o,u=this,l=u.constructor;if(u.s<1){if(!u.s)return new l(0);throw Error(ge+"NaN")}for(e=Z(u),G=!1,i=Math.sqrt(+u),i==0||i==1/0?(t=ye(u.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=nt((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new l(t)):r=new l(i.toString()),n=l.precision,i=o=n+3;;)if(s=r,r=s.plus(Oe(u,s,o+2)).times(.5),ye(s.d).slice(0,o)===(t=ye(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(F(s,n+1,0),s.times(s).eq(u)){r=s;break}}else if(t!="9999")break;o+=4}return G=!0,F(r,n)};y.times=y.mul=function(e){var t,n,r,i,s,o,u,l,c,f=this,d=f.constructor,w=f.d,p=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,n=f.e+e.e,l=w.length,c=p.length,l<c&&(s=w,w=p,p=s,o=l,l=c,c=o),s=[],o=l+c,r=o;r--;)s.push(0);for(r=c;--r>=0;){for(t=0,i=l+r;i>r;)u=s[i]+p[r]*w[i-r-1]+t,s[i--]=u%ne|0,t=u/ne|0;s[i]=(s[i]+t)%ne|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,G?F(e,d.precision):e};y.toDecimalPlaces=y.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(_e(e,0,tt),t===void 0?t=r.rounding:_e(t,0,8),F(n,e+Z(n)+1,t))};y.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=ze(r,!0):(_e(e,0,tt),t===void 0?t=i.rounding:_e(t,0,8),r=F(new i(r),e+1,t),n=ze(r,!0,e+1)),n};y.toFixed=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?ze(i):(_e(e,0,tt),t===void 0?t=s.rounding:_e(t,0,8),r=F(new s(i),e+Z(i)+1,t),n=ze(r.abs(),!1,e+Z(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};y.toInteger=y.toint=function(){var e=this,t=e.constructor;return F(new t(e),Z(e)+1,t.rounding)};y.toNumber=function(){return+this};y.toPower=y.pow=function(e){var t,n,r,i,s,o,u=this,l=u.constructor,c=12,f=+(e=new l(e));if(!e.s)return new l(ce);if(u=new l(u),!u.s){if(e.s<1)throw Error(ge+"Infinity");return u}if(u.eq(ce))return u;if(r=l.precision,e.eq(ce))return F(u,r);if(t=e.e,n=e.d.length-1,o=t>=n,s=u.s,o){if((n=f<0?-f:f)<=ur){for(i=new l(ce),t=Math.ceil(r/V+4),G=!1;n%2&&(i=i.times(u),Fn(i.d,t)),n=nt(n/2),n!==0;)u=u.times(u),Fn(u.d,t);return G=!0,e.s<0?new l(ce).div(i):F(i,r)}}else if(s<0)throw Error(ge+"NaN");return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,u.s=1,G=!1,i=e.times(ft(u,r+c)),G=!0,i=lr(i),i.s=s,i};y.toPrecision=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?(n=Z(i),r=ze(i,n<=s.toExpNeg||n>=s.toExpPos)):(_e(e,1,tt),t===void 0?t=s.rounding:_e(t,0,8),i=F(new s(i),e,t),n=Z(i),r=ze(i,e<=n||n<=s.toExpNeg,e)),r};y.toSignificantDigits=y.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(_e(e,1,tt),t===void 0?t=r.rounding:_e(t,0,8)),F(new r(n),e,t)};y.toString=y.valueOf=y.val=y.toJSON=y[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=Z(e),n=e.constructor;return ze(e,t<=n.toExpNeg||t>=n.toExpPos)};function ar(e,t){var n,r,i,s,o,u,l,c,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),G?F(t,d):t;if(l=e.d,c=t.d,o=e.e,i=t.e,l=l.slice(),s=o-i,s){for(s<0?(r=l,s=-s,u=c.length):(r=c,i=o,u=l.length),o=Math.ceil(d/V),u=o>u?o+1:u+1,s>u&&(s=u,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(u=l.length,s=c.length,u-s<0&&(s=u,r=c,c=l,l=r),n=0;s;)n=(l[--s]=l[s]+c[s]+n)/ne|0,l[s]%=ne;for(n&&(l.unshift(n),++i),u=l.length;l[--u]==0;)l.pop();return t.d=l,t.e=i,G?F(t,d):t}function _e(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ve+e)}function ye(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)r=e[t]+"",n=V-r.length,n&&(s+=Pe(n)),s+=r;o=e[t],r=o+"",n=V-r.length,n&&(s+=Pe(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Oe=function(){function e(r,i){var s,o=0,u=r.length;for(r=r.slice();u--;)s=r[u]*i+o,r[u]=s%ne|0,o=s/ne|0;return o&&r.unshift(o),r}function t(r,i,s,o){var u,l;if(s!=o)l=s>o?1:-1;else for(u=l=0;u<s;u++)if(r[u]!=i[u]){l=r[u]>i[u]?1:-1;break}return l}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*ne+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var u,l,c,f,d,w,p,R,h,a,g,N,T,q,$,L,C,P,x=r.constructor,k=r.s==i.s?1:-1,D=r.d,M=i.d;if(!r.s)return new x(r);if(!i.s)throw Error(ge+"Division by zero");for(l=r.e-i.e,C=M.length,$=D.length,p=new x(k),R=p.d=[],c=0;M[c]==(D[c]||0);)++c;if(M[c]>(D[c]||0)&&--l,s==null?N=s=x.precision:o?N=s+(Z(r)-Z(i))+1:N=s,N<0)return new x(0);if(N=N/V+2|0,c=0,C==1)for(f=0,M=M[0],N++;(c<$||f)&&N--;c++)T=f*ne+(D[c]||0),R[c]=T/M|0,f=T%M|0;else{for(f=ne/(M[0]+1)|0,f>1&&(M=e(M,f),D=e(D,f),C=M.length,$=D.length),q=C,h=D.slice(0,C),a=h.length;a<C;)h[a++]=0;P=M.slice(),P.unshift(0),L=M[0],M[1]>=ne/2&&++L;do f=0,u=t(M,h,C,a),u<0?(g=h[0],C!=a&&(g=g*ne+(h[1]||0)),f=g/L|0,f>1?(f>=ne&&(f=ne-1),d=e(M,f),w=d.length,a=h.length,u=t(d,h,w,a),u==1&&(f--,n(d,C<w?P:M,w))):(f==0&&(u=f=1),d=M.slice()),w=d.length,w<a&&d.unshift(0),n(h,d,a),u==-1&&(a=h.length,u=t(M,h,C,a),u<1&&(f++,n(h,C<a?P:M,a))),a=h.length):u===0&&(f++,h=[0]),R[c++]=f,u&&h[0]?h[a++]=D[q]||0:(h=[D[q]],a=1);while((q++<$||h[0]!==void 0)&&N--)}return R[0]||R.shift(),p.e=l,F(p,o?s+Z(p)+1:s)}}();function lr(e,t){var n,r,i,s,o,u,l=0,c=0,f=e.constructor,d=f.precision;if(Z(e)>16)throw Error(gn+Z(e));if(!e.s)return new f(ce);for(G=!1,u=d,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),c+=5;for(r=Math.log(qe(2,c))/Math.LN10*2+5|0,u+=r,n=i=s=new f(ce),f.precision=u;;){if(i=F(i.times(e),u),n=n.times(++l),o=s.plus(Oe(i,n,u)),ye(o.d).slice(0,u)===ye(s.d).slice(0,u)){for(;c--;)s=F(s.times(s),u);return f.precision=d,t==null?(G=!0,F(s,d)):s}s=o}}function Z(e){for(var t=e.e*V,n=e.d[0];n>=10;n/=10)t++;return t}function Zt(e,t,n){if(t>e.LN10.sd())throw G=!0,n&&(e.precision=n),Error(ge+"LN10 precision limit exceeded");return F(new e(e.LN10),t)}function Pe(e){for(var t="";e--;)t+="0";return t}function ft(e,t){var n,r,i,s,o,u,l,c,f,d=1,w=10,p=e,R=p.d,h=p.constructor,a=h.precision;if(p.s<1)throw Error(ge+(p.s?"NaN":"-Infinity"));if(p.eq(ce))return new h(0);if(t==null?(G=!1,c=a):c=t,p.eq(10))return t==null&&(G=!0),Zt(h,c);if(c+=w,h.precision=c,n=ye(R),r=n.charAt(0),s=Z(p),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)p=p.times(e),n=ye(p.d),r=n.charAt(0),d++;s=Z(p),r>1?(p=new h("0."+n),s++):p=new h(r+"."+n.slice(1))}else return l=Zt(h,c+2,a).times(s+""),p=ft(new h(r+"."+n.slice(1)),c-w).plus(l),h.precision=a,t==null?(G=!0,F(p,a)):p;for(u=o=p=Oe(p.minus(ce),p.plus(ce),c),f=F(p.times(p),c),i=3;;){if(o=F(o.times(f),c),l=u.plus(Oe(o,new h(i),c)),ye(l.d).slice(0,c)===ye(u.d).slice(0,c))return u=u.times(2),s!==0&&(u=u.plus(Zt(h,c+2,a).times(s+""))),u=Oe(u,new h(d),c),h.precision=a,t==null?(G=!0,F(u,a)):u;u=l,i+=2}}function Hn(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(r,i),t){if(i-=r,n=n-r-1,e.e=nt(n/V),e.d=[],r=(n+1)%V,n<0&&(r+=V),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=V;r<i;)e.d.push(+t.slice(r,r+=V));t=t.slice(r),r=V-t.length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),G&&(e.e>It||e.e<-It))throw Error(gn+n)}else e.s=0,e.e=0,e.d=[0];return e}function F(e,t,n){var r,i,s,o,u,l,c,f,d=e.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(r=t-o,r<0)r+=V,i=t,c=d[f=0];else{if(f=Math.ceil((r+1)/V),s=d.length,f>=s)return e;for(c=s=d[f],o=1;s>=10;s/=10)o++;r%=V,i=r-V+o}if(n!==void 0&&(s=qe(10,o-i-1),u=c/s%10|0,l=t<0||d[f+1]!==void 0||c%s,l=n<4?(u||l)&&(n==0||n==(e.s<0?3:2)):u>5||u==5&&(n==4||l||n==6&&(r>0?i>0?c/qe(10,o-i):0:d[f-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return l?(s=Z(e),d.length=1,t=t-s-1,d[0]=qe(10,(V-t%V)%V),e.e=nt(-t/V)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=f,s=1,f--):(d.length=f+1,s=qe(10,V-r),d[f]=i>0?(c/qe(10,o-i)%qe(10,i)|0)*s:0),l)for(;;)if(f==0){(d[0]+=s)==ne&&(d[0]=1,++e.e);break}else{if(d[f]+=s,d[f]!=ne)break;d[f--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(G&&(e.e>It||e.e<-It))throw Error(gn+Z(e));return e}function cr(e,t){var n,r,i,s,o,u,l,c,f,d,w=e.constructor,p=w.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new w(e),G?F(t,p):t;if(l=e.d,d=t.d,r=t.e,c=e.e,l=l.slice(),o=c-r,o){for(f=o<0,f?(n=l,o=-o,u=d.length):(n=d,r=c,u=l.length),i=Math.max(Math.ceil(p/V),u)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=l.length,u=d.length,f=i<u,f&&(u=i),i=0;i<u;i++)if(l[i]!=d[i]){f=l[i]<d[i];break}o=0}for(f&&(n=l,l=d,d=n,t.s=-t.s),u=l.length,i=d.length-u;i>0;--i)l[u++]=0;for(i=d.length;i>o;){if(l[--i]<d[i]){for(s=i;s&&l[--s]===0;)l[s]=ne-1;--l[s],l[i]+=ne}l[i]-=d[i]}for(;l[--u]===0;)l.pop();for(;l[0]===0;l.shift())--r;return l[0]?(t.d=l,t.e=r,G?F(t,p):t):new w(0)}function ze(e,t,n){var r,i=Z(e),s=ye(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Pe(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Pe(-i-1)+s,n&&(r=n-o)>0&&(s+=Pe(r))):i>=o?(s+=Pe(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+Pe(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=Pe(r))),e.s<0?"-"+s:s}function Fn(e,t){if(e.length>t)return e.length=t,!0}function fr(e){var t,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ve+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Hn(o,s.toString())}else if(typeof s!="string")throw Error(Ve+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,Ni.test(s))Hn(o,s);else throw Error(Ve+s)}if(i.prototype=y,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=fr,i.config=i.set=_i,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function _i(e){if(!e||typeof e!="object")throw Error(ge+"Object expected");var t,n,r,i=["precision",1,tt,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((r=e[n=i[t]])!==void 0)if(nt(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(Ve+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ve+n+": "+r);return this}var vn=fr(yi);ce=new vn(1);const Ne=vn,W={of(e){return new Ne(e)},sum(...e){let t=new Ne(0);for(const n of e)t=t.plus(n);return t},toFormat(e,t,n,r){const i=e.toFixed(t,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[u,l]=i.split("."),c=[];for(let f=u.length;f>0;f-=s)c.unshift(u.slice(Math.max(0,f-s),f));return c.join(o)+(l?`.${l}`:"")},round(e,t,n){return W.of(e).toDecimalPlaces(t,n).toNumber()}};function Di(e){switch(e){case Y.Equal:return"==";case Y.NotEqual:return"!=";case Y.Lte:return"<=";case Y.Gte:return">=";case Y.LogicalAnd:return"&&";case Y.LogicalOr:return"||";case Y.Power:return"**";case Y.Nullish:return"??";case Y.Group:return"()";default:return String.fromCharCode(e)}}function de(e){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(e)}function at(e){return e==null}const rt=new Map;function Ai(e,t){const n=rt.get(e);if(n==null)throw new Error(`不支持的函数：${e}`);return n(...t)}function hr(){return new Error("Unexpected end of input")}function te(e){return new Error(`Unexpected end of input at position ${e.start}, near \`${Di(e.value)}\``)}function Ti(e,t,n){switch(e.value){case Y.Plus:{if(e.left==null||e.right==null)throw te(e);return typeof t=="string"||typeof n=="string"?t+n:de(t)&&de(n)?W.of(t).plus(n).toNumber():Number.NaN}case Y.Minus:{if(e.left==null&&e.right==null)throw te(e);return e.left==null&&e.right?-n:de(t)&&de(n)?W.of(t).minus(n).toNumber():Number.NaN}case Y.Asterisk:{if(e.left==null||e.right==null)throw te(e);return de(t)&&de(n)?W.of(t).times(n).toNumber():Number.NaN}case Y.Slash:{if(e.left==null||e.right==null)throw te(e);return de(t)&&de(n)?W.of(t).div(n).toNumber():Number.NaN}case Y.Percent:{if(e.left==null||e.right==null)throw te(e);return de(t)&&de(n)?W.of(t).mod(n).toNumber():Number.NaN}case Y.Power:{if(e.left==null||e.right==null)throw te(e);return de(t)&&de(n)?W.of(t).pow(n).toNumber():Number.NaN}case Y.Equal:{if(e.left==null||e.right==null)throw te(e);return at(t)&&at(n)?!0:t===n}case Y.NotEqual:{if(e.left==null||e.right==null)throw te(e);return at(t)&&at(n)?!1:t!==n}case Y.Lt:{if(e.left==null||e.right==null)throw te(e);return t<n}case Y.Lte:{if(e.left==null||e.right==null)throw te(e);return t<=n}case Y.Gt:{if(e.left==null||e.right==null)throw te(e);return t>n}case Y.Gte:{if(e.left==null||e.right==null)throw te(e);return t>=n}case Y.LogicalAnd:{if(e.left==null||e.right==null)throw te(e);return t&&n}case Y.LogicalOr:{if(e.left==null||e.right==null)throw te(e);return t||n}case Y.LogicalNot:{if(e.right==null)throw te(e);return!n}case Y.Nullish:{if(e.left==null||e.right==null)throw te(e);return at(t)?n:t}default:throw te(e)}}function bi(e,t){const r=(e.children??[]).map(i=>{if(i!=null)return Re(i,t)});return Ai(e.value,r)}function Si(e,t){var n;return t==null||typeof t!="object"?null:(n=t.data)==null?void 0:n[e.value]}function Ri(e,t){var n;return t==null||typeof t!="object"?null:(n=t.scope)==null?void 0:n[e.value]}function Oi(e,t){if(e.left==null||e.right==null||e.condition==null)throw hr();return Re(e.condition,t)?(e.result=Re(e.left,t),e.result):(e.result=Re(e.right,t),e.result)}function Re(e,t){switch(e.type){case Ee.NULL:return null;case Ee.UNDEFINED:return;case Ee.NUMBER:return Number(e.value);case Ee.STRING:return String(e.value);case Ee.TEMPLATE:{const r=(Array.isArray(e.value)?e.value:[e.value]).map(i=>Re(i,t));return e.result=r.join(""),e.result}case Ee.BOOLEAN:return!!e.value;case Ee.VARIABLE:return e.result=Si(e,t),e.result;case Ee.REFERENCE:return e.result=Ri(e,t),e.result;case Ee.FUNCTION:return e.result=bi(e,t),e.result;case Ee.OPERATOR:{if(e.isQuestion)return Oi(e,t);if(e.isGroup){if(e.right==null)throw te(e);return e.result=Re(e.right,t),e.result}const n=e.left?Re(e.left,t):null,r=e.right?Re(e.right,t):null;return e.result=Ti(e,n,r),e.result}default:throw hr()}}function Mi(e,t){return Re(e,t??{})}const dr="Resolve Element Value Pending Error",pr="ElementValueError";function H(e){const t=Object.create(null);return t.state=pe.DONE,t.raw=e,t}function Xe(){const e=Object.create(null);return e.state=pe.PENDING,e}function Ft(){const e=new Error(dr);return e.name=pr,e}function Ii(e){return e instanceof Error&&e.name===pr&&e.message===dr}function Li(e,t){const n=typeof t=="string"?mn(t)?Qe(t):null:t;if(n==null)return H();switch(n.value){case vt.CURRENT_DATE:return H(Date.now());case vt.PAGE_NUMBER:{const r=e.doc;return r==null?H():r.isPaged?H(e.pageNum):Xe()}case vt.PAGE_TOTAL:{const r=e.doc;return r==null?H():r.isPaged?H(r.pages.length):Xe()}case vt.ROW_INDEX:{const r=e.doc;if(r==null)return H();if(r.isPaged){if(e.type!==se.TABLE_CELL)return H();const i=e.parent;return i==null?H():H(i.rowIndex)}return Xe()}default:return H()}}function Pi(e,t){const n=typeof t=="string"?mn(t)?Qe(t):null:t;if(n==null)return H();switch(n.value){case Pr.ELEMENT_VALUR:return e.isProcessValueDone?H(e.getRawValue()):Xe();default:return H()}}function Ci(e,t,n){const r=typeof t=="string"?Qe(t):t,i=e.parent;if(i==null||!i.isBindVariable)return H(ct(n,r.value));const s=Qe(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?H():H(ct(i.rowData,r.value)):H(ct(n,r.value))}async function xi(e,t){const n=e.define;if(n.ds==null)return H();const r=n.ds,i=r.value;return et(i)?H():r.type===Et.TEMPLATE?ki(e,i):r.type===Et.VARIABLE?En(e,i,t):r.type===Et.FORMULA?mr(e,i,t):r.type===Et.CODE?$i(e,i):H(r.value)}function En(e,t,n,r=!1){const i=Qe(t);switch(i.varType){case zt.DS:return e.type===se.TABLE_CELL?Ci(e,i,n):e.type===se.TABLE_ROW?H(e.rowData):H(ct(n,r?i.path:i.value));case zt.BUILTIN:return Li(e,i);case zt.SPECIAL:return Pi(e,i);default:return H()}}function ki(e,t){return console.log("TODO: template:"+t),H()}function mr(e,t,n){try{const r=Cr.compile(t),i={data:{},scope:{}};for(const o of r.variable){const u=En(e,o.value,n);if(u.state===pe.PENDING)return Xe();Reflect.set(i.data,o.value,u.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{value:o.value,element:e});const s=Mi(r.root,i);return H(s)}catch(r){return Ii(r)?Xe():(console.log(r),H())}}async function $i(e,t){try{const r=new Function("element",`return (${t})(element)`)(e);if(r instanceof Promise){const i=await r;return H(i)}return H(r)}catch(n){return console.log(n),H()}}function Un(){const e=document.createElement("span"),t="important";return e.style.visibility="hidden",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.zIndex="-1",e.style.setProperty("line-height","1",t),e.style.setProperty("font-family","宋体",t),e.style.setProperty("padding","0",t),e.textContent="水",e}function qi(){const e=Un();e.style.fontSize="6px",document.body.appendChild(e);const t=Un();t.style.fontSize="12px",document.body.appendChild(t);const n=e.clientHeight<t.clientHeight;return document.body.removeChild(e),document.body.removeChild(t),n}let gr=function(){const e=qi();return gr=function(){return e},e};const Hi=/Chrome/.test(navigator.userAgent);function wn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var we={},Bn;function vr(){if(Bn)return we;Bn=1;var e=/^([+-])?0*(\d+)(\.(\d+))?$/,t=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=we.e2ten=function(i){var s=t.exec(i.toString());if(!s)return i;var o=s[2],u=s[4]||"",l=s[5]?+s[5]:0;if(l>0){var c=u.substr(0,l);c=c.length<l?c+new Array(l-c.length+1).join("0"):c,u=u.substr(l),o+=c}else{l=-l;var f=o.length-l;f=f<0?0:f;var d=o.substr(f,l);d=d.length<l?new Array(l-d.length+1).join("0")+d:d,o=o.substring(0,f),u=d+u}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(u?"."+u:"")};we.getNumbResult=function(i){var s=e.exec(i.toString());if(!s&&t.test(i.toString())&&(s=e.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},we.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var u=[].slice.call(arguments,2);u.unshift(s),i.apply(null,u)}return s};var r=we.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return we.extend=function(i){for(var s,o=arguments[0]||{},u=Array.prototype.slice.call(arguments,1),l=0;l<u.length;l++){var c=u[l];for(s in c)r(c,s)&&(o[s]=c[s])}return o},we.getDigit=function(i){return i>=5?(i-4)*4+4:i},we.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},we.clearZero=function(i,s,o){if(i==null)return"";var u=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,l=new RegExp("^"+u+"+"),c=new RegExp(u+"+$"),f=new RegExp(u+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(l,"")),(!o||o=="$")&&(i=i.replace(c,"")),(!o||o=="nto1")&&(i=i.replace(f,s)),i},we}var Xt,Yn;function Fi(){if(Yn)return Xt;Yn=1;var e=vr();function t(i,s){var o=e.getNumbResult(i);if(!o)return i;s=s||{};var u=this.ch,l=this.ch_u,c=this.ch_f||"",f=this.ch_d||".",d=u.charAt(0),w=o.int,p=o.decimal,R=o.minus,h="",a="",g=R?c:"",N=function C(P,x,k){P=e.getNumbResult(P).int;var D="",M=arguments.length>1?arguments[1]:s.tenMin,J=P.length;if(J==1)return u.charAt(+P);if(J<=4)for(var A=0,E=J;E--;){var m=+P.charAt(A);D+=M&&J==2&&A==0&&m==1?"":u.charAt(m),D+=m&&E?l.charAt(E):"",A++}else{for(var _=P.length/4>>0,v=P.length%4;v==0||!l.charAt(3+_);)v+=4,_--;var b=P.substr(0,v),S=P.substr(v);D=C(b,M)+l.charAt(3+_)+(S.charAt(0)=="0"?d:"")+C(S,S.length>4?M:!1)}return D=e.clearZero(D,d),D};if(p){p=e.clearZero(p,"0","$");for(var T=0;T<p.length;T++)a+=u.charAt(+p.charAt(T));a=a?f+a:""}if(h=N(w),s.ww&&l.length>5){var q=l.charAt(4),$=l.charAt(5),L=h.lastIndexOf($);~L&&(h=h.substring(0,L).replace(new RegExp($,"g"),q+q)+h.substring(L))}return g+h+a}function n(i,s){i=i.toString();var o=i.split(this.ch_d),u=o[0].replace(this.ch_f,""),l=o[1],c=!!~o[0].indexOf(this.ch_f),f=this.ch_u.charAt(1),d=this.ch_u.charAt(4),w=this.ch_u.charAt(5);u=u.replace(new RegExp(d+"{2}(?!"+d+")","g"),w);for(var p=u.split(""),R=0,h=0,a=[],g=[],N=[],T=0;T<p.length;T++){var q=p[T],$=0,L=0;if(~($=this.ch.indexOf(q)))$>0&&N.unshift($);else if(~(L=this.ch_u.indexOf(q))){var C=e.getDigit(L);R>L?(e.unshiftZero(N,C),e.centerArray(g,N)):L>=h?(T==0&&(N=[1]),e.centerArray(a,g,N),a.length>0&&e.unshiftZero(a,C),h=L):(N.length==0&&f==q&&(N=[1]),e.centerArray(g,N),e.unshiftZero(g,e.getDigit(L)),R=L)}}e.centerArray(a,g,N).reverse(),a.length==0&&a.push(0);var P=0;if(l){a.push("."),P="0.";for(var T=0;T<l.length;T++)P+=this.ch.indexOf(l.charAt(T)),a.push(this.ch.indexOf(l.charAt(T)));P=+P}return c&&a.unshift("-"),s&&s.outputString?a.join(""):parseFloat(a.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},u=e.getNumbResult(i),l=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!u)return i;s=e.extend(o,s);var c=u.int,f=u.decimal||"",d=s.outSymbol?this.m_t:"",w=u.minus?this.ch_f:"",p="";if(s.complete){for(var R=1;R<this.m_u.length;R++)p+=t.call(this,f.charAt(R-1)||"0")+this.m_u.charAt(R);w+=t.call(this,c,s)+this.m_u.charAt(0)}else{var h=s.unOmitYuan||c!=="0";if(f=f.substr(0,this.m_u.length-1),f=e.clearZero(f,"0","$"),f)for(var a,R=0;R<this.m_u.length-1;R++)f.charAt(R)&&f.charAt(R)!="0"&&(p+=t.call(this,f.charAt(R))+this.m_u.charAt(R+1),a=!1),f.charAt(R)==="0"&&!a&&((R!=0||c!=="0")&&(p+=l),a=!0);(h||!p)&&(w+=t.call(this,c,s)+this.m_u.charAt(0)),s.forceZheng?(p==""||p.charAt(p.length-1)!==this.m_u[2])&&(p+=this.m_z):w+=u.decimal?"":this.m_z,s.forceZheng}return d+w+p}return Xt={CL:t,unCL:n,toMoney:r},Xt}var Jt,Vn;function Ui(){if(Vn)return Jt;Vn=1;var e=Fi(),t=vr();function n(r,i){return{encodeS:function(s,o){return o=t.extend({ww:!0,tenMin:!0},o),e.CL.call(r,s,o)},encodeB:function(s,o){return o=t.extend({ww:!0},o),e.CL.call(i,s,o)},decodeS:function(){return e.unCL.apply(r,arguments)},decodeB:function(){return e.unCL.apply(i,arguments)},toMoney:function(s,o){return o=t.extend({ww:!0},o),e.toMoney.call(i,s,o)}}}return Jt=n,Jt}var Kt,Gn;function Bi(){return Gn||(Gn=1,Kt={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),Kt}var Qt,zn;function Yi(){return zn||(zn=1,Qt={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),Qt}var en,jn;function Vi(){if(jn)return en;jn=1;var e=Ui(),t={s:Bi(),b:Yi()};return en=e(t.s,t.b),en}var Gi=Vi();const zi=wn(Gi);var Tt={exports:{}},ji=Tt.exports,Wn;function Wi(){return Wn||(Wn=1,function(e,t){(function(n,r){e.exports=r()})(ji,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",u="minute",l="hour",c="day",f="week",d="month",w="quarter",p="year",R="date",h="Invalid Date",a=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(A){var E=["th","st","nd","rd"],m=A%100;return"["+A+(E[(m-20)%10]||E[m]||E[0])+"]"}},T=function(A,E,m){var _=String(A);return!_||_.length>=E?A:""+Array(E+1-_.length).join(m)+A},q={s:T,z:function(A){var E=-A.utcOffset(),m=Math.abs(E),_=Math.floor(m/60),v=m%60;return(E<=0?"+":"-")+T(_,2,"0")+":"+T(v,2,"0")},m:function A(E,m){if(E.date()<m.date())return-A(m,E);var _=12*(m.year()-E.year())+(m.month()-E.month()),v=E.clone().add(_,d),b=m-v<0,S=E.clone().add(_+(b?-1:1),d);return+(-(_+(m-v)/(b?v-S:S-v))||0)},a:function(A){return A<0?Math.ceil(A)||0:Math.floor(A)},p:function(A){return{M:d,y:p,w:f,d:c,D:R,h:l,m:u,s:o,ms:s,Q:w}[A]||String(A||"").toLowerCase().replace(/s$/,"")},u:function(A){return A===void 0}},$="en",L={};L[$]=N;var C="$isDayjsObject",P=function(A){return A instanceof M||!(!A||!A[C])},x=function A(E,m,_){var v;if(!E)return $;if(typeof E=="string"){var b=E.toLowerCase();L[b]&&(v=b),m&&(L[b]=m,v=b);var S=E.split("-");if(!v&&S.length>1)return A(S[0])}else{var I=E.name;L[I]=E,v=I}return!_&&v&&($=v),v||!_&&$},k=function(A,E){if(P(A))return A.clone();var m=typeof E=="object"?E:{};return m.date=A,m.args=arguments,new M(m)},D=q;D.l=x,D.i=P,D.w=function(A,E){return k(A,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var M=function(){function A(m){this.$L=x(m.locale,null,!0),this.parse(m),this.$x=this.$x||m.x||{},this[C]=!0}var E=A.prototype;return E.parse=function(m){this.$d=function(_){var v=_.date,b=_.utc;if(v===null)return new Date(NaN);if(D.u(v))return new Date;if(v instanceof Date)return new Date(v);if(typeof v=="string"&&!/Z$/i.test(v)){var S=v.match(a);if(S){var I=S[2]-1||0,B=(S[7]||"0").substring(0,3);return b?new Date(Date.UTC(S[1],I,S[3]||1,S[4]||0,S[5]||0,S[6]||0,B)):new Date(S[1],I,S[3]||1,S[4]||0,S[5]||0,S[6]||0,B)}}return new Date(v)}(m),this.init()},E.init=function(){var m=this.$d;this.$y=m.getFullYear(),this.$M=m.getMonth(),this.$D=m.getDate(),this.$W=m.getDay(),this.$H=m.getHours(),this.$m=m.getMinutes(),this.$s=m.getSeconds(),this.$ms=m.getMilliseconds()},E.$utils=function(){return D},E.isValid=function(){return this.$d.toString()!==h},E.isSame=function(m,_){var v=k(m);return this.startOf(_)<=v&&v<=this.endOf(_)},E.isAfter=function(m,_){return k(m)<this.startOf(_)},E.isBefore=function(m,_){return this.endOf(_)<k(m)},E.$g=function(m,_,v){return D.u(m)?this[_]:this.set(v,m)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(m,_){var v=this,b=!!D.u(_)||_,S=D.p(m),I=function(ve,re){var fe=D.w(v.$u?Date.UTC(v.$y,re,ve):new Date(v.$y,re,ve),v);return b?fe:fe.endOf(c)},B=function(ve,re){return D.w(v.toDate()[ve].apply(v.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(re)),v)},z=this.$W,ee=this.$M,oe=this.$D,Ie="set"+(this.$u?"UTC":"");switch(S){case p:return b?I(1,0):I(31,11);case d:return b?I(1,ee):I(0,ee+1);case f:var De=this.$locale().weekStart||0,$e=(z<De?z+7:z)-De;return I(b?oe-$e:oe+(6-$e),ee);case c:case R:return B(Ie+"Hours",0);case l:return B(Ie+"Minutes",1);case u:return B(Ie+"Seconds",2);case o:return B(Ie+"Milliseconds",3);default:return this.clone()}},E.endOf=function(m){return this.startOf(m,!1)},E.$set=function(m,_){var v,b=D.p(m),S="set"+(this.$u?"UTC":""),I=(v={},v[c]=S+"Date",v[R]=S+"Date",v[d]=S+"Month",v[p]=S+"FullYear",v[l]=S+"Hours",v[u]=S+"Minutes",v[o]=S+"Seconds",v[s]=S+"Milliseconds",v)[b],B=b===c?this.$D+(_-this.$W):_;if(b===d||b===p){var z=this.clone().set(R,1);z.$d[I](B),z.init(),this.$d=z.set(R,Math.min(this.$D,z.daysInMonth())).$d}else I&&this.$d[I](B);return this.init(),this},E.set=function(m,_){return this.clone().$set(m,_)},E.get=function(m){return this[D.p(m)]()},E.add=function(m,_){var v,b=this;m=Number(m);var S=D.p(_),I=function(ee){var oe=k(b);return D.w(oe.date(oe.date()+Math.round(ee*m)),b)};if(S===d)return this.set(d,this.$M+m);if(S===p)return this.set(p,this.$y+m);if(S===c)return I(1);if(S===f)return I(7);var B=(v={},v[u]=r,v[l]=i,v[o]=n,v)[S]||1,z=this.$d.getTime()+m*B;return D.w(z,this)},E.subtract=function(m,_){return this.add(-1*m,_)},E.format=function(m){var _=this,v=this.$locale();if(!this.isValid())return v.invalidDate||h;var b=m||"YYYY-MM-DDTHH:mm:ssZ",S=D.z(this),I=this.$H,B=this.$m,z=this.$M,ee=v.weekdays,oe=v.months,Ie=v.meridiem,De=function(re,fe,Ae,Le){return re&&(re[fe]||re(_,b))||Ae[fe].slice(0,Le)},$e=function(re){return D.s(I%12||12,re,"0")},ve=Ie||function(re,fe,Ae){var Le=re<12?"AM":"PM";return Ae?Le.toLowerCase():Le};return b.replace(g,function(re,fe){return fe||function(Ae){switch(Ae){case"YY":return String(_.$y).slice(-2);case"YYYY":return D.s(_.$y,4,"0");case"M":return z+1;case"MM":return D.s(z+1,2,"0");case"MMM":return De(v.monthsShort,z,oe,3);case"MMMM":return De(oe,z);case"D":return _.$D;case"DD":return D.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return De(v.weekdaysMin,_.$W,ee,2);case"ddd":return De(v.weekdaysShort,_.$W,ee,3);case"dddd":return ee[_.$W];case"H":return String(I);case"HH":return D.s(I,2,"0");case"h":return $e(1);case"hh":return $e(2);case"a":return ve(I,B,!0);case"A":return ve(I,B,!1);case"m":return String(B);case"mm":return D.s(B,2,"0");case"s":return String(_.$s);case"ss":return D.s(_.$s,2,"0");case"SSS":return D.s(_.$ms,3,"0");case"Z":return S}return null}(re)||S.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(m,_,v){var b,S=this,I=D.p(_),B=k(m),z=(B.utcOffset()-this.utcOffset())*r,ee=this-B,oe=function(){return D.m(S,B)};switch(I){case p:b=oe()/12;break;case d:b=oe();break;case w:b=oe()/3;break;case f:b=(ee-z)/6048e5;break;case c:b=(ee-z)/864e5;break;case l:b=ee/i;break;case u:b=ee/r;break;case o:b=ee/n;break;default:b=ee}return v?b:D.a(b)},E.daysInMonth=function(){return this.endOf(d).$D},E.$locale=function(){return L[this.$L]},E.locale=function(m,_){if(!m)return this.$L;var v=this.clone(),b=x(m,_,!0);return b&&(v.$L=b),v},E.clone=function(){return D.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},A}(),J=M.prototype;return k.prototype=J,[["$ms",s],["$s",o],["$m",u],["$H",l],["$W",c],["$M",d],["$y",p],["$D",R]].forEach(function(A){J[A[1]]=function(E){return this.$g(E,A[0],A[1])}}),k.extend=function(A,E){return A.$i||(A(E,M,k),A.$i=!0),k},k.locale=x,k.isDayjs=P,k.unix=function(A){return k(1e3*A)},k.en=L[$],k.Ls=L,k.p={},k})}(Tt)),Tt.exports}var Zi=Wi();const Me=wn(Zi);var bt={exports:{}},Xi=bt.exports,Zn;function Ji(){return Zn||(Zn=1,function(e,t){(function(n,r){e.exports=r()})(Xi,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,u=/\d*[^-_:/,()\s\d]+/,l={},c=function(a){return(a=+a)+(a>68?1900:2e3)},f=function(a){return function(g){this[a]=+g}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(a){(this.zone||(this.zone={})).offset=function(g){if(!g||g==="Z")return 0;var N=g.match(/([+-]|\d\d)/g),T=60*N[1]+(+N[2]||0);return T===0?0:N[0]==="+"?-T:T}(a)}],w=function(a){var g=l[a];return g&&(g.indexOf?g:g.s.concat(g.f))},p=function(a,g){var N,T=l.meridiem;if(T){for(var q=1;q<=24;q+=1)if(a.indexOf(T(q,0,g))>-1){N=q>12;break}}else N=a===(g?"pm":"PM");return N},R={A:[u,function(a){this.afternoon=p(a,!1)}],a:[u,function(a){this.afternoon=p(a,!0)}],Q:[i,function(a){this.month=3*(a-1)+1}],S:[i,function(a){this.milliseconds=100*+a}],SS:[s,function(a){this.milliseconds=10*+a}],SSS:[/\d{3}/,function(a){this.milliseconds=+a}],s:[o,f("seconds")],ss:[o,f("seconds")],m:[o,f("minutes")],mm:[o,f("minutes")],H:[o,f("hours")],h:[o,f("hours")],HH:[o,f("hours")],hh:[o,f("hours")],D:[o,f("day")],DD:[s,f("day")],Do:[u,function(a){var g=l.ordinal,N=a.match(/\d+/);if(this.day=N[0],g)for(var T=1;T<=31;T+=1)g(T).replace(/\[|\]/g,"")===a&&(this.day=T)}],w:[o,f("week")],ww:[s,f("week")],M:[o,f("month")],MM:[s,f("month")],MMM:[u,function(a){var g=w("months"),N=(w("monthsShort")||g.map(function(T){return T.slice(0,3)})).indexOf(a)+1;if(N<1)throw new Error;this.month=N%12||N}],MMMM:[u,function(a){var g=w("months").indexOf(a)+1;if(g<1)throw new Error;this.month=g%12||g}],Y:[/[+-]?\d+/,f("year")],YY:[s,function(a){this.year=c(a)}],YYYY:[/\d{4}/,f("year")],Z:d,ZZ:d};function h(a){var g,N;g=a,N=l&&l.formats;for(var T=(a=g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(k,D,M){var J=M&&M.toUpperCase();return D||N[M]||n[M]||N[J].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(A,E,m){return E||m.slice(1)})})).match(r),q=T.length,$=0;$<q;$+=1){var L=T[$],C=R[L],P=C&&C[0],x=C&&C[1];T[$]=x?{regex:P,parser:x}:L.replace(/^\[|\]$/g,"")}return function(k){for(var D={},M=0,J=0;M<q;M+=1){var A=T[M];if(typeof A=="string")J+=A.length;else{var E=A.regex,m=A.parser,_=k.slice(J),v=E.exec(_)[0];m.call(D,v),k=k.replace(v,"")}}return function(b){var S=b.afternoon;if(S!==void 0){var I=b.hours;S?I<12&&(b.hours+=12):I===12&&(b.hours=0),delete b.afternoon}}(D),D}}return function(a,g,N){N.p.customParseFormat=!0,a&&a.parseTwoDigitYear&&(c=a.parseTwoDigitYear);var T=g.prototype,q=T.parse;T.parse=function($){var L=$.date,C=$.utc,P=$.args;this.$u=C;var x=P[1];if(typeof x=="string"){var k=P[2]===!0,D=P[3]===!0,M=k||D,J=P[2];D&&(J=P[2]),l=this.$locale(),!k&&J&&(l=N.Ls[J]),this.$d=function(_,v,b,S){try{if(["x","X"].indexOf(v)>-1)return new Date((v==="X"?1e3:1)*_);var I=h(v)(_),B=I.year,z=I.month,ee=I.day,oe=I.hours,Ie=I.minutes,De=I.seconds,$e=I.milliseconds,ve=I.zone,re=I.week,fe=new Date,Ae=ee||(B||z?1:fe.getDate()),Le=B||fe.getFullYear(),mt=0;B&&!z||(mt=z>0?z-1:fe.getMonth());var gt,Ut=oe||0,Bt=Ie||0,Yt=De||0,Vt=$e||0;return ve?new Date(Date.UTC(Le,mt,Ae,Ut,Bt,Yt,Vt+60*ve.offset*1e3)):b?new Date(Date.UTC(Le,mt,Ae,Ut,Bt,Yt,Vt)):(gt=new Date(Le,mt,Ae,Ut,Bt,Yt,Vt),re&&(gt=S(gt).week(re).toDate()),gt)}catch{return new Date("")}}(L,x,C,N),this.init(),J&&J!==!0&&(this.$L=this.locale(J).$L),M&&L!=this.format(x)&&(this.$d=new Date("")),l={}}else if(x instanceof Array)for(var A=x.length,E=1;E<=A;E+=1){P[1]=x[E-1];var m=N.apply(this,P);if(m.isValid()){this.$d=m.$d,this.$L=m.$L,this.init();break}E===A&&(this.$d=new Date(""))}else q.call(this,$)}}})}(bt)),bt.exports}var Ki=Ji();const Qi=wn(Ki);Me.extend(Qi);function es(e){switch(e){case jt.FLOOR:return Ne.ROUND_FLOOR;case jt.CEIL:return Ne.ROUND_CEIL;case jt.BANKER_ROUND:return Ne.ROUND_HALF_EVEN;default:return Ne.ROUND_HALF_UP}}function ts(e,t){if(e==null)return"";const n=t.format,r=es(t.round),i=t.showZero===!1;switch(n){case ot.FIXED:{const s=t.precision;if(s==null||s<0)return e.toString();const o=typeof e=="number"?W.of(e):e;return o.eq(0)&&i?"":o.toFixed(s,r)}case ot.THOUSAND:{const s=typeof e=="number"?W.of(e):e;return s.eq(0)&&i?"":W.toFormat(s,2,r,{groupSize:3})}case ot.TEN_THOUSAND:{const s=typeof e=="number"?W.of(e):e;return s.eq(0)&&i?"":W.toFormat(s,2,r,{groupSize:4})}case ot.DAXIE:{const s=typeof e=="number"?W.of(e):e;return s.eq(0)&&i?"":zi.toMoney(s.toFixed(2,r),{outSymbol:!1})}case ot.PERCENTAGE:{const s=typeof e=="number"?W.of(e):e;return s.eq(0)&&i?"":s.times(100).toFixed(2,Ne.ROUND_HALF_UP)+"%"}default:return typeof e=="number"?e==0&&i?"":e.toString():e.eq(0)&&i?"":e.toString()}}function ns(e,t){const n=t.format;return n==null?e:Me(e).format(n)}function rs(e,t){const n=e.attributes;switch(e.display){case se.NUMBER:return ts(t,n);case se.DATE:return ns(t,n);default:return t}}const Xn=Object.create(null);var kt,Je;const $t=class $t{constructor(t){he(this,kt,dn(pn.PRINT_ELEMENT));he(this,Je,Object.create(null));O(this,"define");O(this,"children",[]);O(this,"atomized",!1);O(this,"extra",!1);O(this,"parent");O(this,"offsetTop",0);O(this,"offsetLeft",0);O(this,"offsetWidth",0);O(this,"offsetHeight",0);O(this,"element");O(this,"zIndex");O(this,"state",un.CREATED);O(this,"visibility",Te.PENDING);O(this,"value",{state:pe.UNDEFINED});this.define=t,this.offsetTop=t.offsetTop,this.offsetLeft=t.offsetLeft,this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.zIndex=t.zIndex,Be(this,"parent",null),Be(this,"element",null)}static register(t,n){Xn[t]=n}static create(t){const n=Xn[t.type]??$t;return new n(t)}get id(){return"@"+U(this,kt)}get type(){return this.define.type}get page(){let t=this.parent;for(;t;){if(t instanceof Mt)return t;t=t.parent}return null}get doc(){var t;return(t=this.page)==null?void 0:t.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const t=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return t+n}get pageNum(){var t;return((t=this.page)==null?void 0:t.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const t=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${t}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===_t.AUTO}get isOverflowScale(){return this.define.attributes.overflow===_t.SCALE}get isOverflowHidden(){const t=this.define.attributes.overflow;return t==null||t===_t.HIDDEN}get isProcessValueDone(){return this.value.state===pe.DONE}get isHidden(){return this.visibility===Te.HIDDEN}async processValue(){var t,n,r;if(!this.isProcessValueDone)switch(this.value=await xi(this,(t=this.doc)==null?void 0:t.data),this.value.state){case pe.DONE:(n=this.doc)==null||n.removeDependency(this);break;case pe.PENDING:(r=this.doc)==null||r.addDependency(this,{state:pe.PENDING});break}}getRawValue(){if(this.value.state===pe.DONE)return this.value.raw}format(){return rs(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(t=>t.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const t=this.content;return xr(t)?null:Q("div",{class:"quickprint-content",children:Q("span",{children:this.content})})}async updateElement(){const t=this.parent;if(t==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await t.replaceChild(this,n)}async mountChild(t){var n;return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),await Ge(),await t.mount(t.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(t,n){var r;return this.element==null||t.element==null?!1:(n==null?this.element.removeChild(t.element):this.element.replaceChild(n,t.element),await Ge(),await t.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(t){t!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.state=un.MOUNDTED,this.element=t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),U(this,Je)[t.id]=t}clone(){const t=$t.create(this.define),n=this.children.map(r=>r.clone());return t.appendMany(n),t}checkOverflow(){if(this.element==null)return!1;const t=this.element.querySelector(".quickprint-content");if(t==null)return!1;const n=t.parentElement;return n==null?!1:n.offsetHeight<t.offsetHeight}processOverflow(){return this.isOverflowScale?gr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const t=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return t==null||(t.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(t){const n=U(this,Je)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}findElementFromDefine(t){return this.children.find(n=>n.define.id===t)}createElements(){it(this,Je,this.children.reduce((t,n)=>(t[n.id]=n,t),Object.create(null)))}checkVisibility(){var i,s,o;const t=this.define;if(t.visibility==null||t.visibility.type===Mn.VISIBLE)return Te.VISIBLE;if(t.visibility.type===Mn.HIDDEN)return Te.HIDDEN;const n=t.visibility.condition;if(et(n))return Te.VISIBLE;const r=mr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case pe.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Te.VISIBLE:Te.HIDDEN;case pe.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:pe.PENDING}),Te.PENDING;default:return Te.PENDING}}};kt=new WeakMap,Je=new WeakMap;let X=$t;function wt(e,t){return t.exclude==null?!0:!t.exclude.includes(e)}function pt(e){var s;const t={};if(!Hi)return t;const n=e.define,r=n.style.fontFamily;return(r==null||r===rn.SONG)&&((s=n.style)==null?void 0:s.fontWeight)===700&&(t["quickprint-patch-song-blod"]=!0),t}function Er(e,t){const n=[];if(t&&t!=rn.DEFAULT&&n.push(`"${t}"`),e&&e!==rn.DEFAULT&&n.push(`"${e}"`),n.length!=0)return n.join(",")}function is(e){if(e.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:e.underlineStyle,textDecorationColor:e.underlineColor}}function ss(e){if(e==null)return{};const t=e.style??{},n={};return t.textAlign&&(n.textAlign=t.textAlign),t.textAlignLast&&(n.textAlignLast=t.textAlignLast),n}function os(e){if(e==null)return{};const t=e.style??{};return t.verticalAlign==In.MIDDLE||t.verticalAlign==null?{display:"flex",alignItems:"center"}:t.verticalAlign==In.BOTTOM?{display:"flex",alignItems:"end"}:{}}function us(e){if(e==null)return{};const t=e.style??{};if(t.padding==null)return{};const n={};return t.padding.top&&(n.paddingTop=t.padding.top),t.padding.right&&(n.paddingRight=t.padding.right),t.padding.bottom&&(n.paddingBottom=t.padding.bottom),t.padding.left&&(n.paddingLeft=t.padding.left),n}function cn(e){if(e==null)return{};const t=e.style??{};if(t.border==null||t.border===je.NONE)return{};const n={},r=t.borderWidth??1,i=t.borderStyle??kr.SOLID,s=t.borderColor??$r.BLACK;return t.border==je.ALL?{borderTop:`${r}px ${i} ${s}`,borderRight:`${r}px ${i} ${s}`,borderBottom:`${r}px ${i} ${s}`,borderLeft:`${r}px ${i} ${s}`}:(t.border&je.TOP&&(n.borderTop=`${r}px ${i} ${s}`),t.border&je.RIGHT&&(n.borderRight=`${r}px ${i} ${s}`),t.border&je.BOTTOM&&(n.borderBottom=`${r}px ${i} ${s}`),t.border&je.LEFT&&(n.borderLeft=`${r}px ${i} ${s}`),n)}function yn(e,t={}){const n={},r=e.define.style??{},i=Er(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=is(r);return s&&lt(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),r.padding&&lt(n,us(e.define)),lt(n,ss(e.define)),lt(n,os(e.define)),n}function Nn(e,t={}){const n={};if(wt("top",t)&&(n.top=e.offsetTop+"px"),wt("left",t)&&(n.left=e.offsetLeft+"px"),wt("width",t)&&(n.width=e.offsetWidth+"px"),wt("height",t)){const r=e.define.attributes.overflow===_t.AUTO?"min-height":"height";n[r]=e.offsetHeight+"px"}return e.zIndex&&(n.zIndex=e.zIndex),n}function _n(e,t={}){return tr(Nn(e,t),yn(e,t),cn(e.define))}class as extends X{get style(){return _n(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class ls extends X{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...pt(this)}}processConstNode(t){var i;const n=t.dataset.value;if(et(n))return;const r=En(this,n,(i=this.doc)==null?void 0:i.data);t.textContent=r.raw}process(t){for(const n of Array.from(t.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return t}render(){if(this.isHidden)return null;const t=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=t,Q("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class cs extends X{get style(){return _n(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class fs extends X{get style(){return _n(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class wr extends X{constructor(){super(...arguments);O(this,"rendering",0)}get style(){return{...tr(Nn(this),yn(this)),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>Q("col",{width:s}));return Q("div",{id:this.id,class:this.className,style:this.style,children:Q("table",{children:[Q("colgroup",{children:i}),Q("tbody",{})]})})}async mountChild(n){var i;if(n.element==null)return!1;const r=this.getTableBody();return r==null?!1:(r.appendChild(n.element),await Ge(),await n.mount(n.element),this.offsetHeight=((i=this.element)==null?void 0:i.offsetHeight)??0,!0)}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await Ge(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n),i=this.getTableBody();if(this.children.length=n,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class hs extends X{constructor(){super(...arguments);O(this,"repeatIndex",-1);O(this,"rowData");O(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return Q("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=un.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}}class Dn extends X{get style(){var r;const t=cn((r=this.define.parent)==null?void 0:r.parent),n=cn(this.define);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-height":this.offsetHeight+"px",...lt(t,n)}}get className(){const t=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(t==null?void 0:t.isOverflowAuto)===!0,"quickprint-fixed-height":(t==null?void 0:t.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}get isCollapsed(){return this.define.attributes.colspan===0||this.define.attributes.rowspan===0}render(){if(this.isCollapsed)return null;const n=this.define.attributes,r=this.isHidden?null:Q("div",{class:"quickprint-layout",style:yn(this),children:this.createContent()});return Q("td",{id:this.id,class:this.className,style:this.style,rowspan:n.rowspan,colspan:n.colspan,children:r})}}X.register(se.TEXT,as);X.register(se.PARAGRAPH,ls);X.register(se.NUMBER,cs);X.register(se.DATE,fs);X.register(se.TABLE,wr);X.register(se.TABLE_ROW,hs);X.register(se.TABLE_CELL,Dn);function ds(e){return Number(e)}function ps(e){return Math.abs(e)}function ms(e){return Math.trunc(e)}function gs(...e){return Math.min(...e)}function vs(...e){return Math.max(...e)}function Es(e,t){return W.round(e,t??0,Ne.ROUND_CEIL)}function ws(e,t){return W.round(e,t??0,Ne.ROUND_FLOOR)}function ys(e,t,n){return W.round(e,t??0,n??Ne.ROUND_HALF_UP)}function Ns(e){e.set("NUMBER",ds),e.set("ABS",ps),e.set("TRUNC",ms),e.set("MIN",gs),e.set("MAX",vs),e.set("CEIL",Es),e.set("FLOOR",ws),e.set("ROUND",ys)}function _s(e){return String(e)}function Ds(e){return String(e).length}function As(e){return String(e).toLowerCase()}function Ts(e){return String(e).toUpperCase()}function bs(e){const t=String(e);return t[0].toUpperCase()+t.slice(1)}function Ss(e){return String(e).trim()}function Rs(e,t,n){return String(e).replace(t,n)}function Os(e,t,n){return String(e).replaceAll(t,n)}function Ms(e,t,n){return String(e).slice(t,n)}function Is(e,t,n){return String(e).includes(String(t),n)}function Ls(e,t,n){return String(e).indexOf(String(t),n)}function Ps(e,t,n){return String(e).lastIndexOf(String(t),n)}function Cs(e,t,n){return String(e).startsWith(String(t),n)}function xs(e,t,n){return String(e).endsWith(String(t),n)}function ks(e){e.set("STRING",_s),e.set("LENGTH",Ds),e.set("LOWER",As),e.set("UPPER",Ts),e.set("TRIM",Ss),e.set("UPPER_FIRST",bs),e.set("REPLACE",Rs),e.set("REPLACE_ALL",Os),e.set("SLICE",Ms),e.set("INCLUDES",Is),e.set("INDEX_OF",Ls),e.set("LAST_INDEX_OF",Ps),e.set("STARTS_WITH",Cs),e.set("ENDS_WITH",xs)}function $s(e,t,n){return e?t:n}function qs(e,t){return Number.isNaN(e)?t:e}function Hs(e,t){return Number.isNaN(e)||e==null?t:e}function Fs(e,...t){for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];if(i===e)return s}return t.length%2===0?void 0:t[t.length-1]}function yr(e){return Number.isNaN(e)}function Us(e){return Number.isInteger(e)}function Nr(e){return typeof e=="number"}function _r(e){return typeof e=="string"}function Bs(e){return typeof e=="boolean"}function Dr(e){return e===null}function Ar(e){return e===void 0}function Tr(e){return Dr(e)||Ar(e)}function Ys(e){return Tr(e)?!0:_r(e)?e.length==0:Nr(e)?!yr(e):!1}function Vs(e){e.set("IF",$s),e.set("IFNA",qs),e.set("IFERROR",Hs),e.set("IS_NAN",yr),e.set("IS_INTEGER",Us),e.set("IS_NUMBER",Nr),e.set("IS_STRING",_r),e.set("IS_BOOLEAN",Bs),e.set("IS_NULL",Dr),e.set("IS_UNDEFINED",Ar),e.set("IS_NULLISH",Tr),e.set("IS_EMPTY",Ys),e.set("SWITCH",Fs)}const Gs=[ue.YEAR_MONTH,ue.YEAR_MONTH_CHS,ue.YEAR_MONTH_DAY,ue.YEAR_MONTH_DAY_CHS,ue.DATETIME_SHORT,ue.DATETIME_SHORT_CHS,ue.DATETIME,ue.DATETIME_CHS,ue.TIME,ue.TIME_SHORT,ue.YEAR,ue.MONTH,ue.DAY];function xe(e){if(e!=null){if(typeof e=="number")return Gs[e];if(typeof e=="string")return e}}function br(e,t,n){return e===null&&(e=void 0),Me(e,xe(n)).format(xe(t)??ue.DATETIME)}function zs(e){return br(void 0,e)}function js(e,t){return e===null&&(e=void 0),Me(e,xe(t)).year()}function Ws(e,t){return e===null&&(e=void 0),Me(e,xe(t)).month()+1}function Zs(e,t){return e===null&&(e=void 0),Me(e,xe(t)).date()}function Xs(e,t){return e===null&&(e=void 0),Me(e,xe(t)).hour()}function Js(e,t){return e===null&&(e=void 0),Me(e,xe(t)).minute()}function Ks(e,t){return e===null&&(e=void 0),Me(e,xe(t)).second()}function Qs(e){e.set("DATE",br),e.set("NOW",zs),e.set("YEAR",js),e.set("MONTH",Ws),e.set("DAY",Zs),e.set("HOUR",Xs),e.set("MINUTE",Js),e.set("SECOND",Ks)}function Sr(e,t){return e.children.reduce((n,r)=>{const i=r.findElementFromDefine(t);if(i==null)return n;if(!i.isProcessValueDone)throw Ft();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(qr(o)?o:0),n},[])}function An(e,t){var r;const n=(r=e.parent)==null?void 0:r.parent;if(!(n==null||n.type!==se.TABLE))return Sr(n,t)}function Tn(e,t){var i,s;const n=(i=e.parent)==null?void 0:i.parent;if(n==null||n.type!==se.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,u)=>o.concat(u.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,u)=>o.concat(Sr(u,t)),[])}function eo(e,t){if(!e.doc.isPaged)throw Ft();const r=e.page,i=r.pageNum<r.pageTotal?An(e,t):Tn(e,t);return i==null||i.length==0?0:W.sum(...i).toNumber()}function to(e,t){const n=e.element,r=e.value;if(!(n instanceof Dn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();if(t===2)return eo(n,r);const s=t==1?An(n,r):Tn(n,r);return s==null||s.length==0?0:W.sum(...s).toNumber()}function no(e,t){const n=e.element,r=e.value;if(!(n instanceof Dn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();const s=t==1?An(n,r):Tn(n,r);return s==null||s.length==0?0:W.sum(...s).div(s.length).toNumber()}function ro(e){e.set("COL_SUM",to),e.set("COL_AVG",no)}Ns(rt);ks(rt);Vs(rt);Qs(rt);ro(rt);const io=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-line;min-width:100%}.quickprint-content>span{background-color:var(--quickprint-variable-highlight-color, transparent)}",so="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song-blod{text-shadow:0 0 currentColor,0 0 currentColor}}";function Jn(){return io}function oo(){return so}var qt,Ke,ht,He,Fe,Ue,ke,fn,hn;const Sn=class Sn{constructor(t,n){he(this,ke);he(this,qt,dn(pn.PRINT_DOCUMENT));he(this,Ke);he(this,ht);he(this,He,Object.create(null));he(this,Fe,0);O(this,"define");O(this,"data");O(this,"state");O(this,"pages",[]);O(this,"element");O(this,"rendering");O(this,"renderState",le.CREATED);O(this,"devicePixelRatio",window.devicePixelRatio);he(this,Ue,[]);const{promise:r,resolve:i}=Promise.withResolvers();it(this,ht,r),it(this,Ke,i),this.define=t,this.state=n,Be(this,"element",null),Be(this,"rendering",0),this.state.renderState=le.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(t,n={}){const r=t instanceof sn?t:sn.create(t);return new Sn(r,n)}get id(){return"@"+U(this,qt)}get style(){const t=this.state.scale??100,n=this.define.style;return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":t/100,"--quickprint-paper-width":this.define.paper.width+"mm","--quickprint-paper-height":`calc(${this.define.paper.height}mm - 1px)`,fontFamily:Er(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get isPaged(){return this.renderState===le.PAGED||this.renderState===le.READY}get isFirstRount(){return U(this,Fe)===0}onCreated(){return Promise.allSettled(this.pages.map(t=>t.onCreated()))}onBeforeUnmount(t){U(this,Ue).indexOf(t)>=0||U(this,Ue).push(t)}unmount(){for(const t of U(this,Ue))typeof t=="function"&&t();U(this,Ue).length=0,this.renderState=le.UNMOUNT,this.element=null}render(){return Q("div",{class:be.DOCUMENT,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(t){return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),!0)}async mount(){this.state.total=this.pages.length;const t=this.pages.map(n=>n.onFinshed());await Promise.allSettled(t),st(this,ke,hn).call(this,le.PAGED),await st(this,ke,fn).call(this),st(this,ke,hn).call(this,le.READY),typeof U(this,Ke)=="function"&&(U(this,Ke).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(t){this.pages.push(t),t.setParent(this)}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}insert(t,n){this.pages.splice(n,0,t),t.setParent(this)}ready(){return U(this,ht)}injectElementStyle(){const t=document.createElement("style");t.textContent=Jn(),document.head.appendChild(t)}async print(){return await this.ready(),new Promise(t=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),t()})})}genPrintHtml(){var r;const t=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${t}</title>`,`<style>${Jn()}</style>`,`<style>${oo()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const t=this.state.scale??100,n=ut.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=ut[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const t=this.state.scale??100,n=ut.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n>=ut.length-1)return!1;const r=ut[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const t=100;this.state.scale=t,this.element.style.setProperty("--quickprint-doc-scale",`${t/100}`)}addDependency(t,n){U(this,He)[t.id]={element:t,...n}}removeDependency(t){delete U(this,He)[t.id]}watchDevicePixelRatio(){const t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);t.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{t.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}toggleDebug(){this.state.debug=this.state.debug!==!0,this.element!=null&&this.element.classList.toggle("quickprint-document-debug")}findElement(t){for(const n of this.pages){const r=n.findElement(t);if(r)return r}}};qt=new WeakMap,Ke=new WeakMap,ht=new WeakMap,He=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,ke=new WeakSet,fn=async function(){for(const n of Object.values(U(this,He))){const r=n.element;await r.processValue(),r.isProcessValueDone&&(this.removeDependency(r),await r.updateElement())}if(Object.keys(U(this,He)).length==0){Hr.debug("Document",`已完成第计算, 共${U(this,Fe)+1}轮`);return}On(this,Fe)._++,!(U(this,Fe)>=100)&&await st(this,ke,fn).call(this)},hn=function(t){this.renderState=t,this.state.renderState=t};let Lt=Sn;function Pt(e){const t=X.create(e),n=e.children.map(r=>X.create(r));return t.appendMany(n),t}async function uo(e,t={}){const n=e.define.pages.map(c=>r(c));e.data=t,e.appendMany(n),await e.onCreated(),e.renderState=le.RENDERING,e.state.renderState=le.RENDERING;function r(c){const f=Mt.create(c,e.define.paper);i(f);for(const d of f.defines){const w=o(d);w.define.isFixed?f.appendToFixed(w):f.append(w)}return s(f),f.state=Dt.INIT,f}function i(c){if(!(c.header.display!=!0||c.header.defines.length==0))for(const f of c.header.defines)c.appendToHeader(o(f))}function s(c){if(!(c.footer.display!=!0||c.footer.defines.length==0))for(const f of c.footer.defines)c.appendToFooter(o(f))}function o(c){switch(c.type){case"Table":return u(c);default:return X.create(c)}}function u(c){const f=X.create(c),d=c.children;for(const w of d){if(w.isRepeat){f.appendMany(l(w));continue}f.append(Pt(w))}return f}function l(c){const f=Qe(c.ds.value),d=ct(t,f.value);return Fr(d).map((w,p)=>{const R=Pt(c);return R.repeatIndex=p,R.rowData=w,R})}return e}function ao(e,t,n){let r=null,i=1;async function s(){const h=t.rendering,a=t.pages[h];return a==null?t.mount():(a.beginPaging(),a.createElement()==null?(t.rendering+=1,s()):(await t.mountChild(a),await u(a),await l(a),a.fid!==r&&(i=1),a.pageNum=i++,await a.onPaged(),t.rendering+=1,t.state.total=t.pages.length,s()))}function o(h,a){const g=h.children[h.rendering-1];return g==null?h.extra?h.header.offsetHeight+4:a.offsetTop:!g.isChanged||nn.isIsolated(g.define,a.define)?a.offsetTop:g.offsetBottom+a.define.top-g.define.top-g.define.height}async function u(h){const a=h.children[h.rendering];return a==null?void 0:(a.offsetTop=o(h,a),a.createElement()==null?(h.rendering+=1,u(h)):(await c(h,a),h.rendering+=1,u(h)))}async function l(h){for(const a of h.fixed)a.createElement(),await h.mountChild(a)}function c(h,a){switch(a.define.type){case se.TABLE:return p(h,a);case se.TEXT:return R(h,a);default:return h.mountChild(a)}}async function f(h,a){const g=a.children[a.rendering];if(g==null)return;if(g.createElement()==null)return a.rendering+=1,f(h,a);await a.mountChild(g);const T=Ur.mm_to_px(h.paper.offsetHeight)-h.footer.offsetHeight;if(a.offsetBottom>T){const q=d(h,a,T);return t.insert(q,h.index+1),f(h,a)}return a.rendering+=1,f(h,a)}function d(h,a,g){const N=a.define.footer.map(x=>Pt(x)),T=g-N.reduce((x,k)=>x+k.offsetHeight,0),q=w(a,T),$=a.splitRows(q);a.appendMany(N),a.atomized=!0,a.rendering=q;const L=h.clone(),C=new wr(a.define),P=a.define.header.map(x=>Pt(x));C.extra=!0,C.appendMany(P),C.appendMany($),L.append(C);for(let x=h.rendering+1,k=h.children.length;x<k;x++){const D=h.children[x];nn.isIsolated(D.define,a.define)||(L.append(D),Reflect.set(h.children,x,null))}return h.children=h.children.filter(x=>x!=null),L}function w(h,a){let g=h.offsetTop;for(let N=0;N<h.children.length;N++){if(g+=h.children[N].offsetHeight,g==a)return N;if(g>a)return N-1}return h.children.length-1}async function p(h,a){return await h.mountChild(a),f(h,a)}function R(h,a){return h.mountChild(a)}return async function(){hi(),await Ge(),await uo(t,n);const h=t.createElement();return h&&e.appendChild(h),r=t.pages[0].fid,s()}}function lo(e){const t=Date.now(),n=Lt.create(e.define,e.state);return ao(e.container,n,e.data??{})().then(()=>{n.state.renderTime=Date.now()-t}),n}const co=dt({__name:"DocState",props:{state:{type:Object,required:!0}},setup(e){const t=e,n=Se(()=>t.state.renderState===le.READY),r=Se(()=>t.state.renderState===le.READY?"已就绪":t.state.renderState===le.RENDERING?`正在生成(${t.state.total??0}页)...`:"正在生成...");return(i,s)=>(Ye(),Ze("div",null,[s[0]||(s[0]=ae("span",null,"文档：",-1)),ae("span",{class:ie({[i.classes.finished]:n.value})},St(r.value),3)]))}}),fo="_finished_7h37m_2",ho={finished:fo},po={classes:ho},mo=Ht(co,[["__cssModules",po]]),go="_toolbar_3etac_1",vo="_button_3etac_9",Eo="_actived_3etac_33",wo="_divider_3etac_46",We={toolbar:go,button:vo,actived:Eo,divider:wo},yo=["viewMode","debug","space","print"],No=dt({props:{doc:{type:Lt},buttons:{type:Array,required:!0}},setup(e){function t(){var l;(l=e.doc)==null||l.print()}function n(){var l;(l=e.doc)==null||l.toggleViewMode()}function r(){var c;const l={[We.button]:!0,[We.actived]:((c=e.doc)==null?void 0:c.state.viewMode)==="multiple"};return j("button",{type:"button",title:"切换单页/多页视图",class:l,onClick:n},[j(on,{icon:"icon-multi-page"},null),j("span",null,[Rt("多页")])])}function i(){return j("button",{type:"button",class:We.button,onClick:t,title:"打印 Ctrl + P"},[j(on,{icon:"icon-printer"},null),j("span",null,[Rt("打印")])])}function s(){return j("div",{class:We.divider},null)}function o(){return j("div",{class:"quickprint-is-fill-w"},null)}function u(l){if(typeof l=="function")return l(We,e.doc);switch(l){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return j("div",{class:We.toolbar},[e.buttons.map(u)])}}}),_o={key:1,class:"quickprint-is-fill-w"},Do=dt({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return yo}}},emits:["mock"],setup(e,{emit:t}){const n=e,r=rr("classes"),i=Ot(),s=Ot(),o=ir({}),u=Se(()=>o.renderState===le.READY),l=Se(()=>{const h=o.renderTime??0;if(h<=6e4)return`${h/1e3}秒`;const a=Math.floor(h/1e3),g=a%60,N=(a-g)/60;return g==0?`${N}分`:`${N}分${g}秒`}),c=Se(()=>o.total??"--"),f=Se(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function d(){var h;(h=s.value)==null||h.zoomIn()}function w(){var h;(h=s.value)==null||h.zoomOut()}function p(h){var a,g;h.deltaY>0?(a=s.value)==null||a.zoomIn():(g=s.value)==null||g.zoomOut()}function R(){var h;(h=s.value)==null||h.toggleDebug()}return ei(()=>{const h=lo({container:i.value,define:sn.create(n.define),state:o,data:n.data});s.value=h,document.title=h?`${h.define.name} - OpenPrint`:"OpenPrint"}),(h,a)=>{var g;return Ye(),Ze("div",{class:ie(K(r).preview),onWheel:ni(p,["ctrl","prevent"])},[ae("div",{class:ie([K(be).PRINT_HIDDEN,K(r).header])},[ae("div",{class:ie(K(r).headerLeft)},[xn(h.$slots,"headerLeft")],2),j(K(No),{doc:s.value,buttons:e.buttons},null,8,["doc","buttons"]),ae("div",{class:ie(K(r).headerRight)},[xn(h.$slots,"headerRight")],2)],2),ae("div",{class:ie(f.value),ref_key:"containerRef",ref:i},null,2),ae("div",{class:ie([K(be).PRINT_HIDDEN,K(r).footer])},[j(mo,{state:o,class:ie(K(r).status)},null,8,["state","class"]),u.value?(Ye(),Ze(ti,{key:0},[ae("div",{class:ie(K(r).status)},"用时："+St(l.value),3),a[0]||(a[0]=ae("div",{class:"quickprint-is-fill-w"},null,-1)),ae("button",{type:"button",class:ie({"quickprint-text-btn":!0,"quickprint-is-selected":(g=s.value)==null?void 0:g.state.debug}),title:"调试模式",onClick:R},[j(K(on),{icon:"icon-bug"})],2),a[1]||(a[1]=ae("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ae("div",{class:ie(K(r).divider)},null,2),ae("div",{class:ie(K(r).status)},"第1页，共"+St(c.value)+"页",3),ae("div",{class:ie(K(r).divider)},null,2)],64)):(Ye(),Ze("div",_o)),j(K(Br),{class:ie(K(r).zoom),scale:o.scale,onZoomIn:d,onZoomOut:w},null,8,["class","scale"])],2)],34)}}}),Ao="_preview_117vl_2",To="_header_117vl_14",bo="_headerLeft_117vl_23",So="_headerRight_117vl_29",Ro="_body_117vl_35",Oo="_footer_117vl_54",Mo="_status_117vl_74",Io="_divider_117vl_80",Lo="_zoom_117vl_87",Po={preview:Ao,header:To,headerLeft:bo,headerRight:So,body:Ro,footer:Oo,status:Mo,divider:Io,zoom:Lo},Co={classes:Po},xo=Ht(Do,[["__cssModules",Co]]),ko=dt({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(e){const t=e,n=rr("classes"),r=Yr(),i=nr(t.local??[]),s=ir(t.ds.fields.map(c=>l(c))),o=[{label:"文本",value:me.STRING},{label:"数字",value:me.NUMBER},{label:"日期",value:me.DATE},{label:"对象",value:me.OBJECT},{label:"数组",value:me.ARRAY}],u=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(c,f){var w;const d=c[f.name];return((w=o.find(p=>p.value===d))==null?void 0:w.label)??d}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(c,f){if(c.type===me.OBJECT)return null;if(c.type===me.ARRAY)return kn(j("input",{type:"number","onUpdate:modelValue":w=>c.total=w,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[ii,c.total]]);const d=t.options.find(w=>w.classify===c.type);return d==null?null:kn(j("select",{"onUpdate:modelValue":w=>c.func=w,class:n.select},[j("option",{value:"",class:n.placeholder},[Rt("请选择")]),d.rules.map(w=>j("option",{value:w.func,key:w.func},[w.name]))]),[[si,c.func]])}}];function l(c,f){const d=f?`${f}.${c.name}`:c.name,w=c.children?c.children.map(R=>l(R,c.name)):void 0,p=i[d];return{type:c.type,name:c.name,title:c.title,children:w,$expand:!0,func:(p==null?void 0:p.func)??"",total:p==null?void 0:p.total}}return r==null||r.useHandle("confirm",()=>ri(s)),(c,f)=>(Ye(),Ze("div",{class:ie(K(n).ds)},[j(K(Vr),{columns:u,data:s},null,8,["data"])],2))}}),$o="_ds_6a9ph_2",qo="_placeholder_6a9ph_8",Ho="_select_6a9ph_12",Fo="_input_6a9ph_13",Uo={ds:$o,placeholder:qo,select:Ho,input:Fo},Bo={classes:Uo},Yo=Ht(ko,[["__cssModules",Bo]]);let yt=null;const Kn=490;function Rr(){return yt!=null?Promise.resolve(yt):jr(()=>import("./mock-CyWGPfye.js"),__vite__mapDeps([0,1,2,3])).then(e=>(yt=e.default,yt))}function Qn(e,t){switch(t){case me.DATE:return e.randDate();case me.NUMBER:return e.randDecimal();case me.STRING:return e.randName();default:return null}}function Vo(e){if((e==null?void 0:e.total)==null)return Kn;const t=Number(e.total);return Number.isNaN(t)||!Number.isFinite(t)||t<=0?Kn:Math.round(t)}function tn(e,t,n){if(n==null||et(n.func))return Qn(e,t.type);const r=e[n.func];return typeof r!="function"?Qn(e,t.type):r(n)}const Go=Gr(function(e,t,n){const r={ds:t,options:e.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:Wr.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return Zr("创建模拟数据",oi(Yo,r),i).promisify()});async function er(e,t){if(e==null)return[];const n=await Rr(),r=await Go(n,e,t).catch(zr);return Array.isArray(r)?r:[]}async function Nt(e,t){if(e==null||!Array.isArray(t)||t.length==0)return{};const n=await Rr(),r=nr(t);return e.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===me.OBJECT){const u=s.children??[];return i[s.name]=u.reduce((l,c)=>{if(et(c.name))return l;const f=`${s.name}.${c.name}`;return l[c.name]=tn(n,c,r[f]),l},{}),i}if(s.type===me.ARRAY){const u=s.children??[],l=Vo(o),c=10+Math.round(Math.random()*l);return i[s.name]=Array(c).fill("").map(()=>u.reduce((f,d)=>{if(et(d.name))return f;const w=`${s.name}.${d.name}`;return f[d.name]=tn(n,d,r[w]),f},{})),i}return i[s.name]=tn(n,s,o),i},{})}const zo=dt({__name:"index",setup(e){const t={INIT:0,LOADED_CASE:1,LOADED_DATA:2,READY:3},n=Ot(),r=Ot(),i=Wt(0),s=Wt(!1),o=Se(()=>{var a;return`${((a=n.value)==null?void 0:a.id)??Date.now()}-${i.value}`}),u=Wt(t.INIT),l=Se(()=>["viewMode","debug","space",s.value?p:null,"print"]),c=Se(()=>u.value===t.INIT?"正在加载...":u.value===t.LOADED_CASE?"已加载模板，正在准备数据...":u.value===t.LOADED_DATA?"开始渲染模板":"");function f(){const a=new URLSearchParams(window.location.search).get("id");return mn(a)&&(a==="local"||Cn.some(g=>g.id===a))?a:Cn[0].id}async function d(h){var T,q,$,L;if(h==null)return{};if(h.data)return s.value=!1,h.data;const a=Ln(h.id);if(Array.isArray(a)&&a.length>0)return Nt((T=h.define)==null?void 0:T.ds,a);const g=h.rules;if(Array.isArray(g)&&g.length>0)return Nt((q=h.define)==null?void 0:q.ds,g);const N=await er(($=n.value)==null?void 0:$.ds);return Pn(N,h.id),Nt((L=h.define)==null?void 0:L.ds,N)}async function w(){if(n.value==null)return;const h=n.value.id;if(h==null||h=="")return;const a=Ln(h),g=await er(n.value.ds,a);Pn(g,n.value.id),r.value=await Nt(n.value.ds,g),i.value++}function p(h){return j("button",{type:"button",class:h.button,onClick:w},[j("span",null,[Rt("模拟数据")])])}async function R(){u.value=t.INIT,s.value=!0;const h=await Xr(f());n.value=(h==null?void 0:h.define)??{},u.value=t.LOADED_CASE,r.value=await d(h),u.value=t.LOADED_DATA,u.value=t.READY}return R(),(h,a)=>u.value<=t.LOADED_DATA?(Ye(),Ze("div",{key:0,class:ie(h.classes.logs)},St(c.value),3)):(Ye(),ui(K(xo),{define:n.value,data:r.value,buttons:l.value,key:o.value,class:ie(h.classes.preview),onMock:w},null,8,["define","data","buttons","class"]))}}),jo="_preview_17t3s_7",Wo="_logs_17t3s_11",Zo={preview:jo,logs:Wo},Xo={classes:Zo},Jo=Ht(zo,[["__cssModules",Xo]]),bn=ai(Jo),Ko=Jr();bn.use(Kr,{zIndex:Ko});bn.mount("#app");Qr(bn._context);
