var He=Object.defineProperty;var ne=n=>{throw TypeError(n)};var ke=(n,t,e)=>t in n?He(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var l=(n,t,e)=>ke(n,typeof t!="symbol"?t+"":t,e),Fe=(n,t,e)=>t.has(n)||ne("Cannot "+e);var Q=(n,t,e)=>(Fe(n,t,"read from private field"),e?e.call(n):t.get(n)),ie=(n,t,e)=>t.has(n)?ne("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e);import{d as q,h as X,c as Yt,a as Gt,l as We,n as pt,b as lt,e as g,t as Ue,V as Ye,g as Vt,r as jt,z as Ge,N as gt,W as se,o as Ve,F as je,s as qe,A as Ze,X as he,T as Xe,x as re}from"./vue-DBh96Ghl.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const a of r.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function e(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function i(s){if(s.ep)return;s.ep=!0;const r=e(s);fetch(s.href,r)}})();function $e(n){return JSON.parse(JSON.stringify(n))}function st(n,t,e){return Reflect.defineProperty(n,t,{configurable:!1,enumerable:!1,writable:!0,value:e})}function Ct(n,t,e){return Reflect.defineProperty(n,t,{configurable:!1,enumerable:!0,writable:!1,value:e})}function Je(n,t,e){return Reflect.defineProperty(n,t,{configurable:!1,enumerable:!1,writable:!1,value:e})}function bt(n="u"){const t=crypto.getRandomValues(new Uint8Array(12));let e=t[0]%11;const i="*********".replace(/[\*]/g,function(){const s=t[e++];return e>=12&&(e=1),(s%36).toString(36)});return`${n}_${i}`}function qt(n,t=null){if(n==null)return t;try{return JSON.parse(n)}catch(e){return console.error(e),t}}function Et(n){return Array.isArray(n)?n:[]}function fe(n){if(n==null||typeof n!="object")return n;const t=Reflect.ownKeys(n);for(const e of t){const i=n[e];i!=null&&(typeof i=="object"||typeof i=="function")&&fe(i)}return Object.freeze(n)}function nt(n){return typeof n!="string"?!1:n.trim().length>0}function St(n){return!nt(n)}function ns(n){return n==null?!0:typeof n=="string"?n=="":Array.isArray(n)?n.length==0:!1}function pe(n=0){return new Promise(t=>setTimeout(t,n))}const oe=Object.create(null);function is(n,t="-"){const e=oe[n];if(e!=null)return e;const i=n.replace(/([A-Z])/g,(s,r,a)=>a===0?r.toLowerCase():t+r.toLowerCase());return oe[n]=i,i}function Qe(n,t){if(t==null)return n;const e=Object.keys(t);if(e.length==0)return n;for(const i of e){const s=t[i];s!=null&&(n[i]=s)}return n}function ss(n,...t){for(const e of t)Qe(n,e);return n}function rs(n){return n instanceof Error&&console.error(n),null}function os(n){return n instanceof Error&&console.error(n),!1}function as(n){}const Mt=Object.freeze({prop:"__RETURN_VALUE__",get(n){return Reflect.get(n,Mt.prop)},set(n,t){if(t==null){Reflect.deleteProperty(n,Mt.prop);return}Reflect.defineProperty(n,Mt.prop,{configurable:!0,enumerable:!1,writable:!0,value:t})}});function cs(n,t){if(t==null||t==""||n==null)return;const e=t.split(".");if(e.length<=1)return n[t];let i=n;for(const s of e)if(i=i[s],i==null)return;return i}const z=Object.freeze({PORTRAIT:0,LANDSCAPE:1}),ae=Object.freeze({NORMAL:0}),_t=Object.freeze({PAPER:0,CONTENT:1}),W=Object.freeze({CONST:0,VARIABLE:1,TEMPLATE:2,FORMULA:3,CODE:4}),Ke=Object.freeze({VISIBLE:0,HIDDEN:1,CONDITION:2}),It=Object.freeze({DEFINE_DOCUMENT:"d0",DEFINE_PAGE:"p0",DEFINE_ELEMENT:"e0",PRINT_DOCUMENT:"d1",PRINT_PAGE:"p1",PRINT_ELEMENT:"e1",HISTORY_OWNER:"ho",CONTEXTMENU:"cm"}),S=Object.freeze({TEXT:"Text",NUMBER:"Number",DATE:"Date",TABLE:"Table",TABLE_ROW:"TableRow",TABLE_CELL:"TableCell",PARAGRAPH:"Paragraph"}),Dt=Object.freeze({CUSTOM:"custom",A4:"A4"}),et=Object.freeze({size:"A4",width:210,height:297,orientation:z.PORTRAIT}),tn=fe([{size:Dt.CUSTOM,width:210,height:297,orientation:z.PORTRAIT},et,{size:"A3",width:297,height:420,orientation:z.PORTRAIT},{size:"B3",width:353,height:500,orientation:z.PORTRAIT},{size:"B4",width:250,height:353,orientation:z.PORTRAIT},{size:"二等分连续纸",width:241,height:139.7,orientation:z.PORTRAIT,margins:{left:12.7,right:12.7}},{size:"三等分连续纸",width:241,height:93.1,orientation:z.PORTRAIT,margins:{left:12.7,right:12.7}}]),ut=Object.freeze({HEADER:0,BODY:1,FOOTER:2}),us=Object.freeze({ROUND:0,FLOOR:1,CEIL:2,BANKER_ROUND:3}),ls=Object.freeze({NONE:0,FIXED:1,THOUSAND:2,TEN_THOUSAND:3,DAXIE:4,PERCENTAGE:5}),ds=Object.freeze({YEAR_MONTH:"YYYY-MM",YEAR_MONTH_CHS:"YYYY年MM月",YEAR_MONTH_DAY:"YYYY-MM-DD",YEAR_MONTH_DAY_CHS:"YYYY年MM月DD日",DATETIME_SHORT:"YYYY-MM-DD HH:mm",DATETIME_SHORT_CHS:"YYYY年MM月DD HH时mm分",DATETIME:"YYYY-MM-DD HH:mm:ss",DATETIME_CHS:"YYYY年MM月DD日 HH时mm分ss秒",TIME:"HH:mm:ss",TIME_SHORT:"HH:mm",YEAR:"YYYY",MONTH:"MM",DAY:"DD"}),hs=Object.freeze({PAGE_NUMBER:"pageNumber",PAGE_TOTAL:"pageTotal",ROW_INDEX:"rowIndex"}),fs=Object.freeze({ELEMENT_VALUR:"elementValue"}),en=Object.freeze({DEFAULT:0,FIXED:1}),xt=Object.freeze({ONCE:0,EACH:1}),ps=Object.freeze({AUTO:0,HIDDEN:1,SCALE:2}),gs=Object.freeze({BUILTIN:0,DS:1,SPECIAL:2}),Pt=Object.freeze({OBJECT:0,ARRAY:1,STRING:2,NUMBER:3,BOOLEAN:4,DATE:5,ANY:6}),ge=nn(),Ee=25.4,Te=4;function nn(){return 96}function sn(n,t=Te){return Math.round(n/t)*t}function $(n){return Math.round(n*ge/Ee)}function rn(n,t=3){const e=n*Ee/ge,i=Math.pow(10,t);return Math.round(e*i)/i}function on(n){return Math.round(n*3/4)}const Es={unit:Te,mm_to_px:$,pt_to_mm:rn,pt_to_px:on};class ht{constructor(t,e){l(this,"id");l(this,"elements");l(this,"index");l(this,"header");l(this,"footer");l(this,"padding");l(this,"parent");l(this,"children");l(this,"size");if(Ct(this,"id",t.id??bt(It.DEFINE_PAGE)),st(this,"elements",Object.create(null)),this.index=t.index,this.header=this.createHeader(t.header),this.footer=this.createFooter(t.footer),this.padding=t.padding,this.children=e,this.size=this.createPageSize(t.size),st(this,"parent",void 0),Array.isArray(e))for(const i of e)i.setParent(this),this.elements[i.id]=i}static create(t){const e=Et(t.children).map(i=>L.create(i));return new ht(t,e)}get orientation(){const t=this.size.orientation;if(t!=null)return t;const e=this.parent;return e==null?z.PORTRAIT:e.paper.orientation}get topZIndex(){const t=this.children;return t.length===0?10:Math.max(...t.map(e=>e.zIndex??10))}get width(){const t=this.parent;return this.size.type===_t.CONTENT?(t==null?void 0:t.paperWidth)??0:t==null?0:(this.size.orientation??t.paper.orientation)===z.LANDSCAPE?t.paperHeight:t.paperWidth}get height(){const t=this.parent;return this.size.type===_t.CONTENT?this.size.height??(t==null?void 0:t.paperHeight)??0:t==null?0:(this.size.orientation??t.paper.orientation)===z.LANDSCAPE?t.paperWidth:t.paperHeight}setParent(t){this.parent=t}createHeader(t={}){return{display:t.display!==!1,height:t.height??80}}createPageSize(t){return t??{type:_t.PAPER}}createFooter(t={}){return{display:t.display!==!1,height:t.height??80}}append(t){t.setParent(this),this.children.push(t),this.elements[t.id]=t}removeChild(t){const e=this.children.indexOf(t);return e<0?!1:(this.children.splice(e,1),t.setParent(void 0),delete this.elements[t.id],!0)}checkHeaderAndFooter(t){const e=this.header,i=this.footer;e.display&&e.height>t&&(e.height=Math.min(80,Math.floor(t*.8))),i.display&&i.height>t&&(i.height=Math.min(80,Math.floor(t*.8))),e.display&&i.display&&e.height+i.height>t&&(i.height=t-e.height-16)}setHeaderHeight(t){const e=this.parent;if(e==null)return!1;const i=$(e.paperHeight),s=this.footer;let r=Math.round(t);return r<=0&&(r=0),r>i&&(r=i),s.display!==!0?(this.header.height=r,!0):(r>i-s.height&&(r=i-s.height-16),this.header.height=r,!0)}setFooterHeight(t){const e=this.parent;if(e==null)return!1;const i=this.header,s=$(e.paperHeight);let r=Math.round(t);return r<=0&&(r=0),r>s&&(r=s),i.display!==!0?(this.footer.height=r,!0):(s-r<i.height&&(r=s-i.height-16),this.footer.height=r,!0)}findElement(t){const e=this.elements[t];if(e)return e;for(const i of this.children){const s=i.find(t);if(s)return s}}}function an(n,...t){console.log(`%c[${n}]`,"color: orange;",...t)}function cn(n,...t){console.log(`%c[${n}]`,"color: green;",...t)}function un(n,...t){console.log(`%c[${n}]`,"color: red;",...t)}function ln(n){console.log(`%c${n}`,"font-family:monospace;")}function dn(){console.log("".padStart(24,"-"))}function hn(){console.clear()}function fn(){console.log(`
`)}const pn={warn:an,debug:cn,writeLine:dn,writeSpaceLine:fn,write:ln,clear:hn,error:un};class me{constructor(t,e){l(this,"type");l(this,"stopped",!1);l(this,"defaultPrevented",!1);l(this,"detail");this.type=t,this.detail=e}stopPropagation(){this.stopped=!0}preventDefault(){this.defaultPrevented=!0}}var j;class gn{constructor(){l(this,"__v_skip",!0);ie(this,j,new Map)}on(t,e){const i=Q(this,j).get(t);return i==null?(Q(this,j).set(t,[e]),this):i.includes(e)?this:(i.unshift(e),this)}once(t,e){const i=s=>{e(s),this.off(t,i)};return this.on(t,i),this}off(t,e){const i=Q(this,j).get(t);if(i==null)return this;const s=i.indexOf(e);return s<0?this:(i.splice(s,1),this)}dispatch(t){const e=Q(this,j).get(t.type);if(e==null)return t;for(let i=e.length-1;i>=0;i--){const s=e[i];if(typeof s=="function"&&s(t),t.stopped)break}return t}cleanup(){Q(this,j).clear()}createEvent(t,e){return new me(t,e)}}j=new WeakMap;function En(n){const t=n.split(".");return{varType:Number(t[0]),dataType:Number(t[1]),path:t.slice(2).join("."),value:t[t.length-1]}}function Tn(n){switch(n){case Pt.STRING:return S.TEXT;case Pt.NUMBER:return S.NUMBER;case Pt.DATE:return S.DATE;default:return}}const H=class H{constructor(t={},e){l(this,"id");l(this,"type");l(this,"title");l(this,"elements");l(this,"top");l(this,"left");l(this,"width");l(this,"height");l(this,"zIndex",10);l(this,"style");l(this,"attributes");l(this,"ds");l(this,"visibility");l(this,"parent");l(this,"children");l(this,"state");l(this,"emitter");if(Ct(this,"id",t.id??bt(It.DEFINE_ELEMENT)),Ct(this,"type",t.type),st(this,"elements",Object.create(null)),this.title=t.title,this.top=t.top??0,this.left=t.left??0,this.width=t.width??0,this.height=t.height??0,this.style=this.createStyle(t.style??{}),this.attributes=t.attributes??{},this.ds=this.createDS(t.ds??{}),this.children=e,this.visibility=t.visibility,Array.isArray(e))for(const i of e)i.setParent(this),this.elements[i.id]=i;st(this,"parent",void 0),st(this,"state",this.createState()),Je(this,"emitter",new gn)}static register(t,e){H.ELEMENTS[t]=e}static create(t,e){const i=H.ELEMENTS[t.type]??H,s=Et(t.children).map(a=>H.create(a)),r=new i(t,s);return e&&r.setParent(e),r}static sort(t,e){return t.top===e.top?t.left-e.left:t.top-e.top}static isIsolated(t,e){return t.left+t.width<=e.left||t.left>=e.left+e.width}static ignoreProp(t,e){switch(t){case"style":case"attributes":return Object.keys(e[t]).length==0;case"top":case"left":case"width":case"height":return e[t]===0;case"children":return e.children.length==0;case"visibility":return e.visibility==null||e.visibility.type===Ke.VISIBLE;case"ds":return St(e.ds.value);default:return!1}}get bottom(){return this.top+this.height}get offsetTop(){return Math.round(this.top)}get offsetLeft(){return Math.round(this.left)}get offsetWidth(){return Math.round(this.width)}get offsetHeight(){return Math.round(this.height)}get display(){var t;return((t=this.attributes)==null?void 0:t.display)??this.type}get isBindConst(){const t=this.ds;return t==null?!1:t.type===W.CONST}get isBindVariable(){const t=this.ds;return t==null?!1:t.type===W.VARIABLE&&nt(t.value)}get isBindTemplate(){const t=this.ds;return t==null?!1:t.type===W.TEMPLATE&&nt(t.value)}get isBindFormula(){const t=this.ds;return t==null?!1:t.type===W.FORMULA&&nt(t.value)}get isBindCode(){const t=this.ds;return t==null?!1:t.type===W.CODE&&nt(t.value)}get index(){const t=this.parent;return t==null?-1:t.children.indexOf(this)}get isSelected(){return this.state.selected===!0}get isFixed(){return this.attributes.position===en.FIXED}get page(){let t=this.parent;for(;t;){if(t instanceof ht)return t;if(!(t instanceof H))return null;t=t.parent}return null}get doc(){var t;return(t=this.page)==null?void 0:t.parent}on(t,e){return this.emitter.on(t,e)}once(t,e){return this.emitter.once(t,e)}off(t,e){return this.emitter.off(t,e)}dispatch(t){return this.emitter.dispatch(t)}createEvent(t,e){return new me(t,e)}setParent(t){this.parent=t}createStyle(t){return t}createDS(t){return{type:(t==null?void 0:t.type)??W.CONST,value:t==null?void 0:t.value}}createState(){return{selected:!1,dragging:!1,key:0}}append(t){t.setParent(this),this.children.push(t),this.elements[t.id]=t}insert(t,e){e.setParent(this),this.children.splice(t,0,e),this.elements[e.id]=e}remove(){const t=this.parent;return t==null?(pn.warn("DefineElement","元素未插入文档中，无法删除"),!1):t.removeChild(this)}removeChild(t){const e=this.children.indexOf(t);return e<0?!1:(this.children.splice(e,1),t.setParent(void 0),delete this.elements[t.id],!0)}resetDS(){this.ds=this.createDS()}forceUpdate(){this.state&&this.state.key++}calculateCoord(t){var i;return((i=this.doc)==null?void 0:i.useGrid)?sn(t):Math.round(t)}setTop(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("top",i),!0}setLeft(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("left",i),!0}setWidth(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("width",i),!0}setHeight(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("height",i),!0}updateValue(t,e){return Reflect.get(this,t)===e?!1:(Reflect.set(this,t,e),this.dispatch(this.createEvent("update",{key:t,value:e})),!0)}setZIndex(t){this.zIndex=t}setStyle(t,e){this.style[t]=e}getStyle(t){return this.style[t]}removeStyle(t){Reflect.deleteProperty(this.style,t)}blur(){this.state.selected===!0&&(this.state.selected=!1,this.dispatch(this.createEvent("blur")))}focus(){this.state.selected!==!0&&(this.state.selected=!0,this.dispatch(this.createEvent("focus")))}find(t){const e=this.elements[t];if(e)return e;for(const i of this.children){const s=i.find(t);if(s)return s}}contains(t){const e=t instanceof H?t.id:t;return this.find(e)!=null}toJSON(){const t={};for(const e in this)H.ignoreProp(e,this)||(t[e]=this[e]);return t}setDataSource(t,e){if(this.ds.type=t,this.ds.value=e,t!==W.VARIABLE)return;const i=En(e),s=Tn(i.dataType);s&&s!==this.display&&(this.attributes.display=s)}};l(H,"ELEMENTS",Object.create(null));let L=H;class mn extends L{}class On extends L{}class wn extends L{}class Zt extends L{static sort(t,e){var c,w;const i=(c=t.parent)==null?void 0:c.index,s=(w=e.parent)==null?void 0:w.index,r=t.index,a=e.index;return i==null||s==null||i===s?r-a:i-s}static createDefault(t,e){return L.create({type:S.TABLE_CELL,width:t,height:e})}get offsetLeft(){const t=this.parent;if(t==null)return 0;const e=this.index;return e==0?0:(t.children??[]).slice(0,e).reduce((s,r)=>s+r.width,0)}get offsetWidth(){var r,a;const t=this.attributes.colspan;if(t==null||t<0)return Math.round(this.width);if(t==0)return 0;const e=(a=(r=this.parent)==null?void 0:r.parent)==null?void 0:a.columns;if(!Array.isArray(e)||e.length==0)return Math.round(this.width);const i=this.index,s=e.slice(i,i+t).reduce((c,w)=>c+w,0);return Math.round(s)}setTop(t,e){return!1}setLeft(t,e){return!1}setWidth(t,e=!0){var r;const i=(r=this.parent)==null?void 0:r.parent;if(i==null)return!1;const s=e?Math.round(t):this.calculateCoord(t);return i.setColWidth(this.index,s),i.updateBoxSize(),!0}setHeight(t,e){const i=this.parent;if(i==null)return!1;const s=e?Math.round(t):this.calculateCoord(t);return i.setRowHeight(s),!0}}const dt=class dt extends L{static createDefault(t,e=dt.DEFAULT_HEIGHT){const i=t.map(s=>Zt.createDefault(s,e));return dt.create({type:S.TABLE_ROW,children:i,height:e,width:t.reduce((s,r)=>s+r,0)})}get isRepeat(){return this.ds==null||this.isHeader||this.isFooter||this.ds.type!=W.VARIABLE?!1:nt(this.ds.value)}get isHeader(){return this.attributes.type===ut.HEADER}get isFooter(){return this.attributes.type===ut.FOOTER}get isBody(){return!this.isFooter&&!this.isHeader}get offsetTop(){const t=this.parent;if(t==null)return 0;const e=this.index;return e==0?0:(t.children??[]).slice(0,e).reduce((s,r)=>s+r.height,0)}setTop(t,e){return!1}setLeft(t,e){return!1}setRowHeight(t){this.setHeight(t,!0),this.children.forEach(e=>e.updateValue("height",this.height))}asHeader(){this.attributes.type=ut.HEADER,this.attributes.printMode=xt.EACH}asFooter(){this.attributes.type=ut.FOOTER,this.attributes.printMode=xt.EACH}asBody(){this.attributes.type=ut.BODY,this.attributes.printMode=xt.ONCE}};l(dt,"DEFAULT_HEIGHT",32);let Tt=dt;class Rn extends L{get columns(){return(this.attributes.colgroup??[]).map(e=>Math.round(e))}get header(){return this.children.filter(t=>t.isHeader)}get footer(){return this.children.filter(t=>t.isFooter)}get offsetWidth(){return this.columns.reduce((t,e)=>t+e,0)}setColgroup(t){this.attributes.colgroup=t}updateBoxSize(){const t=this.attributes.colgroup;for(const e of this.children){const i=e.height;for(let s=0;s<e.children.length;s++){const r=e.children[s];r.updateValue("width",t[s]),r.updateValue("height",i)}}this.updateValue("width",this.attributes.colgroup.reduce((e,i)=>e+=i,0)),this.updateValue("height",this.children.reduce((e,i)=>e+=i.height,0))}insertColumn(t,e){const i=this.attributes.colgroup;if(t<0||t>=i.length)return!1;const s=i[t],r=t+e;i.splice(r,0,s);for(const a of this.children){const c=Zt.createDefault(s,a.height);a.insert(r,c)}return this.updateBoxSize(),!0}removeColumn(t){this.attributes.colgroup.splice(t,1);for(const i of this.children)i.children.splice(t,1);this.updateBoxSize()}inserRow(t,e){const i=this.children[t],s=Tt.createDefault(this.attributes.colgroup,i.height);this.insert(t+e,s),this.updateBoxSize()}removeRow(t){this.children.splice(t,1),this.updateBoxSize()}setColWidth(t,e){this.attributes.colgroup[t]=e}setRowHeight(t,e){const i=this.children[t];i&&i.setRowHeight(e)}setColumns(t){this.attributes.colgroup=t}}class Nn extends L{constructor(t={},e=[]){super(t,e),this.ds.type=W.CONST}}const Ts=Object.freeze({DEFAULT:0,SIZE_0:42,SIZE_0_S:37,SIZE_1:26,SIZE_1_S:24,SIZE_2:22,SIZE_2_S:18,SIZE_3:16,SIZE_3_S:15,SIZE_4:14,SIZE_4_S:12,SIZE_5:10.5,SIZE_5_S:9,SIZE_6:7.5,SIZE_6_S:6.5,SIZE_7:5.5,SIZE_8:5}),ms=Object.freeze({DEFAULT:"inherit",SONG:"SimSun"}),Os=Object.freeze({NORMAL:"normal",ITALIC:"italic"}),ws=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"}),Rs=Object.freeze({AUTO:"auto",LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"}),Ns=Object.freeze({TOP:0,MIDDLE:1,BOTTOM:2}),vs=Object.freeze({NONE:"none",SOLID:"solid",DOTTED:"dotted",DASHED:"dashed",DOUBLE:"double"}),bs=Object.freeze({NONE:"none",UNDERLINE:"underline",OVERLINE:"overline",LINE_THROUGH:"line-through"}),Is=Object.freeze({SOLID:"solid",DOTTED:"dotted",DASHED:"dashed",DOUBLE:"double",WAVY:"wavy"}),Ls=Object.freeze({DEFAULT:"0",TIMES_1:"1",TIMES_1_1:"1.1",TIMES_1_5:"1.5",TIMES_2:"2"}),As=Object.freeze({DEFAULT:"inherit",REGULAR:"#000000"}),ys=Object.freeze({ALL:2,NONE:4,INSIDE:8,OUTSIDE:16,TOP:32,BOTTOM:64,LEFT:128,RIGHT:256}),Ms=Object.freeze({CURRENT_COLOR:"currentColor",BLACK:"#000000"}),_s=Object.freeze({NONE:"",PX:"px",PT:"pt",MM:"mm",EM:"em"});function vn(n){return typeof n!="number"||Number.isNaN(n)?!1:!!Number.isFinite(n)}function xs(n){return!vn(n)}class bn extends Map{constructor(e){super();l(this,"timer",null);l(this,"delay",6e4);l(this,"validator");this.validator=e,this.startTimer()}startTimer(){this.clearTimer(),this.timer=setTimeout(()=>{this.prune(),this.startTimer()},this.delay)}clearTimer(){this.timer!=null&&(clearTimeout(this.timer),this.timer=null)}prune(){const e=this.validator;if(e==null||typeof e!="function"){this.clear();return}for(const[i,s]of this)e(i,s)||this.delete(i)}get(e){const i=super.get(e);if(i!=null){if(this.validate(e,i))return i;this.delete(e)}}validate(e,i){const s=this.validator;return s==null||typeof s!="function"?!0:s(e,i)}cleanup(){this.clear(),this.clearTimer()}}class zt{constructor(t={},e){l(this,"elements");l(this,"id");l(this,"name");l(this,"type");l(this,"paper");l(this,"margins");l(this,"style");l(this,"pages",[]);l(this,"attributes");l(this,"ds");this.id=t.id??bt(It.DEFINE_DOCUMENT),this.name=t.name??"未命名的文档",this.type=t.type??ae.NORMAL,this.paper=this.createPaper(t.paper),this.pages=Et(e),this.ds=this.createDS(t.ds),this.attributes=t.attributes??{grid:!0},this.margins=t.margins,this.style=this.createStyle(t.style),this.pages.length>0&&this.pages.forEach(i=>i.setParent(this)),st(this,"elements",new bn((i,s)=>s.parent!=null))}static createNormalDocument(){const t={height:297,orientation:z.PORTRAIT,size:"A4",width:210},e=ht.create({index:0,orientation:t.orientation}),i={type:ae.NORMAL,paper:t};return new zt(i,[e])}static create(t){const e=typeof t=="string"?qt(t,{}):$e(t),i=Et(e.pages).map(s=>ht.create(s));return new zt(e,i)}get paperWidth(){return this.paper.width}get paperHeight(){return this.paper.height}get firstPage(){return this.pages[0]}get useGrid(){return this.attributes.grid===!0}createPaper(t){if(t==null)return{...et};if(t.size===Dt.CUSTOM)return{size:Dt.CUSTOM,orientation:(t==null?void 0:t.orientation)??et.orientation,width:(t==null?void 0:t.width)??et.width,height:(t==null?void 0:t.height)??et.height};const e=tn.find(i=>i.size===t.size);return e==null?{...et}:{...e}}createDS(t){return{fields:(t==null?void 0:t.fields)??[]}}createStyle(t){return{fontFamily:t==null?void 0:t.fontFamily,enFontFamily:t==null?void 0:t.enFontFamily,fontSize:(t==null?void 0:t.fontSize)??"9pt",lineHeight:(t==null?void 0:t.lineHeight)??"1.15"}}createMarginsFromPaper(t){if(t==null||t.margins==null||Object.keys(t.margins).length==0)return;const e=t.margins;return{top:e.top==null?void 0:$(e.top),right:e.right==null?void 0:$(e.right),bottom:e.bottom==null?void 0:$(e.bottom),left:e.left==null?void 0:$(e.left)}}updateDS(t){this.ds=this.createDS(t)}submit(){return this}findElement(t){const e=this.elements.get(t);if(e)return e;for(const i of this.pages){const s=i.findElement(t);if(s)return this.elements.set(t,s),s}}findPage(t){return this.pages.find(e=>t===e.id)}cleanup(){this.elements.cleanup()}}L.register(S.TEXT,mn);L.register(S.NUMBER,On);L.register(S.DATE,wn);L.register(S.TABLE,Rn);L.register(S.TABLE_ROW,Tt);L.register(S.TABLE_CELL,Zt);L.register(S.PARAGRAPH,Nn);const In=["xlink:href"],Ln=q({__name:"Icon",props:{icon:{type:String,required:!0},size:{type:String,default:"14px"},color:{type:String}},setup(n){const t=n,e=X(()=>({fontSize:t.size,color:t.color}));return(i,s)=>(Gt(),Yt("svg",{class:pt(i.classes.icon),"aria-hidden":"true",style:We(e.value)},[lt("use",{"xlink:href":"#"+n.icon},null,8,In)],6))}}),An="_icon_1uhhs_2",yn={icon:An},Xt=(n,t)=>{const e=n.__vccOpts||n;for(const[i,s]of t)e[i]=s;return e},Mn={classes:yn},Bt=Xt(Ln,[["__cssModules",Mn]]),_n=q({__name:"Zoom",props:{scale:{type:Number,default:100}},emits:["zoomIn","zoomOut"],setup(n,{emit:t}){const e=t;function i(){e("zoomIn")}function s(){e("zoomOut")}return(r,a)=>(Gt(),Yt("div",{class:pt(r.classes.zoom)},[lt("button",{type:"button",class:"quickprint-text-btn",onClick:i,title:"缩小"},[g(Bt,{icon:"icon-minus"})]),lt("span",{class:pt(r.classes.scale)},Ue(n.scale)+"%",3),lt("button",{type:"button",class:"quickprint-text-btn",onClick:s,title:"放大"},[g(Bt,{icon:"icon-plus"})])],2))}}),xn="_zoom_13dvp_2",Pn="_scale_13dvp_8",Cn={zoom:xn,scale:Pn},Sn={classes:Cn},Ps=Xt(_n,[["__cssModules",Sn]]);let mt=Dn();function Cs(n){return n!=null&&(mt=n),mt}function Dn(){let n=3e3;function t(){return n}function e(s){n=s}function i(){return n++,n}return{getZIndex:t,setZIndex:e,getNextZIndex:i}}function Ss(){return mt.getZIndex()}function Ds(){return mt.getNextZIndex()}const zn="_table_1w0g4_1",Bn="_thead_1w0g4_21",Hn="_tbody_1w0g4_29",kn="_index_1w0g4_45",Fn="_cell_1w0g4_49",Wn="_expand_1w0g4_53",Un="_expandBtn_1w0g4_57",Yn="_expandActive_1w0g4_92",Gn="_indent_1w0g4_102",Vn="_indentLast_1w0g4_128",y={table:zn,thead:Bn,tbody:Hn,index:kn,cell:Fn,expand:Wn,expandBtn:Un,expandActive:Yn,indent:Gn,indentLast:Vn};function jn(n){return{name:"$index",title:"#",width:n.width??48}}function qn(n){return{name:"$expand",width:n.width??36}}function Zn(n){return{...n,title:n.title??n.name,width:n.width??80}}const zs=q({emits:["select"],props:{columns:{type:Array,required:!0},data:{type:Array,default(){return[]}}},setup(n,{emit:t}){const e=X(()=>n.columns.map(p=>p.name==="$index"?jn(p):p.name==="$expand"?qn(p):Zn(p)));function i(p){p.$expand=p.$expand!==!0}function s(p){if(p.children==null||p.children.length==0)return;const T={[y.expandBtn]:!0,[y.expandActive]:p.$expand===!0};return g("div",{class:y.expand},[g("button",{type:"button",onClick:()=>i(p),class:T},null)])}function r(p){const T={[y.indent]:!0,[y.indentLast]:p.isLastChildren};return g("div",{class:T},null)}function a(p,T,C){if(typeof T.render=="function")return T.render(p,T,C);if(T.name=="$index")return g("div",{class:y.cell},[C.rowIndex+1]);if(T.name=="$expand")return C.isChildren?r(C):s(p);const d=T.formatter?T.formatter(p,T):p[T.name];return g("div",{class:y.cell},[d])}function c(p,T){const C=e.value.map(d=>g("td",{class:R(d)},[a(p,d,T)]));return g("tr",{onClick:ot.bind(null,p,T)},[C])}function w(p){return{[y.index]:p.name==="$index"}}function R(p){return{[y.index]:p.name==="$index"}}function A(){let p=0;const T=n.data.reduce((C,d)=>{if(C.push(c(d,{rowIndex:p++,classes:y})),d.children&&d.children.length>0&&d.$expand===!0){const E=d.children.map((v,B)=>c(v,{rowIndex:p++,classes:y,isChildren:!0,isLastChildren:B===d.children.length-1,parent:d}));return C.concat(E)}return C},[]);return g("tbody",null,[T])}function M(){const p=e.value.map(T=>g("col",{width:T.width},null));return g("colgroup",null,[p])}function x(){const p=e.value.map(T=>g("th",{class:w(T)},[g("div",{class:y.cell},[T.title])]));return g("thead",null,[g("tr",null,[p])])}function ot(p,T){t("select",p,T==null?void 0:T.parent)}return function(){return g("div",{class:y.table},[g("div",{class:y.thead},[g("table",null,[M(),x()])]),g("div",{class:y.tbody},[g("table",null,[M(),A()])])])}}}),Ht=4,Ot="http://www.w3.org/2000/svg",kt="@quickprint-contextmenu-handler";let D=null;function $t(n){return typeof n.disabled=="function"?n.disabled(n)===!0:typeof n.disabled=="boolean"?n.disabled===!0:!1}function Xn(n){typeof n.handler=="function"&&n.handler(n)}function $n(){const n=document.createElement("div");return n.className="quickprint-contextmenu-divider",n}function Oe(n){if(n==null||n==""){const i=document.createElement("div");return i.className="quickprint-contextmenu-icon",i}const t=document.createElementNS(Ot,"svg"),e=document.createElementNS(Ot,"use");return e.setAttribute("href","#"+n),t.setAttribute("class","quickprint-contextmenu-icon"),t.appendChild(e),t}function Jn(){const n=document.createElementNS(Ot,"svg"),t=document.createElementNS(Ot,"use");return t.setAttribute("href","#icon-right"),n.setAttribute("class","quickprint-contextmenu-arrow"),n.appendChild(t),n}function we(n,t){if($t(n)||n.type==="menu"&&n.submenu&&n.submenu.length>0)return;const e=function(i){i.stopPropagation(),t.removeEventListener("click",e),Xn(n),rt()};t.addEventListener("click",e),Reflect.set(t,kt,e)}function Qn(n){const t=document.createElement("button");return t.type="button",t.title=n.label,t.className="quickprint-text-btn",t.appendChild(Oe(n.icon)),$t(n)&&t.classList.add("quickprint-contextmenu-disabled"),we(n,t),t}function Re(n){const t=document.createElement("div");t.className="quickprint-contextmenu-menu";const e=document.createElement("div"),i=$t(n),s=Oe(n.icon),r=document.createElement("div");if(r.textContent=n.label,r.className="quickprint-contextmenu-label",e.className="quickprint-contextmenu-item",e.append(s,r),n.detail){const c=document.createElement("div");c.textContent=n.detail,c.className="quickprint-contextmenu-detail",e.appendChild(c)}i&&e.classList.add("quickprint-contextmenu-disabled"),we(n,e),t.appendChild(e);const a=Array.isArray(n.submenu)&&n.submenu.length>0;if(a&&!i){const c=document.createElement("div");c.className="quickprint-contextmenu-submenu";for(const w of n.submenu){const R=Re(w);c.appendChild(R)}t.appendChild(c)}return a&&e.appendChild(Jn()),t}function Kn(n,t){const e=document.createElement("div");if(e.id=n,e.className="quickprint-contextmenu",e.addEventListener("mouseover",ce),Array.isArray(t.top)&&t.top.length>0){const s=document.createElement("div");s.className="quickprint-contextmenu-top";for(const r of t.top){const a=Qn(r);s.appendChild(a)}e.appendChild(s)}const i=t.menus??[];for(const s of i){const r=s.type==="divider"?$n():Re(s);e.append(r)}return document.body.appendChild(e),{id:n,element:e,cleanup(){const s=[...e.querySelectorAll(".quickprint-contextmenu-item"),...e.querySelectorAll(".quickprint-contextmenu-top > button.quickprint-text-btn")];for(const r of s){const a=Reflect.get(r,kt);typeof a=="function"&&(r.removeEventListener("click",a),Reflect.deleteProperty(r,kt))}e.removeEventListener("mouseover",ce),document.body.removeChild(e)}}}function rt(){D!=null&&(D.cleanup(),D=null)}function ti(n,t,e){rt();const i=bt(It.CONTEXTMENU);return D=Kn(i,e),pe().then(()=>{if(D==null)return;const s=D.element,r=s.offsetWidth,a=s.offsetHeight;let c=t,w=n;c+a>window.innerHeight&&(c=window.innerHeight-a-Ht),w+r>window.innerWidth&&(w=window.innerWidth-r-Ht),s.style.top=c+"px",s.style.left=w+"px",s.classList.add("quickprint-contextmenu-open")}),{id:i,close:rt}}function ei(n){if(D!=null&&n.target instanceof Node){if(D.element.contains(n.target))return n.preventDefault();rt()}}function ni(n){D!=null&&n.target instanceof Node&&(D.element.contains(n.target)||rt())}function ce(n){if(n.stopPropagation(),D==null)return;const t=D.element.querySelector(".quickprint-contextmenu-expand");t&&!t.contains(n.target)&&ii(t);const e=n.target.closest(".quickprint-contextmenu-item");if(e==null||e.matches(".quickprint-contextmenu-disabled"))return;const i=e.closest(".quickprint-contextmenu-menu");i!=null&&si(i)}function ii(n){n.classList.remove("quickprint-contextmenu-expand"),n.classList.remove("quickprint-contextmenu-visible")}function si(n){if(n.matches(".quickprint-contextmenu-expand"))return;const t=n.querySelector(".quickprint-contextmenu-submenu");t!=null&&(n.classList.add("quickprint-contextmenu-expand"),pe().then(()=>{const e=t.getBoundingClientRect(),i=n.getBoundingClientRect();let s=-4,r=i.width;i.top+e.height>window.innerHeight&&(s=window.innerHeight-e.height-Ht-i.top),i.right+e.width>window.innerWidth&&(r=-e.width),t.style.top=s+"px",t.style.left=r+"px",n.classList.add("quickprint-contextmenu-visible")}))}window.addEventListener("contextmenu",ei,!0);window.addEventListener("click",ni,!0);const Bs={open:ti,close:rt},ri=q({__name:"Loading",setup(n){return(t,e)=>(Gt(),Yt("div",{class:pt(t.classes.loading)},[g(Bt,{icon:"icon-loading"}),e[0]||(e[0]=lt("span",null,"正在加载中...",-1))],2))}}),oi="_loading_n57p9_2",ai={loading:oi,"loading-rotate":"_loading-rotate_n57p9_1"},ci={classes:ai},ui=Xt(ri,[["__cssModules",ci]]);function Hs(n){}function ks(n){return Ye({loader:n,loadingComponent:ui})}if(document.getElementById("quickprint-icon")==null){const n=document.createElement("script");n.id="quickprint-icon",n.src="//at.alicdn.com/t/c/font_4643940_1b7bp37pl02.js",document.head.appendChild(n)}const u=Object.freeze({NULL:0,UNDEFINED:1,STRING:2,NUMBER:3,BOOLEAN:4,BIGINT:5,TEMPLATE:6,VARIABLE:11,REFERENCE:12,FUNCTION:13,OPERATOR:14}),o=Object.freeze({Group:8648,Plus:43,Minus:45,Asterisk:42,Slash:47,Percent:37,Power:94,Nullish:8658,Eq:61,Equal:10869,NotEqual:8800,Lt:60,Lte:10877,Gt:62,Gte:10878,And:38,Or:124,Not:33,LogicalAnd:10837,LogicalOr:8214,LogicalNot:33,OpenBracket:40,CloseBracket:41,LeftSquare:91,RightSquare:93,Comma:44,Question:63,Colon:58,At:64,SingleQuote:39,DoubleQuote:34,Zero:48,One:49,Two:50,Three:51,Four:52,Five:53,Six:54,Seven:55,Eight:56,Nine:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,f:102,n:110,t:116,u:117,Tab:9,NewLine:10,FormFeed:12,CarriageReturn:13,Space:32,Backslash:92,NumberSign:35,Semi:59,Dot:46}),Lt={Group:19,Function:18,Negative:15,[o.OpenBracket]:19,[o.CloseBracket]:19,[o.LogicalNot]:15,[o.Power]:14,[o.Asterisk]:13,[o.Slash]:13,[o.Plus]:12,[o.Minus]:12,[o.Lt]:10,[o.Lte]:10,[o.Gt]:10,[o.Gte]:10,[o.Equal]:9,[o.NotEqual]:9,[o.LogicalAnd]:5,[o.LogicalOr]:4,[o.Nullish]:4,[o.Question]:3,[o.Colon]:3},P=Object.freeze({EXPRESSION:0,OPERATOR:1,FUNCTION:2,TERNARY_TRUE:3,TERNARY_FALSE:4});function Ne(n){switch(n){case u.NULL:return"Null";case u.UNDEFINED:return"Undefined";case u.STRING:return"String";case u.NUMBER:return"Number";case u.BOOLEAN:return"Boolean";case u.VARIABLE:return"Variable";case u.FUNCTION:return"Function";case u.OPERATOR:return"Operator";default:return"Unknown"}}function ve(n){switch(n){case o.Equal:return"==";case o.NotEqual:return"!=";case o.Lte:return"<=";case o.Gte:return">=";case o.LogicalAnd:return"&&";case o.LogicalOr:return"||";case o.Power:return"**";case o.Nullish:return"??";case o.Group:return"()";default:return String.fromCharCode(n)}}function be(n){switch(n.type){case u.OPERATOR:return ve(n.value);case u.NULL:return"null";case u.UNDEFINED:return"undefined";default:return n.value}}function li(n){return{type:Ne(n.type),value:be(n)}}function Ft(n){return Reflect.get(Lt,n)??0}function di(n){switch(n.type){case u.FUNCTION:return Lt.Function;case u.OPERATOR:return Ft(n.value);default:return 0}}function I(n,t){const e=new Error(`Invalid ${n} at position ${t}`);return Reflect.set(e,"__err_index__",t),e}function hi(n){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(n)}function fi(n,t){switch(n){case u.NULL:return null;case u.UNDEFINED:return;case u.NUMBER:return t==="NaN"?Number.NaN:Number(t);case u.BOOLEAN:return t==="true";case u.REFERENCE:return t.charCodeAt(0)===o.LeftSquare?t.slice(2,-1):t;case u.VARIABLE:return t.charCodeAt(0)===o.LeftSquare?t.slice(1,-1):t;case u.TEMPLATE:return t;default:return t}}function b(n,t,e,i){return{type:n,value:fi(n,t),start:e,end:i??e+t.length-1,precedence:di({type:n,value:t})}}function pi(n,t,e){const i=n.indexOf(String.fromCharCode(e),t+1);if(i===-1)throw I("string",t);const s=n.slice(t+1,i),r=s.split(/(\[[0-2]\.[0-6](?:\.[^.]+)?\.[^.]+\])/);if(r.length==0)throw I("string",t);if(r.length==1)return{start:t,end:i,value:b(u.STRING,s,t)};let a=t+1;const c=r.reduce((R,A)=>{if(A=="")return R;const M=b(A.charCodeAt(0)===o.LeftSquare?u.VARIABLE:u.STRING,A,a);return a=M.end+1,R.push(M),R},[]),w=b(u.TEMPLATE,c,t,i);return{start:t,end:i,value:w}}function gi(n,t){const e=n.slice(t).match(/^([\.\d]+)\D?/);if(e==null)throw I("number",t);const i=e[1];if(!hi(i))throw I("number",t);const s=b(u.NUMBER,i,t);return{start:t,end:s.end,value:s}}function Ei(n,t){const e=n.slice(t).match(/^(\[=\w+\])/);if(e==null)throw I("reference",t);const i=b(u.REFERENCE,e[1],t);return{start:t,end:i.end,value:i}}function Ti(n,t){const e=n.charCodeAt(t+1);if(e!==o.Zero&&e!==o.One&&e!==o.Two)throw I("variable",t);const i=n.slice(t).match(/^(\[[0-2]\.[0-6](?:\.[^.]+)?\.[^.]+\])/);if(i==null)throw I("variable",t);const s=b(u.VARIABLE,i[1],t);return{start:t,end:s.end,value:s}}function mi(n,t){const e=n.slice(t).match(/^([A-Z_]+)/);if(e==null)throw I("function",t);const i=b(u.FUNCTION,e[1],t);return{start:t,end:i.end,value:i}}function Oi(n,t){const e=n.slice(t).match(/^(true|false)/);if(e==null)throw I("boolean",t);const i=b(u.BOOLEAN,e[1],t);return{start:t,end:i.end,value:i}}function wi(n,t){const e=n.slice(t).match(/^(null|undefined)/);if(e==null)throw I("input",t);const i=e[1],s=i==="null"?u.NULL:u.UNDEFINED,r=b(s,i,t);return{start:t,end:r.end,value:r}}function Ie(n){const t=[];let e=0;for(;e<n.length;){const i=n.charCodeAt(e);switch(i){case o.SingleQuote:case o.DoubleQuote:{const s=pi(n,e,i);t.push(s.value),e=s.end+1;break}case o.Zero:case o.One:case o.Two:case o.Three:case o.Four:case o.Five:case o.Six:case o.Seven:case o.Eight:case o.Nine:{const s=gi(n,e);t.push(s.value),e=s.end+1;break}case o.t:case o.f:{const s=Oi(n,e);t.push(s.value),e=s.end+1;break}case o.n:case o.u:{const s=wi(n,e);t.push(s.value),e=s.end+1;break}case o.LeftSquare:{if(n.charCodeAt(e+1)===o.Eq){const r=Ei(n,e);t.push(r.value),e=r.end+1;break}const s=Ti(n,e);t.push(s.value),e=s.end+1;break}case o.A:case o.B:case o.C:case o.D:case o.E:case o.F:case o.G:case o.H:case o.I:case o.J:case o.K:case o.L:case o.M:case o.N:case o.O:case o.P:case o.Q:case o.R:case o.S:case o.T:case o.U:case o.V:case o.W:case o.X:case o.Y:case o.Z:{const s=mi(n,e);t.push(s.value),e=s.end+1;break}case o.Lt:{const s=n.charCodeAt(e+1),r=s===o.Eq?2:1,a=s===o.Eq?o.Lte:o.Lt,c=b(u.OPERATOR,a,e,e+r-1);t.push(c),e+=r;break}case o.Gt:{const s=n.charCodeAt(e+1),r=s===o.Eq?2:1,a=s===o.Eq?o.Gte:o.Gt,c=b(u.OPERATOR,a,e,e+r-1);t.push(c),e+=r;break}case o.Eq:{const s=n.charCodeAt(e+1)===o.Eq?2:1,r=b(u.OPERATOR,o.Equal,e,e+s-1);t.push(r),e+=s;break}case o.Not:{const s=n.charCodeAt(e+1),r=s===o.Eq?2:1,a=s===o.Eq?o.NotEqual:o.LogicalNot,c=b(u.OPERATOR,a,e,e+r-1);t.push(c),e+=r;break}case o.And:{const s=n.charCodeAt(e+1)===o.And?2:1,r=b(u.OPERATOR,o.LogicalAnd,e,e+s-1);t.push(r),e+=s;break}case o.Or:{const s=n.charCodeAt(e+1)===o.Or?2:1,r=b(u.OPERATOR,o.LogicalOr,e,e+s-1);t.push(r),e+=s;break}case o.Asterisk:{const s=n.charCodeAt(e+1),r=s===o.Asterisk?2:1,a=s===o.Asterisk?o.Power:o.Asterisk,c=b(u.OPERATOR,a,e,e+r-1);t.push(c),e+=r;break}case o.Question:{const s=n.charCodeAt(e+1),r=s===o.Question?2:1,a=s===o.Question?o.Nullish:o.Question,c=b(u.OPERATOR,a,e,e+r-1);t.push(c),e+=r;break}case o.Plus:case o.Slash:case o.Minus:case o.OpenBracket:case o.CloseBracket:case o.Comma:case o.Percent:case o.Colon:{const s=b(u.OPERATOR,i,e,e);t.push(s),e++;break}default:{if(!/^\s$/.test(n[e]))throw new Error("Unexpected error at position "+e);e++}}}return t}class U{constructor(t){l(this,"type");l(this,"value");l(this,"start");l(this,"end");l(this,"precedence");l(this,"result");l(this,"left");l(this,"right");l(this,"condition");l(this,"children");this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,this.precedence=t.precedence}static appendNode(t,e){if(t==null)return e;if(!t.isOperator&&!e.isOperator)throw I("input",e.start);if(!t.isOperator&&e.isOperator)return e.appendLeft(t),e;if(t.isOperator&&!e.isOperator)return t.appendRight(e),t;const i=t.precedence??-1;return(e.precedence??-1)<=i?t.isLogicalNot&&e.isLogicalNot?(t.appendRight(e),t):(e.appendLeft(t),e):(t.right&&(e.appendLeft(t.right),t.right=void 0),t.appendRight(e),t)}static createGroupNode(t,e){return new U({type:u.OPERATOR,value:o.Group,start:t,end:e,precedence:Lt.Group})}get isOperator(){return this.type===u.OPERATOR}get isMinus(){return this.type===u.OPERATOR&&this.value===o.Minus}get isOpenBracket(){return this.type===u.OPERATOR&&this.value===o.OpenBracket}get isCloseBracket(){return this.type===u.OPERATOR&&this.value===o.CloseBracket}get isLogicalNot(){return this.type===u.OPERATOR&&this.value===o.LogicalNot}get isFunction(){return this.type===u.FUNCTION}get isComma(){return this.type===u.OPERATOR&&this.value===o.Comma}get isQuestion(){return this.type===u.OPERATOR&&this.value===o.Question}get isColon(){return this.type===u.OPERATOR&&this.value===o.Colon}get isGroup(){return this.isOperator&&this.value===o.Group}get isPrimitive(){switch(this.type){case u.FUNCTION:case u.OPERATOR:return!1;default:return!0}}appendLeft(t){this.left=t,this.start=t.start}appendRight(t){this.right=t,this.end=t.end}appendChild(t){this.children==null&&(this.children=[]),this.children.push(t)}}function Ri(n){switch(n.type){case u.FUNCTION:case u.VARIABLE:case u.REFERENCE:case u.NUMBER:return!0;case u.OPERATOR:return n.value===o.Group;default:return!1}}function Y(n,t){let e,i=(t==null?void 0:t.start)??0;for(;i<n.length;){const s=new U(n[i]);if((t==null?void 0:t.mode)===P.EXPRESSION&&e){if(s.isCloseBracket)return{root:e,start:t.start,end:i-1};const r=t.precedence??0;if((s.precedence??0)<=r)return{root:e,start:t.start,end:i-1}}if((t==null?void 0:t.mode)===P.OPERATOR&&s.isOperator&&s.value===t.expect){if(e==null)throw I("input",s.start);return{root:e,start:t.start,end:i}}if((t==null?void 0:t.mode)===P.FUNCTION&&s.isComma){if(t.function==null)throw I("input",s.start);t.function.appendChild(e),e=void 0,i++;continue}if((t==null?void 0:t.mode)===P.FUNCTION&&s.isCloseBracket){if(t.function==null)throw I("input",s.start);return e&&t.function.appendChild(e),{root:t.function,start:t.start,end:i}}if((t==null?void 0:t.mode)===P.TERNARY_TRUE&&s.isColon){if(e==null)throw I("input",s.start);return{root:e,start:t.start,end:i-1}}if((t==null?void 0:t.mode)===P.TERNARY_FALSE&&e){if(s.isColon||s.isCloseBracket||s.isComma)return{root:e,start:t.start,end:i-1};const r=t.precedence??0;if((s.precedence??0)<=r)return{root:e,start:t.start,end:i-1}}if(s.isOpenBracket){const r=Y(n,{start:i+1,expect:o.CloseBracket,mode:P.OPERATOR}),a=U.createGroupNode(i,r.end);a.appendRight(r.root),e=U.appendNode(e,a),i=r.end+1;continue}if(s.isMinus&&(e==null||e.isOperator)){const r=Y(n,{start:i+1,expect:null,mode:P.EXPRESSION,precedence:Lt.Negative});if(Ri(r.root)){s.appendRight(r.root),e=U.appendNode(e,s),i=r.end+1;continue}}if(s.isLogicalNot){const r=Y(n,{start:i+1,expect:null,mode:P.EXPRESSION,precedence:o.LogicalNot});s.appendRight(r.root),e=U.appendNode(e,s),i=r.end+1;continue}if(s.isFunction){const r=n[i+1];if(r==null||r.type!==u.OPERATOR||r.value!==o.OpenBracket)throw I("input",i);const a=Y(n,{start:i+2,expect:o.CloseBracket,mode:P.FUNCTION,function:s});s.end=a.end,e=U.appendNode(e,s),i=a.end+1;continue}if(s.isQuestion){const r=Y(n,{start:i+1,expect:o.Colon,mode:P.TERNARY_TRUE,precedence:Ft(o.Question)}),a=Y(n,{start:r.end+2,mode:P.TERNARY_FALSE,expect:null,precedence:Ft(o.Colon)});s.appendLeft(r.root),s.appendRight(a.root),s.condition=e,s.start=(e==null?void 0:e.start)??0,e=s,i=a.end+1;continue}if(s.isOperator){if(e==null)throw I("input",s.start);if(s.isMinus){const a=n[i+1];if(a&&a.type===u.OPERATOR&&a.value===o.Minus)throw I("input",s.start)}const r=Y(n,{start:i+1,mode:P.EXPRESSION,expect:null,precedence:s.precedence??0});s.appendLeft(e),s.appendRight(r.root),e=s,i=r.end+1;continue}e=U.appendNode(e,s),i++}if(e==null)throw new Error("Uncaught SyntaxError");return{root:e,start:0,end:n.length-1}}const Wt=new Map;function Ni(n){const t=Ie(n),e=Y(t),i=[],s=[];for(const a of t){if(a.type===u.REFERENCE){s.push(a);continue}if(a.type===u.VARIABLE){i.push(a);continue}if(a.type===u.TEMPLATE){const c=Array.isArray(a.value)?a.value:[a.value];for(const w of c)if(w.type===u.VARIABLE){i.push(w);continue}}}const r={root:e.root,tokens:t,variable:i,reference:s};return Wt.set(n,r),r}function vi(n){const t=Wt.get(n);if(t)return t;const e=Ni(n);return Wt.set(n,e),e}function bi(n,t){if(!(t instanceof Error))return console.log(t);console.error(t)}const Fs={tokenize:Ie,parse:Y,compile:vi,formatOperator:ve,formatToken:li,formatTokenType:Ne,formatTokenValue:be,debug:bi};/*! @dongls/xWindow v0.2.13 https://github.com/dongls/xWindow
Copyright 2023-present dongls
Released under the MIT License */var Ii=Object.defineProperty,Li=(n,t,e)=>t in n?Ii(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e,h=(n,t,e)=>(Li(n,typeof t!="symbol"?t+"":t,e),e);const Le=Symbol(),F=Object.freeze({WINDOW:"x-window",SIMPLE_WINDOW:"x-simple-window",TRANSITION:"x-window-is-transition",MENU:"x-window-is-menu",FOCUSED:"x-window-is-focused",MAXIMIZE:"x-window-is-maximize",HEADER:"x-window-header",BODY:"x-window-body"}),m=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8}),V=Object.freeze({TOP:m.TOP,BOTTOM:m.BOTTOM,LEFT:m.LEFT,RIGHT:m.RIGHT,TOP_LEFT:m.TOP|m.LEFT,TOP_RIGHT:m.TOP|m.RIGHT,BOTTOM_LEFT:m.BOTTOM|m.LEFT,BOTTOM_RIGHT:m.BOTTOM|m.RIGHT}),f=Object.freeze({NONE:m.NONE,MAXIMIZE:m.TOP,LEFT:m.LEFT,RIGHT:m.RIGHT,TOP_LEFT:m.TOP|m.LEFT,TOP_RIGHT:m.TOP|m.RIGHT,BOTTOM_LEFT:m.BOTTOM|m.LEFT,BOTTOM_RIGHT:m.BOTTOM|m.RIGHT}),it=Object.freeze({DISABLED:0,RESIZE:1,RESIZE_ONLY:2}),K=Object.freeze({INIT:0,MOUNTED:1,UNMOUNTED:2}),Jt=Object.freeze({SIMPLE_WINDOW:"SimpleWindow",BLANK_WINDOW:"BlankWindow"}),k=Object.freeze({CLOSE:0,MAXIMIZE:1,RESTORE:2,PIN:3,UNPIN:4});class Qt{constructor(t,e,i){h(this,"type"),h(this,"stopped",!1),h(this,"defaultPrevented",!1),h(this,"instance"),h(this,"detail"),this.type=t,this.instance=e,this.detail=i}stop(){this.stopped=!0}preventDefault(){this.defaultPrevented=!0}}class wt{constructor(){h(this,"ALL_EVENTS",new Map)}static NOOP(){}on(t,e){const i=this.ALL_EVENTS.get(t);return i==null?(this.ALL_EVENTS.set(t,[e]),this):(i.includes(e)||i.push(e),this)}once(t,e){const i=s=>{e(s),this.off(t,i,!0)};return this.on(t,i),this}off(t,e,i=!1){const s=this.ALL_EVENTS.get(t);if(s==null)return this;const r=s.indexOf(e);return r<0||(i?s.splice(r,1,wt.NOOP):s.splice(r,1)),this}dispatch(t){const e=this.ALL_EVENTS.get(t.type);if(e==null)return t;for(const s of e)if(typeof s=="function"&&s(t),t.stopped)break;const i=e.filter(s=>s!=wt.NOOP);return this.ALL_EVENTS.set(t.type,i),t}cleanup(){this.ALL_EVENTS.clear()}}function tt(n,t,e){return t!=null&&Number.isFinite(t)&&n<t?t:n}function ue(n){return n==null||typeof n!="string"||n.length==0}function Ai(n){n.stopPropagation()}const yi={top:"offsetTop",left:"offsetLeft",width:"offsetWidth",height:"offsetHeight"};class Mi{constructor(t){h(this,"init",!1),h(this,"defaultPrevented",!1),h(this,"originalEvent"),h(this,"target"),h(this,"direction"),this.originalEvent=t,this.target=t.target,this.direction=Reflect.get(this.target,At.PROP)}createEvent(t,e){return new Qt(t,e,this)}}class At{constructor(t){h(this,"context"),h(this,"window"),h(this,"onResizing"),h(this,"onResizeend"),this.window=t}resizestart(t){t.stopPropagation(),t.preventDefault();const e=new Mi(t);this.context=e,this.onResizing=this.resizing.bind(this),this.onResizeend=this.resizeend.bind(this),window.addEventListener("pointermove",this.onResizing),window.addEventListener("pointerup",this.onResizeend)}resizing(t){if(this.context==null)return;t.stopPropagation(),t.preventDefault();const e=this.context;if(!e.init){if(this.window.dispatch(this.context.createEvent("resizeStart",this.window)).defaultPrevented)return this.cleanup();e.target.setPointerCapture(t.pointerId),e.init=!0}const i=this.calcWindowState(t),s=this.window.getElement();for(const a in i){const c=Math.round(i[a]);Reflect.set(s.style,a,c+"px")}e.originalEvent=t;const r=this.context.createEvent("resizing",this.window);this.window.dispatch(r)}resizeend(t){if(this.context==null)return;t.stopPropagation(),t.preventDefault();const e=this.context;if(e.init){const i=e.createEvent("resizeEnd",this.window);this.window.dispatch(i),this.patchWindowState(this.calcWindowState(t)),e.target.releasePointerCapture(t.pointerId)}this.cleanup()}cleanup(){this.onResizing&&window.removeEventListener("pointermove",this.onResizing),this.onResizeend&&window.removeEventListener("pointerup",this.onResizeend),this.onResizing=void 0,this.onResizeend=void 0,this.context=void 0}calcWindowState(t){const e=this.context,i=this.window.options,s=typeof i.minWidth=="number"&&i.minWidth>=0?i.minWidth:360,r=typeof i.minHeight=="number"&&i.minHeight>=0?i.minHeight:32,a=this.window.getElement().getBoundingClientRect(),c={};return e.direction&m.TOP&&(c.height=tt(a.bottom-tt(t.clientY,0),r),c.top=a.bottom-c.height),e.direction&m.BOTTOM&&(c.height=tt(t.clientY-a.top,r)),e.direction&m.LEFT&&(c.width=tt(a.right-tt(t.clientX,0),s),c.left=a.right-c.width),e.direction&m.RIGHT&&(c.width=tt(t.clientX-a.left,s)),c}patchWindowState(t){const e=this.window.state;for(const i in t){const s=Math.round(t[i]),r=yi[i];r!=null&&Reflect.set(e,r,s)}}}h(At,"PROP","__xwindow_resize_prop__");const N={window:"_1T2rhwiL",dragging:"yi9w1sZD",resizing:"Ja2o9U31",maximize:"_1eMSsKoB",focused:"_3czvPpS2",header:"GiVk7T8N",menu:"VuG4WNig x-window-is-menu",logo:"yBPezU8e",main:"xbuRK23n",init:"_9t1NJBZM",title:"shyxrRzw",menus:"nkEGqTFw",body:"pk12TusX",footer:"noixF94i",closeMenu:"ifXDegN1 VuG4WNig x-window-is-menu",pinMenu:"X5A6roxN VuG4WNig x-window-is-menu",resizeBar:"PPmfTMRL",resizeTop:"v8UGXgKi PPmfTMRL",resizeBottom:"_74VJ9GNt PPmfTMRL",resizeRight:"gg9Mcwey PPmfTMRL",resizeLeft:"Tw7sCaLt PPmfTMRL",resizeTopLeft:"CPuApFyD PPmfTMRL",resizeBottomLeft:"VBRi4FWg PPmfTMRL",resizeTopRight:"gCRpuZdB PPmfTMRL",resizeBottomRight:"iRYpNoUT PPmfTMRL",mask:"xTcKGSVA",simpleWindow:"Mh7BVc1o"},Ae=q({name:"WindowBody",props:{wid:String,body:{type:[Object,Function,String,Number],default:null},abstractWindow:{type:Object,required:!0}},setup:n=>function(){const t=typeof n.body=="function"?n.body(n.abstractWindow):n.body;return t==null&&console.warn("[xWindow] 请指定窗体内容:",n.abstractWindow.options.title),t}}),_i=Math.floor(Number.MAX_SAFE_INTEGER/10)-1e4,xi=[[N.resizeTop,V.TOP],[N.resizeBottom,V.BOTTOM],[N.resizeLeft,V.LEFT],[N.resizeRight,V.RIGHT],[N.resizeTopLeft,V.TOP_LEFT],[N.resizeTopRight,V.TOP_RIGHT],[N.resizeBottomLeft,V.BOTTOM_LEFT],[N.resizeBottomRight,V.BOTTOM_RIGHT]],Rt=q({name:"BlankWindow",props:{abstractWindow:{type:Object,required:!0}},setup(n,{slots:t}){const e=qe(),i=Vt({visible:!1,offsetWidth:0,offsetHeight:0,offsetTop:0,offsetLeft:0,focused:!1,pinned:!1,zIndex:0,splitMode:f.NONE}),s=jt(K.INIT),r=X(()=>{const d=n.abstractWindow.options;return typeof d.zIndex=="number"&&d.zIndex>0}),a=X(()=>{const d=n.abstractWindow.options;return r.value?d.zIndex:(i.pinned?_i:0)+i.zIndex}),c=function(d,E,v,B){return X(()=>{const _=d.options;if(E.value==K.INIT)return{width:_.width,height:_.height,left:_.left,top:_.top};const Z=_.mask?null:B.value;return{top:v.offsetTop+"px",left:v.offsetLeft+"px",width:v.offsetWidth+"px",height:E.value==K.INIT?void 0:v.offsetHeight+"px",zIndex:Z}})}(n.abstractWindow,s,i,a),w=X(()=>{const d=[F.WINDOW,N.window],E=n.abstractWindow;var v;return E.type===Jt.SIMPLE_WINDOW&&d.push(F.SIMPLE_WINDOW),s.value==K.INIT&&d.push(N.init),i.splitMode==f.MAXIMIZE&&d.push(N.maximize,F.MAXIMIZE),i.focused&&d.push(N.focused,F.FOCUSED),(v=E.options.className)!=null&&typeof v=="string"&&v.length!=0&&d.push(E.options.className),d}),R=X(()=>{const d=[],E=n.abstractWindow.options;return E.pinnable&&E.mask!==!0&&r.value!==!0&&d.push(i.pinned?k.PIN:k.UNPIN),E.resizeMode==it.RESIZE&&d.push(i.splitMode==f.MAXIMIZE?k.RESTORE:k.MAXIMIZE),E.closeable&&d.push(k.CLOSE),d}),A={getElement:M,getRenderState:function(){return s.value},useCssClass:function(){return N},useMenus:function(){return R}};function M(){return e.value}async function x(d){d==null||d.preventDefault(),n.abstractWindow.toggleMaximize()}async function ot(d){await re();const E=n.abstractWindow,v=E.options,B=d.el,_=B.getBoundingClientRect();if(s.value==K.INIT){let Z=Math.round(_.left),at=Math.round(_.top);ue(v.left)&&(Z=Math.floor((window.innerWidth-_.width)/2)),ue(v.top)&&(at=Math.floor((window.innerHeight-_.height)/2)),i.offsetWidth=_.width,i.offsetHeight=_.height,i.offsetLeft=Z,i.offsetTop=at,v.maximize&&x(),s.value=K.MOUNTED,JSON.parse(JSON.stringify(i)),re(()=>{const G=E.createEvent("show");E.dispatch(G),function(ct){const J=Array.from(ct.querySelectorAll("[autofocus]"));for(const yt of J)if(yt instanceof HTMLElement&&yt.autofocus)return yt.focus()}(B)})}E.focus()}function p(d){const E=n.abstractWindow;E.focus(),E.allowDrag&&!E.isMaximize&&E.dragstart(d)}function T(d){const E=M();if(E==null)return;const v=E.getBoundingClientRect();d.clientY-v.top>n.abstractWindow.allowDragArea||x(d)}function C(){const d=n.abstractWindow;return g(Ae,{body:d.body,abstractWindow:n.abstractWindow,key:d.wid},null)}return Ze(Le,n.abstractWindow),function(){const d=n.abstractWindow;var E,v;d.component=A,d.state=i,E=d.id,v=d,O.stack.set(E,v);const B=d.createEvent("created");d.dispatch(B)}(),function(){const d=n.abstractWindow,E=d.options;if(i.visible!==!0)return null;const v=g("div",{class:N.main,onDblclick:T},[typeof t.default=="function"?t.default(A):C()]),B={ref:e,id:d.wid,onVnodeMounted:ot,onPointerdown:p,class:w.value,style:c.value},_=(Z=E.resizeMode,at=d.resizestart,Z==it.DISABLED?null:xi.map(J=>gt("div",{["."+At.PROP]:J[1],className:J[0],onPointerdown:at})));var Z,at;let G=gt("div",B,[v,_]);if(E.mask===!0){const J={zIndex:a.value};G=g("div",{class:N.mask,style:J},[G])}return E.teleport===!1?G:g(Xe,{to:E.teleport},typeof(ct=G)=="function"||Object.prototype.toString.call(ct)==="[object Object]"&&!he(ct)?G:{default:()=>[G]});var ct}}}),Pi='<svg width="64" height="64" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M590.265 511.987l305.521-305.468c21.617-21.589 21.617-56.636.027-78.252-21.616-21.617-56.663-21.617-78.279 0L512.012 433.735 206.544 128.213c-21.617-21.617-56.635-21.617-78.252 0-21.616 21.589-21.616 56.635-.027 78.252L433.76 511.987 128.211 817.482c-21.617 21.59-21.617 56.635 0 78.251 10.808 10.81 24.967 16.213 39.125 16.213 14.159 0 28.318-5.403 39.126-16.213l305.522-305.468L817.48 895.788C828.289 906.597 842.447 912 856.606 912s28.317-5.403 39.125-16.212c21.618-21.59 21.618-56.636.028-78.252L590.265 511.987z"/></svg>',Ci='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5228" width="64" height="64"><path d="M97.74775349 97.74775349h828.50449302v828.50449302H97.74775349V97.74775349z m103.56306133 103.56306133v621.37837036h621.37837036V201.31081482H201.31081482z" fill="currentColor"></path></svg>',Si='<svg width="64" height="64" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M38.794 124.791v778.495h946.412V124.791H38.794zm896.678 728.033H89.292v-460.9h846.18v460.9z"/></svg>',Di='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="64" height="64"><path d="M738.793 681.382v-48.331l88.242-88.243a298.676 298.676 0 00156.712-83.482 38.836 38.836 0 000-54.923l-366.15-366.15a38.836 38.836 0 00-54.923 0 298.52 298.52 0 00-83.519 156.749l-88.169 88.169h-48.332a411.145 411.145 0 00-292.59 121.232c-15.16 15.159-15.16 39.764 0 54.923L278.906 690.17 86.642 882.436a38.836 38.836 0 1054.922 54.922l192.23-192.229 228.844 228.845a38.836 38.836 0 0054.922 0 411.042 411.042 0 00121.233-292.592zM134.02 435.44a333.473 333.473 0 01208.56-72.571l64.406.037a38.836 38.836 0 0027.461-11.351L544.292 241.71a38.68 38.68 0 0011.351-27.462 180.096 180.096 0 0136.798-89.01L898.8 431.593a180.925 180.925 0 01-89.12 36.835 38.836 38.836 0 00-27.462 11.35L672.373 589.626c-7.287 7.286-11.387 17.173-11.35 27.461l.036 64.406a333.318 333.318 0 01-72.608 208.596L134.021 435.44z"/></svg>',zi='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="64" height="64"><path d="M845.40952426 212.52063539H65.21904746v702.17142826h780.1904768V212.52063539z m-702.17142933 624.1523808V290.53968285h624.1523808v546.13333334H143.23809493z" fill="currentColor"></path><path d="M981.53650809 76.3936505H201.34603129v78.01904746h702.17142933v624.15238187h78.01904747V76.3936505z" fill="currentColor"></path></svg>';function Bi(n){const t=n.options.icon;return typeof t=="string"?g("i",{class:[N.logo,"icon",t]},null):he(t)?t:typeof t=="function"?t(n):g("i",{class:N.logo,innerHTML:Si},null)}const ye=q({name:"SimpleWindow",props:{abstractWindow:{type:Object,required:!0}},setup(n){const t=n.abstractWindow;function e(i,s){s.stopPropagation(),typeof i.handler=="function"&&i.handler(t)}return function(){return g(Rt,{abstractWindow:t},function(i){const s=i.useMenus(),r=t.options.menus??[];return g("div",{class:N.simpleWindow},[g("div",{class:[N.header,F.HEADER]},[Bi(t),g("div",{class:N.title},[t.options.title??"新窗口"]),g("div",{class:N.menus,onMousedown:Ai},[r.map(a=>function(c){return g("button",{type:"button",class:"x-window-text-menu",onClick:e.bind(null,c)},[c.label])}(a)),s.value.map(a=>Se(t,a))])]),g("div",{class:[N.body,F.BODY]},[g(Ae,{body:t.body,abstractWindow:n.abstractWindow,key:t.wid},null)])])})}}}),Me=Object.freeze({SIMPLE_WINDOW:ye.name,BLANK_WINDOW:Rt.name});function _e(n){return n==Rt.name?Rt:ye}function Hi(n){if(n.key=="Escape")return Ui({pressEsc:!0,forced:!1})}function ki(){O.isMounted=!1,O.topWindow=null,O.ids.value=[],O.stack.clear()}function Fi(){return Kt.getZIndex()}function Wi(){return Kt.getNextZIndex()}function Ui(n){if(O.stack.size==0||O.topWindow==null)return;const t=O.topWindow;(n==null?void 0:n.pressEsc)===!0&&t.options.closeOnPressEsc!==!0||O.topWindow.cancel(n==null?void 0:n.forced)}function Yi(n){const t=n.type===Jt.SIMPLE_WINDOW?Nt.create(n):Ce.create(n);return O.isMounted?(O.ids.value.push(t.id),O.stack.set(t.id,t),t):(function(e){const i=document.createDocumentFragment(),s=_e(e.type),r=gt(s,{abstractWindow:e});r.appContext=O.appContext,se(r,i),document.body.appendChild(i),e.on("beforeDestroy",()=>{se(null,i)})}(t),t)}function xe(n){if(O.topWindow=n,n!=null){for(const t of O.stack.values()){const e=t.state;e!=null&&(e.focused=t===n)}n.state!=null&&n.state.zIndex<Fi()&&(n.state.zIndex=Wi())}}function Gi(){xe(function(){if(O.stack.size==0)return;let n;for(const t of O.stack.values())t.state!=null&&t.state.visible===!0&&(n!=null?n.state.zIndex<t.state.zIndex&&(n=t):n=t);return n}())}function Ws(){return Array.from(O.stack.values()).some(n=>{var t;return((t=n.state)==null?void 0:t.visible)===!0})}class Vi{constructor(t,e){h(this,"moved",!1),h(this,"originalEvent"),h(this,"target"),h(this,"deltaX"),h(this,"deltaY"),h(this,"initialX"),h(this,"initialY"),h(this,"left",0),h(this,"top",0),h(this,"prevClientX"),h(this,"prevClientY");const i=t.getBoundingClientRect();this.originalEvent=e,this.target=t,this.deltaX=Math.round(i.left-e.clientX),this.deltaY=Math.round(i.top-e.clientY),this.initialX=e.clientX,this.initialY=e.clientY,this.prevClientX=e.clientX,this.prevClientY=e.clientY}preventDragEvent(t){return!this.moved&&!(Math.abs(t.clientX-this.initialX)>4)&&!(Math.abs(t.clientY-this.initialY)>4)}createEvent(t,e){return new Qt(t,e,this)}}class ji{constructor(t){h(this,"window"),h(this,"context"),h(this,"onDragging"),h(this,"onDragend"),this.window=t}static isConflict(t,e){const i=t.getBoundingClientRect(),s=e.getBoundingClientRect();return!(i.top>s.bottom||i.right<s.left||i.bottom<s.top||i.left>s.right)}static findElementsFromPoint(t,e,i,s){return typeof document.elementsFromPoint!="function"?[]:document.elementsFromPoint(t,e).filter(r=>!(s!=null&&!s.contains(r))&&typeof i=="string"&&r.matches(i))}dragstart(t){if(t.button!==0)return;const e=t.target;if(e instanceof Element&&e.closest("."+F.MENU))return;const i=this.window.getElement();if(i==null)return;const s=i.getBoundingClientRect();t.clientY-s.top>this.window.allowDragArea||(t.preventDefault(),t.stopPropagation(),this.context=new Vi(i,t),this.context.left=this.window.state.offsetLeft,this.context.top=this.window.state.offsetTop,this.onDragging=this.dragging.bind(this),this.onDragend=this.dragend.bind(this),window.addEventListener("pointermove",this.onDragging),window.addEventListener("pointerup",this.onDragend))}dragging(t){var e;if(this.context==null)return;const i=this.context;if(!i.moved){if(this.window.dispatch(this.context.createEvent("dragStart",this.window)).defaultPrevented)return this.cleanup();const a=(e=this.window.component)==null?void 0:e.useCssClass();a!=null&&a.dragging&&i.target.classList.add(a.dragging),i.target.setPointerCapture(t.pointerId),i.moved=!0}if(i.preventDragEvent(t))return;t.preventDefault(),t.stopPropagation(),i.originalEvent=t,i.left=t.clientX+i.deltaX,i.top=t.clientY+i.deltaY,i.prevClientX=t.clientX,i.prevClientY=t.clientY;const s=i.target;s.style.left=i.left+"px",s.style.top=i.top+"px";const r=this.context.createEvent("dragging",this.window);this.window.dispatch(r)}dragend(t){if(this.context==null||!this.context.moved)return this.cleanup();t.preventDefault(),t.stopPropagation();const e=this.context;e.originalEvent=t,e.target.releasePointerCapture(t.pointerId);const i=e.createEvent("dragEnd",this.window);this.window.dispatch(i),this.window.state.offsetTop=e.top,this.window.state.offsetLeft=e.left,this.cleanup()}cleanup(){var t,e;const i=(t=this.window.component)==null?void 0:t.useCssClass();i!=null&&i.dragging&&((e=this.context)==null||e.target.classList.remove(i.dragging)),this.onDragging&&window.removeEventListener("pointermove",this.onDragging),this.onDragend&&window.removeEventListener("pointerup",this.onDragend),this.onDragging=void 0,this.onDragend=void 0,this.context=void 0}}const Pe=class ft extends wt{constructor(t){super(),h(this,"CREATE_RESOLVE"),h(this,"CREATE_REJECT"),h(this,"id"),h(this,"type"),h(this,"options"),h(this,"body"),h(this,"state"),h(this,"created",!1),h(this,"destroyed",!1),h(this,"component"),h(this,"draggable"),h(this,"resizable"),h(this,"handles",{}),h(this,"dragstart"),h(this,"resizestart");const{body:e,type:i,...s}=t;this.type=i??Jt.SIMPLE_WINDOW,this.options=Vt(this.createOptions(s)),this.body=e,Reflect.defineProperty(this,"id",{enumerable:!0,configurable:!1,writable:!1,value:ft.seed++}),this.initDraggable(),this.initResizable(),this.initHooks()}static create(t){return t instanceof ft?t:new ft(t)}get wid(){return"window--"+this.id}get isReady(){return this.created===!0}get allowDrag(){const t=this.options.draggable;return t!==!1&&(typeof t!="number"||t>0)}get allowDragArea(){const t=this.options.draggable;return typeof t=="number"&&t>0?t:vt.draggaleHeight}get isMaximize(){var t;return((t=this.state)==null?void 0:t.splitMode)===f.MAXIMIZE}createOptions(t){return{...t,title:t.title??"未命名的窗口",icon:t.icon,className:t.className,width:t.width??"640px",minWidth:t.minWidth??360,maxWidth:t.maxWidth,height:t.height,minHeight:t.minHeight??32,maxHeight:t.maxHeight,top:t.top,left:t.left,zIndex:t.zIndex,maximize:t.maximize===!0,teleport:t.teleport??"body",draggable:t.draggable==null||t.draggable,resizeMode:t.resizeMode??it.RESIZE,closeable:t.closeable!==!1,mask:t.mask===!0,pinnable:t.pinnable!==!1,displayAfterCreate:t.displayAfterCreate!==!1,destroyAfterClose:t.destroyAfterClose!==!1,closeOnPressEsc:t.closeOnPressEsc!==!1}}createEvent(t,e){return new Qt(t,this,e)}initDraggable(){this.draggable=new ji(this),this.dragstart=this.draggable.dragstart.bind(this.draggable)}initResizable(){this.resizable=new At(this),this.resizestart=this.resizable.resizestart.bind(this.resizable)}initHooks(){this.once("created",()=>{this.created=!0,typeof this.CREATE_RESOLVE=="function"&&this.CREATE_RESOLVE(),delete this.CREATE_REJECT,delete this.CREATE_RESOLVE})}ready(){return this.created===!0?Promise.resolve():new Promise((t,e)=>{this.CREATE_RESOLVE=t,this.CREATE_REJECT=e})}show(){this.state!=null&&(this.dispatch(this.createEvent("beforeShow")).defaultPrevented||(this.state.visible=!0))}close(t=!1){if(this.state==null||this.options.closeable===!1&&t!==!0)return!1;const e=this.dispatch(this.createEvent("beforeClose"));return(t===!0||!e.defaultPrevented)&&(this.state.visible=!1,this.dispatch(this.createEvent("close")),this.state.focused&&setTimeout(Gi),this.destroyed||this.options.destroyAfterClose===!1||this.destroy(),!0)}cleanup(){super.cleanup(),this.dragstart=void 0,this.resizestart=void 0,this.component=void 0,this.state=void 0,this.handles={}}destroy(){var t;this.destroyed=!0,((t=this.state)==null?void 0:t.visible)===!0&&this.close(),this.dispatch(this.createEvent("beforeDestroy")),function(e){if(!O.stack.has(e)||(O.stack.delete(e),!O.isMounted))return;const i=O.ids.value.indexOf(e);i<0||O.ids.value.splice(i,1)}(this.id),setTimeout(()=>this.cleanup(),100)}getElement(){var t;return(t=this.component)==null?void 0:t.getElement()}useMenus(){return this.component.useMenus()}focus(){var t;this.state==null||this.state.focused||(t=this.id,xe(O.stack.get(t)))}startTransition(){const t=document.documentElement,e=function(i){i.target.matches("."+F.WINDOW)&&(t.classList.remove(F.TRANSITION),t.removeEventListener("transitionend",e))};t.classList.add(F.TRANSITION),t.addEventListener("transitionend",e)}requestMaximize(){const t=this.state;t!=null&&this.options.resizeMode===it.RESIZE&&(t.splitMode=f.MAXIMIZE,this.startTransition(),this.dispatch(this.createEvent("maximizeChange")))}exitMaximize(){const t=this.state;t!=null&&this.options.resizeMode===it.RESIZE&&(t.splitMode=f.NONE,this.startTransition(),this.dispatch(this.createEvent("maximizeChange")))}toggleMaximize(){const t=this.state;t!=null&&this.options.resizeMode===it.RESIZE&&(t.splitMode===f.MAXIMIZE?this.exitMaximize():this.requestMaximize())}pin(){const t=this.state;t!=null&&(t.pinned=!0)}unpin(){const t=this.state;t!=null&&(t.pinned=!1)}togglePin(){const t=this.state;t!=null&&(t.pinned?this.unpin():this.pin())}useHandle(t,e){this.handles[t]=e}async callHandle(t){const e=this.handles[t];if(typeof e=="function")return await e()}dispatchConfirm(){return this.callHandle("confirm").then(t=>this.confirm(t))}confirm(t){this.dispatch(this.createEvent("confirm",t)),this.close(!0)}dispatchCancel(){return this.callHandle("cancel").then(t=>this.cancel(!0,t))}cancel(t=!0,e){this.close(t)&&this.dispatch(this.createEvent("cancel",e))}promisify(){return new Promise((t,e)=>{this.once("confirm",i=>t(i.detail)),this.once("cancel",i=>e(i.detail))})}};h(Pe,"seed",1e3);let Ce=Pe;class Nt extends Ce{static create(t){return t instanceof Nt?t:new Nt(t)}constructor(t){super(t)}updateMenus(t){this.options.menus=t}}const vt={},O={appContext:null,isMounted:!1,stack:new Map,ids:jt([]),topWindow:null,previewState:Vt({mode:f.NONE,width:0,height:0})};let Kt=function(){const n=jt(1e3);return{getZIndex:function(){return n.value},setZIndex:function(t){n.value=t},getNextZIndex:function(){return n.value++,n.value}}}();function Us(){return Ge(Le)}function Se(n,t){var e;const i=n.state,s=((e=n.component)==null?void 0:e.useCssClass())??{};switch(t){case k.CLOSE:return g("button",{onClick:function(){n.cancel()},type:"button",innerHTML:Pi,class:s.closeMenu,title:"关闭"},null);case k.PIN:case k.UNPIN:const r=i.pinned?"取消固定":"固定",a=i.pinned?s.pinMenu:s.menu;return g("button",{onClick:function(){n.togglePin()},type:"button",innerHTML:Di,class:a,title:r},null);case k.MAXIMIZE:case k.RESTORE:const c=i.splitMode==f.MAXIMIZE?zi:Ci,w=i.splitMode==f.MAXIMIZE?"还原":"最大化";return g("button",{onClick:function(R){R.preventDefault(),n.toggleMaximize()},type:"button",innerHTML:c,class:s.menu,title:w},null)}return null}f.BOTTOM_LEFT,f.LEFT,f.BOTTOM_RIGHT,f.RIGHT,f.LEFT,f.TOP_LEFT,f.RIGHT,f.TOP_RIGHT,f.MAXIMIZE,f.TOP_LEFT,f.LEFT,f.TOP_RIGHT,f.RIGHT,f.LEFT,f.BOTTOM_LEFT,f.RIGHT,f.BOTTOM_RIGHT,f.NONE,f.TOP_RIGHT,f.TOP_LEFT,f.TOP_LEFT,f.TOP_RIGHT,f.BOTTOM_RIGHT,f.BOTTOM_LEFT,f.BOTTOM_LEFT,f.BOTTOM_RIGHT,f.LEFT,f.TOP_LEFT,f.TOP_RIGHT,f.TOP_RIGHT,f.TOP_LEFT,f.BOTTOM_LEFT,f.BOTTOM_RIGHT,f.BOTTOM_RIGHT,f.BOTTOM_LEFT,f.RIGHT;const le=q({name:"WindowManager",setup(){const n=O.ids;function t(e){e.key,e.ctrlKey}return O.isMounted=!0,window.addEventListener("keydown",t,!0),Ve(()=>{ki(),window.removeEventListener("keydown",t,!0)}),function(){const e=n.value.map(i=>{const s=function(a){return O.stack.get(a)}(i);if(s==null)return null;const r=_e(s.type);return gt(r,{abstractWindow:s,key:s.wid})});return g(je,null,[e])}}});function De(n){const t=function(i){if(i.length==1){const s=i[0];return s==null?null:typeof s=="object"?{...s}:null}if(i.length==2){const[s,r]=i;if(typeof s=="string"&&r!=null)return{title:s,body:r}}if(i.length==3){const[s,r,a]=i;if(typeof s=="string"&&r!=null)return{...a,title:s,body:r}}return null}(n)??{},e=typeof t.size=="string"?Reflect.get(vt.size,t.size):null;return e!=null&&(t.width=e.width,t.height=e.height,t.top=e.top,t.left=e.left),t}function Ys(...n){const t=De(n)??{};return t.type=Me.BLANK_WINDOW,ze(t)}function Gs(...n){const t=De(n)??{};return t.type=Me.SIMPLE_WINDOW,ze(t)}function ze(n){const t=Yi(n);return t.ready().then(()=>{n.displayAfterCreate!==!1&&t.show()}),t}const Vs=Object.freeze({renderMenu:Se});function qi(n,t){n.component(le.name,le),function(e){vt.draggaleHeight=(e==null?void 0:e.draggaleHeight)??32,vt.size=(e==null?void 0:e.size)??{},e!=null&&e.zIndex&&(Kt=e.zIndex)}(t),window.addEventListener("keydown",Hi,!0),function(e){O.appContext=e._context}(n)}const Zi="0.2.13",js={install:qi,version:Zi},Xi="modulepreload",$i=function(n){return"/"+n},de={},Ji=function(t,e,i){let s=Promise.resolve();if(e&&e.length>0){let a=function(R){return Promise.all(R.map(A=>Promise.resolve(A).then(M=>({status:"fulfilled",value:M}),M=>({status:"rejected",reason:M}))))};document.getElementsByTagName("link");const c=document.querySelector("meta[property=csp-nonce]"),w=(c==null?void 0:c.nonce)||(c==null?void 0:c.getAttribute("nonce"));s=a(e.map(R=>{if(R=$i(R),R in de)return;de[R]=!0;const A=R.endsWith(".css"),M=A?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${R}"]${M}`))return;const x=document.createElement("link");if(x.rel=A?"stylesheet":Xi,A||(x.as="script"),x.crossOrigin="",x.href=R,w&&x.setAttribute("nonce",w),document.head.appendChild(x),A)return new Promise((ot,p)=>{x.addEventListener("load",ot),x.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${R}`)))})}))}function r(a){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=a,window.dispatchEvent(c),!c.defaultPrevented)throw a}return s.then(a=>{for(const c of a||[])c.status==="rejected"&&r(c.reason);return t().catch(r)})},Be="local",Qi="quickprint-local-define",Ut=[{id:"case_01",name:"成绩单",loader:()=>Ji(()=>import("./case_01-Dsihu_si.js"),[])}];function Ki(){const n=localStorage.getItem(Qi),t=qt(n,null);if(t!=null)return{id:Be,name:"未命名的模板",define:t}}async function qs(n,t=!0){var a;const e=Ki();if(n===Be)return e;const i=Ut.find(c=>c.id==n);if(i==null)return;const s=await i.loader().catch(c=>(console.log(c),null));if(s==null||s.default==null)return;let r=s.default.define;return t&&((a=e==null?void 0:e.define)==null?void 0:a.id)==i.id&&(r=e.define),{id:i.id,name:i.name,define:r,data:s.default.data,rules:s.default.rules}}function Zs(){const n=Math.floor(Math.random()*Ut.length);return Ut[n]}const te="quickprint-mock-rules";function ee(){const n=localStorage.getItem(te);return n==null||n==""?{}:qt(n,{})}function Xs(n,t){if(t==null)return;const e=ee();e[t]=n,localStorage.setItem(te,JSON.stringify(e))}function $s(n){if(n!=null)return ee()[n]}function Js(n){return n.reduce((t,e)=>{if(St(e.name))return t;if(t[e.name]=e,e.children&&e.children.length>0){const i=e.name;e.children.forEach(s=>{St(s.name)||(t[`${i}.${s.name}`]=s)})}return t},{})}function Qs(n){const t=ee();delete t[n],localStorage.setItem(te,JSON.stringify(t))}export{wn as $,Ji as A,ys as B,is as C,W as D,Ke as E,ms as F,zt as G,$e as H,Bt as I,L as J,Ys as K,pn as L,as as M,us as N,ps as O,fs as P,it as Q,Mt as R,Ms as S,zs as T,Es as U,Ns as V,rs as W,mn as X,Gs as Y,On as Z,Xt as _,ls as a,Zt as a0,Bs as a1,Rn as a2,Tt as a3,ut as a4,qt as a5,Ls as a6,Ts as a7,me as a8,bs as a9,st as aA,o as aB,cs as aC,ss as aD,Et as aE,Js as aF,$s as aG,Xs as aH,Is as aa,Rs as ab,ws as ac,Nn as ad,ht as ae,sn as af,bt as ag,It as ah,Ws as ai,xs as aj,_s as ak,As as al,$ as am,Os as an,rn as ao,tn as ap,Dt as aq,os as ar,Ps as as,Cs as at,js as au,Hs as av,Ut as aw,qs as ax,Qs as ay,Zs as az,S as b,ds as c,_t as d,z as e,en as f,xt as g,Pt as h,hs as i,gn as j,Ds as k,Ss as l,St as m,ns as n,vs as o,nt as p,vn as q,Qe as r,pe as s,Fs as t,u,En as v,gs as w,Us as x,Vs as y,ks as z};
