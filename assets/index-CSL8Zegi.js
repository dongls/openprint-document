const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-BzOvwT-C.js","assets/vue-B00pXJJQ.js","assets/component-DFsXG4iY.js","assets/utils-BvV3c5eT.js","assets/utils-BWxIAY5I.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Yo=Object.defineProperty;var yl=n=>{throw TypeError(n)};var jo=(n,e,t)=>e in n?Yo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var W=(n,e,t)=>jo(n,typeof e!="symbol"?e+"":e,t),Hn=(n,e,t)=>e.has(n)||yl("Cannot "+t);var Ae=(n,e,t)=>(Hn(n,e,"read from private field"),t?t.call(n):e.get(n)),je=(n,e,t)=>e.has(n)?yl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),vt=(n,e,t,l)=>(Hn(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),Be=(n,e,t)=>(Hn(n,e,"access private method"),t);import{D as Ee,E as Ct,N as en,a as Et,b as J,c as Fe,P as sl,d as ln,e as _l,f as En,g as Tn,O as on,h as oe,i as cn,j as Sn,L as Pe,I as U,_ as H,k as Fl,s as In,l as Xo,m as ae,n as zl,p as Rn,C as $e,o as me,q as Zo,r as il,t as Ul,u as Xe,v as Zn,w as Ko,x as Jo,y as Qo,z as es,A as rl,U as Kn,B as al,F as Hl,V as Lt,G as wn,H as at,J as Gl,K as Wl,M as Yl,Q as _e,R as st,S as ts,T as ns,W as De,X as dt,Y as Me,Z as gt,$ as Je,a0 as ls,a1 as os,a2 as ss,a3 as we,a4 as kn,a5 as re,a6 as Se,a7 as Tt,a8 as mn,a9 as Mt,aa as ee,ab as St,ac as Qe,ad as ct,ae as is,af as ye,ag as Cn,ah as Nn,ai as Rt,aj as Zt,ak as gn,al as Dt,am as rs,an as as,ao as Nt,ap as Bt,aq as cs,ar as us,as as ds,at as fs,au as ps,av as Gt,aw as un,ax as El,ay as ms,az as Tl,aA as he,aB as Gn,aC as Wn,aD as gs,aE as hs,aF as hn,aG as vs,aH as bs,aI as ys,aJ as _s,aK as Sl,aL as Es,aM as Ts}from"./utils-BvV3c5eT.js";import{r as de,o as cl,d as z,c as N,a as T,n as m,b as f,e as p,f as lt,u as Ce,s as pe,g as xe,h as C,w as se,i as b,j as Q,k as Y,T as jl,l as X,m as Ot,p as rn,q as Xl,F as ne,t as ce,v as Z,x as Wt,y as Rl,z as Zl,A as Kl,B as an,C as ul,D as ke,E as Te,G as Oe,H as ie,I as Yt,J as Ss,K as Jl,L as Yn,M as et,N as ft,O as Rs,P as ws,Q as ks,R as Cs}from"./vue-B00pXJJQ.js";const Ql="@quickprint_drag_mode",eo="@quickprint_drop_data",On="@quickprint_operate",Ge="@quickprint_element",dl="@quickprint_element_type",to="@quickprint_resize_flag",It=160,xn=32,Kt=[50,75,100,125,150,200,300,400];var tn=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(tn||{}),At=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(At||{});const tt={SINGLE:0,MULTIPLE:1},qe=Object.freeze({INSERT:0,MOVE:1}),fl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),K=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),ue=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),no=[{label:"固定值",value:Ee.CONST},{label:"变量",value:Ee.VARIABLE},{label:"公式",value:Ee.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:Ee.CODE,detail:"使用Javascript代码生成数据"}],Ls=[{label:"显示",value:Ct.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:Ct.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:Ct.CONDITION,detail:"元素只在满足指定条件后显示"}],Is=[{label:"四舍五入",value:en.ROUND},{label:"向下舍入",value:en.FLOOR},{label:"向上舍入",value:en.CEIL},{label:"四舍六入",value:en.BANKER_ROUND}],Ns=[{label:"原始值",value:Et.NONE},{label:"固定位数",value:Et.FIXED},{label:"金额千位",value:Et.THOUSAND},{label:"金额万位",value:Et.TEN_THOUSAND},{label:"金额大写",value:Et.DAXIE},{label:"百分比",value:Et.PERCENTAGE}],Os=[{label:"显示",value:!0},{label:"隐藏",value:!1}],xs=[{label:"默认",value:void 0},{label:"文本",value:J.TEXT},{label:"数字",value:J.NUMBER},{label:"日期",value:J.DATE}],fe={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},lo=[{label:"年-月",value:Fe.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:Fe.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:Fe.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:Fe.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:Fe.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:Fe.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:Fe.TIME,detail:"示例：12:00:00"},{label:"时:分",value:Fe.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:Fe.YEAR,detail:"示例：2024"},{label:"月",value:Fe.MONTH,detail:"示例：12"},{label:"日",value:Fe.DAY,detail:"示例：01"}];lo.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const Ds=[{label:"元素值",value:sl.ELEMENT_VALUR}],Ms=[{label:"基于纸张",value:ln.PAPER},{label:"基于内容",value:ln.CONTENT}],oo=[{label:"纵向",value:_l.PORTRAIT},{label:"横向",value:_l.LANDSCAPE}],As=[{label:"当前位置",value:En.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:En.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Bs=[{label:"单次打印",value:Tn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:Tn.EACH,detail:"元素将每页打印一次"}],$s=[{label:"按内容调整高度",value:on.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:on.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:on.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Jn=[{label:"页码",value:cn.PAGE_NUMBER,type:oe.NUMBER},{label:"总页数",value:cn.PAGE_TOTAL,type:oe.NUMBER},{label:"行序号",value:cn.ROW_INDEX,type:oe.NUMBER},{label:"当前时间",value:cn.CURRENT_DATE,type:oe.DATE}],qs=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function so(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Ps(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function io(n){return n.isSelected?n.type===J.PARAGRAPH?52:n.type===J.TABLE?32:20:20}function Vs(){const n=de(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),cl(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class Fs{constructor(e,t,l){W(this,"originalEvent");W(this,"target");W(this,"ghost");W(this,"container");W(this,"paths",[]);W(this,"dropTarget");W(this,"top",0);W(this,"left",0);W(this,"deltaX");W(this,"deltaY");W(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var Ft,zt,pt,ro,ao,co;const kt=class kt extends Sn{constructor(t={}){var l,o,s;super();je(this,pt);W(this,"context",null);W(this,"selector");W(this,"scale");W(this,"onDragStart");je(this,Ft);je(this,zt);this.selector={container:((l=t.selector)==null?void 0:l.container)??K.PAGE,element:((o=t.selector)==null?void 0:o.element)??K.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??K.DROPPABLE},this.onDragStart=Be(this,pt,ro).bind(this),this.scale=t.scale,vt(this,Ft,Be(this,pt,ao).bind(this)),vt(this,zt,Be(this,pt,co).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",Ae(this,Ft)),window.removeEventListener("pointerup",Ae(this,zt)),this.context=null)}};Ft=new WeakMap,zt=new WeakMap,pt=new WeakSet,ro=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Pe.warn(kt.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=so(l,o);this.context=new Fs(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return Pe.warn(kt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Pe.warn(kt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return Pe.warn(kt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",Ae(this,Ft)),window.addEventListener("pointerup",Ae(this,zt))},ao=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(a=>!(a===l.ghost||a===l.target||l.ghost.contains(a))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(a=>a.matches("."+K.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},co=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},W(kt,"TAG_NAME","quickprint-draggable");let Qn=kt;const zs=["title"],Us=z({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(T(),N("span",{title:n.title,class:m(e.classes.help)},[f("span",null,[lt(e.$slots,"default")]),p(U,{icon:"icon-question-circle"})],10,zs))}}),Hs="_help_1l6l8_2",Gs={help:Hs},Ws={classes:Gs},Ys=H(Us,[["__cssModules",Ws]]),js=z({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=Ce("classes"),r=de(!1),i=pe(),a=pe(),u=xe({minWidth:0,top:0,left:0,visible:!1}),c=C(()=>({minWidth:l.width==null?u.minWidth+"px":l.width+"px",top:u.top+"px",left:u.left+"px",visibility:u.visible?"visible":"hidden",zIndex:Fl()}));async function g(){if(r.value)return v();l.disabled||(r.value=!0,o("show"),await In(),E())}function v(){x(),r.value=!1,o("close")}function _(I){if(!(I.target instanceof Node))return;const O=i.value;if(O&&O.contains(I.target))return I.preventDefault();const k=a.value;if(k&&k.contains(I.target))return I.preventDefault();v()}function y(){const I=i.value,O=a.value;if(O==null||I==null)return;const k=I.getBoundingClientRect(),$=O.getBoundingClientRect(),M=l.width==null?k.width:l.width;let q=k.bottom+1;q+$.height>window.innerHeight&&k.top>$.height&&(q=k.top-$.height-1);let L=k.left;L+$.width>window.innerWidth&&(L=window.innerWidth-$.width-2),u.minWidth=M,u.top=q,u.left=L,u.visible=!0}function d(I){const O=I.target;if(!(O instanceof HTMLElement))return;const k=i.value;k==null||!O.contains(k)||v()}function h(I){if(I.key!=="Escape")return;const O=a.value;if(O!=null){const k=O.style.zIndex;if(Number(k)<Xo())return}I.preventDefault(),v()}function E(){window.addEventListener("click",_,{capture:!0}),window.addEventListener("contextmenu",v,{capture:!0}),window.addEventListener("scroll",d,{capture:!0,passive:!0}),window.addEventListener("resize",y),window.addEventListener("keydown",h)}function x(){window.removeEventListener("click",_,!0),window.removeEventListener("contextmenu",v,!0),window.removeEventListener("scroll",d,!0),window.removeEventListener("resize",y),window.removeEventListener("keydown",h)}return e({close:v}),(I,O)=>(T(),N("div",{class:m(b(s).reference),onClick:se(g,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[lt(I.$slots,"default"),r.value?(T(),Q(jl,{key:0,to:"body"},[f("div",{class:m(b(s).popover),onVnodeMounted:y,onMousedown:O[0]||(O[0]=se(()=>{},["prevent"])),style:X(c.value),ref_key:"popoverRef",ref:a},[lt(I.$slots,"popover")],38)])):Y("",!0)],2))}}),Xs="_reference_1arli_2",Zs="_popover_1arli_7",Ks={reference:Xs,popover:Zs},Js={classes:Ks},uo=H(js,[["__cssModules",Js]]),Qs=["title","onKeydown"],ei=["onMouseover","onClick"],ti=z({__name:"Select",props:Ot({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:Ot(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=Ce("classes"),s=pe(),r=pe(),i=rn(n,"modelValue"),a=de(),u=de(!1),c=xe({width:0,top:0,left:0,visible:!1,scrollable:!1}),g=C(()=>l.teleport==="none"),v=C(()=>l.teleport=="none"?"body":l.teleport),_=C(()=>{const F={label:"",options:[]},G=[F];for(const j of l.options){if(Array.isArray(j.options)){G.push({label:j.label,options:j.options});continue}F.options.push(j)}return G}),y=C(()=>_.value.reduce((F,G)=>F.concat(G.options),[])),d=C(()=>{if(l.multiple!==!0){const G=zn();return G?G.label:l.button?l.title:ae(l.modelValue)?l.placeholder:l.modelValue}const F=Un();return F.length>0?F.map(G=>G.label).join(","):l.button?l.title:l.placeholder}),h=C(()=>l.clearable!==!0?!1:l.modelValue!=null),E=C(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!h.value,[o.button]:l.button,[o.showClearIcon]:h.value,[o.text]:l.size==="text"})),x=C(()=>({width:l.width})),I=C(()=>c.visible?{width:l.popoverWidth==null?c.width+"px":l.popoverWidth+"px",top:c.top+"px",left:c.left+"px",visibility:"visible",zIndex:Fl()}:{minWidth:l.popoverWidth==null?c.width+"px":l.popoverWidth+"px",visibility:"hidden"}),O=C(()=>({[o.content]:!0,[o.placeholder]:zl(l.modelValue)}));async function k(){if(l.disabled)return;const F=y.value;if(F.length===0)return;if(u.value)return $();const G=s.value;G!=null&&(c.width=G.getBoundingClientRect().width,c.visible=!1,a.value=F.find(j=>j.value===l.modelValue),u.value=!0,await In(),Go())}function $(){Wo(),u.value=!1}function M(F){D(),ht()}function q(F){F.disabled!==!0&&(a.value=F)}function L(F){if(l.disabled==!0||F.disabled===!0)return;if(l.multiple!==!0){i.value=F.value,t("select",F),$();return}const G=Array.isArray(i.value)?i.value:[],j=G.findIndex(ge=>ge===F.value);j>=0?G.splice(j,1):G.push(F.value),i.value=G,t("select",G)}function A(F){if(!(F.target instanceof Node))return;const G=s.value;if(G&&G.contains(F.target))return F.preventDefault();const j=r.value;if(j&&j.contains(F.target))return F.preventDefault();$()}async function D(){const F=s.value,G=r.value;if(G==null||F==null)return;await Wt();const j=F.getBoundingClientRect(),ge=G.getBoundingClientRect();let ve=j.bottom+1;ve+ge.height>window.innerHeight&&j.top>ge.height&&(ve=j.top-ge.height-1);let xt=j.left;xt+ge.width>window.innerWidth&&(xt=window.innerWidth-ge.width-2),c.width=ge.width,c.top=ve,c.left=xt,c.visible=!0;const Xt=G.querySelector("."+o.list);c.scrollable=Xt?Xt.scrollHeight>Xt.clientHeight:!1}function B(F){const G=F.target;if(!(G instanceof HTMLElement))return;const j=s.value;j==null||!G.contains(j)||$()}function S(){const F=y.value,G=Rl(a.value);if(G==null){a.value=Le(0),ht();return}const j=F.indexOf(G);if(j==0)return V();const ge=Le(j-1);ge!=null&&(a.value=ge,ht())}function R(){const F=y.value,G=Rl(a.value);if(G==null){a.value=te(0),ht();return}const j=F.indexOf(G);if(j>=F.length-1){w();return}const ge=Le(j+1);ge!=null&&(a.value=ge,ht())}function w(){a.value=te(0),ht()}function V(){const F=y.value;a.value=Le(F.length-1),ht()}function P(){i.value=void 0,$()}function te(F){const j=y.value[F];return j==null?null:j.disabled===!0?te(F+1):j}function Le(F){const j=y.value[F];return j==null?null:j.disabled===!0?Le(F-1):j}function Ie(F){switch(F.key){case"Enter":F.preventDefault(),a.value&&L(a.value);return;case"Escape":F.preventDefault(),$();return;case"ArrowUp":F.preventDefault(),S();return;case"ArrowDown":F.preventDefault(),R();return;case"Home":F.preventDefault(),w();return;case"End":F.preventDefault(),V();return}}function Ye(F){if(l.disabled)return;const G=s.value;G!=null&&document.activeElement===G&&(u.value||(F.stopPropagation(),k()))}function Ho(F){if(l.multiple!==!0)return l.modelValue===F.value;const G=l.modelValue;return Array.isArray(G)?G.includes(F.value):!1}async function ht(){if(a.value==null)return;await Wt();const F=r.value;if(F==null)return;const G=F.querySelector("."+o.hover);G&&G.scrollIntoView({block:"nearest"})}function zn(){const F=y.value,G=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return F.find(j=>j.value===G)}function Un(){const F=y.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(j=>j).map(j=>{const ge=F.find(ve=>ve.value===j);return ge||{value:j,label:j}})}function Go(){window.addEventListener("mousedown",A,{capture:!0}),window.addEventListener("pointerdown",A,{capture:!0}),window.addEventListener("contextmenu",$,{capture:!0}),window.addEventListener("scroll",B,{capture:!0,passive:!0}),window.addEventListener("resize",D),window.addEventListener("keydown",Ie)}function Wo(){window.removeEventListener("mousedown",A,!0),window.removeEventListener("pointerdown",A,!0),window.removeEventListener("contextmenu",$,!0),window.removeEventListener("scroll",B,!0),window.removeEventListener("resize",D),window.removeEventListener("keydown",Ie)}return(F,G)=>{var j;return T(),N("div",{class:m(E.value),title:n.title,style:X(x.value),onClick:se(k,["stop"]),onKeydown:Xl(se(Ye,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[F.$slots.selected?lt(F.$slots,"selected",{key:0,option:zn(),options:Un()}):lt(F.$slots,"option",{key:1,option:zn(),options:Un()},()=>[f("div",{class:m(O.value)},[f("span",null,Z(d.value),1),h.value?(T(),Q(U,{key:0,icon:"icon-close",onClick:se(P,["stop"]),size:"12px",class:m(b(o).clearIcon)},null,8,["class"])):Y("",!0)],2)]),u.value?(T(),Q(jl,{key:2,to:v.value,disabled:g.value},[f("div",{class:m(b(o).popover),onClick:G[0]||(G[0]=se(()=>{},["stop"])),onVnodeMounted:M,onMousedown:G[1]||(G[1]=se(()=>{},["prevent"])),style:X(I.value),ref_key:"popoverRef",ref:r},[f("div",{class:m(b(o).list)},[(T(!0),N(ne,null,ce(_.value,ge=>(T(),N(ne,null,[ge.label?(T(),N("div",{key:0,class:m(b(o).groupLabel)},Z(ge.label),3)):Y("",!0),(T(!0),N(ne,null,ce(ge.options,ve=>{var xt;return T(),N("div",{key:ve.value,class:m({[b(o).option]:!0,[b(o).disabled]:ve.disabled===!0,[b(o).selected]:Ho(ve),[b(o).hover]:((xt=a.value)==null?void 0:xt.value)==ve.value}),style:X(ve.style),onMouseover:Xt=>q(ve),onClick:Xt=>L(ve)},[lt(F.$slots,"option",{option:ve},()=>[f("div",{class:m(b(o).label)},[ve.icon?(T(),Q(U,{key:0,icon:ve.icon,class:m(b(o).icon)},null,8,["icon","class"])):Y("",!0),f("span",null,Z(ve.label),1)],2),ve.short?(T(),N("div",{key:0,class:m(b(o).short)},Z(ve.short),3)):Y("",!0)])],46,ei)}),128))],64))),256))],2),(j=a.value)!=null&&j.detail&&c.visible?(T(),N("div",{key:0,class:m(b(o).detail)},Z(a.value.detail),3)):Y("",!0)],38)],8,["to","disabled"])):Y("",!0)],46,Qs)}}}),ni="_button_g23yb_2",li="_select_g23yb_7",oi="_appearance_g23yb_16",si="_content_g23yb_31",ii="_placeholder_g23yb_37",ri="_popover_g23yb_41",ai="_list_g23yb_51",ci="_option_g23yb_80",ui="_label_g23yb_95",di="_icon_g23yb_102",fi="_hover_g23yb_106",pi="_detail_g23yb_117",mi="_short_g23yb_127",gi="_selected_g23yb_133",hi="_disabled_g23yb_137",vi="_showClearIcon_g23yb_142",bi="_clearIcon_g23yb_146",yi="_text_g23yb_159",_i="_mini_g23yb_171",Ei="_groupLabel_g23yb_183",Ti={button:ni,select:li,appearance:oi,content:si,placeholder:ii,popover:ri,list:ai,option:ci,label:ui,icon:di,hover:fi,detail:pi,short:mi,selected:gi,disabled:hi,showClearIcon:vi,clearIcon:bi,text:yi,mini:_i,groupLabel:Ei},Si={classes:Ti},le=H(ti,[["__cssModules",Si]]),Ri="_tree_1p28f_1",wi="_node_1p28f_5",ki="_content_1p28f_11",Ci="_space_1p28f_27",Li="_expand_1p28f_28",Ii="_active_1p28f_47",Ni="_children_1p28f_55",it={tree:Ri,node:wi,content:ki,space:Ci,expand:Li,active:Ii,children:Ni},fo=Symbol(),po=z({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Zl(fo),l=C(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=C({get(){const d=t==null?void 0:t.state[n.node.value];return d==null?!1:d.expand},set(d){const h=t==null?void 0:t.state[n.node.value];h!=null&&(h.expand=d)}});function s(d){d.preventDefault(),o.value=!o.value}function r(){if(!l.value)return p("div",{class:it.space},null);const d={[it.expand]:!0,[it.active]:o.value};return p("div",{onMousedown:y,onClick:s,class:d},[p(U,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function a(){return p("div",{class:it.content,onClick:c,onMouseenter:v},[i()])}function u(){if(!l.value||!o.value)return;const d=n.node.children.map(h=>p(po,{node:h,onNodeClick:g,onNodeHover:_},null));return p("div",{class:it.children},[d])}function c(){e("nodeClick",n.node)}function g(d){e("nodeClick",d)}function v(){e("nodeHover",n.node)}function _(d){e("nodeHover",d)}function y(d){d.preventDefault()}return function(){return p("div",{class:it.subTree},[p("div",{class:it.node},[r(),a()]),u()])}}}),Oi=z({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(a){t("nodeClick",a)}function s(a){t("nodeHover",a)}function r(){const a=xe({}),u=function(c,g){for(const v of c)g[v.value]={expand:v.expand!==!1},v.children&&u(v.children,g)};return u(n.data,a),a}function i(a){return typeof e.default=="function"?e.default(a):null}return Kl(fo,{state:l,content:i}),function(){const a=n.data.map(u=>p(po,{node:u,onNodeClick:o,onNodeHover:s},null));return p("div",{class:it.tree},[a])}}});function dn(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const jn={A:10,B:11,C:12,D:13,E:14,F:15},wl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function xi(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function Di(n){return typeof n=="string"&&n.includes("%")}function Pt(n,e){xi(n)&&(n="100%");const t=Di(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function bt(n){return n.length===2?(jn[n[0].toUpperCase()]||+n[0])*16+(jn[n[1].toUpperCase()]||+n[1]):jn[n[1].toUpperCase()]||+n[1]}function kl(n,e,t){n=Pt(n,255),e=Pt(e,255),t=Pt(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,a=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:a*100,v:r*100}}const Mi=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},Ai=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function Xn(n,e,t){n=Pt(n,360)*6,e=Pt(e,100),t=Pt(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),a=l%6,u=[t,r,s,s,i,t][a],c=[i,t,t,r,s,s][a],g=[s,s,i,t,t,r][a];return{r:Math.round(u*255),g:Math.round(c*255),b:Math.round(g*255)}}function vn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${wl[e]||e}${wl[t]||t}`}function Bi({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${vn(n)}${vn(e)}${vn(t)}`}class Dn{constructor(e){W(this,"h",0);W(this,"s",100);W(this,"v",100);W(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=dn(e)}setSaturation(e){this.s=dn(e)}setValue(e){this.v=dn(e)}setAlpha(e){this.a=dn(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=bt(t[0]+t[0]),o=bt(t[1]+t[1]),s=bt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=bt(t.slice(0,2)),o=bt(t.slice(2,4)),s=bt(t.slice(4,6))),t.length===8&&(r=bt(t.slice(6))/255*100);const{h:i,s:a,v:u}=kl(l,o,s);return{h:i,s:a,v:u,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=kl(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Mi(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=Ai(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Bi(Xn(this.h,this.s,this.v))}${vn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=Xn(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return Xn(this.h,this.s,this.v)}}function mo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().width/2;let c=r.clientX-i.left-e.offsetX;return c<-u&&(c=-u),c>i.width-u&&(c=i.width-u),c}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,a=r.currentTarget;origin==null||i==null||(e.container=a,e.target=i===a?i.firstElementChild:i,e.offsetX=i===a?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function $i(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const a=e.container.getBoundingClientRect(),c=e.target.getBoundingClientRect().width/2;let g=i.clientX-a.left-e.offsetX;return g<-c&&(g=-c),g>a.width-c&&(g=a.width-c),g}function l(i){const a=e.container.getBoundingClientRect(),c=e.target.getBoundingClientRect().height/2;let g=i.clientY-a.top-e.offsetY;return g<-c&&(g=-c),g>a.height-c&&(g=a.height-c),g}function o(i){i.stopPropagation(),i.preventDefault();const a=i.target,u=i.currentTarget;origin==null||a==null||(e.container=u,e.target=a===u?a.firstElementChild:a,e.offsetX=a===u?e.target.offsetWidth/2:i.clientX-a.getBoundingClientRect().left,e.offsetY=a===u?e.target.offsetHeight/2:i.clientY-a.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const a=t(i),u=l(i);e.target.style.left=a+"px",e.target.style.top=u+"px",n("move",{left:a,top:u})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const a=t(i),u=l(i);n("end",{top:u,left:a})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const qi=z({__name:"SvPanel",props:{modelValue:{type:Dn,required:!0}},setup(n){const e=n,t=pe(),l=pe(),o=xe(i()),s=C(()=>({left:o.left+"px",top:o.top+"px"})),r=$i((a,u)=>{a=="end"&&(o.top=u.top,o.left=u.left);const c=t.value,g=l.value,v=(u.left+g.offsetWidth/2)/c.offsetWidth*100,_=100-(u.top+g.offsetHeight)/c.offsetHeight*100;e.modelValue.setSaturation(v),e.modelValue.setValue(_)});function i(){const a=t.value,u=l.value;if(a==null||u==null)return{top:-6,left:-6};const c=e.modelValue.s,v=(100-e.modelValue.v)/100*a.offsetHeight,_=c/100*a.offsetWidth;return{top:v-u.offsetHeight/2,left:_-u.offsetWidth/2}}return an(()=>{const a=i();o.top=a.top,o.left=a.left}),(a,u)=>(T(),N("div",{class:m(a.classes.svPanel),onPointerdown:u[0]||(u[0]=(...c)=>b(r)&&b(r)(...c)),ref_key:"svPanelRef",ref:t},[f("div",{class:m(a.classes.thumb),style:X(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Pi="_svPanel_1sv6o_2",Vi="_thumb_1sv6o_10",Fi={svPanel:Pi,thumb:Vi},zi={classes:Fi},Ui=H(qi,[["__cssModules",zi]]),Hi=z({__name:"HueSlider",props:{modelValue:{type:Dn,required:!0}},setup(n){const e=n,t=de(-6),l=pe(),o=pe(),s=mo((i,a)=>{i=="end"&&(t.value=a);const u=l.value,c=o.value,g=Math.round((a+c.offsetWidth/2)/u.offsetWidth*360);e.modelValue.setHue(g)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const u=e.modelValue.h;return Math.round(u/360*i.offsetWidth)-a.offsetWidth/2}return an(()=>{t.value=r()}),(i,a)=>(T(),N("div",{class:m(i.classes.hue),onPointerdown:a[0]||(a[0]=(...u)=>b(s)&&b(s)(...u)),ref_key:"hueRef",ref:l},[f("div",{class:m(i.classes.thumb),style:X({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Gi="_hue_1ozoc_2",Wi="_thumb_1ozoc_10",Yi={hue:Gi,thumb:Wi},ji={classes:Yi},Xi=H(Hi,[["__cssModules",ji]]),Zi=z({__name:"AlphaSlider",props:{modelValue:{type:Dn,required:!0}},setup(n){const e=n,t=de(-6),l=pe(),o=pe(),s=mo((i,a)=>{i=="end"&&(t.value=a);const u=l.value,c=o.value,g=Math.round((a+c.offsetWidth/2)/u.offsetWidth*100);e.modelValue.setAlpha(g)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const u=e.modelValue.a;return Math.round(u/100*i.offsetWidth)-a.offsetWidth/2}return an(()=>{t.value=r()}),(i,a)=>(T(),N("div",{class:m(i.classes.alpha),onPointerdown:a[0]||(a[0]=(...u)=>b(s)&&b(s)(...u)),ref_key:"alphaRef",ref:l},[f("div",{class:m(i.classes.thumb),style:X({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Ki="_alpha_1x8jd_2",Ji="_thumb_1x8jd_26",Qi={alpha:Ki,thumb:Ji},er={classes:Qi},tr=H(Zi,[["__cssModules",er]]),nr=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function lr(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function or(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const Cl={isSupport:lr,open:or},sr=["title","onClick"],ir=["title","onClick"],Ll="quickprint-recent-use-colors",rr=z({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=de(new Dn(l.modelValue)),r=pe(),i=pe(),a=de(x()),u=Cl.isSupport(),c=de("hex"),g=C(()=>{const k=l.modelValue;return k?{backgroundColor:k}:null}),v=C(()=>{const k=s.value,{r:$,g:M,b:q}=k.rgb();return{"--hue-channel-color":`hsl(${k.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${$}, ${M}, ${q}, 0)`,"--alpha-channel-color-b":`rgba(${$}, ${M}, ${q}, 1)`}}),_=C({get(){return s.value.toString(c.value)},set(k){s.value.setColor(k)}});function y(){var k;(k=r.value)==null||k.close()}function d(k){k!=null&&(t("update:modelValue",k),t("select",k),I(k),y())}function h(){t("update:modelValue",void 0),t("select",void 0),y()}function E(){Cl.open().then(k=>d(k))}function x(){const k=localStorage.getItem(Ll);if(k==null||k=="")return[];const $=Rn(k);return $==null?[]:Array.isArray($)?$:[]}function I(k){const $=a.value,M=$.indexOf(k);M>=0&&$.splice(M,1),$.length>10&&$.pop(),$.unshift(k),localStorage.setItem(Ll,JSON.stringify($))}function O(){t("update:modelValue",s.value.toString(c.value)),t("select",s.value.toString(c.value)),y()}return ul(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(k,$)=>(T(),Q(uo,{class:m(k.classes.colorPicker),onMousedown:$[7]||($[7]=se(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:ke(()=>[f("div",{class:m(k.classes.colorPickerPanel)},[f("div",{class:m(k.classes.presetPanel)},[f("div",{class:m(k.classes.presetTools)},[f("button",{type:"button",class:m(k.classes.clearBtn),onClick:h},[f("span",{class:m(k.classes.none)},null,2),$[8]||($[8]=f("span",null,"无颜色",-1))],2),b(u)?(T(),N("button",{key:0,type:"button",class:m(k.classes.indicator),onClick:E},[p(U,{icon:"icon-eye-dropper"}),$[9]||($[9]=f("span",null,"拾色器",-1))],2)):Y("",!0)],2),f("div",{class:m(k.classes.colourAtla)},[(T(!0),N(ne,null,ce(b(nr),M=>(T(),N("div",{style:X({backgroundColor:M}),title:M,class:m(k.classes.color),onClick:q=>d(M)},null,14,sr))),256))],2),f("div",{class:m(k.classes.recentColors)},"最近使用",2),f("div",{class:m(k.classes.colourAtla)},[(T(),N(ne,null,ce(10,M=>f("div",{key:M,title:a.value[M-1],style:X({backgroundColor:a.value[M-1]}),class:m(k.classes.color),onClick:q=>d(a.value[M-1])},null,14,ir)),64))],2)],2),f("div",{class:m(k.pacls.panel),style:X(v.value)},[p(Ui,{class:m(k.pacls.sv),modelValue:s.value,"onUpdate:modelValue":$[1]||($[1]=M=>s.value=M)},null,8,["class","modelValue"]),f("div",{class:m(k.pacls.sliders)},[p(Xi,{class:m(k.pacls.hua),modelValue:s.value,"onUpdate:modelValue":$[2]||($[2]=M=>s.value=M)},null,8,["class","modelValue"]),p(tr,{modelValue:s.value,"onUpdate:modelValue":$[3]||($[3]=M=>s.value=M)},null,8,["modelValue"]),f("div",{class:m(k.pacls.preview)},[f("div",{class:m(k.pacls.previewColor),style:X({backgroundColor:s.value.toRGB()})},null,6)],2)],2),f("div",{class:m(k.pacls.tools)},[p(le,{options:o,teleport:"none",modelValue:c.value,"onUpdate:modelValue":$[4]||($[4]=M=>c.value=M),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Te(f("input",{type:"text","onUpdate:modelValue":$[5]||($[5]=M=>_.value=M),onMousedown:$[6]||($[6]=se(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Oe,_.value]]),f("button",{type:"button",class:m(k.pacls.confirm),onClick:O},"确定",2)],2)],6)],2)]),default:ke(()=>[f("div",{class:m({[k.classes.colorPickerInput]:!0,[k.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[lt(k.$slots,"default",{},()=>[f("span",{class:m(k.classes.colorBlock),style:X(g.value)},null,6)]),n.showText?(T(),N("div",{key:0,class:m(k.classes.colorValue),onClick:$[0]||($[0]=se(()=>{},["stop"]))},Z(n.modelValue),3)):Y("",!0)],2)]),_:3},8,["class","disabled"]))}}),ar="_colorPicker_1egpm_2",cr="_disabled_1egpm_6",ur="_colorPickerInput_1egpm_10",dr="_colorBlock_1egpm_17",fr="_colorValue_1egpm_26",pr="_colorPickerPanel_1egpm_31",mr="_presetPanel_1egpm_45",gr="_colourAtla_1egpm_49",hr="_color_1egpm_2",vr="_presetTools_1egpm_76",br="_clearBtn_1egpm_82",yr="_indicator_1egpm_83",_r="_none_1egpm_101",Er="_recentColors_1egpm_132",Tr={colorPicker:ar,disabled:cr,colorPickerInput:ur,colorBlock:dr,colorValue:fr,colorPickerPanel:pr,presetPanel:mr,colourAtla:gr,color:hr,presetTools:vr,clearBtn:br,indicator:yr,none:_r,recentColors:Er},Sr="_panel_911zv_2",Rr="_sv_911zv_7",wr="_hua_911zv_11",kr="_sliders_911zv_15",Cr="_tools_911zv_20",Lr="_confirm_911zv_37 quickprint-text-btn",Ir="_preview_911zv_44",Nr="_previewColor_911zv_59",Or={panel:Sr,sv:Rr,hua:wr,sliders:kr,tools:Cr,confirm:Lr,preview:Ir,previewColor:Nr},xr={classes:Tr,pacls:Or},Vt=H(rr,[["__cssModules",xr]]),Dr=z({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=C({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=C(()=>{const i=l.modelValue;return zl(i)||i===$e.INHERIT});function r(i){t("select",i)}return(i,a)=>(T(),Q(Vt,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=u=>o.value=u),disabled:n.disabled,onSelect:r},{default:ke(()=>[f("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[f("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:X({backgroundColor:o.value})},null,6),f("div",{class:m(i.classes.colorValue)},Z(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),Mr="_indicator_14ypk_2",Ar="_disabled_14ypk_8",Br="_colorBlock_14ypk_27",$r="_colorValue_14ypk_38",qr="_colorNone_14ypk_45",Pr={indicator:Mr,disabled:Ar,colorBlock:Br,colorValue:$r,colorNone:qr},Vr={classes:Pr},bn=H(Dr,[["__cssModules",Vr]]);function Fr(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function zr(n,e=0){let t=0,l=null;return function(...o){const s=Date.now();if(s-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,o),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,o),t=s}}function go(n,e={}){const t={},l=n.style??{},o=il(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=Ul(l);return s&&Xe(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),Il("border",e)&&Xe(t,Zn(n)),Xe(t,Ko(n)),Xe(t,Jo(n)),Xe(t,Qo(n)),Il("padding",e)&&Xe(t,es(n)),t}function ho(n,e={}){const t=[];let l=n;for(;me.isDefineElement(l);)t.unshift(go(l,e)),l=l.parent;return Zo({},...t)}function Il(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const wt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(wt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(wt.SPACE).filter(o=>rl(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(wt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(wt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(wt.SPACE))}};function nt(n){if(ae(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em|%)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=al(t)?t:null,o=ae(e[2])?null:e[2];return{num:l,unit:o}}function be(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=nt(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return Kn.pt_to_px(e.num);case"mm":return Kn.mm_to_px(e.num);default:return null}}function yt(n){switch(n){case"top":case 0:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case"right":case 1:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case"bottom":case 2:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case"left":case 3:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function pl(n,e){const t=n.ds;if(t!=null)return t.type===Ee.FORMULA?{type:t.type,content:ml(t.value,n.doc)}:t.type===Ee.VARIABLE?{type:t.type,content:ot(t.value,e)}:{type:t.type,content:t.value}}function ot(n,e){var v,_,y;if(ae(n))return n;const t=Hl(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===Lt.BUILTIN)return((v=Jn.find(d=>d.value===s))==null?void 0:v.label)??s;if(t.varType===Lt.SPECIAL)return((_=Ds.find(d=>d.value===s))==null?void 0:_.label)??s;if(e==null)return l;const i=(e.fields??[]).find(d=>d.name===s);if(i==null)return l;const a=o[1],u=ae(i.title)?i.name:i.title;if(a==null)return u;const c=(y=i.children)==null?void 0:y.find(d=>d.name===a);if(c==null)return`${u}.${a}`;const g=ae(c.title)?c.name:c.title;return`${u}.${g}`}function ml(n,e){return ae(n)?void 0:wn.tokenize(n).map(o=>o.type===at.VARIABLE?`[${ot(o.value,e==null?void 0:e.ds)}]`:o.type===at.REFERENCE?`[${vo(o.value,e)}]`:o.type===at.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===at.VARIABLE?`[${ot(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):wn.formatTokenValue(o)).join("")}function vo(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===Ee.VARIABLE&&t.ds.value?ot(t.ds.value,e.ds):"="+n}function Ur(n){switch(Hl(n).dataType){case oe.OBJECT:return"对象";case oe.ARRAY:return"数组";case oe.STRING:return"文本";case oe.NUMBER:return"数字";case oe.DATE:return"日期";case oe.BOOLEAN:return"布尔";default:return"未知类型"}}function Hr(n){var e;return((e=no.find(t=>t.value===n))==null?void 0:e.label)??n}const bo=Gl(()=>Wl(()=>import("./component-BzOvwT-C.js"),__vite__mapDeps([0,1]))),Gr=["onClick","onMouseenter"],Wr=z({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=de(Jn[0].value),o=C(()=>`builtin_${Yl(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,a)=>(T(),N("div",{class:m(i.classes.builtin)},[f("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(T(!0),N(ne,null,ce(b(Jn),u=>(T(),N("div",{class:m({[i.classes.param]:!0,[i.classes.active]:u.value===l.value}),onClick:c=>s(u),onMouseenter:c=>r(u)},[f("strong",null,Z(u.label),1),f("span",null,Z(u.value),1)],42,Gr))),256))],2),f("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[p(b(bo),{name:o.value},null,8,["name"])],2)],2))}}),Yr="_builtin_m1n0z_2",jr="_panel_m1n0z_11",Xr="_desc_m1n0z_17",Zr="_param_m1n0z_24",Kr="_active_m1n0z_34",Jr={builtin:Yr,panel:jr,desc:Xr,param:Zr,active:Kr},Qr={classes:Jr},ea=H(Wr,[["__cssModules",Qr]]),Nl=[{label:"文本",value:oe.STRING},{label:"数字",value:oe.NUMBER},{label:"日期",value:oe.DATE},{label:"对象",value:oe.OBJECT},{label:"数组",value:oe.ARRAY}],ta=z({emit:["select"],props:{doc:{type:_e,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Ce("classes"),o=st(),s=a(),r=i();function i(){const h=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(E,x,I){var O;if(n.readonly){const k=E[x.name],$=((O=Nl.find(M=>M.value===k))==null?void 0:O.label)??k;return p("div",{class:I.classes.cell},[$])}return p("div",{class:I.classes.cell},[p(le,{options:Nl,modelValue:E.type,"onUpdate:modelValue":_.bind(null,E),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(E,x,I){return n.readonly?p("div",{class:I.classes.cell},[E[x.name]]):p("div",{class:I.classes.cell},[Te(p("input",{"onUpdate:modelValue":O=>E.name=O,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Oe,E.name]])])}},{name:"title",title:"标题",width:180,render(E,x,I){return n.readonly?p("div",{class:I.classes.cell},[E[x.name]]):p("div",{class:I.classes.cell},[Te(p("input",{"onUpdate:modelValue":O=>E.title=O,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Oe,E.title]])])}}];return n.readonly!==!0&&h.push({name:"operate",title:"操作",width:200,render(E,x,I){const O=[p("button",{type:"button",class:"quickprint-text-btn",onClick:c.bind(null,E,I.parent)},[p(U,{icon:"icon-subnode"},null),p("span",null,[ie("插入行")])])];return(E.type===oe.ARRAY||E.type===oe.OBJECT)&&O.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:v.bind(null,E)},[p(U,{icon:"icon-sisternode"},null),p("span",null,[ie("插入子级")])])),O.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:g.bind(null,E,I.parent)},[p(U,{icon:"icon-delete"},null),p("span",null,[ie("删除")])])),O}}),h}function a(){const h=ts(n.doc.ds.fields??[]).map(x=>{const I=x.type;return{...x,$expand:I===oe.ARRAY||I===oe.OBJECT}}),E=de(h);return E.value.length==0&&E.value.push(u()),E}function u(){return{type:oe.STRING,name:"",title:""}}function c(h,E){if(E){const I=E.children??[],O=I.indexOf(h);O>=0&&I.splice(O+1,0,u());return}const x=s.value.indexOf(h);x>=0&&s.value.splice(x+1,0,u())}function g(h,E){if(E){const I=E.children??[],O=I.indexOf(h);O>=0&&I.splice(O,1);return}const x=s.value.indexOf(h);x>=0&&s.value.splice(x,1),s.value.length==0&&s.value.push(u())}function v(h){h.type!==oe.ARRAY&&h.type!==oe.OBJECT||(h.children==null&&(h.children=[]),h.children.push(u()))}function _(h,E){h.type=E,E===oe.ARRAY||E===oe.OBJECT?h.$expand=!0:h.children=void 0}function y(){return{fields:s.value.map(E=>ae(E.name)?null:E.type!==oe.ARRAY&&E.type!==oe.OBJECT?{type:E.type,name:E.name,title:E.title}:{type:E.type,name:E.name,title:E.title,children:(E.children??[]).map(x=>ae(E.name)?null:{type:x.type,name:x.name,title:x.title}).filter(x=>x!=null)}).filter(E=>E!=null)}}function d(h,E){n.readonly===!0&&t("select",h,E)}return o==null||o.useHandle("confirm",y),e({submit:y}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(ns,{columns:r,data:s.value,onSelect:d},null)])}}}),na="_form_6lybl_2",la="_readonly_6lybl_6",oa="_datasource_6lybl_11",sa={form:na,readonly:la,datasource:oa},ia={classes:sa},yo=H(ta,[["__cssModules",ia]]),ra={class:"quickprint-config-group"},aa={class:"quickprint-config-section quickprint-config-inline"},ca={class:"quickprint-config-content"},ua={class:"quickprint-config-section quickprint-config-inline"},da={class:"quickprint-config-content"},fa={class:"quickprint-config-id"},pa={class:"quickprint-config-section quickprint-config-inline"},ma={class:"quickprint-config-content"},ga={class:"quickprint-config-group"},ha={class:"quickprint-config-group-title"},va=z({__name:"Detail",props:{element:{type:me,required:!0}},setup(n){const e=n,t=C(()=>{var l,o;return(o=pl(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:o.content});return(l,o)=>(T(),N("div",{class:m(l.classes.detail)},[f("div",ra,[f("section",aa,[o[0]||(o[0]=f("header",{class:"quickprint-config-header"},"类型",-1)),f("div",ca,Z(b(sn)(n.element.type)),1)]),f("section",ua,[o[1]||(o[1]=f("header",{class:"quickprint-config-header"},"标识",-1)),f("div",da,[f("span",fa,Z(n.element.id),1)])]),f("section",pa,[o[2]||(o[2]=f("header",{class:"quickprint-config-header"},"标题",-1)),f("div",ma,Z(n.element.title),1)])]),f("div",ga,[f("div",ha,[o[3]||(o[3]=f("span",null,"数据",-1)),f("span",{class:m(l.classes.type)},Z(b(Hr)(n.element.ds.type)),3)]),f("div",null,Z(t.value),1)])],2))}}),ba="_detail_11ox4_2",ya="_type_11ox4_10",_a={detail:ba,type:ya},Ea={classes:_a},Ta=H(va,[["__cssModules",Ea]]),Sa=z({__name:"index",props:{doc:{type:_e,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=de();function r(v){return v.reduce((_,y)=>{const d=Array.isArray(y.children)?r(y.children):[];if(rl(y.ds.value)||d.length>0){const h={value:y.id,label:y.title??y.id,data:y,children:d};return _.push(h),_}return _},[])}function i(){const v=l.doc.pages.reduce((y,d)=>y.concat(d.children),[]),_=r(v);return de(_)}function a(v){s.value=v}function u(v){return v.title?v.title:sn(v.type)}function c(v){return bp(v.type)??"icon-zhanweifu"}function g(v){t("select",v.data)}return(v,_)=>(T(),N("div",{class:m(v.classes.reference)},[f("div",{class:m([v.classes.panel,"quickprint-is-scrollable"])},[p(b(Oi),{data:b(o),onNodeHover:a,onNodeClick:g},{default:ke(({node:y})=>[p(b(U),{icon:c(y.data)},null,8,["icon"]),f("span",{class:m(v.classes.title)},Z(u(y.data)),3),f("span",{class:m(v.classes.id)},"<"+Z(y.value)+">",3)]),_:1},8,["data"])],2),f("div",{class:m([v.classes.detail,"quickprint-is-scrollable"])},[s.value?(T(),Q(Ta,{element:s.value.data,key:s.value.value},null,8,["element"])):Y("",!0)],2)],2))}}),Ra="_reference_1ekkx_2",wa="_panel_1ekkx_12",ka="_detail_1ekkx_20",Ca="_title_1ekkx_25",La="_id_1ekkx_29",Ia={reference:Ra,panel:wa,detail:ka,title:Ca,id:La},Na={classes:Ia},Oa=H(Sa,[["__cssModules",Na]]),xa=z({__name:"index",props:{doc:{type:_e,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=st();function t(r,i){return r==null?null:i==null?`${Lt.DS}.${r.type}.${r.name}`:`${Lt.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${Lt.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(T(),N("div",{class:m(r.classes.var)},[n.active==="ds"?(T(),Q(yo,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):Y("",!0),n.active==="builtin"?(T(),Q(ea,{key:1,onSelect:o})):Y("",!0),n.active==="reference"?(T(),Q(Oa,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):Y("",!0)],2))}}),Da={var:"_var_12wxd_2"},Ma={classes:Da},_o=H(xa,[["__cssModules",Ma]]),Aa=["onClick","onMouseenter"],Ba=z({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var a;const t=n,l=e,o=de((a=t.options[0])==null?void 0:a.value),s=C(()=>`${t.type}_${o.value.toLowerCase()}`);function r(u){l("select",u.value)}function i(u){o.value=u.value}return(u,c)=>(T(),N("div",{class:m(u.classes.doc)},[f("div",{class:m(["quickprint-is-scrollable",u.classes.panel])},[(T(!0),N(ne,null,ce(n.options,g=>(T(),N("div",{key:g.value,class:m({[u.classes.option]:!0,[u.classes.active]:g.value===o.value}),onClick:v=>r(g),onMouseenter:v=>i(g)},[f("strong",null,Z(g.label),1)],42,Aa))),128))],2),f("div",{class:m(["quickprint-is-scrollable",u.classes.desc])},[p(b(bo),{name:s.value},null,8,["name"])],2)],2))}}),$a="_doc_1pdoc_2",qa="_panel_1pdoc_10",Pa="_desc_1pdoc_16",Va="_option_1pdoc_23",Fa="_active_1pdoc_33",za={doc:$a,panel:qa,desc:Pa,option:Va,active:Fa},Ua={classes:za},Jt=H(Ba,[["__cssModules",Ua]]),Ha=z({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=st(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(a){return e==null?void 0:e.confirm({type:"function",value:`${a}()`})}return(a,u)=>(T(),N("div",{class:m(a.classes.function)},[n.active==="string"?(T(),Q(Jt,{options:t,onSelect:i,key:"string"})):Y("",!0),n.active==="number"?(T(),Q(Jt,{options:l,onSelect:i,key:"number"})):Y("",!0),n.active==="logical"?(T(),Q(Jt,{options:o,onSelect:i,key:"logical"})):Y("",!0),n.active==="date"?(T(),Q(Jt,{options:s,onSelect:i,key:"date"})):Y("",!0),n.active==="aggregate"?(T(),Q(Jt,{options:r,onSelect:i,key:"aggregate"})):Y("",!0)],2))}}),Ga={function:"_function_19szx_2"},Wa={classes:Ga},Ya=H(Ha,[["__cssModules",Wa]]),ja=["onMouseenter"],Xa=["onClick"],Za={key:1},Ka=z({__name:"Formula",props:{doc:{type:_e,default:null}},setup(n){const e=n,t=st(),l=[{id:"pageNumber",name:"页码",options:a(qs)}],o=de(l[0]);function s(u){o.value=u}function r(u){return t==null?void 0:t.confirm({type:"formula",value:u})}function i(u){const c=wn.tokenize(u),g=e.doc;return c.reduce((v,_)=>{if(_.type===at.VARIABLE)return v.push({type:"highlight",value:ot(_.value,g==null?void 0:g.ds)}),v;if(_.type===at.REFERENCE)return v.push({type:"highlight",value:vo(_.value,g)}),v;if(_.type===at.TEMPLATE){const d=(Array.isArray(_.value)?_.value:[_.value]).map(h=>h.type===at.VARIABLE?{type:"highlight",value:ot(h.value,g.ds)}:{type:"text",value:h.value});return v.concat(d)}return v.push({type:"text",value:wn.formatTokenValue(_)}),v},[])}function a(u){return u.map(c=>({nodes:i(c),value:c}))}return(u,c)=>(T(),N("div",{class:m(u.classes.formula)},[f("div",{class:m([u.classes.left,"quickprint-is-scrollable"])},[(T(),N(ne,null,ce(l,g=>f("div",{key:g.name,onMouseenter:v=>s(g),class:m({[u.classes.group]:!0,[u.classes.active]:g.id===o.value.id})},Z(g.name),43,ja)),64))],2),f("div",{class:m(u.classes.right)},[(T(!0),N(ne,null,ce(o.value.options,(g,v)=>(T(),N("div",{key:v,class:m(u.classes.code),onClick:_=>r(g.value)},[(T(!0),N(ne,null,ce(g.nodes,_=>(T(),N(ne,null,[_.type==="highlight"?(T(),N("span",{key:0,class:m(u.classes.highlight)},"["+Z(_.value)+"]",3)):(T(),N("span",Za,Z(_.value),1))],64))),256)),f("span",{class:m(u.classes.badge)},"插入",2)],10,Xa))),128))],2)],2))}}),Ja="_formula_ms7c3_2",Qa="_left_ms7c3_12",ec="_right_ms7c3_17",tc="_group_ms7c3_24",nc="_active_ms7c3_34",lc="_highlight_ms7c3_39",oc="_code_ms7c3_43",sc="_badge_ms7c3_65",ic={formula:Ja,left:Qa,right:ec,group:tc,active:nc,highlight:lc,code:oc,badge:sc},rc={classes:ic},ac=H(Ka,[["__cssModules",rc]]),gl=De(function(n){return gt("变量",(e,t)=>p(_o,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Me)}),cc=De(function(n){return dt("数据源",p(yo,{doc:n},null),{preset:"variable",icon:p(U,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Me)}),uc=De(function(n){const e=["ds","builtin","reference"];return gt("变量",(t,l)=>p(_o,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Me)}),dc=De(function(){return gt("函数",(n,e)=>p(Ya,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(Me)}),fc=De(function(n){return dt("公式",p(ac,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Me)}),pc={key:1},mc=z({__name:"Content",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Re(),l=Yt("editorRef"),o=Yt("contentRef"),s=de(!1),r=C(()=>{const c=e.element.type===J.TABLE_CELL?ho(e.element,{exclude:["border"]}):go(e.element);return c.color&&(c["--quickprint-element-var-color"]=c.color),s.value&&(c.alignItems="flex-start"),c}),i=C(()=>{const c=pl(e.element,t.doc.ds);return c==null||c.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:c.type===Ee.CONST?"span":"strong",content:c.content},{tag:"span",content:e.element.attributes.suffix}]});async function a(){var _;const c=await gl({doc:t.doc,value:e.element.ds.value}).catch(Je);if(c==null||(e.element.setDataSource(Ee.VARIABLE,c.value),e.element.type!=J.TABLE_CELL||c.type!=="ds"))return;const g=e.element.parent;if(g==null||g.isBindVariable||((_=c.parent)==null?void 0:_.type)!==oe.ARRAY)return;const v=c.parent;g.setDataSource(Ee.VARIABLE,`${Lt.DS}.${v.type}.${v.name}`)}function u(){const c=l.value,g=o.value;c==null||g==null||(s.value=g.offsetHeight>c.offsetHeight)}return(c,g)=>(T(),N("div",{class:"quickprint-is-element-editor",style:X(r.value),onVnodeMounted:u,ref_key:"editorRef",ref:l},[f("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:o},[f("span",{class:m({[c.classes.lineThrough]:n.element.style.lineThrough})},[(T(!0),N(ne,null,ce(i.value,(v,_)=>(T(),N(ne,{key:_},[v.tag=="strong"?(T(),N("strong",{key:0,class:m(c.classes.highlight)},"["+Z(v.content)+"]",3)):(T(),N("span",pc,Z(v.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(T(),Q(b(U),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(c.classes.dsIcon),onClick:a,onPointerdown:g[0]||(g[0]=se(()=>{},["stop"]))},null,8,["class"])):Y("",!0)],4))}}),gc="_dsIcon_ss96n_2",hc="_lineThrough_ss96n_10",vc="_highlight_ss96n_14",bc={dsIcon:gc,lineThrough:hc,highlight:vc},yc={classes:bc},Mn=H(mc,[["__cssModules",yc]]),_c=z({__name:"TextEditor",props:{element:{type:ls,required:!0}},setup(n){return(e,t)=>(T(),Q(Mn,{element:n.element},null,8,["element"]))}}),An=Object.freeze({title:"文本",icon:"icon-text",type:J.TEXT,editor:_c,onCreate(){return me.create({type:J.TEXT,width:It,height:xn})}}),Ec=z({__name:"NumberEditor",props:{element:{type:os,required:!0}},setup(n){return(e,t)=>(T(),Q(Mn,{element:n.element},null,8,["element"]))}}),Tc=["value","disabled"],Sc=z({__name:"RadioButton",props:Ot({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=rn(n,"modelValue");return(t,l)=>(T(),N("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(T(!0),N(ne,null,ce(n.options,o=>(T(),N("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[Te(f("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,Tc),[[Ss,e.value]]),f("span",null,Z(o.label),1)],2))),256))],2))}}),Rc="_radioGroup_67myk_2",wc="_compacted_67myk_10",kc="_radio_67myk_2",Cc="_selected_67myk_50",Lc="_disabled_67myk_56",Ic={radioGroup:Rc,compacted:wc,radio:kc,selected:Cc,disabled:Lc},Nc={classes:Ic},$t=H(Sc,[["__cssModules",Nc]]),Oc={class:"quickprint-config-section quickprint-config-inline"},xc={class:"quickprint-config-content"},Dc={class:"quickprint-config-section quickprint-config-inline"},Mc={class:"quickprint-config-content"},Ac={class:"quickprint-config-section quickprint-config-inline"},Bc={class:"quickprint-config-content"},$c={class:"quickprint-config-section quickprint-config-inline"},qc={class:"quickprint-config-content"},Pc=z({__name:"NumberConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t=C({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=C({get(){return e.element.attributes.round??en.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=C({get(){return e.element.attributes.format??Et.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(T(),N(ne,null,[f("section",Oc,[r[4]||(r[4]=f("header",{class:"quickprint-config-header"},"小数位数",-1)),f("div",xc,[Te(f("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Oe,n.element.attributes.precision]])])]),f("section",Dc,[r[5]||(r[5]=f("header",{class:"quickprint-config-header"},"舍入规则",-1)),f("div",Mc,[p(b(le),{options:b(Is),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",Ac,[r[6]||(r[6]=f("header",{class:"quickprint-config-header"},"显示类型",-1)),f("div",Bc,[p(b(le),{options:b(Ns),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",$c,[r[7]||(r[7]=f("header",{class:"quickprint-config-header"},"值为0时",-1)),f("div",qc,[p($t,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:b(Os),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),Bn=Object.freeze({title:"数字",type:J.NUMBER,icon:"icon-number",editor:Ec,config:{display:Pc},onCreate(){return me.create({type:J.NUMBER,width:It,height:xn})}}),Vc=z({__name:"DateEditor",props:{element:{type:ss,required:!0}},setup(n){return(e,t)=>(T(),Q(Mn,{element:n.element},null,8,["element"]))}}),Fc={class:"quickprint-config-section"},zc={class:"quickprint-config-content"},Uc=z({__name:"DateConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=C(()=>[{label:"原始值",value:t.NONE},...lo]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(T(),N("section",Fc,[f("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=f("span",null,"格式",-1)),p(b(le),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:ke(()=>[f("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),f("div",zc,[Te(f("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Oe,n.element.attributes.format]])])]))}}),Hc="_header_79607_2",Gc="_picker_79607_8",Wc="_placeholder_79607_15",Yc={header:Hc,picker:Gc,placeholder:Wc},jc={classes:Yc},Xc=H(Uc,[["__cssModules",jc]]),$n=Object.freeze({title:"日期",type:J.DATE,icon:"icon-date",editor:Vc,config:{display:Xc},onCreate(){return me.create({type:J.DATE,width:It,height:xn})}}),Zc=["x1","y1","x2","y2"],Kc=z({__name:"Diagonal",props:{mode:{type:Number,default:0},labels:{type:Array,default:null},width:{type:Number,default:null},height:{type:Number,default:null}},setup(n){const e=Ce("classes"),t=n,l=C(()=>t.mode===we.TL_BR?{x1:"0",y1:"0",x2:"100%",y2:"100%"}:t.mode===we.TR_BL?{x1:"100%",y1:"0",x2:"0",y2:"100%"}:null),o=C(()=>({[e.biagonal]:!0,[e.tlbr]:t.mode===we.TL_BR,[e.trbl]:t.mode===we.TR_BL})),s=C(()=>({width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"})),r=C(()=>{var a,u;return(u=(a=t.labels)==null?void 0:a[0])==null?void 0:u.text}),i=C(()=>{var a,u;return(u=(a=t.labels)==null?void 0:a[1])==null?void 0:u.text});return(a,u)=>(T(),N("div",{class:m(o.value),style:X(s.value)},[l.value?(T(),N("svg",{key:0,class:m(b(e).line)},[f("line",{x1:l.value.x1,y1:l.value.y1,x2:l.value.x2,y2:l.value.y2},null,8,Zc)],2)):Y("",!0),r.value?(T(),N("div",{key:1,class:m(b(e).firstLabel)},Z(r.value),3)):Y("",!0),i.value?(T(),N("div",{key:2,class:m(b(e).secondLabel)},Z(i.value),3)):Y("",!0)],6))}}),Jc="_biagonal_17a80_2",Qc="_firstLabel_17a80_9",eu="_secondLabel_17a80_10",tu="_tlbr_17a80_15",nu="_trbl_17a80_26",lu="_line_17a80_37",ou={biagonal:Jc,firstLabel:Qc,secondLabel:eu,tlbr:tu,trbl:nu,line:lu},su={classes:ou},el=H(Kc,[["__cssModules",su]]),iu=["colspan","rowspan"],ru=z({__name:"TableCellEditor",props:{element:{type:kn,required:!0}},setup(n){const e=n,t=C(()=>e.element.isCollapsed),l=C(()=>{const c=e.element.attributes.diagonalMode;return c==null?!1:c!==we.NONE}),o=Re(),s=Ce("classes"),r=C(()=>{const c=e.element,g=c.parent;return{[s.cell]:!0,[K.SELECTED]:(g==null?void 0:g.isSelected)||c.isSelected}}),i=C(()=>{var v;const c=Zn((v=e.element.parent)==null?void 0:v.parent),g=Zn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Xe(c,g)}}),a=C(()=>{const c=ho(e.element,{exclude:["border","padding"]});return c.color&&(c["--quickprint-element-var-color"]=c.color),c});function u(c){c.button==0&&o.selectElement(e.element)}return(c,g)=>t.value?Y("",!0):(T(),N("td",Jl({key:0,[`.${b(Ge)||""}`]:n.element,class:r.value,style:i.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:se(u,["stop"])}),[l.value?(T(),Q(el,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight,style:X(a.value)},null,8,["mode","labels","width","height","style"])):(T(),Q(Mn,{key:1,element:n.element,class:m(b(s).content)},null,8,["element","class"]))],48,iu))}}),au="_cell_rp1x6_2",cu="_content_rp1x6_31",uu={cell:au,content:cu},du={classes:uu},Eo=H(ru,[["__cssModules",du]]);function hl(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const fu=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:re.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],To=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],So=[{label:"默认",value:re.DEFAULT},...To],qn=[{label:"默认",value:re.DEFAULT},...fu,...To],vl=[{label:"默认",value:Se.DEFAULT},{label:"初号",value:Se.SIZE_0+"pt",short:"56px"},{label:"小初",value:Se.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:Se.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:Se.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:Se.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:Se.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:Se.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:Se.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:Se.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:Se.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:Se.SIZE_5+"pt",short:"14px"},{label:"小五",value:Se.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],Ro=[{label:"默认",value:Tt.DEFAULT},{label:"1.0",value:Tt.TIMES_1,short:"单倍行距"},{label:"1.1",value:Tt.TIMES_1_1},{label:"1.5",value:Tt.TIMES_1_5},{label:"2.0",value:Tt.TIMES_2,short:"两倍行距"}],pu=[{label:"无",value:mn.NONE},{label:"实线",value:Mt.SOLID},{label:"虚线",value:Mt.DASHED},{label:"点划线",value:Mt.DOTTED},{label:"双实线",value:Mt.DOUBLE},{label:"波浪线",value:Mt.WAVY}],mu=[{label:"无",value:ee.NONE},{label:"实线",value:ee.SOLID},{label:"虚线",value:ee.DASHED},{label:"点划线",value:ee.DOTTED},{label:"双实线",value:ee.DOUBLE}],gu=[{label:"默认",value:St.AUTO},{label:"左对齐",value:St.LEFT},{label:"居中对齐",value:St.CENTER},{label:"右对齐",value:St.RIGHT},{label:"两端对齐",value:St.JUSTIFY}],tl=[{label:"顶部对齐",value:Qe.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Qe.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Qe.BOTTOM,icon:"icon-vertical-align-bottom"}],nl=[{label:"左对齐",value:ct.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:ct.CENTER,icon:"icon-align-center"},{label:"右对齐",value:ct.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:ct.JUSTIFY,icon:"icon-menu"}],hu={class:"quickprint-is-row"},vu=["onClick"],bu=z({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Ce("classes"),o=e,s=n,r=pe(),i=C(()=>({height:s.height})),a=C({get(){return nt(s.modelValue).num??void 0},set(y){if(y==""||is(y)||y<0){g(void 0);return}const d=nt(s.modelValue);g(`${y}${d.unit}`)}}),u=C({get(){return nt(s.modelValue).unit??ye.PX},set(y){const d=nt(s.modelValue);g(`${d.num}${y}`)}});function c(y){const d=y===Se.DEFAULT?void 0:y;o("update:modelValue",d)}function g(y){o("update:modelValue",y),_()}function v(y){const d=s.modelValue;return d==null&&y.value===Se.DEFAULT?!0:d===y.value}async function _(){await Wt();const y=document.querySelector("."+l.fontSelected);y&&y.scrollIntoView({block:"nearest"})}return(y,d)=>(T(),N("div",{class:m(b(l).fontSize),style:X(i.value)},[f("div",hu,[Te(f("input",{type:"number",placeholder:"请输入",class:m(["quickprint-form-control",b(l).input]),min:0,"onUpdate:modelValue":d[0]||(d[0]=h=>a.value=h)},null,2),[[Oe,a.value]]),p(b(le),{width:"54px",options:t,modelValue:u.value,"onUpdate:modelValue":d[1]||(d[1]=h=>u.value=h)},null,8,["modelValue"])]),f("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(l).fonts]),ref_key:"scrollRef",ref:r},[(T(!0),N(ne,null,ce(b(vl),h=>(T(),N("div",{key:h.value,class:m({[b(l).option]:!0,[b(l).fontSelected]:v(h)}),onClick:E=>c(h.value)},[f("span",null,Z(h.label),1)],10,vu))),128))],2)],6))}}),yu="_input_9oh9n_2",_u="_fontSize_9oh9n_8",Eu="_fonts_9oh9n_13",Tu="_option_9oh9n_25",Su="_fontSelected_9oh9n_34",Ru={input:yu,fontSize:_u,fonts:Eu,option:Tu,fontSelected:Su},wu={classes:Ru},wo=H(bu,[["__cssModules",wu]]),ku=["title"],Cu={key:0},Lu="中文字体 AbBbCc",Iu=z({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=C(()=>qn.map(d=>(d.style={fontFamily:d.value==re.DEFAULT?re.SONG:d.value},d))),l=C(()=>So.map(d=>(d.style={fontFamily:d.value==re.DEFAULT?re.SONG:d.value},d))),o=C({get(){const d=e.options.style.fontFamily;return ae(d)?re.DEFAULT:d},set(d){e.options.style.fontFamily=d==re.DEFAULT?void 0:d}}),s=C({get(){const d=e.options.style.enFontFamily;return ae(d)?re.DEFAULT:d},set(d){e.options.style.enFontFamily=d==re.DEFAULT?void 0:d}}),r=C({get(){const d=e.options.style.color;return ae(d)?$e.INHERIT:d},set(d){e.options.style.color=d==$e.INHERIT?void 0:d}}),i=C({get(){const d=e.options.style.highlightColor;return ae(d)?$e.INHERIT:d},set(d){e.options.style.highlightColor=d==$e.INHERIT?void 0:d}}),a=C({get(){return e.options.style.fontSize},set(d){const h=ae(d)?void 0:d;e.options.style.fontSize=h}}),u=C({get(){return e.options.style.fontWeight===700},set(d){e.options.style.fontWeight=d?700:void 0}}),c=C({get(){return e.options.style.fontStyle==="italic"},set(d){e.options.style.fontStyle=d?"italic":void 0}}),g=C({get(){return e.options.style.lineThrough===!0},set(d){e.options.style.lineThrough=d?!0:void 0}}),v=C({get(){const d=e.options.style.underline;if(d==null||d===!1)return mn.NONE;const h=e.options.style.underlineStyle;return ae(h)?Mt.SOLID:h},set(d){if(d===mn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=d}}),_=C({get(){const d=e.options.style.underlineColor;return ae(d)?$e.INHERIT:d},set(d){e.options.style.underlineColor=d==$e.INHERIT?void 0:d}}),y=C(()=>{const d=e.options.style,h={},E=il(d.fontFamily,d.enFontFamily);E&&(h.fontFamily=E);const x=Ul(d);return x&&Xe(h,x),d.fontSize&&(h.fontSize=d.fontSize),d.fontWeight&&(h.fontWeight=d.fontWeight),d.color&&(h.color=d.color),d.fontStyle&&(h.fontStyle=d.fontStyle),d.highlightColor&&(h["--quickprint-variable-highlight-color"]=d.highlightColor),h});return(d,h)=>(T(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",d.classes.font])},[f("div",{class:m(d.classes.fontFamily)},[f("div",{class:m(d.classes.config)},[f("div",{class:m(d.classes.title)},"中文字体",2),f("div",{class:m(d.classes.content)},[p(b(le),{options:t.value,modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=E=>o.value=E)},null,8,["options","modelValue"])],2)],2),f("div",{class:m(d.classes.config)},[f("div",{class:m(d.classes.title)},"颜色",2),p(b(bn),{modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=E=>r.value=E)},null,8,["modelValue"])],2),f("div",{class:m([d.classes.config,d.classes.fontSize])},[f("div",{class:m(d.classes.title)},"字号",2),p(wo,{modelValue:a.value,"onUpdate:modelValue":h[2]||(h[2]=E=>a.value=E),height:"144px"},null,8,["modelValue"])],2),f("div",{class:m(d.classes.config)},[f("div",{class:m(d.classes.title)},"西文字体",2),f("div",{class:m(d.classes.content)},[p(b(le),{options:l.value,modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=E=>s.value=E)},null,8,["options","modelValue"])],2)],2),f("div",{class:m(d.classes.config)},[f("div",{class:m(d.classes.title)},"前景色",2),p(b(bn),{modelValue:i.value,"onUpdate:modelValue":h[4]||(h[4]=E=>i.value=E)},null,8,["modelValue"])],2),f("div",{class:m(d.classes.config)},[f("div",{class:m(d.classes.title)},"下划线",2),f("div",{class:m(d.classes.content)},[p(b(le),{modelValue:v.value,"onUpdate:modelValue":h[5]||(h[5]=E=>v.value=E),options:b(pu),width:"138px"},{option:ke(({option:E})=>[f("div",{title:E.label,class:m(d.classes.option)},[E.value==b(mn).NONE?(T(),N("div",Cu,Z(E.label),1)):(T(),N("div",{key:1,class:m(d.classes.line),style:X({textDecorationStyle:E.value})},"--",6))],10,ku)]),_:1},8,["modelValue","options"])],2)],2),f("div",{class:m(d.classes.config)},[f("div",{class:m(d.classes.title)},"线条颜色",2),f("div",{class:m(d.classes.content)},[p(b(bn),{modelValue:_.value,"onUpdate:modelValue":h[6]||(h[6]=E=>_.value=E),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),f("div",{class:m(d.classes.fieldset)},[h[13]||(h[13]=f("header",null,"效果",-1)),f("div",{class:m(d.classes.configs)},[f("label",{class:m(d.classes.checkbox)},[Te(f("input",{type:"checkbox","onUpdate:modelValue":h[7]||(h[7]=E=>u.value=E)},null,512),[[Yn,u.value]]),h[10]||(h[10]=f("span",null,"粗体",-1))],2),f("label",{class:m(d.classes.checkbox)},[Te(f("input",{type:"checkbox","onUpdate:modelValue":h[8]||(h[8]=E=>c.value=E)},null,512),[[Yn,c.value]]),h[11]||(h[11]=f("span",null,"斜体",-1))],2),f("label",{class:m(d.classes.checkbox)},[Te(f("input",{type:"checkbox","onUpdate:modelValue":h[9]||(h[9]=E=>g.value=E)},null,512),[[Yn,g.value]]),h[12]||(h[12]=f("span",null,"删除线",-1))],2)],2)],2),f("div",{class:m(d.classes.fieldset)},[h[14]||(h[14]=f("header",null,"预览",-1)),f("div",{class:m(d.classes.preview)},[f("span",{style:X(y.value)},[f("span",{class:m({[d.classes.lineThrough]:n.options.style.lineThrough})},Z(Lu),2)],4)],2)],2)],2))}}),Nu="_grid2_7i8m3_1",Ou="_item_7i8m3_1",xu="_itemLabel_7i8m3_1",Du="_fieldset_7i8m3_1",Mu="_font_7i8m3_4",Au="_fontFamily_7i8m3_9",Bu="_config_7i8m3_16",$u="_fontSize_7i8m3_21",qu="_title_7i8m3_25",Pu="_configs_7i8m3_30",Vu="_checkbox_7i8m3_36",Fu="_option_7i8m3_51",zu="_line_7i8m3_59",Uu="_preview_7i8m3_70",Hu="_lineThrough_7i8m3_85",Gu={grid2:Nu,item:Ou,itemLabel:xu,fieldset:Du,font:Mu,fontFamily:Au,config:Bu,fontSize:$u,title:qu,configs:Pu,checkbox:Vu,option:Fu,line:zu,preview:Uu,lineThrough:Hu},Wu={classes:Gu},Yu=H(Iu,[["__cssModules",Wu]]),ju=["placeholder","min","disabled"],Xu=z({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=C(()=>{const a=l.defaultUnit;return l.options.some(u=>u.value===a)?a:l.options[0].value}),s=C({get(){return nt(l.modelValue).num},set(a){if(al(a)){const c=nt(l.modelValue).unit??o.value;return i(`${a}${c}`)}i()}}),r=C({get(){return nt(l.modelValue).unit??o.value},set(a){const c=nt(l.modelValue).num??l.min;i(`${c}${a}`)}});function i(a=void 0){t("update:modelValue",a)}return(a,u)=>(T(),N("div",{class:m(a.classes.input)},[Te(f("input",{type:"number","onUpdate:modelValue":u[0]||(u[0]=c=>s.value=c),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,ju),[[Oe,s.value]]),p(b(le),{modelValue:r.value,"onUpdate:modelValue":u[1]||(u[1]=c=>r.value=c),class:m(a.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),Zu="_input_gtdaq_2",Ku="_unit_gtdaq_14",Ju={input:Zu,unit:Ku},Qu={classes:Ju},ze=H(Xu,[["__cssModules",Qu]]),ed="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",td=z({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:ye.NONE},{label:"磅",value:ye.PT},{label:"像素",value:ye.PX}],l=[{label:"字符",value:ye.EM},{label:"磅",value:ye.PT},{label:"像素",value:ye.PX}],o=[{label:"毫米",value:ye.MM},{label:"磅",value:ye.PT},{label:"像素",value:ye.PX}],s=C({get(){return e.options.style.textAlign??ct.LEFT},set(h){const E=h===ct.LEFT?void 0:h;e.options.style.textAlign=E}}),r=C({get(){return e.options.style.textAlignLast??St.AUTO},set(h){const E=h===St.AUTO?void 0:h;e.options.style.textAlignLast=E}}),i=C({get(){return e.options.style.verticalAlign??Qe.MIDDLE},set(h){const E=h===Qe.MIDDLE?void 0:h;e.options.style.verticalAlign=E}}),a=y("paddingTop"),u=y("paddingBottom"),c=y("paddingLeft"),g=y("paddingRight"),v=C(()=>{const h=e.options.style,E={};return h.textAlign&&(E.textAlign=h.textAlign),h.textAlignLast&&(E.textAlignLast=h.textAlignLast),h.textIndent&&(E.textIndent=h.textIndent),h.lineHeight&&(E.lineHeight=h.lineHeight),Xe(E,d(h.verticalAlign)),E}),_=C(()=>{const h=e.options.style,E={};return E["--openprint-paragraph-preview-padding-top"]=h.paddingTop??"2px",E["--openprint-paragraph-preview-padding-right"]=h.paddingRight??"2px",E["--openprint-paragraph-preview-padding-bottom"]=h.paddingBottom??"2px",E["--openprint-paragraph-preview-padding-left"]=h.paddingLeft??"2px",E});function y(h){return C({get(){return e.options.style[h]},set(E){const x=ae(E)?void 0:E;e.options.style[h]=x}})}function d(h){return h==null?{}:h==Qe.MIDDLE||h==null?{display:"flex",alignItems:"center"}:h==Qe.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(h,E)=>(T(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",h.classes.paragraph])},[f("div",{class:m(h.classes.textAlign)},[f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"文本对齐",2),p(b(le),{options:b(nl),modelValue:s.value,"onUpdate:modelValue":E[0]||(E[0]=x=>s.value=x)},null,8,["options","modelValue"])],2),f("div",{class:m(h.classes.alignLast)},[f("div",{class:m(h.classes.configItemLabel)},"最后一行",2),p(b(le),{options:b(gu),modelValue:r.value,"onUpdate:modelValue":E[1]||(E[1]=x=>r.value=x)},null,8,["options","modelValue"])],2)],2),f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"垂直对齐",2),p(b(le),{options:b(tl),modelValue:i.value,"onUpdate:modelValue":E[2]||(E[2]=x=>i.value=x)},null,8,["options","modelValue"])],2),f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"首行缩进",2),p(ze,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":E[3]||(E[3]=x=>n.options.style.textIndent=x),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"行高",2),p(ze,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":E[4]||(E[4]=x=>n.options.style.lineHeight=x),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.fieldset)},[E[9]||(E[9]=f("header",null,"内边距",-1)),f("div",{class:m(h.classes.padding)},[f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"上边距",2),p(ze,{modelValue:b(a),"onUpdate:modelValue":E[5]||(E[5]=x=>et(a)?a.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"下边距",2),p(ze,{modelValue:b(u),"onUpdate:modelValue":E[6]||(E[6]=x=>et(u)?u.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"左边距",2),p(ze,{modelValue:b(c),"onUpdate:modelValue":E[7]||(E[7]=x=>et(c)?c.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"右边距",2),p(ze,{modelValue:b(g),"onUpdate:modelValue":E[8]||(E[8]=x=>et(g)?g.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),f("div",{class:m(h.classes.fieldset)},[E[10]||(E[10]=f("header",null,"预览",-1)),f("div",{class:m(h.classes.preview),style:X(v.value)},[f("div",{style:X(_.value),class:m(h.classes.previewText)},[ie(Z(ed)+" "),f("div",{class:m(h.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),nd="_grid2_6gzjg_1",ld="_item_6gzjg_1",od="_itemLabel_6gzjg_1",sd="_fieldset_6gzjg_1",id="_paragraph_6gzjg_4",rd="_preview_6gzjg_9",ad="_textAlign_6gzjg_25 quickprint-is-row",cd="_configItem_6gzjg_30 quickprint-is-row",ud="_alignLast_6gzjg_35 quickprint-is-row",dd="_configItemLabel_6gzjg_45",fd="_padding_6gzjg_50",pd="_paddingItem_6gzjg_57",md="_paddingItemLabel_6gzjg_63",gd="_previewText_6gzjg_68",hd="_paddingPreview_6gzjg_77",vd={grid2:nd,item:ld,itemLabel:od,fieldset:sd,paragraph:id,preview:rd,textAlign:ad,configItem:cd,alignLast:ud,configItemLabel:dd,padding:fd,paddingItem:pd,paddingItemLabel:md,previewText:gd,paddingPreview:hd},bd={classes:vd},yd=H(td,[["__cssModules",bd]]),_d=["title","onClick"],Ed={key:0},Td=z({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=Ce("classes"),t=n,l=[{label:"像素",value:ye.PX},{label:"毫米",value:ye.MM},{label:"磅",value:ye.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=de(),i=C(()=>{const S=r.value;return S==null?"全部边框":s[S]}),a=C(()=>{const S=r.value;return S==null?!0:S<=o.BORDER_LEFT}),u=C(()=>{const S=r.value;return S==null?!0:S>=o.RADIUS_TOP_LEFT}),c=C(()=>{const S=r.value;return{[e.box]:!0,[e.highlightTopLeft]:S==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:S==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:S==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:S==o.RADIUS_BOTTOM_RIGHT}}),g=C(()=>({...x(o.BORDER_TOP),...x(o.BORDER_RIGHT),...x(o.BORDER_BOTTOM),...x(o.BORDER_LEFT),...E()})),v=C({get(){var V;const S=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return S.borderWidth;const w=(V=yt(R))==null?void 0:V.width;if(w!=null)return Reflect.get(S,w)},set(S){const R=t.options.style,w=r.value,V=S??void 0;if(w==null||w>o.BORDER_LEFT){R.borderWidth=V;return}const P=yt(w);P!=null&&Reflect.set(R,P.width,V)}}),_=C({get(){var V;const S=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return S.borderStyle??ee.NONE;const w=(V=yt(R))==null?void 0:V.style;return w==null?ee.NONE:Reflect.get(S,w)??ee.NONE},set(S){const R=t.options.style,w=r.value,V=S==null||S==ee.NONE?void 0:S;if(w==null||w>o.BORDER_LEFT){R.borderStyle=V;return}const P=yt(w);P!=null&&Reflect.set(R,P.style,V)}}),y=C({get(){var V;const S=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return S.borderColor;const w=(V=yt(R))==null?void 0:V.color;return w==null?$e.INHERIT:Reflect.get(S,w)??$e.INHERIT},set(S){const R=t.options.style,w=r.value,V=S??void 0;if(w==null||w>o.BORDER_LEFT){R.borderColor=V;return}const P=yt(w);P!=null&&Reflect.set(R,P.color,V)}}),d=C({get(){const S=t.options.style,R=r.value;if(R==null||R<=o.BORDER_LEFT)return S.borderRadius;const w=h(R);if(w!=null)return Reflect.get(S,w)},set(S){const R=t.options.style,w=r.value,V=S??void 0;if(w==null||w<=o.BORDER_LEFT){R.borderRadius=V;return}const P=h(w);P!=null&&Reflect.set(R,P,V)}});function h(S){switch(S){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function E(){const S=t.options.style;return{borderTopLeftRadius:S.borderTopLeftRadius??S.borderRadius,borderTopRightRadius:S.borderTopRightRadius??S.borderRadius,borderBottomRightRadius:S.borderBottomRightRadius??S.borderRadius,borderBottomLeftRadius:S.borderBottomLeftRadius??S.borderRadius}}function x(S){const R=t.options.style;if(S==null||S>o.BORDER_LEFT){const P=R.borderStyle;return P==null||P==ee.NONE?{borderStyle:ee.NONE}:{}}const w=yt(S);if(w==null)return{};const V=Reflect.get(R,w.style)??Reflect.get(R,"borderStyle");return V==null||V===ee.NONE?{}:{[w.style]:V??R.borderStyle,[w.width]:Reflect.get(R,w.width)??R.borderWidth,[w.color]:Reflect.get(R,w.color)??R.borderColor??$e.BLACK}}function I(S){_.value=S}function O(S){r.value=S===r.value?void 0:S}function k(){const S=t.options.style;S.borderStyle=void 0,S.borderColor=void 0,S.borderWidth=void 0,S.borderTopStyle=void 0,S.borderTopColor=void 0,S.borderTopWidth=void 0,S.borderRightStyle=void 0,S.borderRightColor=void 0,S.borderRightWidth=void 0,S.borderBottomStyle=void 0,S.borderBottomColor=void 0,S.borderBottomWidth=void 0,S.borderLeftStyle=void 0,S.borderLeftColor=void 0,S.borderLeftWidth=void 0}function $(){const S=t.options.style;S.borderTopStyle==ee.NONE&&(S.borderTopStyle=void 0),S.borderRightStyle==ee.NONE&&(S.borderRightStyle=void 0),S.borderBottomStyle==ee.NONE&&(S.borderBottomStyle=void 0),S.borderLeftStyle==ee.NONE&&(S.borderLeftStyle=void 0),S.borderStyle=ee.SOLID}function M(){const S=t.options.style;S.borderStyle=void 0,S.borderRightStyle=void 0,S.borderRightColor=void 0,S.borderRightWidth=void 0,S.borderLeftStyle=void 0,S.borderLeftColor=void 0,S.borderLeftWidth=void 0,S.borderTopStyle=ee.SOLID,S.borderBottomStyle=ee.SOLID}function q(S){const R=t.options.style,w=h(S)??"borderRadius",V=Reflect.get(R,w);return be(V)}function L(){const S=t.options.style;return be(S.borderRadius)??0}function A(S){const R=Math.min(Math.max(12,q(S)??L(),D(S)),36),w={width:R+"px",height:R+"px"};return r.value==S&&(w.backgroundColor="var(--radius-highlight-background-color)"),S==o.RADIUS_TOP_LEFT&&(w.top="-6px",w.left="-6px"),S==o.RADIUS_TOP_RIGHT&&(w.top="-6px",w.right="-6px"),S==o.RADIUS_BOTTOM_RIGHT&&(w.bottom="-6px",w.right="-6px"),S==o.RADIUS_BOTTOM_LEFT&&(w.bottom="-6px",w.left="-6px"),w}function D(S){const R=t.options.style;switch(S){case o.RADIUS_TOP_LEFT:{const w=R.borderTopStyle==null||R.borderTopStyle==ee.NONE?0:be(R.borderTopWidth),V=R.borderLeftStyle==null||R.borderLeftStyle==ee.NONE?0:be(R.borderLeftWidth);return Math.max(w??0,V??0)}case o.RADIUS_TOP_RIGHT:{const w=R.borderTopStyle==null||R.borderTopStyle==ee.NONE?0:be(R.borderTopWidth),V=R.borderRightStyle==null||R.borderRightStyle==ee.NONE?0:be(R.borderRightWidth);return Math.max(w??0,V??0)}case o.RADIUS_BOTTOM_RIGHT:{const w=R.borderBottomStyle==null||R.borderBottomStyle==ee.NONE?0:be(R.borderBottomWidth),V=R.borderRightStyle==null||R.borderRightStyle==ee.NONE?0:be(R.borderRightWidth);return Math.max(w??0,V??0)}case o.RADIUS_BOTTOM_LEFT:{const w=R.borderBottomStyle==null||R.borderBottomStyle==ee.NONE?0:be(R.borderBottomWidth),V=R.borderLeftStyle==null||R.borderLeftStyle==ee.NONE?0:be(R.borderLeftWidth);return Math.max(w??0,V??0)}default:return 0}}function B(S){const R=t.options.style;switch(S){case o.BORDER_TOP:{const w=Math.max(6,Math.min(q(o.RADIUS_TOP_LEFT)??L()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_TOP_RIGHT)??L()-6,32)),P={left:w+"px",right:V+"px",top:"-6px",height:"12px"};if(r.value===S&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderTopStyle==null||R.borderTopStyle==ee.NONE)return P;const te=be(R.borderTopWidth);return te==null||(P.height=12+te+"px",P.top=-6-te+"px"),P}case o.BORDER_BOTTOM:{const w=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_LEFT)??L()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_RIGHT)??L()-6,32)),P={left:w+"px",right:V+"px",bottom:"-6px",height:"12px"};if(r.value===S&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderBottomStyle==null||R.borderBottomStyle==ee.NONE)return P;const te=be(R.borderBottomWidth);return te==null||(P.height=12+te+"px",P.bottom=-6-te+"px"),P}case o.BORDER_LEFT:{const w=Math.max(6,Math.min(q(o.RADIUS_TOP_LEFT)??L()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_LEFT)??L()-6,32)),P={top:w+"px",bottom:V+"px",left:"-6px",width:"12px"};if(r.value===S&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderLeftStyle==null||R.borderLeftStyle==ee.NONE)return P;const te=be(R.borderLeftWidth);return te==null||(P.width=12+te+"px",P.left=-6-te+"px"),P}case o.BORDER_RIGHT:{const w=Math.max(6,Math.min(q(o.RADIUS_TOP_RIGHT)??L()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_RIGHT)??L()-6,32)),P={top:w+"px",bottom:V+"px",right:"-6px",width:"12px"};if(r.value===S&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderRightStyle==null||R.borderRightStyle==ee.NONE)return P;const te=be(R.borderRightWidth);return te==null||(P.width=12+te+"px",P.right=-6-te+"px"),P}}}return(S,R)=>(T(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",b(e).settings])},[f("div",{class:m(b(e).presets)},[R[15]||(R[15]=f("span",null,"预设",-1)),f("button",{type:"button",class:"quickprint-text-btn",onClick:k},[f("div",{class:m(b(e).noBorder)},null,2),R[12]||(R[12]=f("span",null,"无边框",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:$},[f("div",{class:m(b(e).outerBorder)},null,2),R[13]||(R[13]=f("span",null,"外部边框",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:M},[f("div",{class:m(b(e).topBottomBorder)},null,2),R[14]||(R[14]=f("span",null,"上下边框",-1))])],2),f("div",{class:m(c.value),style:X(g.value),onClick:R[8]||(R[8]=se(()=>{},["stop"]))},[f("div",{class:m(b(e).borderRadius),style:X(A(o.RADIUS_TOP_LEFT)),onClick:R[0]||(R[0]=w=>O(o.RADIUS_TOP_LEFT))},null,6),f("div",{class:m(b(e).borderRadius),style:X(A(o.RADIUS_TOP_RIGHT)),onClick:R[1]||(R[1]=w=>O(o.RADIUS_TOP_RIGHT))},null,6),f("div",{class:m(b(e).borderRadius),style:X(A(o.RADIUS_BOTTOM_LEFT)),onClick:R[2]||(R[2]=w=>O(o.RADIUS_BOTTOM_LEFT))},null,6),f("div",{class:m(b(e).borderRadius),style:X(A(o.RADIUS_BOTTOM_RIGHT)),onClick:R[3]||(R[3]=w=>O(o.RADIUS_BOTTOM_RIGHT))},null,6),f("div",{class:m(b(e).border),style:X(B(o.BORDER_TOP)),onClick:R[4]||(R[4]=w=>O(o.BORDER_TOP))},null,6),f("div",{class:m(b(e).border),style:X(B(o.BORDER_BOTTOM)),onClick:R[5]||(R[5]=w=>O(o.BORDER_BOTTOM))},null,6),f("div",{class:m(b(e).border),style:X(B(o.BORDER_RIGHT)),onClick:R[6]||(R[6]=w=>O(o.BORDER_RIGHT))},null,6),f("div",{class:m(b(e).border),style:X(B(o.BORDER_LEFT)),onClick:R[7]||(R[7]=w=>O(o.BORDER_LEFT))},null,6),f("div",{class:m(b(e).borderTitle)},Z(i.value),3)],6),f("div",{class:m(b(e).borderSetting)},[f("div",{class:m(b(e).borderStyle)},[f("label",{class:m(b(e).borderStyleTitle)},"线型",2),f("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(e).borderStyleOptions])},[(T(!0),N(ne,null,ce(b(mu),w=>(T(),N("div",{key:w.value,title:w.label,class:m({[b(e).option]:!0,[b(e).selected]:w.value===_.value}),onClick:V=>I(w.value)},[w.value==b(ee).NONE?(T(),N("div",Ed,Z(w.label),1)):(T(),N("div",{key:1,class:m(b(e).line),style:X({textDecorationStyle:w.value})},"--",6))],10,_d))),128))],2)],2),f("div",{class:m(b(e).borderSettingRight)},[f("div",{class:m(b(e).borderItem)},[f("label",{class:m(b(e).borderItemLabel)},"颜色",2),p(b(bn),{modelValue:y.value,"onUpdate:modelValue":R[9]||(R[9]=w=>y.value=w),disabled:!a.value},null,8,["modelValue","disabled"])],2),f("div",{class:m(b(e).borderItem)},[f("label",{class:m(b(e).borderItemLabel)},"宽度",2),p(ze,{modelValue:v.value,"onUpdate:modelValue":R[10]||(R[10]=w=>v.value=w),options:l,disabled:!a.value},null,8,["modelValue","disabled"])],2),f("div",{class:m(b(e).borderItem)},[f("label",{class:m(b(e).borderItemLabel)},"圆角",2),p(ze,{modelValue:d.value,"onUpdate:modelValue":R[11]||(R[11]=w=>d.value=w),options:l,disabled:!u.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),Sd="_settings_12vtg_2",Rd="_box_12vtg_8",wd="_border_12vtg_19",kd="_borderTitle_12vtg_30",Cd="_borderRadius_12vtg_39",Ld="_borderItem_12vtg_50",Id="_borderItemLabel_12vtg_59",Nd="_borderSetting_12vtg_65",Od="_borderSettingRight_12vtg_70",xd="_borderStyle_12vtg_76",Dd="_borderStyleOptions_12vtg_81",Md="_borderStyleTitle_12vtg_88",Ad="_option_12vtg_95",Bd="_line_12vtg_114",$d="_selected_12vtg_125",qd="_presets_12vtg_131",Pd="_noBorder_12vtg_142",Vd="_outerBorder_12vtg_143",Fd="_topBottomBorder_12vtg_144",zd={settings:Sd,box:Rd,border:wd,borderTitle:kd,borderRadius:Cd,borderItem:Ld,borderItemLabel:Id,borderSetting:Nd,borderSettingRight:Od,borderStyle:xd,borderStyleOptions:Dd,borderStyleTitle:Md,option:Ad,line:Bd,selected:$d,presets:qd,noBorder:Pd,outerBorder:Vd,topBottomBorder:Fd},Ud={classes:zd},Hd=H(Td,[["__cssModules",Ud]]),Gd="_setting_joc27_2",Wd={setting:Gd},Yd={};function jd(n,e){return T(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const Xd={classes:Wd},Zd=H(Yd,[["render",jd],["__cssModules",Xd]]),Kd=z({__name:"TableCell",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"像素",value:ye.PX},{label:"毫米",value:ye.MM}],l=C({get(){const u=e.options.width;if(u!=null)return u+"px"},set(u){const c=be(u);e.options.width=c??void 0}}),o=C({get(){const u=e.options.height;if(u!=null)return u+"px"},set(u){const c=be(u);e.options.height=c??void 0}}),s=C({get(){return e.options.diagonalMode??we.NONE},set(u){const c=u==we.NONE?void 0:u;e.options.diagonalMode=c}}),r=C({get(){var u,c;return(c=(u=e.options.diagonalLabels)==null?void 0:u[1])==null?void 0:c.text},set(u){const c=e.options;c.diagonalLabels==null&&(c.diagonalLabels=[]),c.diagonalLabels[0]==null&&(c.diagonalLabels[0]={}),c.diagonalLabels[0].text=u}}),i=C({get(){var u,c;return(c=(u=e.options.diagonalLabels)==null?void 0:u[1])==null?void 0:c.text},set(u){const c=e.options;c.diagonalLabels==null&&(c.diagonalLabels=[]),c.diagonalLabels[1]==null&&(c.diagonalLabels[1]={}),c.diagonalLabels[1].text=u}});function a(u){s.value=u}return(u,c)=>(T(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",u.classes.setting])},[f("div",{class:m(u.classes.width)},[f("div",{class:m(u.classes.itemLabel)},"宽度",2),p(ze,{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=g=>l.value=g),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(u.classes.height)},[f("div",{class:m(u.classes.itemLabel)},"高度",2),p(ze,{modelValue:o.value,"onUpdate:modelValue":c[1]||(c[1]=g=>o.value=g),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(u.classes.fieldset)},[c[7]||(c[7]=f("header",null,"斜线表头",-1)),f("div",{class:m(["quickprint-is-row",u.classes.diagonal])},[f("div",{class:m({[u.classes.cell]:!0,[u.classes.selected]:s.value===b(we).NONE}),onClick:c[2]||(c[2]=g=>a(b(we).NONE))},null,2),f("div",{class:m({[u.classes.cell]:!0,[u.classes.selected]:s.value===b(we).TL_BR}),onClick:c[3]||(c[3]=g=>a(b(we).TL_BR))},[p(el,{mode:b(we).TL_BR,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2),f("div",{class:m({[u.classes.cell]:!0,[u.classes.selected]:s.value===b(we).TR_BL}),onClick:c[4]||(c[4]=g=>a(b(we).TR_BL))},[p(el,{mode:b(we).TR_BL,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2)],2),f("div",{class:m(u.classes.diagonalAttribute)},[f("div",{class:m(u.classes.item)},[f("div",{class:m(u.classes.itemLabel)},"顶部文本",2),Te(f("input",{"onUpdate:modelValue":c[5]||(c[5]=g=>r.value=g),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Oe,r.value]])],2),f("div",{class:m(u.classes.item)},[f("div",{class:m(u.classes.itemLabel)},"底部文本",2),Te(f("input",{"onUpdate:modelValue":c[6]||(c[6]=g=>i.value=g),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Oe,i.value]])],2)],2)],2)],2))}}),Jd="_grid2_vbejn_1",Qd="_item_vbejn_1",ef="_itemLabel_vbejn_1",tf="_fieldset_vbejn_1",nf="_setting_vbejn_4",lf="_width_vbejn_9",of="_height_vbejn_10",sf="_cell_vbejn_21",rf="_selected_vbejn_36",af="_diagonal_vbejn_41",cf="_diagonalAttribute_vbejn_45 _grid2_vbejn_1",uf={grid2:Jd,item:Qd,itemLabel:ef,fieldset:tf,setting:nf,width:lf,height:of,cell:sf,selected:rf,diagonal:af,diagonalAttribute:cf},df={classes:uf},ff=H(Kd,[["__cssModules",df]]),pf=z({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=st();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(T(),N("div",{class:m(s.classes.setting)},[n.active==="font"?(T(),Q(Yu,{key:0,options:e.options},null,8,["options"])):Y("",!0),n.active==="paragraph"?(T(),Q(yd,{key:1,options:e.options},null,8,["options"])):Y("",!0),n.active==="border"?(T(),Q(Hd,{key:2,options:e.options},null,8,["options"])):Y("",!0),n.active==="table"?(T(),Q(Zd,{key:3})):Y("",!0),n.active==="table-cell"?(T(),Q(ff,{key:4,options:e.options},null,8,["options"])):Y("",!0),f("div",{class:m(s.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),mf="_setting_1v5ya_2",gf="_footer_1v5ya_9",hf={setting:mf,footer:gf},vf={classes:hf},Pn=H(pf,[["__cssModules",vf]]);function ko(n){return xe({style:Cn(n.style??{})})}function bf(n,e){n.style=Object.assign({},n.style,e.style)}function yf(n){if(Array.isArray(n)&&n.length>1)return xe({style:{}});const e=Array.isArray(n)?n[0]:n;return xe({width:e.width,height:e.height,diagonalMode:e.attributes.diagonalMode,diagonalLabels:Cn(e.attributes.diagonalLabels??[]),style:Cn(e.style??{})})}const _f=De(function(n){return gt("表格",(e,t)=>p(Pn,{options:ko(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table",active:!0},{label:"边框",name:"border"}]}).promisify().then(e=>bf(n,e)).catch(Me)}),Ef=De(function(n){return gt("表格行",(e,t)=>p(Pn,{options:ko(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(Me)}),Tf=De(function(n){return gt("单元格",(e,t)=>p(Pn,{options:yf(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table-cell",active:!0},{label:"字体",name:"font"},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(Me)});function Sf(n,e,t){const l={menus:[...Co(e),{type:"menu",label:"行设置",icon:"icon-table-row",handler(){const o=e.getSelectedElements(),s=o[0];s!=null&&(Ef(s).then(r=>{if(r!=null)for(const i of o)i.style=Object.assign({},i.style,r.style)}),console.log("TODO:"))}},{type:"divider"},Lo(e),Io(e),{type:"divider"},No(e),hl(e.getDesignApi(),e.getTable())]};Nn.open(n.clientX,n.clientY,l)}function Rf(n,e){const l=e.getDesignApi().getSelectedElements();if(e.isSelectTableRow())return Sf(n,e,l[0]);const o=e.getSelectedCells(),s={menus:[...Co(e),{type:"menu",label:"单元格设置",icon:"icon-table-cell",handler(){Tf(o).then(i=>{if(i!=null)for(const a of o)i.width&&a.setWidth(i.width),i.height&&a.setHeight(i.height),i.diagonalMode&&(a.attributes.diagonalMode=i.diagonalMode),i.diagonalLabels&&(a.attributes.diagonalLabels=i.diagonalLabels),a.style=Object.assign({},a.style,i.style)})}},{type:"divider"}]},r=[];return o.length>=2&&r.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells}),o.some(i=>i.hasSpan)&&r.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),o.length===1&&o[0].noSpan&&r.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),r.length>0&&s.menus.push(...r,{type:"divider"}),s.menus.push(Lo(e),Io(e),{type:"divider"},No(e),hl(e.getDesignApi(),e.getTable())),Nn.open(n.clientX,n.clientY,s)}function Co(n){return[{type:"menu",label:"选中表格",icon:"icon-aim",handler:n.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",handler(){_f(n.getTable())}}]}function Lo(n){return{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:n.insertColumnLeft,disabled:n.isSelectTableRow},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:n.insertColumnRight,disabled:n.isSelectTableRow},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:n.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:n.inserRowBottom}]}}function Io(n){return{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:n.deleteColumns,disabled:n.isSelectTableRow},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:n.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:n.deleteDataSource}]}}function No(n){return{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:n.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:n.avgTableWidth},{type:"menu",label:"均分表格高度",handler:n.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:n.setOtherRowSameHeight,disabled(){const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:n.setOtherColSameWidth,disabled(){if(n.isSelectTableRow())return!0;const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasColSpan)}}]}}function wf(n,e){function t(){return n.element}function l(){return e.getSelectedElements(t())}function o(){const M=t();return l().filter(L=>{var D;if(L.type!==J.TABLE_CELL)return!1;const A=(D=L.parent)==null?void 0:D.parent;return A==null?!1:A.id==M.id}).sort(kn.sort)}function s(){return e.selectElement(t())}function r(){const M=o();if(M.length===0)return!1;const q=Rt.toArea(M);return t().insertColumn(q.colStart,0),e.createSnapshot(),!0}function i(){const M=o();if(M.length===0)return!1;const q=Rt.toArea(M);return t().insertColumn(q.colEnd,1),e.createSnapshot(),!0}function a(){if($()){const L=l()[0];return t().inserRow(L.index,0),e.createSnapshot(),!0}const M=o();if(M.length===0)return!1;const q=Rt.toArea(M);return t().inserRow(q.rowStart,0),e.createSnapshot(),!0}function u(){if($()){const L=l()[0];return t().inserRow(L.index,1),e.createSnapshot(),!0}const M=o();if(M.length===0)return!1;const q=Rt.toArea(M);return t().inserRow(q.rowEnd,1),e.createSnapshot(),!0}function c(){var te,Le;const M=t(),q=M.page;if(q==null)return;const L=M.doc,A=be((te=L==null?void 0:L.margins)==null?void 0:te.left)??38,D=be((Le=L==null?void 0:L.margins)==null?void 0:Le.right)??38,B=M.columns,S=B.reduce((Ie,Ye)=>Ie+Ye,0),R=Kn.mm_to_px(q.width)-A-D,w=[];for(const Ie of B){const Ye=Math.round(Ie/S*R);w.push(Ye)}const V=w.reduce((Ie,Ye)=>Ie+Ye,0),P=R-V;w[w.length-1]+=P,M.setColumns(w),M.updateBoxSize(),e.createSnapshot()}function g(){const M=t(),q=M.columns,L=q.reduce((S,R)=>S+R,0),A=Math.floor(L/q.length),D=new Array(q.length).fill(A),B=L-D.reduce((S,R)=>S+R,0);D[D.length-1]+=B,M.setColumns(D),M.updateBoxSize(),e.createSnapshot()}function v(){const M=t(),q=Math.round(M.height/M.children.length);M.children.forEach((L,A)=>M.setRowHeight(A,q)),M.updateBoxSize(),e.createSnapshot()}function _(){const M=l()[0];if(M==null)return;const q=M.type===J.TABLE_ROW?M:M.parent;if(!me.isDefineElement(q)||q.type!=J.TABLE_ROW)return;const L=t(),A=q.height;L.children.forEach(D=>D.setRowHeight(A)),L.updateBoxSize(),e.createSnapshot()}function y(){const M=l()[0];if(M==null)return;const q=t(),L=M.width,A=q.attributes.colgroup.map(D=>L);q.setColumns(A),q.updateBoxSize(),e.createSnapshot()}function d(){const M=o();if(M.length<2)return;const L=t().mergeCells(M);e.selectElement(L),e.createSnapshot()}function h(){const M=o();if(M.length==0)return;t().splitCells(M),e.createSnapshot()}function E(){const M=o()[0];if(M==null)return;t().removeColumn(M.index),e.resetSelectedElement(),e.createSnapshot()}function x(){if($()){const A=l()[0];t().removeRow(A.index),e.resetSelectedElement(),e.createSnapshot();return}const M=o();if(M.length==0)return;const q=Rt.toArea(M),L=t();for(let A=q.rowEnd;A>=q.rowStart;A--)L.removeRow(A);e.resetSelectedElement(),e.createSnapshot()}function I(){l().forEach(q=>q.resetDS()),e.createSnapshot()}function O(){const M=l();if(M.length!=1)return;const q=M[0];if(q.hasSpan)return;const L=q.index,A=t();A.insertColumn(L,1,!0);for(const D of A.children){const B=D.children[L];if(B.id===q.id)continue;const S=D.children[L+1];if(B.hasSpan){A.mergeRightCell(B,S);continue}if(B.isCollapsed){const R=A.find(B.attributes.control);R&&A.mergeRightCell(R,S);continue}A.mergeCells([B,S])}e.selectElement(q),e.createSnapshot()}function k(){const M=l();if(M.length!=1)return;const q=M[0];if(q.hasSpan)return;const L=q.parent;if(L==null)return;const A=t();A.inserRow(L.index,1);const D=A.children[L.index+1];for(let B=0;B<L.children.length;B++){const S=L.children[B];if(S.id===q.id)continue;const R=D.children[B];if(S.hasSpan){A.mergeBottomCell(S,R);continue}if(S.isCollapsed){const w=A.find(S.attributes.control);w&&A.mergeBottomCell(w,R);continue}A.mergeCells([S,R])}e.selectElement(q),e.createSnapshot()}function $(){const M=l();return M.length==1&&M[0].type==J.TABLE_ROW}return{getDesignApi(){return e},getTable:t,getSelectedElements:l,getSelectedCells:o,selectTable:s,insertColumnLeft:r,insertColumnRight:i,insertRowTop:a,inserRowBottom:u,autoReiszeColumnByPaper:c,avgTableWidth:g,avgTableHeight:v,setOtherRowSameHeight:_,setOtherColSameWidth:y,mergeCells:d,splitCells:h,splitByColumn:O,splitByRow:k,deleteColumns:E,deleteRows:x,deleteDataSource:I,isSelectTableRow:$}}function kf(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(c){return c<=0?null:n.getTable().getColumnLeft(c-1)}function r(c){const g=n.getTable(),v=g.attributes.colgroup.length;return c>=v?null:g.getColumnLeft(c+1)}function i(c,g){if(!(c.target instanceof Element))return;const v=c.target.closest("."+e.colResize);if(v==null)return;const _=v.closest("."+e.layer);_!=null&&(c.stopPropagation(),c.preventDefault(),o.left=v.offsetLeft,o.colIndex=g,o.target=v,o.container=_,o.target.setPointerCapture(c.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",u))}function a(c){if(o.target==null||o.container==null)return;const g=o.container.getBoundingClientRect(),v=n.getDesignApi().state.scale/100,_=s(o.colIndex),y=r(o.colIndex);let d=c.clientX-g.left;_!=null&&d<=_*v+4&&(d=_*v+4),y!=null&&d>=y*v-4&&(d=y*v-4),o.left=d/v,o.target.style.left=d/v+"px",o.moved=!0}function u(c){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",u)}return i}function Cf(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(c){return c<=0?null:n.getTable().getRowTop(c-1)}function r(c){const g=n.getTable(),v=g.children.length;return c>=v?null:g.getRowTop(c+1)}function i(c,g){if(!(c.target instanceof Element))return;const v=c.target.closest("."+e.rowResize);if(v==null)return;const _=v.closest("."+e.layer);_!=null&&(c.stopPropagation(),c.preventDefault(),o.top=v.offsetTop,o.rowIndex=g,o.target=v,o.container=_,o.target.setPointerCapture(c.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",u))}function a(c){if(o.target==null||o.container==null)return;const g=n.getDesignApi().state.scale/100,v=o.container.getBoundingClientRect(),_=s(o.rowIndex),y=r(o.rowIndex);let d=c.clientY-v.top;_!=null&&d<=_*g+4&&(d=_*g+4),y!=null&&d>=y*g-4&&(d=y*g-4),o.moved=!0,o.top=d/g,o.target.style.top=d/g+"px"}function u(c){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",u)}return i}const Lf=["width"],If=["onClick"],Nf=["onClick"],Of=z({__name:"TableEditor",props:{element:{type:Rt,required:!0}},setup(n){const e=n,t=Re(),l=Ce("classes"),o=wf(e,t),s=xe({colIndex:-1,rowIndex:-1,silence:!1}),r=C(()=>e.element.attributes.colgroup??[]),i=kf(o,l,{onResizeEnd:E,onResizeStart:h}),a=Cf(o,l,{onResizeEnd:x,onResizeStart:h});function u(L){return{left:(e.element.attributes.colgroup??[]).slice(0,L).reduce((D,B)=>D+B,0)+"px"}}function c(L){return{top:(e.element.children??[]).slice(0,L).reduce((B,S)=>B+S.height,0)-1+"px"}}function g(L){const A=e.element.attributes.colgroup??[],D=A.slice(0,L).reduce((R,w)=>R+w,0),B=L===0?0:1,S=L>0&&L<A.length?-1:0;return{left:D+B+"px",width:A[L]+S+"px"}}function v(L){const A=e.element.children??[],D=A.slice(0,L).reduce((R,w)=>R+w.height,0),B=L===0?0:1,S=L>0&&L<A.length?-1:0;return{top:D+B+"px",height:A[L].height+S+"px"}}function _(L){t.selectElement(L)}function y(L){const A=[];for(const D of e.element.children){const B=D.children[L];B.isColCollapsed||A.push(B)}t.multiSelectElements(A)}async function d(L){const A=L.target.closest("td");if(A==null)return;const D=Reflect.get(A,Ge);if(D==null)return;const B=t.getSelectedElements(e.element);(B.length==0||B.length==1&&B[0].type===J.TABLE_CELL||B.length>1&&B.findIndex(S=>S.id===D.id)<0)&&(t.selectElement(D),await Wt()),Rf(L,o)}function h(){s.silence=!0}function E(L,A){s.silence=!1;const D=e.element.attributes.colgroup??[];if(L==0){const V=e.element.left,P=e.element.calculateCoord(V+A),te=D[0]-(P-V);e.element.setLeft(P),e.element.setColWidth(0,te),e.element.updateBoxSize(),t.createSnapshot();return}if(L==D.length){const V=L-1,P=D.slice(0,V).reduce((Le,Ie)=>Le+Ie,0),te=A-P;e.element.setColWidth(L-1,te),e.element.updateBoxSize(),t.createSnapshot();return}const B=L-1,S=D[B]+D[L],R=A-D.slice(0,B).reduce((V,P)=>V+P,0),w=S-R;e.element.setColWidth(B,R),e.element.setColWidth(L,w),e.element.updateBoxSize(),t.createSnapshot()}function x(L,A){s.silence=!1;const D=e.element.children;if(L==0){const V=e.element.top,P=e.element.calculateCoord(V+A),te=D[0].height-(P-V);e.element.setTop(P),e.element.setRowHeight(L,te),e.element.updateBoxSize(),t.createSnapshot();return}if(L==D.length){const V=L-1,P=D.slice(0,V).reduce((Le,Ie)=>Le+Ie.height,0),te=A-P;e.element.setRowHeight(L-1,te),e.element.updateBoxSize(),t.createSnapshot();return}const B=L-1,S=D[B].height+D[L].height,R=A-D.slice(0,B).reduce((V,P)=>V+P.height,0),w=S-R;e.element.setRowHeight(B,R),e.element.setRowHeight(L,w),e.element.updateBoxSize(),t.createSnapshot()}function I(){s.rowIndex=-1,s.colIndex=-1}function O(L){const A=L.target.closest("td");if(A==null)return;const D=Reflect.get(A,Ge);if(D==null||!(D instanceof kn))return;const B=A.getBoundingClientRect(),S=L.clientX-B.left,R=D.index;if(!D.hasColSpan)return S<B.width/2?R:D.getNextColIndex();const w=e.element.attributes.colgroup,V=w[R]/2;if(S>=0&&S<=V)return R;const P=D.offsetWidth,te=P-w[R+D.colspan-1]/2;if(S>=te&&S<=P)return D.getNextColIndex()+1}function k(L){const A=L.target.closest("td");if(A==null)return;const D=Reflect.get(A,Ge);if(D==null||!(D instanceof kn))return;const B=D.parent;if(B==null)return;const S=A.getBoundingClientRect(),R=L.clientY-S.top,w=B.index;if(!D.hasRowSpan)return R<S.height/2?w:D.getNextRowIndex();const V=B.height/2;if(R>=0&&R<=V)return w;const P=e.element.children.slice(B.index,B.index+D.rowspan),te=P.reduce((Ie,Ye)=>Ie+Ye.height,0),Le=te-P[P.length-1].height;if(R>=Le&&R<=te)return D.getNextRowIndex()+1}function $(L){s.silence||(s.colIndex=O(L)??-1,s.rowIndex=k(L)??-1)}function M(){const L=e.element;L.insertColumn(L.colSize-1,1)}function q(){const L=e.element;L.inserRow(L.rowSize-1,1)}return(L,A)=>(T(),N("div",{class:m(b(l).tableEditor),onContextmenu:se(d,["stop","prevent"]),onClick:A[3]||(A[3]=se(()=>{},["stop"])),onMouseleave:I},[f("table",{class:m(b(l).table),onMousemove:$},[f("colgroup",null,[(T(!0),N(ne,null,ce(r.value,(D,B)=>(T(),N("col",{key:B,width:D},null,8,Lf))),128))]),f("tbody",null,[(T(!0),N(ne,null,ce(n.element.children,D=>(T(),N("tr",{key:D.id},[(T(!0),N(ne,null,ce(D.children,B=>(T(),Q(Eo,{key:B.id,element:B},null,8,["element"]))),128))]))),128))])],34),f("div",{class:m(b(l).layer)},[s.colIndex>=0?(T(),N("div",{key:0,title:"调整列宽",class:m(b(l).colResize),style:X(u(s.colIndex)),onPointerdown:A[0]||(A[0]=se(D=>b(i)(D,s.colIndex),["stop","prevent"]))},null,38)):Y("",!0),s.rowIndex>=0?(T(),N("div",{key:1,title:"调整行高",class:m(b(l).rowResize),style:X(c(s.rowIndex)),onPointerdown:A[1]||(A[1]=se(D=>b(a)(D,s.rowIndex),["stop","prevent"]))},null,38)):Y("",!0),(T(!0),N(ne,null,ce(r.value,(D,B)=>(T(),N("div",{title:"选中此列",key:B,style:X(g(B)),class:m(b(l).colIndicator),onClick:se(S=>y(B),["stop"])},null,14,If))),128)),(T(!0),N(ne,null,ce(n.element.children,(D,B)=>(T(),N("div",{title:"选中此行",key:B,style:X(v(B)),class:m(b(l).rowIndicator),onClick:se(S=>_(D),["stop"])},null,14,Nf))),128)),n.element.isSelected?(T(),N("button",{key:2,onClick:se(M,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addCol]),title:"添加列"},[p(b(U),{icon:"icon-plus",size:"14px"})],2)):Y("",!0),n.element.isSelected?(T(),N("button",{key:3,onClick:se(q,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addRow]),title:"添加行"},[p(b(U),{icon:"icon-plus",size:"14px"})],2)):Y("",!0)],2),f("div",{class:m(b(l).indicator),onPointerdown:A[2]||(A[2]=(...D)=>b(t).onDragStart&&b(t).onDragStart(...D)),title:"选中/拖动表格"},null,34)],34))}}),xf="_tableEditor_5qbkt_2",Df="_table_5qbkt_2",Mf="_layer_5qbkt_33",Af="_colResize_5qbkt_43",Bf="_rowResize_5qbkt_66",$f="_colIndicator_5qbkt_89",qf="_rowIndicator_5qbkt_95",Pf="_indicator_5qbkt_114",Vf="_addCol_5qbkt_151",Ff="_addRow_5qbkt_166",zf={tableEditor:xf,table:Df,layer:Mf,colResize:Af,rowResize:Bf,colIndicator:$f,rowIndicator:qf,indicator:Pf,addCol:Vf,addRow:Ff},Uf={classes:zf},Hf=H(Of,[["__cssModules",Uf]]),Gf={class:"quickprint-config-section quickprint-config-inline"},Wf={class:"quickprint-config-content"},Yf=z({__name:"TableConfig",props:{element:{type:Rt,required:!0}},setup(n){const e=n,t=C({get(){return e.element.attributes.rowMode??Zt.CONST},set(o){e.element.attributes.rowMode=o===Zt.CONST?void 0:o}}),l=[{label:"固定行数",value:Zt.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:Zt.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:Zt.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(T(),N("section",Gf,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",Wf,[p(b(le),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),jf={class:"quickprint-config-section quickprint-config-inline"},Xf={class:"quickprint-config-content"},Zf=z({__name:"TableRowConfig",props:{element:{type:gn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:Dt.HEADER},{label:"表体",value:Dt.BODY},{label:"表尾",value:Dt.FOOTER}],l=C({get(){return e.element.attributes.type??Dt.BODY},set(o){switch(o){case Dt.HEADER:e.element.asHeader();break;case Dt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(T(),N("section",jf,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",Xf,[p(b(le),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),Vn=Object.freeze({title:"表格",type:J.TABLE,icon:"icon-table",editor:Hf,config:{attributes:Yf,exclude:[fe.DISPLAY,fe.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[It,It,It],e=me.create({type:J.TABLE});return e.setColgroup(n),e.append(gn.createDefault(n)),e.append(gn.createDefault(n)),e.append(gn.createDefault(n)),e.updateBoxSize(),e}}),Oo=Object.freeze({title:"表格行",type:J.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[fe.POSITION,fe.COORD,fe.OVERFLOW],attributes:Zf}}),bl=Object.freeze({title:"单元格",type:J.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:Eo,config:{exclude:[fe.POSITION,fe.COORD]}});class Kf{constructor(e){W(this,"__v_skip",!0);W(this,"observer");W(this,"callbacks",[]);W(this,"handler");this.handler=Fr((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function Jf(n,e){switch(n){case"fontSize":return e===Se.DEFAULT?void 0:e;case"fontFamily":return e===re.DEFAULT?void 0:e;case"lineHeight":return e===Tt.DEFAULT?void 0:e;default:return e}}const Ol="texteditor-const-node",Qf=Object.freeze({CONST:0});class ep{constructor(e,t={}){W(this,"__v_skip",!0);W(this,"emitter",new Sn);W(this,"container");W(this,"options");W(this,"observer");W(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new Kf(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new Sn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new rs(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ae(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await In(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=Ol,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var v;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,a=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(a),r.parentNode===i||(v=r.parentNode)!=null&&v.contains(i))return s.insertNode(a),this.normalize(),this.focusAfterNode(a),!0;const u=r.parentNode;if(u==null)return!1;const c=u.textContent;if(c==null)return!1;if(o.anchorOffset==c.length)return i.insertBefore(a,u.nextSibling),this.normalize(),this.focusAfterNode(a),!0;const g=document.createElement("span");return g.textContent=c.slice(0,o.anchorOffset),u instanceof HTMLElement&&(g.style.cssText=u.style.cssText),u.textContent=c.slice(o.anchorOffset),i.insertBefore(a,u),i.insertBefore(g,a),this.normalize(),this.focusAfterNode(a),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ae(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var c;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:a}=this.normalizeRange(o);if(s===i){const g=s.textContent??"";if(s instanceof CharacterData){const y=document.createElement("span");return y.textContent=g.slice(r,a),o.deleteContents(),o.insertNode(y),[y]}const v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,i);const _=document.createElement("span");return _.textContent=g.slice(r,a),this.inheritStyle(_,i),i.textContent=g.slice(a),e.insertBefore(_,i),e.insertBefore(v,_),[_]}const u=this.findNodesBetween(s,i);if(r>0){const g=s.textContent??"",v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,s),s.textContent=g.slice(r),e.insertBefore(v,s)}if(a>=0&&a<=(((c=i.textContent)==null?void 0:c.length)??0)){const g=i.textContent??"";if(i instanceof HTMLElement){i.textContent=g.slice(0,a);const v=document.createElement("span");v.textContent=g.slice(a),this.inheritStyle(v,i),e.insertBefore(v,i.nextSibling),u.push(i)}else{const v=document.createElement("span");v.textContent=g.slice(0,a),e.replaceChild(v,i);const _=document.createTextNode(g.slice(a));e.insertBefore(_,i.nextSibling),u.push(v)}}return u.unshift(s),u}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=Yl(e),r=Jf(e,t);for(let i=0;i<l.length;i++){const a=l[i];if(a instanceof HTMLElement){this.matchElementStyle(a,s,r)||(o=!1);continue}const u=document.createElement("span");u.textContent=a.textContent,this.container.replaceChild(u,a),l[i]=u,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=wt.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=wt.remove(o,l);ae(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+Ol)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const tp=z({__name:"ParagraphEditor",props:{element:{type:as,required:!0}},setup(n){const e=n,t=Re(),l=pe(),o=C(()=>e.element.isSelected!==!0?!1:t.state.selectMode===tt.SINGLE);let s=null;const r=C(()=>qn.map(k=>(k.style={fontFamily:k.value==re.DEFAULT?re.SONG:k.value},k)));function i(){}async function a(){if(s==null)return;const k=await gl({doc:t.doc}).catch(Je);if(k==null)return;const $=ot(k.value,t.doc.ds)??k.value,M={type:Qf.CONST,value:k.value,label:$};s.insertNode(M)}function u(){s==null||s.blur()}function c(){s==null||s.autosize()}function g(k){const $=e.element.ds.value,M=new ep(k);return M.on("resize",q=>{var A;const L=(A=q.detail)==null?void 0:A.height;L!=null&&e.element.setHeight(L+2)}),M.watch(()=>{const q=M.getHTML(),L=e.element.ds.value;q!==L&&(e.element.ds.value=q,M.checkHeight())}),ae($)||M.setHTML($),M}function v(k){s==null||s.setStyle("fontFamily",k.value)}function _(k){s==null||s.setStyle("fontSize",k.value)}function y(k){s==null||s.setStyle("lineHeight",k.value)}function d(k){s==null||s.setStyle("backgroundColor",k)}function h(k){s==null||s.setStyle("color",k)}function E(){s==null||s.setStyle("fontWeight","700")}function x(){s==null||s.setStyle("fontStyle","italic")}function I(){s==null||s.setStyle("textDecorationLine","underline")}function O(){s==null||s.setStyle("textDecorationLine","line-through")}return ul(()=>e.element.ds.value,k=>{s==null||s.getHTML()==k||s.setHTML(k)}),an(()=>{e.element.on("blur",u),s=g(l.value)}),cl(()=>{e.element.off("blur",u),s&&s.cleanup()}),(k,$)=>(T(),N("div",{class:m(k.classes.paragraph),onPointerdown:$[2]||($[2]=se(()=>{},["stop"])),onContextmenu:se(i,["stop","prevent"])},[f("div",{class:m(k.classes.indicator),onPointerdown:$[0]||($[0]=(...M)=>b(t).onDragStart&&b(t).onDragStart(...M)),title:"选中/拖动段落"},null,34),o.value?(T(),N("div",{key:0,class:m(k.classes.toolbar),onMousedown:$[1]||($[1]=se(()=>{},["prevent"]))},[p(b(le),{onSelect:v,title:"字体",width:"60px",options:r.value,class:m(k.classes.tool),button:""},null,8,["options","class"]),p(b(le),{onSelect:_,title:"字号",width:"60px",options:b(vl),class:m(k.classes.tool),button:""},null,8,["options","class"]),p(b(le),{onSelect:y,title:"行高",width:"60px",options:b(Ro),class:m(k.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),f("div",{class:m(k.classes.divider)},null,2),p(b(Vt),{class:m(k.classes.tool),onSelect:d},{default:ke(()=>[f("div",{class:m(k.classes.colorIcon),title:"突出显示"},[p(b(U),{icon:"icon-bg-color-b",size:"15px"}),f("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(b(Vt),{class:m(k.classes.tool),onSelect:h},{default:ke(()=>[f("div",{class:m(k.classes.colorIcon),title:"字体颜色"},[p(b(U),{icon:"icon-font",size:"15px"}),f("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),f("button",{onClick:E,type:"button",title:"加粗",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-font-bold",size:"16px"})],2),f("button",{onClick:x,type:"button",title:"斜体",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-italic",size:"16px"})],2),f("button",{onClick:I,type:"button",title:"下划线",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-underline",size:"16px"})],2),f("button",{onClick:O,type:"button",title:"删除线",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-through-line",size:"16px"})],2),f("div",{class:m(k.classes.divider)},null,2),f("button",{class:"quickprint-text-btn",type:"button",onClick:a},[p(b(U),{icon:"icon-insert-var",size:"16px"}),$[3]||($[3]=f("span",null,"插入变量",-1))]),f("button",{class:"quickprint-text-btn",type:"button",onClick:c},[p(b(U),{icon:"icon-colum-height",size:"16px"}),$[4]||($[4]=f("span",null,"调整高度",-1))])],34)):Y("",!0),f("div",{ref_key:"editorRef",ref:l,class:m(k.classes.editor)},null,2)],34))}}),np="_paragraph_1v2pj_2",lp="_indicator_1v2pj_6",op="_editor_1v2pj_18",sp="_toolbar_1v2pj_44",ip="_tool_1v2pj_44",rp="_colorIcon_1v2pj_66",ap="_colorIndicator_1v2pj_86",cp="_divider_1v2pj_95",up={paragraph:np,indicator:lp,editor:op,toolbar:sp,tool:ip,colorIcon:rp,colorIndicator:ap,divider:cp},dp={classes:up},fp=H(tp,[["__cssModules",dp]]),Fn=Object.freeze({title:"段落",type:J.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:fp,config:{exclude:[fe.DATASOURCE,fe.BASIC,fe.OVERFLOW]},onCreate(){return me.create({type:J.PARAGRAPH,width:It*4,height:xn*6})}}),xo=[An,Bn,$n,Vn,bl,Oo,Fn],pp=[An,Bn,$n,Vn,Fn],mp={[J.TEXT]:An.editor,[J.NUMBER]:Bn.editor,[J.DATE]:$n.editor,[J.TABLE]:Vn.editor,[J.TABLE_CELL]:bl.editor,[J.PARAGRAPH]:Fn.editor},gp={[J.TEXT]:An.config,[J.NUMBER]:Bn.config,[J.DATE]:$n.config,[J.TABLE]:Vn.config,[J.TABLE_CELL]:bl.config,[J.TABLE_ROW]:Oo.config,[J.PARAGRAPH]:Fn.config},jt=xo.reduce((n,e)=>(n[e.type]=e,n),{});function hp(n){const e=xo.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function vp(n){return Reflect.get(mp,n)}function Qt(n){return Reflect.get(gp,n)}function sn(n){var e;return((e=jt[n])==null?void 0:e.title)??n}function bp(n){var e;return(e=jt[n])==null?void 0:e.icon}function yp(n){var e,t;return((t=(e=jt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function _p(n){var e,t;return((t=(e=jt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function Ep(n){var e,t;return((t=(e=jt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Tp(n){var e,t;return((t=(e=jt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function xl(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function Dl(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function Ml(n,e){const t=n.find(a=>a.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function Al(n,e){const t=n.find(a=>a.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function Sp(n){const e=document.createElement("div");return n.appendChild(e),e}function Rp(n,e){const t=[...e.querySelectorAll(":scope ."+K.GUIDE_LINE)];for(const l of n){const o=t.shift()??Sp(e);o.className=K.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function wp(n,e){const l=e.querySelectorAll(":scope ."+K.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const a=i.getBoundingClientRect();if(Math.abs(s.left-a.left)<=1||Math.abs(s.right-a.left)<=1){const u=a.left-o.left;Ml(r,xl(u,s,a,o))}if(Math.abs(s.left-a.right)<=1||Math.abs(s.right-a.right)<=1){const u=a.right-o.left;Ml(r,xl(u,s,a,o))}if(Math.abs(s.top-a.top)<=1||Math.abs(s.bottom-a.top)<=1){const u=a.top-o.top;Al(r,Dl(u,s,a,o))}if(Math.abs(s.bottom-a.bottom)<=1||Math.abs(s.top-a.bottom)<=1){const u=a.bottom-o.top;Al(r,Dl(u,s,a,o))}}Rp(r,e)}function kp(){const n=document.querySelectorAll("."+K.GUIDE_LINE);for(const e of n)e.remove()}const Ln={create:zr(wp,50),clean:kp};async function Cp(n){await In(),n&&Reflect.deleteProperty(n,On)}async function Lp(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=Ip(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-io(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function Ip(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===qe.INSERT){const o=t.closest("."+K.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?Bt(e.left-s.left):Math.round(e.left-s.left),y:l?Bt(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?Bt(e.left):Math.round(e.left),y:l?Bt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function Np(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function Op(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function xp(n){return!(n.style.rotate&&!n.isSelected)}function Dp(n){const e=new Qn({selector:{container:K.DROPPABLE},scale(t){return t.mode===qe.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,Ql),s=Reflect.get(l.target,dl);o===qe.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===qe.INSERT?o:qe.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===qe.INSERT){const s=hp(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,Ge);if(o==null||!xp(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===qe.INSERT&&(l.ghost.style.display="block"),l.mode===qe.MOVE&&Reflect.set(l.target,On,fl.DRAG_ELEMENT),l.ghost.classList.add(K.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,Lp(n,l),Np(n,l),l.dropTarget&&Ln.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;Ln.clean(),l.ghost.classList.remove(K.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===qe.INSERT&&(l.ghost.style.display="none"),l.mode==qe.MOVE&&Cp(l.target);const o=l.element;if(l.mode==qe.MOVE){const u=o.left,c=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-u,l.diffY=o.top-c,Op(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,eo);if(s==null)return;const r=s instanceof Nt||s instanceof me?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),a=n.state.scale/100;o.setTop((l.top-i.top)/a),o.setLeft((l.left-i.left)/a),o.setWidth(o.width/a),o.setHeight(o.height/a),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Bl="quickprint-history-0000",Mp=1,rt="snapshot",yn="health",$l="owner",Ze="INDEX_OWNER",Ap=15*60*1e3,Bp=10*60*1e3;function $p(){const n={db:null,timer:null,promise:null};async function e(){const c=await a(yn,"readwrite");if(c==null)return n.timer=s(),!1;const g=[],v=c.openCursor();v.onsuccess=async function(_){const y=_.target.result;if(y==null){t(g),n.timer=s(),Pe.debug("History","已检查无效快照");return}const d=y.value;d!=null&&Date.now()-d.timestamp>Ap&&g.push(d),y.continue()},v.onerror=function(_){console.error(_),n.timer=s()}}async function t(c){const g=await Promise.allSettled(c.map(v=>l(v.owner)));for(let v=0;v<g.length;v++){const _=g[v];_.status==="rejected"||_.value!==!0||o(c[v].id)}}async function l(c){const g=await a(rt,"readwrite");return g==null?!1:new Promise(v=>{const _=g.index(Ze).openCursor(IDBKeyRange.only(c));_.onsuccess=function(y){const d=y.target.result;if(d==null)return v(!0);d.delete(),d.continue()},_.onerror=function(y){console.error(y),v(!1)}})}async function o(c){const g=await a(yn,"readwrite");return g==null?!1:nn(g.delete(c)).then(()=>!0).catch(v=>(console.log(v),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),Bp)}function r(){return new Promise(c=>{const g=indexedDB.open(Bl,Mp);g.onupgradeneeded=v=>{const y=v.target.result,d=y.createObjectStore(yn,{keyPath:"id",autoIncrement:!0}),h=y.createObjectStore(rt,{keyPath:"id",autoIncrement:!0});d.createIndex(Ze,$l),h.createIndex(Ze,$l)},g.onsuccess=v=>{const _=v.target;n.db=_.result,Pe.debug("History",`已连接数据库【${Bl}】`),c(n.db)},g.onerror=function(v){console.error(v),n.db=null,c(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function a(c,g="readonly"){const v=await i();if(v==null)return null;try{return v.transaction(c,g).objectStore(c)}catch(_){return console.error(_),null}}function u(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:a,cleanup:u}}function nn(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const qp=5*60*1e3,_t=$p();var Ke,Ue,_n,ll,Do;class Pp{constructor(e,t={}){je(this,Ue);W(this,"state");W(this,"owner");je(this,Ke);this.state=e,this.owner=t.owner??cs(us.HISTORY_OWNER),Be(this,Ue,ll).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await _t.findStore(rt,"readwrite");if(l==null)return!1;await Be(this,Ue,Do).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await nn(l.put(s)).catch(Je)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await _t.findStore(rt,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await nn(o.put(l)).catch(Je)==null))}async getCurrentSnapshot(){const e=await _t.findStore(rt);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ze).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return o(a);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await _t.findStore(rt);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ze).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await _t.findStore(rt);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ze).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await _t.findStore(rt);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(Ze).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const a=i.value;if(a.owner!=t)return i.continue();s.push(a),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){Ae(this,Ke)&&(clearTimeout(Ae(this,Ke)),vt(this,Ke,null))}}Ke=new WeakMap,Ue=new WeakSet,_n=function(){vt(this,Ke,setTimeout(()=>Be(this,Ue,ll).call(this),qp))},ll=async function(){Ae(this,Ke)&&clearTimeout(Ae(this,Ke));const e=await _t.findStore(yn,"readwrite");if(e==null)return Be(this,Ue,_n).call(this);const t=await nn(e.index(Ze).get(this.owner)).catch(Je);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),Be(this,Ue,_n).call(this)}t.timestamp=Date.now(),await nn(e.put(t)).catch(Je),Be(this,Ue,_n).call(this)},Do=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(Ze).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const a=i.target.result;if(a==null)return s(!0);const u=a.value;if(u.owner!=o)return a.continue();if(u.index>t){a.delete(),a.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function Vp(n){const e=new Pp(xe({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(c){return e.createSnapshot(n.value,c)}function s(c){return e.replaceSnapshot(n.value,c)}async function r(){const c=await e.getPrevSnapshot();if(c==null)return!1;const g=Rn(c.data);return g==null?!1:(n.value=_e.create(g),!0)}async function i(){const c=await e.getNextSnapshot();if(c==null)return!1;const g=Rn(c.data);return g==null?!1:(n.value=_e.create(g),!0)}function a(){return e.list()}function u(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:a,cleanup:u,replaceSnapshot:s}}class Fp{constructor(e){W(this,"moved",!1);W(this,"position");W(this,"top",0);W(this,"left",0);W(this,"width",0);W(this,"height",0);W(this,"initX",0);W(this,"initY",0);W(this,"indicator");W(this,"container");W(this,"originalEvent");W(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Ut,Ht,mt,Mo,Ao,Bo;const Ne=class Ne extends Sn{constructor(t={}){var l,o,s;super();je(this,mt);W(this,"context",null);W(this,"selector");W(this,"scale");W(this,"onResizeStart");je(this,Ut);je(this,Ht);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??K.PAGE,element:((o=t.selector)==null?void 0:o.element)??K.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??K.RESIZEABLE_INDICATOR},this.onResizeStart=Be(this,mt,Mo).bind(this),vt(this,Ut,Be(this,mt,Ao).bind(this)),vt(this,Ht,Be(this,mt,Bo).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",Ae(this,Ut)),window.removeEventListener("pointerup",Ae(this,Ht)),this.context=null}};Ut=new WeakMap,Ht=new WeakMap,mt=new WeakSet,Mo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Pe.warn(Ne.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,to);if(o==null)return Pe.warn(Ne.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return Pe.warn(Ne.TAG_NAME,"未找到的可调整元素");const r=so(s,this.selector.container);this.context=new Fp({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Pe.warn(Ne.TAG_NAME,"已取消调整");if(this.context.container==null)return Pe.warn(Ne.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const a=this.createEvent("resizestart",this.context);if(this.dispatch(a).defaultPrevented)return Pe.warn(Ne.TAG_NAME,"已取消调整");window.addEventListener("pointermove",Ae(this,Ut)),window.addEventListener("pointerup",Ae(this,Ht))},Ao=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&tn.TOP){const u=Math.max((i.bottom-t.clientY)/s,Ne.MIN_LENGTH);l.top=(i.bottom-r.top)/s-u,l.height=u}if(o&tn.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Ne.MIN_LENGTH)),o&tn.LEFT){const u=Math.max((i.right-t.clientX)/s,Ne.MIN_LENGTH);l.left=(i.right-r.left)/s-u,l.width=u}o&tn.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Ne.MIN_LENGTH));const a=this.createEvent("resizing",l);this.dispatch(a).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},Bo=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},W(Ne,"TAG_NAME","quickprint-resizeable"),W(Ne,"MIN_LENGTH",12);let ol=Ne;async function zp(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?Bt(e.width):Math.round(e.width),o=t?Bt(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-io(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function Up(n){const e=new ol({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,Ge);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(zp(n,l),Ln.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),Ln.clean()}),n.onResizeStart=e.onResizeStart,e}function Hp(n){function e(r){const i=document.activeElement,a=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||a.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===ue.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===ue.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||ds()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowUp"?-1:1,u=i.map(c=>c.setTop(c.top+a,!0)?c:null).filter(c=>c!=null);u.length>0&&n.replaceSnapshot("top",u);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowLeft"?-1:1,u=i.map(c=>c.setLeft(c.left+a,!0)?c:null).filter(c=>c!=null);u.length>0&&n.replaceSnapshot("left",u);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const a=n.doc.pages.reduce((u,c)=>u.concat(c.children),[]);return n.multiSelectElements(a)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const a=t();for(const u of i)u.setLeft(u.left+8),u.setTop(u.top+8),a.append(u);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const fn="openprint:element,";function Gp(n){function e(){return navigator.clipboard.readText().catch(a=>(console.log(a),null))}function t(a){return navigator.clipboard.writeText(a).catch(u=>{console.log(u)})}async function l(){const a=await e();if(a==null||!a.startsWith(fn))return[];t("");const u=Rn(ps(a.slice(fn.length)),[]);return u.length===0?[]:u.map(c=>(delete c.id,me.create(c))).sort(me.sort)}function o(a){const u=`${fn}${fs(JSON.stringify(a))}`;return t(u)}async function s(){const a=await e();return typeof a=="string"&&a.startsWith(fn)}function r(){}function i(a){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const $o=Symbol();function Wp(){return{panel:{left:!0,right:!0},scale:100,selectedType:ue.NONE,selectedPage:void 0,selectMode:tt.SINGLE,selected:[]}}function Yp(n,e){const t=xe(Wp()),l=Vp(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:a,selectPage:g,selectElement:v,resetSelectedElement:_,deleteSelectedElement:y,multiSelectElements:d,isSingleSelectedElement:$,isNoSelectedElement:M,zoomIn:E,zoomOut:h,toggleBackground:x,toggleElementPanel:I,toggleConfigPanel:O,getSelectedElements:u,getSelectedPage:c,cleanup:q,replaceSnapshot:k},r=Dp(s),i=Up(s);s.shortcut=Hp(s),s.createSnapshot=l.createSnapshot,s.clipboard=Gp();function a(L){s.document.value=L,s.history.createSnapshot()}function u(L){if(s.state.selectedType!==ue.ELEMENT)return[];const A=t.selected;if(A.length==0)return[];const D=A.map(B=>s.doc.findElement(B)).filter(B=>B!=null);return L==null?D:D.filter(B=>L.contains(B))}function c(){var A;const L=t.selectedPage;if(L!=null)return(A=n.value)==null?void 0:A.findPage(L)}function g(L){return _(),t.selectedPage=L.id,t.selectedType=ue.PAGE,!0}function v(L){t.selectMode=tt.SINGLE,t.selectedType=ue.ELEMENT,t.selectedPage=void 0;const A=u();for(const D of A)D.id!==L.id&&D.blur();return L.focus(),t.selected=[L.id],!0}function _(){const L=u();for(const A of L)A.blur();return t.selected=[],t.selectedType=ue.NONE,!0}function y(){if(t.selectedType!=ue.ELEMENT||t.selected.length==0)return!1;let L=!1;const A=u();for(const D of A)D.remove()&&(L=!0);return L&&s.history.createSnapshot(),!0}function d(L){t.selectMode=tt.MULTIPLE,t.selectedType=ue.ELEMENT,t.selectedPage=void 0;const A=u();for(const D of A)D.blur();for(const D of L)D.focus();return t.selected=L.map(D=>D.id),!0}function h(){const L=t.scale??100,A=Kt.indexOf(L);return A<0?(t.scale=100,!1):A>=Kt.length-1?!1:(t.scale=Kt[A+1],!0)}function E(){const L=t.scale??100,A=Kt.indexOf(L);return A<0?(t.scale=100,!1):A==0?!1:(t.scale=Kt[A-1],!0)}function x(){const A=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=A}function I(){s.state.panel.left=!s.state.panel.left}function O(){s.state.panel.right=!s.state.panel.right}function k(L,A){const D=A??s.doc,B=Array.isArray(D)?"element":D instanceof _e?"document":D instanceof Nt?"page":"element",S=Array.isArray(D)?D.map(w=>w.id).join(","):D.id,R=`${B}:${S}:${L}`;return l.replaceSnapshot({action:R})}function $(){return s.state.selectedType!==ue.ELEMENT?!1:s.state.selectMode==tt.SINGLE||s.state.selectMode==tt.MULTIPLE&&s.state.selected.length==1}function M(){return s.state.selectedType!==ue.ELEMENT?!0:s.state.selected.length==0}function q(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),Kl($o,s),cl(q),s}function Re(){return Zl($o)}const jp=z({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Ce("classes"),l=Re(),o=C(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=C(()=>{const d=e.page.id,h=l.doc.pages.find(E=>E.id===d);return h==null?0:e.direction=="horizontal"?h.width:h.height}),r=C(()=>{const d=s.value,h=[];for(let E=0;E<=d;E+=10)h.push(E/10);return h}),i=C(()=>{const d=s.value,h=[];for(let E=0;E<=d;E+=2.5)h.push(E);return h}),a=C(()=>{const d=l.getSelectedElements();return d.length==1?d[0]:null}),u=C(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),c=C(()=>{const d=a.value;if(d==null)return 0;if(d.type==="TableCell"){const h=d.parent;if(h==null)return 0;const E=h.parent;return h==null?0:E.top+h.offsetTop}if(d.type==="TableRow"){const h=d.parent;return h==null?0:h.top+d.offsetTop}return d.top}),g=C(()=>{const d=a.value;if(d==null)return 0;if(d.type==="TableCell"){const h=d.parent;if(h==null)return 0;const E=h.parent;return h==null?0:E.left+d.offsetLeft}if(d.type==="TableRow"){const h=d.parent;return h==null?0:h.left}return d.left});function v(d,h){return e.direction==="horizontal"?{left:d*(e.scale/100)+"mm",height:(h-2)%4==0?"8px":"4px"}:{top:d*(e.scale/100)+"mm",width:(h-2)%4==0?"8px":"4px"}}function _(d){return e.direction==="horizontal"?{left:d*(e.scale/100)+"cm"}:{top:d*(e.scale/100)+"cm"}}function y(d){return e.direction==="horizontal"?{left:g.value*(e.scale/100)+"px",width:d.width*(e.scale/100)+"px",height:"100%"}:{top:c.value*(e.scale/100)+"px",height:d.height*(e.scale/100)+"px",width:"100%"}}return(d,h)=>(T(),N("div",{class:m(o.value)},[f("div",{class:m(b(t).ruler),style:X(u.value)},[a.value?(T(),N("div",{key:0,class:m(b(t).selected),style:X(y(a.value))},null,6)):Y("",!0),(T(!0),N(ne,null,ce(i.value,(E,x)=>(T(),N("div",{key:E,class:m(b(t).scale),style:X(v(E,x))},null,6))),128)),(T(!0),N(ne,null,ce(r.value,E=>(T(),N("div",{class:m(b(t).number),style:X(_(E))},Z(E),7))),256))],6)],2))}}),Xp="_horizontalRuler_170u5_2",Zp="_verticalRuler_170u5_15",Kp="_ruler_170u5_27",Jp="_scale_170u5_32",Qp="_number_170u5_46",em="_selected_170u5_71",tm={horizontalRuler:Xp,verticalRuler:Zp,ruler:Kp,scale:Jp,number:Qp,selected:em},nm={classes:tm},ql=H(jp,[["__cssModules",nm]]),lm=["title"],pn=8,om=z({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=Ce("classes"),s={},r=Re(),i=C(()=>({top:Math.round(t.top*t.zoom)+"px"}));function a(v){if(v.button!=0||t.disabled===!0)return;const _=v.target.closest("."+o.dragLine);_!=null&&(v.stopPropagation(),s.init=!1,s.target=_,s.parent=_.offsetParent,s.target.setPointerCapture(v.pointerId),window.addEventListener("pointermove",u),window.addEventListener("pointerup",c))}function u(v){v.preventDefault();const _=g(s.parent);let y=v.clientY-_.top;y<0&&(y=0),y>_.height&&(y=_.height),t.min>0&&y<t.min+pn&&(y=t.min+pn),t.max>0&&y>t.max-pn&&(y=t.max-pn),s.target.style.top=y/(r.state.scale/100)+"px",s.top=y,s.init=!0}function c(v){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(v.pointerId),window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",c)}function g(v){return v instanceof HTMLElement?v.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(v,_)=>(T(),N("div",{class:m({[b(o).dragLine]:!0,[b(o).disabled]:n.disabled}),style:X(i.value),onPointerdown:se(a,["stop"]),title:n.title},null,46,lm))}}),sm="_dragLine_1m7rt_2",im="_disabled_1m7rt_26",rm={dragLine:sm,disabled:im},am={classes:rm},Pl=H(om,[["__cssModules",am]]),cm=z({__name:"Selection",setup(n,{expose:e}){const t=pe(),l=pe(),o=Yt("selectionRef"),s=pe(),r=Re();let i=[];function a(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function u(){const y=[],d=l.value;if(d==null)return y;const h=c(d);if(h.length==0)return y;const E=o.value;return h.forEach(x=>{if(!Ps(x,E)){x.classList.remove(K.SELECTED);return}const I=Reflect.get(x,Ge);I instanceof me&&(x.classList.add(K.SELECTED),y.push(I))}),y}function c(y){if(y.matches("."+K.ELEMENT)){const d=Reflect.get(y,Ge);if(d&&d.type===J.TABLE)return y.querySelectorAll(":scope td")}return y.querySelectorAll(`:scope .${K.PAGE} > .${K.SELECTABLE}`)}function g(y,d){const h=d.closest("."+K.PAPER);if(h==null)return;y.stopPropagation(),y.preventDefault();const E=a(),x=h.getBoundingClientRect();E.initialX=y.clientX,E.initialY=y.clientY,E.top=y.clientY-x.top,E.left=y.clientX-x.left,l.value=d,s.value=E,t.value=h,i=[],window.addEventListener("pointermove",v),window.addEventListener("pointerup",_)}function v(y){const d=s.value;if(d==null)return;y.stopPropagation(),y.preventDefault();const h=o.value;if(d.init!==!0){if(Math.abs(y.clientX-d.initialX)<4&&Math.abs(y.clientY-d.initialY)<4)return;h.setPointerCapture(y.pointerId),h.style.display="block",d.init=!0}const E=Math.abs(y.clientX-d.initialX),x=Math.abs(y.clientY-d.initialY),I=y.clientX<d.initialX?-E:0,O=y.clientY<d.initialY?-x:0;h.style.top=d.top+O+"px",h.style.left=d.left+I+"px",h.style.width=E+"px",h.style.height=x+"px",i=u()}function _(y){const d=s.value;if(d==null)return;d.init&&(y.stopPropagation(),y.preventDefault()),i.length>0&&r.multiSelectElements(i);const h=o.value;h.releasePointerCapture(y.pointerId),h.style.display="none",s.value=void 0,window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",_)}return e({onSelectStart:g}),(y,d)=>(T(),N("div",{ref_key:"selectionRef",ref:o,class:m(y.classes.selection),onClick:d[0]||(d[0]=se(()=>{},["stop"]))},null,2))}}),um="_selection_10jfe_2",dm={selection:um},fm={classes:dm},pm=H(cm,[["__cssModules",fm]]);function mm(n){return xe({style:Cn(n.style??{})})}function gm(n,e){n.style=Object.assign({},n.style,e.style)}const hm=De(function(n){return gt("元素",(e,t)=>p(Pn,{options:mm(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>gm(n,e)).catch(Me)});function vm(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){hm(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},hl(t,e.element)),Nn.open(n.clientX,n.clientY,{menus:l})}const bm=z({props:{element:{type:me,required:!0}},setup(n){const e=Ce("classes"),t=Re(),l=C(()=>{n.element.state.key;const g=n.element,v={"--quickprint-element-top":g.top+"px","--quickprint-element-left":g.left+"px","--quickprint-element-width":g.width+"px","--quickprint-element-height":g.height+"px","z-index":g.zIndex};return r()&&(v.transform=`rotate(${g.style.rotate}deg)`),v}),o={TOP:[e.resizeTop,At.TOP],BOTTOM:[e.resizeBottom,At.BOTTOM],LEFT:[e.resizeLeft,At.LEFT],RIGHT:[e.resizeRight,At.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,At.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const g=n.element;return g.style.rotate==0||g.style.rotate==null?!1:t.state.selectMode===tt.SINGLE?!g.isSelected:!0}function i(g){const v=vp(g.type);if(v==null)return p("div",{class:e.unknown},[p("span",null,[ie("未知的打印元素")])]);const _={element:g,key:g.id+"_"+g.state.key};return _p(g.type)?(_.onContextmenu=u,ft(v,_)):ft(v,_)}function a(g,v){v.stopPropagation();const _=v.target.closest("."+K.ELEMENT);_&&Reflect.get(_,On)===fl.DRAG_ELEMENT||t.selectElement(g)}function u(g){g.stopPropagation(),g.preventDefault(),vm(g,n,t)}function c(){return!Ep(n.element.type)||r()?null:s.map(g=>{const v={class:[K.RESIZEABLE_INDICATOR,g[0]],["."+to]:g[1]};return p("div",Rs(v,{onPointerdown:t.onResizeStart}),null)})}return function(){const g=n.element,v={["."+Ge]:g,["."+dl]:g.type,id:g.id,key:g.id,class:{[K.ELEMENT]:!0,[K.DRAGGABLE]:!0,[K.RESIZEABLE]:!0,[K.SELECTED]:g.state.selected,[K.SELECTABLE]:yp(g.type),["quickprint-is-"+g.type.toLowerCase()]:!0},style:l.value,onClick:a.bind(null,g)};return p("div",v,[i(g),c()])}}}),ym="_unknown_za8zh_2",_m="_resizeTop_za8zh_12",Em="_resizeBottom_za8zh_20",Tm="_resizeLeft_za8zh_28",Sm="_resizeRight_za8zh_36",Rm="_resizeBottomRight_za8zh_44",wm={unknown:ym,resizeTop:_m,resizeBottom:Em,resizeLeft:Tm,resizeRight:Sm,resizeBottomRight:Rm},km={classes:wm},Cm=H(bm,[["__cssModules",km]]),qo=Gl(()=>Wl(()=>import("./component-DFsXG4iY.js"),__vite__mapDeps([2,3,1,4,5]))),Lm=z({__name:"DocJson",props:{doc:{type:_e,required:!0}},setup(n){const e=n,t=st(),l=de(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(T(),Q(b(qo),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),Im="_json_9crpe_2",Nm={json:Im},Om={classes:Nm},xm=H(Lm,[["__cssModules",Om]]),Dm=De(function(n){return dt("调试",p(xm,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(Je)});async function Mm(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+K.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const a=r.getBoundingClientRect(),u=n.clientX-a.left-i[0].left,c=n.clientY-a.top-i[0].top;for(const g of i)g.setLeft(g.left+u),g.setTop(g.top+c),e.page.append(g);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){Dm(t).then(r=>{if(r==null)return;const i=_e.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),Nn.open(n.clientX,n.clientY,{menus:l})}const Am=z({props:{doc:{type:_e,required:!0},page:{type:Nt,required:!0}},setup(n){const e=Ce("classes"),t=Re(),l=Yt("selectionRef"),o=Yt("paperRef"),s=de(0),r=C(()=>n.page.width),i=C(()=>n.page.height);function a(x){x.stopPropagation();const I=x.target.closest("."+K.PAPER);I&&Reflect.get(I,On)===fl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function u(){if(n.page.header.display===!1)return null;const x=n.page.header.height,I="page_header_"+s.value;return p(Pl,{title:"页眉",top:x,onMove:g,key:I},null)}function c(){if(n.page.footer.display===!1)return null;const x=Gt(i.value)-n.page.footer.height,I="page_footer_"+s.value;return p(Pl,{title:"页脚",top:x,onMove:v,key:I},null)}function g(x){n.page.setHeaderHeight(x.top),s.value++}function v(x){n.page.setFooterHeight(Gt(i.value)-x.top),s.value++}function _(x){x.stopPropagation(),x.preventDefault(),Mm(x,n,t)}function y(){const x=n.doc.margins;if(x==null)return null;const I=[];return x.top&&I.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:x.top+"px"}},null)),x.bottom&&I.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:x.bottom+"px"}},null)),x.left&&I.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:x.left+"px"}},null)),x.right&&I.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:x.right+"px"}},null)),I.length>0?I:null}function d(){const x={["."+eo]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[K.PAGE]:!0,[K.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:_},I=n.page.children.map(O=>p(Cm,{element:O},null));return p("div",x,[u(),I,c(),y()])}function h(x){if(x.button!==0)return;x.stopPropagation(),x.preventDefault();const O=x.target.closest("."+K.ELEMENT);if(O==null)return E(x,o.value);const k=Reflect.get(O,Ge);return k==null?E(x,o.value):k.type===J.TABLE?E(x,O):Tp(k.type)?t.onDragStart(x):E(x,o.value)}function E(x,I){var O;(O=l.value)==null||O.onSelectStart(x,I)}return function(){const x=t.state.scale/100,I={id:"@"+n.page.id,ref:"paperRef",class:{[K.PAPER]:!0,[K.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*x+"mm",height:i.value*x+"mm"},onPointerdown:h,onClick:a};return p("div",I,[d(),p(pm,{ref:"selectionRef"},null)])}}}),Bm="_paper_fdphx_2",$m="_grid_fdphx_12",qm="_marginHorizontalGuide_fdphx_21",Pm="_marginVerticalGuide_fdphx_29",Vm={paper:Bm,grid:$m,marginHorizontalGuide:qm,marginVerticalGuide:Pm},Fm={classes:Vm},zm=H(Am,[["__cssModules",Fm]]),Um={class:"quickprint-is-fill-h quickprint-is-scrollable"},Hm="icon-zhanweifu",Gm=z({__name:"Element",setup(n){const e=Re();return(t,l)=>(T(),N("div",{class:m(t.classes.panel)},[f("div",{class:m(t.classes.header)},"可打印元素",2),f("div",Um,[f("div",{class:m(t.classes.grid)},[(T(!0),N(ne,null,ce(b(pp),o=>(T(),N("div",Jl({key:o.type,class:[b(K).DRAGGABLE,t.classes.element],[`.${b(Ql)||""}`]:b(qe).INSERT,[`.${b(dl)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>b(e).onDragStart&&b(e).onDragStart(...s))}),[p(b(U),{icon:o.icon??Hm,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),f("span",null,Z(o.title),1)],48))),128))],2)])],2))}}),Wm="_panel_1p36j_2",Ym="_header_1p36j_8",jm="_grid_1p36j_18",Xm="_element_1p36j_30",Zm="_icon_1p36j_45",Km={panel:Wm,header:Ym,grid:jm,element:Xm,icon:Zm},Jm={classes:Km},Qm=H(Gm,[["__cssModules",Jm]]),eg=["onClick"],tg=z({__name:"SelectPath",setup(n){const e=Re(),t=C(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===ue.PAGE){const i=e.getSelectedPage();if(i!=null){const a="页面"+(i.index+1);r.push({id:i.id,title:a,type:"page",data:i})}return r}if(s.selectedType===ue.ELEMENT){if(s.selectMode===tt.MULTIPLE){const u=e.getSelectedElements();if(u.length===0)return r;let c=u[0];for(;c.parent;){const g=c.parent;if(g instanceof Nt){const v="页面"+(g.index+1);return r.push({id:g.id,title:v,type:"page",data:g}),r}c=g}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const a=[{id:i.id,title:sn(i.type),type:"element",data:i}];for(;i.parent;){const u=i.parent;if(u instanceof Nt){const c="页面"+(u.index+1);return a.unshift({id:u.id,title:c,type:"page",data:u}),r.concat(a)}a.unshift({id:u.id,title:sn(u.type),type:"element",data:u}),i=u}}return r}),l=C(()=>{if(e.state.selectedType!=ue.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],a=pl(i,e.doc.ds);if(!(a==null||!a.content))return a.type===Ee.VARIABLE||a.type===Ee.FORMULA?`[${a.content}]`:a.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(T(),N("div",{class:m(s.classes.paths)},[(T(!0),N(ne,null,ce(t.value,(i,a)=>(T(),N(ne,{key:i.id},[a>0?(T(),Q(b(U),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):Y("",!0),f("div",{class:m(s.classes.path),onClick:u=>o(i)},Z(i.title),11,eg)],64))),128)),l.value?(T(),N(ne,{key:0},[p(b(U),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),f("div",{class:m(s.classes.content)},Z(l.value),3)],64)):Y("",!0)],2))}}),ng="_paths_fuk62_2",lg="_path_fuk62_2",og="_icon_fuk62_28",sg="_content_fuk62_33",ig={paths:ng,path:lg,icon:og,content:sg},rg={classes:ig},ag=H(tg,[["__cssModules",rg]]),cg=["min","readonly","placeholder"],ug=z({__name:"LabelNumber",props:Ot({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=rn(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const a=e.min?e.min:e.defaultValue;t.value=a;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const a=Math.pow(10,e.precision);t.value=Math.round(i*a)/a}}return(o,s)=>(T(),N("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[Te(f("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,cg),[[Oe,t.value]]),f("span",{class:m(o.classes.label)},Z(n.label),3)],2))}}),dg="_labelNumber_1aifb_2",fg="_label_1aifb_2",pg="_readonly_1aifb_25",mg={labelNumber:dg,label:fg,readonly:pg},gg={classes:mg},qt=H(ug,[["__cssModules",gg]]),hg={class:"quickprint-config"},vg={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},bg={class:"quickprint-config-group"},yg={class:"quickprint-config-section quickprint-config-inline"},_g={class:"quickprint-config-content quickprint-config-inline"},Eg={class:"quickprint-config-group"},Tg={class:"quickprint-config-section quickprint-config-inline"},Sg={class:"quickprint-config-content quickprint-config-inline"},Rg={class:"quickprint-config-section quickprint-config-inline"},wg={class:"quickprint-config-content quickprint-form-inline"},kg={class:"quickprint-config-group"},Cg={class:"quickprint-config-section quickprint-config-inline"},Lg={class:"quickprint-config-content quickprint-form-inline"},Ig={key:0,class:"quickprint-config-section quickprint-config-inline"},Ng={class:"quickprint-config-content quickprint-form-inline"},Og={class:"quickprint-config-section quickprint-config-inline"},xg={class:"quickprint-config-content quickprint-form-inline"},Dg=z({__name:"PageConfig",props:{page:{type:Nt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=[{label:"禁止",value:un.NONE},{label:"跟随表格",value:un.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],o=C({get(){return e.page.size.type},set(u){e.page.size.type=u,u===ln.CONTENT&&(e.page.size.orientation=void 0)}}),s=C({get(){return e.page.orientation},set(u){e.page.size.orientation=u}}),r=C(()=>e.page.width),i=C({get(){return e.page.height},set(u){const c=Number(u);!al(c)||c<0||(e.page.size.height=c)}}),a=C({get(){return e.page.footer.flow??un.NONE},set(u){e.page.footer.flow=u===un.NONE?void 0:u}});return(u,c)=>(T(),N("div",hg,[c[15]||(c[15]=f("div",{class:"quickprint-config-title"},"页面配置",-1)),f("div",vg,[f("div",bg,[c[7]||(c[7]=f("div",{class:"quickprint-config-group-title"},"页眉",-1)),f("section",yg,[c[6]||(c[6]=f("header",{class:"quickprint-config-header"},"位置",-1)),f("div",_g,[p(qt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p($t,{modelValue:n.page.header.display,"onUpdate:modelValue":c[0]||(c[0]=g=>n.page.header.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),f("div",Eg,[c[10]||(c[10]=f("div",{class:"quickprint-config-group-title"},"页脚",-1)),f("section",Tg,[c[8]||(c[8]=f("header",{class:"quickprint-config-header"},"位置",-1)),f("div",Sg,[p(qt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p($t,{modelValue:n.page.footer.display,"onUpdate:modelValue":c[1]||(c[1]=g=>n.page.footer.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",Rg,[c[9]||(c[9]=f("header",{class:"quickprint-config-header"},"跟随",-1)),f("div",wg,[p(b(le),{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=g=>a.value=g),options:l},null,8,["modelValue"])])])]),f("div",kg,[c[14]||(c[14]=f("div",{class:"quickprint-config-group-title"},"画布",-1)),f("section",Cg,[c[11]||(c[11]=f("header",{class:"quickprint-config-header"},"尺寸",-1)),f("div",Lg,[p($t,{modelValue:o.value,"onUpdate:modelValue":c[3]||(c[3]=g=>o.value=g),options:b(Ms),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===b(ln).CONTENT?(T(),N("section",Ig,[c[12]||(c[12]=f("header",{class:"quickprint-config-header"},"内容",-1)),f("div",Ng,[p(qt,{class:"quickprint-form-inline-item",label:"宽",modelValue:r.value,readonly:""},null,8,["modelValue"]),p(qt,{class:"quickprint-form-inline-item",label:"高",modelValue:i.value,"onUpdate:modelValue":c[4]||(c[4]=g=>i.value=g)},null,8,["modelValue"])])])):Y("",!0),f("section",Og,[c[13]||(c[13]=f("header",{class:"quickprint-config-header"},"方向",-1)),f("div",xg,[p($t,{modelValue:s.value,"onUpdate:modelValue":c[5]||(c[5]=g=>s.value=g),class:"quickprint-w-full",options:b(oo),disabled:n.page.size.type===b(ln).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),Mg=["value","placeholder"],Ag=z({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=Yt("inputRef"),s=C({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?El(t.modelValue):t.standard==="mm"&&t.target==="px"?Gt(t.modelValue):0},set(c){if(t.standard===t.target)return l("update:modelValue",c);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Gt(c));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",El(c))}}),r=C(()=>t.clearable&&s.value!=null);function i(c){const v=c.target.value;if(s==null||v===""){if(t.clearable)return;const y=t.min?t.min:t.defaultValue;s.value=y;return}const _=Number(v);if(!Number.isNaN(_)){if(t.min!=null&&_<t.min){s.value=t.min;return}if(t.standard==="px"){s.value=Math.round(_);return}s.value=_}}function a(){l("update:modelValue",void 0)}function u(){var c;(c=o.value)==null||c.blur(),setTimeout(()=>{var g;return(g=o.value)==null?void 0:g.focus()},50)}return(c,g)=>(T(),N("label",{class:m({[c.classes.inputUnit]:!0,[c.classes.withClear]:n.clearable})},[f("span",{class:m(c.classes.label)},Z(n.label),3),f("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",value:s.value,placeholder:n.placeholder,onBlur:i,onKeydown:Xl(u,["enter"])},null,40,Mg),r.value?(T(),N("span",{key:0,class:m(c.classes.clearBtn),onClick:se(a,["stop"])},[p(b(U),{icon:"icon-close",size:"11px"})],2)):Y("",!0)],2))}}),Bg="_inputUnit_2ymft_2",$g="_clearBtn_2ymft_7",qg="_label_2ymft_11",Pg="_withClear_2ymft_31",Vg={inputUnit:Bg,clearBtn:$g,label:qg,withClear:Pg},Fg={classes:Vg},ut=H(Ag,[["__cssModules",Fg]]),zg=z({__name:"UnitSelect",props:Ot({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=rn(n,"modelValue"),o=C(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(T(),N("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(b(le),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:ke(()=>[f("span",{class:m(s.classes.text)},Z(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),Ug="_unit_135mn_2",Hg="_text_135mn_8",Gg="_select_135mn_25",Wg={unit:Ug,text:Hg,select:Gg},Yg={classes:Wg},Po=H(zg,[["__cssModules",Yg]]),jg=z({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=de(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch(ms)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(T(),N("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[p(b(U),{icon:"icon-copy"}),p(ws,{name:"quickprint-fade"},{default:ke(()=>[l.value?(T(),N("span",{key:0,class:m(s.classes.message)},"已复制",2)):Y("",!0)]),_:1})],2))}}),Xg="_btn_v9scw_2",Zg="_message_v9scw_6",Kg={btn:Xg,message:Zg},Jg={classes:Kg},Qg=H(jg,[["__cssModules",Jg]]),eh=z({__name:"window",props:{code:{type:String,default:""},doc:{type:_e,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=st(),l=de(e.code),o=pe();function s(){return l.value}function r(){e.doc!=null&&uc({doc:e.doc}).then(g=>{var _;if(g==null)return;const v=g.type=="reference"?`[=${g.value}]`:`[${g.value}]`;(_=o.value)==null||_.insert(v)})}function i(g){var v;return ot(g,(v=e.doc)==null?void 0:v.ds)}function a(){var g;(g=o.value)==null||g.insert(`[2.6.${sl.ELEMENT_VALUR}]`)}function u(){dc().then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}function c(){fc({doc:e.doc}).then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}return t==null||t.useHandle("confirm",s),(g,v)=>(T(),N("div",{class:m(g.classes.window)},[n.mode!=="code"?(T(),N("div",{key:0,class:m(g.classes.toolbar)},[n.mode=="condition"?(T(),N(ne,{key:0},[f("button",{type:"button",class:"quickprint-text-btn",onClick:a},[p(b(U),{icon:"icon-number-sign"}),v[1]||(v[1]=f("span",null,"插入元素值",-1))]),f("div",{class:m(g.classes.divider)},null,2)],64)):Y("",!0),f("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[p(b(U),{icon:"icon-insert-var"}),v[2]||(v[2]=f("span",null,"插入变量",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:u},[p(b(U),{icon:"icon-function"}),v[3]||(v[3]=f("span",null,"插入函数",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:c},[p(b(U),{icon:"icon-formula"}),v[4]||(v[4]=f("span",null,"插入公式",-1))])],2)):Y("",!0),p(b(qo),{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=_=>l.value=_),language:"javascript",class:m(g.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),th="_window_n935p_2",nh="_toolbar_n935p_11",lh="_code_n935p_22",oh="_divider_n935p_27",sh={window:th,toolbar:nh,code:lh,divider:oh},ih={classes:sh},Vo=H(eh,[["__cssModules",ih]]),Fo=De(function(n){return dt("公式",p(Vo,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Me)}),rh=De(function(n,e){return dt(n,p(Vo,{code:e},null),{preset:"editor"}).promisify().catch(Me)}),ah={class:"quickprint-config-section quickprint-config-inline"},ch={class:"quickprint-config-content"},uh=["value"],dh=z({__name:"Visibility",props:{element:{type:me,required:!0}},setup(n){const e=n,t=C({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??Ct.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==Ct.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=C({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=C(()=>{var i;return ml((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=C(()=>{var i;return t.value!==Ct.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${sl.ELEMENT_VALUR}]`;Fo({code:i,doc:e.element.doc,mode:"condition"}).then(a=>{a!=null&&(l.value=a)})}return(i,a)=>(T(),N(ne,null,[f("section",ah,[a[1]||(a[1]=f("header",{class:"quickprint-config-header"},"可见性",-1)),f("div",ch,[p(b(le),{class:"quickprint-w-full",options:b(Ls),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=u=>t.value=u)},null,8,["options","modelValue"])])]),t.value===b(Ct).CONDITION?(T(),N("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[f("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,uh),s.value?(T(),Q(b(U),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2)):Y("",!0)],64))}}),fh="_condition_siopf_2",ph={condition:fh},mh={classes:ph},gh=H(dh,[["__cssModules",mh]]);function hh(n){return C({get(){return n.element.attributes.position??En.DEFAULT},set(e){const t=e===En.DEFAULT?void 0:e;n.element.attributes.position=t}})}function vh(n){return C({get(){return n.element.attributes.printMode??Tn.ONCE},set(e){const t=e===Tn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function bh(n){return C({get(){return n.element.attributes.overflow??on.HIDDEN},set(e){const t=e===on.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function yh(n){return C({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function _h(n){return C({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function Eh(n){return C({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function Th(n){return C({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const Sh=z({__name:"Const",props:{element:{type:me,required:!0}},setup(n){const e=n,t=C({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,o)=>Te((T(),N("textarea",{"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Oe,t.value]])}}),Rh={class:"quickprint-config-ds-var-type"},wh=["title"],kh=z({__name:"Variable",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Re(),l=C(()=>ae(e.element.ds.value)),o=C(()=>ot(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var c;const i=await gl({doc:t.doc,value:e.element.ds.value}).catch(Je);if(i==null||(e.element.setDataSource(Ee.VARIABLE,i.value),e.element.type!=J.TABLE_CELL||i.type!=="ds"))return;const a=e.element.parent;if(a==null||a.isBindVariable||((c=i.parent)==null?void 0:c.type)!==oe.ARRAY)return;const u=i.parent;a.setDataSource(Ee.VARIABLE,`${Lt.DS}.${u.type}.${u.name}`)}return(i,a)=>(T(),N("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(T(),N(ne,{key:0},[a[0]||(a[0]=f("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(b(U),{icon:"icon-open-new",size:"14px"})],64)):(T(),N(ne,{key:1},[f("span",Rh,"<"+Z(b(Ur)(e.element.ds.value))+">",1),f("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},Z(o.value),9,wh),f("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[p(b(U),{icon:"icon-close",size:"12px"})])],64))]))}}),Ch=["value"],Lh=z({__name:"Code",props:{element:{type:me,required:!0}},setup(n){const e=n,t=C(()=>ae(e.element.ds.value));function l(){return rl(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){rh("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(T(),N("div",{onClick:o,class:m(s.classes.code)},[f("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Ch),t.value?(T(),Q(b(U),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2))}}),Ih="_code_1az68_2",Nh={code:Ih},Oh={classes:Nh},xh=H(Lh,[["__cssModules",Oh]]),Dh=["value"],Mh=z({__name:"Formula",props:{element:{type:me,required:!0}},setup(n){const e=n,t=Re(),l=C(()=>ae(e.element.ds.value)),o=C(()=>ml(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;Fo({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(T(),N("div",{onClick:s,class:m(r.classes.code)},[f("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Dh),l.value?(T(),Q(b(U),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2))}}),Ah="_code_ipm2q_2",Bh={code:Ah},$h={classes:Bh},qh=H(Mh,[["__cssModules",$h]]);function Ph(n){switch(n.ds.type){case Ee.CONST:return p(Sh,{element:n},null);case Ee.VARIABLE:return p(kh,{element:n},null);case Ee.CODE:return p(xh,{element:n},null);case Ee.FORMULA:return p(qh,{element:n},null);default:return null}}const Vh=z({props:{element:{type:me,required:!0}},setup(n){const e=C(()=>sn(n.element.type)),t=C(()=>xs.filter(I=>I.value!=n.element.type)),l=de("px"),o=yh(n),s=_h(n),r=bh(n),i=hh(n),a=vh(n),u=Eh(n),c=Th(n),g=C(()=>{const I=n.element,O=I.parent;if(O===null||!(O instanceof Nt))return!1;const k=O.header;if(k.display&&I.bottom<=(k.height??0))return!1;const $=O.parent;if($==null)return!1;const M=O.footer;return!(M.display&&I.top>=Math.floor(Gt($.paper.height))-(M.height??0))});function v(I,O){return O==null?!1:!!O.includes(I)}function _(){const I=Qt(n.element.type);if(v(fe.LAYOUT,I==null?void 0:I.exclude))return null;const O=n.element,k=v(fe.COORD,I==null?void 0:I.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(ut,{class:"quickprint-form-inline-item",label:"左",modelValue:O.left,"onUpdate:modelValue":D=>O.left=D,target:l.value},null),p(ut,{class:"quickprint-form-inline-item",label:"上",modelValue:O.top,"onUpdate:modelValue":D=>O.top=D,target:l.value},null)])]),$=v(fe.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[ie("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(ut,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,"onUpdate:modelValue":D=>o.value=D,target:l.value},null),p(ut,{class:"quickprint-form-inline-item",label:"高",modelValue:s.value,"onUpdate:modelValue":D=>s.value=D,target:l.value},null)])]),M=v(fe.VISIBILITY,I==null?void 0:I.exclude)?null:p(gh,{element:O},null),q=v(fe.OVERFLOW,I==null?void 0:I.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("溢出时")]),p("div",{class:"quickprint-config-content"},[p(le,{modelValue:r.value,"onUpdate:modelValue":D=>r.value=D,options:$s,class:"quickprint-w-full"},null)])]),L=v(fe.PRINT_MODE,I==null?void 0:I.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[ie("打印模式")]),p("div",{class:"quickprint-config-content"},[p(le,{modelValue:a.value,"onUpdate:modelValue":D=>a.value=D,options:Bs,class:"quickprint-w-full"},null)])]),A=v(fe.POSITION,I==null?void 0:I.exclude)||!g.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("定位模式")]),p("div",{class:"quickprint-config-content"},[p(le,{modelValue:i.value,"onUpdate:modelValue":D=>i.value=D,options:As,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[ie("布局")]),p("span",null,[ie("单位：")]),p(Po,{modelValue:l.value,"onUpdate:modelValue":D=>l.value=D},null)]),k,$,M,q,L,A])}function y(){const I=Qt(n.element.type);if(v(fe.BASIC,I==null?void 0:I.exclude))return null;const O=n.element,k=v(fe.PREFIX,I==null?void 0:I.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("前缀")]),p("div",{class:"quickprint-config-content"},[Te(p("input",{"onUpdate:modelValue":q=>O.attributes.prefix=q,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Oe,O.attributes.prefix]])])]),$=v(fe.SUFFIX,I==null?void 0:I.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("后缀")]),p("div",{class:"quickprint-config-content"},[Te(p("input",{"onUpdate:modelValue":q=>O.attributes.suffix=q,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Oe,O.attributes.suffix]])])]),M=v(fe.DISPLAY,I==null?void 0:I.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("数据类型")]),p("div",{class:"quickprint-config-content"},[p(le,{options:t.value,modelValue:u.value,"onUpdate:modelValue":q=>u.value=q,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ie("基础")]),k,$,M])}function d(){const I=Qt(n.element.display);return(I==null?void 0:I.display)==null?null:ft(I.display,{element:n.element})}function h(){const I=Qt(n.element.type);if(v(fe.ATTRIBUTES,I==null?void 0:I.exclude))return null;const O=I!=null&&I.attributes?ft(I.attributes,{element:n.element}):null,k=d();if(O==null&&k==null)return null;const $=k!=null&&O!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ie("属性")]),k,$,O])}function E(){const I=Qt(n.element.type);return v(fe.DATASOURCE,I==null?void 0:I.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ie("数据")]),p(le,{options:no,modelValue:c.value,"onUpdate:modelValue":O=>c.value=O},null),Ph(n.element)])}function x(I){I(n.element.id)}return function(){const O=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,ie("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[O.id]),p(Qg,{onCopy:x},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("标题")]),p("div",{class:"quickprint-config-content"},[Te(p("input",{type:"text","onUpdate:modelValue":k=>O.title=k,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Oe,O.title]])])])]),_(),y(),h(),E()])])}}}),Fh=z({setup(){const n=Re(),e=Ce("classes");function t(){return p("div",{class:e.tip},[ie("未知的打印元素")])}function l(){return p("div",{class:e.tip},[ie("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return p(Dg,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(J).includes(i.type)===!1?t():ft(Vh,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==ue.ELEMENT?!1:i.selectMode===tt.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),zh="_tip_cdonk_2",Uh={tip:zh},Hh={classes:Uh},Gh=H(Fh,[["__cssModules",Hh]]);function We(n,e){if(n.state.selectedType!==ue.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ve(n,e,t){if(n.state.selectedType!==ue.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function He(n,e){if(n.state.selectedType!==ue.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function Wh(n){const e="underline";return C({get(){if(n.state.selectedType!==ue.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ve(n,e,t):He(n,e)}})}function Yh(n){const e="lineThrough";return C({get(){if(n.state.selectedType!==ue.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ve(n,e,t):He(n,e)}})}function jh(n){const e="lineHeight";return C({get(){return We(n,e)},set(t){t===Tt.DEFAULT?He(n,e):Ve(n,e,t)}})}function Xh(n){const e="highlightColor";return C({get(){return We(n,e)??$e.BLACK},set(t){t===""?He(n,e):Ve(n,e,t)}})}function Zh(n){const e="backgroundColor";return C({get(){return We(n,e)??$e.BLACK},set(t){t===""?He(n,e):Ve(n,e,t)}})}function Kh(n){const e="fontStyle";return C({get(){return We(n,e)===Tl.ITALIC},set(t){t?Ve(n,e,Tl.ITALIC):He(n,e)}})}function Jh(n){const e="textAlign";return C({get(){return We(n,e)??ct.LEFT},set(t){t===ct.LEFT?He(n,e):Ve(n,e,t)}})}function Qh(n){const e="verticalAlign";return C({get(){return We(n,e)??Qe.MIDDLE},set(t){t===Qe.MIDDLE?He(n,e):Ve(n,e,t)}})}function ev(n){const e="fontFamily";return C({get(){return We(n,e)},set(t){t===re.DEFAULT?He(n,e):Ve(n,e,t)}})}function tv(n){const e="fontSize";return C({get(){return We(n,e)},set(t){t===Se.DEFAULT?He(n,e):Ve(n,e,t)}})}function nv(n){const e="color";return C({get(){return We(n,e)??$e.BLACK},set(t){Ve(n,e,t)}})}function lv(n){const e="fontWeight";return C({get(){return We(n,e)===700},set(t){t?Ve(n,e,700):He(n,e)}})}const ov=["title","onClick"],sv=z({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=Re(),l=C(()=>{if(t.state.selectedType!==ue.ELEMENT)return null;const y=t.getSelectedElements();if(y.length!==1)return null;const d=y[0],h={};return he(d,"top")&&(h.borderTopStyle="solid"),he(d,"right")&&(h.borderRightStyle="solid"),he(d,"bottom")&&(h.borderBottomStyle="solid"),he(d,"left")&&(h.borderLeftStyle="solid"),h}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(_){if(t.state.selectedType!==ue.ELEMENT)return!1;const d=t.getSelectedElements();if(d.length!==1)return!1;const h=d[0];switch(_){case e.TOP:return he(h,"top");case e.RIGHT:return he(h,"right");case e.BOTTOM:return he(h,"bottom");case e.LEFT:return he(h,"left");case e.ALL:return he(h,"top")&&he(h,"right")&&he(h,"bottom")&&he(h,"left");default:return!1}}function r(_){if(t.state.selectedType!==ue.ELEMENT)return;const d=t.getSelectedElements();if(d.length!=0){switch(_){case e.TOP:return a(d);case e.BOTTOM:return c(d);case e.LEFT:return g(d);case e.RIGHT:return u(d);case e.ALL:return v(d)}t.createSnapshot()}}function i(){if(t.state.selectedType!==ue.ELEMENT)return;const y=t.getSelectedElements();if(y.length!=0){for(const d of y)d.setStyle("borderStyle",void 0),d.setStyle("borderTopStyle",void 0),d.setStyle("borderRightStyle",void 0),d.setStyle("borderBottomStyle",void 0),d.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function a(_){const y=!_.every(d=>he(d,"top"));for(const d of _)y?d.setStyle("borderTopStyle",ee.SOLID):d.removeStyle("borderTopStyle")}function u(_){const y=!_.every(d=>he(d,"right"));for(const d of _)y?d.setStyle("borderRightStyle",ee.SOLID):d.removeStyle("borderRightStyle")}function c(_){const y=!_.every(d=>he(d,"bottom"));for(const d of _)y?d.setStyle("borderBottomStyle",ee.SOLID):d.removeStyle("borderBottomStyle")}function g(_){const y=!_.every(d=>he(d,"left"));for(const d of _)y?d.setStyle("borderLeftStyle",ee.SOLID):d.removeStyle("borderLeftStyle")}function v(_){const y=!_.every(d=>he(d,"top")&&he(d,"right")&&he(d,"bottom")&&he(d,"left"));for(const d of _){if(y){d.setStyle("borderStyle",y?"solid":void 0);continue}d.removeStyle("borderStyle"),d.removeStyle("borderTopStyle"),d.removeStyle("borderRightStyle"),d.removeStyle("borderBottomStyle"),d.removeStyle("borderLeftStyle")}}return(_,y)=>(T(),Q(b(uo),null,{popover:ke(()=>[f("div",{class:m(_.classes.popover)},[f("div",null,[(T(),N("button",{type:"button",title:"全部框线",key:b(e).ALL,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0,"quickprint-is-selected":s(b(e).ALL)}),onClick:y[0]||(y[0]=d=>r(b(e).ALL))},[p(b(U),{icon:"icon-border",size:"16px"})],2)),(T(),N("button",{type:"button",title:"无框线",key:b(e).NONE,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0}),onClick:i},[p(b(U),{icon:"icon-border-none",size:"16px"})],2))]),f("div",{class:m(_.classes.divider)},[(T(),N(ne,null,ce(o,d=>f("button",{type:"button",title:d.label,key:d.value,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0,"quickprint-is-selected":s(d.value)}),onClick:h=>r(d.value)},[p(b(U),{icon:d.icon,size:"16px"},null,8,["icon"])],10,ov)),64))],2)],2)]),default:ke(()=>[f("div",{class:m(["quickprint-text-btn",_.classes.borderSelect]),title:"边框"},[f("div",{class:m({[_.classes.border]:!0}),style:X(l.value)},null,6)],2)]),_:1}))}}),iv="_border_rprfx_2",rv="_borderSelect_rprfx_10",av="_popover_rprfx_14",cv="_divider_rprfx_18",uv={border:iv,borderSelect:rv,popover:av,divider:cv},dv={classes:uv},fv=H(sv,[["__cssModules",dv]]),pv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},mv={class:"quickprint-config-section"},gv={class:"quickprint-form-inline"},hv={class:"quickprint-config-section quickprint-config-inline"},vv={class:"quickprint-config-section"},bv={class:"quickprint-config-header quickprint-is-row"},yv={class:"quickprint-is-fill-w"},_v={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},Ev={class:"quickprint-config-content quickprint-form-inline"},Tv=z({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=de("px"),l=v("top"),o=v("bottom"),s=v("left"),r=v("right"),i=C(()=>Gn.map(_=>({label:_.size===Wn.CUSTOM?"自定义":`${_.size}(${_.width}mm ✕ ${_.height}mm)`,value:_.size})));function a(_){e.config.width=_,g()}function u(_){e.config.height=_,g()}function c(_){const y=Gn.find(d=>d.size===_);y!=null&&(e.config.width=y.width,e.config.height=y.height,e.config.orientation=y.orientation,e.config.margins=y.margins,e.config.size=y.size)}function g(){const _=e.config,y=Gn.find(d=>d.size===Wn.CUSTOM?!1:d.orientation===_.orientation&&d.width===_.width&&d.height===_.height);if(y==null){_.size=Wn.CUSTOM;return}_.size=y.size}function v(_){return C({get(){var y;return(y=e.config.margins)==null?void 0:y[_]},set(y){e.config.margins==null&&(e.config.margins={}),e.config.margins[_]=y}})}return(_,y)=>(T(),N("div",pv,[f("section",mv,[y[6]||(y[6]=f("header",{class:"quickprint-config-header"},[f("span",null,"尺寸")],-1)),p(b(le),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":c,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),f("div",gv,[p(qt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":a},null,8,["modelValue"]),p(qt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":u},null,8,["modelValue"])])]),f("section",hv,[y[7]||(y[7]=f("header",{class:"quickprint-config-header"},"方向",-1)),p($t,{modelValue:n.config.orientation,"onUpdate:modelValue":y[0]||(y[0]=d=>n.config.orientation=d),options:b(oo)},null,8,["modelValue","options"])]),f("section",vv,[f("header",bv,[f("span",yv,[p(b(Ys),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:ke(()=>y[8]||(y[8]=[ie("参考边距")])),_:1})]),y[9]||(y[9]=f("span",null,"单位：",-1)),p(Po,{modelValue:t.value,"onUpdate:modelValue":y[1]||(y[1]=d=>t.value=d)},null,8,["modelValue"])]),f("div",_v,[p(ut,{class:"quickprint-form-inline-item",label:"上",modelValue:b(l),"onUpdate:modelValue":y[2]||(y[2]=d=>et(l)?l.value=d:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(ut,{class:"quickprint-form-inline-item",label:"下",modelValue:b(o),"onUpdate:modelValue":y[3]||(y[3]=d=>et(o)?o.value=d:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),f("div",Ev,[p(ut,{class:"quickprint-form-inline-item",label:"左",modelValue:b(s),"onUpdate:modelValue":y[4]||(y[4]=d=>et(s)?s.value=d:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(ut,{class:"quickprint-form-inline-item",label:"右",modelValue:b(r),"onUpdate:modelValue":y[5]||(y[5]=d=>et(r)?r.value=d:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),Sv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Rv={class:"quickprint-is-fill-h"},wv={class:"quickprint-is-fill-h"},kv=z({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:ye.NONE},{label:"磅",value:ye.PT},{label:"像素",value:ye.PX}],l=C(()=>qn.map(u=>(u.style={fontFamily:u.value==re.DEFAULT?re.SONG:u.value},u))),o=C(()=>So.map(u=>(u.style={fontFamily:u.value==re.DEFAULT?re.SONG:u.value},u))),s=C({get(){return e.config.style.fontFamily??re.DEFAULT},set(u){const c=u===re.DEFAULT?void 0:u;e.config.style.fontFamily=c}}),r=C({get(){return e.config.style.enFontFamily??re.DEFAULT},set(u){const c=u===re.DEFAULT?void 0:u;e.config.style.enFontFamily=c}}),i=C({get(){return e.config.style.fontSize},set(u){const c=ae(u)?void 0:u;e.config.style.fontSize=c}}),a=C({get(){return e.config.style.lineHeight},set(u){e.config.style.lineHeight=u}});return(u,c)=>(T(),N("div",Sv,[f("section",{class:m(u.classes.font)},[f("div",{class:m(u.classes.zhFont)},[f("div",{class:m(u.classes.title)},"中文字体",2),f("div",Rv,[p(b(le),{options:l.value,modelValue:s.value,"onUpdate:modelValue":c[0]||(c[0]=g=>s.value=g)},null,8,["options","modelValue"])])],2),f("div",{class:m(u.classes.enFont)},[f("div",{class:m(u.classes.title)},"西文字体",2),f("div",wv,[p(b(le),{options:o.value,modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=g=>r.value=g)},null,8,["options","modelValue"])])],2),f("div",{class:m(u.classes.lineHeight)},[f("div",{class:m(u.classes.title)},"行高",2),p(ze,{modelValue:a.value,"onUpdate:modelValue":c[2]||(c[2]=g=>a.value=g),options:t},null,8,["modelValue"])],2),f("div",{class:m(u.classes.fontSize)},[f("div",{class:m(u.classes.title)},"字号",2),p(wo,{modelValue:i.value,"onUpdate:modelValue":c[3]||(c[3]=g=>i.value=g),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),Cv="_font_145qf_2",Lv="_zhFont_145qf_9",Iv="_enFont_145qf_16",Nv="_lineHeight_145qf_23",Ov="_fontSize_145qf_30",xv="_title_145qf_45",Dv={font:Cv,zhFont:Lv,enFont:Iv,lineHeight:Nv,fontSize:Ov,title:xv},Mv={classes:Dv},Av=H(kv,[["__cssModules",Mv]]),Bv=z({__name:"index",props:{doc:{type:_e,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=st(),l=xe(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,a)=>(T(),N("div",{class:m(i.classes.setting)},[n.active=="paper"?(T(),Q(Tv,{key:0,config:l},null,8,["config"])):Y("",!0),n.active=="font"?(T(),Q(Av,{key:1,config:l},null,8,["config"])):Y("",!0),f("div",{class:m(i.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),$v="_setting_h98ws_2",qv="_footer_h98ws_10",Pv={setting:$v,footer:qv},Vv={classes:Pv},Fv=H(Bv,[["__cssModules",Vv]]),zv=De(function(n){return gt("文档",(e,t)=>p(Fv,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Me)}),Uv=z({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Re(),t=Ce("classes"),l=ev(e),o=tv(e),s=jh(e),r=Zh(e),i=Xh(e),a=nv(e),u=lv(e),c=Kh(e),g=Wh(e),v=Yh(e),_=Jh(e),y=Qh(e),d=C(()=>qn.map(B=>(B.style={fontFamily:B.value==re.DEFAULT?re.SONG:B.value},B)));function h(B){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>B.handler(e)},[B.icon&&p(U,{icon:B.icon},null),p("span",null,[B.label])])}function E(B){B.preventDefault()}function x(){u.value=!u.value}function I(){c.value=!c.value}function O(){g.value=!g.value}function k(){v.value=!v.value}function $(){const B=e.getSelectedElements();if(B.length==0)return;const S=Math.min(...B.map(R=>R.left));for(const R of B)R.setLeft(S,!0);e.createSnapshot()}function M(){const B=e.getSelectedElements();if(B.length==0)return;const S=B[0].page;if(S==null)return;const R=Gt(S.width);for(const w of B)w.setLeft((R-w.width)/2);e.createSnapshot()}function q(){const B=e.getSelectedElements();if(B.length==0)return;const S=Math.max(...B.map(R=>R.left+R.width));for(const R of B)R.setLeft(S-R.width,!0);e.createSnapshot()}async function L(){const B=await cc(e.doc);B!=null&&(e.doc.ds=e.doc.createDS(B))}function A(){zv(e.doc)}function D(B){var S,R;if(typeof B=="function")return B(e,t);if(typeof B=="object")return h(B);if(typeof B!="string")return null;switch(B){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const w=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:w,onClick:e.history.undo},[p(U,{icon:"icon-undo"},null)])}case"redo":{const w=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:w,onClick:e.history.redo},[p(U,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(U,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(le,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":w=>l.value=w,options:d.value,class:t.tool,button:!0},null);case"fontSize":return p(le,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":w=>o.value=w,options:vl,class:t.tool,button:!0},null);case"lineHeight":return p(le,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":w=>s.value=w,options:Ro,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(Vt,{modelValue:r.value,"onUpdate:modelValue":w=>r.value=w,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(U,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return p(Vt,{modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(U,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return p(Vt,{modelValue:a.value,"onUpdate:modelValue":w=>a.value=w,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(U,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"fontWeight":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":u.value};return p("button",{type:"button",title:"加粗",class:w,onClick:x},[p(U,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":c.value};return p("button",{type:"button",title:"斜体",class:w,onClick:I},[p(U,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":g.value};return p("button",{type:"button",title:"下划线",class:w,onClick:O},[p(U,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":v.value};return p("button",{type:"button",title:"删除线",class:w,onClick:k},[p(U,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(fv,null,null);case"textAlign":{const w=((S=nl.find(P=>P.value===_.value))==null?void 0:S.label)??"水平对齐",V={selected({option:P}){return p(U,{icon:P==null?void 0:P.icon,class:"quickprint-is-self-center"},null)}};return p(le,{modelValue:_.value,"onUpdate:modelValue":P=>_.value=P,options:nl,title:w,class:t.tool,width:"36px",size:"mini",button:!0},V)}case"verticalAlign":{const w=((R=tl.find(P=>P.value===y.value))==null?void 0:R.label)??"垂直对齐",V={selected({option:P}){return p(U,{icon:P==null?void 0:P.icon,class:"quickprint-is-self-center"},null)}};return p(le,{modelValue:y.value,"onUpdate:modelValue":P=>y.value=P,options:tl,title:w,class:t.tool,width:"36px",size:"mini",button:!0},V)}case"alignLeft":{const w={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:w,onClick:$},[p(U,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const w={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:w,onClick:M},[p(U,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const w={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:w,onClick:q},[p(U,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const w={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:w,onClick:e.toggleBackground},[p(U,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const w={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:w,onClick:e.toggleElementPanel},[p(U,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const w={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:w,onClick:e.toggleConfigPanel},[p(U,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:L},[p(U,{icon:"icon-datasource"},null),p("span",null,[ie("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:A},[p(U,{icon:"icon-file-text"},null),p("span",null,[ie("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:E},[n.toolbar.map(D)])}}}),Hv="_toolbar_1bhq2_2",Gv="_divider_1bhq2_8",Wv="_tool_1bhq2_2",Yv="_colorIcon_1bhq2_18",jv="_colorIndicator_1bhq2_38",Xv={toolbar:Hv,divider:Gv,tool:Wv,colorIcon:Yv,colorIndicator:jv},Zv={classes:Xv},Kv=H(Uv,[["__cssModules",Zv]]);function Jv(n){let e=null;const t=pe(),l=xe({width:0,height:0,scrollTop:0,scrollLeft:0}),o=pe(),s=xe({id:"",top:0,left:0,width:0,height:0});async function r(){await Wt();const _=t.value;_!=null&&(l.width=_.offsetWidth,l.height=_.offsetHeight)}function i(_){const y=_.target;l.scrollLeft=y.scrollLeft,l.scrollTop=y.scrollTop}function a(_){const d=_.target.closest("."+K.PAPER);d!=null&&(o.value=d,c(d),u())}async function u(){await Wt();const _=o.value;_!=null&&(s.id=_.id.slice(1),s.width=_.offsetWidth,s.height=_.offsetHeight,s.top=_.offsetTop,s.left=_.offsetLeft)}function c(_){_!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(_))}function g(){const _=n.doc.firstPage;if(_==null)return;const y=document.querySelector("#\\@"+_.id);o.value=y,e&&y&&e.observe(y),u()}function v(_){_.some(y=>y.target.matches("."+K.CANVAS))&&(r(),u()),_.some(y=>y.target.matches("."+K.PAPER))&&(r(),u())}return ul(()=>n.state.scale,()=>u()),an(()=>{e=new ResizeObserver(v),e.observe(t.value),g(),r()}),ks(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:a}}const zo=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),Qv=z({__name:"index",props:Ot({modelValue:{type:_e,required:!0},toolbar:{type:Array,default(){return zo}}},{modelValue:{required:!0},modelModifiers:{}}),emits:Ot(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=pe(),o=pe(),s=Vs(),r=rn(n,"modelValue"),i=Yp(r,{queryElement:E,dispatchEvent:x}),{canvasRef:a,canvasRect:u,pageRect:c,onScroll:g,onSelectPage:v}=Jv(i),_=C(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),y=C(()=>{const O=i.doc.style;return{fontFamily:il(O==null?void 0:O.fontFamily,O==null?void 0:O.enFontFamily),fontSize:O==null?void 0:O.fontSize,lineHeight:O==null?void 0:O.lineHeight}});function d(){i.state.panel.left=!1}function h(){i.state.panel.right=!1}function E(O){switch(O){case"ghost":return o.value;case"root":return l.value;default:return}}function x(O,...k){t(O,...k)}function I(O){O.deltaY>0?i.zoomIn():i.zoomOut()}return(O,k)=>(T(),N("div",{class:m(O.classes.designer),ref_key:"rootRef",ref:l,style:X(_.value)},[f("div",{class:m(O.classes.header)},[lt(O.$slots,"headerLeft"),p(Kv,{class:m(O.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),lt(O.$slots,"headerRight")],2),f("div",{class:m(O.classes.main)},[b(i).state.panel.left?(T(),N("div",{key:0,class:m(O.classes.left)},[f("button",{type:"button",onClick:d,class:m(["quickprint-text-btn",O.classes.closePanelBtn])},[p(b(U),{icon:"icon-close",size:"12px"})],2),p(Qm)],2)):Y("",!0),f("div",{class:m([O.classes.center,b(K).CANVAS]),onWheel:se(I,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:a},[p(ql,{canvas:b(u),page:b(c),scale:b(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(ql,{canvas:b(u),page:b(c),scale:b(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),f("div",{class:m([b(K).SCROLLABLE,O.classes.canvas]),style:X(y.value),onScroll:k[0]||(k[0]=(...$)=>b(g)&&b(g)(...$)),onClickCapture:k[1]||(k[1]=(...$)=>b(v)&&b(v)(...$))},[(T(!0),N(ne,null,ce(r.value.pages,$=>(T(),Q(zm,{key:$.id,doc:r.value,page:$},null,8,["doc","page"]))),128))],38),f("div",{class:m(O.classes.footer)},[p(ag),p(b(gs),{scale:b(i).state.scale,onZoomIn:b(i).zoomIn,onZoomOut:b(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),b(i).state.panel.right?(T(),N("div",{key:1,class:m(O.classes.right)},[f("button",{type:"button",onClick:h,class:m(["quickprint-text-btn",O.classes.closePanelBtn])},[p(b(U),{icon:"icon-close",size:"12px"})],2),p(Gh)],2)):Y("",!0)],2),f("div",{ref_key:"ghostRef",ref:o,class:m(O.classes.ghost)},null,2),p(b(hs))],6))}}),eb="_designer_grxxm_2",tb="_header_grxxm_17",nb="_toolbar_grxxm_25",lb="_footer_grxxm_31",ob="_main_grxxm_47",sb="_left_grxxm_55",ib="_center_grxxm_63",rb="_right_grxxm_75",ab="_canvas_grxxm_83",cb="_closePanelBtn_grxxm_96",ub="_ghost_grxxm_103",db={designer:eb,header:tb,toolbar:nb,footer:lb,main:ob,left:sb,center:ib,right:rb,canvas:ab,closePanelBtn:cb,ghost:ub},fb={classes:db},pb=H(Qv,[["__cssModules",fb]]),mb={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:hn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Me)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:hn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:hn.DISABLED}};function gb(n,e={}){const t=vs(e.zIndexManager);n.use(bs,{zIndex:t,presets:mb}),ys(n._context)}const hb="0.0.0",vb={version:hb,install:gb},bb=["onClick"],yb=z({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=st();function l(o){t==null||t.confirm(o)}return(o,s)=>(T(),N("div",{class:m(o.classes.panel)},[(T(!0),N(ne,null,ce(b(_s),(r,i)=>(T(),N("div",{key:r.id,class:m(o.classes.item),onClick:a=>l(r)},[f("div",null,[f("span",null,Z(i+1)+". ",1),f("span",null,Z(r.name),1)])],10,bb))),128))],2))}}),_b="_panel_1he7q_2",Eb="_item_1he7q_9",Tb={panel:_b,item:Eb},Sb={classes:Tb},Rb=H(yb,[["__cssModules",Sb]]),wb='<div class="quickprint-md"><h2>设计</h2><ul><li>feat: 单元格内容宽度需计算边框宽度</li><li>feat: 文字方向<ul><li>参照wps文字方向</li><li>垂直文字合并 text-combine-upright</li></ul></li><li>fix: 单元格合并时，需要检测是否为相同数据源</li><li>feat: 支持按<code>ctrl</code>多选元素</li><li>feat: 分离斜线表头设置到单独的面板中</li><li>fix: 单元格调整尺寸后，需要重新计算表格尺寸</li></ul><h2>预览</h2><ul><li>fix: 存在单元格合并时渲染有误</li><li><s>feat: 调试模式</s></li></ul></div>',kb=["innerHTML"],Cb=z({__name:"Todo",setup(n){return(e,t)=>(T(),N("div",{innerHTML:b(wb),class:m(e.classes.doc)},null,10,kb))}}),Lb="_doc_eo2ef_2",Ib={doc:Lb},Nb={classes:Ib},Ob=H(Cb,[["__cssModules",Nb]]),xb="local",Vl="quickprint-local-define",Db=z({__name:"index",setup(n){const e=Ce("classes"),t=_(),l="20251124",o=[{label:"新建",icon:"icon-file-text",handler:c},{label:"加载示例",icon:"icon-import",handler:a},"---",...zo];function s(){const d=JSON.stringify(t.value);localStorage.setItem(Vl,d)}function r(){s()}function i(){const d=t.value.id,h=d.startsWith("case_")?d:xb,E=`${window.location.origin}/preview.html?id=${h}`;s(),dt("文档预览",ft("iframe",{src:E,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(x){window.open(E,"_blank"),x.close()}}]})}function a(){const d={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:hn.DISABLED};dt("选择示例",ft(Rb),d).promisify().then(h=>u(h.id)).catch(Me)}async function u(d){const h=await Sl(d,!1);h!=null&&(Es(d),t.value=_e.create(h.define),g())}function c(){const d=_e.createNormalDocument();t.value=d,g()}function g(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function v(){const d=localStorage.getItem(Vl);if(d!=null)return _e.create(d);const h=Ts(),E=await Sl(h.id,!1);return E==null?_e.createNormalDocument():_e.create(E.define)}function _(){const d=de();return v().then(h=>{d.value=h,g()}),d}const y=De(function(){return dt("待办事项",ft(Ob),{minHeight:360}).promisify().catch(Je)});return(d,h)=>b(t)?(T(),Q(b(pb),{modelValue:b(t),"onUpdate:modelValue":h[1]||(h[1]=E=>et(t)?t.value=E:null),toolbar:o,class:m(b(e).main),key:b(t).id,onSave:r,onPreview:i},{headerLeft:ke(()=>[f("div",{class:m(b(e).logo)},[h[2]||(h[2]=f("h1",null,"OpenPrint",-1)),f("div",{class:m(b(e).dev),onClick:h[0]||(h[0]=(...E)=>b(y)&&b(y)(...E))},"DEV_"+Z(b(l)),3)],2)]),headerRight:ke(()=>[f("div",{class:m(b(e).operate)},[f("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[p(b(U),{icon:"icon-run"}),h[3]||(h[3]=f("span",null,"预览",-1))]),f("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[p(b(U),{icon:"icon-save"}),h[4]||(h[4]=f("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):Y("",!0)}}),Mb="_main_14ojw_2",Ab="_iframe_14ojw_6",Bb="_divider_14ojw_14",$b="_logo_14ojw_20",qb="_dev_14ojw_39",Pb="_operate_14ojw_52",Vb={main:Mb,iframe:Ab,divider:Bb,logo:$b,dev:qb,operate:Pb},Fb={classes:Vb},zb=H(Db,[["__cssModules",Fb]]),Uo=Cs(zb);Uo.use(vb);Uo.mount("#app");
