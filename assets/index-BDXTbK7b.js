const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-BzOvwT-C.js","assets/vue-B00pXJJQ.js","assets/component-pGqeo5PS.js","assets/utils-DvQwHNsq.js","assets/utils-BWxIAY5I.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Ho=Object.defineProperty;var bl=n=>{throw TypeError(n)};var Go=(n,e,t)=>e in n?Ho(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var H=(n,e,t)=>Go(n,typeof e!="symbol"?e+"":e,t),Un=(n,e,t)=>e.has(n)||bl("Cannot "+t);var Ae=(n,e,t)=>(Un(n,e,"read from private field"),t?t.call(n):e.get(n)),Ye=(n,e,t)=>e.has(n)?bl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),ht=(n,e,t,l)=>(Un(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),Me=(n,e,t)=>(Un(n,e,"access private method"),t);import{D as _e,E as wt,N as Jt,a as yt,b as j,c as Ve,P as ol,d as tn,e as yl,f as _n,g as En,O as nn,h as te,i as an,j as Tn,L as $e,I as F,_ as z,k as Pl,s as Ln,l as Wo,m as ie,n as Vl,p as Sn,C as Be,o as sl,U as jn,q as il,r as pe,t as Yo,u as rl,v as Fl,w as Xe,x as Zn,y as Xo,z as jo,A as Zo,B as Ko,F as zl,V as kt,G as Rn,H as rt,J as Ul,K as Hl,M as Gl,Q as ye,R as ot,S as Jo,T as Qo,W as xe,X as ut,Y as De,Z as mt,$ as Ke,a0 as es,a1 as ts,a2 as ns,a3 as Re,a4 as wn,a5 as se,a6 as Te,a7 as _t,a8 as pn,a9 as xt,aa as ae,ab as Et,ac as Je,ad as at,ae as ls,af as be,ag as kn,ah as In,ai as Tt,aj as Xt,ak as mn,al as Ot,am as os,an as ss,ao as Lt,ap as At,aq as is,ar as rs,as,at as cs,au as us,av as Ut,aw as cn,ax as _l,ay as ds,az as El,aA as ge,aB as Hn,aC as Gn,aD as fs,aE as ps,aF as gn,aG as ms,aH as gs,aI as hs,aJ as vs,aK as Tl,aL as bs,aM as ys}from"./utils-DvQwHNsq.js";import{r as ue,o as al,d as V,c as I,a as R,n as m,b as f,e as p,f as nt,u as ke,s as fe,g as Oe,h as k,w as ne,i as b,j as J,k as G,T as Wl,l as K,m as It,p as sn,q as Yl,F as Q,t as re,v as Y,x as Ht,y as Sl,z as Xl,A as jl,B as rn,C as cl,D as we,E as Ee,G as Ne,H as le,I as Gt,J as _s,K as Zl,L as Wn,M as Qe,N as dt,O as Es,P as Ts,Q as Ss,R as Rs}from"./vue-B00pXJJQ.js";const Kl="@quickprint_drag_mode",Jl="@quickprint_drop_data",Nn="@quickprint_operate",He="@quickprint_element",ul="@quickprint_element_type",Ql="@quickprint_resize_flag",Ct=160,On=32,jt=[50,75,100,125,150,200,300,400];var Qt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Qt||{}),Dt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Dt||{});const et={SINGLE:0,MULTIPLE:1},qe=Object.freeze({INSERT:0,MOVE:1}),dl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),X=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),ce=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),eo=[{label:"固定值",value:_e.CONST},{label:"变量",value:_e.VARIABLE},{label:"公式",value:_e.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:_e.CODE,detail:"使用Javascript代码生成数据"}],ws=[{label:"显示",value:wt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:wt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:wt.CONDITION,detail:"元素只在满足指定条件后显示"}],ks=[{label:"四舍五入",value:Jt.ROUND},{label:"向下舍入",value:Jt.FLOOR},{label:"向上舍入",value:Jt.CEIL},{label:"四舍六入",value:Jt.BANKER_ROUND}],Cs=[{label:"原始值",value:yt.NONE},{label:"固定位数",value:yt.FIXED},{label:"金额千位",value:yt.THOUSAND},{label:"金额万位",value:yt.TEN_THOUSAND},{label:"金额大写",value:yt.DAXIE},{label:"百分比",value:yt.PERCENTAGE}],Ls=[{label:"显示",value:!0},{label:"隐藏",value:!1}],Is=[{label:"默认",value:void 0},{label:"文本",value:j.TEXT},{label:"数字",value:j.NUMBER},{label:"日期",value:j.DATE}],de={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},to=[{label:"年-月",value:Ve.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:Ve.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:Ve.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:Ve.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:Ve.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:Ve.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:Ve.TIME,detail:"示例：12:00:00"},{label:"时:分",value:Ve.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:Ve.YEAR,detail:"示例：2024"},{label:"月",value:Ve.MONTH,detail:"示例：12"},{label:"日",value:Ve.DAY,detail:"示例：01"}];to.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const Ns=[{label:"元素值",value:ol.ELEMENT_VALUR}],Os=[{label:"基于纸张",value:tn.PAPER},{label:"基于内容",value:tn.CONTENT}],no=[{label:"纵向",value:yl.PORTRAIT},{label:"横向",value:yl.LANDSCAPE}],xs=[{label:"当前位置",value:_n.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:_n.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Ds=[{label:"单次打印",value:En.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:En.EACH,detail:"元素将每页打印一次"}],As=[{label:"按内容调整高度",value:nn.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:nn.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:nn.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Kn=[{label:"页码",value:an.PAGE_NUMBER,type:te.NUMBER},{label:"总页数",value:an.PAGE_TOTAL,type:te.NUMBER},{label:"行序号",value:an.ROW_INDEX,type:te.NUMBER},{label:"当前时间",value:an.CURRENT_DATE,type:te.DATE}],Ms=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function lo(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Bs(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function oo(n){return n.isSelected?n.type===j.PARAGRAPH?52:n.type===j.TABLE?32:20:20}function qs(){const n=ue(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),al(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class $s{constructor(e,t,l){H(this,"originalEvent");H(this,"target");H(this,"ghost");H(this,"container");H(this,"paths",[]);H(this,"dropTarget");H(this,"top",0);H(this,"left",0);H(this,"deltaX");H(this,"deltaY");H(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var Pt,Vt,ft,so,io,ro;const Rt=class Rt extends Tn{constructor(t={}){var l,o,s;super();Ye(this,ft);H(this,"context",null);H(this,"selector");H(this,"scale");H(this,"onDragStart");Ye(this,Pt);Ye(this,Vt);this.selector={container:((l=t.selector)==null?void 0:l.container)??X.PAGE,element:((o=t.selector)==null?void 0:o.element)??X.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??X.DROPPABLE},this.onDragStart=Me(this,ft,so).bind(this),this.scale=t.scale,ht(this,Pt,Me(this,ft,io).bind(this)),ht(this,Vt,Me(this,ft,ro).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",Ae(this,Pt)),window.removeEventListener("pointerup",Ae(this,Vt)),this.context=null)}};Pt=new WeakMap,Vt=new WeakMap,ft=new WeakSet,so=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return $e.warn(Rt.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=lo(l,o);this.context=new $s(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return $e.warn(Rt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return $e.warn(Rt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return $e.warn(Rt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",Ae(this,Pt)),window.addEventListener("pointerup",Ae(this,Vt))},io=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(c=>!(c===l.ghost||c===l.target||l.ghost.contains(c))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(c=>c.matches("."+X.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},ro=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},H(Rt,"TAG_NAME","quickprint-draggable");let Jn=Rt;const Ps=["title"],Vs=V({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(R(),I("span",{title:n.title,class:m(e.classes.help)},[f("span",null,[nt(e.$slots,"default")]),p(F,{icon:"icon-question-circle"})],10,Ps))}}),Fs="_help_1l6l8_2",zs={help:Fs},Us={classes:zs},Hs=z(Vs,[["__cssModules",Us]]),Gs=V({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=ke("classes"),r=ue(!1),i=fe(),c=fe(),a=Oe({minWidth:0,top:0,left:0,visible:!1}),d=k(()=>({minWidth:l.width==null?a.minWidth+"px":l.width+"px",top:a.top+"px",left:a.left+"px",visibility:a.visible?"visible":"hidden",zIndex:Pl()}));async function g(){if(r.value)return v();l.disabled||(r.value=!0,o("show"),await Ln(),T())}function v(){N(),r.value=!1,o("close")}function E(C){if(!(C.target instanceof Node))return;const O=i.value;if(O&&O.contains(C.target))return C.preventDefault();const w=c.value;if(w&&w.contains(C.target))return C.preventDefault();v()}function y(){const C=i.value,O=c.value;if(O==null||C==null)return;const w=C.getBoundingClientRect(),M=O.getBoundingClientRect(),x=l.width==null?w.width:l.width;let $=w.bottom+1;$+M.height>window.innerHeight&&w.top>M.height&&($=w.top-M.height-1);let L=w.left;L+M.width>window.innerWidth&&(L=window.innerWidth-M.width-2),a.minWidth=x,a.top=$,a.left=L,a.visible=!0}function u(C){const O=C.target;if(!(O instanceof HTMLElement))return;const w=i.value;w==null||!O.contains(w)||v()}function h(C){if(C.key!=="Escape")return;const O=c.value;if(O!=null){const w=O.style.zIndex;if(Number(w)<Wo())return}C.preventDefault(),v()}function T(){window.addEventListener("click",E,{capture:!0}),window.addEventListener("contextmenu",v,{capture:!0}),window.addEventListener("scroll",u,{capture:!0,passive:!0}),window.addEventListener("resize",y),window.addEventListener("keydown",h)}function N(){window.removeEventListener("click",E,!0),window.removeEventListener("contextmenu",v,!0),window.removeEventListener("scroll",u,!0),window.removeEventListener("resize",y),window.removeEventListener("keydown",h)}return e({close:v}),(C,O)=>(R(),I("div",{class:m(b(s).reference),onClick:ne(g,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[nt(C.$slots,"default"),r.value?(R(),J(Wl,{key:0,to:"body"},[f("div",{class:m(b(s).popover),onVnodeMounted:y,onMousedown:O[0]||(O[0]=ne(()=>{},["prevent"])),style:K(d.value),ref_key:"popoverRef",ref:c},[nt(C.$slots,"popover")],38)])):G("",!0)],2))}}),Ws="_reference_1arli_2",Ys="_popover_1arli_7",Xs={reference:Ws,popover:Ys},js={classes:Xs},ao=z(Gs,[["__cssModules",js]]),Zs=["title","onKeydown"],Ks=["onMouseover","onClick"],Js=V({__name:"Select",props:It({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:It(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=ke("classes"),s=fe(),r=fe(),i=sn(n,"modelValue"),c=ue(),a=ue(!1),d=Oe({width:0,top:0,left:0,visible:!1,scrollable:!1}),g=k(()=>l.teleport==="none"),v=k(()=>l.teleport=="none"?"body":l.teleport),E=k(()=>{const P={label:"",options:[]},U=[P];for(const W of l.options){if(Array.isArray(W.options)){U.push({label:W.label,options:W.options});continue}P.options.push(W)}return U}),y=k(()=>E.value.reduce((P,U)=>P.concat(U.options),[])),u=k(()=>{if(l.multiple!==!0){const U=Fn();return U?U.label:l.button?l.title:ie(l.modelValue)?l.placeholder:l.modelValue}const P=zn();return P.length>0?P.map(U=>U.label).join(","):l.button?l.title:l.placeholder}),h=k(()=>l.clearable!==!0?!1:l.modelValue!=null),T=k(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!h.value,[o.button]:l.button,[o.showClearIcon]:h.value,[o.text]:l.size==="text"})),N=k(()=>({width:l.width})),C=k(()=>d.visible?{width:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",top:d.top+"px",left:d.left+"px",visibility:"visible",zIndex:Pl()}:{minWidth:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",visibility:"hidden"}),O=k(()=>({[o.content]:!0,[o.placeholder]:Vl(l.modelValue)}));async function w(){if(l.disabled)return;const P=y.value;if(P.length===0)return;if(a.value)return M();const U=s.value;U!=null&&(d.width=U.getBoundingClientRect().width,d.visible=!1,c.value=P.find(W=>W.value===l.modelValue),a.value=!0,await Ln(),zo())}function M(){Uo(),a.value=!1}function x(P){_(),gt()}function $(P){P.disabled!==!0&&(c.value=P)}function L(P){if(l.disabled==!0||P.disabled===!0)return;if(l.multiple!==!0){i.value=P.value,t("select",P),M();return}const U=Array.isArray(i.value)?i.value:[],W=U.findIndex(me=>me===P.value);W>=0?U.splice(W,1):U.push(P.value),i.value=U,t("select",U)}function D(P){if(!(P.target instanceof Node))return;const U=s.value;if(U&&U.contains(P.target))return P.preventDefault();const W=r.value;if(W&&W.contains(P.target))return P.preventDefault();M()}async function _(){const P=s.value,U=r.value;if(U==null||P==null)return;await Ht();const W=P.getBoundingClientRect(),me=U.getBoundingClientRect();let ve=W.bottom+1;ve+me.height>window.innerHeight&&W.top>me.height&&(ve=W.top-me.height-1);let Nt=W.left;Nt+me.width>window.innerWidth&&(Nt=window.innerWidth-me.width-2),d.width=me.width,d.top=ve,d.left=Nt,d.visible=!0;const Yt=U.querySelector("."+o.list);d.scrollable=Yt?Yt.scrollHeight>Yt.clientHeight:!1}function S(P){const U=P.target;if(!(U instanceof HTMLElement))return;const W=s.value;W==null||!U.contains(W)||M()}function A(){const P=y.value,U=Sl(c.value);if(U==null){c.value=Ce(0),gt();return}const W=P.indexOf(U);if(W==0)return oe();const me=Ce(W-1);me!=null&&(c.value=me,gt())}function q(){const P=y.value,U=Sl(c.value);if(U==null){c.value=he(0),gt();return}const W=P.indexOf(U);if(W>=P.length-1){B();return}const me=Ce(W+1);me!=null&&(c.value=me,gt())}function B(){c.value=he(0),gt()}function oe(){const P=y.value;c.value=Ce(P.length-1),gt()}function Z(){i.value=void 0,M()}function he(P){const W=y.value[P];return W==null?null:W.disabled===!0?he(P+1):W}function Ce(P){const W=y.value[P];return W==null?null:W.disabled===!0?Ce(P-1):W}function Le(P){switch(P.key){case"Enter":P.preventDefault(),c.value&&L(c.value);return;case"Escape":P.preventDefault(),M();return;case"ArrowUp":P.preventDefault(),A();return;case"ArrowDown":P.preventDefault(),q();return;case"Home":P.preventDefault(),B();return;case"End":P.preventDefault(),oe();return}}function We(P){if(l.disabled)return;const U=s.value;U!=null&&document.activeElement===U&&(a.value||(P.stopPropagation(),w()))}function Fo(P){if(l.multiple!==!0)return l.modelValue===P.value;const U=l.modelValue;return Array.isArray(U)?U.includes(P.value):!1}async function gt(){if(c.value==null)return;await Ht();const P=r.value;if(P==null)return;const U=P.querySelector("."+o.hover);U&&U.scrollIntoView({block:"nearest"})}function Fn(){const P=y.value,U=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return P.find(W=>W.value===U)}function zn(){const P=y.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(W=>W).map(W=>{const me=P.find(ve=>ve.value===W);return me||{value:W,label:W}})}function zo(){window.addEventListener("mousedown",D,{capture:!0}),window.addEventListener("pointerdown",D,{capture:!0}),window.addEventListener("contextmenu",M,{capture:!0}),window.addEventListener("scroll",S,{capture:!0,passive:!0}),window.addEventListener("resize",_),window.addEventListener("keydown",Le)}function Uo(){window.removeEventListener("mousedown",D,!0),window.removeEventListener("pointerdown",D,!0),window.removeEventListener("contextmenu",M,!0),window.removeEventListener("scroll",S,!0),window.removeEventListener("resize",_),window.removeEventListener("keydown",Le)}return(P,U)=>{var W;return R(),I("div",{class:m(T.value),title:n.title,style:K(N.value),onClick:ne(w,["stop"]),onKeydown:Yl(ne(We,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[P.$slots.selected?nt(P.$slots,"selected",{key:0,option:Fn(),options:zn()}):nt(P.$slots,"option",{key:1,option:Fn(),options:zn()},()=>[f("div",{class:m(O.value)},[f("span",null,Y(u.value),1),h.value?(R(),J(F,{key:0,icon:"icon-close",onClick:ne(Z,["stop"]),size:"12px",class:m(b(o).clearIcon)},null,8,["class"])):G("",!0)],2)]),a.value?(R(),J(Wl,{key:2,to:v.value,disabled:g.value},[f("div",{class:m(b(o).popover),onClick:U[0]||(U[0]=ne(()=>{},["stop"])),onVnodeMounted:x,onMousedown:U[1]||(U[1]=ne(()=>{},["prevent"])),style:K(C.value),ref_key:"popoverRef",ref:r},[f("div",{class:m(b(o).list)},[(R(!0),I(Q,null,re(E.value,me=>(R(),I(Q,null,[me.label?(R(),I("div",{key:0,class:m(b(o).groupLabel)},Y(me.label),3)):G("",!0),(R(!0),I(Q,null,re(me.options,ve=>{var Nt;return R(),I("div",{key:ve.value,class:m({[b(o).option]:!0,[b(o).disabled]:ve.disabled===!0,[b(o).selected]:Fo(ve),[b(o).hover]:((Nt=c.value)==null?void 0:Nt.value)==ve.value}),style:K(ve.style),onMouseover:Yt=>$(ve),onClick:Yt=>L(ve)},[nt(P.$slots,"option",{option:ve},()=>[f("div",{class:m(b(o).label)},[ve.icon?(R(),J(F,{key:0,icon:ve.icon,class:m(b(o).icon)},null,8,["icon","class"])):G("",!0),f("span",null,Y(ve.label),1)],2),ve.short?(R(),I("div",{key:0,class:m(b(o).short)},Y(ve.short),3)):G("",!0)])],46,Ks)}),128))],64))),256))],2),(W=c.value)!=null&&W.detail&&d.visible?(R(),I("div",{key:0,class:m(b(o).detail)},Y(c.value.detail),3)):G("",!0)],38)],8,["to","disabled"])):G("",!0)],46,Zs)}}}),Qs="_button_g23yb_2",ei="_select_g23yb_7",ti="_appearance_g23yb_16",ni="_content_g23yb_31",li="_placeholder_g23yb_37",oi="_popover_g23yb_41",si="_list_g23yb_51",ii="_option_g23yb_80",ri="_label_g23yb_95",ai="_icon_g23yb_102",ci="_hover_g23yb_106",ui="_detail_g23yb_117",di="_short_g23yb_127",fi="_selected_g23yb_133",pi="_disabled_g23yb_137",mi="_showClearIcon_g23yb_142",gi="_clearIcon_g23yb_146",hi="_text_g23yb_159",vi="_mini_g23yb_171",bi="_groupLabel_g23yb_183",yi={button:Qs,select:ei,appearance:ti,content:ni,placeholder:li,popover:oi,list:si,option:ii,label:ri,icon:ai,hover:ci,detail:ui,short:di,selected:fi,disabled:pi,showClearIcon:mi,clearIcon:gi,text:hi,mini:vi,groupLabel:bi},_i={classes:yi},ee=z(Js,[["__cssModules",_i]]),Ei="_tree_1p28f_1",Ti="_node_1p28f_5",Si="_content_1p28f_11",Ri="_space_1p28f_27",wi="_expand_1p28f_28",ki="_active_1p28f_47",Ci="_children_1p28f_55",st={tree:Ei,node:Ti,content:Si,space:Ri,expand:wi,active:ki,children:Ci},co=Symbol(),uo=V({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Xl(co),l=k(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=k({get(){const u=t==null?void 0:t.state[n.node.value];return u==null?!1:u.expand},set(u){const h=t==null?void 0:t.state[n.node.value];h!=null&&(h.expand=u)}});function s(u){u.preventDefault(),o.value=!o.value}function r(){if(!l.value)return p("div",{class:st.space},null);const u={[st.expand]:!0,[st.active]:o.value};return p("div",{onMousedown:y,onClick:s,class:u},[p(F,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function c(){return p("div",{class:st.content,onClick:d,onMouseenter:v},[i()])}function a(){if(!l.value||!o.value)return;const u=n.node.children.map(h=>p(uo,{node:h,onNodeClick:g,onNodeHover:E},null));return p("div",{class:st.children},[u])}function d(){e("nodeClick",n.node)}function g(u){e("nodeClick",u)}function v(){e("nodeHover",n.node)}function E(u){e("nodeHover",u)}function y(u){u.preventDefault()}return function(){return p("div",{class:st.subTree},[p("div",{class:st.node},[r(),c()]),a()])}}}),Li=V({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(c){t("nodeClick",c)}function s(c){t("nodeHover",c)}function r(){const c=Oe({}),a=function(d,g){for(const v of d)g[v.value]={expand:v.expand!==!1},v.children&&a(v.children,g)};return a(n.data,c),c}function i(c){return typeof e.default=="function"?e.default(c):null}return jl(co,{state:l,content:i}),function(){const c=n.data.map(a=>p(uo,{node:a,onNodeClick:o,onNodeHover:s},null));return p("div",{class:st.tree},[c])}}});function un(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const Yn={A:10,B:11,C:12,D:13,E:14,F:15},Rl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function Ii(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function Ni(n){return typeof n=="string"&&n.includes("%")}function qt(n,e){Ii(n)&&(n="100%");const t=Ni(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function vt(n){return n.length===2?(Yn[n[0].toUpperCase()]||+n[0])*16+(Yn[n[1].toUpperCase()]||+n[1]):Yn[n[1].toUpperCase()]||+n[1]}function wl(n,e,t){n=qt(n,255),e=qt(e,255),t=qt(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,c=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:c*100,v:r*100}}const Oi=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},xi=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function Xn(n,e,t){n=qt(n,360)*6,e=qt(e,100),t=qt(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),c=l%6,a=[t,r,s,s,i,t][c],d=[i,t,t,r,s,s][c],g=[s,s,i,t,t,r][c];return{r:Math.round(a*255),g:Math.round(d*255),b:Math.round(g*255)}}function hn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${Rl[e]||e}${Rl[t]||t}`}function Di({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${hn(n)}${hn(e)}${hn(t)}`}class xn{constructor(e){H(this,"h",0);H(this,"s",100);H(this,"v",100);H(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=un(e)}setSaturation(e){this.s=un(e)}setValue(e){this.v=un(e)}setAlpha(e){this.a=un(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=vt(t[0]+t[0]),o=vt(t[1]+t[1]),s=vt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=vt(t.slice(0,2)),o=vt(t.slice(2,4)),s=vt(t.slice(4,6))),t.length===8&&(r=vt(t.slice(6))/255*100);const{h:i,s:c,v:a}=wl(l,o,s);return{h:i,s:c,v:a,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=wl(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Oi(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=xi(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Di(Xn(this.h,this.s,this.v))}${hn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=Xn(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return Xn(this.h,this.s,this.v)}}function fo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),a=e.target.getBoundingClientRect().width/2;let d=r.clientX-i.left-e.offsetX;return d<-a&&(d=-a),d>i.width-a&&(d=i.width-a),d}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,c=r.currentTarget;origin==null||i==null||(e.container=c,e.target=i===c?i.firstElementChild:i,e.offsetX=i===c?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function Ai(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const c=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let g=i.clientX-c.left-e.offsetX;return g<-d&&(g=-d),g>c.width-d&&(g=c.width-d),g}function l(i){const c=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().height/2;let g=i.clientY-c.top-e.offsetY;return g<-d&&(g=-d),g>c.height-d&&(g=c.height-d),g}function o(i){i.stopPropagation(),i.preventDefault();const c=i.target,a=i.currentTarget;origin==null||c==null||(e.container=a,e.target=c===a?c.firstElementChild:c,e.offsetX=c===a?e.target.offsetWidth/2:i.clientX-c.getBoundingClientRect().left,e.offsetY=c===a?e.target.offsetHeight/2:i.clientY-c.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const c=t(i),a=l(i);e.target.style.left=c+"px",e.target.style.top=a+"px",n("move",{left:c,top:a})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const c=t(i),a=l(i);n("end",{top:a,left:c})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const Mi=V({__name:"SvPanel",props:{modelValue:{type:xn,required:!0}},setup(n){const e=n,t=fe(),l=fe(),o=Oe(i()),s=k(()=>({left:o.left+"px",top:o.top+"px"})),r=Ai((c,a)=>{c=="end"&&(o.top=a.top,o.left=a.left);const d=t.value,g=l.value,v=(a.left+g.offsetWidth/2)/d.offsetWidth*100,E=100-(a.top+g.offsetHeight)/d.offsetHeight*100;e.modelValue.setSaturation(v),e.modelValue.setValue(E)});function i(){const c=t.value,a=l.value;if(c==null||a==null)return{top:-6,left:-6};const d=e.modelValue.s,v=(100-e.modelValue.v)/100*c.offsetHeight,E=d/100*c.offsetWidth;return{top:v-a.offsetHeight/2,left:E-a.offsetWidth/2}}return rn(()=>{const c=i();o.top=c.top,o.left=c.left}),(c,a)=>(R(),I("div",{class:m(c.classes.svPanel),onPointerdown:a[0]||(a[0]=(...d)=>b(r)&&b(r)(...d)),ref_key:"svPanelRef",ref:t},[f("div",{class:m(c.classes.thumb),style:K(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Bi="_svPanel_1sv6o_2",qi="_thumb_1sv6o_10",$i={svPanel:Bi,thumb:qi},Pi={classes:$i},Vi=z(Mi,[["__cssModules",Pi]]),Fi=V({__name:"HueSlider",props:{modelValue:{type:xn,required:!0}},setup(n){const e=n,t=ue(-6),l=fe(),o=fe(),s=fo((i,c)=>{i=="end"&&(t.value=c);const a=l.value,d=o.value,g=Math.round((c+d.offsetWidth/2)/a.offsetWidth*360);e.modelValue.setHue(g)});function r(){const i=l.value,c=o.value;if(i==null||c==null)return-6;const a=e.modelValue.h;return Math.round(a/360*i.offsetWidth)-c.offsetWidth/2}return rn(()=>{t.value=r()}),(i,c)=>(R(),I("div",{class:m(i.classes.hue),onPointerdown:c[0]||(c[0]=(...a)=>b(s)&&b(s)(...a)),ref_key:"hueRef",ref:l},[f("div",{class:m(i.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),zi="_hue_1ozoc_2",Ui="_thumb_1ozoc_10",Hi={hue:zi,thumb:Ui},Gi={classes:Hi},Wi=z(Fi,[["__cssModules",Gi]]),Yi=V({__name:"AlphaSlider",props:{modelValue:{type:xn,required:!0}},setup(n){const e=n,t=ue(-6),l=fe(),o=fe(),s=fo((i,c)=>{i=="end"&&(t.value=c);const a=l.value,d=o.value,g=Math.round((c+d.offsetWidth/2)/a.offsetWidth*100);e.modelValue.setAlpha(g)});function r(){const i=l.value,c=o.value;if(i==null||c==null)return-6;const a=e.modelValue.a;return Math.round(a/100*i.offsetWidth)-c.offsetWidth/2}return rn(()=>{t.value=r()}),(i,c)=>(R(),I("div",{class:m(i.classes.alpha),onPointerdown:c[0]||(c[0]=(...a)=>b(s)&&b(s)(...a)),ref_key:"alphaRef",ref:l},[f("div",{class:m(i.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Xi="_alpha_1x8jd_2",ji="_thumb_1x8jd_26",Zi={alpha:Xi,thumb:ji},Ki={classes:Zi},Ji=z(Yi,[["__cssModules",Ki]]),Qi=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function er(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function tr(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const kl={isSupport:er,open:tr},nr=["title","onClick"],lr=["title","onClick"],Cl="quickprint-recent-use-colors",or=V({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=ue(new xn(l.modelValue)),r=fe(),i=fe(),c=ue(N()),a=kl.isSupport(),d=ue("hex"),g=k(()=>{const w=l.modelValue;return w?{backgroundColor:w}:null}),v=k(()=>{const w=s.value,{r:M,g:x,b:$}=w.rgb();return{"--hue-channel-color":`hsl(${w.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${M}, ${x}, ${$}, 0)`,"--alpha-channel-color-b":`rgba(${M}, ${x}, ${$}, 1)`}}),E=k({get(){return s.value.toString(d.value)},set(w){s.value.setColor(w)}});function y(){var w;(w=r.value)==null||w.close()}function u(w){w!=null&&(t("update:modelValue",w),t("select",w),C(w),y())}function h(){t("update:modelValue",void 0),t("select",void 0),y()}function T(){kl.open().then(w=>u(w))}function N(){const w=localStorage.getItem(Cl);if(w==null||w=="")return[];const M=Sn(w);return M==null?[]:Array.isArray(M)?M:[]}function C(w){const M=c.value,x=M.indexOf(w);x>=0&&M.splice(x,1),M.length>10&&M.pop(),M.unshift(w),localStorage.setItem(Cl,JSON.stringify(M))}function O(){t("update:modelValue",s.value.toString(d.value)),t("select",s.value.toString(d.value)),y()}return cl(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(w,M)=>(R(),J(ao,{class:m(w.classes.colorPicker),onMousedown:M[7]||(M[7]=ne(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:we(()=>[f("div",{class:m(w.classes.colorPickerPanel)},[f("div",{class:m(w.classes.presetPanel)},[f("div",{class:m(w.classes.presetTools)},[f("button",{type:"button",class:m(w.classes.clearBtn),onClick:h},[f("span",{class:m(w.classes.none)},null,2),M[8]||(M[8]=f("span",null,"无颜色",-1))],2),b(a)?(R(),I("button",{key:0,type:"button",class:m(w.classes.indicator),onClick:T},[p(F,{icon:"icon-eye-dropper"}),M[9]||(M[9]=f("span",null,"拾色器",-1))],2)):G("",!0)],2),f("div",{class:m(w.classes.colourAtla)},[(R(!0),I(Q,null,re(b(Qi),x=>(R(),I("div",{style:K({backgroundColor:x}),title:x,class:m(w.classes.color),onClick:$=>u(x)},null,14,nr))),256))],2),f("div",{class:m(w.classes.recentColors)},"最近使用",2),f("div",{class:m(w.classes.colourAtla)},[(R(),I(Q,null,re(10,x=>f("div",{key:x,title:c.value[x-1],style:K({backgroundColor:c.value[x-1]}),class:m(w.classes.color),onClick:$=>u(c.value[x-1])},null,14,lr)),64))],2)],2),f("div",{class:m(w.pacls.panel),style:K(v.value)},[p(Vi,{class:m(w.pacls.sv),modelValue:s.value,"onUpdate:modelValue":M[1]||(M[1]=x=>s.value=x)},null,8,["class","modelValue"]),f("div",{class:m(w.pacls.sliders)},[p(Wi,{class:m(w.pacls.hua),modelValue:s.value,"onUpdate:modelValue":M[2]||(M[2]=x=>s.value=x)},null,8,["class","modelValue"]),p(Ji,{modelValue:s.value,"onUpdate:modelValue":M[3]||(M[3]=x=>s.value=x)},null,8,["modelValue"]),f("div",{class:m(w.pacls.preview)},[f("div",{class:m(w.pacls.previewColor),style:K({backgroundColor:s.value.toRGB()})},null,6)],2)],2),f("div",{class:m(w.pacls.tools)},[p(ee,{options:o,teleport:"none",modelValue:d.value,"onUpdate:modelValue":M[4]||(M[4]=x=>d.value=x),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Ee(f("input",{type:"text","onUpdate:modelValue":M[5]||(M[5]=x=>E.value=x),onMousedown:M[6]||(M[6]=ne(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Ne,E.value]]),f("button",{type:"button",class:m(w.pacls.confirm),onClick:O},"确定",2)],2)],6)],2)]),default:we(()=>[f("div",{class:m({[w.classes.colorPickerInput]:!0,[w.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[nt(w.$slots,"default",{},()=>[f("span",{class:m(w.classes.colorBlock),style:K(g.value)},null,6)]),n.showText?(R(),I("div",{key:0,class:m(w.classes.colorValue),onClick:M[0]||(M[0]=ne(()=>{},["stop"]))},Y(n.modelValue),3)):G("",!0)],2)]),_:3},8,["class","disabled"]))}}),sr="_colorPicker_1egpm_2",ir="_disabled_1egpm_6",rr="_colorPickerInput_1egpm_10",ar="_colorBlock_1egpm_17",cr="_colorValue_1egpm_26",ur="_colorPickerPanel_1egpm_31",dr="_presetPanel_1egpm_45",fr="_colourAtla_1egpm_49",pr="_color_1egpm_2",mr="_presetTools_1egpm_76",gr="_clearBtn_1egpm_82",hr="_indicator_1egpm_83",vr="_none_1egpm_101",br="_recentColors_1egpm_132",yr={colorPicker:sr,disabled:ir,colorPickerInput:rr,colorBlock:ar,colorValue:cr,colorPickerPanel:ur,presetPanel:dr,colourAtla:fr,color:pr,presetTools:mr,clearBtn:gr,indicator:hr,none:vr,recentColors:br},_r="_panel_911zv_2",Er="_sv_911zv_7",Tr="_hua_911zv_11",Sr="_sliders_911zv_15",Rr="_tools_911zv_20",wr="_confirm_911zv_37 quickprint-text-btn",kr="_preview_911zv_44",Cr="_previewColor_911zv_59",Lr={panel:_r,sv:Er,hua:Tr,sliders:Sr,tools:Rr,confirm:wr,preview:kr,previewColor:Cr},Ir={classes:yr,pacls:Lr},$t=z(or,[["__cssModules",Ir]]),Nr=V({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=k({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=k(()=>{const i=l.modelValue;return Vl(i)||i===Be.INHERIT});function r(i){t("select",i)}return(i,c)=>(R(),J($t,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=a=>o.value=a),disabled:n.disabled,onSelect:r},{default:we(()=>[f("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[f("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:K({backgroundColor:o.value})},null,6),f("div",{class:m(i.classes.colorValue)},Y(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),Or="_indicator_14ypk_2",xr="_disabled_14ypk_8",Dr="_colorBlock_14ypk_27",Ar="_colorValue_14ypk_38",Mr="_colorNone_14ypk_45",Br={indicator:Or,disabled:xr,colorBlock:Dr,colorValue:Ar,colorNone:Mr},qr={classes:Br},vn=z(Nr,[["__cssModules",qr]]);function $r(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function Pr(n,e=0){let t=0,l=null;return function(...o){const s=Date.now();if(s-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,o),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,o),t=s}}function po(n,e={}){const t={},l=n.style??{},o=rl(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=Fl(l);return s&&Xe(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),Fr("border",e)&&Xe(t,Zn(n)),Xe(t,Xo(n)),Xe(t,jo(n)),Xe(t,Zo(n)),Xe(t,Ko(n)),t}function Vr(n,e={}){const t=[];let l=n;for(;pe.isDefineElement(l);)t.unshift(po(l,e)),l=l.parent;return Yo({},...t)}function Fr(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const St={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(St.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(St.SPACE).filter(o=>sl(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(St.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(St.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(St.SPACE))}};function tt(n){if(ie(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em|%)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=il(t)?t:null,o=ie(e[2])?null:e[2];return{num:l,unit:o}}function ln(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=tt(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return jn.pt_to_px(e.num);case"mm":return jn.mm_to_px(e.num);default:return null}}function fl(n,e){const t=n.ds;if(t!=null)return t.type===_e.FORMULA?{type:t.type,content:pl(t.value,n.doc)}:t.type===_e.VARIABLE?{type:t.type,content:lt(t.value,e)}:{type:t.type,content:t.value}}function lt(n,e){var v,E,y;if(ie(n))return n;const t=zl(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===kt.BUILTIN)return((v=Kn.find(u=>u.value===s))==null?void 0:v.label)??s;if(t.varType===kt.SPECIAL)return((E=Ns.find(u=>u.value===s))==null?void 0:E.label)??s;if(e==null)return l;const i=(e.fields??[]).find(u=>u.name===s);if(i==null)return l;const c=o[1],a=ie(i.title)?i.name:i.title;if(c==null)return a;const d=(y=i.children)==null?void 0:y.find(u=>u.name===c);if(d==null)return`${a}.${c}`;const g=ie(d.title)?d.name:d.title;return`${a}.${g}`}function pl(n,e){return ie(n)?void 0:Rn.tokenize(n).map(o=>o.type===rt.VARIABLE?`[${lt(o.value,e==null?void 0:e.ds)}]`:o.type===rt.REFERENCE?`[${mo(o.value,e)}]`:o.type===rt.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===rt.VARIABLE?`[${lt(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):Rn.formatTokenValue(o)).join("")}function mo(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===_e.VARIABLE&&t.ds.value?lt(t.ds.value,e.ds):"="+n}function zr(n){switch(zl(n).dataType){case te.OBJECT:return"对象";case te.ARRAY:return"数组";case te.STRING:return"文本";case te.NUMBER:return"数字";case te.DATE:return"日期";case te.BOOLEAN:return"布尔";default:return"未知类型"}}function Ur(n){var e;return((e=eo.find(t=>t.value===n))==null?void 0:e.label)??n}const go=Ul(()=>Hl(()=>import("./component-BzOvwT-C.js"),__vite__mapDeps([0,1]))),Hr=["onClick","onMouseenter"],Gr=V({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=ue(Kn[0].value),o=k(()=>`builtin_${Gl(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,c)=>(R(),I("div",{class:m(i.classes.builtin)},[f("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(R(!0),I(Q,null,re(b(Kn),a=>(R(),I("div",{class:m({[i.classes.param]:!0,[i.classes.active]:a.value===l.value}),onClick:d=>s(a),onMouseenter:d=>r(a)},[f("strong",null,Y(a.label),1),f("span",null,Y(a.value),1)],42,Hr))),256))],2),f("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[p(b(go),{name:o.value},null,8,["name"])],2)],2))}}),Wr="_builtin_m1n0z_2",Yr="_panel_m1n0z_11",Xr="_desc_m1n0z_17",jr="_param_m1n0z_24",Zr="_active_m1n0z_34",Kr={builtin:Wr,panel:Yr,desc:Xr,param:jr,active:Zr},Jr={classes:Kr},Qr=z(Gr,[["__cssModules",Jr]]),Ll=[{label:"文本",value:te.STRING},{label:"数字",value:te.NUMBER},{label:"日期",value:te.DATE},{label:"对象",value:te.OBJECT},{label:"数组",value:te.ARRAY}],ea=V({emit:["select"],props:{doc:{type:ye,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=ke("classes"),o=ot(),s=c(),r=i();function i(){const h=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(T,N,C){var O;if(n.readonly){const w=T[N.name],M=((O=Ll.find(x=>x.value===w))==null?void 0:O.label)??w;return p("div",{class:C.classes.cell},[M])}return p("div",{class:C.classes.cell},[p(ee,{options:Ll,modelValue:T.type,"onUpdate:modelValue":E.bind(null,T),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(T,N,C){return n.readonly?p("div",{class:C.classes.cell},[T[N.name]]):p("div",{class:C.classes.cell},[Ee(p("input",{"onUpdate:modelValue":O=>T.name=O,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Ne,T.name]])])}},{name:"title",title:"标题",width:180,render(T,N,C){return n.readonly?p("div",{class:C.classes.cell},[T[N.name]]):p("div",{class:C.classes.cell},[Ee(p("input",{"onUpdate:modelValue":O=>T.title=O,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Ne,T.title]])])}}];return n.readonly!==!0&&h.push({name:"operate",title:"操作",width:200,render(T,N,C){const O=[p("button",{type:"button",class:"quickprint-text-btn",onClick:d.bind(null,T,C.parent)},[p(F,{icon:"icon-subnode"},null),p("span",null,[le("插入行")])])];return(T.type===te.ARRAY||T.type===te.OBJECT)&&O.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:v.bind(null,T)},[p(F,{icon:"icon-sisternode"},null),p("span",null,[le("插入子级")])])),O.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:g.bind(null,T,C.parent)},[p(F,{icon:"icon-delete"},null),p("span",null,[le("删除")])])),O}}),h}function c(){const h=Jo(n.doc.ds.fields??[]).map(N=>{const C=N.type;return{...N,$expand:C===te.ARRAY||C===te.OBJECT}}),T=ue(h);return T.value.length==0&&T.value.push(a()),T}function a(){return{type:te.STRING,name:"",title:""}}function d(h,T){if(T){const C=T.children??[],O=C.indexOf(h);O>=0&&C.splice(O+1,0,a());return}const N=s.value.indexOf(h);N>=0&&s.value.splice(N+1,0,a())}function g(h,T){if(T){const C=T.children??[],O=C.indexOf(h);O>=0&&C.splice(O,1);return}const N=s.value.indexOf(h);N>=0&&s.value.splice(N,1),s.value.length==0&&s.value.push(a())}function v(h){h.type!==te.ARRAY&&h.type!==te.OBJECT||(h.children==null&&(h.children=[]),h.children.push(a()))}function E(h,T){h.type=T,T===te.ARRAY||T===te.OBJECT?h.$expand=!0:h.children=void 0}function y(){return{fields:s.value.map(T=>ie(T.name)?null:T.type!==te.ARRAY&&T.type!==te.OBJECT?{type:T.type,name:T.name,title:T.title}:{type:T.type,name:T.name,title:T.title,children:(T.children??[]).map(N=>ie(T.name)?null:{type:N.type,name:N.name,title:N.title}).filter(N=>N!=null)}).filter(T=>T!=null)}}function u(h,T){n.readonly===!0&&t("select",h,T)}return o==null||o.useHandle("confirm",y),e({submit:y}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(Qo,{columns:r,data:s.value,onSelect:u},null)])}}}),ta="_form_6lybl_2",na="_readonly_6lybl_6",la="_datasource_6lybl_11",oa={form:ta,readonly:na,datasource:la},sa={classes:oa},ho=z(ea,[["__cssModules",sa]]),ia={class:"quickprint-config-group"},ra={class:"quickprint-config-section quickprint-config-inline"},aa={class:"quickprint-config-content"},ca={class:"quickprint-config-section quickprint-config-inline"},ua={class:"quickprint-config-content"},da={class:"quickprint-config-id"},fa={class:"quickprint-config-section quickprint-config-inline"},pa={class:"quickprint-config-content"},ma={class:"quickprint-config-group"},ga={class:"quickprint-config-group-title"},ha=V({__name:"Detail",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=k(()=>{var l,o;return(o=fl(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:o.content});return(l,o)=>(R(),I("div",{class:m(l.classes.detail)},[f("div",ia,[f("section",ra,[o[0]||(o[0]=f("header",{class:"quickprint-config-header"},"类型",-1)),f("div",aa,Y(b(on)(n.element.type)),1)]),f("section",ca,[o[1]||(o[1]=f("header",{class:"quickprint-config-header"},"标识",-1)),f("div",ua,[f("span",da,Y(n.element.id),1)])]),f("section",fa,[o[2]||(o[2]=f("header",{class:"quickprint-config-header"},"标题",-1)),f("div",pa,Y(n.element.title),1)])]),f("div",ma,[f("div",ga,[o[3]||(o[3]=f("span",null,"数据",-1)),f("span",{class:m(l.classes.type)},Y(b(Ur)(n.element.ds.type)),3)]),f("div",null,Y(t.value),1)])],2))}}),va="_detail_11ox4_2",ba="_type_11ox4_10",ya={detail:va,type:ba},_a={classes:ya},Ea=z(ha,[["__cssModules",_a]]),Ta=V({__name:"index",props:{doc:{type:ye,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=ue();function r(v){return v.reduce((E,y)=>{const u=Array.isArray(y.children)?r(y.children):[];if(sl(y.ds.value)||u.length>0){const h={value:y.id,label:y.title??y.id,data:y,children:u};return E.push(h),E}return E},[])}function i(){const v=l.doc.pages.reduce((y,u)=>y.concat(u.children),[]),E=r(v);return ue(E)}function c(v){s.value=v}function a(v){return v.title?v.title:on(v.type)}function d(v){return Sp(v.type)??"icon-zhanweifu"}function g(v){t("select",v.data)}return(v,E)=>(R(),I("div",{class:m(v.classes.reference)},[f("div",{class:m([v.classes.panel,"quickprint-is-scrollable"])},[p(b(Li),{data:b(o),onNodeHover:c,onNodeClick:g},{default:we(({node:y})=>[p(b(F),{icon:d(y.data)},null,8,["icon"]),f("span",{class:m(v.classes.title)},Y(a(y.data)),3),f("span",{class:m(v.classes.id)},"<"+Y(y.value)+">",3)]),_:1},8,["data"])],2),f("div",{class:m([v.classes.detail,"quickprint-is-scrollable"])},[s.value?(R(),J(Ea,{element:s.value.data,key:s.value.value},null,8,["element"])):G("",!0)],2)],2))}}),Sa="_reference_1ekkx_2",Ra="_panel_1ekkx_12",wa="_detail_1ekkx_20",ka="_title_1ekkx_25",Ca="_id_1ekkx_29",La={reference:Sa,panel:Ra,detail:wa,title:ka,id:Ca},Ia={classes:La},Na=z(Ta,[["__cssModules",Ia]]),Oa=V({__name:"index",props:{doc:{type:ye,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=ot();function t(r,i){return r==null?null:i==null?`${kt.DS}.${r.type}.${r.name}`:`${kt.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${kt.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(R(),I("div",{class:m(r.classes.var)},[n.active==="ds"?(R(),J(ho,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):G("",!0),n.active==="builtin"?(R(),J(Qr,{key:1,onSelect:o})):G("",!0),n.active==="reference"?(R(),J(Na,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):G("",!0)],2))}}),xa={var:"_var_12wxd_2"},Da={classes:xa},vo=z(Oa,[["__cssModules",Da]]),Aa=["onClick","onMouseenter"],Ma=V({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var c;const t=n,l=e,o=ue((c=t.options[0])==null?void 0:c.value),s=k(()=>`${t.type}_${o.value.toLowerCase()}`);function r(a){l("select",a.value)}function i(a){o.value=a.value}return(a,d)=>(R(),I("div",{class:m(a.classes.doc)},[f("div",{class:m(["quickprint-is-scrollable",a.classes.panel])},[(R(!0),I(Q,null,re(n.options,g=>(R(),I("div",{key:g.value,class:m({[a.classes.option]:!0,[a.classes.active]:g.value===o.value}),onClick:v=>r(g),onMouseenter:v=>i(g)},[f("strong",null,Y(g.label),1)],42,Aa))),128))],2),f("div",{class:m(["quickprint-is-scrollable",a.classes.desc])},[p(b(go),{name:s.value},null,8,["name"])],2)],2))}}),Ba="_doc_1pdoc_2",qa="_panel_1pdoc_10",$a="_desc_1pdoc_16",Pa="_option_1pdoc_23",Va="_active_1pdoc_33",Fa={doc:Ba,panel:qa,desc:$a,option:Pa,active:Va},za={classes:Fa},Zt=z(Ma,[["__cssModules",za]]),Ua=V({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=ot(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(c){return e==null?void 0:e.confirm({type:"function",value:`${c}()`})}return(c,a)=>(R(),I("div",{class:m(c.classes.function)},[n.active==="string"?(R(),J(Zt,{options:t,onSelect:i,key:"string"})):G("",!0),n.active==="number"?(R(),J(Zt,{options:l,onSelect:i,key:"number"})):G("",!0),n.active==="logical"?(R(),J(Zt,{options:o,onSelect:i,key:"logical"})):G("",!0),n.active==="date"?(R(),J(Zt,{options:s,onSelect:i,key:"date"})):G("",!0),n.active==="aggregate"?(R(),J(Zt,{options:r,onSelect:i,key:"aggregate"})):G("",!0)],2))}}),Ha={function:"_function_19szx_2"},Ga={classes:Ha},Wa=z(Ua,[["__cssModules",Ga]]),Ya=["onMouseenter"],Xa=["onClick"],ja={key:1},Za=V({__name:"Formula",props:{doc:{type:ye,default:null}},setup(n){const e=n,t=ot(),l=[{id:"pageNumber",name:"页码",options:c(Ms)}],o=ue(l[0]);function s(a){o.value=a}function r(a){return t==null?void 0:t.confirm({type:"formula",value:a})}function i(a){const d=Rn.tokenize(a),g=e.doc;return d.reduce((v,E)=>{if(E.type===rt.VARIABLE)return v.push({type:"highlight",value:lt(E.value,g==null?void 0:g.ds)}),v;if(E.type===rt.REFERENCE)return v.push({type:"highlight",value:mo(E.value,g)}),v;if(E.type===rt.TEMPLATE){const u=(Array.isArray(E.value)?E.value:[E.value]).map(h=>h.type===rt.VARIABLE?{type:"highlight",value:lt(h.value,g.ds)}:{type:"text",value:h.value});return v.concat(u)}return v.push({type:"text",value:Rn.formatTokenValue(E)}),v},[])}function c(a){return a.map(d=>({nodes:i(d),value:d}))}return(a,d)=>(R(),I("div",{class:m(a.classes.formula)},[f("div",{class:m([a.classes.left,"quickprint-is-scrollable"])},[(R(),I(Q,null,re(l,g=>f("div",{key:g.name,onMouseenter:v=>s(g),class:m({[a.classes.group]:!0,[a.classes.active]:g.id===o.value.id})},Y(g.name),43,Ya)),64))],2),f("div",{class:m(a.classes.right)},[(R(!0),I(Q,null,re(o.value.options,(g,v)=>(R(),I("div",{key:v,class:m(a.classes.code),onClick:E=>r(g.value)},[(R(!0),I(Q,null,re(g.nodes,E=>(R(),I(Q,null,[E.type==="highlight"?(R(),I("span",{key:0,class:m(a.classes.highlight)},"["+Y(E.value)+"]",3)):(R(),I("span",ja,Y(E.value),1))],64))),256)),f("span",{class:m(a.classes.badge)},"插入",2)],10,Xa))),128))],2)],2))}}),Ka="_formula_ms7c3_2",Ja="_left_ms7c3_12",Qa="_right_ms7c3_17",ec="_group_ms7c3_24",tc="_active_ms7c3_34",nc="_highlight_ms7c3_39",lc="_code_ms7c3_43",oc="_badge_ms7c3_65",sc={formula:Ka,left:Ja,right:Qa,group:ec,active:tc,highlight:nc,code:lc,badge:oc},ic={classes:sc},rc=z(Za,[["__cssModules",ic]]),ml=xe(function(n){return mt("变量",(e,t)=>p(vo,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(De)}),ac=xe(function(n){return ut("数据源",p(ho,{doc:n},null),{preset:"variable",icon:p(F,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(De)}),cc=xe(function(n){const e=["ds","builtin","reference"];return mt("变量",(t,l)=>p(vo,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(De)}),uc=xe(function(){return mt("函数",(n,e)=>p(Wa,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(De)}),dc=xe(function(n){return ut("公式",p(rc,{doc:n.doc},null),{preset:"variable"}).promisify().catch(De)}),fc={key:1},pc=V({__name:"Content",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Se(),l=Gt("editorRef"),o=Gt("contentRef"),s=ue(!1),r=k(()=>{const d=e.element.type===j.TABLE_CELL?Vr(e.element,{exclude:["border"]}):po(e.element);return d.color&&(d["--quickprint-element-var-color"]=d.color),s.value&&(d.alignItems="flex-start"),d}),i=k(()=>{const d=fl(e.element,t.doc.ds);return d==null||d.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:d.type===_e.CONST?"span":"strong",content:d.content},{tag:"span",content:e.element.attributes.suffix}]});async function c(){var E;const d=await ml({doc:t.doc,value:e.element.ds.value}).catch(Ke);if(d==null||(e.element.setDataSource(_e.VARIABLE,d.value),e.element.type!=j.TABLE_CELL||d.type!=="ds"))return;const g=e.element.parent;if(g==null||g.isBindVariable||((E=d.parent)==null?void 0:E.type)!==te.ARRAY)return;const v=d.parent;g.setDataSource(_e.VARIABLE,`${kt.DS}.${v.type}.${v.name}`)}function a(){const d=l.value,g=o.value;d==null||g==null||(s.value=g.offsetHeight>d.offsetHeight)}return(d,g)=>(R(),I("div",{class:"quickprint-is-element-editor",style:K(r.value),onVnodeMounted:a,ref_key:"editorRef",ref:l},[f("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:o},[f("span",{class:m({[d.classes.lineThrough]:n.element.style.lineThrough})},[(R(!0),I(Q,null,re(i.value,(v,E)=>(R(),I(Q,{key:E},[v.tag=="strong"?(R(),I("strong",{key:0,class:m(d.classes.highlight)},"["+Y(v.content)+"]",3)):(R(),I("span",fc,Y(v.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(R(),J(b(F),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(d.classes.dsIcon),onClick:c,onPointerdown:g[0]||(g[0]=ne(()=>{},["stop"]))},null,8,["class"])):G("",!0)],4))}}),mc="_dsIcon_ss96n_2",gc="_lineThrough_ss96n_10",hc="_highlight_ss96n_14",vc={dsIcon:mc,lineThrough:gc,highlight:hc},bc={classes:vc},Dn=z(pc,[["__cssModules",bc]]),yc=V({__name:"TextEditor",props:{element:{type:es,required:!0}},setup(n){return(e,t)=>(R(),J(Dn,{element:n.element},null,8,["element"]))}}),An=Object.freeze({title:"文本",icon:"icon-text",type:j.TEXT,editor:yc,onCreate(){return pe.create({type:j.TEXT,width:Ct,height:On})}}),_c=V({__name:"NumberEditor",props:{element:{type:ts,required:!0}},setup(n){return(e,t)=>(R(),J(Dn,{element:n.element},null,8,["element"]))}}),Ec=["value","disabled"],Tc=V({__name:"RadioButton",props:It({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=sn(n,"modelValue");return(t,l)=>(R(),I("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(R(!0),I(Q,null,re(n.options,o=>(R(),I("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[Ee(f("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,Ec),[[_s,e.value]]),f("span",null,Y(o.label),1)],2))),256))],2))}}),Sc="_radioGroup_67myk_2",Rc="_compacted_67myk_10",wc="_radio_67myk_2",kc="_selected_67myk_50",Cc="_disabled_67myk_56",Lc={radioGroup:Sc,compacted:Rc,radio:wc,selected:kc,disabled:Cc},Ic={classes:Lc},Mt=z(Tc,[["__cssModules",Ic]]),Nc={class:"quickprint-config-section quickprint-config-inline"},Oc={class:"quickprint-config-content"},xc={class:"quickprint-config-section quickprint-config-inline"},Dc={class:"quickprint-config-content"},Ac={class:"quickprint-config-section quickprint-config-inline"},Mc={class:"quickprint-config-content"},Bc={class:"quickprint-config-section quickprint-config-inline"},qc={class:"quickprint-config-content"},$c=V({__name:"NumberConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=k({get(){return e.element.attributes.round??Jt.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=k({get(){return e.element.attributes.format??yt.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(R(),I(Q,null,[f("section",Nc,[r[4]||(r[4]=f("header",{class:"quickprint-config-header"},"小数位数",-1)),f("div",Oc,[Ee(f("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ne,n.element.attributes.precision]])])]),f("section",xc,[r[5]||(r[5]=f("header",{class:"quickprint-config-header"},"舍入规则",-1)),f("div",Dc,[p(b(ee),{options:b(ks),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",Ac,[r[6]||(r[6]=f("header",{class:"quickprint-config-header"},"显示类型",-1)),f("div",Mc,[p(b(ee),{options:b(Cs),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",Bc,[r[7]||(r[7]=f("header",{class:"quickprint-config-header"},"值为0时",-1)),f("div",qc,[p(Mt,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:b(Ls),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),Mn=Object.freeze({title:"数字",type:j.NUMBER,icon:"icon-number",editor:_c,config:{display:$c},onCreate(){return pe.create({type:j.NUMBER,width:Ct,height:On})}}),Pc=V({__name:"DateEditor",props:{element:{type:ns,required:!0}},setup(n){return(e,t)=>(R(),J(Dn,{element:n.element},null,8,["element"]))}}),Vc={class:"quickprint-config-section"},Fc={class:"quickprint-config-content"},zc=V({__name:"DateConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=k(()=>[{label:"原始值",value:t.NONE},...to]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(R(),I("section",Vc,[f("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=f("span",null,"格式",-1)),p(b(ee),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:we(()=>[f("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),f("div",Fc,[Ee(f("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ne,n.element.attributes.format]])])]))}}),Uc="_header_79607_2",Hc="_picker_79607_8",Gc="_placeholder_79607_15",Wc={header:Uc,picker:Hc,placeholder:Gc},Yc={classes:Wc},Xc=z(zc,[["__cssModules",Yc]]),Bn=Object.freeze({title:"日期",type:j.DATE,icon:"icon-date",editor:Pc,config:{display:Xc},onCreate(){return pe.create({type:j.DATE,width:Ct,height:On})}}),jc=["x1","y1","x2","y2"],Zc=V({__name:"Diagonal",props:{mode:{type:Number,default:0},labels:{type:Array,default:null},width:{type:Number,default:null},height:{type:Number,default:null}},setup(n){const e=ke("classes"),t=n,l=k(()=>t.mode===Re.TL_BR?{x1:"0",y1:"0",x2:"100%",y2:"100%"}:t.mode===Re.TR_BL?{x1:"100%",y1:"0",x2:"0",y2:"100%"}:null),o=k(()=>({[e.biagonal]:!0,[e.tlbr]:t.mode===Re.TL_BR,[e.trbl]:t.mode===Re.TR_BL})),s=k(()=>({width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"})),r=k(()=>{var c,a;return(a=(c=t.labels)==null?void 0:c[0])==null?void 0:a.text}),i=k(()=>{var c,a;return(a=(c=t.labels)==null?void 0:c[1])==null?void 0:a.text});return(c,a)=>(R(),I("div",{class:m(o.value),style:K(s.value)},[l.value?(R(),I("svg",{key:0,"aria-hidden":"true",class:m(b(e).line)},[f("line",{x1:l.value.x1,y1:l.value.y1,x2:l.value.x2,y2:l.value.y2},null,8,jc)],2)):G("",!0),r.value?(R(),I("div",{key:1,class:m(b(e).firstLabel)},Y(r.value),3)):G("",!0),i.value?(R(),I("div",{key:2,class:m(b(e).secondLabel)},Y(i.value),3)):G("",!0)],6))}}),Kc="_biagonal_17a80_2",Jc="_firstLabel_17a80_9",Qc="_secondLabel_17a80_10",eu="_tlbr_17a80_15",tu="_trbl_17a80_26",nu="_line_17a80_37",lu={biagonal:Kc,firstLabel:Jc,secondLabel:Qc,tlbr:eu,trbl:tu,line:nu},ou={classes:lu},Qn=z(Zc,[["__cssModules",ou]]),su=["colspan","rowspan"],iu=V({__name:"TableCellEditor",props:{element:{type:wn,required:!0}},setup(n){const e=n,t=k(()=>e.element.isCollapsed),l=k(()=>{const a=e.element.attributes.diagonalMode;return a==null?!1:a!==Re.NONE}),o=Se(),s=ke("classes"),r=k(()=>{const a=e.element,d=a.parent;return{[s.cell]:!0,[X.SELECTED]:(d==null?void 0:d.isSelected)||a.isSelected}}),i=k(()=>{var g;const a=Zn((g=e.element.parent)==null?void 0:g.parent),d=Zn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Xe(a,d)}});function c(a){a.button==0&&o.selectElement(e.element)}return(a,d)=>t.value?G("",!0):(R(),I("td",Zl({key:0,[`.${b(He)||""}`]:n.element,class:r.value,style:i.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:ne(c,["stop"])}),[l.value?(R(),J(Qn,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight},null,8,["mode","labels","width","height"])):(R(),J(Dn,{key:1,element:n.element,class:m(b(s).content)},null,8,["element","class"]))],48,su))}}),ru="_cell_rp1x6_2",au="_content_rp1x6_31",cu={cell:ru,content:au},uu={classes:cu},bo=z(iu,[["__cssModules",uu]]);function gl(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const du=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:se.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],yo=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],_o=[{label:"默认",value:se.DEFAULT},...yo],qn=[{label:"默认",value:se.DEFAULT},...du,...yo],hl=[{label:"默认",value:Te.DEFAULT},{label:"初号",value:Te.SIZE_0+"pt",short:"56px"},{label:"小初",value:Te.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:Te.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:Te.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:Te.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:Te.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:Te.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:Te.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:Te.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:Te.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:Te.SIZE_5+"pt",short:"14px"},{label:"小五",value:Te.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],Eo=[{label:"默认",value:_t.DEFAULT},{label:"1.0",value:_t.TIMES_1,short:"单倍行距"},{label:"1.1",value:_t.TIMES_1_1},{label:"1.5",value:_t.TIMES_1_5},{label:"2.0",value:_t.TIMES_2,short:"两倍行距"}],fu=[{label:"无",value:pn.NONE},{label:"实线",value:xt.SOLID},{label:"虚线",value:xt.DASHED},{label:"点划线",value:xt.DOTTED},{label:"双实线",value:xt.DOUBLE},{label:"波浪线",value:xt.WAVY}],pu=[{label:"无",value:ae.NONE},{label:"实线",value:ae.SOLID},{label:"虚线",value:ae.DASHED},{label:"点划线",value:ae.DOTTED},{label:"双实线",value:ae.DOUBLE}],mu=[{label:"默认",value:Et.AUTO},{label:"左对齐",value:Et.LEFT},{label:"居中对齐",value:Et.CENTER},{label:"右对齐",value:Et.RIGHT},{label:"两端对齐",value:Et.JUSTIFY}],el=[{label:"顶部对齐",value:Je.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Je.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Je.BOTTOM,icon:"icon-vertical-align-bottom"}],tl=[{label:"左对齐",value:at.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:at.CENTER,icon:"icon-align-center"},{label:"右对齐",value:at.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:at.JUSTIFY,icon:"icon-menu"}],gu={class:"quickprint-is-row"},hu=["onClick"],vu=V({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=ke("classes"),o=e,s=n,r=fe(),i=k(()=>({height:s.height})),c=k({get(){return tt(s.modelValue).num??void 0},set(y){if(y==""||ls(y)||y<0){g(void 0);return}const u=tt(s.modelValue);g(`${y}${u.unit}`)}}),a=k({get(){return tt(s.modelValue).unit??be.PX},set(y){const u=tt(s.modelValue);g(`${u.num}${y}`)}});function d(y){const u=y===Te.DEFAULT?void 0:y;o("update:modelValue",u)}function g(y){o("update:modelValue",y),E()}function v(y){const u=s.modelValue;return u==null&&y.value===Te.DEFAULT?!0:u===y.value}async function E(){await Ht();const y=document.querySelector("."+l.fontSelected);y&&y.scrollIntoView({block:"nearest"})}return(y,u)=>(R(),I("div",{class:m(b(l).fontSize),style:K(i.value)},[f("div",gu,[Ee(f("input",{type:"number",placeholder:"请输入",class:m(["quickprint-form-control",b(l).input]),min:0,"onUpdate:modelValue":u[0]||(u[0]=h=>c.value=h)},null,2),[[Ne,c.value]]),p(b(ee),{width:"54px",options:t,modelValue:a.value,"onUpdate:modelValue":u[1]||(u[1]=h=>a.value=h)},null,8,["modelValue"])]),f("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(l).fonts]),ref_key:"scrollRef",ref:r},[(R(!0),I(Q,null,re(b(hl),h=>(R(),I("div",{key:h.value,class:m({[b(l).option]:!0,[b(l).fontSelected]:v(h)}),onClick:T=>d(h.value)},[f("span",null,Y(h.label),1)],10,hu))),128))],2)],6))}}),bu="_input_9oh9n_2",yu="_fontSize_9oh9n_8",_u="_fonts_9oh9n_13",Eu="_option_9oh9n_25",Tu="_fontSelected_9oh9n_34",Su={input:bu,fontSize:yu,fonts:_u,option:Eu,fontSelected:Tu},Ru={classes:Su},To=z(vu,[["__cssModules",Ru]]),wu=["title"],ku={key:0},Cu="中文字体 AbBbCc",Lu=V({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k(()=>qn.map(u=>(u.style={fontFamily:u.value==se.DEFAULT?se.SONG:u.value},u))),l=k(()=>_o.map(u=>(u.style={fontFamily:u.value==se.DEFAULT?se.SONG:u.value},u))),o=k({get(){const u=e.options.style.fontFamily;return ie(u)?se.DEFAULT:u},set(u){e.options.style.fontFamily=u==se.DEFAULT?void 0:u}}),s=k({get(){const u=e.options.style.enFontFamily;return ie(u)?se.DEFAULT:u},set(u){e.options.style.enFontFamily=u==se.DEFAULT?void 0:u}}),r=k({get(){const u=e.options.style.color;return ie(u)?Be.INHERIT:u},set(u){e.options.style.color=u==Be.INHERIT?void 0:u}}),i=k({get(){const u=e.options.style.highlightColor;return ie(u)?Be.INHERIT:u},set(u){e.options.style.highlightColor=u==Be.INHERIT?void 0:u}}),c=k({get(){return e.options.style.fontSize},set(u){const h=ie(u)?void 0:u;e.options.style.fontSize=h}}),a=k({get(){return e.options.style.fontWeight===700},set(u){e.options.style.fontWeight=u?700:void 0}}),d=k({get(){return e.options.style.fontStyle==="italic"},set(u){e.options.style.fontStyle=u?"italic":void 0}}),g=k({get(){return e.options.style.lineThrough===!0},set(u){e.options.style.lineThrough=u?!0:void 0}}),v=k({get(){const u=e.options.style.underline;if(u==null||u===!1)return pn.NONE;const h=e.options.style.underlineStyle;return ie(h)?xt.SOLID:h},set(u){if(u===pn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=u}}),E=k({get(){const u=e.options.style.underlineColor;return ie(u)?Be.INHERIT:u},set(u){e.options.style.underlineColor=u==Be.INHERIT?void 0:u}}),y=k(()=>{const u=e.options.style,h={},T=rl(u.fontFamily,u.enFontFamily);T&&(h.fontFamily=T);const N=Fl(u);return N&&Xe(h,N),u.fontSize&&(h.fontSize=u.fontSize),u.fontWeight&&(h.fontWeight=u.fontWeight),u.color&&(h.color=u.color),u.fontStyle&&(h.fontStyle=u.fontStyle),u.highlightColor&&(h["--quickprint-variable-highlight-color"]=u.highlightColor),h});return(u,h)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",u.classes.font])},[f("div",{class:m(u.classes.fontFamily)},[f("div",{class:m(u.classes.config)},[f("div",{class:m(u.classes.title)},"中文字体",2),f("div",{class:m(u.classes.content)},[p(b(ee),{options:t.value,modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=T=>o.value=T)},null,8,["options","modelValue"])],2)],2),f("div",{class:m(u.classes.config)},[f("div",{class:m(u.classes.title)},"颜色",2),p(b(vn),{modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=T=>r.value=T)},null,8,["modelValue"])],2),f("div",{class:m([u.classes.config,u.classes.fontSize])},[f("div",{class:m(u.classes.title)},"字号",2),p(To,{modelValue:c.value,"onUpdate:modelValue":h[2]||(h[2]=T=>c.value=T),height:"144px"},null,8,["modelValue"])],2),f("div",{class:m(u.classes.config)},[f("div",{class:m(u.classes.title)},"西文字体",2),f("div",{class:m(u.classes.content)},[p(b(ee),{options:l.value,modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=T=>s.value=T)},null,8,["options","modelValue"])],2)],2),f("div",{class:m(u.classes.config)},[f("div",{class:m(u.classes.title)},"前景色",2),p(b(vn),{modelValue:i.value,"onUpdate:modelValue":h[4]||(h[4]=T=>i.value=T)},null,8,["modelValue"])],2),f("div",{class:m(u.classes.config)},[f("div",{class:m(u.classes.title)},"下划线",2),f("div",{class:m(u.classes.content)},[p(b(ee),{modelValue:v.value,"onUpdate:modelValue":h[5]||(h[5]=T=>v.value=T),options:b(fu),width:"138px"},{option:we(({option:T})=>[f("div",{title:T.label,class:m(u.classes.option)},[T.value==b(pn).NONE?(R(),I("div",ku,Y(T.label),1)):(R(),I("div",{key:1,class:m(u.classes.line),style:K({textDecorationStyle:T.value})},"--",6))],10,wu)]),_:1},8,["modelValue","options"])],2)],2),f("div",{class:m(u.classes.config)},[f("div",{class:m(u.classes.title)},"线条颜色",2),f("div",{class:m(u.classes.content)},[p(b(vn),{modelValue:E.value,"onUpdate:modelValue":h[6]||(h[6]=T=>E.value=T),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),f("div",{class:m(u.classes.fieldset)},[h[13]||(h[13]=f("header",null,"效果",-1)),f("div",{class:m(u.classes.configs)},[f("label",{class:m(u.classes.checkbox)},[Ee(f("input",{type:"checkbox","onUpdate:modelValue":h[7]||(h[7]=T=>a.value=T)},null,512),[[Wn,a.value]]),h[10]||(h[10]=f("span",null,"粗体",-1))],2),f("label",{class:m(u.classes.checkbox)},[Ee(f("input",{type:"checkbox","onUpdate:modelValue":h[8]||(h[8]=T=>d.value=T)},null,512),[[Wn,d.value]]),h[11]||(h[11]=f("span",null,"斜体",-1))],2),f("label",{class:m(u.classes.checkbox)},[Ee(f("input",{type:"checkbox","onUpdate:modelValue":h[9]||(h[9]=T=>g.value=T)},null,512),[[Wn,g.value]]),h[12]||(h[12]=f("span",null,"删除线",-1))],2)],2)],2),f("div",{class:m(u.classes.fieldset)},[h[14]||(h[14]=f("header",null,"预览",-1)),f("div",{class:m(u.classes.preview)},[f("span",{style:K(y.value)},[f("span",{class:m({[u.classes.lineThrough]:n.options.style.lineThrough})},Y(Cu),2)],4)],2)],2)],2))}}),Iu="_font_5dh9t_2",Nu="_fontFamily_5dh9t_7",Ou="_config_5dh9t_14",xu="_fontSize_5dh9t_19",Du="_fieldset_5dh9t_23",Au="_title_5dh9t_39",Mu="_configs_5dh9t_44",Bu="_checkbox_5dh9t_50",qu="_option_5dh9t_65",$u="_line_5dh9t_73",Pu="_preview_5dh9t_84",Vu="_lineThrough_5dh9t_99",Fu={font:Iu,fontFamily:Nu,config:Ou,fontSize:xu,fieldset:Du,title:Au,configs:Mu,checkbox:Bu,option:qu,line:$u,preview:Pu,lineThrough:Vu},zu={classes:Fu},Uu=z(Lu,[["__cssModules",zu]]),Hu=["placeholder","min","disabled"],Gu=V({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=k(()=>{const c=l.defaultUnit;return l.options.some(a=>a.value===c)?c:l.options[0].value}),s=k({get(){return tt(l.modelValue).num},set(c){if(il(c)){const d=tt(l.modelValue).unit??o.value;return i(`${c}${d}`)}i()}}),r=k({get(){return tt(l.modelValue).unit??o.value},set(c){const d=tt(l.modelValue).num??l.min;i(`${d}${c}`)}});function i(c=void 0){t("update:modelValue",c)}return(c,a)=>(R(),I("div",{class:m(c.classes.input)},[Ee(f("input",{type:"number","onUpdate:modelValue":a[0]||(a[0]=d=>s.value=d),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,Hu),[[Ne,s.value]]),p(b(ee),{modelValue:r.value,"onUpdate:modelValue":a[1]||(a[1]=d=>r.value=d),class:m(c.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),Wu="_input_gtdaq_2",Yu="_unit_gtdaq_14",Xu={input:Wu,unit:Yu},ju={classes:Xu},Fe=z(Gu,[["__cssModules",ju]]),Zu="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",Ku=V({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:be.NONE},{label:"磅",value:be.PT},{label:"像素",value:be.PX}],l=[{label:"字符",value:be.EM},{label:"磅",value:be.PT},{label:"像素",value:be.PX}],o=[{label:"毫米",value:be.MM},{label:"磅",value:be.PT},{label:"像素",value:be.PX}],s=k({get(){return e.options.style.textAlign??at.LEFT},set(h){const T=h===at.LEFT?void 0:h;e.options.style.textAlign=T}}),r=k({get(){return e.options.style.textAlignLast??Et.AUTO},set(h){const T=h===Et.AUTO?void 0:h;e.options.style.textAlignLast=T}}),i=k({get(){return e.options.style.verticalAlign??Je.MIDDLE},set(h){const T=h===Je.MIDDLE?void 0:h;e.options.style.verticalAlign=T}}),c=y("paddingTop"),a=y("paddingBottom"),d=y("paddingLeft"),g=y("paddingRight"),v=k(()=>{const h=e.options.style,T={};return h.textAlign&&(T.textAlign=h.textAlign),h.textAlignLast&&(T.textAlignLast=h.textAlignLast),h.textIndent&&(T.textIndent=h.textIndent),h.lineHeight&&(T.lineHeight=h.lineHeight),Xe(T,u(h.verticalAlign)),T}),E=k(()=>{const h=e.options.style,T={};return T["--openprint-paragraph-preview-padding-top"]=h.paddingTop??"2px",T["--openprint-paragraph-preview-padding-right"]=h.paddingRight??"2px",T["--openprint-paragraph-preview-padding-bottom"]=h.paddingBottom??"2px",T["--openprint-paragraph-preview-padding-left"]=h.paddingLeft??"2px",T});function y(h){return k({get(){return e.options.style[h]},set(T){const N=ie(T)?void 0:T;e.options.style[h]=N}})}function u(h){return h==null?{}:h==Je.MIDDLE||h==null?{display:"flex",alignItems:"center"}:h==Je.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(h,T)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",h.classes.paragraph])},[f("div",{class:m(h.classes.textAlign)},[f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"文本对齐",2),p(b(ee),{options:b(tl),modelValue:s.value,"onUpdate:modelValue":T[0]||(T[0]=N=>s.value=N)},null,8,["options","modelValue"])],2),f("div",{class:m(h.classes.alignLast)},[f("div",{class:m(h.classes.configItemLabel)},"最后一行",2),p(b(ee),{options:b(mu),modelValue:r.value,"onUpdate:modelValue":T[1]||(T[1]=N=>r.value=N)},null,8,["options","modelValue"])],2)],2),f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"垂直对齐",2),p(b(ee),{options:b(el),modelValue:i.value,"onUpdate:modelValue":T[2]||(T[2]=N=>i.value=N)},null,8,["options","modelValue"])],2),f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"首行缩进",2),p(Fe,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":T[3]||(T[3]=N=>n.options.style.textIndent=N),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.configItem)},[f("div",{class:m(h.classes.configItemLabel)},"行高",2),p(Fe,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":T[4]||(T[4]=N=>n.options.style.lineHeight=N),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.fieldset)},[T[9]||(T[9]=f("header",null,"内边距",-1)),f("div",{class:m(h.classes.padding)},[f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"上边距",2),p(Fe,{modelValue:b(c),"onUpdate:modelValue":T[5]||(T[5]=N=>Qe(c)?c.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"下边距",2),p(Fe,{modelValue:b(a),"onUpdate:modelValue":T[6]||(T[6]=N=>Qe(a)?a.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"左边距",2),p(Fe,{modelValue:b(d),"onUpdate:modelValue":T[7]||(T[7]=N=>Qe(d)?d.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(h.classes.paddingItem)},[f("label",{class:m(h.classes.paddingItemLabel)},"右边距",2),p(Fe,{modelValue:b(g),"onUpdate:modelValue":T[8]||(T[8]=N=>Qe(g)?g.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),f("div",{class:m(h.classes.fieldset)},[T[10]||(T[10]=f("header",null,"预览",-1)),f("div",{class:m(h.classes.preview),style:K(v.value)},[f("div",{style:K(E.value),class:m(h.classes.previewText)},[le(Y(Zu)+" "),f("div",{class:m(h.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),Ju="_paragraph_1ex97_2",Qu="_fieldset_1ex97_7",ed="_preview_1ex97_23",td="_textAlign_1ex97_34 quickprint-is-row",nd="_configItem_1ex97_39 quickprint-is-row",ld="_alignLast_1ex97_44 quickprint-is-row",od="_configItemLabel_1ex97_54",sd="_padding_1ex97_59",id="_paddingItem_1ex97_66",rd="_paddingItemLabel_1ex97_72",ad="_previewText_1ex97_77",cd="_paddingPreview_1ex97_86",ud={paragraph:Ju,fieldset:Qu,preview:ed,textAlign:td,configItem:nd,alignLast:ld,configItemLabel:od,padding:sd,paddingItem:id,paddingItemLabel:rd,previewText:ad,paddingPreview:cd},dd={classes:ud},fd=z(Ku,[["__cssModules",dd]]),pd=["title","onClick"],md={key:0},gd=V({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=ke("classes"),t=n,l=[{label:"像素",value:be.PX},{label:"毫米",value:be.MM},{label:"磅",value:be.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=ue(),i=k(()=>{const _=r.value;return _==null?"全部边框":s[_]}),c=k(()=>{const _=r.value;return _==null?!0:_<=o.BORDER_LEFT}),a=k(()=>{const _=r.value;return _==null?!0:_>=o.RADIUS_TOP_LEFT}),d=k(()=>{const _=r.value;return{[e.box]:!0,[e.highlightTop]:_==o.BORDER_TOP,[e.highlightRight]:_==o.BORDER_RIGHT,[e.highlightBottom]:_==o.BORDER_BOTTOM,[e.highlightLeft]:_==o.BORDER_LEFT,[e.highlightTopLeft]:_==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:_==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:_==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:_==o.RADIUS_BOTTOM_RIGHT}}),g=k(()=>({...C(o.BORDER_TOP),...C(o.BORDER_RIGHT),...C(o.BORDER_BOTTOM),...C(o.BORDER_LEFT),...N()})),v=k({get(){var q;const _=t.options.style,S=r.value;if(S==null||S>o.BORDER_LEFT)return _.borderWidth;const A=(q=T(S))==null?void 0:q.width;if(A!=null)return Reflect.get(_,A)},set(_){const S=t.options.style,A=r.value,q=_??void 0;if(A==null||A>o.BORDER_LEFT){S.borderWidth=q;return}const B=T(A);B!=null&&Reflect.set(S,B.width,q)}}),E=k({get(){var q;const _=t.options.style,S=r.value;if(S==null||S>o.BORDER_LEFT)return _.borderStyle??ae.NONE;const A=(q=T(S))==null?void 0:q.style;return A==null?ae.NONE:Reflect.get(_,A)??ae.NONE},set(_){const S=t.options.style,A=r.value,q=_==null||_==ae.NONE?void 0:_;if(A==null||A>o.BORDER_LEFT){S.borderStyle=q;return}const B=T(A);B!=null&&Reflect.set(S,B.style,q)}}),y=k({get(){var q;const _=t.options.style,S=r.value;if(S==null||S>o.BORDER_LEFT)return _.borderColor;const A=(q=T(S))==null?void 0:q.color;return A==null?Be.INHERIT:Reflect.get(_,A)??Be.INHERIT},set(_){const S=t.options.style,A=r.value,q=_??void 0;if(A==null||A>o.BORDER_LEFT){S.borderColor=q;return}const B=T(A);B!=null&&Reflect.set(S,B.color,q)}}),u=k({get(){const _=t.options.style,S=r.value;if(S==null||S<=o.BORDER_LEFT)return _.borderRadius;const A=h(S);if(A!=null)return Reflect.get(_,A)},set(_){const S=t.options.style,A=r.value,q=_??void 0;if(A==null||A<=o.BORDER_LEFT){S.borderRadius=q;return}const B=h(A);B!=null&&Reflect.set(S,B,q)}});function h(_){switch(_){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function T(_){switch(_){case o.BORDER_TOP:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case o.BORDER_RIGHT:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case o.BORDER_BOTTOM:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case o.BORDER_LEFT:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function N(){const _=t.options.style;return{borderTopLeftRadius:_.borderTopLeftRadius??_.borderRadius,borderTopRightRadius:_.borderTopRightRadius??_.borderRadius,borderBottomRightRadius:_.borderBottomRightRadius??_.borderRadius,borderBottomLeftRadius:_.borderBottomLeftRadius??_.borderRadius}}function C(_){const S=t.options.style;if(_==null||_>o.BORDER_LEFT){const B=S.borderStyle;return B==null||B==ae.NONE?{borderStyle:ae.NONE}:{}}const A=T(_);if(A==null)return{};const q=Reflect.get(S,A.style)??Reflect.get(S,"borderStyle");return q==null||q===ae.NONE?{}:{[A.style]:q??S.borderStyle,[A.width]:Reflect.get(S,A.width)??S.borderWidth,[A.color]:Reflect.get(S,A.color)??S.borderColor??Be.BLACK}}function O(_){E.value=_}function w(_){r.value=_===r.value?void 0:_}function M(){const _=t.options.style;_.borderStyle=void 0,_.borderColor=void 0,_.borderWidth=void 0,_.borderTopStyle=void 0,_.borderTopColor=void 0,_.borderTopWidth=void 0,_.borderRightStyle=void 0,_.borderRightColor=void 0,_.borderRightWidth=void 0,_.borderBottomStyle=void 0,_.borderBottomColor=void 0,_.borderBottomWidth=void 0,_.borderLeftStyle=void 0,_.borderLeftColor=void 0,_.borderLeftWidth=void 0}function x(){const _=t.options.style;_.borderTopStyle==ae.NONE&&(_.borderTopStyle=void 0),_.borderRightStyle==ae.NONE&&(_.borderRightStyle=void 0),_.borderBottomStyle==ae.NONE&&(_.borderBottomStyle=void 0),_.borderLeftStyle==ae.NONE&&(_.borderLeftStyle=void 0),_.borderStyle=ae.SOLID}function $(){const _=t.options.style;_.borderStyle=void 0,_.borderRightStyle=void 0,_.borderRightColor=void 0,_.borderRightWidth=void 0,_.borderLeftStyle=void 0,_.borderLeftColor=void 0,_.borderLeftWidth=void 0,_.borderTopStyle=ae.SOLID,_.borderBottomStyle=ae.SOLID}function L(_){const S=t.options.style,A=h(_)??"borderRadius",q=Reflect.get(S,A);return ln(q)}function D(_){const S=Math.max(12,L(_)??0);return{width:S+"px",height:S+"px"}}return(_,S)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",b(e).settings])},[f("div",{class:m(b(e).presets)},[S[15]||(S[15]=f("span",null,"预设：",-1)),f("button",{type:"button",class:"quickprint-text-btn",onClick:M},[f("div",{class:m(b(e).noBorder)},null,2),S[12]||(S[12]=f("span",null,"无边框",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:x},[f("div",{class:m(b(e).outerBorder)},null,2),S[13]||(S[13]=f("span",null,"外部边框",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:$},[f("div",{class:m(b(e).topBottomBorder)},null,2),S[14]||(S[14]=f("span",null,"上下边框",-1))])],2),f("div",{class:m(b(e).borderTitle)},[S[16]||(S[16]=le(" 当前：")),f("strong",null,Y(i.value),1)],2),f("div",{class:m(d.value),style:K(g.value),onClick:S[8]||(S[8]=ne(()=>{},["stop"]))},[f("div",{class:m(b(e).borderTopLeftRadius),style:K(D(o.RADIUS_TOP_LEFT)),onClick:S[0]||(S[0]=A=>w(o.RADIUS_TOP_LEFT))},null,6),f("div",{class:m(b(e).borderTopRightRadius),style:K(D(o.RADIUS_TOP_RIGHT)),onClick:S[1]||(S[1]=A=>w(o.RADIUS_TOP_RIGHT))},null,6),f("div",{class:m(b(e).borderBottomLeftRadius),style:K(D(o.RADIUS_BOTTOM_LEFT)),onClick:S[2]||(S[2]=A=>w(o.RADIUS_BOTTOM_LEFT))},null,6),f("div",{class:m(b(e).borderBottomRightRadius),style:K(D(o.RADIUS_BOTTOM_RIGHT)),onClick:S[3]||(S[3]=A=>w(o.RADIUS_BOTTOM_RIGHT))},null,6),f("div",{class:m(b(e).borderTop),onClick:S[4]||(S[4]=A=>w(o.BORDER_TOP))},null,2),f("div",{class:m(b(e).borderRight),onClick:S[5]||(S[5]=A=>w(o.BORDER_RIGHT))},null,2),f("div",{class:m(b(e).borderBottom),onClick:S[6]||(S[6]=A=>w(o.BORDER_BOTTOM))},null,2),f("div",{class:m(b(e).borderLeft),onClick:S[7]||(S[7]=A=>w(o.BORDER_LEFT))},null,2)],6),f("div",{class:m(b(e).borderSetting)},[f("div",{class:m(b(e).borderStyle)},[f("label",{class:m(b(e).borderStyleTitle)},"线型",2),f("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(e).borderStyleOptions])},[(R(!0),I(Q,null,re(b(pu),A=>(R(),I("div",{key:A.value,title:A.label,class:m({[b(e).option]:!0,[b(e).selected]:A.value===E.value}),onClick:q=>O(A.value)},[A.value==b(ae).NONE?(R(),I("div",md,Y(A.label),1)):(R(),I("div",{key:1,class:m(b(e).line),style:K({textDecorationStyle:A.value})},"--",6))],10,pd))),128))],2)],2),f("div",{class:m(b(e).borderSettingRight)},[f("div",{class:m(b(e).borderItem)},[f("label",{class:m(b(e).borderItemLabel)},"颜色",2),p(b(vn),{modelValue:y.value,"onUpdate:modelValue":S[9]||(S[9]=A=>y.value=A),class:"quickprint-is-fill-w",disabled:!c.value},null,8,["modelValue","disabled"])],2),f("div",{class:m(b(e).borderItem)},[f("label",{class:m(b(e).borderItemLabel)},"宽度",2),p(Fe,{modelValue:v.value,"onUpdate:modelValue":S[10]||(S[10]=A=>v.value=A),options:l,class:"quickprint-is-fill-w",disabled:!c.value},null,8,["modelValue","disabled"])],2),f("div",{class:m(b(e).borderItem)},[f("label",{class:m(b(e).borderItemLabel)},"圆角",2),p(Fe,{modelValue:u.value,"onUpdate:modelValue":S[11]||(S[11]=A=>u.value=A),options:l,class:"quickprint-is-fill-w",disabled:!a.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),hd="_settings_58on3_2",vd="_borderTitle_58on3_8",bd="_box_58on3_13",yd="_border_58on3_8",_d="_borderRadius_58on3_28",Ed="_highlightTop_58on3_35",Td="_borderTop_58on3_35 _border_58on3_8",Sd="_highlightBottom_58on3_36",Rd="_borderBottom_58on3_36 _border_58on3_8",wd="_highlightRight_58on3_37",kd="_borderRight_58on3_37 _border_58on3_8",Cd="_highlightLeft_58on3_38",Ld="_borderLeft_58on3_38 _border_58on3_8",Id="_highlightTopLeft_58on3_44",Nd="_borderTopLeftRadius_58on3_44 _borderRadius_58on3_28",Od="_highlightTopRight_58on3_45",xd="_borderTopRightRadius_58on3_45 _borderRadius_58on3_28",Dd="_highlightBottomLeft_58on3_46",Ad="_borderBottomLeftRadius_58on3_46 _borderRadius_58on3_28",Md="_highlightBottomRight_58on3_47",Bd="_borderBottomRightRadius_58on3_47 _borderRadius_58on3_28",qd="_borderItem_58on3_111",$d="_borderItemLabel_58on3_121",Pd="_borderSetting_58on3_126",Vd="_borderSettingRight_58on3_131",Fd="_borderStyle_58on3_138",zd="_borderStyleOptions_58on3_143",Ud="_borderStyleTitle_58on3_150",Hd="_option_58on3_155",Gd="_line_58on3_171",Wd="_selected_58on3_182",Yd="_presets_58on3_188",Xd="_noBorder_58on3_195",jd="_outerBorder_58on3_196",Zd="_topBottomBorder_58on3_197",Kd={settings:hd,borderTitle:vd,box:bd,border:yd,borderRadius:_d,highlightTop:Ed,borderTop:Td,highlightBottom:Sd,borderBottom:Rd,highlightRight:wd,borderRight:kd,highlightLeft:Cd,borderLeft:Ld,highlightTopLeft:Id,borderTopLeftRadius:Nd,highlightTopRight:Od,borderTopRightRadius:xd,highlightBottomLeft:Dd,borderBottomLeftRadius:Ad,highlightBottomRight:Md,borderBottomRightRadius:Bd,borderItem:qd,borderItemLabel:$d,borderSetting:Pd,borderSettingRight:Vd,borderStyle:Fd,borderStyleOptions:zd,borderStyleTitle:Ud,option:Hd,line:Gd,selected:Wd,presets:Yd,noBorder:Xd,outerBorder:jd,topBottomBorder:Zd},Jd={classes:Kd},Qd=z(gd,[["__cssModules",Jd]]),ef="_setting_joc27_2",tf={setting:ef},nf={};function lf(n,e){return R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const of={classes:tf},sf=z(nf,[["render",lf],["__cssModules",of]]),rf=V({__name:"TableCell",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"像素",value:be.PX},{label:"毫米",value:be.MM}],l=k({get(){const a=e.options.width;if(a!=null)return a+"px"},set(a){const d=ln(a);e.options.width=d??void 0}}),o=k({get(){const a=e.options.height;if(a!=null)return a+"px"},set(a){const d=ln(a);e.options.height=d??void 0}}),s=k({get(){return e.options.diagonalMode??Re.NONE},set(a){const d=a==Re.NONE?void 0:a;e.options.diagonalMode=d}}),r=k({get(){var a,d;return(d=(a=e.options.diagonalLabels)==null?void 0:a[1])==null?void 0:d.text},set(a){const d=e.options;d.diagonalLabels==null&&(d.diagonalLabels=[]),d.diagonalLabels[0]==null&&(d.diagonalLabels[0]={}),d.diagonalLabels[0].text=a}}),i=k({get(){var a,d;return(d=(a=e.options.diagonalLabels)==null?void 0:a[1])==null?void 0:d.text},set(a){const d=e.options;d.diagonalLabels==null&&(d.diagonalLabels=[]),d.diagonalLabels[1]==null&&(d.diagonalLabels[1]={}),d.diagonalLabels[1].text=a}});function c(a){s.value=a}return(a,d)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",a.classes.setting])},[f("div",{class:m(a.classes.grid2)},[f("div",{class:m(a.classes.item)},[f("div",{class:m(a.classes.itemLabel)},"宽度",2),p(Fe,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=g=>l.value=g),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:m(a.classes.item)},[f("div",{class:m(a.classes.itemLabel)},"宽度",2),p(Fe,{modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=g=>o.value=g),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2),d[7]||(d[7]=f("div",null,"斜线表头",-1)),f("div",{class:m(["quickprint-is-row",a.classes.diagonal])},[f("div",{class:m({[a.classes.cell]:!0,[a.classes.selected]:s.value===b(Re).NONE}),onClick:d[2]||(d[2]=g=>c(b(Re).NONE))},null,2),f("div",{class:m({[a.classes.cell]:!0,[a.classes.selected]:s.value===b(Re).TL_BR}),onClick:d[3]||(d[3]=g=>c(b(Re).TL_BR))},[p(Qn,{mode:b(Re).TL_BR,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2),f("div",{class:m({[a.classes.cell]:!0,[a.classes.selected]:s.value===b(Re).TR_BL}),onClick:d[4]||(d[4]=g=>c(b(Re).TR_BL))},[p(Qn,{mode:b(Re).TR_BL,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2)],2),f("div",null,[f("div",{class:m(a.classes.item)},[f("div",{class:m(a.classes.itemLabel)},"顶部文本",2),Ee(f("input",{"onUpdate:modelValue":d[5]||(d[5]=g=>r.value=g),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Ne,r.value]])],2),f("div",{class:m(a.classes.item)},[f("div",{class:m(a.classes.itemLabel)},"底部文本",2),Ee(f("input",{"onUpdate:modelValue":d[6]||(d[6]=g=>i.value=g),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Ne,i.value]])],2)])],2))}}),af="_grid2_1bmdg_1",cf="_item_1bmdg_1",uf="_itemLabel_1bmdg_1",df="_setting_1bmdg_4",ff="_cell_1bmdg_9",pf="_selected_1bmdg_24",mf="_diagonal_1bmdg_29",gf={grid2:af,item:cf,itemLabel:uf,setting:df,cell:ff,selected:pf,diagonal:mf},hf={classes:gf},vf=z(rf,[["__cssModules",hf]]),bf=V({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=ot();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(R(),I("div",{class:m(s.classes.setting)},[n.active==="font"?(R(),J(Uu,{key:0,options:e.options},null,8,["options"])):G("",!0),n.active==="paragraph"?(R(),J(fd,{key:1,options:e.options},null,8,["options"])):G("",!0),n.active==="border"?(R(),J(Qd,{key:2,options:e.options},null,8,["options"])):G("",!0),n.active==="table"?(R(),J(sf,{key:3})):G("",!0),n.active==="table-cell"?(R(),J(vf,{key:4,options:e.options},null,8,["options"])):G("",!0),f("div",{class:m(s.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),yf="_setting_1v5ya_2",_f="_footer_1v5ya_9",Ef={setting:yf,footer:_f},Tf={classes:Ef},$n=z(bf,[["__cssModules",Tf]]);function So(n){return Oe({style:kn(n.style??{})})}function Sf(n,e){n.style=Object.assign({},n.style,e.style)}function Rf(n){if(Array.isArray(n)&&n.length>1)return Oe({style:{}});const e=Array.isArray(n)?n[0]:n;return Oe({width:e.width,height:e.height,diagonalMode:e.attributes.diagonalMode,diagonalLabels:kn(e.attributes.diagonalLabels??[]),style:kn(e.style??{})})}const wf=xe(function(n){return mt("表格",(e,t)=>p($n,{options:So(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table",active:!0},{label:"边框",name:"border"}]}).promisify().then(e=>Sf(n,e)).catch(De)}),kf=xe(function(n){return mt("表格行",(e,t)=>p($n,{options:So(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(De)}),Cf=xe(function(n){return mt("单元格",(e,t)=>p($n,{options:Rf(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table-cell",active:!0},{label:"字体",name:"font"},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(De)});function Lf(n,e,t){const l={menus:[...Ro(e),{type:"menu",label:"行设置",icon:"icon-table-row",handler(){const o=e.getSelectedElements(),s=o[0];s!=null&&(kf(s).then(r=>{if(r!=null)for(const i of o)i.style=Object.assign({},i.style,r.style)}),console.log("TODO:"))}},{type:"divider"},wo(e),ko(e),{type:"divider"},Co(e),gl(e.getDesignApi(),e.getTable())]};In.open(n.clientX,n.clientY,l)}function If(n,e){const l=e.getDesignApi().getSelectedElements();if(e.isSelectTableRow())return Lf(n,e,l[0]);const o=e.getSelectedCells(),s={menus:[...Ro(e),{type:"menu",label:"单元格设置",icon:"icon-table-cell",handler(){Cf(o).then(i=>{if(i!=null)for(const c of o)i.width&&c.setWidth(i.width),i.height&&c.setHeight(i.height),i.diagonalMode&&(c.attributes.diagonalMode=i.diagonalMode),i.diagonalLabels&&(c.attributes.diagonalLabels=i.diagonalLabels),c.style=Object.assign({},c.style,i.style)})}},{type:"divider"}]},r=[];return o.length>=2&&r.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells}),o.some(i=>i.hasSpan)&&r.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),o.length===1&&o[0].noSpan&&r.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),r.length>0&&s.menus.push(...r,{type:"divider"}),s.menus.push(wo(e),ko(e),{type:"divider"},Co(e),gl(e.getDesignApi(),e.getTable())),In.open(n.clientX,n.clientY,s)}function Ro(n){return[{type:"menu",label:"选中表格",icon:"icon-aim",handler:n.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",handler(){wf(n.getTable())}}]}function wo(n){return{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:n.insertColumnLeft,disabled:n.isSelectTableRow},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:n.insertColumnRight,disabled:n.isSelectTableRow},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:n.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:n.inserRowBottom}]}}function ko(n){return{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:n.deleteColumns,disabled:n.isSelectTableRow},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:n.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:n.deleteDataSource}]}}function Co(n){return{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:n.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:n.avgTableWidth},{type:"menu",label:"均分表格高度",handler:n.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:n.setOtherRowSameHeight,disabled(){const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:n.setOtherColSameWidth,disabled(){if(n.isSelectTableRow())return!0;const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasColSpan)}}]}}function Nf(n,e){function t(){return n.element}function l(){return e.getSelectedElements(t())}function o(){const x=t();return l().filter(L=>{var _;if(L.type!==j.TABLE_CELL)return!1;const D=(_=L.parent)==null?void 0:_.parent;return D==null?!1:D.id==x.id}).sort(wn.sort)}function s(){return e.selectElement(t())}function r(){const x=o();if(x.length===0)return!1;const $=Tt.toArea(x);return t().insertColumn($.colStart,0),e.createSnapshot(),!0}function i(){const x=o();if(x.length===0)return!1;const $=Tt.toArea(x);return t().insertColumn($.colEnd,1),e.createSnapshot(),!0}function c(){if(M()){const L=l()[0];return t().inserRow(L.index,0),e.createSnapshot(),!0}const x=o();if(x.length===0)return!1;const $=Tt.toArea(x);return t().inserRow($.rowStart,0),e.createSnapshot(),!0}function a(){if(M()){const L=l()[0];return t().inserRow(L.index,1),e.createSnapshot(),!0}const x=o();if(x.length===0)return!1;const $=Tt.toArea(x);return t().inserRow($.rowEnd,1),e.createSnapshot(),!0}function d(){var he,Ce;const x=t(),$=x.page;if($==null)return;const L=x.doc,D=ln((he=L==null?void 0:L.margins)==null?void 0:he.left)??38,_=ln((Ce=L==null?void 0:L.margins)==null?void 0:Ce.right)??38,S=x.columns,A=S.reduce((Le,We)=>Le+We,0),q=jn.mm_to_px($.width)-D-_,B=[];for(const Le of S){const We=Math.round(Le/A*q);B.push(We)}const oe=B.reduce((Le,We)=>Le+We,0),Z=q-oe;B[B.length-1]+=Z,x.setColumns(B),x.updateBoxSize(),e.createSnapshot()}function g(){const x=t(),$=x.columns,L=$.reduce((A,q)=>A+q,0),D=Math.floor(L/$.length),_=new Array($.length).fill(D),S=L-_.reduce((A,q)=>A+q,0);_[_.length-1]+=S,x.setColumns(_),x.updateBoxSize(),e.createSnapshot()}function v(){const x=t(),$=Math.round(x.height/x.children.length);x.children.forEach((L,D)=>x.setRowHeight(D,$)),x.updateBoxSize(),e.createSnapshot()}function E(){const x=l()[0];if(x==null)return;const $=x.type===j.TABLE_ROW?x:x.parent;if(!pe.isDefineElement($)||$.type!=j.TABLE_ROW)return;const L=t(),D=$.height;L.children.forEach(_=>_.setRowHeight(D)),L.updateBoxSize(),e.createSnapshot()}function y(){const x=l()[0];if(x==null)return;const $=t(),L=x.width,D=$.attributes.colgroup.map(_=>L);$.setColumns(D),$.updateBoxSize(),e.createSnapshot()}function u(){const x=o();if(x.length<2)return;const L=t().mergeCells(x);e.selectElement(L),e.createSnapshot()}function h(){const x=o();if(x.length==0)return;t().splitCells(x),e.createSnapshot()}function T(){const x=o()[0];if(x==null)return;t().removeColumn(x.index),e.resetSelectedElement(),e.createSnapshot()}function N(){if(M()){const D=l()[0];t().removeRow(D.index),e.resetSelectedElement(),e.createSnapshot();return}const x=o();if(x.length==0)return;const $=Tt.toArea(x),L=t();for(let D=$.rowEnd;D>=$.rowStart;D--)L.removeRow(D);e.resetSelectedElement(),e.createSnapshot()}function C(){l().forEach($=>$.resetDS()),e.createSnapshot()}function O(){const x=l();if(x.length!=1)return;const $=x[0];if($.hasSpan)return;const L=$.index,D=t();D.insertColumn(L,1,!0);for(const _ of D.children){const S=_.children[L];if(S.id===$.id)continue;const A=_.children[L+1];if(S.hasSpan){D.mergeRightCell(S,A);continue}if(S.isCollapsed){const q=D.find(S.attributes.control);q&&D.mergeRightCell(q,A);continue}D.mergeCells([S,A])}e.selectElement($),e.createSnapshot()}function w(){const x=l();if(x.length!=1)return;const $=x[0];if($.hasSpan)return;const L=$.parent;if(L==null)return;const D=t();D.inserRow(L.index,1);const _=D.children[L.index+1];for(let S=0;S<L.children.length;S++){const A=L.children[S];if(A.id===$.id)continue;const q=_.children[S];if(A.hasSpan){D.mergeBottomCell(A,q);continue}if(A.isCollapsed){const B=D.find(A.attributes.control);B&&D.mergeBottomCell(B,q);continue}D.mergeCells([A,q])}e.selectElement($),e.createSnapshot()}function M(){const x=l();return x.length==1&&x[0].type==j.TABLE_ROW}return{getDesignApi(){return e},getTable:t,getSelectedElements:l,getSelectedCells:o,selectTable:s,insertColumnLeft:r,insertColumnRight:i,insertRowTop:c,inserRowBottom:a,autoReiszeColumnByPaper:d,avgTableWidth:g,avgTableHeight:v,setOtherRowSameHeight:E,setOtherColSameWidth:y,mergeCells:u,splitCells:h,splitByColumn:O,splitByRow:w,deleteColumns:T,deleteRows:N,deleteDataSource:C,isSelectTableRow:M}}function Of(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(d){return d<=0?null:n.getTable().getColumnLeft(d-1)}function r(d){const g=n.getTable(),v=g.attributes.colgroup.length;return d>=v?null:g.getColumnLeft(d+1)}function i(d,g){if(!(d.target instanceof Element))return;const v=d.target.closest("."+e.colResize);if(v==null)return;const E=v.closest("."+e.layer);E!=null&&(d.stopPropagation(),d.preventDefault(),o.left=v.offsetLeft,o.colIndex=g,o.target=v,o.container=E,o.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",c),window.addEventListener("pointerup",a))}function c(d){if(o.target==null||o.container==null)return;const g=o.container.getBoundingClientRect(),v=n.getDesignApi().state.scale/100,E=s(o.colIndex),y=r(o.colIndex);let u=d.clientX-g.left;E!=null&&u<=E*v+4&&(u=E*v+4),y!=null&&u>=y*v-4&&(u=y*v-4),o.left=u/v,o.target.style.left=u/v+"px",o.moved=!0}function a(d){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",a)}return i}function xf(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(d){return d<=0?null:n.getTable().getRowTop(d-1)}function r(d){const g=n.getTable(),v=g.children.length;return d>=v?null:g.getRowTop(d+1)}function i(d,g){if(!(d.target instanceof Element))return;const v=d.target.closest("."+e.rowResize);if(v==null)return;const E=v.closest("."+e.layer);E!=null&&(d.stopPropagation(),d.preventDefault(),o.top=v.offsetTop,o.rowIndex=g,o.target=v,o.container=E,o.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",c),window.addEventListener("pointerup",a))}function c(d){if(o.target==null||o.container==null)return;const g=n.getDesignApi().state.scale/100,v=o.container.getBoundingClientRect(),E=s(o.rowIndex),y=r(o.rowIndex);let u=d.clientY-v.top;E!=null&&u<=E*g+4&&(u=E*g+4),y!=null&&u>=y*g-4&&(u=y*g-4),o.moved=!0,o.top=u/g,o.target.style.top=u/g+"px"}function a(d){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",a)}return i}const Df=["width"],Af=["onClick"],Mf=["onClick"],Bf=V({__name:"TableEditor",props:{element:{type:Tt,required:!0}},setup(n){const e=n,t=Se(),l=ke("classes"),o=Nf(e,t),s=Oe({colIndex:-1,rowIndex:-1,silence:!1}),r=k(()=>e.element.attributes.colgroup??[]),i=Of(o,l,{onResizeEnd:T,onResizeStart:h}),c=xf(o,l,{onResizeEnd:N,onResizeStart:h});function a(L){return{left:(e.element.attributes.colgroup??[]).slice(0,L).reduce((_,S)=>_+S,0)+"px"}}function d(L){return{top:(e.element.children??[]).slice(0,L).reduce((S,A)=>S+A.height,0)-1+"px"}}function g(L){const D=e.element.attributes.colgroup??[],_=D.slice(0,L).reduce((q,B)=>q+B,0),S=L===0?0:1,A=L>0&&L<D.length?-1:0;return{left:_+S+"px",width:D[L]+A+"px"}}function v(L){const D=e.element.children??[],_=D.slice(0,L).reduce((q,B)=>q+B.height,0),S=L===0?0:1,A=L>0&&L<D.length?-1:0;return{top:_+S+"px",height:D[L].height+A+"px"}}function E(L){t.selectElement(L)}function y(L){const D=[];for(const _ of e.element.children){const S=_.children[L];S.isColCollapsed||D.push(S)}t.multiSelectElements(D)}async function u(L){const D=L.target.closest("td");if(D==null)return;const _=Reflect.get(D,He);if(_==null)return;const S=t.getSelectedElements(e.element);(S.length==0||S.length==1&&S[0].type===j.TABLE_CELL||S.length>1&&S.findIndex(A=>A.id===_.id)<0)&&(t.selectElement(_),await Ht()),If(L,o)}function h(){s.silence=!0}function T(L,D){s.silence=!1;const _=e.element.attributes.colgroup??[];if(L==0){const oe=e.element.left,Z=e.element.calculateCoord(oe+D),he=_[0]-(Z-oe);e.element.setLeft(Z),e.element.setColWidth(0,he),e.element.updateBoxSize(),t.createSnapshot();return}if(L==_.length){const oe=L-1,Z=_.slice(0,oe).reduce((Ce,Le)=>Ce+Le,0),he=D-Z;e.element.setColWidth(L-1,he),e.element.updateBoxSize(),t.createSnapshot();return}const S=L-1,A=_[S]+_[L],q=D-_.slice(0,S).reduce((oe,Z)=>oe+Z,0),B=A-q;e.element.setColWidth(S,q),e.element.setColWidth(L,B),e.element.updateBoxSize(),t.createSnapshot()}function N(L,D){s.silence=!1;const _=e.element.children;if(L==0){const oe=e.element.top,Z=e.element.calculateCoord(oe+D),he=_[0].height-(Z-oe);e.element.setTop(Z),e.element.setRowHeight(L,he),e.element.updateBoxSize(),t.createSnapshot();return}if(L==_.length){const oe=L-1,Z=_.slice(0,oe).reduce((Ce,Le)=>Ce+Le.height,0),he=D-Z;e.element.setRowHeight(L-1,he),e.element.updateBoxSize(),t.createSnapshot();return}const S=L-1,A=_[S].height+_[L].height,q=D-_.slice(0,S).reduce((oe,Z)=>oe+Z.height,0),B=A-q;e.element.setRowHeight(S,q),e.element.setRowHeight(L,B),e.element.updateBoxSize(),t.createSnapshot()}function C(){s.rowIndex=-1,s.colIndex=-1}function O(L){const D=L.target.closest("td");if(D==null)return;const _=Reflect.get(D,He);if(_==null||!(_ instanceof wn))return;const S=D.getBoundingClientRect(),A=L.clientX-S.left,q=_.index;if(!_.hasColSpan)return A<S.width/2?q:_.getNextColIndex();const B=e.element.attributes.colgroup,oe=B[q]/2;if(A>=0&&A<=oe)return q;const Z=_.offsetWidth,he=Z-B[q+_.colspan-1]/2;if(A>=he&&A<=Z)return _.getNextColIndex()+1}function w(L){const D=L.target.closest("td");if(D==null)return;const _=Reflect.get(D,He);if(_==null||!(_ instanceof wn))return;const S=_.parent;if(S==null)return;const A=D.getBoundingClientRect(),q=L.clientY-A.top,B=S.index;if(!_.hasRowSpan)return q<A.height/2?B:_.getNextRowIndex();const oe=S.height/2;if(q>=0&&q<=oe)return B;const Z=e.element.children.slice(S.index,S.index+_.rowspan),he=Z.reduce((Le,We)=>Le+We.height,0),Ce=he-Z[Z.length-1].height;if(q>=Ce&&q<=he)return _.getNextRowIndex()+1}function M(L){s.silence||(s.colIndex=O(L)??-1,s.rowIndex=w(L)??-1)}function x(){const L=e.element;L.insertColumn(L.colSize-1,1)}function $(){const L=e.element;L.inserRow(L.rowSize-1,1)}return(L,D)=>(R(),I("div",{class:m(b(l).tableEditor),onContextmenu:ne(u,["stop","prevent"]),onClick:D[3]||(D[3]=ne(()=>{},["stop"])),onMouseleave:C},[f("table",{class:m(b(l).table),onMousemove:M},[f("colgroup",null,[(R(!0),I(Q,null,re(r.value,(_,S)=>(R(),I("col",{key:S,width:_},null,8,Df))),128))]),f("tbody",null,[(R(!0),I(Q,null,re(n.element.children,_=>(R(),I("tr",{key:_.id},[(R(!0),I(Q,null,re(_.children,S=>(R(),J(bo,{key:S.id,element:S},null,8,["element"]))),128))]))),128))])],34),f("div",{class:m(b(l).layer)},[s.colIndex>=0?(R(),I("div",{key:0,title:"调整列宽",class:m(b(l).colResize),style:K(a(s.colIndex)),onPointerdown:D[0]||(D[0]=ne(_=>b(i)(_,s.colIndex),["stop","prevent"]))},null,38)):G("",!0),s.rowIndex>=0?(R(),I("div",{key:1,title:"调整行高",class:m(b(l).rowResize),style:K(d(s.rowIndex)),onPointerdown:D[1]||(D[1]=ne(_=>b(c)(_,s.rowIndex),["stop","prevent"]))},null,38)):G("",!0),(R(!0),I(Q,null,re(r.value,(_,S)=>(R(),I("div",{title:"选中此列",key:S,style:K(g(S)),class:m(b(l).colIndicator),onClick:ne(A=>y(S),["stop"])},null,14,Af))),128)),(R(!0),I(Q,null,re(n.element.children,(_,S)=>(R(),I("div",{title:"选中此行",key:S,style:K(v(S)),class:m(b(l).rowIndicator),onClick:ne(A=>E(_),["stop"])},null,14,Mf))),128)),n.element.isSelected?(R(),I("button",{key:2,onClick:ne(x,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addCol]),title:"添加列"},[p(b(F),{icon:"icon-plus",size:"14px"})],2)):G("",!0),n.element.isSelected?(R(),I("button",{key:3,onClick:ne($,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addRow]),title:"添加行"},[p(b(F),{icon:"icon-plus",size:"14px"})],2)):G("",!0)],2),f("div",{class:m(b(l).indicator),onPointerdown:D[2]||(D[2]=(..._)=>b(t).onDragStart&&b(t).onDragStart(..._)),title:"选中/拖动表格"},null,34)],34))}}),qf="_tableEditor_5qbkt_2",$f="_table_5qbkt_2",Pf="_layer_5qbkt_33",Vf="_colResize_5qbkt_43",Ff="_rowResize_5qbkt_66",zf="_colIndicator_5qbkt_89",Uf="_rowIndicator_5qbkt_95",Hf="_indicator_5qbkt_114",Gf="_addCol_5qbkt_151",Wf="_addRow_5qbkt_166",Yf={tableEditor:qf,table:$f,layer:Pf,colResize:Vf,rowResize:Ff,colIndicator:zf,rowIndicator:Uf,indicator:Hf,addCol:Gf,addRow:Wf},Xf={classes:Yf},jf=z(Bf,[["__cssModules",Xf]]),Zf={class:"quickprint-config-section quickprint-config-inline"},Kf={class:"quickprint-config-content"},Jf=V({__name:"TableConfig",props:{element:{type:Tt,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.rowMode??Xt.CONST},set(o){e.element.attributes.rowMode=o===Xt.CONST?void 0:o}}),l=[{label:"固定行数",value:Xt.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:Xt.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:Xt.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(R(),I("section",Zf,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",Kf,[p(b(ee),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),Qf={class:"quickprint-config-section quickprint-config-inline"},ep={class:"quickprint-config-content"},tp=V({__name:"TableRowConfig",props:{element:{type:mn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:Ot.HEADER},{label:"表体",value:Ot.BODY},{label:"表尾",value:Ot.FOOTER}],l=k({get(){return e.element.attributes.type??Ot.BODY},set(o){switch(o){case Ot.HEADER:e.element.asHeader();break;case Ot.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(R(),I("section",Qf,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",ep,[p(b(ee),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),Pn=Object.freeze({title:"表格",type:j.TABLE,icon:"icon-table",editor:jf,config:{attributes:Jf,exclude:[de.DISPLAY,de.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[Ct,Ct,Ct],e=pe.create({type:j.TABLE});return e.setColgroup(n),e.append(mn.createDefault(n)),e.append(mn.createDefault(n)),e.append(mn.createDefault(n)),e.updateBoxSize(),e}}),Lo=Object.freeze({title:"表格行",type:j.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[de.POSITION,de.COORD,de.OVERFLOW],attributes:tp}}),vl=Object.freeze({title:"单元格",type:j.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:bo,config:{exclude:[de.POSITION,de.COORD]}});class np{constructor(e){H(this,"__v_skip",!0);H(this,"observer");H(this,"callbacks",[]);H(this,"handler");this.handler=$r((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function lp(n,e){switch(n){case"fontSize":return e===Te.DEFAULT?void 0:e;case"fontFamily":return e===se.DEFAULT?void 0:e;case"lineHeight":return e===_t.DEFAULT?void 0:e;default:return e}}const Il="texteditor-const-node",op=Object.freeze({CONST:0});class sp{constructor(e,t={}){H(this,"__v_skip",!0);H(this,"emitter",new Tn);H(this,"container");H(this,"options");H(this,"observer");H(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new np(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new Tn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new os(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ie(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await Ln(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=Il,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var v;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,c=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(c),r.parentNode===i||(v=r.parentNode)!=null&&v.contains(i))return s.insertNode(c),this.normalize(),this.focusAfterNode(c),!0;const a=r.parentNode;if(a==null)return!1;const d=a.textContent;if(d==null)return!1;if(o.anchorOffset==d.length)return i.insertBefore(c,a.nextSibling),this.normalize(),this.focusAfterNode(c),!0;const g=document.createElement("span");return g.textContent=d.slice(0,o.anchorOffset),a instanceof HTMLElement&&(g.style.cssText=a.style.cssText),a.textContent=d.slice(o.anchorOffset),i.insertBefore(c,a),i.insertBefore(g,c),this.normalize(),this.focusAfterNode(c),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ie(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var d;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:c}=this.normalizeRange(o);if(s===i){const g=s.textContent??"";if(s instanceof CharacterData){const y=document.createElement("span");return y.textContent=g.slice(r,c),o.deleteContents(),o.insertNode(y),[y]}const v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,i);const E=document.createElement("span");return E.textContent=g.slice(r,c),this.inheritStyle(E,i),i.textContent=g.slice(c),e.insertBefore(E,i),e.insertBefore(v,E),[E]}const a=this.findNodesBetween(s,i);if(r>0){const g=s.textContent??"",v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,s),s.textContent=g.slice(r),e.insertBefore(v,s)}if(c>=0&&c<=(((d=i.textContent)==null?void 0:d.length)??0)){const g=i.textContent??"";if(i instanceof HTMLElement){i.textContent=g.slice(0,c);const v=document.createElement("span");v.textContent=g.slice(c),this.inheritStyle(v,i),e.insertBefore(v,i.nextSibling),a.push(i)}else{const v=document.createElement("span");v.textContent=g.slice(0,c),e.replaceChild(v,i);const E=document.createTextNode(g.slice(c));e.insertBefore(E,i.nextSibling),a.push(v)}}return a.unshift(s),a}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=Gl(e),r=lp(e,t);for(let i=0;i<l.length;i++){const c=l[i];if(c instanceof HTMLElement){this.matchElementStyle(c,s,r)||(o=!1);continue}const a=document.createElement("span");a.textContent=c.textContent,this.container.replaceChild(a,c),l[i]=a,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=St.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=St.remove(o,l);ie(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+Il)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const ip=V({__name:"ParagraphEditor",props:{element:{type:ss,required:!0}},setup(n){const e=n,t=Se(),l=fe(),o=k(()=>e.element.isSelected!==!0?!1:t.state.selectMode===et.SINGLE);let s=null;const r=k(()=>qn.map(w=>(w.style={fontFamily:w.value==se.DEFAULT?se.SONG:w.value},w)));function i(){}async function c(){if(s==null)return;const w=await ml({doc:t.doc}).catch(Ke);if(w==null)return;const M=lt(w.value,t.doc.ds)??w.value,x={type:op.CONST,value:w.value,label:M};s.insertNode(x)}function a(){s==null||s.blur()}function d(){s==null||s.autosize()}function g(w){const M=e.element.ds.value,x=new sp(w);return x.on("resize",$=>{var D;const L=(D=$.detail)==null?void 0:D.height;L!=null&&e.element.setHeight(L+2)}),x.watch(()=>{const $=x.getHTML(),L=e.element.ds.value;$!==L&&(e.element.ds.value=$,x.checkHeight())}),ie(M)||x.setHTML(M),x}function v(w){s==null||s.setStyle("fontFamily",w.value)}function E(w){s==null||s.setStyle("fontSize",w.value)}function y(w){s==null||s.setStyle("lineHeight",w.value)}function u(w){s==null||s.setStyle("backgroundColor",w)}function h(w){s==null||s.setStyle("color",w)}function T(){s==null||s.setStyle("fontWeight","700")}function N(){s==null||s.setStyle("fontStyle","italic")}function C(){s==null||s.setStyle("textDecorationLine","underline")}function O(){s==null||s.setStyle("textDecorationLine","line-through")}return cl(()=>e.element.ds.value,w=>{s==null||s.getHTML()==w||s.setHTML(w)}),rn(()=>{e.element.on("blur",a),s=g(l.value)}),al(()=>{e.element.off("blur",a),s&&s.cleanup()}),(w,M)=>(R(),I("div",{class:m(w.classes.paragraph),onPointerdown:M[2]||(M[2]=ne(()=>{},["stop"])),onContextmenu:ne(i,["stop","prevent"])},[f("div",{class:m(w.classes.indicator),onPointerdown:M[0]||(M[0]=(...x)=>b(t).onDragStart&&b(t).onDragStart(...x)),title:"选中/拖动段落"},null,34),o.value?(R(),I("div",{key:0,class:m(w.classes.toolbar),onMousedown:M[1]||(M[1]=ne(()=>{},["prevent"]))},[p(b(ee),{onSelect:v,title:"字体",width:"60px",options:r.value,class:m(w.classes.tool),button:""},null,8,["options","class"]),p(b(ee),{onSelect:E,title:"字号",width:"60px",options:b(hl),class:m(w.classes.tool),button:""},null,8,["options","class"]),p(b(ee),{onSelect:y,title:"行高",width:"60px",options:b(Eo),class:m(w.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),f("div",{class:m(w.classes.divider)},null,2),p(b($t),{class:m(w.classes.tool),onSelect:u},{default:we(()=>[f("div",{class:m(w.classes.colorIcon),title:"突出显示"},[p(b(F),{icon:"icon-bg-color-b",size:"15px"}),f("div",{class:m(w.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(b($t),{class:m(w.classes.tool),onSelect:h},{default:we(()=>[f("div",{class:m(w.classes.colorIcon),title:"字体颜色"},[p(b(F),{icon:"icon-font",size:"15px"}),f("div",{class:m(w.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),f("button",{onClick:T,type:"button",title:"加粗",class:m(["quickprint-text-btn",w.classes.tool])},[p(b(F),{icon:"icon-font-bold",size:"16px"})],2),f("button",{onClick:N,type:"button",title:"斜体",class:m(["quickprint-text-btn",w.classes.tool])},[p(b(F),{icon:"icon-italic",size:"16px"})],2),f("button",{onClick:C,type:"button",title:"下划线",class:m(["quickprint-text-btn",w.classes.tool])},[p(b(F),{icon:"icon-underline",size:"16px"})],2),f("button",{onClick:O,type:"button",title:"删除线",class:m(["quickprint-text-btn",w.classes.tool])},[p(b(F),{icon:"icon-through-line",size:"16px"})],2),f("div",{class:m(w.classes.divider)},null,2),f("button",{class:"quickprint-text-btn",type:"button",onClick:c},[p(b(F),{icon:"icon-insert-var",size:"16px"}),M[3]||(M[3]=f("span",null,"插入变量",-1))]),f("button",{class:"quickprint-text-btn",type:"button",onClick:d},[p(b(F),{icon:"icon-colum-height",size:"16px"}),M[4]||(M[4]=f("span",null,"调整高度",-1))])],34)):G("",!0),f("div",{ref_key:"editorRef",ref:l,class:m(w.classes.editor)},null,2)],34))}}),rp="_paragraph_1v2pj_2",ap="_indicator_1v2pj_6",cp="_editor_1v2pj_18",up="_toolbar_1v2pj_44",dp="_tool_1v2pj_44",fp="_colorIcon_1v2pj_66",pp="_colorIndicator_1v2pj_86",mp="_divider_1v2pj_95",gp={paragraph:rp,indicator:ap,editor:cp,toolbar:up,tool:dp,colorIcon:fp,colorIndicator:pp,divider:mp},hp={classes:gp},vp=z(ip,[["__cssModules",hp]]),Vn=Object.freeze({title:"段落",type:j.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:vp,config:{exclude:[de.DATASOURCE,de.BASIC,de.OVERFLOW]},onCreate(){return pe.create({type:j.PARAGRAPH,width:Ct*4,height:On*6})}}),Io=[An,Mn,Bn,Pn,vl,Lo,Vn],bp=[An,Mn,Bn,Pn,Vn],yp={[j.TEXT]:An.editor,[j.NUMBER]:Mn.editor,[j.DATE]:Bn.editor,[j.TABLE]:Pn.editor,[j.TABLE_CELL]:vl.editor,[j.PARAGRAPH]:Vn.editor},_p={[j.TEXT]:An.config,[j.NUMBER]:Mn.config,[j.DATE]:Bn.config,[j.TABLE]:Pn.config,[j.TABLE_CELL]:vl.config,[j.TABLE_ROW]:Lo.config,[j.PARAGRAPH]:Vn.config},Wt=Io.reduce((n,e)=>(n[e.type]=e,n),{});function Ep(n){const e=Io.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function Tp(n){return Reflect.get(yp,n)}function Kt(n){return Reflect.get(_p,n)}function on(n){var e;return((e=Wt[n])==null?void 0:e.title)??n}function Sp(n){var e;return(e=Wt[n])==null?void 0:e.icon}function Rp(n){var e,t;return((t=(e=Wt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function wp(n){var e,t;return((t=(e=Wt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function kp(n){var e,t;return((t=(e=Wt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Cp(n){var e,t;return((t=(e=Wt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Nl(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function Ol(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function xl(n,e){const t=n.find(c=>c.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function Dl(n,e){const t=n.find(c=>c.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function Lp(n){const e=document.createElement("div");return n.appendChild(e),e}function Ip(n,e){const t=[...e.querySelectorAll(":scope ."+X.GUIDE_LINE)];for(const l of n){const o=t.shift()??Lp(e);o.className=X.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function Np(n,e){const l=e.querySelectorAll(":scope ."+X.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const c=i.getBoundingClientRect();if(Math.abs(s.left-c.left)<=1||Math.abs(s.right-c.left)<=1){const a=c.left-o.left;xl(r,Nl(a,s,c,o))}if(Math.abs(s.left-c.right)<=1||Math.abs(s.right-c.right)<=1){const a=c.right-o.left;xl(r,Nl(a,s,c,o))}if(Math.abs(s.top-c.top)<=1||Math.abs(s.bottom-c.top)<=1){const a=c.top-o.top;Dl(r,Ol(a,s,c,o))}if(Math.abs(s.bottom-c.bottom)<=1||Math.abs(s.top-c.bottom)<=1){const a=c.bottom-o.top;Dl(r,Ol(a,s,c,o))}}Ip(r,e)}function Op(){const n=document.querySelectorAll("."+X.GUIDE_LINE);for(const e of n)e.remove()}const Cn={create:Pr(Np,50),clean:Op};async function xp(n){await Ln(),n&&Reflect.deleteProperty(n,Nn)}async function Dp(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=Ap(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-oo(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function Ap(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===qe.INSERT){const o=t.closest("."+X.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?At(e.left-s.left):Math.round(e.left-s.left),y:l?At(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?At(e.left):Math.round(e.left),y:l?At(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function Mp(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function Bp(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function qp(n){return!(n.style.rotate&&!n.isSelected)}function $p(n){const e=new Jn({selector:{container:X.DROPPABLE},scale(t){return t.mode===qe.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,Kl),s=Reflect.get(l.target,ul);o===qe.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===qe.INSERT?o:qe.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===qe.INSERT){const s=Ep(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,He);if(o==null||!qp(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===qe.INSERT&&(l.ghost.style.display="block"),l.mode===qe.MOVE&&Reflect.set(l.target,Nn,dl.DRAG_ELEMENT),l.ghost.classList.add(X.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,Dp(n,l),Mp(n,l),l.dropTarget&&Cn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;Cn.clean(),l.ghost.classList.remove(X.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===qe.INSERT&&(l.ghost.style.display="none"),l.mode==qe.MOVE&&xp(l.target);const o=l.element;if(l.mode==qe.MOVE){const a=o.left,d=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-a,l.diffY=o.top-d,Bp(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,Jl);if(s==null)return;const r=s instanceof Lt||s instanceof pe?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),c=n.state.scale/100;o.setTop((l.top-i.top)/c),o.setLeft((l.left-i.left)/c),o.setWidth(o.width/c),o.setHeight(o.height/c),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Al="quickprint-history-0000",Pp=1,it="snapshot",bn="health",Ml="owner",je="INDEX_OWNER",Vp=15*60*1e3,Fp=10*60*1e3;function zp(){const n={db:null,timer:null,promise:null};async function e(){const d=await c(bn,"readwrite");if(d==null)return n.timer=s(),!1;const g=[],v=d.openCursor();v.onsuccess=async function(E){const y=E.target.result;if(y==null){t(g),n.timer=s(),$e.debug("History","已检查无效快照");return}const u=y.value;u!=null&&Date.now()-u.timestamp>Vp&&g.push(u),y.continue()},v.onerror=function(E){console.error(E),n.timer=s()}}async function t(d){const g=await Promise.allSettled(d.map(v=>l(v.owner)));for(let v=0;v<g.length;v++){const E=g[v];E.status==="rejected"||E.value!==!0||o(d[v].id)}}async function l(d){const g=await c(it,"readwrite");return g==null?!1:new Promise(v=>{const E=g.index(je).openCursor(IDBKeyRange.only(d));E.onsuccess=function(y){const u=y.target.result;if(u==null)return v(!0);u.delete(),u.continue()},E.onerror=function(y){console.error(y),v(!1)}})}async function o(d){const g=await c(bn,"readwrite");return g==null?!1:en(g.delete(d)).then(()=>!0).catch(v=>(console.log(v),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),Fp)}function r(){return new Promise(d=>{const g=indexedDB.open(Al,Pp);g.onupgradeneeded=v=>{const y=v.target.result,u=y.createObjectStore(bn,{keyPath:"id",autoIncrement:!0}),h=y.createObjectStore(it,{keyPath:"id",autoIncrement:!0});u.createIndex(je,Ml),h.createIndex(je,Ml)},g.onsuccess=v=>{const E=v.target;n.db=E.result,$e.debug("History",`已连接数据库【${Al}】`),d(n.db)},g.onerror=function(v){console.error(v),n.db=null,d(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function c(d,g="readonly"){const v=await i();if(v==null)return null;try{return v.transaction(d,g).objectStore(d)}catch(E){return console.error(E),null}}function a(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:c,cleanup:a}}function en(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const Up=5*60*1e3,bt=zp();var Ze,ze,yn,nl,No;class Hp{constructor(e,t={}){Ye(this,ze);H(this,"state");H(this,"owner");Ye(this,Ze);this.state=e,this.owner=t.owner??is(rs.HISTORY_OWNER),Me(this,ze,nl).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await bt.findStore(it,"readwrite");if(l==null)return!1;await Me(this,ze,No).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await en(l.put(s)).catch(Ke)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await bt.findStore(it,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await en(o.put(l)).catch(Ke)==null))}async getCurrentSnapshot(){const e=await bt.findStore(it);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(je).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const c=i.value;if(c.owner!=l)return i.continue();if(c.index==t)return o(c);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await bt.findStore(it);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(je).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const c=i.value;if(c.owner!=l)return i.continue();if(c.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await bt.findStore(it);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(je).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const c=i.value;if(c.owner!=l)return i.continue();if(c.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await bt.findStore(it);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(je).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const c=i.value;if(c.owner!=t)return i.continue();s.push(c),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){Ae(this,Ze)&&(clearTimeout(Ae(this,Ze)),ht(this,Ze,null))}}Ze=new WeakMap,ze=new WeakSet,yn=function(){ht(this,Ze,setTimeout(()=>Me(this,ze,nl).call(this),Up))},nl=async function(){Ae(this,Ze)&&clearTimeout(Ae(this,Ze));const e=await bt.findStore(bn,"readwrite");if(e==null)return Me(this,ze,yn).call(this);const t=await en(e.index(je).get(this.owner)).catch(Ke);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),Me(this,ze,yn).call(this)}t.timestamp=Date.now(),await en(e.put(t)).catch(Ke),Me(this,ze,yn).call(this)},No=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(je).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const c=i.target.result;if(c==null)return s(!0);const a=c.value;if(a.owner!=o)return c.continue();if(a.index>t){c.delete(),c.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function Gp(n){const e=new Hp(Oe({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(d){return e.createSnapshot(n.value,d)}function s(d){return e.replaceSnapshot(n.value,d)}async function r(){const d=await e.getPrevSnapshot();if(d==null)return!1;const g=Sn(d.data);return g==null?!1:(n.value=ye.create(g),!0)}async function i(){const d=await e.getNextSnapshot();if(d==null)return!1;const g=Sn(d.data);return g==null?!1:(n.value=ye.create(g),!0)}function c(){return e.list()}function a(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:c,cleanup:a,replaceSnapshot:s}}class Wp{constructor(e){H(this,"moved",!1);H(this,"position");H(this,"top",0);H(this,"left",0);H(this,"width",0);H(this,"height",0);H(this,"initX",0);H(this,"initY",0);H(this,"indicator");H(this,"container");H(this,"originalEvent");H(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Ft,zt,pt,Oo,xo,Do;const Ie=class Ie extends Tn{constructor(t={}){var l,o,s;super();Ye(this,pt);H(this,"context",null);H(this,"selector");H(this,"scale");H(this,"onResizeStart");Ye(this,Ft);Ye(this,zt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??X.PAGE,element:((o=t.selector)==null?void 0:o.element)??X.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??X.RESIZEABLE_INDICATOR},this.onResizeStart=Me(this,pt,Oo).bind(this),ht(this,Ft,Me(this,pt,xo).bind(this)),ht(this,zt,Me(this,pt,Do).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",Ae(this,Ft)),window.removeEventListener("pointerup",Ae(this,zt)),this.context=null}};Ft=new WeakMap,zt=new WeakMap,pt=new WeakSet,Oo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return $e.warn(Ie.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,Ql);if(o==null)return $e.warn(Ie.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return $e.warn(Ie.TAG_NAME,"未找到的可调整元素");const r=lo(s,this.selector.container);this.context=new Wp({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return $e.warn(Ie.TAG_NAME,"已取消调整");if(this.context.container==null)return $e.warn(Ie.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const c=this.createEvent("resizestart",this.context);if(this.dispatch(c).defaultPrevented)return $e.warn(Ie.TAG_NAME,"已取消调整");window.addEventListener("pointermove",Ae(this,Ft)),window.addEventListener("pointerup",Ae(this,zt))},xo=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&Qt.TOP){const a=Math.max((i.bottom-t.clientY)/s,Ie.MIN_LENGTH);l.top=(i.bottom-r.top)/s-a,l.height=a}if(o&Qt.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Ie.MIN_LENGTH)),o&Qt.LEFT){const a=Math.max((i.right-t.clientX)/s,Ie.MIN_LENGTH);l.left=(i.right-r.left)/s-a,l.width=a}o&Qt.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Ie.MIN_LENGTH));const c=this.createEvent("resizing",l);this.dispatch(c).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},Do=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},H(Ie,"TAG_NAME","quickprint-resizeable"),H(Ie,"MIN_LENGTH",12);let ll=Ie;async function Yp(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?At(e.width):Math.round(e.width),o=t?At(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-oo(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function Xp(n){const e=new ll({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,He);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(Yp(n,l),Cn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),Cn.clean()}),n.onResizeStart=e.onResizeStart,e}function jp(n){function e(r){const i=document.activeElement,c=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||c.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===ce.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===ce.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||as()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const c=r.key==="ArrowUp"?-1:1,a=i.map(d=>d.setTop(d.top+c,!0)?d:null).filter(d=>d!=null);a.length>0&&n.replaceSnapshot("top",a);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const c=r.key==="ArrowLeft"?-1:1,a=i.map(d=>d.setLeft(d.left+c,!0)?d:null).filter(d=>d!=null);a.length>0&&n.replaceSnapshot("left",a);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const c=n.doc.pages.reduce((a,d)=>a.concat(d.children),[]);return n.multiSelectElements(c)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const c=t();for(const a of i)a.setLeft(a.left+8),a.setTop(a.top+8),c.append(a);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const dn="openprint:element,";function Zp(n){function e(){return navigator.clipboard.readText().catch(c=>(console.log(c),null))}function t(c){return navigator.clipboard.writeText(c).catch(a=>{console.log(a)})}async function l(){const c=await e();if(c==null||!c.startsWith(dn))return[];t("");const a=Sn(us(c.slice(dn.length)),[]);return a.length===0?[]:a.map(d=>(delete d.id,pe.create(d))).sort(pe.sort)}function o(c){const a=`${dn}${cs(JSON.stringify(c))}`;return t(a)}async function s(){const c=await e();return typeof c=="string"&&c.startsWith(dn)}function r(){}function i(c){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const Ao=Symbol();function Kp(){return{panel:{left:!0,right:!0},scale:100,selectedType:ce.NONE,selectedPage:void 0,selectMode:et.SINGLE,selected:[]}}function Jp(n,e){const t=Oe(Kp()),l=Gp(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:c,selectPage:g,selectElement:v,resetSelectedElement:E,deleteSelectedElement:y,multiSelectElements:u,isSingleSelectedElement:M,isNoSelectedElement:x,zoomIn:T,zoomOut:h,toggleBackground:N,toggleElementPanel:C,toggleConfigPanel:O,getSelectedElements:a,getSelectedPage:d,cleanup:$,replaceSnapshot:w},r=$p(s),i=Xp(s);s.shortcut=jp(s),s.createSnapshot=l.createSnapshot,s.clipboard=Zp();function c(L){s.document.value=L,s.history.createSnapshot()}function a(L){if(s.state.selectedType!==ce.ELEMENT)return[];const D=t.selected;if(D.length==0)return[];const _=D.map(S=>s.doc.findElement(S)).filter(S=>S!=null);return L==null?_:_.filter(S=>L.contains(S))}function d(){var D;const L=t.selectedPage;if(L!=null)return(D=n.value)==null?void 0:D.findPage(L)}function g(L){return E(),t.selectedPage=L.id,t.selectedType=ce.PAGE,!0}function v(L){t.selectMode=et.SINGLE,t.selectedType=ce.ELEMENT,t.selectedPage=void 0;const D=a();for(const _ of D)_.id!==L.id&&_.blur();return L.focus(),t.selected=[L.id],!0}function E(){const L=a();for(const D of L)D.blur();return t.selected=[],t.selectedType=ce.NONE,!0}function y(){if(t.selectedType!=ce.ELEMENT||t.selected.length==0)return!1;let L=!1;const D=a();for(const _ of D)_.remove()&&(L=!0);return L&&s.history.createSnapshot(),!0}function u(L){t.selectMode=et.MULTIPLE,t.selectedType=ce.ELEMENT,t.selectedPage=void 0;const D=a();for(const _ of D)_.blur();for(const _ of L)_.focus();return t.selected=L.map(_=>_.id),!0}function h(){const L=t.scale??100,D=jt.indexOf(L);return D<0?(t.scale=100,!1):D>=jt.length-1?!1:(t.scale=jt[D+1],!0)}function T(){const L=t.scale??100,D=jt.indexOf(L);return D<0?(t.scale=100,!1):D==0?!1:(t.scale=jt[D-1],!0)}function N(){const D=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=D}function C(){s.state.panel.left=!s.state.panel.left}function O(){s.state.panel.right=!s.state.panel.right}function w(L,D){const _=D??s.doc,S=Array.isArray(_)?"element":_ instanceof ye?"document":_ instanceof Lt?"page":"element",A=Array.isArray(_)?_.map(B=>B.id).join(","):_.id,q=`${S}:${A}:${L}`;return l.replaceSnapshot({action:q})}function M(){return s.state.selectedType!==ce.ELEMENT?!1:s.state.selectMode==et.SINGLE||s.state.selectMode==et.MULTIPLE&&s.state.selected.length==1}function x(){return s.state.selectedType!==ce.ELEMENT?!0:s.state.selected.length==0}function $(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),jl(Ao,s),al($),s}function Se(){return Xl(Ao)}const Qp=V({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=ke("classes"),l=Se(),o=k(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=k(()=>{const u=e.page.id,h=l.doc.pages.find(T=>T.id===u);return h==null?0:e.direction=="horizontal"?h.width:h.height}),r=k(()=>{const u=s.value,h=[];for(let T=0;T<=u;T+=10)h.push(T/10);return h}),i=k(()=>{const u=s.value,h=[];for(let T=0;T<=u;T+=2.5)h.push(T);return h}),c=k(()=>{const u=l.getSelectedElements();return u.length==1?u[0]:null}),a=k(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),d=k(()=>{const u=c.value;if(u==null)return 0;if(u.type==="TableCell"){const h=u.parent;if(h==null)return 0;const T=h.parent;return h==null?0:T.top+h.offsetTop}if(u.type==="TableRow"){const h=u.parent;return h==null?0:h.top+u.offsetTop}return u.top}),g=k(()=>{const u=c.value;if(u==null)return 0;if(u.type==="TableCell"){const h=u.parent;if(h==null)return 0;const T=h.parent;return h==null?0:T.left+u.offsetLeft}if(u.type==="TableRow"){const h=u.parent;return h==null?0:h.left}return u.left});function v(u,h){return e.direction==="horizontal"?{left:u*(e.scale/100)+"mm",height:(h-2)%4==0?"8px":"4px"}:{top:u*(e.scale/100)+"mm",width:(h-2)%4==0?"8px":"4px"}}function E(u){return e.direction==="horizontal"?{left:u*(e.scale/100)+"cm"}:{top:u*(e.scale/100)+"cm"}}function y(u){return e.direction==="horizontal"?{left:g.value*(e.scale/100)+"px",width:u.width*(e.scale/100)+"px",height:"100%"}:{top:d.value*(e.scale/100)+"px",height:u.height*(e.scale/100)+"px",width:"100%"}}return(u,h)=>(R(),I("div",{class:m(o.value)},[f("div",{class:m(b(t).ruler),style:K(a.value)},[c.value?(R(),I("div",{key:0,class:m(b(t).selected),style:K(y(c.value))},null,6)):G("",!0),(R(!0),I(Q,null,re(i.value,(T,N)=>(R(),I("div",{key:T,class:m(b(t).scale),style:K(v(T,N))},null,6))),128)),(R(!0),I(Q,null,re(r.value,T=>(R(),I("div",{class:m(b(t).number),style:K(E(T))},Y(T),7))),256))],6)],2))}}),em="_horizontalRuler_170u5_2",tm="_verticalRuler_170u5_15",nm="_ruler_170u5_27",lm="_scale_170u5_32",om="_number_170u5_46",sm="_selected_170u5_71",im={horizontalRuler:em,verticalRuler:tm,ruler:nm,scale:lm,number:om,selected:sm},rm={classes:im},Bl=z(Qp,[["__cssModules",rm]]),am=["title"],fn=8,cm=V({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=ke("classes"),s={},r=Se(),i=k(()=>({top:Math.round(t.top*t.zoom)+"px"}));function c(v){if(v.button!=0||t.disabled===!0)return;const E=v.target.closest("."+o.dragLine);E!=null&&(v.stopPropagation(),s.init=!1,s.target=E,s.parent=E.offsetParent,s.target.setPointerCapture(v.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",d))}function a(v){v.preventDefault();const E=g(s.parent);let y=v.clientY-E.top;y<0&&(y=0),y>E.height&&(y=E.height),t.min>0&&y<t.min+fn&&(y=t.min+fn),t.max>0&&y>t.max-fn&&(y=t.max-fn),s.target.style.top=y/(r.state.scale/100)+"px",s.top=y,s.init=!0}function d(v){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(v.pointerId),window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",d)}function g(v){return v instanceof HTMLElement?v.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(v,E)=>(R(),I("div",{class:m({[b(o).dragLine]:!0,[b(o).disabled]:n.disabled}),style:K(i.value),onPointerdown:ne(c,["stop"]),title:n.title},null,46,am))}}),um="_dragLine_1m7rt_2",dm="_disabled_1m7rt_26",fm={dragLine:um,disabled:dm},pm={classes:fm},ql=z(cm,[["__cssModules",pm]]),mm=V({__name:"Selection",setup(n,{expose:e}){const t=fe(),l=fe(),o=Gt("selectionRef"),s=fe(),r=Se();let i=[];function c(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function a(){const y=[],u=l.value;if(u==null)return y;const h=d(u);if(h.length==0)return y;const T=o.value;return h.forEach(N=>{if(!Bs(N,T)){N.classList.remove(X.SELECTED);return}const C=Reflect.get(N,He);C instanceof pe&&(N.classList.add(X.SELECTED),y.push(C))}),y}function d(y){if(y.matches("."+X.ELEMENT)){const u=Reflect.get(y,He);if(u&&u.type===j.TABLE)return y.querySelectorAll(":scope td")}return y.querySelectorAll(`:scope .${X.PAGE} > .${X.SELECTABLE}`)}function g(y,u){const h=u.closest("."+X.PAPER);if(h==null)return;y.stopPropagation(),y.preventDefault();const T=c(),N=h.getBoundingClientRect();T.initialX=y.clientX,T.initialY=y.clientY,T.top=y.clientY-N.top,T.left=y.clientX-N.left,l.value=u,s.value=T,t.value=h,i=[],window.addEventListener("pointermove",v),window.addEventListener("pointerup",E)}function v(y){const u=s.value;if(u==null)return;y.stopPropagation(),y.preventDefault();const h=o.value;if(u.init!==!0){if(Math.abs(y.clientX-u.initialX)<4&&Math.abs(y.clientY-u.initialY)<4)return;h.setPointerCapture(y.pointerId),h.style.display="block",u.init=!0}const T=Math.abs(y.clientX-u.initialX),N=Math.abs(y.clientY-u.initialY),C=y.clientX<u.initialX?-T:0,O=y.clientY<u.initialY?-N:0;h.style.top=u.top+O+"px",h.style.left=u.left+C+"px",h.style.width=T+"px",h.style.height=N+"px",i=a()}function E(y){const u=s.value;if(u==null)return;u.init&&(y.stopPropagation(),y.preventDefault()),i.length>0&&r.multiSelectElements(i);const h=o.value;h.releasePointerCapture(y.pointerId),h.style.display="none",s.value=void 0,window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",E)}return e({onSelectStart:g}),(y,u)=>(R(),I("div",{ref_key:"selectionRef",ref:o,class:m(y.classes.selection),onClick:u[0]||(u[0]=ne(()=>{},["stop"]))},null,2))}}),gm="_selection_10jfe_2",hm={selection:gm},vm={classes:hm},bm=z(mm,[["__cssModules",vm]]);function ym(n){return Oe({style:kn(n.style??{})})}function _m(n,e){n.style=Object.assign({},n.style,e.style)}const Em=xe(function(n){return mt("元素",(e,t)=>p($n,{options:ym(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>_m(n,e)).catch(De)});function Tm(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){Em(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},gl(t,e.element)),In.open(n.clientX,n.clientY,{menus:l})}const Sm=V({props:{element:{type:pe,required:!0}},setup(n){const e=ke("classes"),t=Se(),l=k(()=>{const g=n.element;g.state.key;const v={"--quickprint-element-top":g.top+"px","--quickprint-element-left":g.left+"px","--quickprint-element-width":g.width+"px","--quickprint-element-height":g.height+"px","z-index":g.zIndex};return r()&&(v.transform=`rotate(${g.style.rotate}deg)`),v}),o={TOP:[e.resizeTop,Dt.TOP],BOTTOM:[e.resizeBottom,Dt.BOTTOM],LEFT:[e.resizeLeft,Dt.LEFT],RIGHT:[e.resizeRight,Dt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Dt.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const g=n.element;return g.style.rotate==0||g.style.rotate==null?!1:t.state.selectMode===et.SINGLE?!g.isSelected:!0}function i(g){const v=Tp(g.type);if(v==null)return p("div",{class:e.unknown},[p("span",null,[le("未知的打印元素")])]);const E={element:g,key:g.id+"_"+g.state.key};return wp(g.type)?(E.onContextmenu=a,dt(v,E)):dt(v,E)}function c(g,v){v.stopPropagation();const E=v.target.closest("."+X.ELEMENT);E&&Reflect.get(E,Nn)===dl.DRAG_ELEMENT||t.selectElement(g)}function a(g){g.stopPropagation(),g.preventDefault(),Tm(g,n,t)}function d(){return!kp(n.element.type)||r()?null:s.map(g=>{const v={class:[X.RESIZEABLE_INDICATOR,g[0]],["."+Ql]:g[1]};return p("div",Es(v,{onPointerdown:t.onResizeStart}),null)})}return function(){const g=n.element,v={["."+He]:g,["."+ul]:g.type,id:g.id,key:g.id,class:{[X.ELEMENT]:!0,[X.DRAGGABLE]:!0,[X.RESIZEABLE]:!0,[X.SELECTED]:g.state.selected,[X.SELECTABLE]:Rp(g.type),["quickprint-is-"+g.type.toLowerCase()]:!0},style:l.value,onClick:c.bind(null,g)};return p("div",v,[i(g),d()])}}}),Rm="_unknown_za8zh_2",wm="_resizeTop_za8zh_12",km="_resizeBottom_za8zh_20",Cm="_resizeLeft_za8zh_28",Lm="_resizeRight_za8zh_36",Im="_resizeBottomRight_za8zh_44",Nm={unknown:Rm,resizeTop:wm,resizeBottom:km,resizeLeft:Cm,resizeRight:Lm,resizeBottomRight:Im},Om={classes:Nm},xm=z(Sm,[["__cssModules",Om]]),Mo=Ul(()=>Hl(()=>import("./component-pGqeo5PS.js"),__vite__mapDeps([2,3,1,4,5]))),Dm=V({__name:"DocJson",props:{doc:{type:ye,required:!0}},setup(n){const e=n,t=ot(),l=ue(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(R(),J(b(Mo),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),Am="_json_9crpe_2",Mm={json:Am},Bm={classes:Mm},qm=z(Dm,[["__cssModules",Bm]]),$m=xe(function(n){return ut("调试",p(qm,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(Ke)});async function Pm(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+X.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const c=r.getBoundingClientRect(),a=n.clientX-c.left-i[0].left,d=n.clientY-c.top-i[0].top;for(const g of i)g.setLeft(g.left+a),g.setTop(g.top+d),e.page.append(g);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){$m(t).then(r=>{if(r==null)return;const i=ye.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),In.open(n.clientX,n.clientY,{menus:l})}const Vm=V({props:{doc:{type:ye,required:!0},page:{type:Lt,required:!0}},setup(n){const e=ke("classes"),t=Se(),l=Gt("selectionRef"),o=Gt("paperRef"),s=ue(0),r=k(()=>n.page.width),i=k(()=>n.page.height);function c(N){N.stopPropagation();const C=N.target.closest("."+X.PAPER);C&&Reflect.get(C,Nn)===dl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function a(){if(n.page.header.display===!1)return null;const N=n.page.header.height,C="page_header_"+s.value;return p(ql,{title:"页眉",top:N,onMove:g,key:C},null)}function d(){if(n.page.footer.display===!1)return null;const N=Ut(i.value)-n.page.footer.height,C="page_footer_"+s.value;return p(ql,{title:"页脚",top:N,onMove:v,key:C},null)}function g(N){n.page.setHeaderHeight(N.top),s.value++}function v(N){n.page.setFooterHeight(Ut(i.value)-N.top),s.value++}function E(N){N.stopPropagation(),N.preventDefault(),Pm(N,n,t)}function y(){const N=n.doc.margins;if(N==null)return null;const C=[];return N.top&&C.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:N.top+"px"}},null)),N.bottom&&C.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:N.bottom+"px"}},null)),N.left&&C.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:N.left+"px"}},null)),N.right&&C.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:N.right+"px"}},null)),C.length>0?C:null}function u(){const N={["."+Jl]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[X.PAGE]:!0,[X.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:E},C=n.page.children.map(O=>p(xm,{element:O},null));return p("div",N,[a(),C,d(),y()])}function h(N){if(N.button!==0)return;N.stopPropagation(),N.preventDefault();const O=N.target.closest("."+X.ELEMENT);if(O==null)return T(N,o.value);const w=Reflect.get(O,He);return w==null?T(N,o.value):w.type===j.TABLE?T(N,O):Cp(w.type)?t.onDragStart(N):T(N,o.value)}function T(N,C){var O;(O=l.value)==null||O.onSelectStart(N,C)}return function(){const N=t.state.scale/100,C={id:"@"+n.page.id,ref:"paperRef",class:{[X.PAPER]:!0,[X.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*N+"mm",height:i.value*N+"mm"},onPointerdown:h,onClick:c};return p("div",C,[u(),p(bm,{ref:"selectionRef"},null)])}}}),Fm="_paper_fdphx_2",zm="_grid_fdphx_12",Um="_marginHorizontalGuide_fdphx_21",Hm="_marginVerticalGuide_fdphx_29",Gm={paper:Fm,grid:zm,marginHorizontalGuide:Um,marginVerticalGuide:Hm},Wm={classes:Gm},Ym=z(Vm,[["__cssModules",Wm]]),Xm={class:"quickprint-is-fill-h quickprint-is-scrollable"},jm="icon-zhanweifu",Zm=V({__name:"Element",setup(n){const e=Se();return(t,l)=>(R(),I("div",{class:m(t.classes.panel)},[f("div",{class:m(t.classes.header)},"可打印元素",2),f("div",Xm,[f("div",{class:m(t.classes.grid)},[(R(!0),I(Q,null,re(b(bp),o=>(R(),I("div",Zl({key:o.type,class:[b(X).DRAGGABLE,t.classes.element],[`.${b(Kl)||""}`]:b(qe).INSERT,[`.${b(ul)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>b(e).onDragStart&&b(e).onDragStart(...s))}),[p(b(F),{icon:o.icon??jm,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),f("span",null,Y(o.title),1)],48))),128))],2)])],2))}}),Km="_panel_1p36j_2",Jm="_header_1p36j_8",Qm="_grid_1p36j_18",eg="_element_1p36j_30",tg="_icon_1p36j_45",ng={panel:Km,header:Jm,grid:Qm,element:eg,icon:tg},lg={classes:ng},og=z(Zm,[["__cssModules",lg]]),sg=["onClick"],ig=V({__name:"SelectPath",setup(n){const e=Se(),t=k(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===ce.PAGE){const i=e.getSelectedPage();if(i!=null){const c="页面"+(i.index+1);r.push({id:i.id,title:c,type:"page",data:i})}return r}if(s.selectedType===ce.ELEMENT){if(s.selectMode===et.MULTIPLE){const a=e.getSelectedElements();if(a.length===0)return r;let d=a[0];for(;d.parent;){const g=d.parent;if(g instanceof Lt){const v="页面"+(g.index+1);return r.push({id:g.id,title:v,type:"page",data:g}),r}d=g}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const c=[{id:i.id,title:on(i.type),type:"element",data:i}];for(;i.parent;){const a=i.parent;if(a instanceof Lt){const d="页面"+(a.index+1);return c.unshift({id:a.id,title:d,type:"page",data:a}),r.concat(c)}c.unshift({id:a.id,title:on(a.type),type:"element",data:a}),i=a}}return r}),l=k(()=>{if(e.state.selectedType!=ce.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],c=fl(i,e.doc.ds);if(!(c==null||!c.content))return c.type===_e.VARIABLE||c.type===_e.FORMULA?`[${c.content}]`:c.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(R(),I("div",{class:m(s.classes.paths)},[(R(!0),I(Q,null,re(t.value,(i,c)=>(R(),I(Q,{key:i.id},[c>0?(R(),J(b(F),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):G("",!0),f("div",{class:m(s.classes.path),onClick:a=>o(i)},Y(i.title),11,sg)],64))),128)),l.value?(R(),I(Q,{key:0},[p(b(F),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),f("div",{class:m(s.classes.content)},Y(l.value),3)],64)):G("",!0)],2))}}),rg="_paths_fuk62_2",ag="_path_fuk62_2",cg="_icon_fuk62_28",ug="_content_fuk62_33",dg={paths:rg,path:ag,icon:cg,content:ug},fg={classes:dg},pg=z(ig,[["__cssModules",fg]]),mg=["min","readonly","placeholder"],gg=V({__name:"LabelNumber",props:It({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=sn(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const c=e.min?e.min:e.defaultValue;t.value=c;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const c=Math.pow(10,e.precision);t.value=Math.round(i*c)/c}}return(o,s)=>(R(),I("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[Ee(f("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,mg),[[Ne,t.value]]),f("span",{class:m(o.classes.label)},Y(n.label),3)],2))}}),hg="_labelNumber_1aifb_2",vg="_label_1aifb_2",bg="_readonly_1aifb_25",yg={labelNumber:hg,label:vg,readonly:bg},_g={classes:yg},Bt=z(gg,[["__cssModules",_g]]),Eg={class:"quickprint-config"},Tg={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},Sg={class:"quickprint-config-group"},Rg={class:"quickprint-config-section quickprint-config-inline"},wg={class:"quickprint-config-content quickprint-config-inline"},kg={class:"quickprint-config-group"},Cg={class:"quickprint-config-section quickprint-config-inline"},Lg={class:"quickprint-config-content quickprint-config-inline"},Ig={class:"quickprint-config-section quickprint-config-inline"},Ng={class:"quickprint-config-content quickprint-form-inline"},Og={class:"quickprint-config-group"},xg={class:"quickprint-config-section quickprint-config-inline"},Dg={class:"quickprint-config-content quickprint-form-inline"},Ag={key:0,class:"quickprint-config-section quickprint-config-inline"},Mg={class:"quickprint-config-content quickprint-form-inline"},Bg={class:"quickprint-config-section quickprint-config-inline"},qg={class:"quickprint-config-content quickprint-form-inline"},$g=V({__name:"PageConfig",props:{page:{type:Lt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=[{label:"禁止",value:cn.NONE},{label:"跟随表格",value:cn.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],o=k({get(){return e.page.size.type},set(a){e.page.size.type=a,a===tn.CONTENT&&(e.page.size.orientation=void 0)}}),s=k({get(){return e.page.orientation},set(a){e.page.size.orientation=a}}),r=k(()=>e.page.width),i=k({get(){return e.page.height},set(a){const d=Number(a);!il(d)||d<0||(e.page.size.height=d)}}),c=k({get(){return e.page.footer.flow??cn.NONE},set(a){e.page.footer.flow=a===cn.NONE?void 0:a}});return(a,d)=>(R(),I("div",Eg,[d[15]||(d[15]=f("div",{class:"quickprint-config-title"},"页面配置",-1)),f("div",Tg,[f("div",Sg,[d[7]||(d[7]=f("div",{class:"quickprint-config-group-title"},"页眉",-1)),f("section",Rg,[d[6]||(d[6]=f("header",{class:"quickprint-config-header"},"位置",-1)),f("div",wg,[p(Bt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(Mt,{modelValue:n.page.header.display,"onUpdate:modelValue":d[0]||(d[0]=g=>n.page.header.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),f("div",kg,[d[10]||(d[10]=f("div",{class:"quickprint-config-group-title"},"页脚",-1)),f("section",Cg,[d[8]||(d[8]=f("header",{class:"quickprint-config-header"},"位置",-1)),f("div",Lg,[p(Bt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(Mt,{modelValue:n.page.footer.display,"onUpdate:modelValue":d[1]||(d[1]=g=>n.page.footer.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",Ig,[d[9]||(d[9]=f("header",{class:"quickprint-config-header"},"跟随",-1)),f("div",Ng,[p(b(ee),{modelValue:c.value,"onUpdate:modelValue":d[2]||(d[2]=g=>c.value=g),options:l},null,8,["modelValue"])])])]),f("div",Og,[d[14]||(d[14]=f("div",{class:"quickprint-config-group-title"},"画布",-1)),f("section",xg,[d[11]||(d[11]=f("header",{class:"quickprint-config-header"},"尺寸",-1)),f("div",Dg,[p(Mt,{modelValue:o.value,"onUpdate:modelValue":d[3]||(d[3]=g=>o.value=g),options:b(Os),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===b(tn).CONTENT?(R(),I("section",Ag,[d[12]||(d[12]=f("header",{class:"quickprint-config-header"},"内容",-1)),f("div",Mg,[p(Bt,{class:"quickprint-form-inline-item",label:"宽",modelValue:r.value,readonly:""},null,8,["modelValue"]),p(Bt,{class:"quickprint-form-inline-item",label:"高",modelValue:i.value,"onUpdate:modelValue":d[4]||(d[4]=g=>i.value=g)},null,8,["modelValue"])])])):G("",!0),f("section",Bg,[d[13]||(d[13]=f("header",{class:"quickprint-config-header"},"方向",-1)),f("div",qg,[p(Mt,{modelValue:s.value,"onUpdate:modelValue":d[5]||(d[5]=g=>s.value=g),class:"quickprint-w-full",options:b(no),disabled:n.page.size.type===b(tn).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),Pg=["value","placeholder"],Vg=V({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=Gt("inputRef"),s=k({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?_l(t.modelValue):t.standard==="mm"&&t.target==="px"?Ut(t.modelValue):0},set(d){if(t.standard===t.target)return l("update:modelValue",d);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Ut(d));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",_l(d))}}),r=k(()=>t.clearable&&s.value!=null);function i(d){const v=d.target.value;if(s==null||v===""){if(t.clearable)return;const y=t.min?t.min:t.defaultValue;s.value=y;return}const E=Number(v);if(!Number.isNaN(E)){if(t.min!=null&&E<t.min){s.value=t.min;return}if(t.standard==="px"){s.value=Math.round(E);return}s.value=E}}function c(){l("update:modelValue",void 0)}function a(){var d;(d=o.value)==null||d.blur(),setTimeout(()=>{var g;return(g=o.value)==null?void 0:g.focus()},50)}return(d,g)=>(R(),I("label",{class:m({[d.classes.inputUnit]:!0,[d.classes.withClear]:n.clearable})},[f("span",{class:m(d.classes.label)},Y(n.label),3),f("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",value:s.value,placeholder:n.placeholder,onBlur:i,onKeydown:Yl(a,["enter"])},null,40,Pg),r.value?(R(),I("span",{key:0,class:m(d.classes.clearBtn),onClick:ne(c,["stop"])},[p(b(F),{icon:"icon-close",size:"11px"})],2)):G("",!0)],2))}}),Fg="_inputUnit_2ymft_2",zg="_clearBtn_2ymft_7",Ug="_label_2ymft_11",Hg="_withClear_2ymft_31",Gg={inputUnit:Fg,clearBtn:zg,label:Ug,withClear:Hg},Wg={classes:Gg},ct=z(Vg,[["__cssModules",Wg]]),Yg=V({__name:"UnitSelect",props:It({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=sn(n,"modelValue"),o=k(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(R(),I("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(b(ee),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:we(()=>[f("span",{class:m(s.classes.text)},Y(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),Xg="_unit_135mn_2",jg="_text_135mn_8",Zg="_select_135mn_25",Kg={unit:Xg,text:jg,select:Zg},Jg={classes:Kg},Bo=z(Yg,[["__cssModules",Jg]]),Qg=V({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=ue(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch(ds)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(R(),I("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[p(b(F),{icon:"icon-copy"}),p(Ts,{name:"quickprint-fade"},{default:we(()=>[l.value?(R(),I("span",{key:0,class:m(s.classes.message)},"已复制",2)):G("",!0)]),_:1})],2))}}),eh="_btn_v9scw_2",th="_message_v9scw_6",nh={btn:eh,message:th},lh={classes:nh},oh=z(Qg,[["__cssModules",lh]]),sh=V({__name:"window",props:{code:{type:String,default:""},doc:{type:ye,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=ot(),l=ue(e.code),o=fe();function s(){return l.value}function r(){e.doc!=null&&cc({doc:e.doc}).then(g=>{var E;if(g==null)return;const v=g.type=="reference"?`[=${g.value}]`:`[${g.value}]`;(E=o.value)==null||E.insert(v)})}function i(g){var v;return lt(g,(v=e.doc)==null?void 0:v.ds)}function c(){var g;(g=o.value)==null||g.insert(`[2.6.${ol.ELEMENT_VALUR}]`)}function a(){uc().then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}function d(){dc({doc:e.doc}).then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}return t==null||t.useHandle("confirm",s),(g,v)=>(R(),I("div",{class:m(g.classes.window)},[n.mode!=="code"?(R(),I("div",{key:0,class:m(g.classes.toolbar)},[n.mode=="condition"?(R(),I(Q,{key:0},[f("button",{type:"button",class:"quickprint-text-btn",onClick:c},[p(b(F),{icon:"icon-number-sign"}),v[1]||(v[1]=f("span",null,"插入元素值",-1))]),f("div",{class:m(g.classes.divider)},null,2)],64)):G("",!0),f("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[p(b(F),{icon:"icon-insert-var"}),v[2]||(v[2]=f("span",null,"插入变量",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:a},[p(b(F),{icon:"icon-function"}),v[3]||(v[3]=f("span",null,"插入函数",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:d},[p(b(F),{icon:"icon-formula"}),v[4]||(v[4]=f("span",null,"插入公式",-1))])],2)):G("",!0),p(b(Mo),{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=E=>l.value=E),language:"javascript",class:m(g.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),ih="_window_n935p_2",rh="_toolbar_n935p_11",ah="_code_n935p_22",ch="_divider_n935p_27",uh={window:ih,toolbar:rh,code:ah,divider:ch},dh={classes:uh},qo=z(sh,[["__cssModules",dh]]),$o=xe(function(n){return ut("公式",p(qo,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(De)}),fh=xe(function(n,e){return ut(n,p(qo,{code:e},null),{preset:"editor"}).promisify().catch(De)}),ph={class:"quickprint-config-section quickprint-config-inline"},mh={class:"quickprint-config-content"},gh=["value"],hh=V({__name:"Visibility",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=k({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??wt.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==wt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=k({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=k(()=>{var i;return pl((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=k(()=>{var i;return t.value!==wt.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${ol.ELEMENT_VALUR}]`;$o({code:i,doc:e.element.doc,mode:"condition"}).then(c=>{c!=null&&(l.value=c)})}return(i,c)=>(R(),I(Q,null,[f("section",ph,[c[1]||(c[1]=f("header",{class:"quickprint-config-header"},"可见性",-1)),f("div",mh,[p(b(ee),{class:"quickprint-w-full",options:b(ws),modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=a=>t.value=a)},null,8,["options","modelValue"])])]),t.value===b(wt).CONDITION?(R(),I("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[f("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,gh),s.value?(R(),J(b(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2)):G("",!0)],64))}}),vh="_condition_siopf_2",bh={condition:vh},yh={classes:bh},_h=z(hh,[["__cssModules",yh]]);function Eh(n){return k({get(){return n.element.attributes.position??_n.DEFAULT},set(e){const t=e===_n.DEFAULT?void 0:e;n.element.attributes.position=t}})}function Th(n){return k({get(){return n.element.attributes.printMode??En.ONCE},set(e){const t=e===En.ONCE?void 0:e;n.element.attributes.printMode=t}})}function Sh(n){return k({get(){return n.element.attributes.overflow??nn.HIDDEN},set(e){const t=e===nn.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function Rh(n){return k({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function wh(n){return k({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function kh(n){return k({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function Ch(n){return k({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const Lh=V({__name:"Const",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=k({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,o)=>Ee((R(),I("textarea",{"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Ne,t.value]])}}),Ih={class:"quickprint-config-ds-var-type"},Nh=["title"],Oh=V({__name:"Variable",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Se(),l=k(()=>ie(e.element.ds.value)),o=k(()=>lt(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var d;const i=await ml({doc:t.doc,value:e.element.ds.value}).catch(Ke);if(i==null||(e.element.setDataSource(_e.VARIABLE,i.value),e.element.type!=j.TABLE_CELL||i.type!=="ds"))return;const c=e.element.parent;if(c==null||c.isBindVariable||((d=i.parent)==null?void 0:d.type)!==te.ARRAY)return;const a=i.parent;c.setDataSource(_e.VARIABLE,`${kt.DS}.${a.type}.${a.name}`)}return(i,c)=>(R(),I("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(R(),I(Q,{key:0},[c[0]||(c[0]=f("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(b(F),{icon:"icon-open-new",size:"14px"})],64)):(R(),I(Q,{key:1},[f("span",Ih,"<"+Y(b(zr)(e.element.ds.value))+">",1),f("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},Y(o.value),9,Nh),f("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[p(b(F),{icon:"icon-close",size:"12px"})])],64))]))}}),xh=["value"],Dh=V({__name:"Code",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=k(()=>ie(e.element.ds.value));function l(){return sl(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){fh("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(R(),I("div",{onClick:o,class:m(s.classes.code)},[f("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,xh),t.value?(R(),J(b(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2))}}),Ah="_code_1az68_2",Mh={code:Ah},Bh={classes:Mh},qh=z(Dh,[["__cssModules",Bh]]),$h=["value"],Ph=V({__name:"Formula",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Se(),l=k(()=>ie(e.element.ds.value)),o=k(()=>pl(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;$o({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(R(),I("div",{onClick:s,class:m(r.classes.code)},[f("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,$h),l.value?(R(),J(b(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2))}}),Vh="_code_ipm2q_2",Fh={code:Vh},zh={classes:Fh},Uh=z(Ph,[["__cssModules",zh]]);function Hh(n){switch(n.ds.type){case _e.CONST:return p(Lh,{element:n},null);case _e.VARIABLE:return p(Oh,{element:n},null);case _e.CODE:return p(qh,{element:n},null);case _e.FORMULA:return p(Uh,{element:n},null);default:return null}}const Gh=V({props:{element:{type:pe,required:!0}},setup(n){const e=k(()=>on(n.element.type)),t=k(()=>Is.filter(C=>C.value!=n.element.type)),l=ue("px"),o=Rh(n),s=wh(n),r=Sh(n),i=Eh(n),c=Th(n),a=kh(n),d=Ch(n),g=k(()=>{const C=n.element,O=C.parent;if(O===null||!(O instanceof Lt))return!1;const w=O.header;if(w.display&&C.bottom<=(w.height??0))return!1;const M=O.parent;if(M==null)return!1;const x=O.footer;return!(x.display&&C.top>=Math.floor(Ut(M.paper.height))-(x.height??0))});function v(C,O){return O==null?!1:!!O.includes(C)}function E(){const C=Kt(n.element.type);if(v(de.LAYOUT,C==null?void 0:C.exclude))return null;const O=n.element,w=v(de.COORD,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(ct,{class:"quickprint-form-inline-item",label:"左",modelValue:O.left,"onUpdate:modelValue":_=>O.left=_,target:l.value},null),p(ct,{class:"quickprint-form-inline-item",label:"上",modelValue:O.top,"onUpdate:modelValue":_=>O.top=_,target:l.value},null)])]),M=v(de.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[le("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(ct,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,"onUpdate:modelValue":_=>o.value=_,target:l.value},null),p(ct,{class:"quickprint-form-inline-item",label:"高",modelValue:s.value,"onUpdate:modelValue":_=>s.value=_,target:l.value},null)])]),x=v(de.VISIBILITY,C==null?void 0:C.exclude)?null:p(_h,{element:O},null),$=v(de.OVERFLOW,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("溢出时")]),p("div",{class:"quickprint-config-content"},[p(ee,{modelValue:r.value,"onUpdate:modelValue":_=>r.value=_,options:As,class:"quickprint-w-full"},null)])]),L=v(de.PRINT_MODE,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[le("打印模式")]),p("div",{class:"quickprint-config-content"},[p(ee,{modelValue:c.value,"onUpdate:modelValue":_=>c.value=_,options:Ds,class:"quickprint-w-full"},null)])]),D=v(de.POSITION,C==null?void 0:C.exclude)||!g.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("定位模式")]),p("div",{class:"quickprint-config-content"},[p(ee,{modelValue:i.value,"onUpdate:modelValue":_=>i.value=_,options:xs,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[le("布局")]),p("span",null,[le("单位：")]),p(Bo,{modelValue:l.value,"onUpdate:modelValue":_=>l.value=_},null)]),w,M,x,$,L,D])}function y(){const C=Kt(n.element.type);if(v(de.BASIC,C==null?void 0:C.exclude))return null;const O=n.element,w=v(de.PREFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("前缀")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{"onUpdate:modelValue":$=>O.attributes.prefix=$,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ne,O.attributes.prefix]])])]),M=v(de.SUFFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("后缀")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{"onUpdate:modelValue":$=>O.attributes.suffix=$,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ne,O.attributes.suffix]])])]),x=v(de.DISPLAY,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("数据类型")]),p("div",{class:"quickprint-config-content"},[p(ee,{options:t.value,modelValue:a.value,"onUpdate:modelValue":$=>a.value=$,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("基础")]),w,M,x])}function u(){const C=Kt(n.element.display);return(C==null?void 0:C.display)==null?null:dt(C.display,{element:n.element})}function h(){const C=Kt(n.element.type);if(v(de.ATTRIBUTES,C==null?void 0:C.exclude))return null;const O=C!=null&&C.attributes?dt(C.attributes,{element:n.element}):null,w=u();if(O==null&&w==null)return null;const M=w!=null&&O!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("属性")]),w,M,O])}function T(){const C=Kt(n.element.type);return v(de.DATASOURCE,C==null?void 0:C.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("数据")]),p(ee,{options:eo,modelValue:d.value,"onUpdate:modelValue":O=>d.value=O},null),Hh(n.element)])}function N(C){C(n.element.id)}return function(){const O=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,le("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[O.id]),p(oh,{onCopy:N},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("标题")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{type:"text","onUpdate:modelValue":w=>O.title=w,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ne,O.title]])])])]),E(),y(),h(),T()])])}}}),Wh=V({setup(){const n=Se(),e=ke("classes");function t(){return p("div",{class:e.tip},[le("未知的打印元素")])}function l(){return p("div",{class:e.tip},[le("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return p($g,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(j).includes(i.type)===!1?t():dt(Gh,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==ce.ELEMENT?!1:i.selectMode===et.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),Yh="_tip_cdonk_2",Xh={tip:Yh},jh={classes:Xh},Zh=z(Wh,[["__cssModules",jh]]);function Ge(n,e){if(n.state.selectedType!==ce.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Pe(n,e,t){if(n.state.selectedType!==ce.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function Ue(n,e){if(n.state.selectedType!==ce.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function Kh(n){const e="underline";return k({get(){if(n.state.selectedType!==ce.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Pe(n,e,t):Ue(n,e)}})}function Jh(n){const e="lineThrough";return k({get(){if(n.state.selectedType!==ce.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Pe(n,e,t):Ue(n,e)}})}function Qh(n){const e="lineHeight";return k({get(){return Ge(n,e)},set(t){t===_t.DEFAULT?Ue(n,e):Pe(n,e,t)}})}function ev(n){const e="highlightColor";return k({get(){return Ge(n,e)??Be.BLACK},set(t){t===""?Ue(n,e):Pe(n,e,t)}})}function tv(n){const e="backgroundColor";return k({get(){return Ge(n,e)??Be.BLACK},set(t){t===""?Ue(n,e):Pe(n,e,t)}})}function nv(n){const e="fontStyle";return k({get(){return Ge(n,e)===El.ITALIC},set(t){t?Pe(n,e,El.ITALIC):Ue(n,e)}})}function lv(n){const e="textAlign";return k({get(){return Ge(n,e)??at.LEFT},set(t){t===at.LEFT?Ue(n,e):Pe(n,e,t)}})}function ov(n){const e="verticalAlign";return k({get(){return Ge(n,e)??Je.MIDDLE},set(t){t===Je.MIDDLE?Ue(n,e):Pe(n,e,t)}})}function sv(n){const e="fontFamily";return k({get(){return Ge(n,e)},set(t){t===se.DEFAULT?Ue(n,e):Pe(n,e,t)}})}function iv(n){const e="fontSize";return k({get(){return Ge(n,e)},set(t){t===Te.DEFAULT?Ue(n,e):Pe(n,e,t)}})}function rv(n){const e="color";return k({get(){return Ge(n,e)??Be.BLACK},set(t){Pe(n,e,t)}})}function av(n){const e="fontWeight";return k({get(){return Ge(n,e)===700},set(t){t?Pe(n,e,700):Ue(n,e)}})}const cv=["title","onClick"],uv=V({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=Se(),l=k(()=>{if(t.state.selectedType!==ce.ELEMENT)return null;const y=t.getSelectedElements();if(y.length!==1)return null;const u=y[0],h={};return ge(u,"top")&&(h.borderTopStyle="solid"),ge(u,"right")&&(h.borderRightStyle="solid"),ge(u,"bottom")&&(h.borderBottomStyle="solid"),ge(u,"left")&&(h.borderLeftStyle="solid"),h}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(E){if(t.state.selectedType!==ce.ELEMENT)return!1;const u=t.getSelectedElements();if(u.length!==1)return!1;const h=u[0];switch(E){case e.TOP:return ge(h,"top");case e.RIGHT:return ge(h,"right");case e.BOTTOM:return ge(h,"bottom");case e.LEFT:return ge(h,"left");case e.ALL:return ge(h,"top")&&ge(h,"right")&&ge(h,"bottom")&&ge(h,"left");default:return!1}}function r(E){if(t.state.selectedType!==ce.ELEMENT)return;const u=t.getSelectedElements();if(u.length!=0){switch(E){case e.TOP:return c(u);case e.BOTTOM:return d(u);case e.LEFT:return g(u);case e.RIGHT:return a(u);case e.ALL:return v(u)}t.createSnapshot()}}function i(){if(t.state.selectedType!==ce.ELEMENT)return;const y=t.getSelectedElements();if(y.length!=0){for(const u of y)u.setStyle("borderStyle",void 0),u.setStyle("borderTopStyle",void 0),u.setStyle("borderRightStyle",void 0),u.setStyle("borderBottomStyle",void 0),u.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function c(E){const y=!E.every(u=>ge(u,"top"));for(const u of E)y?u.setStyle("borderTopStyle",ae.SOLID):u.removeStyle("borderTopStyle")}function a(E){const y=!E.every(u=>ge(u,"right"));for(const u of E)y?u.setStyle("borderRightStyle",ae.SOLID):u.removeStyle("borderRightStyle")}function d(E){const y=!E.every(u=>ge(u,"bottom"));for(const u of E)y?u.setStyle("borderBottomStyle",ae.SOLID):u.removeStyle("borderBottomStyle")}function g(E){const y=!E.every(u=>ge(u,"left"));for(const u of E)y?u.setStyle("borderLeftStyle",ae.SOLID):u.removeStyle("borderLeftStyle")}function v(E){const y=!E.every(u=>ge(u,"top")&&ge(u,"right")&&ge(u,"bottom")&&ge(u,"left"));for(const u of E){if(y){u.setStyle("borderStyle",y?"solid":void 0);continue}u.removeStyle("borderStyle"),u.removeStyle("borderTopStyle"),u.removeStyle("borderRightStyle"),u.removeStyle("borderBottomStyle"),u.removeStyle("borderLeftStyle")}}return(E,y)=>(R(),J(b(ao),null,{popover:we(()=>[f("div",{class:m(E.classes.popover)},[f("div",null,[(R(),I("button",{type:"button",title:"全部框线",key:b(e).ALL,class:m({"quickprint-text-btn":!0,[E.classes.tool]:!0,"quickprint-is-selected":s(b(e).ALL)}),onClick:y[0]||(y[0]=u=>r(b(e).ALL))},[p(b(F),{icon:"icon-border",size:"16px"})],2)),(R(),I("button",{type:"button",title:"无框线",key:b(e).NONE,class:m({"quickprint-text-btn":!0,[E.classes.tool]:!0}),onClick:i},[p(b(F),{icon:"icon-border-none",size:"16px"})],2))]),f("div",{class:m(E.classes.divider)},[(R(),I(Q,null,re(o,u=>f("button",{type:"button",title:u.label,key:u.value,class:m({"quickprint-text-btn":!0,[E.classes.tool]:!0,"quickprint-is-selected":s(u.value)}),onClick:h=>r(u.value)},[p(b(F),{icon:u.icon,size:"16px"},null,8,["icon"])],10,cv)),64))],2)],2)]),default:we(()=>[f("div",{class:m(["quickprint-text-btn",E.classes.borderSelect]),title:"边框"},[f("div",{class:m({[E.classes.border]:!0}),style:K(l.value)},null,6)],2)]),_:1}))}}),dv="_border_rprfx_2",fv="_borderSelect_rprfx_10",pv="_popover_rprfx_14",mv="_divider_rprfx_18",gv={border:dv,borderSelect:fv,popover:pv,divider:mv},hv={classes:gv},vv=z(uv,[["__cssModules",hv]]),bv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},yv={class:"quickprint-config-section"},_v={class:"quickprint-form-inline"},Ev={class:"quickprint-config-section quickprint-config-inline"},Tv={class:"quickprint-config-section"},Sv={class:"quickprint-config-header quickprint-is-row"},Rv={class:"quickprint-is-fill-w"},wv={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},kv={class:"quickprint-config-content quickprint-form-inline"},Cv=V({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=ue("px"),l=v("top"),o=v("bottom"),s=v("left"),r=v("right"),i=k(()=>Hn.map(E=>({label:E.size===Gn.CUSTOM?"自定义":`${E.size}(${E.width}mm ✕ ${E.height}mm)`,value:E.size})));function c(E){e.config.width=E,g()}function a(E){e.config.height=E,g()}function d(E){const y=Hn.find(u=>u.size===E);y!=null&&(e.config.width=y.width,e.config.height=y.height,e.config.orientation=y.orientation,e.config.margins=y.margins,e.config.size=y.size)}function g(){const E=e.config,y=Hn.find(u=>u.size===Gn.CUSTOM?!1:u.orientation===E.orientation&&u.width===E.width&&u.height===E.height);if(y==null){E.size=Gn.CUSTOM;return}E.size=y.size}function v(E){return k({get(){var y;return(y=e.config.margins)==null?void 0:y[E]},set(y){e.config.margins==null&&(e.config.margins={}),e.config.margins[E]=y}})}return(E,y)=>(R(),I("div",bv,[f("section",yv,[y[6]||(y[6]=f("header",{class:"quickprint-config-header"},[f("span",null,"尺寸")],-1)),p(b(ee),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":d,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),f("div",_v,[p(Bt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":c},null,8,["modelValue"]),p(Bt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":a},null,8,["modelValue"])])]),f("section",Ev,[y[7]||(y[7]=f("header",{class:"quickprint-config-header"},"方向",-1)),p(Mt,{modelValue:n.config.orientation,"onUpdate:modelValue":y[0]||(y[0]=u=>n.config.orientation=u),options:b(no)},null,8,["modelValue","options"])]),f("section",Tv,[f("header",Sv,[f("span",Rv,[p(b(Hs),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:we(()=>y[8]||(y[8]=[le("参考边距")])),_:1})]),y[9]||(y[9]=f("span",null,"单位：",-1)),p(Bo,{modelValue:t.value,"onUpdate:modelValue":y[1]||(y[1]=u=>t.value=u)},null,8,["modelValue"])]),f("div",wv,[p(ct,{class:"quickprint-form-inline-item",label:"上",modelValue:b(l),"onUpdate:modelValue":y[2]||(y[2]=u=>Qe(l)?l.value=u:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(ct,{class:"quickprint-form-inline-item",label:"下",modelValue:b(o),"onUpdate:modelValue":y[3]||(y[3]=u=>Qe(o)?o.value=u:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),f("div",kv,[p(ct,{class:"quickprint-form-inline-item",label:"左",modelValue:b(s),"onUpdate:modelValue":y[4]||(y[4]=u=>Qe(s)?s.value=u:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(ct,{class:"quickprint-form-inline-item",label:"右",modelValue:b(r),"onUpdate:modelValue":y[5]||(y[5]=u=>Qe(r)?r.value=u:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),Lv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Iv={class:"quickprint-is-fill-h"},Nv={class:"quickprint-is-fill-h"},Ov=V({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:be.NONE},{label:"磅",value:be.PT},{label:"像素",value:be.PX}],l=k(()=>qn.map(a=>(a.style={fontFamily:a.value==se.DEFAULT?se.SONG:a.value},a))),o=k(()=>_o.map(a=>(a.style={fontFamily:a.value==se.DEFAULT?se.SONG:a.value},a))),s=k({get(){return e.config.style.fontFamily??se.DEFAULT},set(a){const d=a===se.DEFAULT?void 0:a;e.config.style.fontFamily=d}}),r=k({get(){return e.config.style.enFontFamily??se.DEFAULT},set(a){const d=a===se.DEFAULT?void 0:a;e.config.style.enFontFamily=d}}),i=k({get(){return e.config.style.fontSize},set(a){const d=ie(a)?void 0:a;e.config.style.fontSize=d}}),c=k({get(){return e.config.style.lineHeight},set(a){e.config.style.lineHeight=a}});return(a,d)=>(R(),I("div",Lv,[f("section",{class:m(a.classes.font)},[f("div",{class:m(a.classes.zhFont)},[f("div",{class:m(a.classes.title)},"中文字体",2),f("div",Iv,[p(b(ee),{options:l.value,modelValue:s.value,"onUpdate:modelValue":d[0]||(d[0]=g=>s.value=g)},null,8,["options","modelValue"])])],2),f("div",{class:m(a.classes.enFont)},[f("div",{class:m(a.classes.title)},"西文字体",2),f("div",Nv,[p(b(ee),{options:o.value,modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=g=>r.value=g)},null,8,["options","modelValue"])])],2),f("div",{class:m(a.classes.lineHeight)},[f("div",{class:m(a.classes.title)},"行高",2),p(Fe,{modelValue:c.value,"onUpdate:modelValue":d[2]||(d[2]=g=>c.value=g),options:t},null,8,["modelValue"])],2),f("div",{class:m(a.classes.fontSize)},[f("div",{class:m(a.classes.title)},"字号",2),p(To,{modelValue:i.value,"onUpdate:modelValue":d[3]||(d[3]=g=>i.value=g),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),xv="_font_145qf_2",Dv="_zhFont_145qf_9",Av="_enFont_145qf_16",Mv="_lineHeight_145qf_23",Bv="_fontSize_145qf_30",qv="_title_145qf_45",$v={font:xv,zhFont:Dv,enFont:Av,lineHeight:Mv,fontSize:Bv,title:qv},Pv={classes:$v},Vv=z(Ov,[["__cssModules",Pv]]),Fv=V({__name:"index",props:{doc:{type:ye,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=ot(),l=Oe(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,c)=>(R(),I("div",{class:m(i.classes.setting)},[n.active=="paper"?(R(),J(Cv,{key:0,config:l},null,8,["config"])):G("",!0),n.active=="font"?(R(),J(Vv,{key:1,config:l},null,8,["config"])):G("",!0),f("div",{class:m(i.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),zv="_setting_h98ws_2",Uv="_footer_h98ws_10",Hv={setting:zv,footer:Uv},Gv={classes:Hv},Wv=z(Fv,[["__cssModules",Gv]]),Yv=xe(function(n){return mt("文档",(e,t)=>p(Wv,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(De)}),Xv=V({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Se(),t=ke("classes"),l=sv(e),o=iv(e),s=Qh(e),r=tv(e),i=ev(e),c=rv(e),a=av(e),d=nv(e),g=Kh(e),v=Jh(e),E=lv(e),y=ov(e),u=k(()=>qn.map(S=>(S.style={fontFamily:S.value==se.DEFAULT?se.SONG:S.value},S)));function h(S){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>S.handler(e)},[S.icon&&p(F,{icon:S.icon},null),p("span",null,[S.label])])}function T(S){S.preventDefault()}function N(){a.value=!a.value}function C(){d.value=!d.value}function O(){g.value=!g.value}function w(){v.value=!v.value}function M(){const S=e.getSelectedElements();if(S.length==0)return;const A=Math.min(...S.map(q=>q.left));for(const q of S)q.setLeft(A,!0);e.createSnapshot()}function x(){const S=e.getSelectedElements();if(S.length==0)return;const A=S[0].page;if(A==null)return;const q=Ut(A.width);for(const B of S)B.setLeft((q-B.width)/2);e.createSnapshot()}function $(){const S=e.getSelectedElements();if(S.length==0)return;const A=Math.max(...S.map(q=>q.left+q.width));for(const q of S)q.setLeft(A-q.width,!0);e.createSnapshot()}async function L(){const S=await ac(e.doc);S!=null&&(e.doc.ds=e.doc.createDS(S))}function D(){Yv(e.doc)}function _(S){var A,q;if(typeof S=="function")return S(e,t);if(typeof S=="object")return h(S);if(typeof S!="string")return null;switch(S){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const B=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:B,onClick:e.history.undo},[p(F,{icon:"icon-undo"},null)])}case"redo":{const B=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:B,onClick:e.history.redo},[p(F,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(F,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(ee,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":B=>l.value=B,options:u.value,class:t.tool,button:!0},null);case"fontSize":return p(ee,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":B=>o.value=B,options:hl,class:t.tool,button:!0},null);case"lineHeight":return p(ee,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":B=>s.value=B,options:Eo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p($t,{modelValue:r.value,"onUpdate:modelValue":B=>r.value=B,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(F,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return p($t,{modelValue:i.value,"onUpdate:modelValue":B=>i.value=B,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(F,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return p($t,{modelValue:c.value,"onUpdate:modelValue":B=>c.value=B,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(F,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:c.value}},null)])]});case"fontWeight":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":a.value};return p("button",{type:"button",title:"加粗",class:B,onClick:N},[p(F,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":d.value};return p("button",{type:"button",title:"斜体",class:B,onClick:C},[p(F,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":g.value};return p("button",{type:"button",title:"下划线",class:B,onClick:O},[p(F,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":v.value};return p("button",{type:"button",title:"删除线",class:B,onClick:w},[p(F,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(vv,null,null);case"textAlign":{const B=((A=tl.find(Z=>Z.value===E.value))==null?void 0:A.label)??"水平对齐",oe={selected({option:Z}){return p(F,{icon:Z==null?void 0:Z.icon,class:"quickprint-is-self-center"},null)}};return p(ee,{modelValue:E.value,"onUpdate:modelValue":Z=>E.value=Z,options:tl,title:B,class:t.tool,width:"36px",size:"mini",button:!0},oe)}case"verticalAlign":{const B=((q=el.find(Z=>Z.value===y.value))==null?void 0:q.label)??"垂直对齐",oe={selected({option:Z}){return p(F,{icon:Z==null?void 0:Z.icon,class:"quickprint-is-self-center"},null)}};return p(ee,{modelValue:y.value,"onUpdate:modelValue":Z=>y.value=Z,options:el,title:B,class:t.tool,width:"36px",size:"mini",button:!0},oe)}case"alignLeft":{const B={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:B,onClick:M},[p(F,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const B={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:B,onClick:x},[p(F,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const B={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:B,onClick:$},[p(F,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const B={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:B,onClick:e.toggleBackground},[p(F,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const B={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:B,onClick:e.toggleElementPanel},[p(F,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const B={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:B,onClick:e.toggleConfigPanel},[p(F,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:L},[p(F,{icon:"icon-datasource"},null),p("span",null,[le("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:D},[p(F,{icon:"icon-file-text"},null),p("span",null,[le("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:T},[n.toolbar.map(_)])}}}),jv="_toolbar_1bhq2_2",Zv="_divider_1bhq2_8",Kv="_tool_1bhq2_2",Jv="_colorIcon_1bhq2_18",Qv="_colorIndicator_1bhq2_38",eb={toolbar:jv,divider:Zv,tool:Kv,colorIcon:Jv,colorIndicator:Qv},tb={classes:eb},nb=z(Xv,[["__cssModules",tb]]);function lb(n){let e=null;const t=fe(),l=Oe({width:0,height:0,scrollTop:0,scrollLeft:0}),o=fe(),s=Oe({id:"",top:0,left:0,width:0,height:0});async function r(){await Ht();const E=t.value;E!=null&&(l.width=E.offsetWidth,l.height=E.offsetHeight)}function i(E){const y=E.target;l.scrollLeft=y.scrollLeft,l.scrollTop=y.scrollTop}function c(E){const u=E.target.closest("."+X.PAPER);u!=null&&(o.value=u,d(u),a())}async function a(){await Ht();const E=o.value;E!=null&&(s.id=E.id.slice(1),s.width=E.offsetWidth,s.height=E.offsetHeight,s.top=E.offsetTop,s.left=E.offsetLeft)}function d(E){E!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(E))}function g(){const E=n.doc.firstPage;if(E==null)return;const y=document.querySelector("#\\@"+E.id);o.value=y,e&&y&&e.observe(y),a()}function v(E){E.some(y=>y.target.matches("."+X.CANVAS))&&(r(),a()),E.some(y=>y.target.matches("."+X.PAPER))&&(r(),a())}return cl(()=>n.state.scale,()=>a()),rn(()=>{e=new ResizeObserver(v),e.observe(t.value),g(),r()}),Ss(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:c}}const Po=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),ob=V({__name:"index",props:It({modelValue:{type:ye,required:!0},toolbar:{type:Array,default(){return Po}}},{modelValue:{required:!0},modelModifiers:{}}),emits:It(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=fe(),o=fe(),s=qs(),r=sn(n,"modelValue"),i=Jp(r,{queryElement:T,dispatchEvent:N}),{canvasRef:c,canvasRect:a,pageRect:d,onScroll:g,onSelectPage:v}=lb(i),E=k(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),y=k(()=>{const O=i.doc.style;return{fontFamily:rl(O==null?void 0:O.fontFamily,O==null?void 0:O.enFontFamily),fontSize:O==null?void 0:O.fontSize,lineHeight:O==null?void 0:O.lineHeight}});function u(){i.state.panel.left=!1}function h(){i.state.panel.right=!1}function T(O){switch(O){case"ghost":return o.value;case"root":return l.value;default:return}}function N(O,...w){t(O,...w)}function C(O){O.deltaY>0?i.zoomIn():i.zoomOut()}return(O,w)=>(R(),I("div",{class:m(O.classes.designer),ref_key:"rootRef",ref:l,style:K(E.value)},[f("div",{class:m(O.classes.header)},[nt(O.$slots,"headerLeft"),p(nb,{class:m(O.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),nt(O.$slots,"headerRight")],2),f("div",{class:m(O.classes.main)},[b(i).state.panel.left?(R(),I("div",{key:0,class:m(O.classes.left)},[f("button",{type:"button",onClick:u,class:m(["quickprint-text-btn",O.classes.closePanelBtn])},[p(b(F),{icon:"icon-close",size:"12px"})],2),p(og)],2)):G("",!0),f("div",{class:m([O.classes.center,b(X).CANVAS]),onWheel:ne(C,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:c},[p(Bl,{canvas:b(a),page:b(d),scale:b(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Bl,{canvas:b(a),page:b(d),scale:b(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),f("div",{class:m([b(X).SCROLLABLE,O.classes.canvas]),style:K(y.value),onScroll:w[0]||(w[0]=(...M)=>b(g)&&b(g)(...M)),onClickCapture:w[1]||(w[1]=(...M)=>b(v)&&b(v)(...M))},[(R(!0),I(Q,null,re(r.value.pages,M=>(R(),J(Ym,{key:M.id,doc:r.value,page:M},null,8,["doc","page"]))),128))],38),f("div",{class:m(O.classes.footer)},[p(pg),p(b(fs),{scale:b(i).state.scale,onZoomIn:b(i).zoomIn,onZoomOut:b(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),b(i).state.panel.right?(R(),I("div",{key:1,class:m(O.classes.right)},[f("button",{type:"button",onClick:h,class:m(["quickprint-text-btn",O.classes.closePanelBtn])},[p(b(F),{icon:"icon-close",size:"12px"})],2),p(Zh)],2)):G("",!0)],2),f("div",{ref_key:"ghostRef",ref:o,class:m(O.classes.ghost)},null,2),p(b(ps))],6))}}),sb="_designer_grxxm_2",ib="_header_grxxm_17",rb="_toolbar_grxxm_25",ab="_footer_grxxm_31",cb="_main_grxxm_47",ub="_left_grxxm_55",db="_center_grxxm_63",fb="_right_grxxm_75",pb="_canvas_grxxm_83",mb="_closePanelBtn_grxxm_96",gb="_ghost_grxxm_103",hb={designer:sb,header:ib,toolbar:rb,footer:ab,main:cb,left:ub,center:db,right:fb,canvas:pb,closePanelBtn:mb,ghost:gb},vb={classes:hb},bb=z(ob,[["__cssModules",vb]]),yb={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:gn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(De)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:gn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:gn.DISABLED}};function _b(n,e={}){const t=ms(e.zIndexManager);n.use(gs,{zIndex:t,presets:yb}),hs(n._context)}const Eb="0.0.0",Tb={version:Eb,install:_b},Sb=["onClick"],Rb=V({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=ot();function l(o){t==null||t.confirm(o)}return(o,s)=>(R(),I("div",{class:m(o.classes.panel)},[(R(!0),I(Q,null,re(b(vs),(r,i)=>(R(),I("div",{key:r.id,class:m(o.classes.item),onClick:c=>l(r)},[f("div",null,[f("span",null,Y(i+1)+". ",1),f("span",null,Y(r.name),1)])],10,Sb))),128))],2))}}),wb="_panel_1he7q_2",kb="_item_1he7q_9",Cb={panel:wb,item:kb},Lb={classes:Cb},Ib=z(Rb,[["__cssModules",Lb]]),Nb='<div class="quickprint-md"><h2>设计</h2><ul><li><s>feat: 表格行设置</s></li><li>feat: 单元格设置<ul><li><s>单元格设置支持多选</s></li><li>单元格支持斜线分割，并设置文字</li><li>单元格内容宽度需计算边框宽度</li></ul></li><li>feat: 文字方向<ul><li>参照wps文字方向</li><li>垂直文字合并 text-combine-upright</li></ul></li><li>fix: 分割列时需要出来合并列</li><li>fix: 单元格合并时，需要检测是否为相同数据源</li><li>fix: 边框设置样式</li></ul><h2>预览</h2><ul><li>feat: 表格支持斜线表头</li><li>fix: 存在单元格合并时渲染有误</li></ul></div>',Ob=["innerHTML"],xb=V({__name:"Todo",setup(n){return(e,t)=>(R(),I("div",{innerHTML:b(Nb),class:m(e.classes.doc)},null,10,Ob))}}),Db="_doc_eo2ef_2",Ab={doc:Db},Mb={classes:Ab},Bb=z(xb,[["__cssModules",Mb]]),qb="local",$l="quickprint-local-define",$b=V({__name:"index",setup(n){const e=ke("classes"),t=E(),l="20251006",o=[{label:"新建",icon:"icon-file-text",handler:d},{label:"加载示例",icon:"icon-import",handler:c},"---",...Po];function s(){const u=JSON.stringify(t.value);localStorage.setItem($l,u)}function r(){s()}function i(){const u=t.value.id,h=u.startsWith("case_")?u:qb,T=`${window.location.origin}/preview.html?id=${h}`;s(),ut("文档预览",dt("iframe",{src:T,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(N){window.open(T,"_blank"),N.close()}}]})}function c(){const u={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:gn.DISABLED};ut("选择示例",dt(Ib),u).promisify().then(h=>a(h.id)).catch(De)}async function a(u){const h=await Tl(u,!1);h!=null&&(bs(u),t.value=ye.create(h.define),g())}function d(){const u=ye.createNormalDocument();t.value=u,g()}function g(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function v(){const u=localStorage.getItem($l);if(u!=null)return ye.create(u);const h=ys(),T=await Tl(h.id,!1);return T==null?ye.createNormalDocument():ye.create(T.define)}function E(){const u=ue();return v().then(h=>{u.value=h,g()}),u}const y=xe(function(){return ut("待办事项",dt(Bb),{minHeight:360}).promisify().catch(Ke)});return(u,h)=>b(t)?(R(),J(b(bb),{modelValue:b(t),"onUpdate:modelValue":h[1]||(h[1]=T=>Qe(t)?t.value=T:null),toolbar:o,class:m(b(e).main),key:b(t).id,onSave:r,onPreview:i},{headerLeft:we(()=>[f("div",{class:m(b(e).logo)},[h[2]||(h[2]=f("h1",null,"OpenPrint",-1)),f("div",{class:m(b(e).dev),onClick:h[0]||(h[0]=(...T)=>b(y)&&b(y)(...T))},"DEV_"+Y(b(l)),3)],2)]),headerRight:we(()=>[f("div",{class:m(b(e).operate)},[f("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[p(b(F),{icon:"icon-run"}),h[3]||(h[3]=f("span",null,"预览",-1))]),f("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[p(b(F),{icon:"icon-save"}),h[4]||(h[4]=f("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):G("",!0)}}),Pb="_main_14ojw_2",Vb="_iframe_14ojw_6",Fb="_divider_14ojw_14",zb="_logo_14ojw_20",Ub="_dev_14ojw_39",Hb="_operate_14ojw_52",Gb={main:Pb,iframe:Vb,divider:Fb,logo:zb,dev:Ub,operate:Hb},Wb={classes:Gb},Yb=z($b,[["__cssModules",Wb]]),Vo=Rs(Yb);Vo.use(Tb);Vo.mount("#app");
