const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-CpComRFX.js","assets/utils-Bc8fbH9Q.js","assets/vue-B00pXJJQ.js","assets/utils-BWxIAY5I.css"])))=>i.map(i=>d[i]);
var Tr=Object.defineProperty;var Tn=t=>{throw TypeError(t)};var Sr=(t,e,n)=>e in t?Tr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var A=(t,e,n)=>Sr(t,typeof e!="symbol"?e+"":e,n),Yt=(t,e,n)=>e.has(t)||Tn("Cannot "+n);var F=(t,e,n)=>(Yt(t,e,"read from private field"),n?n.call(t):e.get(t)),le=(t,e,n)=>e.has(t)?Tn("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),ze=(t,e,n,r)=>(Yt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Vt=(t,e,n)=>(Yt(t,e,"access private method"),n);var Sn=(t,e,n,r)=>({set _(i){ze(t,e,i,n)},get _(){return F(t,e,r)}});import{M as Ar,aq as ln,ar as cn,aN as Ue,o as tn,av as Rr,aw as Or,b as se,aO as B,H as ve,A as fn,F as Ve,i as Et,P as kr,m as tt,D as yt,G as Mr,V as Gt,aP as Ze,a as st,N as zt,O as Dt,n as Pr,E as An,q as hn,v as nn,a5 as xr,r as Jn,t as Ir,u as We,w as Lr,x as Cr,y as qr,z as $r,a3 as ot,c as ae,B as Fr,Q as rn,L as Hr,aQ as Rn,U as Ur,_ as qt,I as sn,aD as Br,R as Yr,aR as Qn,h as pe,T as Vr,W as Gr,$ as zr,K as jr,aF as Wr,X as Zr,aS as On,aT as kn,aK as Xr,aJ as Mn,aG as Kr,aH as Jr,aI as Qr}from"./utils-Bc8fbH9Q.js";import{d as mt,h as Ae,c as Xe,a as Be,b as ue,n as ie,v as At,e as Z,H as Rt,u as er,s as Ot,g as tr,B as ei,i as Q,f as Pn,F as ti,w as ni,y as ri,E as xn,G as ii,S as si,N as oi,r as jt,j as ai,R as ui}from"./vue-B00pXJJQ.js";const ge=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),bt=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),on=Object.freeze({CREATED:0,MOUNDTED:1}),ce={UNDEFINED:0,PENDING:1,DONE:2},Te={PENDING:-1,HIDDEN:0,VISIBLE:1},at=[25,50,75,100,125,150,200,300,400],Se=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDDE_LINE:"quickprint-guide-line"}),In="http://www.w3.org/2000/svg",li=["class","className","style"];function ci(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97)}function fi(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123}function an(t){return t==null?"":typeof t=="string"?t.trim():Array.isArray(t)?t.map(an).join(" "):typeof t=="object"?Object.keys(t).filter(e=>t[e]).join(" "):""}function hi(t){return li.includes(t)}function nr(t,e){if(e!=null){if(e instanceof Element){t.appendChild(e);return}if(Array.isArray(e)){for(const n of e)nr(t,n);return}t.textContent+=e}}function di(t,e){if(!(e==null||typeof e!="object"))for(const n of Object.keys(e)){const r=e[n];if(r==null)continue;const i=Ar(n);t.style.setProperty(i,r)}}function pi(t,e){if(an(e)=="")return;const r=t.className==""?"":" ";t.className+=r+an(e)}function rr(t,e,n){switch(e){case"class":case"className":pi(t,n);break;case"style":di(t,n);break;case"children":n!=null&&nr(t,n);break;case"innerHTML":break;default:if(e[0]==="@")return mi(t,e,n);e in t&&(t[e]=n),n==null?t.removeAttribute(e):t.setAttribute(e,n)}}function mi(t,e,n){Reflect.set(t,e.slice(1),n)}function gi(t,e,n){const r=t(e);if(r==null)return null;for(const i of Object.keys(e??{}))(ci(i)||fi(i)||hi(i))&&rr(r,i,e[i]);return r}function wi(t,e,n){const r=document.createElement(t);if(r==null)return null;for(const i of Object.keys(e??{}))rr(r,i,e[i]);return r}function z(t,e,n){return typeof t=="function"?gi(t,e):wi(t,e)}function Ln(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var xt,Ie;const It=class It{constructor(e,n,r){le(this,xt,ln(cn.PRINT_PAGE));le(this,Ie,Object.create(null));A(this,"file");A(this,"define");A(this,"pageNum",-1);A(this,"pageTotal",-1);A(this,"extra",!1);A(this,"paper");A(this,"header");A(this,"footer");A(this,"children",[]);A(this,"fixed",[]);A(this,"parent");A(this,"element");A(this,"rendering");A(this,"state",bt.CREATED);this.file=r,this.define=e,this.paper=this.createPaper(e,n),this.header=this.createHeader(),this.footer=this.createFooter(),Ue(this,"parent",null),Ue(this,"element",null),Ue(this,"rendering",0)}static create(e,n,r="0000"){return new It(e,n,r)}get id(){return"@"+F(this,xt)}get index(){return this.parent==null?-1:this.parent.pages.findIndex(e=>e.id===this.id)}get defines(){const e=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>e.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>e.add(i.id)),this.define.children.filter(i=>!e.has(i.id)).sort(tn.sort)}get style(){const{offsetWidth:e,offsetHeight:n}=this.paper;return{width:e+"px",height:n+"px"}}get isLast(){return this.pageNum===this.pageTotal}nextTick(){return this.parent?this.parent.nextTick():Promise.resolve()}createPageHeader(){const e=this.header;if(e.display!==!0)return null;const n={top:e.offsetTop+"px"},r=[Se.GUIDDE_LINE,Se.PRINT_HIDDEN];return[...e.children.map(i=>i.createElement()),z("div",{class:r,style:n})]}createPageFooter(){const e=this.footer;if(e.display!==!0)return null;const n={top:e.offsetTop+"px"},r=[Se.GUIDDE_LINE,Se.PRINT_HIDDEN];return[...e.children.map(i=>i.createElement()),z("div",{class:r,style:n})]}render(){return z("div",{id:this.id,class:Se.PAGE,"data-index":this.index+1,children:z("div",{class:Se.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(e){this.state=bt.PAGED,await this.onPaged()}async mountChild(e){if(this.element==null||e.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(e.element),await this.nextTick(),await e.mount(e.element),!0)}async replaceChild(e,n){if(this.element==null||e.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null?r.removeChild(e.element):r.replaceChild(n,e.element),await this.nextTick(),await e.mount(n),!0)}beginPaging(){this.state=bt.PAGING}onCreated(){const e=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(e.map(n=>n.onCreated()))}onPaged(){const e=this.children.map(n=>typeof n.onPaged=="function"?n.onPaged():Promise.resolve());return Promise.allSettled(e)}onFinshed(){const e=this.children.map(r=>typeof r.onFinished=="function"?r.onFinished():Promise.resolve()),n=this.adjustFooter();return n&&e.push(n),Promise.allSettled(e)}setParent(e){this.parent=e}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}append(e){e.setParent(this),this.children.push(e),F(this,Ie)[e.id]=e}appendToHeader(e){e.setParent(this),this.header.children.push(e),F(this,Ie)[e.id]=e}appendToFooter(e){e.setParent(this),this.footer.children.push(e),F(this,Ie)[e.id]=e}appendToFixed(e){e.setParent(this),this.fixed.push(e),F(this,Ie)[e.id]=e}createPaper(e,n){return{size:n.size,width:n.width,height:n.height,orientation:e.orientation,offsetWidth:Math.round(n.width),offsetHeight:Math.round(n.height)}}createHeader(){const e=this.define.header;if(e.display!==!0)return Ln();const n=e.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const e=this.define.footer;if(e.display!==!0)return Ln();const n=e.height??0,i=Math.floor(Rr(this.paper.height))-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const e=new It(this.define,this.paper,this.file);e.rendering=0;for(const n of this.header.children){const r=n.clone();e.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();e.appendToFooter(r)}return e}findElement(e){const n=F(this,Ie)[e];if(n)return n;for(const r of this.children){const i=r.findElement(e);if(i)return i}}filterElement(e){const n=typeof e=="string"?e:e.id;return this.children.filter(r=>r.define.id===n)}adjustFooter(){if(!this.isLast||this.define.footer.flow!==Or.TABLE)return;let e=0,n=null;for(const i of this.children)if(i.offsetBottom>e&&(e=i.offsetBottom),i.type===se.TABLE){if(n==null){n=i;continue}i.offsetBottom>n.offsetBottom&&(n=i)}if(n==null||Math.abs(e-n.offsetBottom)>=4)return;const r=Math.floor(this.footer.offsetTop-n.offsetBottom);return Promise.allSettled(this.footer.children.map(i=>(i.offsetTop-=r,i.updateElement())))}};xt=new WeakMap,Ie=new WeakMap;let kt=It;var nt=1e9,vi={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},pn,V=!0,me="[DecimalError] ",Ye=me+"Invalid argument: ",dn=me+"Exponent out of range: ",rt=Math.floor,qe=Math.pow,Ei=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe,ne=1e7,Y=7,ir=9007199254740991,Mt=rt(ir/Y),y={};y.absoluteValue=y.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};y.comparedTo=y.cmp=function(t){var e,n,r,i,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(r=s.d.length,i=t.d.length,e=0,n=r<i?r:i;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};y.decimalPlaces=y.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Y;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};y.dividedBy=y.div=function(t){return Oe(this,new this.constructor(t))};y.dividedToIntegerBy=y.idiv=function(t){var e=this,n=e.constructor;return H(Oe(e,new n(t),0,1),n.precision)};y.equals=y.eq=function(t){return!this.cmp(t)};y.exponent=function(){return K(this)};y.greaterThan=y.gt=function(t){return this.cmp(t)>0};y.greaterThanOrEqualTo=y.gte=function(t){return this.cmp(t)>=0};y.isInteger=y.isint=function(){return this.e>this.d.length-2};y.isNegative=y.isneg=function(){return this.s<0};y.isPositive=y.ispos=function(){return this.s>0};y.isZero=function(){return this.s===0};y.lessThan=y.lt=function(t){return this.cmp(t)<0};y.lessThanOrEqualTo=y.lte=function(t){return this.cmp(t)<1};y.logarithm=y.log=function(t){var e,n=this,r=n.constructor,i=r.precision,s=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(fe))throw Error(me+"NaN");if(n.s<1)throw Error(me+(n.s?"NaN":"-Infinity"));return n.eq(fe)?new r(0):(V=!1,e=Oe(ht(n,s),ht(t,s),s),V=!0,H(e,i))};y.minus=y.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?ar(e,t):sr(e,(t.s=-t.s,t))};y.modulo=y.mod=function(t){var e,n=this,r=n.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(me+"NaN");return n.s?(V=!1,e=Oe(n,t,0,1).times(t),V=!0,n.minus(e)):H(new r(n),i)};y.naturalExponential=y.exp=function(){return or(this)};y.naturalLogarithm=y.ln=function(){return ht(this)};y.negated=y.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};y.plus=y.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?sr(e,t):ar(e,(t.s=-t.s,t))};y.precision=y.sd=function(t){var e,n,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Ye+t);if(e=K(i)+1,r=i.d.length-1,n=r*Y+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};y.squareRoot=y.sqrt=function(){var t,e,n,r,i,s,o,a=this,u=a.constructor;if(a.s<1){if(!a.s)return new u(0);throw Error(me+"NaN")}for(t=K(a),V=!1,i=Math.sqrt(+a),i==0||i==1/0?(e=ye(a.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=rt((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new u(e)):r=new u(i.toString()),n=u.precision,i=o=n+3;;)if(s=r,r=s.plus(Oe(a,s,o+2)).times(.5),ye(s.d).slice(0,o)===(e=ye(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(H(s,n+1,0),s.times(s).eq(a)){r=s;break}}else if(e!="9999")break;o+=4}return V=!0,H(r,n)};y.times=y.mul=function(t){var e,n,r,i,s,o,a,u,l,c=this,f=c.constructor,E=c.d,d=(t=new f(t)).d;if(!c.s||!t.s)return new f(0);for(t.s*=c.s,n=c.e+t.e,u=E.length,l=d.length,u<l&&(s=E,E=d,d=s,o=u,u=l,l=o),s=[],o=u+l,r=o;r--;)s.push(0);for(r=l;--r>=0;){for(e=0,i=u+r;i>r;)a=s[i]+d[r]*E[i-r-1]+e,s[i--]=a%ne|0,e=a/ne|0;s[i]=(s[i]+e)%ne|0}for(;!s[--o];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,V?H(t,f.precision):t};y.toDecimalPlaces=y.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(_e(t,0,nt),e===void 0?e=r.rounding:_e(e,0,8),H(n,t+K(n)+1,e))};y.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Ge(r,!0):(_e(t,0,nt),e===void 0?e=i.rounding:_e(e,0,8),r=H(new i(r),t+1,e),n=Ge(r,!0,t+1)),n};y.toFixed=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?Ge(i):(_e(t,0,nt),e===void 0?e=s.rounding:_e(e,0,8),r=H(new s(i),t+K(i)+1,e),n=Ge(r.abs(),!1,t+K(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};y.toInteger=y.toint=function(){var t=this,e=t.constructor;return H(new e(t),K(t)+1,e.rounding)};y.toNumber=function(){return+this};y.toPower=y.pow=function(t){var e,n,r,i,s,o,a=this,u=a.constructor,l=12,c=+(t=new u(t));if(!t.s)return new u(fe);if(a=new u(a),!a.s){if(t.s<1)throw Error(me+"Infinity");return a}if(a.eq(fe))return a;if(r=u.precision,t.eq(fe))return H(a,r);if(e=t.e,n=t.d.length-1,o=e>=n,s=a.s,o){if((n=c<0?-c:c)<=ir){for(i=new u(fe),e=Math.ceil(r/Y+4),V=!1;n%2&&(i=i.times(a),qn(i.d,e)),n=rt(n/2),n!==0;)a=a.times(a),qn(a.d,e);return V=!0,t.s<0?new u(fe).div(i):H(i,r)}}else if(s<0)throw Error(me+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,a.s=1,V=!1,i=t.times(ht(a,r+l)),V=!0,i=or(i),i.s=s,i};y.toPrecision=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?(n=K(i),r=Ge(i,n<=s.toExpNeg||n>=s.toExpPos)):(_e(t,1,nt),e===void 0?e=s.rounding:_e(e,0,8),i=H(new s(i),t,e),n=K(i),r=Ge(i,t<=n||n<=s.toExpNeg,t)),r};y.toSignificantDigits=y.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(_e(t,1,nt),e===void 0?e=r.rounding:_e(e,0,8)),H(new r(n),t,e)};y.toString=y.valueOf=y.val=y.toJSON=y[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=K(t),n=t.constructor;return Ge(t,e<=n.toExpNeg||e>=n.toExpPos)};function sr(t,e){var n,r,i,s,o,a,u,l,c=t.constructor,f=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),V?H(e,f):e;if(u=t.d,l=e.d,o=t.e,i=e.e,u=u.slice(),s=o-i,s){for(s<0?(r=u,s=-s,a=l.length):(r=l,i=o,a=u.length),o=Math.ceil(f/Y),a=o>a?o+1:a+1,s>a&&(s=a,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(a=u.length,s=l.length,a-s<0&&(s=a,r=l,l=u,u=r),n=0;s;)n=(u[--s]=u[s]+l[s]+n)/ne|0,u[s]%=ne;for(n&&(u.unshift(n),++i),a=u.length;u[--a]==0;)u.pop();return e.d=u,e.e=i,V?H(e,f):e}function _e(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Ye+t)}function ye(t){var e,n,r,i=t.length-1,s="",o=t[0];if(i>0){for(s+=o,e=1;e<i;e++)r=t[e]+"",n=Y-r.length,n&&(s+=xe(n)),s+=r;o=t[e],r=o+"",n=Y-r.length,n&&(s+=xe(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Oe=function(){function t(r,i){var s,o=0,a=r.length;for(r=r.slice();a--;)s=r[a]*i+o,r[a]=s%ne|0,o=s/ne|0;return o&&r.unshift(o),r}function e(r,i,s,o){var a,u;if(s!=o)u=s>o?1:-1;else for(a=u=0;a<s;a++)if(r[a]!=i[a]){u=r[a]>i[a]?1:-1;break}return u}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*ne+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var a,u,l,c,f,E,d,O,m,h,g,N,D,C,I,x,$,P,W=r.constructor,q=r.s==i.s?1:-1,T=r.d,k=i.d;if(!r.s)return new W(r);if(!i.s)throw Error(me+"Division by zero");for(u=r.e-i.e,$=k.length,I=T.length,d=new W(q),O=d.d=[],l=0;k[l]==(T[l]||0);)++l;if(k[l]>(T[l]||0)&&--u,s==null?N=s=W.precision:o?N=s+(K(r)-K(i))+1:N=s,N<0)return new W(0);if(N=N/Y+2|0,l=0,$==1)for(c=0,k=k[0],N++;(l<I||c)&&N--;l++)D=c*ne+(T[l]||0),O[l]=D/k|0,c=D%k|0;else{for(c=ne/(k[0]+1)|0,c>1&&(k=t(k,c),T=t(T,c),$=k.length,I=T.length),C=$,m=T.slice(0,$),h=m.length;h<$;)m[h++]=0;P=k.slice(),P.unshift(0),x=k[0],k[1]>=ne/2&&++x;do c=0,a=e(k,m,$,h),a<0?(g=m[0],$!=h&&(g=g*ne+(m[1]||0)),c=g/x|0,c>1?(c>=ne&&(c=ne-1),f=t(k,c),E=f.length,h=m.length,a=e(f,m,E,h),a==1&&(c--,n(f,$<E?P:k,E))):(c==0&&(a=c=1),f=k.slice()),E=f.length,E<h&&f.unshift(0),n(m,f,h),a==-1&&(h=m.length,a=e(k,m,$,h),a<1&&(c++,n(m,$<h?P:k,h))),h=m.length):a===0&&(c++,m=[0]),O[l++]=c,a&&m[0]?m[h++]=T[C]||0:(m=[T[C]],h=1);while((C++<I||m[0]!==void 0)&&N--)}return O[0]||O.shift(),d.e=u,H(d,o?s+K(d)+1:s)}}();function or(t,e){var n,r,i,s,o,a,u=0,l=0,c=t.constructor,f=c.precision;if(K(t)>16)throw Error(dn+K(t));if(!t.s)return new c(fe);for(V=!1,a=f,o=new c(.03125);t.abs().gte(.1);)t=t.times(o),l+=5;for(r=Math.log(qe(2,l))/Math.LN10*2+5|0,a+=r,n=i=s=new c(fe),c.precision=a;;){if(i=H(i.times(t),a),n=n.times(++u),o=s.plus(Oe(i,n,a)),ye(o.d).slice(0,a)===ye(s.d).slice(0,a)){for(;l--;)s=H(s.times(s),a);return c.precision=f,e==null?(V=!0,H(s,f)):s}s=o}}function K(t){for(var e=t.e*Y,n=t.d[0];n>=10;n/=10)e++;return e}function Wt(t,e,n){if(e>t.LN10.sd())throw V=!0,n&&(t.precision=n),Error(me+"LN10 precision limit exceeded");return H(new t(t.LN10),e)}function xe(t){for(var e="";t--;)e+="0";return e}function ht(t,e){var n,r,i,s,o,a,u,l,c,f=1,E=10,d=t,O=d.d,m=d.constructor,h=m.precision;if(d.s<1)throw Error(me+(d.s?"NaN":"-Infinity"));if(d.eq(fe))return new m(0);if(e==null?(V=!1,l=h):l=e,d.eq(10))return e==null&&(V=!0),Wt(m,l);if(l+=E,m.precision=l,n=ye(O),r=n.charAt(0),s=K(d),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)d=d.times(t),n=ye(d.d),r=n.charAt(0),f++;s=K(d),r>1?(d=new m("0."+n),s++):d=new m(r+"."+n.slice(1))}else return u=Wt(m,l+2,h).times(s+""),d=ht(new m(r+"."+n.slice(1)),l-E).plus(u),m.precision=h,e==null?(V=!0,H(d,h)):d;for(a=o=d=Oe(d.minus(fe),d.plus(fe),l),c=H(d.times(d),l),i=3;;){if(o=H(o.times(c),l),u=a.plus(Oe(o,new m(i),l)),ye(u.d).slice(0,l)===ye(a.d).slice(0,l))return a=a.times(2),s!==0&&(a=a.plus(Wt(m,l+2,h).times(s+""))),a=Oe(a,new m(f),l),m.precision=h,e==null?(V=!0,H(a,h)):a;a=u,i+=2}}function Cn(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(r,i),e){if(i-=r,n=n-r-1,t.e=rt(n/Y),t.d=[],r=(n+1)%Y,n<0&&(r+=Y),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Y;r<i;)t.d.push(+e.slice(r,r+=Y));e=e.slice(r),r=Y-e.length}else r-=i;for(;r--;)e+="0";if(t.d.push(+e),V&&(t.e>Mt||t.e<-Mt))throw Error(dn+n)}else t.s=0,t.e=0,t.d=[0];return t}function H(t,e,n){var r,i,s,o,a,u,l,c,f=t.d;for(o=1,s=f[0];s>=10;s/=10)o++;if(r=e-o,r<0)r+=Y,i=e,l=f[c=0];else{if(c=Math.ceil((r+1)/Y),s=f.length,c>=s)return t;for(l=s=f[c],o=1;s>=10;s/=10)o++;r%=Y,i=r-Y+o}if(n!==void 0&&(s=qe(10,o-i-1),a=l/s%10|0,u=e<0||f[c+1]!==void 0||l%s,u=n<4?(a||u)&&(n==0||n==(t.s<0?3:2)):a>5||a==5&&(n==4||u||n==6&&(r>0?i>0?l/qe(10,o-i):0:f[c-1])%10&1||n==(t.s<0?8:7))),e<1||!f[0])return u?(s=K(t),f.length=1,e=e-s-1,f[0]=qe(10,(Y-e%Y)%Y),t.e=rt(-e/Y)||0):(f.length=1,f[0]=t.e=t.s=0),t;if(r==0?(f.length=c,s=1,c--):(f.length=c+1,s=qe(10,Y-r),f[c]=i>0?(l/qe(10,o-i)%qe(10,i)|0)*s:0),u)for(;;)if(c==0){(f[0]+=s)==ne&&(f[0]=1,++t.e);break}else{if(f[c]+=s,f[c]!=ne)break;f[c--]=0,s=1}for(r=f.length;f[--r]===0;)f.pop();if(V&&(t.e>Mt||t.e<-Mt))throw Error(dn+K(t));return t}function ar(t,e){var n,r,i,s,o,a,u,l,c,f,E=t.constructor,d=E.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new E(t),V?H(e,d):e;if(u=t.d,f=e.d,r=e.e,l=t.e,u=u.slice(),o=l-r,o){for(c=o<0,c?(n=u,o=-o,a=f.length):(n=f,r=l,a=u.length),i=Math.max(Math.ceil(d/Y),a)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=u.length,a=f.length,c=i<a,c&&(a=i),i=0;i<a;i++)if(u[i]!=f[i]){c=u[i]<f[i];break}o=0}for(c&&(n=u,u=f,f=n,e.s=-e.s),a=u.length,i=f.length-a;i>0;--i)u[a++]=0;for(i=f.length;i>o;){if(u[--i]<f[i]){for(s=i;s&&u[--s]===0;)u[s]=ne-1;--u[s],u[i]+=ne}u[i]-=f[i]}for(;u[--a]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(e.d=u,e.e=r,V?H(e,d):e):new E(0)}function Ge(t,e,n){var r,i=K(t),s=ye(t.d),o=s.length;return e?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+xe(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+xe(-i-1)+s,n&&(r=n-o)>0&&(s+=xe(r))):i>=o?(s+=xe(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+xe(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=xe(r))),t.s<0?"-"+s:s}function qn(t,e){if(t.length>e)return t.length=e,!0}function ur(t){var e,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ye+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Cn(o,s.toString())}else if(typeof s!="string")throw Error(Ye+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,Ei.test(s))Cn(o,s);else throw Error(Ye+s)}if(i.prototype=y,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=ur,i.config=i.set=yi,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function yi(t){if(!t||typeof t!="object")throw Error(me+"Object expected");var e,n,r,i=["precision",1,nt,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((r=t[n=i[e]])!==void 0)if(rt(r)===r&&r>=i[e+1]&&r<=i[e+2])this[n]=r;else throw Error(Ye+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ye+n+": "+r);return this}var pn=ur(vi);fe=new pn(1);const Ne=pn,X={of(t){return new Ne(t)},sum(...t){let e=new Ne(0);for(const n of t)e=e.plus(n);return e},toFormat(t,e,n,r){const i=t.toFixed(e,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[a,u]=i.split("."),l=[];for(let c=a.length;c>0;c-=s)l.unshift(a.slice(Math.max(0,c-s),c));return l.join(o)+(u?`.${u}`:"")},round(t,e,n){return X.of(t).toDecimalPlaces(e,n).toNumber()}};function Ni(t){switch(t){case B.Equal:return"==";case B.NotEqual:return"!=";case B.Lte:return"<=";case B.Gte:return">=";case B.LogicalAnd:return"&&";case B.LogicalOr:return"||";case B.Power:return"**";case B.Nullish:return"??";case B.Group:return"()";default:return String.fromCharCode(t)}}function de(t){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(t)}function ut(t){return t==null}const it=new Map;function _i(t,e){const n=it.get(t);if(n==null)throw new Error(`不支持的函数：${t}`);return n(...e)}function lr(){return new Error("Unexpected end of input")}function te(t){return new Error(`Unexpected end of input at position ${t.start}, near \`${Ni(t.value)}\``)}function Di(t,e,n){switch(t.value){case B.Plus:{if(t.left==null||t.right==null)throw te(t);return typeof e=="string"||typeof n=="string"?e+n:de(e)&&de(n)?X.of(e).plus(n).toNumber():Number.NaN}case B.Minus:{if(t.left==null&&t.right==null)throw te(t);return t.left==null&&t.right?-n:de(e)&&de(n)?X.of(e).minus(n).toNumber():Number.NaN}case B.Asterisk:{if(t.left==null||t.right==null)throw te(t);return de(e)&&de(n)?X.of(e).times(n).toNumber():Number.NaN}case B.Slash:{if(t.left==null||t.right==null)throw te(t);return de(e)&&de(n)?X.of(e).div(n).toNumber():Number.NaN}case B.Percent:{if(t.left==null||t.right==null)throw te(t);return de(e)&&de(n)?X.of(e).mod(n).toNumber():Number.NaN}case B.Power:{if(t.left==null||t.right==null)throw te(t);return de(e)&&de(n)?X.of(e).pow(n).toNumber():Number.NaN}case B.Equal:{if(t.left==null||t.right==null)throw te(t);return ut(e)&&ut(n)?!0:e===n}case B.NotEqual:{if(t.left==null||t.right==null)throw te(t);return ut(e)&&ut(n)?!1:e!==n}case B.Lt:{if(t.left==null||t.right==null)throw te(t);return e<n}case B.Lte:{if(t.left==null||t.right==null)throw te(t);return e<=n}case B.Gt:{if(t.left==null||t.right==null)throw te(t);return e>n}case B.Gte:{if(t.left==null||t.right==null)throw te(t);return e>=n}case B.LogicalAnd:{if(t.left==null||t.right==null)throw te(t);return e&&n}case B.LogicalOr:{if(t.left==null||t.right==null)throw te(t);return e||n}case B.LogicalNot:{if(t.right==null)throw te(t);return!n}case B.Nullish:{if(t.left==null||t.right==null)throw te(t);return ut(e)?n:e}default:throw te(t)}}function bi(t,e){const r=(t.children??[]).map(i=>{if(i!=null)return Re(i,e)});return _i(t.value,r)}function Ti(t,e){var n;return e==null||typeof e!="object"?null:(n=e.data)==null?void 0:n[t.value]}function Si(t,e){var n;return e==null||typeof e!="object"?null:(n=e.scope)==null?void 0:n[t.value]}function Ai(t,e){if(t.left==null||t.right==null||t.condition==null)throw lr();return Re(t.condition,e)?(t.result=Re(t.left,e),t.result):(t.result=Re(t.right,e),t.result)}function Re(t,e){switch(t.type){case ve.NULL:return null;case ve.UNDEFINED:return;case ve.NUMBER:return Number(t.value);case ve.STRING:return String(t.value);case ve.TEMPLATE:{const r=(Array.isArray(t.value)?t.value:[t.value]).map(i=>Re(i,e));return t.result=r.join(""),t.result}case ve.BOOLEAN:return!!t.value;case ve.VARIABLE:return t.result=Ti(t,e),t.result;case ve.REFERENCE:return t.result=Si(t,e),t.result;case ve.FUNCTION:return t.result=bi(t,e),t.result;case ve.OPERATOR:{if(t.isQuestion)return Ai(t,e);if(t.isGroup){if(t.right==null)throw te(t);return t.result=Re(t.right,e),t.result}const n=t.left?Re(t.left,e):null,r=t.right?Re(t.right,e):null;return t.result=Di(t,n,r),t.result}default:throw lr()}}function Ri(t,e){return Re(t,e??{})}const cr="Resolve Element Value Pending Error",fr="ElementValueError";function L(t){const e=Object.create(null);return e.state=ce.DONE,e.raw=t,e}function Ke(){const t=Object.create(null);return t.state=ce.PENDING,t}function $t(){const t=new Error(cr);return t.name=fr,t}function Oi(t){return t instanceof Error&&t.name===fr&&t.message===cr}function ki(t,e){var r;const n=typeof e=="string"?fn(e)?Ve(e):null:e;if(n==null)return L();switch(n.value){case Et.CURRENT_DATE:return L(Date.now());case Et.PAGE_NUMBER:{const i=t.doc;return i==null?L():i.isPaged?L(t.pageNum):Ke()}case Et.PAGE_TOTAL:{const i=t.doc;return i==null?L():i.isPaged?L((r=t.page)==null?void 0:r.pageTotal):Ke()}case Et.ROW_INDEX:{const i=t.doc;if(i==null)return L();if(i.isPaged){if(t.type!==se.TABLE_CELL)return L();const s=t.parent;return s==null?L():L(s.rowIndex)}return Ke()}default:return L()}}function Mi(t,e){const n=typeof e=="string"?fn(e)?Ve(e):null:e;if(n==null)return L();switch(n.value){case kr.ELEMENT_VALUR:return t.isProcessValueDone?L(t.getRawValue()):Ke();default:return L()}}function Pi(t,e,n){const r=typeof e=="string"?Ve(e):e,i=t.parent;if(i==null||!i.isBindVariable)return L(Ze(n,r.value));const s=Ve(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?L():L(Ze(i.rowData,r.value)):L(Ze(n,r.value))}async function xi(t,e){const n=t.define;if(n.ds==null)return L();const r=n.ds,i=r.value;return tt(i)?L():r.type===yt.TEMPLATE?Ii(t,i):r.type===yt.VARIABLE?mn(t,i,e):r.type===yt.FORMULA?hr(t,i,e):r.type===yt.CODE?Li(t,i):L(r.value)}function mn(t,e,n,r=!1){const i=Ve(e);switch(i.varType){case Gt.DS:return t.type===se.TABLE_CELL?Pi(t,i,n):t.type===se.TABLE_ROW?L(t.rowData):L(Ze(n,r?i.path:i.value));case Gt.BUILTIN:return ki(t,i);case Gt.SPECIAL:return Mi(t,i);default:return L()}}function Ii(t,e){return console.log("TODO: template:"+e),L()}function hr(t,e,n){try{const r=Mr.compile(e),i={data:{},scope:{}};for(const o of r.variable){const a=mn(t,o.value,n);if(a.state===ce.PENDING)return Ke();Reflect.set(i.data,o.value,a.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{value:o.value,element:t});const s=Ri(r.root,i);return L(s)}catch(r){return Oi(r)?Ke():(console.log(r),L())}}async function Li(t,e){try{const r=new Function("element",`return (${e})(element)`)(t);if(r instanceof Promise){const i=await r;return L(i)}return L(r)}catch(n){return console.log(n),L()}}function $n(){const t=document.createElement("span"),e="important";return t.style.visibility="hidden",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.zIndex="-1",t.style.setProperty("line-height","1",e),t.style.setProperty("font-family","宋体",e),t.style.setProperty("padding","0",e),t.textContent="水",t}function Ci(){const t=$n();t.style.fontSize="6px",document.body.appendChild(t);const e=$n();e.style.fontSize="12px",document.body.appendChild(e);const n=t.clientHeight<e.clientHeight;return document.body.removeChild(t),document.body.removeChild(e),n}let dr=function(){const t=Ci();return dr=function(){return t},t};const qi=/Chrome/.test(navigator.userAgent);function gn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ee={},Fn;function pr(){if(Fn)return Ee;Fn=1;var t=/^([+-])?0*(\d+)(\.(\d+))?$/,e=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=Ee.e2ten=function(i){var s=e.exec(i.toString());if(!s)return i;var o=s[2],a=s[4]||"",u=s[5]?+s[5]:0;if(u>0){var l=a.substr(0,u);l=l.length<u?l+new Array(u-l.length+1).join("0"):l,a=a.substr(u),o+=l}else{u=-u;var c=o.length-u;c=c<0?0:c;var f=o.substr(c,u);f=f.length<u?new Array(u-f.length+1).join("0")+f:f,o=o.substring(0,c),a=f+a}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(a?"."+a:"")};Ee.getNumbResult=function(i){var s=t.exec(i.toString());if(!s&&e.test(i.toString())&&(s=t.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},Ee.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var a=[].slice.call(arguments,2);a.unshift(s),i.apply(null,a)}return s};var r=Ee.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return Ee.extend=function(i){for(var s,o=arguments[0]||{},a=Array.prototype.slice.call(arguments,1),u=0;u<a.length;u++){var l=a[u];for(s in l)r(l,s)&&(o[s]=l[s])}return o},Ee.getDigit=function(i){return i>=5?(i-4)*4+4:i},Ee.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},Ee.clearZero=function(i,s,o){if(i==null)return"";var a=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,u=new RegExp("^"+a+"+"),l=new RegExp(a+"+$"),c=new RegExp(a+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(u,"")),(!o||o=="$")&&(i=i.replace(l,"")),(!o||o=="nto1")&&(i=i.replace(c,s)),i},Ee}var Zt,Hn;function $i(){if(Hn)return Zt;Hn=1;var t=pr();function e(i,s){var o=t.getNumbResult(i);if(!o)return i;s=s||{};var a=this.ch,u=this.ch_u,l=this.ch_f||"",c=this.ch_d||".",f=a.charAt(0),E=o.int,d=o.decimal,O=o.minus,m="",h="",g=O?l:"",N=function $(P,W,q){P=t.getNumbResult(P).int;var T="",k=arguments.length>1?arguments[1]:s.tenMin,J=P.length;if(J==1)return a.charAt(+P);if(J<=4)for(var b=0,v=J;v--;){var p=+P.charAt(b);T+=k&&J==2&&b==0&&p==1?"":a.charAt(p),T+=p&&v?u.charAt(v):"",b++}else{for(var _=P.length/4>>0,w=P.length%4;w==0||!u.charAt(3+_);)w+=4,_--;var S=P.substr(0,w),R=P.substr(w);T=$(S,k)+u.charAt(3+_)+(R.charAt(0)=="0"?f:"")+$(R,R.length>4?k:!1)}return T=t.clearZero(T,f),T};if(d){d=t.clearZero(d,"0","$");for(var D=0;D<d.length;D++)h+=a.charAt(+d.charAt(D));h=h?c+h:""}if(m=N(E),s.ww&&u.length>5){var C=u.charAt(4),I=u.charAt(5),x=m.lastIndexOf(I);~x&&(m=m.substring(0,x).replace(new RegExp(I,"g"),C+C)+m.substring(x))}return g+m+h}function n(i,s){i=i.toString();var o=i.split(this.ch_d),a=o[0].replace(this.ch_f,""),u=o[1],l=!!~o[0].indexOf(this.ch_f),c=this.ch_u.charAt(1),f=this.ch_u.charAt(4),E=this.ch_u.charAt(5);a=a.replace(new RegExp(f+"{2}(?!"+f+")","g"),E);for(var d=a.split(""),O=0,m=0,h=[],g=[],N=[],D=0;D<d.length;D++){var C=d[D],I=0,x=0;if(~(I=this.ch.indexOf(C)))I>0&&N.unshift(I);else if(~(x=this.ch_u.indexOf(C))){var $=t.getDigit(x);O>x?(t.unshiftZero(N,$),t.centerArray(g,N)):x>=m?(D==0&&(N=[1]),t.centerArray(h,g,N),h.length>0&&t.unshiftZero(h,$),m=x):(N.length==0&&c==C&&(N=[1]),t.centerArray(g,N),t.unshiftZero(g,t.getDigit(x)),O=x)}}t.centerArray(h,g,N).reverse(),h.length==0&&h.push(0);var P=0;if(u){h.push("."),P="0.";for(var D=0;D<u.length;D++)P+=this.ch.indexOf(u.charAt(D)),h.push(this.ch.indexOf(u.charAt(D)));P=+P}return l&&h.unshift("-"),s&&s.outputString?h.join(""):parseFloat(h.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},a=t.getNumbResult(i),u=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!a)return i;s=t.extend(o,s);var l=a.int,c=a.decimal||"",f=s.outSymbol?this.m_t:"",E=a.minus?this.ch_f:"",d="";if(s.complete){for(var O=1;O<this.m_u.length;O++)d+=e.call(this,c.charAt(O-1)||"0")+this.m_u.charAt(O);E+=e.call(this,l,s)+this.m_u.charAt(0)}else{var m=s.unOmitYuan||l!=="0";if(c=c.substr(0,this.m_u.length-1),c=t.clearZero(c,"0","$"),c)for(var h,O=0;O<this.m_u.length-1;O++)c.charAt(O)&&c.charAt(O)!="0"&&(d+=e.call(this,c.charAt(O))+this.m_u.charAt(O+1),h=!1),c.charAt(O)==="0"&&!h&&((O!=0||l!=="0")&&(d+=u),h=!0);(m||!d)&&(E+=e.call(this,l,s)+this.m_u.charAt(0)),s.forceZheng?(d==""||d.charAt(d.length-1)!==this.m_u[2])&&(d+=this.m_z):E+=a.decimal?"":this.m_z,s.forceZheng}return f+E+d}return Zt={CL:e,unCL:n,toMoney:r},Zt}var Xt,Un;function Fi(){if(Un)return Xt;Un=1;var t=$i(),e=pr();function n(r,i){return{encodeS:function(s,o){return o=e.extend({ww:!0,tenMin:!0},o),t.CL.call(r,s,o)},encodeB:function(s,o){return o=e.extend({ww:!0},o),t.CL.call(i,s,o)},decodeS:function(){return t.unCL.apply(r,arguments)},decodeB:function(){return t.unCL.apply(i,arguments)},toMoney:function(s,o){return o=e.extend({ww:!0},o),t.toMoney.call(i,s,o)}}}return Xt=n,Xt}var Kt,Bn;function Hi(){return Bn||(Bn=1,Kt={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),Kt}var Jt,Yn;function Ui(){return Yn||(Yn=1,Jt={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),Jt}var Qt,Vn;function Bi(){if(Vn)return Qt;Vn=1;var t=Fi(),e={s:Hi(),b:Ui()};return Qt=t(e.s,e.b),Qt}var Yi=Bi();const Vi=gn(Yi);var Tt={exports:{}},Gi=Tt.exports,Gn;function zi(){return Gn||(Gn=1,function(t,e){(function(n,r){t.exports=r()})(Gi,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",a="minute",u="hour",l="day",c="week",f="month",E="quarter",d="year",O="date",m="Invalid Date",h=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,N={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(b){var v=["th","st","nd","rd"],p=b%100;return"["+b+(v[(p-20)%10]||v[p]||v[0])+"]"}},D=function(b,v,p){var _=String(b);return!_||_.length>=v?b:""+Array(v+1-_.length).join(p)+b},C={s:D,z:function(b){var v=-b.utcOffset(),p=Math.abs(v),_=Math.floor(p/60),w=p%60;return(v<=0?"+":"-")+D(_,2,"0")+":"+D(w,2,"0")},m:function b(v,p){if(v.date()<p.date())return-b(p,v);var _=12*(p.year()-v.year())+(p.month()-v.month()),w=v.clone().add(_,f),S=p-w<0,R=v.clone().add(_+(S?-1:1),f);return+(-(_+(p-w)/(S?w-R:R-w))||0)},a:function(b){return b<0?Math.ceil(b)||0:Math.floor(b)},p:function(b){return{M:f,y:d,w:c,d:l,D:O,h:u,m:a,s:o,ms:s,Q:E}[b]||String(b||"").toLowerCase().replace(/s$/,"")},u:function(b){return b===void 0}},I="en",x={};x[I]=N;var $="$isDayjsObject",P=function(b){return b instanceof k||!(!b||!b[$])},W=function b(v,p,_){var w;if(!v)return I;if(typeof v=="string"){var S=v.toLowerCase();x[S]&&(w=S),p&&(x[S]=p,w=S);var R=v.split("-");if(!w&&R.length>1)return b(R[0])}else{var M=v.name;x[M]=v,w=M}return!_&&w&&(I=w),w||!_&&I},q=function(b,v){if(P(b))return b.clone();var p=typeof v=="object"?v:{};return p.date=b,p.args=arguments,new k(p)},T=C;T.l=W,T.i=P,T.w=function(b,v){return q(b,{locale:v.$L,utc:v.$u,x:v.$x,$offset:v.$offset})};var k=function(){function b(p){this.$L=W(p.locale,null,!0),this.parse(p),this.$x=this.$x||p.x||{},this[$]=!0}var v=b.prototype;return v.parse=function(p){this.$d=function(_){var w=_.date,S=_.utc;if(w===null)return new Date(NaN);if(T.u(w))return new Date;if(w instanceof Date)return new Date(w);if(typeof w=="string"&&!/Z$/i.test(w)){var R=w.match(h);if(R){var M=R[2]-1||0,U=(R[7]||"0").substring(0,3);return S?new Date(Date.UTC(R[1],M,R[3]||1,R[4]||0,R[5]||0,R[6]||0,U)):new Date(R[1],M,R[3]||1,R[4]||0,R[5]||0,R[6]||0,U)}}return new Date(w)}(p),this.init()},v.init=function(){var p=this.$d;this.$y=p.getFullYear(),this.$M=p.getMonth(),this.$D=p.getDate(),this.$W=p.getDay(),this.$H=p.getHours(),this.$m=p.getMinutes(),this.$s=p.getSeconds(),this.$ms=p.getMilliseconds()},v.$utils=function(){return T},v.isValid=function(){return this.$d.toString()!==m},v.isSame=function(p,_){var w=q(p);return this.startOf(_)<=w&&w<=this.endOf(_)},v.isAfter=function(p,_){return q(p)<this.startOf(_)},v.isBefore=function(p,_){return this.endOf(_)<q(p)},v.$g=function(p,_,w){return T.u(p)?this[_]:this.set(w,p)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(p,_){var w=this,S=!!T.u(_)||_,R=T.p(p),M=function(we,re){var he=T.w(w.$u?Date.UTC(w.$y,re,we):new Date(w.$y,re,we),w);return S?he:he.endOf(l)},U=function(we,re){return T.w(w.toDate()[we].apply(w.toDate("s"),(S?[0,0,0,0]:[23,59,59,999]).slice(re)),w)},G=this.$W,ee=this.$M,oe=this.$D,Me="set"+(this.$u?"UTC":"");switch(R){case d:return S?M(1,0):M(31,11);case f:return S?M(1,ee):M(0,ee+1);case c:var De=this.$locale().weekStart||0,Ce=(G<De?G+7:G)-De;return M(S?oe-Ce:oe+(6-Ce),ee);case l:case O:return U(Me+"Hours",0);case u:return U(Me+"Minutes",1);case a:return U(Me+"Seconds",2);case o:return U(Me+"Milliseconds",3);default:return this.clone()}},v.endOf=function(p){return this.startOf(p,!1)},v.$set=function(p,_){var w,S=T.p(p),R="set"+(this.$u?"UTC":""),M=(w={},w[l]=R+"Date",w[O]=R+"Date",w[f]=R+"Month",w[d]=R+"FullYear",w[u]=R+"Hours",w[a]=R+"Minutes",w[o]=R+"Seconds",w[s]=R+"Milliseconds",w)[S],U=S===l?this.$D+(_-this.$W):_;if(S===f||S===d){var G=this.clone().set(O,1);G.$d[M](U),G.init(),this.$d=G.set(O,Math.min(this.$D,G.daysInMonth())).$d}else M&&this.$d[M](U);return this.init(),this},v.set=function(p,_){return this.clone().$set(p,_)},v.get=function(p){return this[T.p(p)]()},v.add=function(p,_){var w,S=this;p=Number(p);var R=T.p(_),M=function(ee){var oe=q(S);return T.w(oe.date(oe.date()+Math.round(ee*p)),S)};if(R===f)return this.set(f,this.$M+p);if(R===d)return this.set(d,this.$y+p);if(R===l)return M(1);if(R===c)return M(7);var U=(w={},w[a]=r,w[u]=i,w[o]=n,w)[R]||1,G=this.$d.getTime()+p*U;return T.w(G,this)},v.subtract=function(p,_){return this.add(-1*p,_)},v.format=function(p){var _=this,w=this.$locale();if(!this.isValid())return w.invalidDate||m;var S=p||"YYYY-MM-DDTHH:mm:ssZ",R=T.z(this),M=this.$H,U=this.$m,G=this.$M,ee=w.weekdays,oe=w.months,Me=w.meridiem,De=function(re,he,be,Pe){return re&&(re[he]||re(_,S))||be[he].slice(0,Pe)},Ce=function(re){return T.s(M%12||12,re,"0")},we=Me||function(re,he,be){var Pe=re<12?"AM":"PM";return be?Pe.toLowerCase():Pe};return S.replace(g,function(re,he){return he||function(be){switch(be){case"YY":return String(_.$y).slice(-2);case"YYYY":return T.s(_.$y,4,"0");case"M":return G+1;case"MM":return T.s(G+1,2,"0");case"MMM":return De(w.monthsShort,G,oe,3);case"MMMM":return De(oe,G);case"D":return _.$D;case"DD":return T.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return De(w.weekdaysMin,_.$W,ee,2);case"ddd":return De(w.weekdaysShort,_.$W,ee,3);case"dddd":return ee[_.$W];case"H":return String(M);case"HH":return T.s(M,2,"0");case"h":return Ce(1);case"hh":return Ce(2);case"a":return we(M,U,!0);case"A":return we(M,U,!1);case"m":return String(U);case"mm":return T.s(U,2,"0");case"s":return String(_.$s);case"ss":return T.s(_.$s,2,"0");case"SSS":return T.s(_.$ms,3,"0");case"Z":return R}return null}(re)||R.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(p,_,w){var S,R=this,M=T.p(_),U=q(p),G=(U.utcOffset()-this.utcOffset())*r,ee=this-U,oe=function(){return T.m(R,U)};switch(M){case d:S=oe()/12;break;case f:S=oe();break;case E:S=oe()/3;break;case c:S=(ee-G)/6048e5;break;case l:S=(ee-G)/864e5;break;case u:S=ee/i;break;case a:S=ee/r;break;case o:S=ee/n;break;default:S=ee}return w?S:T.a(S)},v.daysInMonth=function(){return this.endOf(f).$D},v.$locale=function(){return x[this.$L]},v.locale=function(p,_){if(!p)return this.$L;var w=this.clone(),S=W(p,_,!0);return S&&(w.$L=S),w},v.clone=function(){return T.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},b}(),J=k.prototype;return q.prototype=J,[["$ms",s],["$s",o],["$m",a],["$H",u],["$W",l],["$M",f],["$y",d],["$D",O]].forEach(function(b){J[b[1]]=function(v){return this.$g(v,b[0],b[1])}}),q.extend=function(b,v){return b.$i||(b(v,k,q),b.$i=!0),q},q.locale=W,q.isDayjs=P,q.unix=function(b){return q(1e3*b)},q.en=x[I],q.Ls=x,q.p={},q})}(Tt)),Tt.exports}var ji=zi();const ke=gn(ji);var St={exports:{}},Wi=St.exports,zn;function Zi(){return zn||(zn=1,function(t,e){(function(n,r){t.exports=r()})(Wi,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,u={},l=function(h){return(h=+h)+(h>68?1900:2e3)},c=function(h){return function(g){this[h]=+g}},f=[/[+-]\d\d:?(\d\d)?|Z/,function(h){(this.zone||(this.zone={})).offset=function(g){if(!g||g==="Z")return 0;var N=g.match(/([+-]|\d\d)/g),D=60*N[1]+(+N[2]||0);return D===0?0:N[0]==="+"?-D:D}(h)}],E=function(h){var g=u[h];return g&&(g.indexOf?g:g.s.concat(g.f))},d=function(h,g){var N,D=u.meridiem;if(D){for(var C=1;C<=24;C+=1)if(h.indexOf(D(C,0,g))>-1){N=C>12;break}}else N=h===(g?"pm":"PM");return N},O={A:[a,function(h){this.afternoon=d(h,!1)}],a:[a,function(h){this.afternoon=d(h,!0)}],Q:[i,function(h){this.month=3*(h-1)+1}],S:[i,function(h){this.milliseconds=100*+h}],SS:[s,function(h){this.milliseconds=10*+h}],SSS:[/\d{3}/,function(h){this.milliseconds=+h}],s:[o,c("seconds")],ss:[o,c("seconds")],m:[o,c("minutes")],mm:[o,c("minutes")],H:[o,c("hours")],h:[o,c("hours")],HH:[o,c("hours")],hh:[o,c("hours")],D:[o,c("day")],DD:[s,c("day")],Do:[a,function(h){var g=u.ordinal,N=h.match(/\d+/);if(this.day=N[0],g)for(var D=1;D<=31;D+=1)g(D).replace(/\[|\]/g,"")===h&&(this.day=D)}],w:[o,c("week")],ww:[s,c("week")],M:[o,c("month")],MM:[s,c("month")],MMM:[a,function(h){var g=E("months"),N=(E("monthsShort")||g.map(function(D){return D.slice(0,3)})).indexOf(h)+1;if(N<1)throw new Error;this.month=N%12||N}],MMMM:[a,function(h){var g=E("months").indexOf(h)+1;if(g<1)throw new Error;this.month=g%12||g}],Y:[/[+-]?\d+/,c("year")],YY:[s,function(h){this.year=l(h)}],YYYY:[/\d{4}/,c("year")],Z:f,ZZ:f};function m(h){var g,N;g=h,N=u&&u.formats;for(var D=(h=g.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(q,T,k){var J=k&&k.toUpperCase();return T||N[k]||n[k]||N[J].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(b,v,p){return v||p.slice(1)})})).match(r),C=D.length,I=0;I<C;I+=1){var x=D[I],$=O[x],P=$&&$[0],W=$&&$[1];D[I]=W?{regex:P,parser:W}:x.replace(/^\[|\]$/g,"")}return function(q){for(var T={},k=0,J=0;k<C;k+=1){var b=D[k];if(typeof b=="string")J+=b.length;else{var v=b.regex,p=b.parser,_=q.slice(J),w=v.exec(_)[0];p.call(T,w),q=q.replace(w,"")}}return function(S){var R=S.afternoon;if(R!==void 0){var M=S.hours;R?M<12&&(S.hours+=12):M===12&&(S.hours=0),delete S.afternoon}}(T),T}}return function(h,g,N){N.p.customParseFormat=!0,h&&h.parseTwoDigitYear&&(l=h.parseTwoDigitYear);var D=g.prototype,C=D.parse;D.parse=function(I){var x=I.date,$=I.utc,P=I.args;this.$u=$;var W=P[1];if(typeof W=="string"){var q=P[2]===!0,T=P[3]===!0,k=q||T,J=P[2];T&&(J=P[2]),u=this.$locale(),!q&&J&&(u=N.Ls[J]),this.$d=function(_,w,S,R){try{if(["x","X"].indexOf(w)>-1)return new Date((w==="X"?1e3:1)*_);var M=m(w)(_),U=M.year,G=M.month,ee=M.day,oe=M.hours,Me=M.minutes,De=M.seconds,Ce=M.milliseconds,we=M.zone,re=M.week,he=new Date,be=ee||(U||G?1:he.getDate()),Pe=U||he.getFullYear(),wt=0;U&&!G||(wt=G>0?G-1:he.getMonth());var vt,Ft=oe||0,Ht=Me||0,Ut=De||0,Bt=Ce||0;return we?new Date(Date.UTC(Pe,wt,be,Ft,Ht,Ut,Bt+60*we.offset*1e3)):S?new Date(Date.UTC(Pe,wt,be,Ft,Ht,Ut,Bt)):(vt=new Date(Pe,wt,be,Ft,Ht,Ut,Bt),re&&(vt=R(vt).week(re).toDate()),vt)}catch{return new Date("")}}(x,W,$,N),this.init(),J&&J!==!0&&(this.$L=this.locale(J).$L),k&&x!=this.format(W)&&(this.$d=new Date("")),u={}}else if(W instanceof Array)for(var b=W.length,v=1;v<=b;v+=1){P[1]=W[v-1];var p=N.apply(this,P);if(p.isValid()){this.$d=p.$d,this.$L=p.$L,this.init();break}v===b&&(this.$d=new Date(""))}else C.call(this,I)}}})}(St)),St.exports}var Xi=Zi();const Ki=gn(Xi);ke.extend(Ki);function Ji(t){switch(t){case zt.FLOOR:return Ne.ROUND_FLOOR;case zt.CEIL:return Ne.ROUND_CEIL;case zt.BANKER_ROUND:return Ne.ROUND_HALF_EVEN;default:return Ne.ROUND_HALF_UP}}function Qi(t,e){if(t==null)return"";const n=e.format,r=Ji(e.round),i=e.showZero===!1;switch(n){case st.FIXED:{const s=e.precision;if(s==null||s<0)return t.toString();const o=typeof t=="number"?X.of(t):t;return o.eq(0)&&i?"":o.toFixed(s,r)}case st.THOUSAND:{const s=typeof t=="number"?X.of(t):t;return s.eq(0)&&i?"":X.toFormat(s,2,r,{groupSize:3})}case st.TEN_THOUSAND:{const s=typeof t=="number"?X.of(t):t;return s.eq(0)&&i?"":X.toFormat(s,2,r,{groupSize:4})}case st.DAXIE:{const s=typeof t=="number"?X.of(t):t;return s.eq(0)&&i?"":Vi.toMoney(s.toFixed(2,r),{outSymbol:!1})}case st.PERCENTAGE:{const s=typeof t=="number"?X.of(t):t;if(s.eq(0)&&i)return"";const o=e.precision??2;return s.times(100).toFixed(o,Ne.ROUND_HALF_UP)+"%"}default:return typeof t=="number"?t==0&&i?"":t.toString():t.eq(0)&&i?"":t.toString()}}function es(t,e){const n=e.format;return n==null?t:ke(t).format(n)}function ts(t,e){const n=t.attributes;switch(t.display){case se.NUMBER:return Qi(e,n);case se.DATE:return es(e,n);default:return e}}const jn=Object.create(null);var Lt,Je;const ft=class ft{constructor(e){le(this,Lt,ln(cn.PRINT_ELEMENT));le(this,Je,Object.create(null));A(this,"define");A(this,"children",[]);A(this,"atomized",!1);A(this,"extra",!1);A(this,"parent");A(this,"offsetTop",0);A(this,"offsetLeft",0);A(this,"offsetWidth",0);A(this,"offsetHeight",0);A(this,"element");A(this,"zIndex");A(this,"state",on.CREATED);A(this,"visibility",Te.PENDING);A(this,"value",{state:ce.UNDEFINED});this.define=e,this.offsetTop=e.offsetTop,this.offsetLeft=e.offsetLeft,this.offsetWidth=e.offsetWidth,this.offsetHeight=e.offsetHeight,this.zIndex=e.zIndex,Ue(this,"parent",null),Ue(this,"element",null)}static register(e,n){jn[e]=n}static create(e){const n=jn[e.type]??ft;return new n(e)}static isPrintElement(e){return e instanceof ft}get id(){return"@"+F(this,Lt)}get type(){return this.define.type}get page(){let e=this.parent;for(;e;){if(e instanceof kt)return e;e=e.parent}return null}get doc(){var e;return(e=this.page)==null?void 0:e.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const e=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return e+n}get pageNum(){var e;return((e=this.page)==null?void 0:e.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const e=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${e}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===Dt.AUTO}get isOverflowScale(){return this.define.attributes.overflow===Dt.SCALE}get isOverflowHidden(){const e=this.define.attributes.overflow;return e==null||e===Dt.HIDDEN}get isProcessValueDone(){return this.value.state===ce.DONE}get isUndefinedValue(){return this.value.state===ce.UNDEFINED}get isHidden(){return this.visibility===Te.HIDDEN}async processValue(){var e,n,r;if(!this.isProcessValueDone)switch(this.value=await xi(this,(e=this.doc)==null?void 0:e.data),this.value.state){case ce.DONE:(n=this.doc)==null||n.removeDependency(this);break;case ce.PENDING:(r=this.doc)==null||r.addDependency(this,{state:ce.PENDING});break}}getRawValue(){if(this.value.state===ce.DONE)return this.value.raw}format(){return ts(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(e=>e.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}nextTick(){return this.doc?this.doc.nextTick():Promise.resolve()}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const e=this.content;return Pr(e)?null:z("div",{class:"quickprint-content",children:z("span",{children:this.content})})}async updateElement(){const e=this.parent;if(e==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await e.replaceChild(this,n)}async mountChild(e){var n;return this.element==null||e.element==null?!1:(this.element.appendChild(e.element),await this.nextTick(),await e.mount(e.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(e,n){var r;return this.element==null||e.element==null?!1:(n==null?this.element.removeChild(e.element):this.element.replaceChild(n,e.element),await this.nextTick(),await e.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(e){e!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=e.offsetWidth,this.offsetHeight=e.offsetHeight,this.state=on.MOUNDTED,this.element=e)}setParent(e){this.parent=e}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}append(e){e.setParent(this),this.children.push(e),F(this,Je)[e.id]=e}clone(){const e=ft.create(this.define),n=this.children.map(r=>r.clone());return e.appendMany(n),e}checkOverflow(){if(this.element==null)return!1;const e=this.element.querySelector(".quickprint-content");if(e==null)return!1;const n=e.parentElement;return n==null?!1:n.offsetHeight<e.offsetHeight}processOverflow(){return this.isOverflowScale?dr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const e=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return e==null||(e.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(e){const n=F(this,Je)[e];if(n)return n;for(const r of this.children){const i=r.findElement(e);if(i)return i}}findElementFromDefine(e){return this.children.find(n=>n.define.id===e)}createElements(){ze(this,Je,this.children.reduce((e,n)=>(e[n.id]=n,e),Object.create(null)))}checkVisibility(){var i,s,o;const e=this.define;if(e.visibility==null||e.visibility.type===An.VISIBLE)return Te.VISIBLE;if(e.visibility.type===An.HIDDEN)return Te.HIDDEN;const n=e.visibility.condition;if(tt(n))return Te.VISIBLE;const r=hr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case ce.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Te.VISIBLE:Te.HIDDEN;case ce.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:ce.PENDING}),Te.PENDING;default:return Te.PENDING}}};Lt=new WeakMap,Je=new WeakMap;let j=ft;function lt(t,e){return e.exclude==null?!0:!e.exclude.includes(t)}function gt(t){var s;const e={};if(!qi)return e;const n=t.define,r=n.style.fontFamily;return(r==null||r===xr.SONG)&&((s=n.style)==null?void 0:s.fontWeight)===700&&(e["quickprint-patch-song-blod"]=!0),e}function wn(t,e={}){const n={},r=t.define.style??{},i=Jn(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=Ir(r);return s&&We(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),We(n,Lr(t.define)),We(n,Cr(t.define)),We(n,qr(t.define)),lt("padding",e)&&We(n,$r(t.define)),n}function vn(t,e={}){const n={};if(lt("top",e)&&(n.top=t.offsetTop+"px"),lt("left",e)&&(n.left=t.offsetLeft+"px"),lt("width",e)&&(n.width=t.offsetWidth+"px"),lt("height",e)){const r=t.define.attributes.overflow===Dt.AUTO?"min-height":"height";n[r]=t.offsetHeight+"px"}return t.zIndex&&(n.zIndex=t.zIndex),n}function En(t,e={}){return hn(vn(t,e),wn(t,e),nn(t.define))}class ns extends j{get style(){return En(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...gt(this)}}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class rs extends j{get style(){return vn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...gt(this)}}processConstNode(e){var i;const n=e.dataset.value;if(tt(n))return;const r=mn(this,n,(i=this.doc)==null?void 0:i.data);e.textContent=r.raw}process(e){for(const n of Array.from(e.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return e}render(){if(this.isHidden)return null;const e=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=e,z("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class is extends j{get style(){return En(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...gt(this)}}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class ss extends j{get style(){return En(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...gt(this)}}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class mr extends j{constructor(){super(...arguments);A(this,"rendering",0)}get style(){return{...hn(vn(this),wn(this)),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>z("col",{width:s}));return z("div",{id:this.id,class:this.className,style:this.style,children:z("table",{children:[z("colgroup",{children:i}),z("tbody",{})]})})}async mountChild(n){var i;if(n.element==null)return!1;const r=this.getTableBody();return r==null?!1:(r.appendChild(n.element),await this.nextTick(),await n.mount(n.element),this.offsetHeight=((i=this.element)==null?void 0:i.offsetHeight)??0,!0)}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await this.nextTick(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n+1),i=this.getTableBody();if(this.children.length=n+1,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class os extends j{constructor(){super(...arguments);A(this,"repeatGroup");A(this,"rowData");A(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return z("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=on.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}}class yn extends j{get style(){var r;const e=nn((r=this.define.parent)==null?void 0:r.parent),n=nn(this.define);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-height":this.offsetHeight+"px",...We(e,n)}}get className(){const e=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(e==null?void 0:e.isOverflowAuto)===!0,"quickprint-fixed-height":(e==null?void 0:e.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...gt(this)}}get showDiagonal(){const e=this.define.attributes.diagonalMode;return e==null?!1:e!==ot.NONE}createContentStyle(e=!1){var s;const n=[],r={exclude:[]};e&&((s=r.exclude)==null||s.push("padding"));let i=this;for(;j.isPrintElement(i);)n.unshift(wn(i,r)),i=i.parent;return hn({},...n)}createCoord(){switch(this.define.attributes.diagonalMode){case ot.TL_BR:return{x1:"0",y1:"0",x2:"100%",y2:"100%"};case ot.TR_BL:return{x1:"100%",y1:"0",x2:"0",y2:"100%"};default:return null}}createDiagonal(){const e=this.createCoord();if(e==null)return null;const n=this.define.attributes.diagonalMode,r=this.define.attributes.diagonalLabels??[],i={"quickprint-diagonal":!0,"quickprint-diagonal-tlbr":n===ot.TL_BR,"quickprint-diagonal-trbl":n===ot.TR_BL},s=r[0]?z("div",{class:"quickprint-diagonal-first-label",children:r[0].text}):null,o=r[1]?z("div",{class:"quickprint-diagonal-second-label",children:r[1].text}):null,a=document.createElementNS(In,"svg");a.setAttribute("width","100%"),a.setAttribute("height","100%");const u=document.createElementNS(In,"line");return u.setAttribute("x1",e.x1),u.setAttribute("y1",e.y1),u.setAttribute("x2",e.x2),u.setAttribute("y2",e.y2),u.setAttribute("stroke","currentColor"),u.setAttribute("stroke-width","1"),a.appendChild(u),z("div",{class:i,style:this.createContentStyle(!0),children:[a,s,o]})}createCell(){return this.isHidden?null:this.showDiagonal?this.createDiagonal():z("div",{class:"quickprint-layout",style:this.createContentStyle(),children:this.createContent()})}render(){return this.define.isCollapsed?null:z("td",{id:this.id,class:this.className,style:this.style,rowspan:this.define.rowspan,colspan:this.define.colspan,children:this.createCell()})}}j.register(se.TEXT,ns);j.register(se.PARAGRAPH,rs);j.register(se.NUMBER,is);j.register(se.DATE,ss);j.register(se.TABLE,mr);j.register(se.TABLE_ROW,os);j.register(se.TABLE_CELL,yn);function as(t){return Number(t)}function us(t){return Math.abs(t)}function ls(t){return Math.trunc(t)}function cs(...t){return Math.min(...t)}function fs(...t){return Math.max(...t)}function hs(t,e){return X.round(t,e??0,Ne.ROUND_CEIL)}function ds(t,e){return X.round(t,e??0,Ne.ROUND_FLOOR)}function ps(t,e,n){return X.round(t,e??0,n??Ne.ROUND_HALF_UP)}function ms(t){t.set("NUMBER",as),t.set("ABS",us),t.set("TRUNC",ls),t.set("MIN",cs),t.set("MAX",fs),t.set("CEIL",hs),t.set("FLOOR",ds),t.set("ROUND",ps)}function gs(t){return String(t)}function ws(t){return String(t).length}function vs(t){return String(t).toLowerCase()}function Es(t){return String(t).toUpperCase()}function ys(t){const e=String(t);return e[0].toUpperCase()+e.slice(1)}function Ns(t){return String(t).trim()}function _s(t,e,n){return String(t).replace(e,n)}function Ds(t,e,n){return String(t).replaceAll(e,n)}function bs(t,e,n){return String(t).slice(e,n)}function Ts(t,e,n){return String(t).includes(String(e),n)}function Ss(t,e,n){return String(t).indexOf(String(e),n)}function As(t,e,n){return String(t).lastIndexOf(String(e),n)}function Rs(t,e,n){return String(t).startsWith(String(e),n)}function Os(t,e,n){return String(t).endsWith(String(e),n)}function ks(t){t.set("STRING",gs),t.set("LENGTH",ws),t.set("LOWER",vs),t.set("UPPER",Es),t.set("TRIM",Ns),t.set("UPPER_FIRST",ys),t.set("REPLACE",_s),t.set("REPLACE_ALL",Ds),t.set("SLICE",bs),t.set("INCLUDES",Ts),t.set("INDEX_OF",Ss),t.set("LAST_INDEX_OF",As),t.set("STARTS_WITH",Rs),t.set("ENDS_WITH",Os)}function Ms(t,e,n){return t?e:n}function Ps(t,e){return Number.isNaN(t)?e:t}function xs(t,e){return Number.isNaN(t)||t==null?e:t}function Is(t,...e){for(let r=0;r<e.length;r+=2){const i=e[r],s=e[r+1];if(i===t)return s}return e.length%2===0?void 0:e[e.length-1]}function gr(t){return Number.isNaN(t)}function Ls(t){return Number.isInteger(t)}function wr(t){return typeof t=="number"}function vr(t){return typeof t=="string"}function Cs(t){return typeof t=="boolean"}function Er(t){return t===null}function yr(t){return t===void 0}function Nr(t){return Er(t)||yr(t)}function qs(t){return Nr(t)?!0:vr(t)?t.length==0:wr(t)?!gr(t):!1}function $s(t){t.set("IF",Ms),t.set("IFNA",Ps),t.set("IFERROR",xs),t.set("IS_NAN",gr),t.set("IS_INTEGER",Ls),t.set("IS_NUMBER",wr),t.set("IS_STRING",vr),t.set("IS_BOOLEAN",Cs),t.set("IS_NULL",Er),t.set("IS_UNDEFINED",yr),t.set("IS_NULLISH",Nr),t.set("IS_EMPTY",qs),t.set("SWITCH",Is)}const Fs=[ae.YEAR_MONTH,ae.YEAR_MONTH_CHS,ae.YEAR_MONTH_DAY,ae.YEAR_MONTH_DAY_CHS,ae.DATETIME_SHORT,ae.DATETIME_SHORT_CHS,ae.DATETIME,ae.DATETIME_CHS,ae.TIME,ae.TIME_SHORT,ae.YEAR,ae.MONTH,ae.DAY];function Le(t){if(t!=null){if(typeof t=="number")return Fs[t];if(typeof t=="string")return t}}function _r(t,e,n){return t===null&&(t=void 0),ke(t,Le(n)).format(Le(e)??ae.DATETIME)}function Hs(t){return _r(void 0,t)}function Us(t,e){return t===null&&(t=void 0),ke(t,Le(e)).year()}function Bs(t,e){return t===null&&(t=void 0),ke(t,Le(e)).month()+1}function Ys(t,e){return t===null&&(t=void 0),ke(t,Le(e)).date()}function Vs(t,e){return t===null&&(t=void 0),ke(t,Le(e)).hour()}function Gs(t,e){return t===null&&(t=void 0),ke(t,Le(e)).minute()}function zs(t,e){return t===null&&(t=void 0),ke(t,Le(e)).second()}function js(t){t.set("DATE",_r),t.set("NOW",Hs),t.set("YEAR",Us),t.set("MONTH",Bs),t.set("DAY",Ys),t.set("HOUR",Vs),t.set("MINUTE",Gs),t.set("SECOND",zs)}function Dr(t,e){return t.children.reduce((n,r)=>{const i=r.findElementFromDefine(e);if(i==null)return n;if(!i.isProcessValueDone)throw $t();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(Fr(o)?o:0),n},[])}function Nn(t,e){var r;const n=(r=t.parent)==null?void 0:r.parent;if(!(n==null||n.type!==se.TABLE))return Dr(n,e)}function _n(t,e){var i,s;const n=(i=t.parent)==null?void 0:i.parent;if(n==null||n.type!==se.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,a)=>o.concat(a.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,a)=>o.concat(Dr(a,e)),[])}function Ws(t,e){if(!t.doc.isPaged)throw $t();const r=t.page,i=r.pageNum<r.pageTotal?Nn(t,e):_n(t,e);return i==null||i.length==0?0:X.sum(...i).toNumber()}function Zs(t,e){const n=t.element,r=t.value;if(!(n instanceof yn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw $t();if(e===2)return Ws(n,r);const s=e==1?Nn(n,r):_n(n,r);return s==null||s.length==0?0:X.sum(...s).toNumber()}function Xs(t,e){const n=t.element,r=t.value;if(!(n instanceof yn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw $t();const s=e==1?Nn(n,r):_n(n,r);return s==null||s.length==0?0:X.sum(...s).div(s.length).toNumber()}function Ks(t){t.set("COL_SUM",Zs),t.set("COL_AVG",Xs)}ms(it);ks(it);$s(it);js(it);Ks(it);const Js=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-line;min-width:100%}.quickprint-content>span{background-color:var(--quickprint-variable-highlight-color, transparent)}.quickprint-diagonal{display:block;width:var(--quickprint-cell-width);height:var(--quickprint-cell-height);position:relative}.quickprint-diagonal-first-label,.quickprint-diagonal-second-label{position:absolute;z-index:2}.quickprint-diagonal-tlbr .quickprint-diagonal-first-label{top:2px;right:2px;text-align:right}.quickprint-diagonal-tlbr .quickprint-diagonal-second-label{left:2px;bottom:2px}.quickprint-diagonal-trbl .quickprint-diagonal-first-label{top:2px;left:2px}.quickprint-diagonal-trbl .quickprint-diagonal-second-label{right:2px;bottom:2px;text-align:right}",Qs="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none!important}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song-blod{text-shadow:0 0 currentColor,0 0 currentColor}}";function Wn(){return Js}function eo(){return Qs}class to{constructor(){A(this,"skip",0);A(this,"count",0);A(this,"resolvedPromise",Promise.resolve())}nextTick(){return this.skip<=2e3?(this.skip++,this.resolvedPromise):this.count<48?(this.count++,this.resolvedPromise):new Promise(e=>{this.count=0,setTimeout(e)})}}var Ct,Qe,dt,$e,Fe,He,pt,un;const bn=class bn{constructor(e,n){le(this,pt);le(this,Ct,ln(cn.PRINT_DOCUMENT));le(this,Qe);le(this,dt);le(this,$e,Object.create(null));le(this,Fe,0);A(this,"define");A(this,"data");A(this,"state");A(this,"pages",[]);A(this,"element");A(this,"renderer",null);A(this,"rendering");A(this,"devicePixelRatio",window.devicePixelRatio);A(this,"tick",new to);le(this,He,[]);const{promise:r,resolve:i}=Promise.withResolvers();ze(this,dt,r),ze(this,Qe,i),this.define=e,this.state=n,Ue(this,"element",null),Ue(this,"rendering",0),this.state.renderState=ge.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(e,n={}){const r=e instanceof rn?e:rn.create(e);return new bn(r,n)}get id(){return"@"+F(this,Ct)}get style(){const e=this.state.scale??100,n=this.define.style;return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":e/100,"--quickprint-paper-width":this.define.paper.width+"mm","--quickprint-paper-height":`calc(${this.define.paper.height}mm - 1px)`,fontFamily:Jn(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get renderState(){return this.state.renderState}get isPaged(){return this.renderState===ge.PAGED||this.renderState===ge.READY}get isFirstRount(){return F(this,Fe)===0}onCreated(){return Promise.allSettled(this.pages.map(e=>e.onCreated()))}onBeforeUnmount(e){F(this,He).indexOf(e)>=0||F(this,He).push(e)}unmount(){for(const e of F(this,He))typeof e=="function"&&e();F(this,He).length=0,this.setRenderState(ge.UNMOUNT),this.element=null}nextTick(){return this.tick.nextTick()}render(){return z("div",{class:Se.DOCUMENT,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(e){return this.element==null||e.element==null?!1:(this.element.appendChild(e.element),!0)}async mount(){this.state.total=this.pages.length,this.refreshPageTotal(),this.setRenderState(ge.PAGED),await Vt(this,pt,un).call(this),this.setRenderState(ge.READY);const e=this.pages.map(n=>n.onFinshed());await Promise.allSettled(e),typeof F(this,Qe)=="function"&&(F(this,Qe).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(e){this.pages.push(e),e.setParent(this)}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}insert(e,n){this.pages.splice(n,0,e),e.setParent(this)}ready(){return F(this,dt)}injectElementStyle(){const e=document.createElement("style");e.textContent=Wn(),document.head.appendChild(e)}async print(){return await this.ready(),new Promise(e=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),e()})})}genPapeStyle(){const e=this.define;return`@page{ size: ${e.paper.width}mm ${e.paper.height}mm }`}genPrintHtml(){var r;const e=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${e}</title>`,`<style>${Wn()}</style>`,`<style>${eo()}</style>`,`<style>${this.genPapeStyle()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const e=this.state.scale??100,n=at.indexOf(e);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=at[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const e=this.state.scale??100,n=at.indexOf(e);if(n<0)return this.resetZoom(),!1;if(n>=at.length-1)return!1;const r=at[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const e=100;this.state.scale=e,this.element.style.setProperty("--quickprint-doc-scale",`${e/100}`)}addDependency(e,n){F(this,$e)[e.id]={element:e,...n}}removeDependency(e){delete F(this,$e)[e.id]}setRenderState(e){this.state.renderState=e}watchDevicePixelRatio(){const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);e.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{e.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}debug(){var e;this.state.debug=!0,(e=this.element)==null||e.classList.add("quickprint-document-debug")}toggleDebug(){var e;this.state.debug=this.state.debug!==!0,(e=this.element)==null||e.classList.toggle("quickprint-document-debug")}findElement(e){for(const n of this.pages){const r=n.findElement(e);if(r)return r}}refreshPageTotal(){const e={};for(const n of this.pages){const r=n.file;if(e[r]!=null){n.pageTotal=e[r];continue}const i=this.pages.filter(s=>s.file===r);e[r]=i.length,n.pageTotal=i.length}}};Ct=new WeakMap,Qe=new WeakMap,dt=new WeakMap,$e=new WeakMap,Fe=new WeakMap,He=new WeakMap,pt=new WeakSet,un=async function(){for(const n of Object.values(F(this,$e))){const r=n.element;await r.processValue(),r.isProcessValueDone&&(this.removeDependency(r),await r.updateElement())}if(Object.keys(F(this,$e)).length==0){Hr.debug("Document",`已完成第计算, 共${F(this,Fe)+1}轮`);return}Sn(this,Fe)._++,!(F(this,Fe)>=100)&&await Vt(this,pt,un).call(this)};let Pt=bn;function ct(t){const e=j.create(t),n=t.children.map(r=>j.create(r));return e.appendMany(n),e}function no(t,e={}){function n(l){const c=kt.create(l,t.define.paper);r(c);for(const f of c.defines){const E=s(f);E.define.isFixed?c.appendToFixed(E):c.append(E)}return i(c),c.state=bt.INIT,c}function r(l){if(!(l.header.display!=!0||l.header.defines.length==0))for(const c of l.header.defines)l.appendToHeader(s(c))}function i(l){if(!(l.footer.display!=!0||l.footer.defines.length==0))for(const c of l.footer.defines)l.appendToFooter(s(c))}function s(l){switch(l.type){case"Table":return o(l);default:return j.create(l)}}function o(l){let c=0;const f=j.create(l),E=l.children;for(;c<E.length;){const d=E[c];if(d.isRepeat&&d.rowspan>1){const O=a(l,c);f.appendMany(O.rows),c=O.next;continue}if(d.isRepeat){f.appendMany(u(d)),c++;continue}f.append(ct(d)),c++}return f}function a(l,c){const f=l.children[c],E=l.children.slice(c,c+f.rowspan),d=Ve(f.ds.value),O=Rn(Ze(e,d.value)),m=[];for(let h=0;h<O.length;h++){const g=`${f.id}_${h}`;for(const N of E){const D=ct(N);D.repeatGroup=g,D.rowData=O[h],m.push(D)}}return{rows:m,next:c+f.rowspan}}function u(l){const c=Ve(l.ds.value),f=Ze(e,c.value);return Rn(f).map(E=>{const d=ct(l);return d.rowData=E,d})}return t.data=e,t.appendMany(t.define.pages.map(l=>n(l))),t}function ro(t,e={}){return no(t,e)}var et;class io{constructor(e,n,r){A(this,"container");A(this,"doc");A(this,"data");A(this,"currentFile",null);A(this,"pageNum",1);A(this,"debug",!1);le(this,et,null);this.container=e,this.doc=n,this.data=r,document.addEventListener("keydown",i=>{i.key==="F10"&&(i.preventDefault,this.next())})}next(){typeof F(this,et)=="function"&&F(this,et).call(this)}resume(){}createNextTask(e){return this.debug!==!0?e():new Promise(n=>{ze(this,et,()=>{e().then(n)})})}async render(){ro(this.doc,this.data),await this.doc.onCreated(),this.doc.setRenderState(ge.RENDERING);const e=this.doc.createElement();return e&&this.container.appendChild(e),this.currentFile=this.doc.pages[0].file,this.renderPage()}async renderPage(){const e=this.doc,n=e.rendering,r=e.pages[n];return r==null?e.mount():(r.beginPaging(),r.createElement()==null?(e.rendering+=1,this.renderPage()):(await e.mountChild(r),await this.renderPageElement(r),await this.renderPageFixedElement(r),r.file!==this.currentFile&&(this.pageNum=1),r.pageNum=this.pageNum++,await r.onPaged(),this.createNextTask(()=>(e.rendering+=1,e.state.total=e.pages.length,this.renderPage()))))}async renderPageElement(e){const n=e.children[e.rendering];return n==null?void 0:(n.offsetTop=this.findNewOffsetTop(e,n),n.createElement()==null?this.createNextTask(()=>(e.rendering+=1,this.renderPageElement(e))):(await this.mountChild(e,n),this.createNextTask(()=>(e.rendering+=1,this.renderPageElement(e)))))}async renderPageFixedElement(e){for(const n of e.fixed)n.createElement(),await e.mountChild(n)}findNewOffsetTop(e,n){const r=e.children[e.rendering-1];return r==null?e.extra?e.header.offsetHeight+4:n.offsetTop:!r.isChanged||tn.isIsolated(r.define,n.define)?n.offsetTop:r.offsetBottom+n.define.top-r.define.top-r.define.height}mountChild(e,n){switch(n.define.type){case se.TABLE:return this.renderTable(e,n);case se.TEXT:return this.renderText(e,n);default:return this.defaultRender(e,n)}}findNextFragment(e,n){const r=e.children[n],i=[r];if(r.repeatGroup==null)return{height:r.offsetHeight,length:1};for(let s=n+1;s<e.children.length;s++){const o=e.children[s];if(o.repeatGroup!==r.repeatGroup)break;i.push(o)}return{height:Math.max(...i.map(s=>s.offsetHeight)),length:i.length}}findSplitRowIndex(e,n){let r=e.offsetTop,i=0;for(;i<e.children.length;){const s=this.findNextFragment(e,i);if(r+=s.height,r==n)return i+s.length-1;if(r>n)return i-1;i+=s.length}return e.children.length-1}splitTable(e,n,r){const i=n.define.footer.map(f=>{const E=ct(f);return E.extra=!0,E}),s=r-i.reduce((f,E)=>f+E.offsetHeight,0),o=this.findSplitRowIndex(n,s),a=n.splitRows(o);n.appendMany(i),n.atomized=!0,n.rendering=o;const u=e.clone(),l=new mr(n.define),c=n.define.header.map(f=>ct(f));l.extra=!0,l.appendMany(c),l.appendMany(a),u.append(l);for(let f=e.rendering+1,E=e.children.length;f<E;f++){const d=e.children[f];tn.isIsolated(d.define,n.define)||(u.append(d),Reflect.set(e.children,f,null))}return e.children=e.children.filter(f=>f!=null),u}async renderTableRow(e,n){const r=n.children[n.rendering];if(r==null)return;if(r.extra&&r.isUndefinedValue&&await r.onCreated(),r.createElement()==null)return n.rendering+=1,this.renderTableRow(e,n);await n.mountChild(r);const s=Ur.mm_to_px(e.paper.offsetHeight)-e.footer.offsetHeight;if(n.offsetBottom-s>=2){const o=this.splitTable(e,n,s),a=n.children.filter(u=>u.extra);return this.doc.insert(o,e.index+1),await Promise.allSettled(a.map(u=>u.onCreated())),await o.onCreated(),this.renderTableRow(e,n)}return n.rendering+=1,this.renderTableRow(e,n)}async renderTable(e,n){return await e.mountChild(n),this.renderTableRow(e,n)}async renderText(e,n){return n.extra&&n.isUndefinedValue&&await n.onCreated(),e.mountChild(n)}async defaultRender(e,n){return n.extra&&n.isUndefinedValue&&await n.onCreated(),e.mountChild(n)}}et=new WeakMap;function so(t){const e=Date.now(),n=Pt.create(t.define,t.state);return new io(t.container,n,t.data).render().then(()=>{n.state.renderTime=Date.now()-e}),n}const oo=mt({__name:"DocState",props:{state:{type:Object,required:!0}},setup(t){const e=t,n=Ae(()=>e.state.renderState===ge.READY),r=Ae(()=>e.state.renderState===ge.READY?"已就绪":e.state.renderState===ge.RENDERING?`正在生成(${e.state.total??0}页)...`:"正在生成...");return(i,s)=>(Be(),Xe("div",null,[s[0]||(s[0]=ue("span",null,"文档：",-1)),ue("span",{class:ie({[i.classes.finished]:n.value})},At(r.value),3)]))}}),ao="_finished_7h37m_2",uo={finished:ao},lo={classes:uo},co=qt(oo,[["__cssModules",lo]]),fo="_toolbar_3etac_1",ho="_button_3etac_9",po="_actived_3etac_33",mo="_divider_3etac_46",je={toolbar:fo,button:ho,actived:po,divider:mo},go=["viewMode","debug","space","print"],wo=mt({props:{doc:{type:Pt},buttons:{type:Array,required:!0}},setup(t){function e(){var u;(u=t.doc)==null||u.print()}function n(){var u;(u=t.doc)==null||u.toggleViewMode()}function r(){var l;const u={[je.button]:!0,[je.actived]:((l=t.doc)==null?void 0:l.state.viewMode)==="multiple"};return Z("button",{type:"button",title:"切换单页/多页视图",class:u,onClick:n},[Z(sn,{icon:"icon-multi-page"},null),Z("span",null,[Rt("多页")])])}function i(){return Z("button",{type:"button",class:je.button,onClick:e,title:"打印 Ctrl + P"},[Z(sn,{icon:"icon-printer"},null),Z("span",null,[Rt("打印")])])}function s(){return Z("div",{class:je.divider},null)}function o(){return Z("div",{class:"quickprint-is-fill-w"},null)}function a(u){if(typeof u=="function")return u(je,t.doc);switch(u){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return Z("div",{class:je.toolbar},[t.buttons.map(a)])}}});function vo(t){function e(i){const s=t.value;if(s!=null)switch(i.key){case"p":case"P":if(i.ctrlKey)return i.preventDefault(),s.print();case"Add":if(i.ctrlKey)return i.preventDefault(),s.zoomOut();case"Subtract":if(i.ctrlKey)return i.preventDefault(),s.zoomIn();case"0":if(i.ctrlKey)return i.preventDefault(),s.resetZoom();case"m":case"M":if(i.ctrlKey)return i.preventDefault(),s.toggleViewMode()}}function n(){window.addEventListener("keydown",e)}function r(){window.removeEventListener("keydown",e)}return{enable:n,disable:r}}const Eo={key:1,class:"quickprint-is-fill-w"},yo=mt({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return go}}},emits:["mock"],setup(t,{emit:e}){const n=t,r=er("classes"),i=Ot(),s=Ot(),o=tr({}),a=vo(s),u=Ae(()=>o.renderState===ge.READY),l=Ae(()=>{const g=o.renderTime??0;if(g<=6e4)return`${g/1e3}秒`;const N=Math.floor(g/1e3),D=N%60,C=(N-D)/60;return D==0?`${C}分`:`${C}分${D}秒`}),c=Ae(()=>o.total??"--"),f=Ae(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function E(){var g;(g=s.value)==null||g.zoomIn()}function d(){var g;(g=s.value)==null||g.zoomOut()}function O(g){var N,D;g.deltaY>0?(N=s.value)==null||N.zoomIn():(D=s.value)==null||D.zoomOut()}function m(){var g;(g=s.value)==null||g.toggleDebug()}async function h(){const g=so({container:i.value,define:rn.create(n.define),state:o,data:n.data});s.value=g,document.title=g?`${g.define.name} - OpenPrint`:"OpenPrint",await g.ready(),a.enable();const N=window.location.hostname;(N==="localhost"||N==="127.0.0.1")&&g.debug()}return ei(()=>{h()}),(g,N)=>{var D;return Be(),Xe("div",{class:ie(Q(r).preview),onWheel:ni(O,["ctrl","prevent"])},[ue("div",{class:ie([Q(Se).PRINT_HIDDEN,Q(r).header])},[ue("div",{class:ie(Q(r).headerLeft)},[Pn(g.$slots,"headerLeft")],2),Z(Q(wo),{doc:s.value,buttons:t.buttons},null,8,["doc","buttons"]),ue("div",{class:ie(Q(r).headerRight)},[Pn(g.$slots,"headerRight")],2)],2),ue("div",{class:ie(f.value),ref_key:"containerRef",ref:i},null,2),ue("div",{class:ie([Q(Se).PRINT_HIDDEN,Q(r).footer])},[Z(co,{state:o,class:ie(Q(r).status)},null,8,["state","class"]),u.value?(Be(),Xe(ti,{key:0},[ue("div",{class:ie(Q(r).status)},"用时："+At(l.value),3),N[0]||(N[0]=ue("div",{class:"quickprint-is-fill-w"},null,-1)),ue("button",{type:"button",class:ie({"quickprint-text-btn":!0,"quickprint-is-selected":(D=s.value)==null?void 0:D.state.debug}),title:"调试模式",onClick:m},[Z(Q(sn),{icon:"icon-bug"})],2),N[1]||(N[1]=ue("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ue("div",{class:ie(Q(r).divider)},null,2),ue("div",{class:ie(Q(r).status)},"第1页，共"+At(c.value)+"页",3),ue("div",{class:ie(Q(r).divider)},null,2)],64)):(Be(),Xe("div",Eo)),Z(Q(Br),{class:ie(Q(r).zoom),scale:o.scale,onZoomIn:E,onZoomOut:d},null,8,["class","scale"])],2)],34)}}}),No="_preview_1hc69_2",_o="_header_1hc69_13",Do="_headerLeft_1hc69_22",bo="_headerRight_1hc69_28",To="_body_1hc69_34",So="_footer_1hc69_53",Ao="_status_1hc69_73",Ro="_divider_1hc69_79",Oo="_zoom_1hc69_86",ko={preview:No,header:_o,headerLeft:Do,headerRight:bo,body:To,footer:So,status:Ao,divider:Ro,zoom:Oo},Mo={classes:ko},Po=qt(yo,[["__cssModules",Mo]]),xo=mt({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(t){const e=t,n=er("classes"),r=Yr(),i=Qn(e.local??[]),s=tr(e.ds.fields.map(l=>u(l))),o=[{label:"文本",value:pe.STRING},{label:"数字",value:pe.NUMBER},{label:"日期",value:pe.DATE},{label:"对象",value:pe.OBJECT},{label:"数组",value:pe.ARRAY}],a=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(l,c){var E;const f=l[c.name];return((E=o.find(d=>d.value===f))==null?void 0:E.label)??f}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(l,c){if(l.type===pe.OBJECT)return null;if(l.type===pe.ARRAY)return xn(Z("input",{type:"number","onUpdate:modelValue":E=>l.total=E,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[ii,l.total]]);const f=e.options.find(E=>E.classify===l.type);return f==null?null:xn(Z("select",{"onUpdate:modelValue":E=>l.func=E,class:n.select},[Z("option",{value:"",class:n.placeholder},[Rt("请选择")]),f.rules.map(E=>Z("option",{value:E.func,key:E.func},[E.name]))]),[[si,l.func]])}}];function u(l,c){const f=c?`${c}.${l.name}`:l.name,E=l.children?l.children.map(O=>u(O,l.name)):void 0,d=i[f];return{type:l.type,name:l.name,title:l.title,children:E,$expand:!0,func:(d==null?void 0:d.func)??"",total:d==null?void 0:d.total}}return r==null||r.useHandle("confirm",()=>ri(s)),(l,c)=>(Be(),Xe("div",{class:ie(Q(n).ds)},[Z(Q(Vr),{columns:a,data:s},null,8,["data"])],2))}}),Io="_ds_6a9ph_2",Lo="_placeholder_6a9ph_8",Co="_select_6a9ph_12",qo="_input_6a9ph_13",$o={ds:Io,placeholder:Lo,select:Co,input:qo},Fo={classes:$o},Ho=qt(xo,[["__cssModules",Fo]]);let Nt=null;const Zn=490;function br(){return Nt!=null?Promise.resolve(Nt):jr(()=>import("./mock-CpComRFX.js"),__vite__mapDeps([0,1,2,3])).then(t=>(Nt=t.default,Nt))}function Xn(t,e){switch(e){case pe.DATE:return t.randDate();case pe.NUMBER:return t.randDecimal();case pe.STRING:return t.randName();default:return null}}function Uo(t){if((t==null?void 0:t.total)==null)return Zn;const e=Number(t.total);return Number.isNaN(e)||!Number.isFinite(e)||e<=0?Zn:Math.round(e)}function en(t,e,n){if(n==null||tt(n.func))return Xn(t,e.type);const r=t[n.func];return typeof r!="function"?Xn(t,e.type):r(n)}const Bo=Gr(function(t,e,n){const r={ds:e,options:t.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:Wr.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return Zr("创建模拟数据",oi(Ho,r),i).promisify()});async function Kn(t,e){if(t==null)return[];const n=await br(),r=await Bo(n,t,e).catch(zr);return Array.isArray(r)?r:[]}async function _t(t,e){if(t==null||!Array.isArray(e)||e.length==0)return{};const n=await br(),r=Qn(e);return t.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===pe.OBJECT){const a=s.children??[];return i[s.name]=a.reduce((u,l)=>{if(tt(l.name))return u;const c=`${s.name}.${l.name}`;return u[l.name]=en(n,l,r[c]),u},{}),i}if(s.type===pe.ARRAY){const a=s.children??[],u=Uo(o),l=10+Math.round(Math.random()*u);return i[s.name]=Array(l).fill("").map(()=>a.reduce((c,f)=>{if(tt(f.name))return c;const E=`${s.name}.${f.name}`;return c[f.name]=en(n,f,r[E]),c},{})),i}return i[s.name]=en(n,s,o),i},{})}const Yo=mt({__name:"index",setup(t){const e={INIT:0,LOADED_CASE:1,LOADED_DATA:2,READY:3},n=Ot(),r=Ot(),i=jt(0),s=jt(!1),o=Ae(()=>{var h;return`${((h=n.value)==null?void 0:h.id)??Date.now()}-${i.value}`}),a=jt(e.INIT),u=Ae(()=>["viewMode","debug","space",s.value?d:null,"print"]),l=Ae(()=>a.value===e.INIT?"正在加载...":a.value===e.LOADED_CASE?"已加载模板，正在准备数据...":a.value===e.LOADED_DATA?"开始渲染模板":"");function c(){const h=new URLSearchParams(window.location.search).get("id");return fn(h)&&(h==="local"||Mn.some(g=>g.id===h))?h:Mn[0].id}async function f(m){var D,C,I,x;if(m==null)return{};if(m.data)return s.value=!1,m.data;const h=On(m.id);if(Array.isArray(h)&&h.length>0)return _t((D=m.define)==null?void 0:D.ds,h);const g=m.rules;if(Array.isArray(g)&&g.length>0)return _t((C=m.define)==null?void 0:C.ds,g);const N=await Kn((I=n.value)==null?void 0:I.ds);return kn(N,m.id),_t((x=m.define)==null?void 0:x.ds,N)}async function E(){if(n.value==null)return;const m=n.value.id;if(m==null||m=="")return;const h=On(m),g=await Kn(n.value.ds,h);kn(g,n.value.id),r.value=await _t(n.value.ds,g),i.value++}function d(m){return Z("button",{type:"button",class:m.button,onClick:E},[Z("span",null,[Rt("模拟数据")])])}async function O(){a.value=e.INIT,s.value=!0;const m=await Xr(c());n.value=(m==null?void 0:m.define)??{},a.value=e.LOADED_CASE,r.value=await f(m),a.value=e.LOADED_DATA,a.value=e.READY}return O(),(m,h)=>a.value<=e.LOADED_DATA?(Be(),Xe("div",{key:0,class:ie(m.classes.logs)},At(l.value),3)):(Be(),ai(Q(Po),{define:n.value,data:r.value,buttons:u.value,key:o.value,class:ie(m.classes.preview),onMock:E},null,8,["define","data","buttons","class"]))}}),Vo="_preview_17t3s_7",Go="_logs_17t3s_11",zo={preview:Vo,logs:Go},jo={classes:zo},Wo=qt(Yo,[["__cssModules",jo]]),Dn=ui(Wo),Zo=Kr();Dn.use(Jr,{zIndex:Zo});Dn.mount("#app");Qr(Dn._context);
