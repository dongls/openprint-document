const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-BzOvwT-C.js","assets/vue-B00pXJJQ.js","assets/component-wHisujg_.js","assets/utils-B3YDrDEo.js","assets/utils-DCW1KeBq.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Bo=Object.defineProperty;var ml=n=>{throw TypeError(n)};var $o=(n,e,t)=>e in n?Bo(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var H=(n,e,t)=>$o(n,typeof e!="symbol"?e+"":e,t),Mn=(n,e,t)=>e.has(n)||ml("Cannot "+t);var we=(n,e,t)=>(Mn(n,e,"read from private field"),t?t.call(n):e.get(n)),ze=(n,e,t)=>e.has(n)?ml("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),pt=(n,e,t,l)=>(Mn(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),Ce=(n,e,t)=>(Mn(n,e,"access private method"),t);import{D as ve,E as Et,N as jt,a as ht,b as j,c as Be,P as Zn,d as Jt,e as gl,f as hn,g as vn,O as Qt,h as ee,i as ln,j as bn,L as xe,I as F,_ as z,k as Ml,s as Tn,l as Po,m as oe,n as ql,p as yn,C as Le,o as Kn,q as Jn,U as Fn,r as pe,t as Vo,u as Qn,v as Bl,w as Ue,x as zn,y as Fo,z as zo,A as Uo,B as Ho,F as $l,V as Tt,G as _n,H as st,J as Pl,K as Vl,M as Fl,Q as he,R as tt,S as Go,T as Wo,W as Ne,X as at,Y as Oe,Z as wt,$ as Ye,a0 as Yo,a1 as Xo,a2 as jo,a3 as el,a4 as le,a5 as be,a6 as vt,a7 as cn,a8 as It,a9 as re,aa as bt,ab as Xe,ac as it,ad as Zo,ae as _e,af as tl,ag as nl,ah as ll,ai as Gt,aj as un,ak as Lt,al as Ko,am as Jo,an as Rt,ao as Ot,ap as Qo,aq as es,ar as ts,as as ns,at as ls,au as Vt,av as on,aw as hl,ax as os,ay as vl,az as me,aA as qn,aB as Bn,aC as ss,aD as is,aE as dn,aF as rs,aG as as,aH as cs,aI as us,aJ as bl,aK as ds,aL as fs}from"./utils-B3YDrDEo.js";import{r as ae,o as ol,d as V,c as N,a as S,n as m,b as u,e as p,f as Ke,u as ke,s as ue,g as Ie,h as I,w as te,i as y,j as K,k as G,T as zl,l as Z,m as kt,p as tn,q as Ul,F as J,t as se,v as X,x as Ft,y as yl,z as Hl,A as Gl,B as nn,C as sl,D as Se,E as Ee,G as Ae,H as ne,I as zt,J as ps,K as Wl,L as $n,M as je,N as ct,O as ms,P as gs,Q as hs,R as vs}from"./vue-B00pXJJQ.js";const Yl="@quickprint_drag_mode",Xl="@quickprint_drop_data",Sn="@quickprint_operate",Je="@quickprint_element",il="@quickprint_element_type",jl="@quickprint_resize_flag",St=160,Rn=32,Wt=[50,75,100,125,150,200,300,400];var Zt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Zt||{}),Nt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Nt||{});const Qe={SINGLE:0,MULTIPLE:1},De=Object.freeze({INSERT:0,MOVE:1}),rl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),Y=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),fe=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Zl=[{label:"固定值",value:ve.CONST},{label:"变量",value:ve.VARIABLE},{label:"公式",value:ve.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:ve.CODE,detail:"使用Javascript代码生成数据"}],bs=[{label:"显示",value:Et.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:Et.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:Et.CONDITION,detail:"元素只在满足指定条件后显示"}],ys=[{label:"四舍五入",value:jt.ROUND},{label:"向下舍入",value:jt.FLOOR},{label:"向上舍入",value:jt.CEIL},{label:"四舍六入",value:jt.BANKER_ROUND}],_s=[{label:"原始值",value:ht.NONE},{label:"固定位数",value:ht.FIXED},{label:"金额千位",value:ht.THOUSAND},{label:"金额万位",value:ht.TEN_THOUSAND},{label:"金额大写",value:ht.DAXIE},{label:"百分比",value:ht.PERCENTAGE}],Es=[{label:"显示",value:!0},{label:"隐藏",value:!1}],Ts=[{label:"默认",value:void 0},{label:"文本",value:j.TEXT},{label:"数字",value:j.NUMBER},{label:"日期",value:j.DATE}],ce={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Kl=[{label:"年-月",value:Be.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:Be.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:Be.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:Be.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:Be.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:Be.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:Be.TIME,detail:"示例：12:00:00"},{label:"时:分",value:Be.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:Be.YEAR,detail:"示例：2024"},{label:"月",value:Be.MONTH,detail:"示例：12"},{label:"日",value:Be.DAY,detail:"示例：01"}];Kl.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const Ss=[{label:"元素值",value:Zn.ELEMENT_VALUR}],Rs=[{label:"基于纸张",value:Jt.PAPER},{label:"基于内容",value:Jt.CONTENT}],Jl=[{label:"纵向",value:gl.PORTRAIT},{label:"横向",value:gl.LANDSCAPE}],ks=[{label:"当前位置",value:hn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:hn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],ws=[{label:"单次打印",value:vn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:vn.EACH,detail:"元素将每页打印一次"}],Cs=[{label:"按内容调整高度",value:Qt.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:Qt.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:Qt.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Un=[{label:"页码",value:ln.PAGE_NUMBER,type:ee.NUMBER},{label:"总页数",value:ln.PAGE_TOTAL,type:ee.NUMBER},{label:"行序号",value:ln.ROW_INDEX,type:ee.NUMBER},{label:"当前时间",value:ln.CURRENT_DATE,type:ee.DATE}],Ls=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function Ql(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Is(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function eo(n){return n.isSelected?n.type===j.PARAGRAPH?52:n.type===j.TABLE?32:20:20}function Ns(){const n=ae(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),ol(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class Os{constructor(e,t,l){H(this,"originalEvent");H(this,"target");H(this,"ghost");H(this,"container");H(this,"paths",[]);H(this,"dropTarget");H(this,"top",0);H(this,"left",0);H(this,"deltaX");H(this,"deltaY");H(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var qt,Bt,ut,to,no,lo;const _t=class _t extends bn{constructor(t={}){var l,o,s;super();ze(this,ut);H(this,"context",null);H(this,"selector");H(this,"scale");H(this,"onDragStart");ze(this,qt);ze(this,Bt);this.selector={container:((l=t.selector)==null?void 0:l.container)??Y.PAGE,element:((o=t.selector)==null?void 0:o.element)??Y.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??Y.DROPPABLE},this.onDragStart=Ce(this,ut,to).bind(this),this.scale=t.scale,pt(this,qt,Ce(this,ut,no).bind(this)),pt(this,Bt,Ce(this,ut,lo).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",we(this,qt)),window.removeEventListener("pointerup",we(this,Bt)),this.context=null)}};qt=new WeakMap,Bt=new WeakMap,ut=new WeakSet,to=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return xe.warn(_t.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=Ql(l,o);this.context=new Os(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return xe.warn(_t.TAG_NAME,"已取消拖拽");if(this.context.container==null)return xe.warn(_t.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return xe.warn(_t.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",we(this,qt)),window.addEventListener("pointerup",we(this,Bt))},no=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(a=>!(a===l.ghost||a===l.target||l.ghost.contains(a))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(a=>a.matches("."+Y.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},lo=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},H(_t,"TAG_NAME","quickprint-draggable");let Hn=_t;const Ds=["title"],xs=V({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(S(),N("span",{title:n.title,class:m(e.classes.help)},[u("span",null,[Ke(e.$slots,"default")]),p(F,{icon:"icon-question-circle"})],10,Ds))}}),As="_help_1l6l8_2",Ms={help:As},qs={classes:Ms},Bs=z(xs,[["__cssModules",qs]]),$s=V({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=ke("classes"),r=ae(!1),i=ue(),a=ue(),d=Ie({minWidth:0,top:0,left:0,visible:!1}),f=I(()=>({minWidth:l.width==null?d.minWidth+"px":l.width+"px",top:d.top+"px",left:d.left+"px",visibility:d.visible?"visible":"hidden",zIndex:Ml()}));async function g(){if(r.value)return v();l.disabled||(r.value=!0,o("show"),await Tn(),E())}function v(){D(),r.value=!1,o("close")}function _(C){if(!(C.target instanceof Node))return;const x=i.value;if(x&&x.contains(C.target))return C.preventDefault();const k=a.value;if(k&&k.contains(C.target))return C.preventDefault();v()}function b(){const C=i.value,x=a.value;if(x==null||C==null)return;const k=C.getBoundingClientRect(),w=x.getBoundingClientRect(),T=l.width==null?k.width:l.width;let O=k.bottom+1;O+w.height>window.innerHeight&&k.top>w.height&&(O=k.top-w.height-1);let A=k.left;A+w.width>window.innerWidth&&(A=window.innerWidth-w.width-2),d.minWidth=T,d.top=O,d.left=A,d.visible=!0}function c(C){const x=C.target;if(!(x instanceof HTMLElement))return;const k=i.value;k==null||!x.contains(k)||v()}function h(C){if(C.key!=="Escape")return;const x=a.value;if(x!=null){const k=x.style.zIndex;if(Number(k)<Po())return}C.preventDefault(),v()}function E(){window.addEventListener("click",_,{capture:!0}),window.addEventListener("contextmenu",v,{capture:!0}),window.addEventListener("scroll",c,{capture:!0,passive:!0}),window.addEventListener("resize",b),window.addEventListener("keydown",h)}function D(){window.removeEventListener("click",_,!0),window.removeEventListener("contextmenu",v,!0),window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",b),window.removeEventListener("keydown",h)}return e({close:v}),(C,x)=>(S(),N("div",{class:m(y(s).reference),onClick:te(g,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[Ke(C.$slots,"default"),r.value?(S(),K(zl,{key:0,to:"body"},[u("div",{class:m(y(s).popover),onVnodeMounted:b,onMousedown:x[0]||(x[0]=te(()=>{},["prevent"])),style:Z(f.value),ref_key:"popoverRef",ref:a},[Ke(C.$slots,"popover")],38)])):G("",!0)],2))}}),Ps="_reference_1arli_2",Vs="_popover_1arli_7",Fs={reference:Ps,popover:Vs},zs={classes:Fs},oo=z($s,[["__cssModules",zs]]),Us=["title","onKeydown"],Hs=["onMouseover","onClick"],Gs=V({__name:"Select",props:kt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:kt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=ke("classes"),s=ue(),r=ue(),i=tn(n,"modelValue"),a=ae(),d=ae(!1),f=Ie({width:0,top:0,left:0,visible:!1,scrollable:!1}),g=I(()=>l.teleport==="none"),v=I(()=>l.teleport=="none"?"body":l.teleport),_=I(()=>{const $={label:"",options:[]},U=[$];for(const W of l.options){if(Array.isArray(W.options)){U.push({label:W.label,options:W.options});continue}$.options.push(W)}return U}),b=I(()=>_.value.reduce(($,U)=>$.concat(U.options),[])),c=I(()=>{if(l.multiple!==!0){const U=xn();return U?U.label:l.button?l.title:oe(l.modelValue)?l.placeholder:l.modelValue}const $=An();return $.length>0?$.map(U=>U.label).join(","):l.button?l.title:l.placeholder}),h=I(()=>l.clearable!==!0?!1:l.modelValue!=null),E=I(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!h.value,[o.button]:l.button,[o.showClearIcon]:h.value,[o.text]:l.size==="text"})),D=I(()=>({width:l.width})),C=I(()=>f.visible?{width:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",top:f.top+"px",left:f.left+"px",visibility:"visible",zIndex:Ml()}:{minWidth:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",visibility:"hidden"}),x=I(()=>({[o.content]:!0,[o.placeholder]:ql(l.modelValue)}));async function k(){if(l.disabled)return;const $=b.value;if($.length===0)return;if(d.value)return w();const U=s.value;U!=null&&(f.width=U.getBoundingClientRect().width,f.visible=!1,a.value=$.find(W=>W.value===l.modelValue),d.value=!0,await Tn(),Mo())}function w(){qo(),d.value=!1}function T($){R(),ft()}function O($){$.disabled!==!0&&(a.value=$)}function A($){if(l.disabled==!0||$.disabled===!0)return;if(l.multiple!==!0){i.value=$.value,t("select",$),w();return}const U=Array.isArray(i.value)?i.value:[],W=U.findIndex(de=>de===$.value);W>=0?U.splice(W,1):U.push($.value),i.value=U,t("select",U)}function B($){if(!($.target instanceof Node))return;const U=s.value;if(U&&U.contains($.target))return $.preventDefault();const W=r.value;if(W&&W.contains($.target))return $.preventDefault();w()}async function R(){const $=s.value,U=r.value;if(U==null||$==null)return;await Ft();const W=$.getBoundingClientRect(),de=U.getBoundingClientRect();let ge=W.bottom+1;ge+de.height>window.innerHeight&&W.top>de.height&&(ge=W.top-de.height-1);let Ct=W.left;Ct+de.width>window.innerWidth&&(Ct=window.innerWidth-de.width-2),f.width=de.width,f.top=ge,f.left=Ct,f.visible=!0;const Ht=U.querySelector("."+o.list);f.scrollable=Ht?Ht.scrollHeight>Ht.clientHeight:!1}function L($){const U=$.target;if(!(U instanceof HTMLElement))return;const W=s.value;W==null||!U.contains(W)||w()}function M(){const $=b.value,U=yl(a.value);if(U==null){a.value=qe(0),ft();return}const W=$.indexOf(U);if(W==0)return ye();const de=qe(W-1);de!=null&&(a.value=de,ft())}function P(){const $=b.value,U=yl(a.value);if(U==null){a.value=Ve(0),ft();return}const W=$.indexOf(U);if(W>=$.length-1){q();return}const de=qe(W+1);de!=null&&(a.value=de,ft())}function q(){a.value=Ve(0),ft()}function ye(){const $=b.value;a.value=qe($.length-1),ft()}function ie(){i.value=void 0,w()}function Ve($){const W=b.value[$];return W==null?null:W.disabled===!0?Ve($+1):W}function qe($){const W=b.value[$];return W==null?null:W.disabled===!0?qe($-1):W}function nt($){switch($.key){case"Enter":$.preventDefault(),a.value&&A(a.value);return;case"Escape":$.preventDefault(),w();return;case"ArrowUp":$.preventDefault(),M();return;case"ArrowDown":$.preventDefault(),P();return;case"Home":$.preventDefault(),q();return;case"End":$.preventDefault(),ye();return}}function xo($){if(l.disabled)return;const U=s.value;U!=null&&document.activeElement===U&&(d.value||($.stopPropagation(),k()))}function Ao($){if(l.multiple!==!0)return l.modelValue===$.value;const U=l.modelValue;return Array.isArray(U)?U.includes($.value):!1}async function ft(){if(a.value==null)return;await Ft();const $=r.value;if($==null)return;const U=$.querySelector("."+o.hover);U&&U.scrollIntoView({block:"nearest"})}function xn(){const $=b.value,U=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return $.find(W=>W.value===U)}function An(){const $=b.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(W=>W).map(W=>{const de=$.find(ge=>ge.value===W);return de||{value:W,label:W}})}function Mo(){window.addEventListener("mousedown",B,{capture:!0}),window.addEventListener("pointerdown",B,{capture:!0}),window.addEventListener("contextmenu",w,{capture:!0}),window.addEventListener("scroll",L,{capture:!0,passive:!0}),window.addEventListener("resize",R),window.addEventListener("keydown",nt)}function qo(){window.removeEventListener("mousedown",B,!0),window.removeEventListener("pointerdown",B,!0),window.removeEventListener("contextmenu",w,!0),window.removeEventListener("scroll",L,!0),window.removeEventListener("resize",R),window.removeEventListener("keydown",nt)}return($,U)=>{var W;return S(),N("div",{class:m(E.value),title:n.title,style:Z(D.value),onClick:te(k,["stop"]),onKeydown:Ul(te(xo,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[$.$slots.selected?Ke($.$slots,"selected",{key:0,option:xn(),options:An()}):Ke($.$slots,"option",{key:1,option:xn(),options:An()},()=>[u("div",{class:m(x.value)},[u("span",null,X(c.value),1),h.value?(S(),K(F,{key:0,icon:"icon-close",onClick:te(ie,["stop"]),size:"12px",class:m(y(o).clearIcon)},null,8,["class"])):G("",!0)],2)]),d.value?(S(),K(zl,{key:2,to:v.value,disabled:g.value},[u("div",{class:m(y(o).popover),onClick:U[0]||(U[0]=te(()=>{},["stop"])),onVnodeMounted:T,onMousedown:U[1]||(U[1]=te(()=>{},["prevent"])),style:Z(C.value),ref_key:"popoverRef",ref:r},[u("div",{class:m(y(o).list)},[(S(!0),N(J,null,se(_.value,de=>(S(),N(J,null,[de.label?(S(),N("div",{key:0,class:m(y(o).groupLabel)},X(de.label),3)):G("",!0),(S(!0),N(J,null,se(de.options,ge=>{var Ct;return S(),N("div",{key:ge.value,class:m({[y(o).option]:!0,[y(o).disabled]:ge.disabled===!0,[y(o).selected]:Ao(ge),[y(o).hover]:((Ct=a.value)==null?void 0:Ct.value)==ge.value}),style:Z(ge.style),onMouseover:Ht=>O(ge),onClick:Ht=>A(ge)},[Ke($.$slots,"option",{option:ge},()=>[u("div",{class:m(y(o).label)},[ge.icon?(S(),K(F,{key:0,icon:ge.icon,class:m(y(o).icon)},null,8,["icon","class"])):G("",!0),u("span",null,X(ge.label),1)],2),ge.short?(S(),N("div",{key:0,class:m(y(o).short)},X(ge.short),3)):G("",!0)])],46,Hs)}),128))],64))),256))],2),(W=a.value)!=null&&W.detail&&f.visible?(S(),N("div",{key:0,class:m(y(o).detail)},X(a.value.detail),3)):G("",!0)],38)],8,["to","disabled"])):G("",!0)],46,Us)}}}),Ws="_button_g23yb_2",Ys="_select_g23yb_7",Xs="_appearance_g23yb_16",js="_content_g23yb_31",Zs="_placeholder_g23yb_37",Ks="_popover_g23yb_41",Js="_list_g23yb_51",Qs="_option_g23yb_80",ei="_label_g23yb_95",ti="_icon_g23yb_102",ni="_hover_g23yb_106",li="_detail_g23yb_117",oi="_short_g23yb_127",si="_selected_g23yb_133",ii="_disabled_g23yb_137",ri="_showClearIcon_g23yb_142",ai="_clearIcon_g23yb_146",ci="_text_g23yb_159",ui="_mini_g23yb_171",di="_groupLabel_g23yb_183",fi={button:Ws,select:Ys,appearance:Xs,content:js,placeholder:Zs,popover:Ks,list:Js,option:Qs,label:ei,icon:ti,hover:ni,detail:li,short:oi,selected:si,disabled:ii,showClearIcon:ri,clearIcon:ai,text:ci,mini:ui,groupLabel:di},pi={classes:fi},Q=z(Gs,[["__cssModules",pi]]),mi="_tree_1p28f_1",gi="_node_1p28f_5",hi="_content_1p28f_11",vi="_space_1p28f_27",bi="_expand_1p28f_28",yi="_active_1p28f_47",_i="_children_1p28f_55",lt={tree:mi,node:gi,content:hi,space:vi,expand:bi,active:yi,children:_i},so=Symbol(),io=V({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Hl(so),l=I(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=I({get(){const c=t==null?void 0:t.state[n.node.value];return c==null?!1:c.expand},set(c){const h=t==null?void 0:t.state[n.node.value];h!=null&&(h.expand=c)}});function s(c){c.preventDefault(),o.value=!o.value}function r(){if(!l.value)return p("div",{class:lt.space},null);const c={[lt.expand]:!0,[lt.active]:o.value};return p("div",{onMousedown:b,onClick:s,class:c},[p(F,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function a(){return p("div",{class:lt.content,onClick:f,onMouseenter:v},[i()])}function d(){if(!l.value||!o.value)return;const c=n.node.children.map(h=>p(io,{node:h,onNodeClick:g,onNodeHover:_},null));return p("div",{class:lt.children},[c])}function f(){e("nodeClick",n.node)}function g(c){e("nodeClick",c)}function v(){e("nodeHover",n.node)}function _(c){e("nodeHover",c)}function b(c){c.preventDefault()}return function(){return p("div",{class:lt.subTree},[p("div",{class:lt.node},[r(),a()]),d()])}}}),Ei=V({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(a){t("nodeClick",a)}function s(a){t("nodeHover",a)}function r(){const a=Ie({}),d=function(f,g){for(const v of f)g[v.value]={expand:v.expand!==!1},v.children&&d(v.children,g)};return d(n.data,a),a}function i(a){return typeof e.default=="function"?e.default(a):null}return Gl(so,{state:l,content:i}),function(){const a=n.data.map(d=>p(io,{node:d,onNodeClick:o,onNodeHover:s},null));return p("div",{class:lt.tree},[a])}}});function sn(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const Pn={A:10,B:11,C:12,D:13,E:14,F:15},_l={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function Ti(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function Si(n){return typeof n=="string"&&n.includes("%")}function At(n,e){Ti(n)&&(n="100%");const t=Si(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function mt(n){return n.length===2?(Pn[n[0].toUpperCase()]||+n[0])*16+(Pn[n[1].toUpperCase()]||+n[1]):Pn[n[1].toUpperCase()]||+n[1]}function El(n,e,t){n=At(n,255),e=At(e,255),t=At(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,a=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:a*100,v:r*100}}const Ri=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},ki=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function Vn(n,e,t){n=At(n,360)*6,e=At(e,100),t=At(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),a=l%6,d=[t,r,s,s,i,t][a],f=[i,t,t,r,s,s][a],g=[s,s,i,t,t,r][a];return{r:Math.round(d*255),g:Math.round(f*255),b:Math.round(g*255)}}function fn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${_l[e]||e}${_l[t]||t}`}function wi({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${fn(n)}${fn(e)}${fn(t)}`}class kn{constructor(e){H(this,"h",0);H(this,"s",100);H(this,"v",100);H(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=sn(e)}setSaturation(e){this.s=sn(e)}setValue(e){this.v=sn(e)}setAlpha(e){this.a=sn(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=mt(t[0]+t[0]),o=mt(t[1]+t[1]),s=mt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=mt(t.slice(0,2)),o=mt(t.slice(2,4)),s=mt(t.slice(4,6))),t.length===8&&(r=mt(t.slice(6))/255*100);const{h:i,s:a,v:d}=El(l,o,s);return{h:i,s:a,v:d,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=El(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Ri(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=ki(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${wi(Vn(this.h,this.s,this.v))}${fn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=Vn(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return Vn(this.h,this.s,this.v)}}function ro(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let f=r.clientX-i.left-e.offsetX;return f<-d&&(f=-d),f>i.width-d&&(f=i.width-d),f}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,a=r.currentTarget;origin==null||i==null||(e.container=a,e.target=i===a?i.firstElementChild:i,e.offsetX=i===a?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function Ci(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().width/2;let g=i.clientX-a.left-e.offsetX;return g<-f&&(g=-f),g>a.width-f&&(g=a.width-f),g}function l(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().height/2;let g=i.clientY-a.top-e.offsetY;return g<-f&&(g=-f),g>a.height-f&&(g=a.height-f),g}function o(i){i.stopPropagation(),i.preventDefault();const a=i.target,d=i.currentTarget;origin==null||a==null||(e.container=d,e.target=a===d?a.firstElementChild:a,e.offsetX=a===d?e.target.offsetWidth/2:i.clientX-a.getBoundingClientRect().left,e.offsetY=a===d?e.target.offsetHeight/2:i.clientY-a.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const a=t(i),d=l(i);e.target.style.left=a+"px",e.target.style.top=d+"px",n("move",{left:a,top:d})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const a=t(i),d=l(i);n("end",{top:d,left:a})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const Li=V({__name:"SvPanel",props:{modelValue:{type:kn,required:!0}},setup(n){const e=n,t=ue(),l=ue(),o=Ie(i()),s=I(()=>({left:o.left+"px",top:o.top+"px"})),r=Ci((a,d)=>{a=="end"&&(o.top=d.top,o.left=d.left);const f=t.value,g=l.value,v=(d.left+g.offsetWidth/2)/f.offsetWidth*100,_=100-(d.top+g.offsetHeight)/f.offsetHeight*100;e.modelValue.setSaturation(v),e.modelValue.setValue(_)});function i(){const a=t.value,d=l.value;if(a==null||d==null)return{top:-6,left:-6};const f=e.modelValue.s,v=(100-e.modelValue.v)/100*a.offsetHeight,_=f/100*a.offsetWidth;return{top:v-d.offsetHeight/2,left:_-d.offsetWidth/2}}return nn(()=>{const a=i();o.top=a.top,o.left=a.left}),(a,d)=>(S(),N("div",{class:m(a.classes.svPanel),onPointerdown:d[0]||(d[0]=(...f)=>y(r)&&y(r)(...f)),ref_key:"svPanelRef",ref:t},[u("div",{class:m(a.classes.thumb),style:Z(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Ii="_svPanel_1sv6o_2",Ni="_thumb_1sv6o_10",Oi={svPanel:Ii,thumb:Ni},Di={classes:Oi},xi=z(Li,[["__cssModules",Di]]),Ai=V({__name:"HueSlider",props:{modelValue:{type:kn,required:!0}},setup(n){const e=n,t=ae(-6),l=ue(),o=ue(),s=ro((i,a)=>{i=="end"&&(t.value=a);const d=l.value,f=o.value,g=Math.round((a+f.offsetWidth/2)/d.offsetWidth*360);e.modelValue.setHue(g)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const d=e.modelValue.h;return Math.round(d/360*i.offsetWidth)-a.offsetWidth/2}return nn(()=>{t.value=r()}),(i,a)=>(S(),N("div",{class:m(i.classes.hue),onPointerdown:a[0]||(a[0]=(...d)=>y(s)&&y(s)(...d)),ref_key:"hueRef",ref:l},[u("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Mi="_hue_1ozoc_2",qi="_thumb_1ozoc_10",Bi={hue:Mi,thumb:qi},$i={classes:Bi},Pi=z(Ai,[["__cssModules",$i]]),Vi=V({__name:"AlphaSlider",props:{modelValue:{type:kn,required:!0}},setup(n){const e=n,t=ae(-6),l=ue(),o=ue(),s=ro((i,a)=>{i=="end"&&(t.value=a);const d=l.value,f=o.value,g=Math.round((a+f.offsetWidth/2)/d.offsetWidth*100);e.modelValue.setAlpha(g)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const d=e.modelValue.a;return Math.round(d/100*i.offsetWidth)-a.offsetWidth/2}return nn(()=>{t.value=r()}),(i,a)=>(S(),N("div",{class:m(i.classes.alpha),onPointerdown:a[0]||(a[0]=(...d)=>y(s)&&y(s)(...d)),ref_key:"alphaRef",ref:l},[u("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Fi="_alpha_1x8jd_2",zi="_thumb_1x8jd_26",Ui={alpha:Fi,thumb:zi},Hi={classes:Ui},Gi=z(Vi,[["__cssModules",Hi]]),Wi=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function Yi(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function Xi(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const Tl={isSupport:Yi,open:Xi},ji=["title","onClick"],Zi=["title","onClick"],Sl="quickprint-recent-use-colors",Ki=V({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=ae(new kn(l.modelValue)),r=ue(),i=ue(),a=ae(D()),d=Tl.isSupport(),f=ae("hex"),g=I(()=>{const k=l.modelValue;return k?{backgroundColor:k}:null}),v=I(()=>{const k=s.value,{r:w,g:T,b:O}=k.rgb();return{"--hue-channel-color":`hsl(${k.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${w}, ${T}, ${O}, 0)`,"--alpha-channel-color-b":`rgba(${w}, ${T}, ${O}, 1)`}}),_=I({get(){return s.value.toString(f.value)},set(k){s.value.setColor(k)}});function b(){var k;(k=r.value)==null||k.close()}function c(k){k!=null&&(t("update:modelValue",k),t("select",k),C(k),b())}function h(){t("update:modelValue",void 0),t("select",void 0),b()}function E(){Tl.open().then(k=>c(k))}function D(){const k=localStorage.getItem(Sl);if(k==null||k=="")return[];const w=yn(k);return w==null?[]:Array.isArray(w)?w:[]}function C(k){const w=a.value,T=w.indexOf(k);T>=0&&w.splice(T,1),w.length>10&&w.pop(),w.unshift(k),localStorage.setItem(Sl,JSON.stringify(w))}function x(){t("update:modelValue",s.value.toString(f.value)),t("select",s.value.toString(f.value)),b()}return sl(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(k,w)=>(S(),K(oo,{class:m(k.classes.colorPicker),onMousedown:w[7]||(w[7]=te(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:Se(()=>[u("div",{class:m(k.classes.colorPickerPanel)},[u("div",{class:m(k.classes.presetPanel)},[u("div",{class:m(k.classes.presetTools)},[u("button",{type:"button",class:m(k.classes.clearBtn),onClick:h},[u("span",{class:m(k.classes.none)},null,2),w[8]||(w[8]=u("span",null,"无颜色",-1))],2),y(d)?(S(),N("button",{key:0,type:"button",class:m(k.classes.indicator),onClick:E},[p(F,{icon:"icon-eye-dropper"}),w[9]||(w[9]=u("span",null,"拾色器",-1))],2)):G("",!0)],2),u("div",{class:m(k.classes.colourAtla)},[(S(!0),N(J,null,se(y(Wi),T=>(S(),N("div",{style:Z({backgroundColor:T}),title:T,class:m(k.classes.color),onClick:O=>c(T)},null,14,ji))),256))],2),u("div",{class:m(k.classes.recentColors)},"最近使用",2),u("div",{class:m(k.classes.colourAtla)},[(S(),N(J,null,se(10,T=>u("div",{key:T,title:a.value[T-1],style:Z({backgroundColor:a.value[T-1]}),class:m(k.classes.color),onClick:O=>c(a.value[T-1])},null,14,Zi)),64))],2)],2),u("div",{class:m(k.pacls.panel),style:Z(v.value)},[p(xi,{class:m(k.pacls.sv),modelValue:s.value,"onUpdate:modelValue":w[1]||(w[1]=T=>s.value=T)},null,8,["class","modelValue"]),u("div",{class:m(k.pacls.sliders)},[p(Pi,{class:m(k.pacls.hua),modelValue:s.value,"onUpdate:modelValue":w[2]||(w[2]=T=>s.value=T)},null,8,["class","modelValue"]),p(Gi,{modelValue:s.value,"onUpdate:modelValue":w[3]||(w[3]=T=>s.value=T)},null,8,["modelValue"]),u("div",{class:m(k.pacls.preview)},[u("div",{class:m(k.pacls.previewColor),style:Z({backgroundColor:s.value.toRGB()})},null,6)],2)],2),u("div",{class:m(k.pacls.tools)},[p(Q,{options:o,teleport:"none",modelValue:f.value,"onUpdate:modelValue":w[4]||(w[4]=T=>f.value=T),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Ee(u("input",{type:"text","onUpdate:modelValue":w[5]||(w[5]=T=>_.value=T),onMousedown:w[6]||(w[6]=te(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Ae,_.value]]),u("button",{type:"button",class:m(k.pacls.confirm),onClick:x},"确定",2)],2)],6)],2)]),default:Se(()=>[u("div",{class:m({[k.classes.colorPickerInput]:!0,[k.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[Ke(k.$slots,"default",{},()=>[u("span",{class:m(k.classes.colorBlock),style:Z(g.value)},null,6)]),n.showText?(S(),N("div",{key:0,class:m(k.classes.colorValue),onClick:w[0]||(w[0]=te(()=>{},["stop"]))},X(n.modelValue),3)):G("",!0)],2)]),_:3},8,["class","disabled"]))}}),Ji="_colorPicker_1egpm_2",Qi="_disabled_1egpm_6",er="_colorPickerInput_1egpm_10",tr="_colorBlock_1egpm_17",nr="_colorValue_1egpm_26",lr="_colorPickerPanel_1egpm_31",or="_presetPanel_1egpm_45",sr="_colourAtla_1egpm_49",ir="_color_1egpm_2",rr="_presetTools_1egpm_76",ar="_clearBtn_1egpm_82",cr="_indicator_1egpm_83",ur="_none_1egpm_101",dr="_recentColors_1egpm_132",fr={colorPicker:Ji,disabled:Qi,colorPickerInput:er,colorBlock:tr,colorValue:nr,colorPickerPanel:lr,presetPanel:or,colourAtla:sr,color:ir,presetTools:rr,clearBtn:ar,indicator:cr,none:ur,recentColors:dr},pr="_panel_911zv_2",mr="_sv_911zv_7",gr="_hua_911zv_11",hr="_sliders_911zv_15",vr="_tools_911zv_20",br="_confirm_911zv_37 quickprint-text-btn",yr="_preview_911zv_44",_r="_previewColor_911zv_59",Er={panel:pr,sv:mr,hua:gr,sliders:hr,tools:vr,confirm:br,preview:yr,previewColor:_r},Tr={classes:fr,pacls:Er},Mt=z(Ki,[["__cssModules",Tr]]),Sr=V({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=I({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=I(()=>{const i=l.modelValue;return ql(i)||i===Le.INHERIT});function r(i){t("select",i)}return(i,a)=>(S(),K(Mt,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=d=>o.value=d),disabled:n.disabled,onSelect:r},{default:Se(()=>[u("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[u("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:Z({backgroundColor:o.value})},null,6),u("div",{class:m(i.classes.colorValue)},X(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),Rr="_indicator_14ypk_2",kr="_disabled_14ypk_8",wr="_colorBlock_14ypk_27",Cr="_colorValue_14ypk_38",Lr="_colorNone_14ypk_45",Ir={indicator:Rr,disabled:kr,colorBlock:wr,colorValue:Cr,colorNone:Lr},Nr={classes:Ir},pn=z(Sr,[["__cssModules",Nr]]);function Or(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function Dr(n,e=0){let t=0,l=null;return function(...o){const s=Date.now();if(s-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,o),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,o),t=s}}function ao(n,e={}){const t={},l=n.style??{},o=Qn(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=Bl(l);return s&&Ue(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),Ar("border",e)&&Ue(t,zn(n)),Ue(t,Fo(n)),Ue(t,zo(n)),Ue(t,Uo(n)),Ue(t,Ho(n)),t}function xr(n,e={}){const t=[];let l=n;for(;pe.isDefineElement(l);)t.unshift(ao(l,e)),l=l.parent;return Vo({},...t)}function Ar(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const yt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(yt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(yt.SPACE).filter(o=>Kn(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(yt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(yt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(yt.SPACE))}};function Ze(n){if(oe(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em|%)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=Jn(t)?t:null,o=oe(e[2])?null:e[2];return{num:l,unit:o}}function Gn(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=Ze(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return Fn.pt_to_px(e.num);case"mm":return Fn.mm_to_px(e.num);default:return null}}function al(n,e){const t=n.ds;if(t!=null)return t.type===ve.FORMULA?{type:t.type,content:cl(t.value,n.doc)}:t.type===ve.VARIABLE?{type:t.type,content:et(t.value,e)}:{type:t.type,content:t.value}}function et(n,e){var v,_,b;if(oe(n))return n;const t=$l(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===Tt.BUILTIN)return((v=Un.find(c=>c.value===s))==null?void 0:v.label)??s;if(t.varType===Tt.SPECIAL)return((_=Ss.find(c=>c.value===s))==null?void 0:_.label)??s;if(e==null)return l;const i=(e.fields??[]).find(c=>c.name===s);if(i==null)return l;const a=o[1],d=oe(i.title)?i.name:i.title;if(a==null)return d;const f=(b=i.children)==null?void 0:b.find(c=>c.name===a);if(f==null)return`${d}.${a}`;const g=oe(f.title)?f.name:f.title;return`${d}.${g}`}function cl(n,e){return oe(n)?void 0:_n.tokenize(n).map(o=>o.type===st.VARIABLE?`[${et(o.value,e==null?void 0:e.ds)}]`:o.type===st.REFERENCE?`[${co(o.value,e)}]`:o.type===st.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===st.VARIABLE?`[${et(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):_n.formatTokenValue(o)).join("")}function co(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===ve.VARIABLE&&t.ds.value?et(t.ds.value,e.ds):"="+n}function Mr(n){switch($l(n).dataType){case ee.OBJECT:return"对象";case ee.ARRAY:return"数组";case ee.STRING:return"文本";case ee.NUMBER:return"数字";case ee.DATE:return"日期";case ee.BOOLEAN:return"布尔";default:return"未知类型"}}function qr(n){var e;return((e=Zl.find(t=>t.value===n))==null?void 0:e.label)??n}const uo=Pl(()=>Vl(()=>import("./component-BzOvwT-C.js"),__vite__mapDeps([0,1]))),Br=["onClick","onMouseenter"],$r=V({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=ae(Un[0].value),o=I(()=>`builtin_${Fl(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,a)=>(S(),N("div",{class:m(i.classes.builtin)},[u("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(S(!0),N(J,null,se(y(Un),d=>(S(),N("div",{class:m({[i.classes.param]:!0,[i.classes.active]:d.value===l.value}),onClick:f=>s(d),onMouseenter:f=>r(d)},[u("strong",null,X(d.label),1),u("span",null,X(d.value),1)],42,Br))),256))],2),u("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[p(y(uo),{name:o.value},null,8,["name"])],2)],2))}}),Pr="_builtin_m1n0z_2",Vr="_panel_m1n0z_11",Fr="_desc_m1n0z_17",zr="_param_m1n0z_24",Ur="_active_m1n0z_34",Hr={builtin:Pr,panel:Vr,desc:Fr,param:zr,active:Ur},Gr={classes:Hr},Wr=z($r,[["__cssModules",Gr]]),Rl=[{label:"文本",value:ee.STRING},{label:"数字",value:ee.NUMBER},{label:"日期",value:ee.DATE},{label:"对象",value:ee.OBJECT},{label:"数组",value:ee.ARRAY}],Yr=V({emit:["select"],props:{doc:{type:he,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=ke("classes"),o=tt(),s=a(),r=i();function i(){const h=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(E,D,C){var x;if(n.readonly){const k=E[D.name],w=((x=Rl.find(T=>T.value===k))==null?void 0:x.label)??k;return p("div",{class:C.classes.cell},[w])}return p("div",{class:C.classes.cell},[p(Q,{options:Rl,modelValue:E.type,"onUpdate:modelValue":_.bind(null,E),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(E,D,C){return n.readonly?p("div",{class:C.classes.cell},[E[D.name]]):p("div",{class:C.classes.cell},[Ee(p("input",{"onUpdate:modelValue":x=>E.name=x,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Ae,E.name]])])}},{name:"title",title:"标题",width:180,render(E,D,C){return n.readonly?p("div",{class:C.classes.cell},[E[D.name]]):p("div",{class:C.classes.cell},[Ee(p("input",{"onUpdate:modelValue":x=>E.title=x,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Ae,E.title]])])}}];return n.readonly!==!0&&h.push({name:"operate",title:"操作",width:200,render(E,D,C){const x=[p("button",{type:"button",class:"quickprint-text-btn",onClick:f.bind(null,E,C.parent)},[p(F,{icon:"icon-subnode"},null),p("span",null,[ne("插入行")])])];return(E.type===ee.ARRAY||E.type===ee.OBJECT)&&x.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:v.bind(null,E)},[p(F,{icon:"icon-sisternode"},null),p("span",null,[ne("插入子级")])])),x.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:g.bind(null,E,C.parent)},[p(F,{icon:"icon-delete"},null),p("span",null,[ne("删除")])])),x}}),h}function a(){const h=Go(n.doc.ds.fields??[]).map(D=>{const C=D.type;return{...D,$expand:C===ee.ARRAY||C===ee.OBJECT}}),E=ae(h);return E.value.length==0&&E.value.push(d()),E}function d(){return{type:ee.STRING,name:"",title:""}}function f(h,E){if(E){const C=E.children??[],x=C.indexOf(h);x>=0&&C.splice(x+1,0,d());return}const D=s.value.indexOf(h);D>=0&&s.value.splice(D+1,0,d())}function g(h,E){if(E){const C=E.children??[],x=C.indexOf(h);x>=0&&C.splice(x,1);return}const D=s.value.indexOf(h);D>=0&&s.value.splice(D,1),s.value.length==0&&s.value.push(d())}function v(h){h.type!==ee.ARRAY&&h.type!==ee.OBJECT||(h.children==null&&(h.children=[]),h.children.push(d()))}function _(h,E){h.type=E,E===ee.ARRAY||E===ee.OBJECT?h.$expand=!0:h.children=void 0}function b(){return{fields:s.value.map(E=>oe(E.name)?null:E.type!==ee.ARRAY&&E.type!==ee.OBJECT?{type:E.type,name:E.name,title:E.title}:{type:E.type,name:E.name,title:E.title,children:(E.children??[]).map(D=>oe(E.name)?null:{type:D.type,name:D.name,title:D.title}).filter(D=>D!=null)}).filter(E=>E!=null)}}function c(h,E){n.readonly===!0&&t("select",h,E)}return o==null||o.useHandle("confirm",b),e({submit:b}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(Wo,{columns:r,data:s.value,onSelect:c},null)])}}}),Xr="_form_6lybl_2",jr="_readonly_6lybl_6",Zr="_datasource_6lybl_11",Kr={form:Xr,readonly:jr,datasource:Zr},Jr={classes:Kr},fo=z(Yr,[["__cssModules",Jr]]),Qr={class:"quickprint-config-group"},ea={class:"quickprint-config-section quickprint-config-inline"},ta={class:"quickprint-config-content"},na={class:"quickprint-config-section quickprint-config-inline"},la={class:"quickprint-config-content"},oa={class:"quickprint-config-id"},sa={class:"quickprint-config-section quickprint-config-inline"},ia={class:"quickprint-config-content"},ra={class:"quickprint-config-group"},aa={class:"quickprint-config-group-title"},ca=V({__name:"Detail",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=I(()=>{var l,o;return(o=al(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:o.content});return(l,o)=>(S(),N("div",{class:m(l.classes.detail)},[u("div",Qr,[u("section",ea,[o[0]||(o[0]=u("header",{class:"quickprint-config-header"},"类型",-1)),u("div",ta,X(y(en)(n.element.type)),1)]),u("section",na,[o[1]||(o[1]=u("header",{class:"quickprint-config-header"},"标识",-1)),u("div",la,[u("span",oa,X(n.element.id),1)])]),u("section",sa,[o[2]||(o[2]=u("header",{class:"quickprint-config-header"},"标题",-1)),u("div",ia,X(n.element.title),1)])]),u("div",ra,[u("div",aa,[o[3]||(o[3]=u("span",null,"数据",-1)),u("span",{class:m(l.classes.type)},X(y(qr)(n.element.ds.type)),3)]),u("div",null,X(t.value),1)])],2))}}),ua="_detail_11ox4_2",da="_type_11ox4_10",fa={detail:ua,type:da},pa={classes:fa},ma=z(ca,[["__cssModules",pa]]),ga=V({__name:"index",props:{doc:{type:he,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=ae();function r(v){return v.reduce((_,b)=>{const c=Array.isArray(b.children)?r(b.children):[];if(Kn(b.ds.value)||c.length>0){const h={value:b.id,label:b.title??b.id,data:b,children:c};return _.push(h),_}return _},[])}function i(){const v=l.doc.pages.reduce((b,c)=>b.concat(c.children),[]),_=r(v);return ae(_)}function a(v){s.value=v}function d(v){return v.title?v.title:en(v.type)}function f(v){return tp(v.type)??"icon-zhanweifu"}function g(v){t("select",v.data)}return(v,_)=>(S(),N("div",{class:m(v.classes.reference)},[u("div",{class:m([v.classes.panel,"quickprint-is-scrollable"])},[p(y(Ei),{data:y(o),onNodeHover:a,onNodeClick:g},{default:Se(({node:b})=>[p(y(F),{icon:f(b.data)},null,8,["icon"]),u("span",{class:m(v.classes.title)},X(d(b.data)),3),u("span",{class:m(v.classes.id)},"<"+X(b.value)+">",3)]),_:1},8,["data"])],2),u("div",{class:m([v.classes.detail,"quickprint-is-scrollable"])},[s.value?(S(),K(ma,{element:s.value.data,key:s.value.value},null,8,["element"])):G("",!0)],2)],2))}}),ha="_reference_1ekkx_2",va="_panel_1ekkx_12",ba="_detail_1ekkx_20",ya="_title_1ekkx_25",_a="_id_1ekkx_29",Ea={reference:ha,panel:va,detail:ba,title:ya,id:_a},Ta={classes:Ea},Sa=z(ga,[["__cssModules",Ta]]),Ra=V({__name:"index",props:{doc:{type:he,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=tt();function t(r,i){return r==null?null:i==null?`${Tt.DS}.${r.type}.${r.name}`:`${Tt.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${Tt.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(S(),N("div",{class:m(r.classes.var)},[n.active==="ds"?(S(),K(fo,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):G("",!0),n.active==="builtin"?(S(),K(Wr,{key:1,onSelect:o})):G("",!0),n.active==="reference"?(S(),K(Sa,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):G("",!0)],2))}}),ka={var:"_var_12wxd_2"},wa={classes:ka},po=z(Ra,[["__cssModules",wa]]),Ca=["onClick","onMouseenter"],La=V({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var a;const t=n,l=e,o=ae((a=t.options[0])==null?void 0:a.value),s=I(()=>`${t.type}_${o.value.toLowerCase()}`);function r(d){l("select",d.value)}function i(d){o.value=d.value}return(d,f)=>(S(),N("div",{class:m(d.classes.doc)},[u("div",{class:m(["quickprint-is-scrollable",d.classes.panel])},[(S(!0),N(J,null,se(n.options,g=>(S(),N("div",{key:g.value,class:m({[d.classes.option]:!0,[d.classes.active]:g.value===o.value}),onClick:v=>r(g),onMouseenter:v=>i(g)},[u("strong",null,X(g.label),1)],42,Ca))),128))],2),u("div",{class:m(["quickprint-is-scrollable",d.classes.desc])},[p(y(uo),{name:s.value},null,8,["name"])],2)],2))}}),Ia="_doc_1pdoc_2",Na="_panel_1pdoc_10",Oa="_desc_1pdoc_16",Da="_option_1pdoc_23",xa="_active_1pdoc_33",Aa={doc:Ia,panel:Na,desc:Oa,option:Da,active:xa},Ma={classes:Aa},Yt=z(La,[["__cssModules",Ma]]),qa=V({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=tt(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(a){return e==null?void 0:e.confirm({type:"function",value:`${a}()`})}return(a,d)=>(S(),N("div",{class:m(a.classes.function)},[n.active==="string"?(S(),K(Yt,{options:t,onSelect:i,key:"string"})):G("",!0),n.active==="number"?(S(),K(Yt,{options:l,onSelect:i,key:"number"})):G("",!0),n.active==="logical"?(S(),K(Yt,{options:o,onSelect:i,key:"logical"})):G("",!0),n.active==="date"?(S(),K(Yt,{options:s,onSelect:i,key:"date"})):G("",!0),n.active==="aggregate"?(S(),K(Yt,{options:r,onSelect:i,key:"aggregate"})):G("",!0)],2))}}),Ba={function:"_function_19szx_2"},$a={classes:Ba},Pa=z(qa,[["__cssModules",$a]]),Va=["onMouseenter"],Fa=["onClick"],za={key:1},Ua=V({__name:"Formula",props:{doc:{type:he,default:null}},setup(n){const e=n,t=tt(),l=[{id:"pageNumber",name:"页码",options:a(Ls)}],o=ae(l[0]);function s(d){o.value=d}function r(d){return t==null?void 0:t.confirm({type:"formula",value:d})}function i(d){const f=_n.tokenize(d),g=e.doc;return f.reduce((v,_)=>{if(_.type===st.VARIABLE)return v.push({type:"highlight",value:et(_.value,g==null?void 0:g.ds)}),v;if(_.type===st.REFERENCE)return v.push({type:"highlight",value:co(_.value,g)}),v;if(_.type===st.TEMPLATE){const c=(Array.isArray(_.value)?_.value:[_.value]).map(h=>h.type===st.VARIABLE?{type:"highlight",value:et(h.value,g.ds)}:{type:"text",value:h.value});return v.concat(c)}return v.push({type:"text",value:_n.formatTokenValue(_)}),v},[])}function a(d){return d.map(f=>({nodes:i(f),value:f}))}return(d,f)=>(S(),N("div",{class:m(d.classes.formula)},[u("div",{class:m([d.classes.left,"quickprint-is-scrollable"])},[(S(),N(J,null,se(l,g=>u("div",{key:g.name,onMouseenter:v=>s(g),class:m({[d.classes.group]:!0,[d.classes.active]:g.id===o.value.id})},X(g.name),43,Va)),64))],2),u("div",{class:m(d.classes.right)},[(S(!0),N(J,null,se(o.value.options,(g,v)=>(S(),N("div",{key:v,class:m(d.classes.code),onClick:_=>r(g.value)},[(S(!0),N(J,null,se(g.nodes,_=>(S(),N(J,null,[_.type==="highlight"?(S(),N("span",{key:0,class:m(d.classes.highlight)},"["+X(_.value)+"]",3)):(S(),N("span",za,X(_.value),1))],64))),256)),u("span",{class:m(d.classes.badge)},"插入",2)],10,Fa))),128))],2)],2))}}),Ha="_formula_ms7c3_2",Ga="_left_ms7c3_12",Wa="_right_ms7c3_17",Ya="_group_ms7c3_24",Xa="_active_ms7c3_34",ja="_highlight_ms7c3_39",Za="_code_ms7c3_43",Ka="_badge_ms7c3_65",Ja={formula:Ha,left:Ga,right:Wa,group:Ya,active:Xa,highlight:ja,code:Za,badge:Ka},Qa={classes:Ja},ec=z(Ua,[["__cssModules",Qa]]),ul=Ne(function(n){return wt("变量",(e,t)=>p(po,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Oe)}),tc=Ne(function(n){return at("数据源",p(fo,{doc:n},null),{preset:"variable",icon:p(F,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Oe)}),nc=Ne(function(n){const e=["ds","builtin","reference"];return wt("变量",(t,l)=>p(po,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Oe)}),lc=Ne(function(){return wt("函数",(n,e)=>p(Pa,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(Oe)}),oc=Ne(function(n){return at("公式",p(ec,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Oe)}),sc={key:1},ic=V({__name:"Content",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Te(),l=zt("editorRef"),o=zt("contentRef"),s=ae(!1),r=I(()=>{const f=e.element.type===j.TABLE_CELL?xr(e.element,{exclude:["border"]}):ao(e.element);return f.color&&(f["--quickprint-element-var-color"]=f.color),s.value&&(f.alignItems="flex-start"),f}),i=I(()=>{const f=al(e.element,t.doc.ds);return f==null||f.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:f.type===ve.CONST?"span":"strong",content:f.content},{tag:"span",content:e.element.attributes.suffix}]});async function a(){var _;const f=await ul({doc:t.doc,value:e.element.ds.value}).catch(Ye);if(f==null||(e.element.setDataSource(ve.VARIABLE,f.value),e.element.type!=j.TABLE_CELL||f.type!=="ds"))return;const g=e.element.parent;if(g==null||g.isBindVariable||((_=f.parent)==null?void 0:_.type)!==ee.ARRAY)return;const v=f.parent;g.setDataSource(ve.VARIABLE,`${Tt.DS}.${v.type}.${v.name}`)}function d(){const f=l.value,g=o.value;f==null||g==null||(s.value=g.offsetHeight>f.offsetHeight)}return(f,g)=>(S(),N("div",{class:"quickprint-is-element-editor",style:Z(r.value),onVnodeMounted:d,ref_key:"editorRef",ref:l},[u("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:o},[u("span",{class:m({[f.classes.lineThrough]:n.element.style.lineThrough})},[(S(!0),N(J,null,se(i.value,(v,_)=>(S(),N(J,{key:_},[v.tag=="strong"?(S(),N("strong",{key:0,class:m(f.classes.highlight)},"["+X(v.content)+"]",3)):(S(),N("span",sc,X(v.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(S(),K(y(F),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(f.classes.dsIcon),onClick:a,onPointerdown:g[0]||(g[0]=te(()=>{},["stop"]))},null,8,["class"])):G("",!0)],4))}}),rc="_dsIcon_ss96n_2",ac="_lineThrough_ss96n_10",cc="_highlight_ss96n_14",uc={dsIcon:rc,lineThrough:ac,highlight:cc},dc={classes:uc},wn=z(ic,[["__cssModules",dc]]),fc=V({__name:"TextEditor",props:{element:{type:Yo,required:!0}},setup(n){return(e,t)=>(S(),K(wn,{element:n.element},null,8,["element"]))}}),Cn=Object.freeze({title:"文本",icon:"icon-text",type:j.TEXT,editor:fc,onCreate(){return pe.create({type:j.TEXT,width:St,height:Rn})}}),pc=V({__name:"NumberEditor",props:{element:{type:Xo,required:!0}},setup(n){return(e,t)=>(S(),K(wn,{element:n.element},null,8,["element"]))}}),mc=["value","disabled"],gc=V({__name:"RadioButton",props:kt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=tn(n,"modelValue");return(t,l)=>(S(),N("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(S(!0),N(J,null,se(n.options,o=>(S(),N("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[Ee(u("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,mc),[[ps,e.value]]),u("span",null,X(o.label),1)],2))),256))],2))}}),hc="_radioGroup_67myk_2",vc="_compacted_67myk_10",bc="_radio_67myk_2",yc="_selected_67myk_50",_c="_disabled_67myk_56",Ec={radioGroup:hc,compacted:vc,radio:bc,selected:yc,disabled:_c},Tc={classes:Ec},Dt=z(gc,[["__cssModules",Tc]]),Sc={class:"quickprint-config-section quickprint-config-inline"},Rc={class:"quickprint-config-content"},kc={class:"quickprint-config-section quickprint-config-inline"},wc={class:"quickprint-config-content"},Cc={class:"quickprint-config-section quickprint-config-inline"},Lc={class:"quickprint-config-content"},Ic={class:"quickprint-config-section quickprint-config-inline"},Nc={class:"quickprint-config-content"},Oc=V({__name:"NumberConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=I({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=I({get(){return e.element.attributes.round??jt.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=I({get(){return e.element.attributes.format??ht.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(S(),N(J,null,[u("section",Sc,[r[4]||(r[4]=u("header",{class:"quickprint-config-header"},"小数位数",-1)),u("div",Rc,[Ee(u("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ae,n.element.attributes.precision]])])]),u("section",kc,[r[5]||(r[5]=u("header",{class:"quickprint-config-header"},"舍入规则",-1)),u("div",wc,[p(y(Q),{options:y(ys),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",Cc,[r[6]||(r[6]=u("header",{class:"quickprint-config-header"},"显示类型",-1)),u("div",Lc,[p(y(Q),{options:y(_s),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",Ic,[r[7]||(r[7]=u("header",{class:"quickprint-config-header"},"值为0时",-1)),u("div",Nc,[p(Dt,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:y(Es),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),Ln=Object.freeze({title:"数字",type:j.NUMBER,icon:"icon-number",editor:pc,config:{display:Oc},onCreate(){return pe.create({type:j.NUMBER,width:St,height:Rn})}}),Dc=V({__name:"DateEditor",props:{element:{type:jo,required:!0}},setup(n){return(e,t)=>(S(),K(wn,{element:n.element},null,8,["element"]))}}),xc={class:"quickprint-config-section"},Ac={class:"quickprint-config-content"},Mc=V({__name:"DateConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=I(()=>[{label:"原始值",value:t.NONE},...Kl]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(S(),N("section",xc,[u("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=u("span",null,"格式",-1)),p(y(Q),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:Se(()=>[u("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),u("div",Ac,[Ee(u("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ae,n.element.attributes.format]])])]))}}),qc="_header_79607_2",Bc="_picker_79607_8",$c="_placeholder_79607_15",Pc={header:qc,picker:Bc,placeholder:$c},Vc={classes:Pc},Fc=z(Mc,[["__cssModules",Vc]]),In=Object.freeze({title:"日期",type:j.DATE,icon:"icon-date",editor:Dc,config:{display:Fc},onCreate(){return pe.create({type:j.DATE,width:St,height:Rn})}}),zc=["colspan","rowspan"],Uc=V({__name:"TableCellEditor",props:{element:{type:el,required:!0}},setup(n){const e=n,t=I(()=>e.element.isCollapse),l=Te(),o=ke("classes"),s=I(()=>{var a;return{[o.cell]:!0,[Y.SELECTED]:(a=e.element.state)==null?void 0:a.selected}}),r=I(()=>{var f;const a=zn((f=e.element.parent)==null?void 0:f.parent),d=zn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Ue(a,d)}});function i(a){a.button==0&&l.selectElement(e.element)}return(a,d)=>t.value?G("",!0):(S(),N("td",Wl({key:0,[`.${y(Je)||""}`]:n.element,class:s.value,style:r.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:te(i,["stop"])}),[p(wn,{element:n.element,class:m(y(o).content)},null,8,["element","class"])],48,zc))}}),Hc="_cell_rp1x6_2",Gc="_content_rp1x6_31",Wc={cell:Hc,content:Gc},Yc={classes:Wc},mo=z(Uc,[["__cssModules",Yc]]);function go(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const Xc=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:le.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],ho=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],vo=[{label:"默认",value:le.DEFAULT},...ho],Nn=[{label:"默认",value:le.DEFAULT},...Xc,...ho],dl=[{label:"默认",value:be.DEFAULT},{label:"初号",value:be.SIZE_0+"pt",short:"56px"},{label:"小初",value:be.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:be.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:be.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:be.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:be.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:be.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:be.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:be.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:be.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:be.SIZE_5+"pt",short:"14px"},{label:"小五",value:be.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],bo=[{label:"默认",value:vt.DEFAULT},{label:"1.0",value:vt.TIMES_1,short:"单倍行距"},{label:"1.1",value:vt.TIMES_1_1},{label:"1.5",value:vt.TIMES_1_5},{label:"2.0",value:vt.TIMES_2,short:"两倍行距"}],jc=[{label:"无",value:cn.NONE},{label:"实线",value:It.SOLID},{label:"虚线",value:It.DASHED},{label:"点划线",value:It.DOTTED},{label:"双实线",value:It.DOUBLE},{label:"波浪线",value:It.WAVY}],Zc=[{label:"无",value:re.NONE},{label:"实线",value:re.SOLID},{label:"虚线",value:re.DASHED},{label:"点划线",value:re.DOTTED},{label:"双实线",value:re.DOUBLE}],Kc=[{label:"默认",value:bt.AUTO},{label:"左对齐",value:bt.LEFT},{label:"居中对齐",value:bt.CENTER},{label:"右对齐",value:bt.RIGHT},{label:"两端对齐",value:bt.JUSTIFY}],Wn=[{label:"顶部对齐",value:Xe.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Xe.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Xe.BOTTOM,icon:"icon-vertical-align-bottom"}],Yn=[{label:"左对齐",value:it.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:it.CENTER,icon:"icon-align-center"},{label:"右对齐",value:it.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:it.JUSTIFY,icon:"icon-menu"}],Jc={class:"quickprint-is-row"},Qc=["onClick"],eu=V({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=ke("classes"),o=e,s=n,r=ue(),i=I(()=>({height:s.height})),a=I({get(){return Ze(s.modelValue).num??void 0},set(b){if(b==""||Zo(b)||b<0){g(void 0);return}const c=Ze(s.modelValue);g(`${b}${c.unit}`)}}),d=I({get(){return Ze(s.modelValue).unit??_e.PX},set(b){const c=Ze(s.modelValue);g(`${c.num}${b}`)}});function f(b){const c=b===be.DEFAULT?void 0:b;o("update:modelValue",c)}function g(b){o("update:modelValue",b),_()}function v(b){const c=s.modelValue;return c==null&&b.value===be.DEFAULT?!0:c===b.value}async function _(){await Ft();const b=document.querySelector("."+l.fontSelected);b&&b.scrollIntoView({block:"nearest"})}return(b,c)=>(S(),N("div",{class:m(y(l).fontSize),style:Z(i.value)},[u("div",Jc,[Ee(u("input",{type:"number",placeholder:"请输入",class:m(["quickprint-form-control",y(l).input]),min:0,"onUpdate:modelValue":c[0]||(c[0]=h=>a.value=h)},null,2),[[Ae,a.value]]),p(y(Q),{width:"54px",options:t,modelValue:d.value,"onUpdate:modelValue":c[1]||(c[1]=h=>d.value=h)},null,8,["modelValue"])]),u("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",y(l).fonts]),ref_key:"scrollRef",ref:r},[(S(!0),N(J,null,se(y(dl),h=>(S(),N("div",{key:h.value,class:m({[y(l).option]:!0,[y(l).fontSelected]:v(h)}),onClick:E=>f(h.value)},[u("span",null,X(h.label),1)],10,Qc))),128))],2)],6))}}),tu="_input_9oh9n_2",nu="_fontSize_9oh9n_8",lu="_fonts_9oh9n_13",ou="_option_9oh9n_25",su="_fontSelected_9oh9n_34",iu={input:tu,fontSize:nu,fonts:lu,option:ou,fontSelected:su},ru={classes:iu},yo=z(eu,[["__cssModules",ru]]),au=["title"],cu={key:0},uu="中文字体 AbBbCc",du=V({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=I(()=>Nn.map(c=>(c.style={fontFamily:c.value==le.DEFAULT?le.SONG:c.value},c))),l=I(()=>vo.map(c=>(c.style={fontFamily:c.value==le.DEFAULT?le.SONG:c.value},c))),o=I({get(){const c=e.options.style.fontFamily;return oe(c)?le.DEFAULT:c},set(c){e.options.style.fontFamily=c==le.DEFAULT?void 0:c}}),s=I({get(){const c=e.options.style.enFontFamily;return oe(c)?le.DEFAULT:c},set(c){e.options.style.enFontFamily=c==le.DEFAULT?void 0:c}}),r=I({get(){const c=e.options.style.color;return oe(c)?Le.INHERIT:c},set(c){e.options.style.color=c==Le.INHERIT?void 0:c}}),i=I({get(){const c=e.options.style.highlightColor;return oe(c)?Le.INHERIT:c},set(c){e.options.style.highlightColor=c==Le.INHERIT?void 0:c}}),a=I({get(){return e.options.style.fontSize},set(c){const h=oe(c)?void 0:c;e.options.style.fontSize=h}}),d=I({get(){return e.options.style.fontWeight===700},set(c){e.options.style.fontWeight=c?700:void 0}}),f=I({get(){return e.options.style.fontStyle==="italic"},set(c){e.options.style.fontStyle=c?"italic":void 0}}),g=I({get(){return e.options.style.lineThrough===!0},set(c){e.options.style.lineThrough=c?!0:void 0}}),v=I({get(){const c=e.options.style.underline;if(c==null||c===!1)return cn.NONE;const h=e.options.style.underlineStyle;return oe(h)?It.SOLID:h},set(c){if(c===cn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=c}}),_=I({get(){const c=e.options.style.underlineColor;return oe(c)?Le.INHERIT:c},set(c){e.options.style.underlineColor=c==Le.INHERIT?void 0:c}}),b=I(()=>{const c=e.options.style,h={},E=Qn(c.fontFamily,c.enFontFamily);E&&(h.fontFamily=E);const D=Bl(c);return D&&Ue(h,D),c.fontSize&&(h.fontSize=c.fontSize),c.fontWeight&&(h.fontWeight=c.fontWeight),c.color&&(h.color=c.color),c.fontStyle&&(h.fontStyle=c.fontStyle),c.highlightColor&&(h["--quickprint-variable-highlight-color"]=c.highlightColor),h});return(c,h)=>(S(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.font])},[u("div",{class:m(c.classes.fontFamily)},[u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"中文字体",2),u("div",{class:m(c.classes.content)},[p(y(Q),{options:t.value,modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=E=>o.value=E)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"颜色",2),p(y(pn),{modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=E=>r.value=E)},null,8,["modelValue"])],2),u("div",{class:m([c.classes.config,c.classes.fontSize])},[u("div",{class:m(c.classes.title)},"字号",2),p(yo,{modelValue:a.value,"onUpdate:modelValue":h[2]||(h[2]=E=>a.value=E),height:"144px"},null,8,["modelValue"])],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"西文字体",2),u("div",{class:m(c.classes.content)},[p(y(Q),{options:l.value,modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=E=>s.value=E)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"前景色",2),p(y(pn),{modelValue:i.value,"onUpdate:modelValue":h[4]||(h[4]=E=>i.value=E)},null,8,["modelValue"])],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"下划线",2),u("div",{class:m(c.classes.content)},[p(y(Q),{modelValue:v.value,"onUpdate:modelValue":h[5]||(h[5]=E=>v.value=E),options:y(jc),width:"138px"},{option:Se(({option:E})=>[u("div",{title:E.label,class:m(c.classes.option)},[E.value==y(cn).NONE?(S(),N("div",cu,X(E.label),1)):(S(),N("div",{key:1,class:m(c.classes.line),style:Z({textDecorationStyle:E.value})},"--",6))],10,au)]),_:1},8,["modelValue","options"])],2)],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"线条颜色",2),u("div",{class:m(c.classes.content)},[p(y(pn),{modelValue:_.value,"onUpdate:modelValue":h[6]||(h[6]=E=>_.value=E),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),u("div",{class:m(c.classes.fieldset)},[h[13]||(h[13]=u("header",null,"效果",-1)),u("div",{class:m(c.classes.configs)},[u("label",{class:m(c.classes.checkbox)},[Ee(u("input",{type:"checkbox","onUpdate:modelValue":h[7]||(h[7]=E=>d.value=E)},null,512),[[$n,d.value]]),h[10]||(h[10]=u("span",null,"粗体",-1))],2),u("label",{class:m(c.classes.checkbox)},[Ee(u("input",{type:"checkbox","onUpdate:modelValue":h[8]||(h[8]=E=>f.value=E)},null,512),[[$n,f.value]]),h[11]||(h[11]=u("span",null,"斜体",-1))],2),u("label",{class:m(c.classes.checkbox)},[Ee(u("input",{type:"checkbox","onUpdate:modelValue":h[9]||(h[9]=E=>g.value=E)},null,512),[[$n,g.value]]),h[12]||(h[12]=u("span",null,"删除线",-1))],2)],2)],2),u("div",{class:m(c.classes.fieldset)},[h[14]||(h[14]=u("header",null,"预览",-1)),u("div",{class:m(c.classes.preview)},[u("span",{style:Z(b.value)},[u("span",{class:m({[c.classes.lineThrough]:n.options.style.lineThrough})},X(uu),2)],4)],2)],2)],2))}}),fu="_font_5dh9t_2",pu="_fontFamily_5dh9t_7",mu="_config_5dh9t_14",gu="_fontSize_5dh9t_19",hu="_fieldset_5dh9t_23",vu="_title_5dh9t_39",bu="_configs_5dh9t_44",yu="_checkbox_5dh9t_50",_u="_option_5dh9t_65",Eu="_line_5dh9t_73",Tu="_preview_5dh9t_84",Su="_lineThrough_5dh9t_99",Ru={font:fu,fontFamily:pu,config:mu,fontSize:gu,fieldset:hu,title:vu,configs:bu,checkbox:yu,option:_u,line:Eu,preview:Tu,lineThrough:Su},ku={classes:Ru},wu=z(du,[["__cssModules",ku]]),Cu=["placeholder","min","disabled"],Lu=V({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=I(()=>{const a=l.defaultUnit;return l.options.some(d=>d.value===a)?a:l.options[0].value}),s=I({get(){return Ze(l.modelValue).num},set(a){if(Jn(a)){const f=Ze(l.modelValue).unit??o.value;return i(`${a}${f}`)}i()}}),r=I({get(){return Ze(l.modelValue).unit??o.value},set(a){const f=Ze(l.modelValue).num??l.min;i(`${f}${a}`)}});function i(a=void 0){t("update:modelValue",a)}return(a,d)=>(S(),N("div",{class:m(a.classes.input)},[Ee(u("input",{type:"number","onUpdate:modelValue":d[0]||(d[0]=f=>s.value=f),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,Cu),[[Ae,s.value]]),p(y(Q),{modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=f=>r.value=f),class:m(a.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),Iu="_input_gtdaq_2",Nu="_unit_gtdaq_14",Ou={input:Iu,unit:Nu},Du={classes:Ou},He=z(Lu,[["__cssModules",Du]]),xu="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",Au=V({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:_e.NONE},{label:"磅",value:_e.PT},{label:"像素",value:_e.PX}],l=[{label:"字符",value:_e.EM},{label:"磅",value:_e.PT},{label:"像素",value:_e.PX}],o=[{label:"毫米",value:_e.MM},{label:"磅",value:_e.PT},{label:"像素",value:_e.PX}],s=I({get(){return e.options.style.textAlign??it.LEFT},set(h){const E=h===it.LEFT?void 0:h;e.options.style.textAlign=E}}),r=I({get(){return e.options.style.textAlignLast??bt.AUTO},set(h){const E=h===bt.AUTO?void 0:h;e.options.style.textAlignLast=E}}),i=I({get(){return e.options.style.verticalAlign??Xe.MIDDLE},set(h){const E=h===Xe.MIDDLE?void 0:h;e.options.style.verticalAlign=E}}),a=b("paddingTop"),d=b("paddingBottom"),f=b("paddingLeft"),g=b("paddingRight"),v=I(()=>{const h=e.options.style,E={};return h.textAlign&&(E.textAlign=h.textAlign),h.textAlignLast&&(E.textAlignLast=h.textAlignLast),h.textIndent&&(E.textIndent=h.textIndent),h.lineHeight&&(E.lineHeight=h.lineHeight),Ue(E,c(h.verticalAlign)),E}),_=I(()=>{const h=e.options.style,E={};return E["--openprint-paragraph-preview-padding-top"]=h.paddingTop??"2px",E["--openprint-paragraph-preview-padding-right"]=h.paddingRight??"2px",E["--openprint-paragraph-preview-padding-bottom"]=h.paddingBottom??"2px",E["--openprint-paragraph-preview-padding-left"]=h.paddingLeft??"2px",E});function b(h){return I({get(){return e.options.style[h]},set(E){const D=oe(E)?void 0:E;e.options.style[h]=D}})}function c(h){return h==null?{}:h==Xe.MIDDLE||h==null?{display:"flex",alignItems:"center"}:h==Xe.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(h,E)=>(S(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",h.classes.paragraph])},[u("div",{class:m(h.classes.textAlign)},[u("div",{class:m(h.classes.configItem)},[u("div",{class:m(h.classes.configItemLabel)},"文本对齐",2),p(y(Q),{options:y(Yn),modelValue:s.value,"onUpdate:modelValue":E[0]||(E[0]=D=>s.value=D)},null,8,["options","modelValue"])],2),u("div",{class:m(h.classes.alignLast)},[u("div",{class:m(h.classes.configItemLabel)},"最后一行",2),p(y(Q),{options:y(Kc),modelValue:r.value,"onUpdate:modelValue":E[1]||(E[1]=D=>r.value=D)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(h.classes.configItem)},[u("div",{class:m(h.classes.configItemLabel)},"垂直对齐",2),p(y(Q),{options:y(Wn),modelValue:i.value,"onUpdate:modelValue":E[2]||(E[2]=D=>i.value=D)},null,8,["options","modelValue"])],2),u("div",{class:m(h.classes.configItem)},[u("div",{class:m(h.classes.configItemLabel)},"首行缩进",2),p(He,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":E[3]||(E[3]=D=>n.options.style.textIndent=D),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(h.classes.configItem)},[u("div",{class:m(h.classes.configItemLabel)},"行高",2),p(He,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":E[4]||(E[4]=D=>n.options.style.lineHeight=D),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(h.classes.fieldset)},[E[9]||(E[9]=u("header",null,"内边距",-1)),u("div",{class:m(h.classes.padding)},[u("div",{class:m(h.classes.paddingItem)},[u("label",{class:m(h.classes.paddingItemLabel)},"上边距",2),p(He,{modelValue:y(a),"onUpdate:modelValue":E[5]||(E[5]=D=>je(a)?a.value=D:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(h.classes.paddingItem)},[u("label",{class:m(h.classes.paddingItemLabel)},"下边距",2),p(He,{modelValue:y(d),"onUpdate:modelValue":E[6]||(E[6]=D=>je(d)?d.value=D:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(h.classes.paddingItem)},[u("label",{class:m(h.classes.paddingItemLabel)},"左边距",2),p(He,{modelValue:y(f),"onUpdate:modelValue":E[7]||(E[7]=D=>je(f)?f.value=D:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(h.classes.paddingItem)},[u("label",{class:m(h.classes.paddingItemLabel)},"右边距",2),p(He,{modelValue:y(g),"onUpdate:modelValue":E[8]||(E[8]=D=>je(g)?g.value=D:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),u("div",{class:m(h.classes.fieldset)},[E[10]||(E[10]=u("header",null,"预览",-1)),u("div",{class:m(h.classes.preview),style:Z(v.value)},[u("div",{style:Z(_.value),class:m(h.classes.previewText)},[ne(X(xu)+" "),u("div",{class:m(h.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),Mu="_paragraph_1ex97_2",qu="_fieldset_1ex97_7",Bu="_preview_1ex97_23",$u="_textAlign_1ex97_34 quickprint-is-row",Pu="_configItem_1ex97_39 quickprint-is-row",Vu="_alignLast_1ex97_44 quickprint-is-row",Fu="_configItemLabel_1ex97_54",zu="_padding_1ex97_59",Uu="_paddingItem_1ex97_66",Hu="_paddingItemLabel_1ex97_72",Gu="_previewText_1ex97_77",Wu="_paddingPreview_1ex97_86",Yu={paragraph:Mu,fieldset:qu,preview:Bu,textAlign:$u,configItem:Pu,alignLast:Vu,configItemLabel:Fu,padding:zu,paddingItem:Uu,paddingItemLabel:Hu,previewText:Gu,paddingPreview:Wu},Xu={classes:Yu},ju=z(Au,[["__cssModules",Xu]]),Zu=["title","onClick"],Ku={key:0},Ju=V({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=ke("classes"),t=n,l=[{label:"像素",value:_e.PX},{label:"毫米",value:_e.MM},{label:"磅",value:_e.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=ae(),i=I(()=>{const R=r.value;return R==null?"全部边框":s[R]}),a=I(()=>{const R=r.value;return R==null?!0:R<=o.BORDER_LEFT}),d=I(()=>{const R=r.value;return R==null?!0:R>=o.RADIUS_TOP_LEFT}),f=I(()=>{const R=r.value;return{[e.box]:!0,[e.highlightTop]:R==o.BORDER_TOP,[e.highlightRight]:R==o.BORDER_RIGHT,[e.highlightBottom]:R==o.BORDER_BOTTOM,[e.highlightLeft]:R==o.BORDER_LEFT,[e.highlightTopLeft]:R==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:R==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:R==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:R==o.RADIUS_BOTTOM_RIGHT}}),g=I(()=>({...C(o.BORDER_TOP),...C(o.BORDER_RIGHT),...C(o.BORDER_BOTTOM),...C(o.BORDER_LEFT),...D()})),v=I({get(){var P;const R=t.options.style,L=r.value;if(L==null||L>o.BORDER_LEFT)return R.borderWidth;const M=(P=E(L))==null?void 0:P.width;if(M!=null)return Reflect.get(R,M)},set(R){const L=t.options.style,M=r.value,P=R??void 0;if(M==null||M>o.BORDER_LEFT){L.borderWidth=P;return}const q=E(M);q!=null&&Reflect.set(L,q.width,P)}}),_=I({get(){var P;const R=t.options.style,L=r.value;if(L==null||L>o.BORDER_LEFT)return R.borderStyle??re.NONE;const M=(P=E(L))==null?void 0:P.style;return M==null?re.NONE:Reflect.get(R,M)??re.NONE},set(R){const L=t.options.style,M=r.value,P=R==null||R==re.NONE?void 0:R;if(M==null||M>o.BORDER_LEFT){L.borderStyle=P;return}const q=E(M);q!=null&&Reflect.set(L,q.style,P)}}),b=I({get(){var P;const R=t.options.style,L=r.value;if(L==null||L>o.BORDER_LEFT)return R.borderColor;const M=(P=E(L))==null?void 0:P.color;return M==null?Le.INHERIT:Reflect.get(R,M)??Le.INHERIT},set(R){const L=t.options.style,M=r.value,P=R??void 0;if(M==null||M>o.BORDER_LEFT){L.borderColor=P;return}const q=E(M);q!=null&&Reflect.set(L,q.color,P)}}),c=I({get(){const R=t.options.style,L=r.value;if(L==null||L<=o.BORDER_LEFT)return R.borderRadius;const M=h(L);if(M!=null)return Reflect.get(R,M)},set(R){const L=t.options.style,M=r.value,P=R??void 0;if(M==null||M<=o.BORDER_LEFT){L.borderRadius=P;return}const q=h(M);q!=null&&Reflect.set(L,q,P)}});function h(R){switch(R){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function E(R){switch(R){case o.BORDER_TOP:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case o.BORDER_RIGHT:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case o.BORDER_BOTTOM:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case o.BORDER_LEFT:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function D(){const R=t.options.style;return{borderTopLeftRadius:R.borderTopLeftRadius??R.borderRadius,borderTopRightRadius:R.borderTopRightRadius??R.borderRadius,borderBottomRightRadius:R.borderBottomRightRadius??R.borderRadius,borderBottomLeftRadius:R.borderBottomLeftRadius??R.borderRadius}}function C(R){const L=t.options.style;if(R==null||R>o.BORDER_LEFT){const q=L.borderStyle;return q==null||q==re.NONE?{borderStyle:re.NONE}:{}}const M=E(R);if(M==null)return{};const P=Reflect.get(L,M.style)??Reflect.get(L,"borderStyle");return P==null||P===re.NONE?{}:{[M.style]:P??L.borderStyle,[M.width]:Reflect.get(L,M.width)??L.borderWidth,[M.color]:Reflect.get(L,M.color)??L.borderColor??Le.BLACK}}function x(R){_.value=R}function k(R){r.value=R===r.value?void 0:R}function w(){const R=t.options.style;R.borderStyle=void 0,R.borderColor=void 0,R.borderWidth=void 0,R.borderTopStyle=void 0,R.borderTopColor=void 0,R.borderTopWidth=void 0,R.borderRightStyle=void 0,R.borderRightColor=void 0,R.borderRightWidth=void 0,R.borderBottomStyle=void 0,R.borderBottomColor=void 0,R.borderBottomWidth=void 0,R.borderLeftStyle=void 0,R.borderLeftColor=void 0,R.borderLeftWidth=void 0}function T(){const R=t.options.style;R.borderTopStyle==re.NONE&&(R.borderTopStyle=void 0),R.borderRightStyle==re.NONE&&(R.borderRightStyle=void 0),R.borderBottomStyle==re.NONE&&(R.borderBottomStyle=void 0),R.borderLeftStyle==re.NONE&&(R.borderLeftStyle=void 0),R.borderStyle=re.SOLID}function O(){const R=t.options.style;R.borderStyle=void 0,R.borderRightStyle=void 0,R.borderRightColor=void 0,R.borderRightWidth=void 0,R.borderLeftStyle=void 0,R.borderLeftColor=void 0,R.borderLeftWidth=void 0,R.borderTopStyle=re.SOLID,R.borderBottomStyle=re.SOLID}function A(R){const L=t.options.style,M=h(R)??"borderRadius",P=Reflect.get(L,M);return Gn(P)}function B(R){const L=Math.max(12,A(R)??0);return{width:L+"px",height:L+"px"}}return(R,L)=>(S(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",y(e).settings])},[u("div",{class:m(y(e).presets)},[L[15]||(L[15]=u("span",null,"预设：",-1)),u("button",{type:"button",class:"quickprint-text-btn",onClick:w},[u("div",{class:m(y(e).noBorder)},null,2),L[12]||(L[12]=u("span",null,"无边框",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:T},[u("div",{class:m(y(e).outerBorder)},null,2),L[13]||(L[13]=u("span",null,"外部边框",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:O},[u("div",{class:m(y(e).topBottomBorder)},null,2),L[14]||(L[14]=u("span",null,"上下边框",-1))])],2),u("div",{class:m(y(e).borderTitle)},[L[16]||(L[16]=ne(" 当前：")),u("strong",null,X(i.value),1)],2),u("div",{class:m(f.value),style:Z(g.value),onClick:L[8]||(L[8]=te(()=>{},["stop"]))},[u("div",{class:m(y(e).borderTopLeftRadius),style:Z(B(o.RADIUS_TOP_LEFT)),onClick:L[0]||(L[0]=M=>k(o.RADIUS_TOP_LEFT))},null,6),u("div",{class:m(y(e).borderTopRightRadius),style:Z(B(o.RADIUS_TOP_RIGHT)),onClick:L[1]||(L[1]=M=>k(o.RADIUS_TOP_RIGHT))},null,6),u("div",{class:m(y(e).borderBottomLeftRadius),style:Z(B(o.RADIUS_BOTTOM_LEFT)),onClick:L[2]||(L[2]=M=>k(o.RADIUS_BOTTOM_LEFT))},null,6),u("div",{class:m(y(e).borderBottomRightRadius),style:Z(B(o.RADIUS_BOTTOM_RIGHT)),onClick:L[3]||(L[3]=M=>k(o.RADIUS_BOTTOM_RIGHT))},null,6),u("div",{class:m(y(e).borderTop),onClick:L[4]||(L[4]=M=>k(o.BORDER_TOP))},null,2),u("div",{class:m(y(e).borderRight),onClick:L[5]||(L[5]=M=>k(o.BORDER_RIGHT))},null,2),u("div",{class:m(y(e).borderBottom),onClick:L[6]||(L[6]=M=>k(o.BORDER_BOTTOM))},null,2),u("div",{class:m(y(e).borderLeft),onClick:L[7]||(L[7]=M=>k(o.BORDER_LEFT))},null,2)],6),u("div",{class:m(y(e).borderSetting)},[u("div",{class:m(y(e).borderStyle)},[u("label",{class:m(y(e).borderStyleTitle)},"线型",2),u("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",y(e).borderStyleOptions])},[(S(!0),N(J,null,se(y(Zc),M=>(S(),N("div",{key:M.value,title:M.label,class:m({[y(e).option]:!0,[y(e).selected]:M.value===_.value}),onClick:P=>x(M.value)},[M.value==y(re).NONE?(S(),N("div",Ku,X(M.label),1)):(S(),N("div",{key:1,class:m(y(e).line),style:Z({textDecorationStyle:M.value})},"--",6))],10,Zu))),128))],2)],2),u("div",{class:m(y(e).borderSettingRight)},[u("div",{class:m(y(e).borderItem)},[u("label",{class:m(y(e).borderItemLabel)},"颜色",2),p(y(pn),{modelValue:b.value,"onUpdate:modelValue":L[9]||(L[9]=M=>b.value=M),class:"quickprint-is-fill-w",disabled:!a.value},null,8,["modelValue","disabled"])],2),u("div",{class:m(y(e).borderItem)},[u("label",{class:m(y(e).borderItemLabel)},"宽度",2),p(He,{modelValue:v.value,"onUpdate:modelValue":L[10]||(L[10]=M=>v.value=M),options:l,class:"quickprint-is-fill-w",disabled:!a.value},null,8,["modelValue","disabled"])],2),u("div",{class:m(y(e).borderItem)},[u("label",{class:m(y(e).borderItemLabel)},"圆角",2),p(He,{modelValue:c.value,"onUpdate:modelValue":L[11]||(L[11]=M=>c.value=M),options:l,class:"quickprint-is-fill-w",disabled:!d.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),Qu="_settings_58on3_2",ed="_borderTitle_58on3_8",td="_box_58on3_13",nd="_border_58on3_8",ld="_borderRadius_58on3_28",od="_highlightTop_58on3_35",sd="_borderTop_58on3_35 _border_58on3_8",id="_highlightBottom_58on3_36",rd="_borderBottom_58on3_36 _border_58on3_8",ad="_highlightRight_58on3_37",cd="_borderRight_58on3_37 _border_58on3_8",ud="_highlightLeft_58on3_38",dd="_borderLeft_58on3_38 _border_58on3_8",fd="_highlightTopLeft_58on3_44",pd="_borderTopLeftRadius_58on3_44 _borderRadius_58on3_28",md="_highlightTopRight_58on3_45",gd="_borderTopRightRadius_58on3_45 _borderRadius_58on3_28",hd="_highlightBottomLeft_58on3_46",vd="_borderBottomLeftRadius_58on3_46 _borderRadius_58on3_28",bd="_highlightBottomRight_58on3_47",yd="_borderBottomRightRadius_58on3_47 _borderRadius_58on3_28",_d="_borderItem_58on3_111",Ed="_borderItemLabel_58on3_121",Td="_borderSetting_58on3_126",Sd="_borderSettingRight_58on3_131",Rd="_borderStyle_58on3_138",kd="_borderStyleOptions_58on3_143",wd="_borderStyleTitle_58on3_150",Cd="_option_58on3_155",Ld="_line_58on3_171",Id="_selected_58on3_182",Nd="_presets_58on3_188",Od="_noBorder_58on3_195",Dd="_outerBorder_58on3_196",xd="_topBottomBorder_58on3_197",Ad={settings:Qu,borderTitle:ed,box:td,border:nd,borderRadius:ld,highlightTop:od,borderTop:sd,highlightBottom:id,borderBottom:rd,highlightRight:ad,borderRight:cd,highlightLeft:ud,borderLeft:dd,highlightTopLeft:fd,borderTopLeftRadius:pd,highlightTopRight:md,borderTopRightRadius:gd,highlightBottomLeft:hd,borderBottomLeftRadius:vd,highlightBottomRight:bd,borderBottomRightRadius:yd,borderItem:_d,borderItemLabel:Ed,borderSetting:Td,borderSettingRight:Sd,borderStyle:Rd,borderStyleOptions:kd,borderStyleTitle:wd,option:Cd,line:Ld,selected:Id,presets:Nd,noBorder:Od,outerBorder:Dd,topBottomBorder:xd},Md={classes:Ad},qd=z(Ju,[["__cssModules",Md]]),Bd="_setting_joc27_2",$d={setting:Bd},Pd={};function Vd(n,e){return S(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const Fd={classes:$d},zd=z(Pd,[["render",Vd],["__cssModules",Fd]]),Ud="_setting_joc27_2",Hd={setting:Ud},Gd={};function Wd(n,e){return S(),N("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const Yd={classes:Hd},Xd=z(Gd,[["render",Wd],["__cssModules",Yd]]),jd=V({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=tt();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(S(),N("div",{class:m(s.classes.setting)},[n.active==="font"?(S(),K(wu,{key:0,options:e.options},null,8,["options"])):G("",!0),n.active==="paragraph"?(S(),K(ju,{key:1,options:e.options},null,8,["options"])):G("",!0),n.active==="border"?(S(),K(qd,{key:2,options:e.options},null,8,["options"])):G("",!0),n.active==="table"?(S(),K(zd,{key:3})):G("",!0),n.active==="table-cell"?(S(),K(Xd,{key:4})):G("",!0),u("div",{class:m(s.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),Zd="_setting_1v5ya_2",Kd="_footer_1v5ya_9",Jd={setting:Zd,footer:Kd},Qd={classes:Jd},fl=z(jd,[["__cssModules",Qd]]);function ef(n){return Ie({style:tl(n.style??{})})}function tf(n,e){n.style=Object.assign({},n.style,e.style)}const nf=Ne(function(n){return wt("表格",(e,t)=>p(fl,{options:ef(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table",active:!0},{label:"边框",name:"border"}]}).promisify().then(e=>tf(n,e)).catch(Oe)});function lf(n){return Ie({style:tl(n.style??{})})}function of(n,e){n.style=Object.assign({},n.style,e.style)}const sf=Ne(function(n){return wt("单元格",(e,t)=>p(fl,{options:lf(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table-cell",active:!0},{label:"字体",name:"font"},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>of(n,e)).catch(Oe)});function rf(n,e){const t=e.getSelected(),l={menus:[{type:"menu",label:"选中表格",icon:"icon-aim",handler:e.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",handler(){nf(e.getTable())}},{type:"menu",label:"单元格设置",icon:"icon-setting",handler(){const s=t[0];s!=null&&sf(s)}},{type:"divider"}]},o=[];return t.length>=2&&o.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells}),t.some(s=>s.hasSpan)&&o.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),t.length===1&&t[0].noSpan&&o.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),o.length>0&&l.menus.push(...o,{type:"divider"}),l.menus.push({type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:e.insertColumnLeft},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:e.insertColumnRight},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:e.inserRowBottom}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:e.deleteColumns},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]},{type:"divider"},{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:e.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:e.avgTableWidth},{type:"menu",label:"均分表格高度",handler:e.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:e.setOtherRowSameHeight,disabled(){return!!(t.length!==1||t[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:e.setOtherColSameWidth,disabled(){return!!(t.length!==1||t[0].hasColSpan)}}]},go(e.getDesignApi(),e.getTable())),nl.open(n.clientX,n.clientY,l)}function af(n,e){function t(){return n.element}function l(){const w=t();return e.getSelectedElements().filter(O=>{var B;if(O.type!==j.TABLE_CELL)return!1;const A=(B=O.parent)==null?void 0:B.parent;return A==null?!1:A.id==w.id}).sort(el.sort)}function o(w){return ll.toArea(w)}function s(){var O;const w=l()[0];if(w==null)return!1;const T=(O=w.parent)==null?void 0:O.parent;return T==null?!1:e.selectElement(T)}function r(){const w=l();if(w.length===0)return!1;const T=o(w);return t().insertColumn(T.colStart,0),e.createSnapshot(),!0}function i(){const w=l();if(w.length===0)return!1;const T=o(w);return t().insertColumn(T.colEnd,1),e.createSnapshot(),!0}function a(){const w=l();if(w.length===0)return!1;const T=o(w);return t().inserRow(T.rowStart,0),e.createSnapshot(),!0}function d(){const w=l();if(w.length===0)return!1;const T=o(w);return t().inserRow(T.rowEnd,1),e.createSnapshot(),!0}function f(){var ie,Ve;const w=t(),T=w.page;if(T==null)return;const O=w.doc,A=Gn((ie=O==null?void 0:O.margins)==null?void 0:ie.left)??38,B=Gn((Ve=O==null?void 0:O.margins)==null?void 0:Ve.right)??38,R=w.columns,L=R.reduce((qe,nt)=>qe+nt,0),M=Fn.mm_to_px(T.width)-A-B,P=[];for(const qe of R){const nt=Math.round(qe/L*M);P.push(nt)}const q=P.reduce((qe,nt)=>qe+nt,0),ye=M-q;P[P.length-1]+=ye,w.setColumns(P),w.updateBoxSize(),e.createSnapshot()}function g(){const w=t(),T=w.columns,O=T.reduce((L,M)=>L+M,0),A=Math.floor(O/T.length),B=new Array(T.length).fill(A),R=O-B.reduce((L,M)=>L+M,0);B[B.length-1]+=R,w.setColumns(B),w.updateBoxSize(),e.createSnapshot()}function v(){const w=t(),T=Math.round(w.height/w.children.length);w.children.forEach((O,A)=>w.setRowHeight(A,T)),w.updateBoxSize(),e.createSnapshot()}function _(){const w=e.getSelectedElements()[0];if(w==null)return;const T=w.parent;if(T==null||T.type!="TableRow")return;const O=t(),A=T.height;O.children.forEach(B=>B.setRowHeight(A)),O.updateBoxSize(),e.createSnapshot()}function b(){const w=e.getSelectedElements()[0];if(w==null)return;const T=t(),O=w.width,A=T.attributes.colgroup.map(B=>O);T.setColumns(A),T.updateBoxSize(),e.createSnapshot()}function c(){const w=l();if(w.length<2)return;const O=t().mergeCells(w);e.selectElement(O),e.createSnapshot()}function h(){const w=l();if(w.length==0)return;t().splitCells(w),e.createSnapshot()}function E(){const w=l()[0];if(w==null)return;t().removeColumn(w.index),e.resetSelectedElement(),e.createSnapshot()}function D(){const w=l()[0];if(w==null)return;const T=w.parent;if(T==null)return;t().removeRow(T.index),e.resetSelectedElement(),e.createSnapshot()}function C(){e.getSelectedElements().forEach(T=>T.resetDS()),e.createSnapshot()}function x(){const w=e.getSelectedElements();if(w.length!=1)return;const T=w[0];if(T.hasSpan)return;const O=T.index,A=t();A.insertColumn(O,1,!0);for(const B of A.children){const R=B.children[O];if(R.id===T.id)continue;const L=B.children[O+1];A.mergeCells([R,L])}e.selectElement(T),e.createSnapshot()}function k(){const w=e.getSelectedElements();if(w.length!=1)return;const T=w[0];if(T.hasSpan)return;const O=T.parent;if(O==null)return;const A=t();A.inserRow(O.index,1);const B=A.children[O.index+1];for(let R=0;R<O.children.length;R++){const L=O.children[R];if(L.id===T.id)continue;const M=B.children[R];A.mergeCells([L,M])}e.selectElement(T),e.createSnapshot()}return{getDesignApi(){return e},getTable:t,getSelected:l,selectTable:s,toArea:o,insertColumnLeft:r,insertColumnRight:i,insertRowTop:a,inserRowBottom:d,autoReiszeColumnByPaper:f,avgTableWidth:g,avgTableHeight:v,setOtherRowSameHeight:_,setOtherColSameWidth:b,mergeCells:c,splitCells:h,splitByColumn:x,splitByRow:k,deleteColumns:E,deleteRows:D,deleteDataSource:C}}function cf(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getColumnLeft(f-1)}function r(f){const g=n.getTable(),v=g.attributes.colgroup.length;return f>=v?null:g.getColumnLeft(f+1)}function i(f,g){if(!(f.target instanceof Element))return;const v=f.target.closest("."+e.colResize);if(v==null)return;const _=v.closest("."+e.layer);_!=null&&(f.stopPropagation(),f.preventDefault(),o.left=v.offsetLeft,o.colIndex=g,o.target=v,o.container=_,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",d))}function a(f){if(o.target==null||o.container==null)return;const g=o.container.getBoundingClientRect(),v=n.getDesignApi().state.scale/100,_=s(o.colIndex),b=r(o.colIndex);let c=f.clientX-g.left;_!=null&&c<=_*v+4&&(c=_*v+4),b!=null&&c>=b*v-4&&(c=b*v-4),o.left=c/v,o.target.style.left=c/v+"px",o.moved=!0}function d(f){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",d)}return i}function uf(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getRowTop(f-1)}function r(f){const g=n.getTable(),v=g.children.length;return f>=v?null:g.getRowTop(f+1)}function i(f,g){if(!(f.target instanceof Element))return;const v=f.target.closest("."+e.rowResize);if(v==null)return;const _=v.closest("."+e.layer);_!=null&&(f.stopPropagation(),f.preventDefault(),o.top=v.offsetTop,o.rowIndex=g,o.target=v,o.container=_,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",d))}function a(f){if(o.target==null||o.container==null)return;const g=n.getDesignApi().state.scale/100,v=o.container.getBoundingClientRect(),_=s(o.rowIndex),b=r(o.rowIndex);let c=f.clientY-v.top;_!=null&&c<=_*g+4&&(c=_*g+4),b!=null&&c>=b*g-4&&(c=b*g-4),o.moved=!0,o.top=c/g,o.target.style.top=c/g+"px"}function d(f){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",d)}return i}const df=["width"],ff=["onClick"],pf=["onClick"],mf=V({__name:"TableEditor",props:{element:{type:ll,required:!0}},setup(n){const e=n,t=Te(),l=ke("classes"),o=af(e,t),s=Ie({colIndex:-1,rowIndex:-1,silence:!1}),r=I(()=>e.element.attributes.colgroup??[]),i=cf(o,l,{onResizeEnd:E,onResizeStart:h}),a=uf(o,l,{onResizeEnd:D,onResizeStart:h});function d(T){return{left:(e.element.attributes.colgroup??[]).slice(0,T).reduce((A,B)=>A+B,0)+"px"}}function f(T){return{top:(e.element.children??[]).slice(0,T).reduce((B,R)=>B+R.height,0)-1+"px"}}function g(T){const O=e.element.attributes.colgroup??[],A=O.slice(0,T).reduce((L,M)=>L+M,0),B=T===0?0:1,R=T>0&&T<O.length?-1:0;return{left:A+B+"px",width:O[T]+R+"px"}}function v(T){const O=e.element.children??[],A=O.slice(0,T).reduce((L,M)=>L+M.height,0),B=T===0?0:1,R=T>0&&T<O.length?-1:0;return{top:A+B+"px",height:O[T].height+R+"px"}}function _(T){t.selectElement(T)}function b(T){const O=[];for(const A of e.element.children){const B=A.children[T];B.isColCollapse||O.push(B)}t.multiSelectElements(O)}async function c(T){const O=T.target.closest("td");if(O==null)return;const A=Reflect.get(O,Je);A!=null&&((t.state.selectMode==Qe.SINGLE||t.state.selectMode==Qe.MULTIPLE&&t.state.selected.length<2)&&(t.selectElement(A),await Ft()),rf(T,o))}function h(){s.silence=!0}function E(T,O){s.silence=!1;const A=e.element.attributes.colgroup??[];if(T==0){const P=e.element.left,q=e.element.calculateCoord(P+O),ye=A[0]-(q-P);e.element.setLeft(q),e.element.setColWidth(0,ye),e.element.updateBoxSize(),t.createSnapshot();return}if(T==A.length){const P=T-1,q=A.slice(0,P).reduce((ie,Ve)=>ie+Ve,0),ye=O-q;e.element.setColWidth(T-1,ye),e.element.updateBoxSize(),t.createSnapshot();return}const B=T-1,R=A[B]+A[T],L=O-A.slice(0,B).reduce((P,q)=>P+q,0),M=R-L;e.element.setColWidth(B,L),e.element.setColWidth(T,M),e.element.updateBoxSize(),t.createSnapshot()}function D(T,O){s.silence=!1;const A=e.element.children;if(T==0){const P=e.element.top,q=e.element.calculateCoord(P+O),ye=A[0].height-(q-P);e.element.setTop(q),e.element.setRowHeight(T,ye),e.element.updateBoxSize(),t.createSnapshot();return}if(T==A.length){const P=T-1,q=A.slice(0,P).reduce((ie,Ve)=>ie+Ve.height,0),ye=O-q;e.element.setRowHeight(T-1,ye),e.element.updateBoxSize(),t.createSnapshot();return}const B=T-1,R=A[B].height+A[T].height,L=O-A.slice(0,B).reduce((P,q)=>P+q.height,0),M=R-L;e.element.setRowHeight(B,L),e.element.setRowHeight(T,M),e.element.updateBoxSize(),t.createSnapshot()}function C(){s.rowIndex=-1,s.colIndex=-1}function x(T){if(s.silence)return;const O=T.target.closest("td");if(O==null)return;const A=Reflect.get(O,Je);if(A==null||!(A instanceof el))return;const B=A.parent;if(B==null)return;const R=O.getBoundingClientRect(),L=T.clientY-R.top,P=T.clientX-R.left<R.width/2,q=L<R.height/2;s.colIndex=P?A.index:A.getNextColIndex(),s.rowIndex=q?B.index:A.getNextRowIndex()}function k(){const T=e.element;T.insertColumn(T.colSize-1,1)}function w(){const T=e.element;T.inserRow(T.rowSize-1,1)}return(T,O)=>(S(),N("div",{class:m(y(l).tableEditor),onContextmenu:te(c,["stop","prevent"]),onClick:O[3]||(O[3]=te(()=>{},["stop"])),onMouseleave:C},[u("table",{class:m(y(l).table),onMousemove:x},[u("colgroup",null,[(S(!0),N(J,null,se(r.value,(A,B)=>(S(),N("col",{key:B,width:A},null,8,df))),128))]),u("tbody",null,[(S(!0),N(J,null,se(n.element.children,A=>(S(),N("tr",{key:A.id,class:m({[y(Y).SELECTED]:A.isSelected})},[(S(!0),N(J,null,se(A.children,B=>(S(),K(mo,{key:B.id,element:B},null,8,["element"]))),128))],2))),128))])],34),u("div",{class:m(y(l).layer)},[s.colIndex>=0?(S(),N("div",{key:0,title:"调整列宽",class:m(y(l).colResize),style:Z(d(s.colIndex)),onPointerdown:O[0]||(O[0]=te(A=>y(i)(A,s.colIndex),["stop","prevent"]))},null,38)):G("",!0),s.rowIndex>=0?(S(),N("div",{key:1,title:"调整行高",class:m(y(l).rowResize),style:Z(f(s.rowIndex)),onPointerdown:O[1]||(O[1]=te(A=>y(a)(A,s.rowIndex),["stop","prevent"]))},null,38)):G("",!0),(S(!0),N(J,null,se(r.value,(A,B)=>(S(),N("div",{title:"选中此列",key:B,style:Z(g(B)),class:m(y(l).colIndicator),onClick:te(R=>b(B),["stop"])},null,14,ff))),128)),(S(!0),N(J,null,se(n.element.children,(A,B)=>(S(),N("div",{title:"选中此行",key:B,style:Z(v(B)),class:m(y(l).rowIndicator),onClick:te(R=>_(A),["stop"])},null,14,pf))),128)),n.element.isSelected?(S(),N("button",{key:2,onClick:te(k,["stop"]),type:"button",class:m(["quickprint-text-btn",y(l).addCol]),title:"添加列"},[p(y(F),{icon:"icon-plus",size:"14px"})],2)):G("",!0),n.element.isSelected?(S(),N("button",{key:3,onClick:te(w,["stop"]),type:"button",class:m(["quickprint-text-btn",y(l).addRow]),title:"添加行"},[p(y(F),{icon:"icon-plus",size:"14px"})],2)):G("",!0)],2),u("div",{class:m(y(l).indicator),onPointerdown:O[2]||(O[2]=(...A)=>y(t).onDragStart&&y(t).onDragStart(...A)),title:"选中/拖动表格"},null,34)],34))}}),gf="_tableEditor_5qbkt_2",hf="_table_5qbkt_2",vf="_layer_5qbkt_33",bf="_colResize_5qbkt_43",yf="_rowResize_5qbkt_66",_f="_colIndicator_5qbkt_89",Ef="_rowIndicator_5qbkt_95",Tf="_indicator_5qbkt_114",Sf="_addCol_5qbkt_151",Rf="_addRow_5qbkt_166",kf={tableEditor:gf,table:hf,layer:vf,colResize:bf,rowResize:yf,colIndicator:_f,rowIndicator:Ef,indicator:Tf,addCol:Sf,addRow:Rf},wf={classes:kf},Cf=z(mf,[["__cssModules",wf]]),Lf={class:"quickprint-config-section quickprint-config-inline"},If={class:"quickprint-config-content"},Nf=V({__name:"TableConfig",props:{element:{type:ll,required:!0}},setup(n){const e=n,t=I({get(){return e.element.attributes.rowMode??Gt.CONST},set(o){e.element.attributes.rowMode=o===Gt.CONST?void 0:o}}),l=[{label:"固定行数",value:Gt.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:Gt.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:Gt.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(S(),N("section",Lf,[s[1]||(s[1]=u("header",{class:"quickprint-config-header"},"行模式",-1)),u("div",If,[p(y(Q),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),Of={class:"quickprint-config-section quickprint-config-inline"},Df={class:"quickprint-config-content"},xf=V({__name:"TableRowConfig",props:{element:{type:un,required:!0}},setup(n){const e=n,t=[{label:"表头",value:Lt.HEADER},{label:"表体",value:Lt.BODY},{label:"表尾",value:Lt.FOOTER}],l=I({get(){return e.element.attributes.type??Lt.BODY},set(o){switch(o){case Lt.HEADER:e.element.asHeader();break;case Lt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(S(),N("section",Of,[s[1]||(s[1]=u("header",{class:"quickprint-config-header"},"行模式",-1)),u("div",Df,[p(y(Q),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),On=Object.freeze({title:"表格",type:j.TABLE,icon:"icon-table",editor:Cf,config:{attributes:Nf,exclude:[ce.DISPLAY,ce.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[St,St,St],e=pe.create({type:j.TABLE});return e.setColgroup(n),e.append(un.createDefault(n)),e.append(un.createDefault(n)),e.append(un.createDefault(n)),e.updateBoxSize(),e}}),_o=Object.freeze({title:"表格行",type:j.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[ce.POSITION,ce.COORD,ce.OVERFLOW],attributes:xf}}),pl=Object.freeze({title:"单元格",type:j.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:mo,config:{exclude:[ce.POSITION,ce.COORD]}});class Af{constructor(e){H(this,"__v_skip",!0);H(this,"observer");H(this,"callbacks",[]);H(this,"handler");this.handler=Or((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function Mf(n,e){switch(n){case"fontSize":return e===be.DEFAULT?void 0:e;case"fontFamily":return e===le.DEFAULT?void 0:e;case"lineHeight":return e===vt.DEFAULT?void 0:e;default:return e}}const kl="texteditor-const-node",qf=Object.freeze({CONST:0});class Bf{constructor(e,t={}){H(this,"__v_skip",!0);H(this,"emitter",new bn);H(this,"container");H(this,"options");H(this,"observer");H(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new Af(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new bn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Ko(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(oe(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await Tn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=kl,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var v;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,a=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(a),r.parentNode===i||(v=r.parentNode)!=null&&v.contains(i))return s.insertNode(a),this.normalize(),this.focusAfterNode(a),!0;const d=r.parentNode;if(d==null)return!1;const f=d.textContent;if(f==null)return!1;if(o.anchorOffset==f.length)return i.insertBefore(a,d.nextSibling),this.normalize(),this.focusAfterNode(a),!0;const g=document.createElement("span");return g.textContent=f.slice(0,o.anchorOffset),d instanceof HTMLElement&&(g.style.cssText=d.style.cssText),d.textContent=f.slice(o.anchorOffset),i.insertBefore(a,d),i.insertBefore(g,a),this.normalize(),this.focusAfterNode(a),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return oe(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var f;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:a}=this.normalizeRange(o);if(s===i){const g=s.textContent??"";if(s instanceof CharacterData){const b=document.createElement("span");return b.textContent=g.slice(r,a),o.deleteContents(),o.insertNode(b),[b]}const v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,i);const _=document.createElement("span");return _.textContent=g.slice(r,a),this.inheritStyle(_,i),i.textContent=g.slice(a),e.insertBefore(_,i),e.insertBefore(v,_),[_]}const d=this.findNodesBetween(s,i);if(r>0){const g=s.textContent??"",v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,s),s.textContent=g.slice(r),e.insertBefore(v,s)}if(a>=0&&a<=(((f=i.textContent)==null?void 0:f.length)??0)){const g=i.textContent??"";if(i instanceof HTMLElement){i.textContent=g.slice(0,a);const v=document.createElement("span");v.textContent=g.slice(a),this.inheritStyle(v,i),e.insertBefore(v,i.nextSibling),d.push(i)}else{const v=document.createElement("span");v.textContent=g.slice(0,a),e.replaceChild(v,i);const _=document.createTextNode(g.slice(a));e.insertBefore(_,i.nextSibling),d.push(v)}}return d.unshift(s),d}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=Fl(e),r=Mf(e,t);for(let i=0;i<l.length;i++){const a=l[i];if(a instanceof HTMLElement){this.matchElementStyle(a,s,r)||(o=!1);continue}const d=document.createElement("span");d.textContent=a.textContent,this.container.replaceChild(d,a),l[i]=d,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=yt.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=yt.remove(o,l);oe(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+kl)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const $f=V({__name:"ParagraphEditor",props:{element:{type:Jo,required:!0}},setup(n){const e=n,t=Te(),l=ue(),o=I(()=>e.element.isSelected!==!0?!1:t.state.selectMode===Qe.SINGLE);let s=null;const r=I(()=>Nn.map(k=>(k.style={fontFamily:k.value==le.DEFAULT?le.SONG:k.value},k)));function i(){}async function a(){if(s==null)return;const k=await ul({doc:t.doc}).catch(Ye);if(k==null)return;const w=et(k.value,t.doc.ds)??k.value,T={type:qf.CONST,value:k.value,label:w};s.insertNode(T)}function d(){s==null||s.blur()}function f(){s==null||s.autosize()}function g(k){const w=e.element.ds.value,T=new Bf(k);return T.on("resize",O=>{var B;const A=(B=O.detail)==null?void 0:B.height;A!=null&&e.element.setHeight(A+2)}),T.watch(()=>{const O=T.getHTML(),A=e.element.ds.value;O!==A&&(e.element.ds.value=O,T.checkHeight())}),oe(w)||T.setHTML(w),T}function v(k){s==null||s.setStyle("fontFamily",k.value)}function _(k){s==null||s.setStyle("fontSize",k.value)}function b(k){s==null||s.setStyle("lineHeight",k.value)}function c(k){s==null||s.setStyle("backgroundColor",k)}function h(k){s==null||s.setStyle("color",k)}function E(){s==null||s.setStyle("fontWeight","700")}function D(){s==null||s.setStyle("fontStyle","italic")}function C(){s==null||s.setStyle("textDecorationLine","underline")}function x(){s==null||s.setStyle("textDecorationLine","line-through")}return sl(()=>e.element.ds.value,k=>{s==null||s.getHTML()==k||s.setHTML(k)}),nn(()=>{e.element.on("blur",d),s=g(l.value)}),ol(()=>{e.element.off("blur",d),s&&s.cleanup()}),(k,w)=>(S(),N("div",{class:m(k.classes.paragraph),onPointerdown:w[2]||(w[2]=te(()=>{},["stop"])),onContextmenu:te(i,["stop","prevent"])},[u("div",{class:m(k.classes.indicator),onPointerdown:w[0]||(w[0]=(...T)=>y(t).onDragStart&&y(t).onDragStart(...T)),title:"选中/拖动段落"},null,34),o.value?(S(),N("div",{key:0,class:m(k.classes.toolbar),onMousedown:w[1]||(w[1]=te(()=>{},["prevent"]))},[p(y(Q),{onSelect:v,title:"字体",width:"60px",options:r.value,class:m(k.classes.tool),button:""},null,8,["options","class"]),p(y(Q),{onSelect:_,title:"字号",width:"60px",options:y(dl),class:m(k.classes.tool),button:""},null,8,["options","class"]),p(y(Q),{onSelect:b,title:"行高",width:"60px",options:y(bo),class:m(k.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),u("div",{class:m(k.classes.divider)},null,2),p(y(Mt),{class:m(k.classes.tool),onSelect:c},{default:Se(()=>[u("div",{class:m(k.classes.colorIcon),title:"突出显示"},[p(y(F),{icon:"icon-bg-color-b",size:"15px"}),u("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(y(Mt),{class:m(k.classes.tool),onSelect:h},{default:Se(()=>[u("div",{class:m(k.classes.colorIcon),title:"字体颜色"},[p(y(F),{icon:"icon-font",size:"15px"}),u("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),u("button",{onClick:E,type:"button",title:"加粗",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-font-bold",size:"16px"})],2),u("button",{onClick:D,type:"button",title:"斜体",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-italic",size:"16px"})],2),u("button",{onClick:C,type:"button",title:"下划线",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-underline",size:"16px"})],2),u("button",{onClick:x,type:"button",title:"删除线",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-through-line",size:"16px"})],2),u("div",{class:m(k.classes.divider)},null,2),u("button",{class:"quickprint-text-btn",type:"button",onClick:a},[p(y(F),{icon:"icon-insert-var",size:"16px"}),w[3]||(w[3]=u("span",null,"插入变量",-1))]),u("button",{class:"quickprint-text-btn",type:"button",onClick:f},[p(y(F),{icon:"icon-colum-height",size:"16px"}),w[4]||(w[4]=u("span",null,"调整高度",-1))])],34)):G("",!0),u("div",{ref_key:"editorRef",ref:l,class:m(k.classes.editor)},null,2)],34))}}),Pf="_paragraph_1v2pj_2",Vf="_indicator_1v2pj_6",Ff="_editor_1v2pj_18",zf="_toolbar_1v2pj_44",Uf="_tool_1v2pj_44",Hf="_colorIcon_1v2pj_66",Gf="_colorIndicator_1v2pj_86",Wf="_divider_1v2pj_95",Yf={paragraph:Pf,indicator:Vf,editor:Ff,toolbar:zf,tool:Uf,colorIcon:Hf,colorIndicator:Gf,divider:Wf},Xf={classes:Yf},jf=z($f,[["__cssModules",Xf]]),Dn=Object.freeze({title:"段落",type:j.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:jf,config:{exclude:[ce.DATASOURCE,ce.BASIC,ce.OVERFLOW]},onCreate(){return pe.create({type:j.PARAGRAPH,width:St*4,height:Rn*6})}}),Eo=[Cn,Ln,In,On,pl,_o,Dn],Zf=[Cn,Ln,In,On,Dn],Kf={[j.TEXT]:Cn.editor,[j.NUMBER]:Ln.editor,[j.DATE]:In.editor,[j.TABLE]:On.editor,[j.TABLE_CELL]:pl.editor,[j.PARAGRAPH]:Dn.editor},Jf={[j.TEXT]:Cn.config,[j.NUMBER]:Ln.config,[j.DATE]:In.config,[j.TABLE]:On.config,[j.TABLE_CELL]:pl.config,[j.TABLE_ROW]:_o.config,[j.PARAGRAPH]:Dn.config},Ut=Eo.reduce((n,e)=>(n[e.type]=e,n),{});function Qf(n){const e=Eo.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function ep(n){return Reflect.get(Kf,n)}function Xt(n){return Reflect.get(Jf,n)}function en(n){var e;return((e=Ut[n])==null?void 0:e.title)??n}function tp(n){var e;return(e=Ut[n])==null?void 0:e.icon}function np(n){var e,t;return((t=(e=Ut[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function lp(n){var e,t;return((t=(e=Ut[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function op(n){var e,t;return((t=(e=Ut[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function sp(n){var e,t;return((t=(e=Ut[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function wl(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function Cl(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function Ll(n,e){const t=n.find(a=>a.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function Il(n,e){const t=n.find(a=>a.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function ip(n){const e=document.createElement("div");return n.appendChild(e),e}function rp(n,e){const t=[...e.querySelectorAll(":scope ."+Y.GUIDE_LINE)];for(const l of n){const o=t.shift()??ip(e);o.className=Y.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function ap(n,e){const l=e.querySelectorAll(":scope ."+Y.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const a=i.getBoundingClientRect();if(Math.abs(s.left-a.left)<=1||Math.abs(s.right-a.left)<=1){const d=a.left-o.left;Ll(r,wl(d,s,a,o))}if(Math.abs(s.left-a.right)<=1||Math.abs(s.right-a.right)<=1){const d=a.right-o.left;Ll(r,wl(d,s,a,o))}if(Math.abs(s.top-a.top)<=1||Math.abs(s.bottom-a.top)<=1){const d=a.top-o.top;Il(r,Cl(d,s,a,o))}if(Math.abs(s.bottom-a.bottom)<=1||Math.abs(s.top-a.bottom)<=1){const d=a.bottom-o.top;Il(r,Cl(d,s,a,o))}}rp(r,e)}function cp(){const n=document.querySelectorAll("."+Y.GUIDE_LINE);for(const e of n)e.remove()}const En={create:Dr(ap,50),clean:cp};async function up(n){await Tn(),n&&Reflect.deleteProperty(n,Sn)}async function dp(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=fp(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-eo(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function fp(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===De.INSERT){const o=t.closest("."+Y.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?Ot(e.left-s.left):Math.round(e.left-s.left),y:l?Ot(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?Ot(e.left):Math.round(e.left),y:l?Ot(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function pp(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function mp(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function gp(n){return!(n.style.rotate&&!n.isSelected)}function hp(n){const e=new Hn({selector:{container:Y.DROPPABLE},scale(t){return t.mode===De.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,Yl),s=Reflect.get(l.target,il);o===De.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===De.INSERT?o:De.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===De.INSERT){const s=Qf(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,Je);if(o==null||!gp(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===De.INSERT&&(l.ghost.style.display="block"),l.mode===De.MOVE&&Reflect.set(l.target,Sn,rl.DRAG_ELEMENT),l.ghost.classList.add(Y.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,dp(n,l),pp(n,l),l.dropTarget&&En.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;En.clean(),l.ghost.classList.remove(Y.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===De.INSERT&&(l.ghost.style.display="none"),l.mode==De.MOVE&&up(l.target);const o=l.element;if(l.mode==De.MOVE){const d=o.left,f=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-d,l.diffY=o.top-f,mp(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,Xl);if(s==null)return;const r=s instanceof Rt||s instanceof pe?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),a=n.state.scale/100;o.setTop((l.top-i.top)/a),o.setLeft((l.left-i.left)/a),o.setWidth(o.width/a),o.setHeight(o.height/a),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Nl="quickprint-history-0000",vp=1,ot="snapshot",mn="health",Ol="owner",Ge="INDEX_OWNER",bp=15*60*1e3,yp=10*60*1e3;function _p(){const n={db:null,timer:null,promise:null};async function e(){const f=await a(mn,"readwrite");if(f==null)return n.timer=s(),!1;const g=[],v=f.openCursor();v.onsuccess=async function(_){const b=_.target.result;if(b==null){t(g),n.timer=s(),xe.debug("History","已检查无效快照");return}const c=b.value;c!=null&&Date.now()-c.timestamp>bp&&g.push(c),b.continue()},v.onerror=function(_){console.error(_),n.timer=s()}}async function t(f){const g=await Promise.allSettled(f.map(v=>l(v.owner)));for(let v=0;v<g.length;v++){const _=g[v];_.status==="rejected"||_.value!==!0||o(f[v].id)}}async function l(f){const g=await a(ot,"readwrite");return g==null?!1:new Promise(v=>{const _=g.index(Ge).openCursor(IDBKeyRange.only(f));_.onsuccess=function(b){const c=b.target.result;if(c==null)return v(!0);c.delete(),c.continue()},_.onerror=function(b){console.error(b),v(!1)}})}async function o(f){const g=await a(mn,"readwrite");return g==null?!1:Kt(g.delete(f)).then(()=>!0).catch(v=>(console.log(v),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),yp)}function r(){return new Promise(f=>{const g=indexedDB.open(Nl,vp);g.onupgradeneeded=v=>{const b=v.target.result,c=b.createObjectStore(mn,{keyPath:"id",autoIncrement:!0}),h=b.createObjectStore(ot,{keyPath:"id",autoIncrement:!0});c.createIndex(Ge,Ol),h.createIndex(Ge,Ol)},g.onsuccess=v=>{const _=v.target;n.db=_.result,xe.debug("History",`已连接数据库【${Nl}】`),f(n.db)},g.onerror=function(v){console.error(v),n.db=null,f(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function a(f,g="readonly"){const v=await i();if(v==null)return null;try{return v.transaction(f,g).objectStore(f)}catch(_){return console.error(_),null}}function d(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:a,cleanup:d}}function Kt(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const Ep=5*60*1e3,gt=_p();var We,$e,gn,Xn,To;class Tp{constructor(e,t={}){ze(this,$e);H(this,"state");H(this,"owner");ze(this,We);this.state=e,this.owner=t.owner??Qo(es.HISTORY_OWNER),Ce(this,$e,Xn).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await gt.findStore(ot,"readwrite");if(l==null)return!1;await Ce(this,$e,To).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await Kt(l.put(s)).catch(Ye)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await gt.findStore(ot,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await Kt(o.put(l)).catch(Ye)==null))}async getCurrentSnapshot(){const e=await gt.findStore(ot);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ge).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return o(a);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await gt.findStore(ot);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ge).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await gt.findStore(ot);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ge).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await gt.findStore(ot);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(Ge).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const a=i.value;if(a.owner!=t)return i.continue();s.push(a),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){we(this,We)&&(clearTimeout(we(this,We)),pt(this,We,null))}}We=new WeakMap,$e=new WeakSet,gn=function(){pt(this,We,setTimeout(()=>Ce(this,$e,Xn).call(this),Ep))},Xn=async function(){we(this,We)&&clearTimeout(we(this,We));const e=await gt.findStore(mn,"readwrite");if(e==null)return Ce(this,$e,gn).call(this);const t=await Kt(e.index(Ge).get(this.owner)).catch(Ye);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),Ce(this,$e,gn).call(this)}t.timestamp=Date.now(),await Kt(e.put(t)).catch(Ye),Ce(this,$e,gn).call(this)},To=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(Ge).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const a=i.target.result;if(a==null)return s(!0);const d=a.value;if(d.owner!=o)return a.continue();if(d.index>t){a.delete(),a.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function Sp(n){const e=new Tp(Ie({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(f){return e.createSnapshot(n.value,f)}function s(f){return e.replaceSnapshot(n.value,f)}async function r(){const f=await e.getPrevSnapshot();if(f==null)return!1;const g=yn(f.data);return g==null?!1:(n.value=he.create(g),!0)}async function i(){const f=await e.getNextSnapshot();if(f==null)return!1;const g=yn(f.data);return g==null?!1:(n.value=he.create(g),!0)}function a(){return e.list()}function d(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:a,cleanup:d,replaceSnapshot:s}}class Rp{constructor(e){H(this,"moved",!1);H(this,"position");H(this,"top",0);H(this,"left",0);H(this,"width",0);H(this,"height",0);H(this,"initX",0);H(this,"initY",0);H(this,"indicator");H(this,"container");H(this,"originalEvent");H(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var $t,Pt,dt,So,Ro,ko;const Re=class Re extends bn{constructor(t={}){var l,o,s;super();ze(this,dt);H(this,"context",null);H(this,"selector");H(this,"scale");H(this,"onResizeStart");ze(this,$t);ze(this,Pt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??Y.PAGE,element:((o=t.selector)==null?void 0:o.element)??Y.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??Y.RESIZEABLE_INDICATOR},this.onResizeStart=Ce(this,dt,So).bind(this),pt(this,$t,Ce(this,dt,Ro).bind(this)),pt(this,Pt,Ce(this,dt,ko).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",we(this,$t)),window.removeEventListener("pointerup",we(this,Pt)),this.context=null}};$t=new WeakMap,Pt=new WeakMap,dt=new WeakSet,So=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return xe.warn(Re.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,jl);if(o==null)return xe.warn(Re.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return xe.warn(Re.TAG_NAME,"未找到的可调整元素");const r=Ql(s,this.selector.container);this.context=new Rp({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return xe.warn(Re.TAG_NAME,"已取消调整");if(this.context.container==null)return xe.warn(Re.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const a=this.createEvent("resizestart",this.context);if(this.dispatch(a).defaultPrevented)return xe.warn(Re.TAG_NAME,"已取消调整");window.addEventListener("pointermove",we(this,$t)),window.addEventListener("pointerup",we(this,Pt))},Ro=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&Zt.TOP){const d=Math.max((i.bottom-t.clientY)/s,Re.MIN_LENGTH);l.top=(i.bottom-r.top)/s-d,l.height=d}if(o&Zt.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Re.MIN_LENGTH)),o&Zt.LEFT){const d=Math.max((i.right-t.clientX)/s,Re.MIN_LENGTH);l.left=(i.right-r.left)/s-d,l.width=d}o&Zt.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Re.MIN_LENGTH));const a=this.createEvent("resizing",l);this.dispatch(a).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},ko=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},H(Re,"TAG_NAME","quickprint-resizeable"),H(Re,"MIN_LENGTH",12);let jn=Re;async function kp(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?Ot(e.width):Math.round(e.width),o=t?Ot(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-eo(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function wp(n){const e=new jn({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,Je);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(kp(n,l),En.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),En.clean()}),n.onResizeStart=e.onResizeStart,e}function Cp(n){function e(r){const i=document.activeElement,a=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||a.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===fe.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===fe.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||ts()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowUp"?-1:1,d=i.map(f=>f.setTop(f.top+a,!0)?f:null).filter(f=>f!=null);d.length>0&&n.replaceSnapshot("top",d);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowLeft"?-1:1,d=i.map(f=>f.setLeft(f.left+a,!0)?f:null).filter(f=>f!=null);d.length>0&&n.replaceSnapshot("left",d);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const a=n.doc.pages.reduce((d,f)=>d.concat(f.children),[]);return n.multiSelectElements(a)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const a=t();for(const d of i)d.setLeft(d.left+8),d.setTop(d.top+8),a.append(d);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const rn="openprint:element,";function Lp(n){function e(){return navigator.clipboard.readText().catch(a=>(console.log(a),null))}function t(a){return navigator.clipboard.writeText(a).catch(d=>{console.log(d)})}async function l(){const a=await e();if(a==null||!a.startsWith(rn))return[];t("");const d=yn(ls(a.slice(rn.length)),[]);return d.length===0?[]:d.map(f=>(delete f.id,pe.create(f))).sort(pe.sort)}function o(a){const d=`${rn}${ns(JSON.stringify(a))}`;return t(d)}async function s(){const a=await e();return typeof a=="string"&&a.startsWith(rn)}function r(){}function i(a){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const wo=Symbol();function Ip(){return{panel:{left:!0,right:!0},scale:100,selectedType:fe.NONE,selectedPage:void 0,selectMode:Qe.SINGLE,selected:[]}}function Np(n,e){const t=Ie(Ip()),l=Sp(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:a,selectPage:g,selectElement:v,resetSelectedElement:_,deleteSelectedElement:b,multiSelectElements:c,zoomIn:E,zoomOut:h,toggleBackground:D,toggleElementPanel:C,toggleConfigPanel:x,getSelectedElements:d,getSelectedPage:f,cleanup:w,replaceSnapshot:k},r=hp(s),i=wp(s);s.shortcut=Cp(s),s.createSnapshot=l.createSnapshot,s.clipboard=Lp();function a(T){s.document.value=T,s.history.createSnapshot()}function d(){const T=t.selected;return T.length==0?[]:T.map(O=>s.doc.findElement(O)).filter(O=>O!=null)}function f(){var O;const T=t.selectedPage;if(T!=null)return(O=n.value)==null?void 0:O.findPage(T)}function g(T){return _(),t.selectedPage=T.id,t.selectedType=fe.PAGE,!0}function v(T){t.selectMode=Qe.SINGLE,t.selectedType=fe.ELEMENT,t.selectedPage=void 0;const O=d();for(const A of O)A.id!==T.id&&A.blur();return T.focus(),t.selected=[T.id],!0}function _(){const T=d();for(const O of T)O.blur();return t.selected=[],t.selectedType=fe.NONE,!0}function b(){if(t.selectedType!=fe.ELEMENT||t.selected.length==0)return!1;let T=!1;const O=d();for(const A of O)A.remove()&&(T=!0);return T&&s.history.createSnapshot(),!0}function c(T){t.selectMode=Qe.MULTIPLE,t.selectedType=fe.ELEMENT,t.selectedPage=void 0;const O=d();for(const A of O)A.blur();for(const A of T)A.focus();return t.selected=T.map(A=>A.id),!0}function h(){const T=t.scale??100,O=Wt.indexOf(T);return O<0?(t.scale=100,!1):O>=Wt.length-1?!1:(t.scale=Wt[O+1],!0)}function E(){const T=t.scale??100,O=Wt.indexOf(T);return O<0?(t.scale=100,!1):O==0?!1:(t.scale=Wt[O-1],!0)}function D(){const O=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=O}function C(){s.state.panel.left=!s.state.panel.left}function x(){s.state.panel.right=!s.state.panel.right}function k(T,O){const A=O??s.doc,B=Array.isArray(A)?"element":A instanceof he?"document":A instanceof Rt?"page":"element",R=Array.isArray(A)?A.map(M=>M.id).join(","):A.id,L=`${B}:${R}:${T}`;return l.replaceSnapshot({action:L})}function w(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),Gl(wo,s),ol(w),s}function Te(){return Hl(wo)}const Op=V({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=ke("classes"),l=Te(),o=I(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=I(()=>{const c=e.page.id,h=l.doc.pages.find(E=>E.id===c);return h==null?0:e.direction=="horizontal"?h.width:h.height}),r=I(()=>{const c=s.value,h=[];for(let E=0;E<=c;E+=10)h.push(E/10);return h}),i=I(()=>{const c=s.value,h=[];for(let E=0;E<=c;E+=2.5)h.push(E);return h}),a=I(()=>{const c=l.getSelectedElements();return c.length==1?c[0]:null}),d=I(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),f=I(()=>{const c=a.value;if(c==null)return 0;if(c.type==="TableCell"){const h=c.parent;if(h==null)return 0;const E=h.parent;return h==null?0:E.top+h.offsetTop}if(c.type==="TableRow"){const h=c.parent;return h==null?0:h.top+c.offsetTop}return c.top}),g=I(()=>{const c=a.value;if(c==null)return 0;if(c.type==="TableCell"){const h=c.parent;if(h==null)return 0;const E=h.parent;return h==null?0:E.left+c.offsetLeft}if(c.type==="TableRow"){const h=c.parent;return h==null?0:h.left}return c.left});function v(c,h){return e.direction==="horizontal"?{left:c*(e.scale/100)+"mm",height:(h-2)%4==0?"8px":"4px"}:{top:c*(e.scale/100)+"mm",width:(h-2)%4==0?"8px":"4px"}}function _(c){return e.direction==="horizontal"?{left:c*(e.scale/100)+"cm"}:{top:c*(e.scale/100)+"cm"}}function b(c){return e.direction==="horizontal"?{left:g.value*(e.scale/100)+"px",width:c.width*(e.scale/100)+"px",height:"100%"}:{top:f.value*(e.scale/100)+"px",height:c.height*(e.scale/100)+"px",width:"100%"}}return(c,h)=>(S(),N("div",{class:m(o.value)},[u("div",{class:m(y(t).ruler),style:Z(d.value)},[a.value?(S(),N("div",{key:0,class:m(y(t).selected),style:Z(b(a.value))},null,6)):G("",!0),(S(!0),N(J,null,se(i.value,(E,D)=>(S(),N("div",{key:E,class:m(y(t).scale),style:Z(v(E,D))},null,6))),128)),(S(!0),N(J,null,se(r.value,E=>(S(),N("div",{class:m(y(t).number),style:Z(_(E))},X(E),7))),256))],6)],2))}}),Dp="_horizontalRuler_170u5_2",xp="_verticalRuler_170u5_15",Ap="_ruler_170u5_27",Mp="_scale_170u5_32",qp="_number_170u5_46",Bp="_selected_170u5_71",$p={horizontalRuler:Dp,verticalRuler:xp,ruler:Ap,scale:Mp,number:qp,selected:Bp},Pp={classes:$p},Dl=z(Op,[["__cssModules",Pp]]),Vp=["title"],an=8,Fp=V({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=ke("classes"),s={},r=Te(),i=I(()=>({top:Math.round(t.top*t.zoom)+"px"}));function a(v){if(v.button!=0||t.disabled===!0)return;const _=v.target.closest("."+o.dragLine);_!=null&&(v.stopPropagation(),s.init=!1,s.target=_,s.parent=_.offsetParent,s.target.setPointerCapture(v.pointerId),window.addEventListener("pointermove",d),window.addEventListener("pointerup",f))}function d(v){v.preventDefault();const _=g(s.parent);let b=v.clientY-_.top;b<0&&(b=0),b>_.height&&(b=_.height),t.min>0&&b<t.min+an&&(b=t.min+an),t.max>0&&b>t.max-an&&(b=t.max-an),s.target.style.top=b/(r.state.scale/100)+"px",s.top=b,s.init=!0}function f(v){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(v.pointerId),window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",f)}function g(v){return v instanceof HTMLElement?v.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(v,_)=>(S(),N("div",{class:m({[y(o).dragLine]:!0,[y(o).disabled]:n.disabled}),style:Z(i.value),onPointerdown:te(a,["stop"]),title:n.title},null,46,Vp))}}),zp="_dragLine_1m7rt_2",Up="_disabled_1m7rt_26",Hp={dragLine:zp,disabled:Up},Gp={classes:Hp},xl=z(Fp,[["__cssModules",Gp]]),Wp=V({__name:"Selection",setup(n,{expose:e}){const t=ue(),l=ue(),o=zt("selectionRef"),s=ue(),r=Te();let i=[];function a(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function d(){const b=[],c=l.value;if(c==null)return b;const h=f(c);if(h.length==0)return b;const E=o.value;return h.forEach(D=>{if(!Is(D,E)){D.classList.remove(Y.SELECTED);return}const C=Reflect.get(D,Je);C instanceof pe&&(D.classList.add(Y.SELECTED),b.push(C))}),b}function f(b){if(b.matches("."+Y.ELEMENT)){const c=Reflect.get(b,Je);if(c&&c.type===j.TABLE)return b.querySelectorAll(":scope td")}return b.querySelectorAll(`:scope .${Y.PAGE} > .${Y.SELECTABLE}`)}function g(b,c){const h=c.closest("."+Y.PAPER);if(h==null)return;b.stopPropagation(),b.preventDefault();const E=a(),D=h.getBoundingClientRect();E.initialX=b.clientX,E.initialY=b.clientY,E.top=b.clientY-D.top,E.left=b.clientX-D.left,l.value=c,s.value=E,t.value=h,i=[],window.addEventListener("pointermove",v),window.addEventListener("pointerup",_)}function v(b){const c=s.value;if(c==null)return;b.stopPropagation(),b.preventDefault();const h=o.value;if(c.init!==!0){if(Math.abs(b.clientX-c.initialX)<4&&Math.abs(b.clientY-c.initialY)<4)return;h.setPointerCapture(b.pointerId),h.style.display="block",c.init=!0}const E=Math.abs(b.clientX-c.initialX),D=Math.abs(b.clientY-c.initialY),C=b.clientX<c.initialX?-E:0,x=b.clientY<c.initialY?-D:0;h.style.top=c.top+x+"px",h.style.left=c.left+C+"px",h.style.width=E+"px",h.style.height=D+"px",i=d()}function _(b){const c=s.value;if(c==null)return;c.init&&(b.stopPropagation(),b.preventDefault()),i.length>0&&r.multiSelectElements(i);const h=o.value;h.releasePointerCapture(b.pointerId),h.style.display="none",s.value=void 0,window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",_)}return e({onSelectStart:g}),(b,c)=>(S(),N("div",{ref_key:"selectionRef",ref:o,class:m(b.classes.selection),onClick:c[0]||(c[0]=te(()=>{},["stop"]))},null,2))}}),Yp="_selection_10jfe_2",Xp={selection:Yp},jp={classes:Xp},Zp=z(Wp,[["__cssModules",jp]]);function Kp(n){return Ie({style:tl(n.style??{})})}function Jp(n,e){n.style=Object.assign({},n.style,e.style)}const Qp=Ne(function(n){return wt("元素",(e,t)=>p(fl,{options:Kp(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>Jp(n,e)).catch(Oe)});function em(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){Qp(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},go(t,e.element)),nl.open(n.clientX,n.clientY,{menus:l})}const tm=V({props:{element:{type:pe,required:!0}},setup(n){const e=ke("classes"),t=Te(),l=I(()=>{const g=n.element;g.state.key;const v={"--quickprint-element-top":g.top+"px","--quickprint-element-left":g.left+"px","--quickprint-element-width":g.width+"px","--quickprint-element-height":g.height+"px","z-index":g.zIndex};return r()&&(v.transform=`rotate(${g.style.rotate}deg)`),v}),o={TOP:[e.resizeTop,Nt.TOP],BOTTOM:[e.resizeBottom,Nt.BOTTOM],LEFT:[e.resizeLeft,Nt.LEFT],RIGHT:[e.resizeRight,Nt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Nt.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const g=n.element;return g.style.rotate==0||g.style.rotate==null?!1:t.state.selectMode===Qe.SINGLE?!g.isSelected:!0}function i(g){const v=ep(g.type);if(v==null)return p("div",{class:e.unknown},[p("span",null,[ne("未知的打印元素")])]);const _={element:g,key:g.id+"_"+g.state.key};return lp(g.type)?(_.onContextmenu=d,ct(v,_)):ct(v,_)}function a(g,v){v.stopPropagation();const _=v.target.closest("."+Y.ELEMENT);_&&Reflect.get(_,Sn)===rl.DRAG_ELEMENT||t.selectElement(g)}function d(g){g.stopPropagation(),g.preventDefault(),em(g,n,t)}function f(){return!op(n.element.type)||r()?null:s.map(g=>{const v={class:[Y.RESIZEABLE_INDICATOR,g[0]],["."+jl]:g[1]};return p("div",ms(v,{onPointerdown:t.onResizeStart}),null)})}return function(){const g=n.element,v={["."+Je]:g,["."+il]:g.type,id:g.id,key:g.id,class:{[Y.ELEMENT]:!0,[Y.DRAGGABLE]:!0,[Y.RESIZEABLE]:!0,[Y.SELECTED]:g.state.selected,[Y.SELECTABLE]:np(g.type),["quickprint-is-"+g.type.toLowerCase()]:!0},style:l.value,onClick:a.bind(null,g)};return p("div",v,[i(g),f()])}}}),nm="_unknown_za8zh_2",lm="_resizeTop_za8zh_12",om="_resizeBottom_za8zh_20",sm="_resizeLeft_za8zh_28",im="_resizeRight_za8zh_36",rm="_resizeBottomRight_za8zh_44",am={unknown:nm,resizeTop:lm,resizeBottom:om,resizeLeft:sm,resizeRight:im,resizeBottomRight:rm},cm={classes:am},um=z(tm,[["__cssModules",cm]]),Co=Pl(()=>Vl(()=>import("./component-wHisujg_.js"),__vite__mapDeps([2,3,1,4,5]))),dm=V({__name:"DocJson",props:{doc:{type:he,required:!0}},setup(n){const e=n,t=tt(),l=ae(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(S(),K(y(Co),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),fm="_json_9crpe_2",pm={json:fm},mm={classes:pm},gm=z(dm,[["__cssModules",mm]]),hm=Ne(function(n){return at("调试",p(gm,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(Ye)});async function vm(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+Y.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const a=r.getBoundingClientRect(),d=n.clientX-a.left-i[0].left,f=n.clientY-a.top-i[0].top;for(const g of i)g.setLeft(g.left+d),g.setTop(g.top+f),e.page.append(g);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){hm(t).then(r=>{if(r==null)return;const i=he.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),nl.open(n.clientX,n.clientY,{menus:l})}const bm=V({props:{doc:{type:he,required:!0},page:{type:Rt,required:!0}},setup(n){const e=ke("classes"),t=Te(),l=zt("selectionRef"),o=zt("paperRef"),s=ae(0),r=I(()=>n.page.width),i=I(()=>n.page.height);function a(D){D.stopPropagation();const C=D.target.closest("."+Y.PAPER);C&&Reflect.get(C,Sn)===rl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function d(){if(n.page.header.display===!1)return null;const D=n.page.header.height,C="page_header_"+s.value;return p(xl,{title:"页眉",top:D,onMove:g,key:C},null)}function f(){if(n.page.footer.display===!1)return null;const D=Vt(i.value)-n.page.footer.height,C="page_footer_"+s.value;return p(xl,{title:"页脚",top:D,onMove:v,key:C},null)}function g(D){n.page.setHeaderHeight(D.top),s.value++}function v(D){n.page.setFooterHeight(Vt(i.value)-D.top),s.value++}function _(D){D.stopPropagation(),D.preventDefault(),vm(D,n,t)}function b(){const D=n.doc.margins;if(D==null)return null;const C=[];return D.top&&C.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:D.top+"px"}},null)),D.bottom&&C.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:D.bottom+"px"}},null)),D.left&&C.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:D.left+"px"}},null)),D.right&&C.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:D.right+"px"}},null)),C.length>0?C:null}function c(){const D={["."+Xl]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[Y.PAGE]:!0,[Y.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:_},C=n.page.children.map(x=>p(um,{element:x},null));return p("div",D,[d(),C,f(),b()])}function h(D){if(D.button!==0)return;D.stopPropagation(),D.preventDefault();const x=D.target.closest("."+Y.ELEMENT);if(x==null)return E(D,o.value);const k=Reflect.get(x,Je);return k==null?E(D,o.value):k.type===j.TABLE?E(D,x):sp(k.type)?t.onDragStart(D):E(D,o.value)}function E(D,C){var x;(x=l.value)==null||x.onSelectStart(D,C)}return function(){const D=t.state.scale/100,C={id:"@"+n.page.id,ref:"paperRef",class:{[Y.PAPER]:!0,[Y.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*D+"mm",height:i.value*D+"mm"},onPointerdown:h,onClick:a};return p("div",C,[c(),p(Zp,{ref:"selectionRef"},null)])}}}),ym="_paper_fdphx_2",_m="_grid_fdphx_12",Em="_marginHorizontalGuide_fdphx_21",Tm="_marginVerticalGuide_fdphx_29",Sm={paper:ym,grid:_m,marginHorizontalGuide:Em,marginVerticalGuide:Tm},Rm={classes:Sm},km=z(bm,[["__cssModules",Rm]]),wm={class:"quickprint-is-fill-h quickprint-is-scrollable"},Cm="icon-zhanweifu",Lm=V({__name:"Element",setup(n){const e=Te();return(t,l)=>(S(),N("div",{class:m(t.classes.panel)},[u("div",{class:m(t.classes.header)},"可打印元素",2),u("div",wm,[u("div",{class:m(t.classes.grid)},[(S(!0),N(J,null,se(y(Zf),o=>(S(),N("div",Wl({key:o.type,class:[y(Y).DRAGGABLE,t.classes.element],[`.${y(Yl)||""}`]:y(De).INSERT,[`.${y(il)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>y(e).onDragStart&&y(e).onDragStart(...s))}),[p(y(F),{icon:o.icon??Cm,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),u("span",null,X(o.title),1)],48))),128))],2)])],2))}}),Im="_panel_1p36j_2",Nm="_header_1p36j_8",Om="_grid_1p36j_18",Dm="_element_1p36j_30",xm="_icon_1p36j_45",Am={panel:Im,header:Nm,grid:Om,element:Dm,icon:xm},Mm={classes:Am},qm=z(Lm,[["__cssModules",Mm]]),Bm=["onClick"],$m=V({__name:"SelectPath",setup(n){const e=Te(),t=I(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===fe.PAGE){const i=e.getSelectedPage();if(i!=null){const a="页面"+(i.index+1);r.push({id:i.id,title:a,type:"page",data:i})}return r}if(s.selectedType===fe.ELEMENT){if(s.selectMode===Qe.MULTIPLE){const d=e.getSelectedElements();if(d.length===0)return r;let f=d[0];for(;f.parent;){const g=f.parent;if(g instanceof Rt){const v="页面"+(g.index+1);return r.push({id:g.id,title:v,type:"page",data:g}),r}f=g}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const a=[{id:i.id,title:en(i.type),type:"element",data:i}];for(;i.parent;){const d=i.parent;if(d instanceof Rt){const f="页面"+(d.index+1);return a.unshift({id:d.id,title:f,type:"page",data:d}),r.concat(a)}a.unshift({id:d.id,title:en(d.type),type:"element",data:d}),i=d}}return r}),l=I(()=>{if(e.state.selectedType!=fe.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],a=al(i,e.doc.ds);if(!(a==null||!a.content))return a.type===ve.VARIABLE||a.type===ve.FORMULA?`[${a.content}]`:a.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(S(),N("div",{class:m(s.classes.paths)},[(S(!0),N(J,null,se(t.value,(i,a)=>(S(),N(J,{key:i.id},[a>0?(S(),K(y(F),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):G("",!0),u("div",{class:m(s.classes.path),onClick:d=>o(i)},X(i.title),11,Bm)],64))),128)),l.value?(S(),N(J,{key:0},[p(y(F),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),u("div",{class:m(s.classes.content)},X(l.value),3)],64)):G("",!0)],2))}}),Pm="_paths_fuk62_2",Vm="_path_fuk62_2",Fm="_icon_fuk62_28",zm="_content_fuk62_33",Um={paths:Pm,path:Vm,icon:Fm,content:zm},Hm={classes:Um},Gm=z($m,[["__cssModules",Hm]]),Wm=["min","readonly","placeholder"],Ym=V({__name:"LabelNumber",props:kt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=tn(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const a=e.min?e.min:e.defaultValue;t.value=a;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const a=Math.pow(10,e.precision);t.value=Math.round(i*a)/a}}return(o,s)=>(S(),N("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[Ee(u("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Wm),[[Ae,t.value]]),u("span",{class:m(o.classes.label)},X(n.label),3)],2))}}),Xm="_labelNumber_1aifb_2",jm="_label_1aifb_2",Zm="_readonly_1aifb_25",Km={labelNumber:Xm,label:jm,readonly:Zm},Jm={classes:Km},xt=z(Ym,[["__cssModules",Jm]]),Qm={class:"quickprint-config"},eg={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},tg={class:"quickprint-config-group"},ng={class:"quickprint-config-section quickprint-config-inline"},lg={class:"quickprint-config-content quickprint-config-inline"},og={class:"quickprint-config-group"},sg={class:"quickprint-config-section quickprint-config-inline"},ig={class:"quickprint-config-content quickprint-config-inline"},rg={class:"quickprint-config-section quickprint-config-inline"},ag={class:"quickprint-config-content quickprint-form-inline"},cg={class:"quickprint-config-group"},ug={class:"quickprint-config-section quickprint-config-inline"},dg={class:"quickprint-config-content quickprint-form-inline"},fg={key:0,class:"quickprint-config-section quickprint-config-inline"},pg={class:"quickprint-config-content quickprint-form-inline"},mg={class:"quickprint-config-section quickprint-config-inline"},gg={class:"quickprint-config-content quickprint-form-inline"},hg=V({__name:"PageConfig",props:{page:{type:Rt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=[{label:"禁止",value:on.NONE},{label:"跟随表格",value:on.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],o=I({get(){return e.page.size.type},set(d){e.page.size.type=d,d===Jt.CONTENT&&(e.page.size.orientation=void 0)}}),s=I({get(){return e.page.orientation},set(d){e.page.size.orientation=d}}),r=I(()=>e.page.width),i=I({get(){return e.page.height},set(d){const f=Number(d);!Jn(f)||f<0||(e.page.size.height=f)}}),a=I({get(){return e.page.footer.flow??on.NONE},set(d){e.page.footer.flow=d===on.NONE?void 0:d}});return(d,f)=>(S(),N("div",Qm,[f[15]||(f[15]=u("div",{class:"quickprint-config-title"},"页面配置",-1)),u("div",eg,[u("div",tg,[f[7]||(f[7]=u("div",{class:"quickprint-config-group-title"},"页眉",-1)),u("section",ng,[f[6]||(f[6]=u("header",{class:"quickprint-config-header"},"位置",-1)),u("div",lg,[p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(Dt,{modelValue:n.page.header.display,"onUpdate:modelValue":f[0]||(f[0]=g=>n.page.header.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),u("div",og,[f[10]||(f[10]=u("div",{class:"quickprint-config-group-title"},"页脚",-1)),u("section",sg,[f[8]||(f[8]=u("header",{class:"quickprint-config-header"},"位置",-1)),u("div",ig,[p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(Dt,{modelValue:n.page.footer.display,"onUpdate:modelValue":f[1]||(f[1]=g=>n.page.footer.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),u("section",rg,[f[9]||(f[9]=u("header",{class:"quickprint-config-header"},"跟随",-1)),u("div",ag,[p(y(Q),{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=g=>a.value=g),options:l},null,8,["modelValue"])])])]),u("div",cg,[f[14]||(f[14]=u("div",{class:"quickprint-config-group-title"},"画布",-1)),u("section",ug,[f[11]||(f[11]=u("header",{class:"quickprint-config-header"},"尺寸",-1)),u("div",dg,[p(Dt,{modelValue:o.value,"onUpdate:modelValue":f[3]||(f[3]=g=>o.value=g),options:y(Rs),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===y(Jt).CONTENT?(S(),N("section",fg,[f[12]||(f[12]=u("header",{class:"quickprint-config-header"},"内容",-1)),u("div",pg,[p(xt,{class:"quickprint-form-inline-item",label:"宽",modelValue:r.value,readonly:""},null,8,["modelValue"]),p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:i.value,"onUpdate:modelValue":f[4]||(f[4]=g=>i.value=g)},null,8,["modelValue"])])])):G("",!0),u("section",mg,[f[13]||(f[13]=u("header",{class:"quickprint-config-header"},"方向",-1)),u("div",gg,[p(Dt,{modelValue:s.value,"onUpdate:modelValue":f[5]||(f[5]=g=>s.value=g),class:"quickprint-w-full",options:y(Jl),disabled:n.page.size.type===y(Jt).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),vg=["value","placeholder"],bg=V({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=zt("inputRef"),s=I({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?hl(t.modelValue):t.standard==="mm"&&t.target==="px"?Vt(t.modelValue):0},set(f){if(t.standard===t.target)return l("update:modelValue",f);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Vt(f));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",hl(f))}}),r=I(()=>t.clearable&&s.value!=null);function i(f){const v=f.target.value;if(s==null||v===""){if(t.clearable)return;const b=t.min?t.min:t.defaultValue;s.value=b;return}const _=Number(v);if(!Number.isNaN(_)){if(t.min!=null&&_<t.min){s.value=t.min;return}if(t.standard==="px"){s.value=Math.round(_);return}s.value=_}}function a(){l("update:modelValue",void 0)}function d(){var f;(f=o.value)==null||f.blur(),setTimeout(()=>{var g;return(g=o.value)==null?void 0:g.focus()},50)}return(f,g)=>(S(),N("label",{class:m({[f.classes.inputUnit]:!0,[f.classes.withClear]:n.clearable})},[u("span",{class:m(f.classes.label)},X(n.label),3),u("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",value:s.value,placeholder:n.placeholder,onBlur:i,onKeydown:Ul(d,["enter"])},null,40,vg),r.value?(S(),N("span",{key:0,class:m(f.classes.clearBtn),onClick:te(a,["stop"])},[p(y(F),{icon:"icon-close",size:"11px"})],2)):G("",!0)],2))}}),yg="_inputUnit_2ymft_2",_g="_clearBtn_2ymft_7",Eg="_label_2ymft_11",Tg="_withClear_2ymft_31",Sg={inputUnit:yg,clearBtn:_g,label:Eg,withClear:Tg},Rg={classes:Sg},rt=z(bg,[["__cssModules",Rg]]),kg=V({__name:"UnitSelect",props:kt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=tn(n,"modelValue"),o=I(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(S(),N("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(y(Q),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:Se(()=>[u("span",{class:m(s.classes.text)},X(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),wg="_unit_135mn_2",Cg="_text_135mn_8",Lg="_select_135mn_25",Ig={unit:wg,text:Cg,select:Lg},Ng={classes:Ig},Lo=z(kg,[["__cssModules",Ng]]),Og=V({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=ae(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch(os)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(S(),N("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[p(y(F),{icon:"icon-copy"}),p(gs,{name:"quickprint-fade"},{default:Se(()=>[l.value?(S(),N("span",{key:0,class:m(s.classes.message)},"已复制",2)):G("",!0)]),_:1})],2))}}),Dg="_btn_v9scw_2",xg="_message_v9scw_6",Ag={btn:Dg,message:xg},Mg={classes:Ag},qg=z(Og,[["__cssModules",Mg]]),Bg=V({__name:"window",props:{code:{type:String,default:""},doc:{type:he,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=tt(),l=ae(e.code),o=ue();function s(){return l.value}function r(){e.doc!=null&&nc({doc:e.doc}).then(g=>{var _;if(g==null)return;const v=g.type=="reference"?`[=${g.value}]`:`[${g.value}]`;(_=o.value)==null||_.insert(v)})}function i(g){var v;return et(g,(v=e.doc)==null?void 0:v.ds)}function a(){var g;(g=o.value)==null||g.insert(`[2.6.${Zn.ELEMENT_VALUR}]`)}function d(){lc().then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}function f(){oc({doc:e.doc}).then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}return t==null||t.useHandle("confirm",s),(g,v)=>(S(),N("div",{class:m(g.classes.window)},[n.mode!=="code"?(S(),N("div",{key:0,class:m(g.classes.toolbar)},[n.mode=="condition"?(S(),N(J,{key:0},[u("button",{type:"button",class:"quickprint-text-btn",onClick:a},[p(y(F),{icon:"icon-number-sign"}),v[1]||(v[1]=u("span",null,"插入元素值",-1))]),u("div",{class:m(g.classes.divider)},null,2)],64)):G("",!0),u("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[p(y(F),{icon:"icon-insert-var"}),v[2]||(v[2]=u("span",null,"插入变量",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:d},[p(y(F),{icon:"icon-function"}),v[3]||(v[3]=u("span",null,"插入函数",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:f},[p(y(F),{icon:"icon-formula"}),v[4]||(v[4]=u("span",null,"插入公式",-1))])],2)):G("",!0),p(y(Co),{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=_=>l.value=_),language:"javascript",class:m(g.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),$g="_window_n935p_2",Pg="_toolbar_n935p_11",Vg="_code_n935p_22",Fg="_divider_n935p_27",zg={window:$g,toolbar:Pg,code:Vg,divider:Fg},Ug={classes:zg},Io=z(Bg,[["__cssModules",Ug]]),No=Ne(function(n){return at("公式",p(Io,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Oe)}),Hg=Ne(function(n,e){return at(n,p(Io,{code:e},null),{preset:"editor"}).promisify().catch(Oe)}),Gg={class:"quickprint-config-section quickprint-config-inline"},Wg={class:"quickprint-config-content"},Yg=["value"],Xg=V({__name:"Visibility",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=I({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??Et.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==Et.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=I({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=I(()=>{var i;return cl((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=I(()=>{var i;return t.value!==Et.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${Zn.ELEMENT_VALUR}]`;No({code:i,doc:e.element.doc,mode:"condition"}).then(a=>{a!=null&&(l.value=a)})}return(i,a)=>(S(),N(J,null,[u("section",Gg,[a[1]||(a[1]=u("header",{class:"quickprint-config-header"},"可见性",-1)),u("div",Wg,[p(y(Q),{class:"quickprint-w-full",options:y(bs),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=d=>t.value=d)},null,8,["options","modelValue"])])]),t.value===y(Et).CONDITION?(S(),N("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[u("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Yg),s.value?(S(),K(y(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2)):G("",!0)],64))}}),jg="_condition_siopf_2",Zg={condition:jg},Kg={classes:Zg},Jg=z(Xg,[["__cssModules",Kg]]);function Qg(n){return I({get(){return n.element.attributes.position??hn.DEFAULT},set(e){const t=e===hn.DEFAULT?void 0:e;n.element.attributes.position=t}})}function eh(n){return I({get(){return n.element.attributes.printMode??vn.ONCE},set(e){const t=e===vn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function th(n){return I({get(){return n.element.attributes.overflow??Qt.HIDDEN},set(e){const t=e===Qt.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function nh(n){return I({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function lh(n){return I({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function oh(n){return I({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function sh(n){return I({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const ih=V({__name:"Const",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=I({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,o)=>Ee((S(),N("textarea",{"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Ae,t.value]])}}),rh={class:"quickprint-config-ds-var-type"},ah=["title"],ch=V({__name:"Variable",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Te(),l=I(()=>oe(e.element.ds.value)),o=I(()=>et(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var f;const i=await ul({doc:t.doc,value:e.element.ds.value}).catch(Ye);if(i==null||(e.element.setDataSource(ve.VARIABLE,i.value),e.element.type!=j.TABLE_CELL||i.type!=="ds"))return;const a=e.element.parent;if(a==null||a.isBindVariable||((f=i.parent)==null?void 0:f.type)!==ee.ARRAY)return;const d=i.parent;a.setDataSource(ve.VARIABLE,`${Tt.DS}.${d.type}.${d.name}`)}return(i,a)=>(S(),N("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(S(),N(J,{key:0},[a[0]||(a[0]=u("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(y(F),{icon:"icon-open-new",size:"14px"})],64)):(S(),N(J,{key:1},[u("span",rh,"<"+X(y(Mr)(e.element.ds.value))+">",1),u("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},X(o.value),9,ah),u("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[p(y(F),{icon:"icon-close",size:"12px"})])],64))]))}}),uh=["value"],dh=V({__name:"Code",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=I(()=>oe(e.element.ds.value));function l(){return Kn(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){Hg("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(S(),N("div",{onClick:o,class:m(s.classes.code)},[u("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,uh),t.value?(S(),K(y(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2))}}),fh="_code_1az68_2",ph={code:fh},mh={classes:ph},gh=z(dh,[["__cssModules",mh]]),hh=["value"],vh=V({__name:"Formula",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Te(),l=I(()=>oe(e.element.ds.value)),o=I(()=>cl(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;No({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(S(),N("div",{onClick:s,class:m(r.classes.code)},[u("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,hh),l.value?(S(),K(y(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2))}}),bh="_code_ipm2q_2",yh={code:bh},_h={classes:yh},Eh=z(vh,[["__cssModules",_h]]);function Th(n){switch(n.ds.type){case ve.CONST:return p(ih,{element:n},null);case ve.VARIABLE:return p(ch,{element:n},null);case ve.CODE:return p(gh,{element:n},null);case ve.FORMULA:return p(Eh,{element:n},null);default:return null}}const Sh=V({props:{element:{type:pe,required:!0}},setup(n){const e=I(()=>en(n.element.type)),t=I(()=>Ts.filter(C=>C.value!=n.element.type)),l=ae("px"),o=nh(n),s=lh(n),r=th(n),i=Qg(n),a=eh(n),d=oh(n),f=sh(n),g=I(()=>{const C=n.element,x=C.parent;if(x===null||!(x instanceof Rt))return!1;const k=x.header;if(k.display&&C.bottom<=(k.height??0))return!1;const w=x.parent;if(w==null)return!1;const T=x.footer;return!(T.display&&C.top>=Math.floor(Vt(w.paper.height))-(T.height??0))});function v(C,x){return x==null?!1:!!x.includes(C)}function _(){const C=Xt(n.element.type);if(v(ce.LAYOUT,C==null?void 0:C.exclude))return null;const x=n.element,k=v(ce.COORD,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(rt,{class:"quickprint-form-inline-item",label:"左",modelValue:x.left,"onUpdate:modelValue":R=>x.left=R,target:l.value},null),p(rt,{class:"quickprint-form-inline-item",label:"上",modelValue:x.top,"onUpdate:modelValue":R=>x.top=R,target:l.value},null)])]),w=v(ce.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[ne("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(rt,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,"onUpdate:modelValue":R=>o.value=R,target:l.value},null),p(rt,{class:"quickprint-form-inline-item",label:"高",modelValue:s.value,"onUpdate:modelValue":R=>s.value=R,target:l.value},null)])]),T=v(ce.VISIBILITY,C==null?void 0:C.exclude)?null:p(Jg,{element:x},null),O=v(ce.OVERFLOW,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("溢出时")]),p("div",{class:"quickprint-config-content"},[p(Q,{modelValue:r.value,"onUpdate:modelValue":R=>r.value=R,options:Cs,class:"quickprint-w-full"},null)])]),A=v(ce.PRINT_MODE,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[ne("打印模式")]),p("div",{class:"quickprint-config-content"},[p(Q,{modelValue:a.value,"onUpdate:modelValue":R=>a.value=R,options:ws,class:"quickprint-w-full"},null)])]),B=v(ce.POSITION,C==null?void 0:C.exclude)||!g.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("定位模式")]),p("div",{class:"quickprint-config-content"},[p(Q,{modelValue:i.value,"onUpdate:modelValue":R=>i.value=R,options:ks,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[ne("布局")]),p("span",null,[ne("单位：")]),p(Lo,{modelValue:l.value,"onUpdate:modelValue":R=>l.value=R},null)]),k,w,T,O,A,B])}function b(){const C=Xt(n.element.type);if(v(ce.BASIC,C==null?void 0:C.exclude))return null;const x=n.element,k=v(ce.PREFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("前缀")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{"onUpdate:modelValue":O=>x.attributes.prefix=O,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ae,x.attributes.prefix]])])]),w=v(ce.SUFFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("后缀")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{"onUpdate:modelValue":O=>x.attributes.suffix=O,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ae,x.attributes.suffix]])])]),T=v(ce.DISPLAY,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("数据类型")]),p("div",{class:"quickprint-config-content"},[p(Q,{options:t.value,modelValue:d.value,"onUpdate:modelValue":O=>d.value=O,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ne("基础")]),k,w,T])}function c(){const C=Xt(n.element.display);return(C==null?void 0:C.display)==null?null:ct(C.display,{element:n.element})}function h(){const C=Xt(n.element.type);if(v(ce.ATTRIBUTES,C==null?void 0:C.exclude))return null;const x=C!=null&&C.attributes?ct(C.attributes,{element:n.element}):null,k=c();if(x==null&&k==null)return null;const w=k!=null&&x!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ne("属性")]),k,w,x])}function E(){const C=Xt(n.element.type);return v(ce.DATASOURCE,C==null?void 0:C.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ne("数据")]),p(Q,{options:Zl,modelValue:f.value,"onUpdate:modelValue":x=>f.value=x},null),Th(n.element)])}function D(C){C(n.element.id)}return function(){const x=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,ne("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[x.id]),p(qg,{onCopy:D},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ne("标题")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{type:"text","onUpdate:modelValue":k=>x.title=k,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ae,x.title]])])])]),_(),b(),h(),E()])])}}}),Rh=V({setup(){const n=Te(),e=ke("classes");function t(){return p("div",{class:e.tip},[ne("未知的打印元素")])}function l(){return p("div",{class:e.tip},[ne("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return p(hg,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(j).includes(i.type)===!1?t():ct(Sh,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==fe.ELEMENT?!1:i.selectMode===Qe.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),kh="_tip_cdonk_2",wh={tip:kh},Ch={classes:wh},Lh=z(Rh,[["__cssModules",Ch]]);function Fe(n,e){if(n.state.selectedType!==fe.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Me(n,e,t){if(n.state.selectedType!==fe.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function Pe(n,e){if(n.state.selectedType!==fe.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function Ih(n){const e="underline";return I({get(){if(n.state.selectedType!==fe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Me(n,e,t):Pe(n,e)}})}function Nh(n){const e="lineThrough";return I({get(){if(n.state.selectedType!==fe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Me(n,e,t):Pe(n,e)}})}function Oh(n){const e="lineHeight";return I({get(){return Fe(n,e)},set(t){t===vt.DEFAULT?Pe(n,e):Me(n,e,t)}})}function Dh(n){const e="highlightColor";return I({get(){return Fe(n,e)??Le.BLACK},set(t){t===""?Pe(n,e):Me(n,e,t)}})}function xh(n){const e="backgroundColor";return I({get(){return Fe(n,e)??Le.BLACK},set(t){t===""?Pe(n,e):Me(n,e,t)}})}function Ah(n){const e="fontStyle";return I({get(){return Fe(n,e)===vl.ITALIC},set(t){t?Me(n,e,vl.ITALIC):Pe(n,e)}})}function Mh(n){const e="textAlign";return I({get(){return Fe(n,e)??it.LEFT},set(t){t===it.LEFT?Pe(n,e):Me(n,e,t)}})}function qh(n){const e="verticalAlign";return I({get(){return Fe(n,e)??Xe.MIDDLE},set(t){t===Xe.MIDDLE?Pe(n,e):Me(n,e,t)}})}function Bh(n){const e="fontFamily";return I({get(){return Fe(n,e)},set(t){t===le.DEFAULT?Pe(n,e):Me(n,e,t)}})}function $h(n){const e="fontSize";return I({get(){return Fe(n,e)},set(t){t===be.DEFAULT?Pe(n,e):Me(n,e,t)}})}function Ph(n){const e="color";return I({get(){return Fe(n,e)??Le.BLACK},set(t){Me(n,e,t)}})}function Vh(n){const e="fontWeight";return I({get(){return Fe(n,e)===700},set(t){t?Me(n,e,700):Pe(n,e)}})}const Fh=["title","onClick"],zh=V({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=Te(),l=I(()=>{if(t.state.selectedType!==fe.ELEMENT)return null;const b=t.getSelectedElements();if(b.length!==1)return null;const c=b[0],h={};return me(c,"top")&&(h.borderTopStyle="solid"),me(c,"right")&&(h.borderRightStyle="solid"),me(c,"bottom")&&(h.borderBottomStyle="solid"),me(c,"left")&&(h.borderLeftStyle="solid"),h}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(_){if(t.state.selectedType!==fe.ELEMENT)return!1;const c=t.getSelectedElements();if(c.length!==1)return!1;const h=c[0];switch(_){case e.TOP:return me(h,"top");case e.RIGHT:return me(h,"right");case e.BOTTOM:return me(h,"bottom");case e.LEFT:return me(h,"left");case e.ALL:return me(h,"top")&&me(h,"right")&&me(h,"bottom")&&me(h,"left");default:return!1}}function r(_){if(t.state.selectedType!==fe.ELEMENT)return;const c=t.getSelectedElements();if(c.length!=0){switch(_){case e.TOP:return a(c);case e.BOTTOM:return f(c);case e.LEFT:return g(c);case e.RIGHT:return d(c);case e.ALL:return v(c)}t.createSnapshot()}}function i(){if(t.state.selectedType!==fe.ELEMENT)return;const b=t.getSelectedElements();if(b.length!=0){for(const c of b)c.setStyle("borderStyle",void 0),c.setStyle("borderTopStyle",void 0),c.setStyle("borderRightStyle",void 0),c.setStyle("borderBottomStyle",void 0),c.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function a(_){const b=!_.every(c=>me(c,"top"));for(const c of _)b?c.setStyle("borderTopStyle",re.SOLID):c.removeStyle("borderTopStyle")}function d(_){const b=!_.every(c=>me(c,"right"));for(const c of _)b?c.setStyle("borderRightStyle",re.SOLID):c.removeStyle("borderRightStyle")}function f(_){const b=!_.every(c=>me(c,"bottom"));for(const c of _)b?c.setStyle("borderBottomStyle",re.SOLID):c.removeStyle("borderBottomStyle")}function g(_){const b=!_.every(c=>me(c,"left"));for(const c of _)b?c.setStyle("borderLeftStyle",re.SOLID):c.removeStyle("borderLeftStyle")}function v(_){const b=!_.every(c=>me(c,"top")&&me(c,"right")&&me(c,"bottom")&&me(c,"left"));for(const c of _){if(b){c.setStyle("borderStyle",b?"solid":void 0);continue}c.removeStyle("borderStyle"),c.removeStyle("borderTopStyle"),c.removeStyle("borderRightStyle"),c.removeStyle("borderBottomStyle"),c.removeStyle("borderLeftStyle")}}return(_,b)=>(S(),K(y(oo),null,{popover:Se(()=>[u("div",{class:m(_.classes.popover)},[u("div",null,[(S(),N("button",{type:"button",title:"全部框线",key:y(e).ALL,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0,"quickprint-is-selected":s(y(e).ALL)}),onClick:b[0]||(b[0]=c=>r(y(e).ALL))},[p(y(F),{icon:"icon-border",size:"16px"})],2)),(S(),N("button",{type:"button",title:"无框线",key:y(e).NONE,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0}),onClick:i},[p(y(F),{icon:"icon-border-none",size:"16px"})],2))]),u("div",{class:m(_.classes.divider)},[(S(),N(J,null,se(o,c=>u("button",{type:"button",title:c.label,key:c.value,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0,"quickprint-is-selected":s(c.value)}),onClick:h=>r(c.value)},[p(y(F),{icon:c.icon,size:"16px"},null,8,["icon"])],10,Fh)),64))],2)],2)]),default:Se(()=>[u("div",{class:m(["quickprint-text-btn",_.classes.borderSelect]),title:"边框"},[u("div",{class:m({[_.classes.border]:!0}),style:Z(l.value)},null,6)],2)]),_:1}))}}),Uh="_border_rprfx_2",Hh="_borderSelect_rprfx_10",Gh="_popover_rprfx_14",Wh="_divider_rprfx_18",Yh={border:Uh,borderSelect:Hh,popover:Gh,divider:Wh},Xh={classes:Yh},jh=z(zh,[["__cssModules",Xh]]),Zh={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Kh={class:"quickprint-config-section"},Jh={class:"quickprint-form-inline"},Qh={class:"quickprint-config-section quickprint-config-inline"},ev={class:"quickprint-config-section"},tv={class:"quickprint-config-header quickprint-is-row"},nv={class:"quickprint-is-fill-w"},lv={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},ov={class:"quickprint-config-content quickprint-form-inline"},sv=V({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=ae("px"),l=v("top"),o=v("bottom"),s=v("left"),r=v("right"),i=I(()=>qn.map(_=>({label:_.size===Bn.CUSTOM?"自定义":`${_.size}(${_.width}mm ✕ ${_.height}mm)`,value:_.size})));function a(_){e.config.width=_,g()}function d(_){e.config.height=_,g()}function f(_){const b=qn.find(c=>c.size===_);b!=null&&(e.config.width=b.width,e.config.height=b.height,e.config.orientation=b.orientation,e.config.margins=b.margins,e.config.size=b.size)}function g(){const _=e.config,b=qn.find(c=>c.size===Bn.CUSTOM?!1:c.orientation===_.orientation&&c.width===_.width&&c.height===_.height);if(b==null){_.size=Bn.CUSTOM;return}_.size=b.size}function v(_){return I({get(){var b;return(b=e.config.margins)==null?void 0:b[_]},set(b){e.config.margins==null&&(e.config.margins={}),e.config.margins[_]=b}})}return(_,b)=>(S(),N("div",Zh,[u("section",Kh,[b[6]||(b[6]=u("header",{class:"quickprint-config-header"},[u("span",null,"尺寸")],-1)),p(y(Q),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":f,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),u("div",Jh,[p(xt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":a},null,8,["modelValue"]),p(xt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":d},null,8,["modelValue"])])]),u("section",Qh,[b[7]||(b[7]=u("header",{class:"quickprint-config-header"},"方向",-1)),p(Dt,{modelValue:n.config.orientation,"onUpdate:modelValue":b[0]||(b[0]=c=>n.config.orientation=c),options:y(Jl)},null,8,["modelValue","options"])]),u("section",ev,[u("header",tv,[u("span",nv,[p(y(Bs),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:Se(()=>b[8]||(b[8]=[ne("参考边距")])),_:1})]),b[9]||(b[9]=u("span",null,"单位：",-1)),p(Lo,{modelValue:t.value,"onUpdate:modelValue":b[1]||(b[1]=c=>t.value=c)},null,8,["modelValue"])]),u("div",lv,[p(rt,{class:"quickprint-form-inline-item",label:"上",modelValue:y(l),"onUpdate:modelValue":b[2]||(b[2]=c=>je(l)?l.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(rt,{class:"quickprint-form-inline-item",label:"下",modelValue:y(o),"onUpdate:modelValue":b[3]||(b[3]=c=>je(o)?o.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),u("div",ov,[p(rt,{class:"quickprint-form-inline-item",label:"左",modelValue:y(s),"onUpdate:modelValue":b[4]||(b[4]=c=>je(s)?s.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(rt,{class:"quickprint-form-inline-item",label:"右",modelValue:y(r),"onUpdate:modelValue":b[5]||(b[5]=c=>je(r)?r.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),iv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},rv={class:"quickprint-is-fill-h"},av={class:"quickprint-is-fill-h"},cv=V({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:_e.NONE},{label:"磅",value:_e.PT},{label:"像素",value:_e.PX}],l=I(()=>Nn.map(d=>(d.style={fontFamily:d.value==le.DEFAULT?le.SONG:d.value},d))),o=I(()=>vo.map(d=>(d.style={fontFamily:d.value==le.DEFAULT?le.SONG:d.value},d))),s=I({get(){return e.config.style.fontFamily??le.DEFAULT},set(d){const f=d===le.DEFAULT?void 0:d;e.config.style.fontFamily=f}}),r=I({get(){return e.config.style.enFontFamily??le.DEFAULT},set(d){const f=d===le.DEFAULT?void 0:d;e.config.style.enFontFamily=f}}),i=I({get(){return e.config.style.fontSize},set(d){const f=oe(d)?void 0:d;e.config.style.fontSize=f}}),a=I({get(){return e.config.style.lineHeight},set(d){e.config.style.lineHeight=d}});return(d,f)=>(S(),N("div",iv,[u("section",{class:m(d.classes.font)},[u("div",{class:m(d.classes.zhFont)},[u("div",{class:m(d.classes.title)},"中文字体",2),u("div",rv,[p(y(Q),{options:l.value,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g)},null,8,["options","modelValue"])])],2),u("div",{class:m(d.classes.enFont)},[u("div",{class:m(d.classes.title)},"西文字体",2),u("div",av,[p(y(Q),{options:o.value,modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=g=>r.value=g)},null,8,["options","modelValue"])])],2),u("div",{class:m(d.classes.lineHeight)},[u("div",{class:m(d.classes.title)},"行高",2),p(He,{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=g=>a.value=g),options:t},null,8,["modelValue"])],2),u("div",{class:m(d.classes.fontSize)},[u("div",{class:m(d.classes.title)},"字号",2),p(yo,{modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=g=>i.value=g),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),uv="_font_145qf_2",dv="_zhFont_145qf_9",fv="_enFont_145qf_16",pv="_lineHeight_145qf_23",mv="_fontSize_145qf_30",gv="_title_145qf_45",hv={font:uv,zhFont:dv,enFont:fv,lineHeight:pv,fontSize:mv,title:gv},vv={classes:hv},bv=z(cv,[["__cssModules",vv]]),yv=V({__name:"index",props:{doc:{type:he,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=tt(),l=Ie(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,a)=>(S(),N("div",{class:m(i.classes.setting)},[n.active=="paper"?(S(),K(sv,{key:0,config:l},null,8,["config"])):G("",!0),n.active=="font"?(S(),K(bv,{key:1,config:l},null,8,["config"])):G("",!0),u("div",{class:m(i.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),_v="_setting_h98ws_2",Ev="_footer_h98ws_10",Tv={setting:_v,footer:Ev},Sv={classes:Tv},Rv=z(yv,[["__cssModules",Sv]]),kv=Ne(function(n){return wt("文档",(e,t)=>p(Rv,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Oe)}),wv=V({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Te(),t=ke("classes"),l=Bh(e),o=$h(e),s=Oh(e),r=xh(e),i=Dh(e),a=Ph(e),d=Vh(e),f=Ah(e),g=Ih(e),v=Nh(e),_=Mh(e),b=qh(e),c=I(()=>Nn.map(L=>(L.style={fontFamily:L.value==le.DEFAULT?le.SONG:L.value},L)));function h(L){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>L.handler(e)},[L.icon&&p(F,{icon:L.icon},null),p("span",null,[L.label])])}function E(L){L.preventDefault()}function D(){d.value=!d.value}function C(){f.value=!f.value}function x(){g.value=!g.value}function k(){v.value=!v.value}function w(){const L=e.getSelectedElements();if(L.length==0)return;const M=Math.min(...L.map(P=>P.left));for(const P of L)P.setLeft(M,!0);e.createSnapshot()}function T(){const L=e.getSelectedElements();if(L.length==0)return;const M=L[0].page;if(M==null)return;const P=Vt(M.width);for(const q of L)q.setLeft((P-q.width)/2);e.createSnapshot()}function O(){const L=e.getSelectedElements();if(L.length==0)return;const M=Math.max(...L.map(P=>P.left+P.width));for(const P of L)P.setLeft(M-P.width,!0);e.createSnapshot()}async function A(){const L=await tc(e.doc);L!=null&&(e.doc.ds=e.doc.createDS(L))}function B(){kv(e.doc)}function R(L){var M,P;if(typeof L=="function")return L(e,t);if(typeof L=="object")return h(L);if(typeof L!="string")return null;switch(L){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const q=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:q,onClick:e.history.undo},[p(F,{icon:"icon-undo"},null)])}case"redo":{const q=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:q,onClick:e.history.redo},[p(F,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(F,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(Q,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":q=>l.value=q,options:c.value,class:t.tool,button:!0},null);case"fontSize":return p(Q,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":q=>o.value=q,options:dl,class:t.tool,button:!0},null);case"lineHeight":return p(Q,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":q=>s.value=q,options:bo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(Mt,{modelValue:r.value,"onUpdate:modelValue":q=>r.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(F,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return p(Mt,{modelValue:i.value,"onUpdate:modelValue":q=>i.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(F,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return p(Mt,{modelValue:a.value,"onUpdate:modelValue":q=>a.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(F,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"fontWeight":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":d.value};return p("button",{type:"button",title:"加粗",class:q,onClick:D},[p(F,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":f.value};return p("button",{type:"button",title:"斜体",class:q,onClick:C},[p(F,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":g.value};return p("button",{type:"button",title:"下划线",class:q,onClick:x},[p(F,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":v.value};return p("button",{type:"button",title:"删除线",class:q,onClick:k},[p(F,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(jh,null,null);case"textAlign":{const q=((M=Yn.find(ie=>ie.value===_.value))==null?void 0:M.label)??"水平对齐",ye={selected({option:ie}){return p(F,{icon:ie==null?void 0:ie.icon,class:"quickprint-is-self-center"},null)}};return p(Q,{modelValue:_.value,"onUpdate:modelValue":ie=>_.value=ie,options:Yn,title:q,class:t.tool,width:"36px",size:"mini",button:!0},ye)}case"verticalAlign":{const q=((P=Wn.find(ie=>ie.value===b.value))==null?void 0:P.label)??"垂直对齐",ye={selected({option:ie}){return p(F,{icon:ie==null?void 0:ie.icon,class:"quickprint-is-self-center"},null)}};return p(Q,{modelValue:b.value,"onUpdate:modelValue":ie=>b.value=ie,options:Wn,title:q,class:t.tool,width:"36px",size:"mini",button:!0},ye)}case"alignLeft":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:q,onClick:w},[p(F,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:q,onClick:T},[p(F,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:q,onClick:O},[p(F,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:q,onClick:e.toggleBackground},[p(F,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:q,onClick:e.toggleElementPanel},[p(F,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:q,onClick:e.toggleConfigPanel},[p(F,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:A},[p(F,{icon:"icon-datasource"},null),p("span",null,[ne("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:B},[p(F,{icon:"icon-file-text"},null),p("span",null,[ne("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:E},[n.toolbar.map(R)])}}}),Cv="_toolbar_1bhq2_2",Lv="_divider_1bhq2_8",Iv="_tool_1bhq2_2",Nv="_colorIcon_1bhq2_18",Ov="_colorIndicator_1bhq2_38",Dv={toolbar:Cv,divider:Lv,tool:Iv,colorIcon:Nv,colorIndicator:Ov},xv={classes:Dv},Av=z(wv,[["__cssModules",xv]]);function Mv(n){let e=null;const t=ue(),l=Ie({width:0,height:0,scrollTop:0,scrollLeft:0}),o=ue(),s=Ie({id:"",top:0,left:0,width:0,height:0});async function r(){await Ft();const _=t.value;_!=null&&(l.width=_.offsetWidth,l.height=_.offsetHeight)}function i(_){const b=_.target;l.scrollLeft=b.scrollLeft,l.scrollTop=b.scrollTop}function a(_){const c=_.target.closest("."+Y.PAPER);c!=null&&(o.value=c,f(c),d())}async function d(){await Ft();const _=o.value;_!=null&&(s.id=_.id.slice(1),s.width=_.offsetWidth,s.height=_.offsetHeight,s.top=_.offsetTop,s.left=_.offsetLeft)}function f(_){_!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(_))}function g(){const _=n.doc.firstPage;if(_==null)return;const b=document.querySelector("#\\@"+_.id);o.value=b,e&&b&&e.observe(b),d()}function v(_){_.some(b=>b.target.matches("."+Y.CANVAS))&&(r(),d()),_.some(b=>b.target.matches("."+Y.PAPER))&&(r(),d())}return sl(()=>n.state.scale,()=>d()),nn(()=>{e=new ResizeObserver(v),e.observe(t.value),g(),r()}),hs(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:a}}const Oo=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),qv=V({__name:"index",props:kt({modelValue:{type:he,required:!0},toolbar:{type:Array,default(){return Oo}}},{modelValue:{required:!0},modelModifiers:{}}),emits:kt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=ue(),o=ue(),s=Ns(),r=tn(n,"modelValue"),i=Np(r,{queryElement:E,dispatchEvent:D}),{canvasRef:a,canvasRect:d,pageRect:f,onScroll:g,onSelectPage:v}=Mv(i),_=I(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),b=I(()=>{const x=i.doc.style;return{fontFamily:Qn(x==null?void 0:x.fontFamily,x==null?void 0:x.enFontFamily),fontSize:x==null?void 0:x.fontSize,lineHeight:x==null?void 0:x.lineHeight}});function c(){i.state.panel.left=!1}function h(){i.state.panel.right=!1}function E(x){switch(x){case"ghost":return o.value;case"root":return l.value;default:return}}function D(x,...k){t(x,...k)}function C(x){x.deltaY>0?i.zoomIn():i.zoomOut()}return(x,k)=>(S(),N("div",{class:m(x.classes.designer),ref_key:"rootRef",ref:l,style:Z(_.value)},[u("div",{class:m(x.classes.header)},[Ke(x.$slots,"headerLeft"),p(Av,{class:m(x.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),Ke(x.$slots,"headerRight")],2),u("div",{class:m(x.classes.main)},[y(i).state.panel.left?(S(),N("div",{key:0,class:m(x.classes.left)},[u("button",{type:"button",onClick:c,class:m(["quickprint-text-btn",x.classes.closePanelBtn])},[p(y(F),{icon:"icon-close",size:"12px"})],2),p(qm)],2)):G("",!0),u("div",{class:m([x.classes.center,y(Y).CANVAS]),onWheel:te(C,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:a},[p(Dl,{canvas:y(d),page:y(f),scale:y(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Dl,{canvas:y(d),page:y(f),scale:y(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),u("div",{class:m([y(Y).SCROLLABLE,x.classes.canvas]),style:Z(b.value),onScroll:k[0]||(k[0]=(...w)=>y(g)&&y(g)(...w)),onClickCapture:k[1]||(k[1]=(...w)=>y(v)&&y(v)(...w))},[(S(!0),N(J,null,se(r.value.pages,w=>(S(),K(km,{key:w.id,doc:r.value,page:w},null,8,["doc","page"]))),128))],38),u("div",{class:m(x.classes.footer)},[p(Gm),p(y(ss),{scale:y(i).state.scale,onZoomIn:y(i).zoomIn,onZoomOut:y(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),y(i).state.panel.right?(S(),N("div",{key:1,class:m(x.classes.right)},[u("button",{type:"button",onClick:h,class:m(["quickprint-text-btn",x.classes.closePanelBtn])},[p(y(F),{icon:"icon-close",size:"12px"})],2),p(Lh)],2)):G("",!0)],2),u("div",{ref_key:"ghostRef",ref:o,class:m(x.classes.ghost)},null,2),p(y(is))],6))}}),Bv="_designer_grxxm_2",$v="_header_grxxm_17",Pv="_toolbar_grxxm_25",Vv="_footer_grxxm_31",Fv="_main_grxxm_47",zv="_left_grxxm_55",Uv="_center_grxxm_63",Hv="_right_grxxm_75",Gv="_canvas_grxxm_83",Wv="_closePanelBtn_grxxm_96",Yv="_ghost_grxxm_103",Xv={designer:Bv,header:$v,toolbar:Pv,footer:Vv,main:Fv,left:zv,center:Uv,right:Hv,canvas:Gv,closePanelBtn:Wv,ghost:Yv},jv={classes:Xv},Zv=z(qv,[["__cssModules",jv]]),Kv={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:dn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Oe)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:dn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:dn.DISABLED}};function Jv(n,e={}){const t=rs(e.zIndexManager);n.use(as,{zIndex:t,presets:Kv}),cs(n._context)}const Qv="0.0.0",eb={version:Qv,install:Jv},tb=["onClick"],nb=V({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=tt();function l(o){t==null||t.confirm(o)}return(o,s)=>(S(),N("div",{class:m(o.classes.panel)},[(S(!0),N(J,null,se(y(us),(r,i)=>(S(),N("div",{key:r.id,class:m(o.classes.item),onClick:a=>l(r)},[u("div",null,[u("span",null,X(i+1)+". ",1),u("span",null,X(r.name),1)])],10,tb))),128))],2))}}),lb="_panel_1he7q_2",ob="_item_1he7q_9",sb={panel:lb,item:ob},ib={classes:sb},rb=z(nb,[["__cssModules",ib]]),ab='<div class="quickprint-md"><h2>设计</h2><ul><li><s>feat: 边框设置</s></li><li>feat: 单元格设置<ul><li>单元格支持斜线分割，并设置文字</li><li><s>支持设置边框</s></li></ul></li><li>feat: 表格设置面板<ul><li>支持border-collapse</li></ul></li><li>feat: 文字方向<ul><li>参照wps文字方向</li><li>垂直文字合并 text-combine-upright</li></ul></li></ul><h2>预览</h2><ul><li>表格支持行合并</li></ul></div>',cb=["innerHTML"],ub=V({__name:"Todo",setup(n){return(e,t)=>(S(),N("div",{innerHTML:y(ab),class:m(e.classes.doc)},null,10,cb))}}),db="_doc_eo2ef_2",fb={doc:db},pb={classes:fb},mb=z(ub,[["__cssModules",pb]]),gb="local",Al="quickprint-local-define",hb=V({__name:"index",setup(n){const e=ke("classes"),t=_(),l="20250907",o=[{label:"新建",icon:"icon-file-text",handler:f},{label:"加载示例",icon:"icon-import",handler:a},"---",...Oo];function s(){const c=JSON.stringify(t.value);localStorage.setItem(Al,c)}function r(){s()}function i(){const c=t.value.id,h=c.startsWith("case_")?c:gb,E=`${window.location.origin}/preview.html?id=${h}`;s(),at("文档预览",ct("iframe",{src:E,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(D){window.open(E,"_blank"),D.close()}}]})}function a(){const c={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:dn.DISABLED};at("选择示例",ct(rb),c).promisify().then(h=>d(h.id)).catch(Oe)}async function d(c){const h=await bl(c,!1);h!=null&&(ds(c),t.value=he.create(h.define),g())}function f(){const c=he.createNormalDocument();t.value=c,g()}function g(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function v(){const c=localStorage.getItem(Al);if(c!=null)return he.create(c);const h=fs(),E=await bl(h.id,!1);return E==null?he.createNormalDocument():he.create(E.define)}function _(){const c=ae();return v().then(h=>{c.value=h,g()}),c}const b=Ne(function(){return at("待办事项",ct(mb)).promisify().catch(Ye)});return(c,h)=>y(t)?(S(),K(y(Zv),{modelValue:y(t),"onUpdate:modelValue":h[1]||(h[1]=E=>je(t)?t.value=E:null),toolbar:o,class:m(y(e).main),key:y(t).id,onSave:r,onPreview:i},{headerLeft:Se(()=>[u("div",{class:m(y(e).logo)},[h[2]||(h[2]=u("h1",null,"OpenPrint",-1)),u("div",{class:m(y(e).dev),onClick:h[0]||(h[0]=(...E)=>y(b)&&y(b)(...E))},"DEV_"+X(y(l)),3)],2)]),headerRight:Se(()=>[u("div",{class:m(y(e).operate)},[u("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[p(y(F),{icon:"icon-run"}),h[3]||(h[3]=u("span",null,"预览",-1))]),u("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[p(y(F),{icon:"icon-save"}),h[4]||(h[4]=u("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):G("",!0)}}),vb="_main_14ojw_2",bb="_iframe_14ojw_6",yb="_divider_14ojw_14",_b="_logo_14ojw_20",Eb="_dev_14ojw_39",Tb="_operate_14ojw_52",Sb={main:vb,iframe:bb,divider:yb,logo:_b,dev:Eb,operate:Tb},Rb={classes:Sb},kb=z(hb,[["__cssModules",Rb]]),Do=vs(kb);Do.use(eb);Do.mount("#app");
