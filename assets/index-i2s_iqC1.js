const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-DAbiSzqU.js","assets/vue-CaYzjicG.js","assets/component-D1Z1DBw2.js","assets/utils-BMR7IgXW.js","assets/utils-of1GTLjz.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Ls=Object.defineProperty;var ol=n=>{throw TypeError(n)};var Ns=(n,e,t)=>e in n?Ls(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var x=(n,e,t)=>Ns(n,typeof e!="symbol"?e+"":e,t),Rn=(n,e,t)=>e.has(n)||ol("Cannot "+t);var ye=(n,e,t)=>(Rn(n,e,"read from private field"),t?t.call(n):e.get(n)),Fe=(n,e,t)=>e.has(n)?ol("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),ct=(n,e,t,l)=>(Rn(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),_e=(n,e,t)=>(Rn(n,e,"access private method"),t);import{D as he,E as yt,N as Ht,a as pt,b as W,c as $e,P as Fn,d as Yt,e as il,f as an,g as cn,O as Xt,h as J,i as Qt,j as un,L as Re,I as O,_ as D,k as Ll,s as fn,l as $s,m as le,n as Is,B as Q,o as As,S as Un,p as Hn,F as ee,q as Gn,r as mt,V as We,U as qn,t as Wn,u as je,v as dn,w as Ze,A as xe,x as Nl,y as $l,z as Il,C as Al,G as de,H as ql,T as qs,J as pe,K as Ve,M as Et,Q as qe,R as Zt,W as Ke,X as Os,Y as Ms,Z as Ds,$ as Ol,a0 as Yn,a1 as Ps,a2 as tn,a3 as St,a4 as On,a5 as ht,a6 as fe,a7 as xs,a8 as nn,a9 as Ct,aa as gt,ab as Je,ac as Vs,ad as Tt,ae as Nt,af as zs,ag as Bs,ah as Fs,ai as Us,aj as Te,ak as Ee,al as Pt,am as rl,an as al,ao as Ln,ap as Nn,aq as Hs,ar as Gs,as as Ws,at as ln,au as Ys,av as Xs,aw as js,ax as Zs,ay as cl,az as Ks,aA as Js}from"./utils-BMR7IgXW.js";import{r as K,o as Xn,d as q,c as L,a as C,n as f,b as a,e as g,f as Ie,u as Oe,s as re,g as Pe,h as N,w as te,i as v,j,k as F,T as Ml,l as Y,m as kt,p as Kt,q as Dl,F as G,t as Z,v as B,x as xt,y as ul,z as Pl,A as xl,B as ge,C as Le,D as oe,E as se,G as Vt,H as Qs,I as Vl,J as Jt,K as jn,L as $n,M as me,N as eo,O as tt,P as to,Q as no,R as lo,S as so}from"./vue-CaYzjicG.js";const zl="@quickprint_drag_mode",Bl="@quickprint_drop_data",mn="@quickprint_operate",nt="@quickprint_element",Zn="@quickprint_element_type",Fl="@quickprint_resize_flag",_t=160,hn=32,Ut=[50,75,100,125,150,200,300,400];var Gt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Gt||{}),Rt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Rt||{});const lt={SINGLE:0,MULTIPLE:1},Ce=Object.freeze({INSERT:0,MOVE:1}),Kn=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),U=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),ue=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Ul=[{label:"固定值",value:he.CONST},{label:"变量",value:he.VARIABLE},{label:"公式",value:he.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:he.CODE,detail:"使用Javascript代码生成数据"}],oo=[{label:"显示",value:yt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:yt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:yt.CONDITION,detail:"元素只在满足指定条件后显示"}],io=[{label:"四舍五入",value:Ht.ROUND},{label:"向下舍入",value:Ht.FLOOR},{label:"向上舍入",value:Ht.CEIL},{label:"四舍六入",value:Ht.BANKER_ROUND}],ro=[{label:"原始值",value:pt.NONE},{label:"固定位数",value:pt.FIXED},{label:"金额千位",value:pt.THOUSAND},{label:"金额万位",value:pt.TEN_THOUSAND},{label:"金额大写",value:pt.DAXIE},{label:"百分比",value:pt.PERCENTAGE}],ao=[{label:"显示",value:!0},{label:"隐藏",value:!1}],co=[{label:"默认",value:void 0},{label:"文本",value:W.TEXT},{label:"数字",value:W.NUMBER},{label:"日期",value:W.DATE}],ne={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Hl=[{label:"年-月",value:$e.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:$e.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:$e.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:$e.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:$e.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:$e.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:$e.TIME,detail:"示例：12:00:00"},{label:"时:分",value:$e.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:$e.YEAR,detail:"示例：2024"},{label:"月",value:$e.MONTH,detail:"示例：12"},{label:"日",value:$e.DAY,detail:"示例：01"}];Hl.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const uo=[{label:"元素值",value:Fn.ELEMENT_VALUR}],po=[{label:"基于纸张",value:Yt.PAPER},{label:"基于内容",value:Yt.CONTENT}],Gl=[{label:"纵向",value:il.PORTRAIT},{label:"横向",value:il.LANDSCAPE}],fo=[{label:"当前位置",value:an.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:an.FIXED,detail:"元素会在固定位置显示，不参与分页"}],mo=[{label:"单次打印",value:cn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:cn.EACH,detail:"元素将每页打印一次"}],ho=[{label:"按内容调整高度",value:Xt.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:Xt.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:Xt.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Mn=[{label:"页码",value:Qt.PAGE_NUMBER,type:J.NUMBER},{label:"总页数",value:Qt.PAGE_TOTAL,type:J.NUMBER},{label:"行序号",value:Qt.ROW_INDEX,type:J.NUMBER},{label:"当前时间",value:Qt.CURRENT_DATE,type:J.DATE}],go=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function Wl(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function vo(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function Yl(n){return n.isSelected?n.type===W.PARAGRAPH?52:n.type===W.TABLE?32:20:20}function bo(){const n=K(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),Xn(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class yo{constructor(e,t,l){x(this,"originalEvent");x(this,"target");x(this,"ghost");x(this,"container");x(this,"paths",[]);x(this,"dropTarget");x(this,"top",0);x(this,"left",0);x(this,"deltaX");x(this,"deltaY");x(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const s=t.getBoundingClientRect();this.deltaX=s.left-e.clientX,this.deltaY=s.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var qt,Ot,ot,Xl,jl,Zl;const bt=class bt extends un{constructor(t={}){var l,s,o;super();Fe(this,ot);x(this,"context",null);x(this,"selector");x(this,"onDragStart");x(this,"scale");Fe(this,qt);Fe(this,Ot);this.selector={container:((l=t.selector)==null?void 0:l.container)??U.PAGE,element:((s=t.selector)==null?void 0:s.element)??U.DRAGGABLE,droppable:((o=t.selector)==null?void 0:o.droppable)??U.DROPPABLE},this.onDragStart=_e(this,ot,Xl).bind(this),this.scale=t.scale,ct(this,qt,_e(this,ot,jl).bind(this)),ct(this,Ot,_e(this,ot,Zl).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",ye(this,qt)),window.removeEventListener("pointerup",ye(this,Ot)),this.context=null)}};qt=new WeakMap,Ot=new WeakMap,ot=new WeakSet,Xl=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Re.warn(bt.TAG_NAME,"未找到的可拖拽元素");const s=this.selector.container,o=Wl(l,s);this.context=new yo(t,l,o);const c=this.createEvent("before-dragstart",this.context);if(this.dispatch(c).defaultPrevented)return Re.warn(bt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Re.warn(bt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const r=this.createEvent("dragstart",this.context);if(this.dispatch(r).defaultPrevented)return Re.warn(bt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",ye(this,qt)),window.addEventListener("pointerup",ye(this,Ot))},jl=function(t){const l=this.context;if(l==null)return;const s=l.container.getBoundingClientRect(),o=document.elementsFromPoint(t.clientX,t.clientY),c=Array.from(o).filter(i=>!(i===l.ghost||i===l.target||l.ghost.contains(i))),r=this.normalizeScale();l.originalEvent=t,l.paths=c,l.dropTarget=c.find(i=>i.matches("."+U.DROPPABLE)),l.top=(t.clientY+l.deltaY-s.top)/r,l.left=(t.clientX+l.deltaX-s.left)/r,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},Zl=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("dragend",l);this.dispatch(s).defaultPrevented||this.reset()},x(bt,"TAG_NAME","quickprint-draggable");let Dn=bt;const _o=["title"],Eo=q({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(C(),L("span",{title:n.title,class:f(e.classes.help)},[a("span",null,[Ie(e.$slots,"default")]),g(O,{icon:"icon-question-circle"})],10,_o))}}),To="_help_1l6l8_2",ko={help:To},wo={classes:ko},So=D(Eo,[["__cssModules",wo]]),Co=q({__name:"Popover",props:{width:{type:Number,default:null}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,s=t,o=Oe("classes"),c=K(!1),r=re(),i=re(),u=Pe({minWidth:0,top:0,left:0,visible:!1}),d=N(()=>({minWidth:l.width==null?u.minWidth+"px":l.width+"px",top:u.top+"px",left:u.left+"px",visibility:u.visible?"visible":"hidden",zIndex:Ll()}));async function h(){if(c.value)return m();c.value=!0,s("show"),await fn(),$()}function m(){M(),c.value=!1,s("close")}function b(E){if(!(E.target instanceof Node))return;const T=r.value;if(T&&T.contains(E.target))return E.preventDefault();const _=i.value;if(_&&_.contains(E.target))return E.preventDefault();m()}function y(){const E=r.value,T=i.value;if(T==null||E==null)return;const _=E.getBoundingClientRect(),k=T.getBoundingClientRect(),w=l.width==null?_.width:l.width;let R=_.bottom+1;R+k.height>window.innerHeight&&_.top>k.height&&(R=_.top-k.height-1);let I=_.left;I+k.width>window.innerWidth&&(I=window.innerWidth-k.width-2),u.minWidth=w,u.top=R,u.left=I,u.visible=!0}function p(E){const T=E.target;if(!(T instanceof HTMLElement))return;const _=r.value;_==null||!T.contains(_)||m()}function S(E){if(E.key!=="Escape")return;const T=i.value;if(T!=null){const _=T.style.zIndex;if(Number(_)<$s())return}E.preventDefault(),m()}function $(){window.addEventListener("click",b,{capture:!0}),window.addEventListener("contextmenu",m,{capture:!0}),window.addEventListener("scroll",p,{capture:!0,passive:!0}),window.addEventListener("resize",y),window.addEventListener("keydown",S)}function M(){window.removeEventListener("click",b,!0),window.removeEventListener("contextmenu",m,!0),window.removeEventListener("scroll",p,!0),window.removeEventListener("resize",y),window.removeEventListener("keydown",S)}return e({close:m}),(E,T)=>(C(),L("div",{class:f(v(o).reference),onClick:te(h,["stop"]),ref_key:"referenceRef",ref:r,tabindex:"0"},[Ie(E.$slots,"default"),c.value?(C(),j(Ml,{key:0,to:"body"},[a("div",{class:f(v(o).popover),onVnodeMounted:y,onMousedown:T[0]||(T[0]=te(()=>{},["prevent"])),style:Y(d.value),ref_key:"popoverRef",ref:i},[Ie(E.$slots,"popover")],38)])):F("",!0)],2))}}),Ro="_reference_1arli_2",Lo="_popover_1arli_7",No={reference:Ro,popover:Lo},$o={classes:No},Kl=D(Co,[["__cssModules",$o]]),Io=["title","onKeydown"],Ao=["onMouseover","onClick"],qo=q({__name:"Select",props:kt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:kt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,s=Oe("classes"),o=re(),c=re(),r=Kt(n,"modelValue"),i=K(),u=K(!1),d=Pe({width:0,top:0,left:0,visible:!1,scrollable:!1}),h=N(()=>l.teleport==="none"),m=N(()=>l.teleport=="none"?"body":l.teleport),b=N(()=>{const A={label:"",options:[]},P=[A];for(const z of l.options){if(Array.isArray(z.options)){P.push({label:z.label,options:z.options});continue}A.options.push(z)}return P}),y=N(()=>b.value.reduce((A,P)=>A.concat(P.options),[])),p=N(()=>{if(l.multiple!==!0){const P=Sn();return P?P.label:l.button?l.title:le(l.modelValue)?l.placeholder:l.modelValue}const A=Cn();return A.length>0?A.map(P=>P.label).join(","):l.button?l.title:l.placeholder}),S=N(()=>l.clearable!==!0?!1:l.modelValue!=null),$=N(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[s.mini]:l.size==="mini",[s.select]:!0,[s.appearance]:l.appearance!=="none"&&!S.value,[s.button]:l.button,[s.showClearIcon]:S.value,[s.text]:l.size==="text"})),M=N(()=>({width:l.width})),E=N(()=>d.visible?{width:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",top:d.top+"px",left:d.left+"px",visibility:"visible",zIndex:Ll()}:{minWidth:l.popoverWidth==null?d.width+"px":l.popoverWidth+"px",visibility:"hidden"}),T=N(()=>({[s.content]:!0,[s.placeholder]:Is(l.modelValue)}));async function _(){if(l.disabled)return;const A=y.value;if(A.length===0)return;if(u.value)return k();const P=o.value;P!=null&&(d.width=P.getBoundingClientRect().width,d.visible=!1,i.value=A.find(z=>z.value===l.modelValue),u.value=!0,await fn(),Cs())}function k(){Rs(),u.value=!1}function w(A){V(),at()}function R(A){A.disabled!==!0&&(i.value=A)}function I(A){if(l.disabled==!0||A.disabled===!0)return;if(l.multiple!==!0){r.value=A.value,t("select",A),k();return}const P=Array.isArray(r.value)?r.value:[],z=P.findIndex(ae=>ae===A.value);z>=0?P.splice(z,1):P.push(A.value),r.value=P,t("select",P)}function H(A){if(!(A.target instanceof Node))return;const P=o.value;if(P&&P.contains(A.target))return A.preventDefault();const z=c.value;if(z&&z.contains(A.target))return A.preventDefault();k()}async function V(){const A=o.value,P=c.value;if(P==null||A==null)return;await xt();const z=A.getBoundingClientRect(),ae=P.getBoundingClientRect();let ce=z.bottom+1;ce+ae.height>window.innerHeight&&z.top>ae.height&&(ce=z.top-ae.height-1);let wt=z.left;wt+ae.width>window.innerWidth&&(wt=window.innerWidth-ae.width-2),d.width=ae.width,d.top=ce,d.left=wt,d.visible=!0;const Ft=P.querySelector("."+s.list);d.scrollable=Ft?Ft.scrollHeight>Ft.clientHeight:!1}function ie(A){const P=A.target;if(!(P instanceof HTMLElement))return;const z=o.value;z==null||!P.contains(z)||k()}function ke(){const A=y.value,P=ul(i.value);if(P==null){i.value=Bt(0),at();return}const z=A.indexOf(P);if(z==0)return Se();const ae=Bt(z-1);ae!=null&&(i.value=ae,at())}function De(){const A=y.value,P=ul(i.value);if(P==null){i.value=Be(0),at();return}const z=A.indexOf(P);if(z>=A.length-1){we();return}const ae=Bt(z+1);ae!=null&&(i.value=ae,at())}function we(){i.value=Be(0),at()}function Se(){const A=y.value;i.value=Bt(A.length-1),at()}function rt(){r.value=void 0,k()}function Be(A){const z=y.value[A];return z==null?null:z.disabled===!0?Be(A+1):z}function Bt(A){const z=y.value[A];return z==null?null:z.disabled===!0?Bt(A-1):z}function sl(A){switch(A.key){case"Enter":A.preventDefault(),i.value&&I(i.value);return;case"Escape":A.preventDefault(),k();return;case"ArrowUp":A.preventDefault(),ke();return;case"ArrowDown":A.preventDefault(),De();return;case"Home":A.preventDefault(),we();return;case"End":A.preventDefault(),Se();return}}function ws(A){if(l.disabled)return;const P=o.value;P!=null&&document.activeElement===P&&(u.value||(A.stopPropagation(),_()))}function Ss(A){if(l.multiple!==!0)return l.modelValue===A.value;const P=l.modelValue;return Array.isArray(P)?P.includes(A.value):!1}async function at(){if(i.value==null)return;await xt();const A=c.value;if(A==null)return;const P=A.querySelector("."+s.hover);P&&P.scrollIntoView({block:"nearest"})}function Sn(){const A=y.value,P=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return A.find(z=>z.value===P)}function Cn(){const A=y.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(z=>z).map(z=>{const ae=A.find(ce=>ce.value===z);return ae||{value:z,label:z}})}function Cs(){window.addEventListener("mousedown",H,{capture:!0}),window.addEventListener("pointerdown",H,{capture:!0}),window.addEventListener("contextmenu",k,{capture:!0}),window.addEventListener("scroll",ie,{capture:!0,passive:!0}),window.addEventListener("resize",V),window.addEventListener("keydown",sl)}function Rs(){window.removeEventListener("mousedown",H,!0),window.removeEventListener("pointerdown",H,!0),window.removeEventListener("contextmenu",k,!0),window.removeEventListener("scroll",ie,!0),window.removeEventListener("resize",V),window.removeEventListener("keydown",sl)}return(A,P)=>{var z;return C(),L("div",{class:f($.value),title:n.title,style:Y(M.value),onClick:te(_,["stop"]),onKeydown:Dl(te(ws,["prevent"]),["enter"]),ref_key:"selectRef",ref:o,tabindex:"0"},[A.$slots.selected?Ie(A.$slots,"selected",{key:0,option:Sn(),options:Cn()}):Ie(A.$slots,"option",{key:1,option:Sn(),options:Cn()},()=>[a("div",{class:f(T.value)},[a("span",null,B(p.value),1),S.value?(C(),j(O,{key:0,icon:"icon-close",onClick:te(rt,["stop"]),size:"12px",class:f(v(s).clearIcon)},null,8,["class"])):F("",!0)],2)]),u.value?(C(),j(Ml,{key:2,to:m.value,disabled:h.value},[a("div",{class:f(v(s).popover),onClick:P[0]||(P[0]=te(()=>{},["stop"])),onVnodeMounted:w,onMousedown:P[1]||(P[1]=te(()=>{},["prevent"])),style:Y(E.value),ref_key:"popoverRef",ref:c},[a("div",{class:f(v(s).list)},[(C(!0),L(G,null,Z(b.value,ae=>(C(),L(G,null,[ae.label?(C(),L("div",{key:0,class:f(v(s).groupLabel)},B(ae.label),3)):F("",!0),(C(!0),L(G,null,Z(ae.options,ce=>{var wt;return C(),L("div",{key:ce.value,class:f({[v(s).option]:!0,[v(s).disabled]:ce.disabled===!0,[v(s).selected]:Ss(ce),[v(s).hover]:((wt=i.value)==null?void 0:wt.value)==ce.value}),style:Y(ce.style),onMouseover:Ft=>R(ce),onClick:Ft=>I(ce)},[Ie(A.$slots,"option",{option:ce},()=>[a("div",{class:f(v(s).label)},[ce.icon?(C(),j(O,{key:0,icon:ce.icon,class:f(v(s).icon)},null,8,["icon","class"])):F("",!0),a("span",null,B(ce.label),1)],2),ce.short?(C(),L("div",{key:0,class:f(v(s).short)},B(ce.short),3)):F("",!0)])],46,Ao)}),128))],64))),256))],2),(z=i.value)!=null&&z.detail&&d.visible?(C(),L("div",{key:0,class:f(v(s).detail)},B(i.value.detail),3)):F("",!0)],38)],8,["to","disabled"])):F("",!0)],46,Io)}}}),Oo="_button_1h82x_2",Mo="_select_1h82x_7",Do="_appearance_1h82x_16",Po="_content_1h82x_31",xo="_placeholder_1h82x_37",Vo="_popover_1h82x_41",zo="_list_1h82x_51",Bo="_option_1h82x_80",Fo="_label_1h82x_95",Uo="_icon_1h82x_100",Ho="_hover_1h82x_104",Go="_detail_1h82x_115",Wo="_short_1h82x_125",Yo="_selected_1h82x_131",Xo="_disabled_1h82x_135",jo="_showClearIcon_1h82x_140",Zo="_clearIcon_1h82x_144",Ko="_text_1h82x_157",Jo="_mini_1h82x_169",Qo="_groupLabel_1h82x_181",ei={button:Oo,select:Mo,appearance:Do,content:Po,placeholder:xo,popover:Vo,list:zo,option:Bo,label:Fo,icon:Uo,hover:Ho,detail:Go,short:Wo,selected:Yo,disabled:Xo,showClearIcon:jo,clearIcon:Zo,text:Ko,mini:Jo,groupLabel:Qo},ti={classes:ei},X=D(qo,[["__cssModules",ti]]),ni="_tree_1p28f_1",li="_node_1p28f_5",si="_content_1p28f_11",oi="_space_1p28f_27",ii="_expand_1p28f_28",ri="_active_1p28f_47",ai="_children_1p28f_55",Ye={tree:ni,node:li,content:si,space:oi,expand:ii,active:ri,children:ai},Jl=Symbol(),Ql=q({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Pl(Jl),l=N(()=>Array.isArray(n.node.children)&&n.node.children.length>0),s=N({get(){const p=t==null?void 0:t.state[n.node.value];return p==null?!1:p.expand},set(p){const S=t==null?void 0:t.state[n.node.value];S!=null&&(S.expand=p)}});function o(p){p.preventDefault(),s.value=!s.value}function c(){if(!l.value)return g("div",{class:Ye.space},null);const p={[Ye.expand]:!0,[Ye.active]:s.value};return g("div",{onMousedown:y,onClick:o,class:p},[g(O,{icon:"icon-right",size:"12px"},null)])}function r(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):g("span",null,[n.node.label])}function i(){return g("div",{class:Ye.content,onClick:d,onMouseenter:m},[r()])}function u(){if(!l.value||!s.value)return;const p=n.node.children.map(S=>g(Ql,{node:S,onNodeClick:h,onNodeHover:b},null));return g("div",{class:Ye.children},[p])}function d(){e("nodeClick",n.node)}function h(p){e("nodeClick",p)}function m(){e("nodeHover",n.node)}function b(p){e("nodeHover",p)}function y(p){p.preventDefault()}return function(){return g("div",{class:Ye.subTree},[g("div",{class:Ye.node},[c(),i()]),u()])}}}),ci=q({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=c();function s(i){t("nodeClick",i)}function o(i){t("nodeHover",i)}function c(){const i=Pe({}),u=function(d,h){for(const m of d)h[m.value]={expand:m.expand!==!1},m.children&&u(m.children,h)};return u(n.data,i),i}function r(i){return typeof e.default=="function"?e.default(i):null}return xl(Jl,{state:l,content:r}),function(){const i=n.data.map(u=>g(Ql,{node:u,onNodeClick:s,onNodeHover:o},null));return g("div",{class:Ye.tree},[i])}}});function ui(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function di(n,e=0){let t=0,l=null;return function(...s){const o=Date.now();if(o-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,s),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,s),t=o}}function Jn(n,e){const t=[];if(e&&e!=ee.DEFAULT&&t.push(`"${e}"`),n&&n!==ee.DEFAULT&&t.push(`"${n}"`),t.length!=0)return t.join(",")}function es(n){if(n.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:n.underlineStyle,textDecorationColor:n.underlineColor}}function pi(n,e={}){const t={},l=n.style??{},s=Jn(l.fontFamily,l.enFontFamily);s&&(t.fontFamily=s);const o=es(l);return o&&mt(t,o),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),fi("border",e)&&l.border&&mt(t,Pn(n)),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.padding&&mt(t,gi(n)),mt(t,mi(n)),mt(t,hi(n)),t}function fi(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}function mi(n){if(n==null)return{};const e=n.style??{},t={};return e.textAlign&&(t.textAlign=e.textAlign),e.textAlignLast&&(t.textAlignLast=e.textAlignLast),t}function hi(n){if(n==null)return{};const e=n.style??{};return e.verticalAlign==We.MIDDLE||e.verticalAlign==null?{display:"flex",alignItems:"center"}:e.verticalAlign==We.BOTTOM?{display:"flex",alignItems:"end"}:{}}function gi(n){if(n==null)return{};const e=n.style??{};if(e.padding==null)return{};const t={};return e.padding.top&&(t.paddingTop=e.padding.top),e.padding.right&&(t.paddingRight=e.padding.right),e.padding.bottom&&(t.paddingBottom=e.padding.bottom),e.padding.left&&(t.paddingLeft=e.padding.left),t}function Pn(n){if(n==null)return{};const e=n.style??{};if(e.border==null||e.border===Q.NONE)return{};const t={},l=e.borderWidth??1,s=e.borderStyle??As.SOLID,o=e.borderColor??Un.BLACK;return e.border==Q.ALL?{borderTop:`${l}px ${s} ${o}`,borderRight:`${l}px ${s} ${o}`,borderBottom:`${l}px ${s} ${o}`,borderLeft:`${l}px ${s} ${o}`}:(e.border&Q.TOP&&(t.borderTop=`${l}px ${s} ${o}`),e.border&Q.RIGHT&&(t.borderRight=`${l}px ${s} ${o}`),e.border&Q.BOTTOM&&(t.borderBottom=`${l}px ${s} ${o}`),e.border&Q.LEFT&&(t.borderLeft=`${l}px ${s} ${o}`),t)}const vt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(vt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(vt.SPACE).filter(s=>Hn(s));return t.indexOf(e)>=0?n:(t.push(e),t.join(vt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(vt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(vt.SPACE))}};function Ge(n){if(le(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=Gn(t)?t:null,s=le(e[2])?null:e[2];return{num:l,unit:s}}function dl(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=Ge(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return qn.pt_to_px(e.num);case"mm":return qn.mm_to_px(e.num);default:return null}}function Qn(n,e){const t=n.ds;if(t!=null)return t.type===he.FORMULA?{type:t.type,content:el(t.value,n.doc)}:t.type===he.VARIABLE?{type:t.type,content:st(t.value,e)}:{type:t.type,content:t.value}}function st(n,e){var m,b,y;if(le(n))return n;const t=Wn(n),l=t.path;if(l==null||l=="")return;const s=l.split(".");if(s.length==0)return l;const o=s[0];if(t.varType===je.BUILTIN)return((m=Mn.find(p=>p.value===o))==null?void 0:m.label)??o;if(t.varType===je.SPECIAL)return((b=uo.find(p=>p.value===o))==null?void 0:b.label)??o;if(e==null)return l;const r=(e.fields??[]).find(p=>p.name===o);if(r==null)return l;const i=s[1],u=le(r.title)?r.name:r.title;if(i==null)return u;const d=(y=r.children)==null?void 0:y.find(p=>p.name===i);if(d==null)return`${u}.${i}`;const h=le(d.title)?d.name:d.title;return`${u}.${h}`}function el(n,e){return le(n)?void 0:dn.tokenize(n).map(s=>s.type===Ze.VARIABLE?`[${st(s.value,e==null?void 0:e.ds)}]`:s.type===Ze.REFERENCE?`[${ts(s.value,e)}]`:s.type===Ze.TEMPLATE?(Array.isArray(s.value)?s.value:[s.value]).map(c=>c.type===Ze.VARIABLE?`[${st(c.value,e==null?void 0:e.ds)}]`:c.value).join(""):dn.formatTokenValue(s)).join("")}function ts(n,e){if(e){const t=e.findElement(n);if(t&&t.title)return"="+t.title}return"="+n}function vi(n){switch(Wn(n).dataType){case J.OBJECT:return"对象";case J.ARRAY:return"数组";case J.STRING:return"文本";case J.NUMBER:return"数字";case J.DATE:return"日期";case J.BOOLEAN:return"布尔";default:return"未知类型"}}function bi(n){var e;return((e=Ul.find(t=>t.value===n))==null?void 0:e.label)??n}const yi=["onClick"],_i=q({__name:"WindowHeader",props:{modelValue:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=xe(),l=e;function s(o){l("update:modelValue",o.value)}return(o,c)=>(C(),L("div",{class:f(o.classes.header)},[a("div",{class:f(o.classes.headerLeft)},[Ie(o.$slots,"prefix"),a("div",{class:f(o.classes.tabs)},[(C(!0),L(G,null,Z(n.tabs,r=>(C(),L("div",{key:r.value,class:f({[o.classes.tab]:!0,[o.classes.active]:n.modelValue===r.value}),onClick:i=>s(r),onPointerdown:c[0]||(c[0]=te(()=>{},["stop","prevent"]))},[a("span",null,B(r.label),1)],42,yi))),128))],2)],2),v(t)?(C(),j(v(Nl),{key:0,instance:v(t)},null,8,["instance"])):F("",!0)],2))}}),Ei="_header_1o09p_2",Ti="_headerLeft_1o09p_14",ki="_tabs_1o09p_27",wi="_tab_1o09p_27",Si="_active_1o09p_69",Ci={header:Ei,headerLeft:Ti,tabs:ki,tab:wi,active:Si},Ri={classes:Ci},ns=D(_i,[["__cssModules",Ri]]),gn=$l(()=>Il(()=>import("./component-DAbiSzqU.js"),__vite__mapDeps([0,1]))),Li=["onClick","onMouseenter"],Ni=q({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=K(Mn[0].value),s=N(()=>`builtin_${Al(l.value,"_").toLowerCase()}`);function o(r){t("select",r)}function c(r){l.value=r.value}return(r,i)=>(C(),L("div",{class:f(r.classes.builtin)},[a("div",{class:f(["quickprint-is-scrollable",r.classes.panel])},[(C(!0),L(G,null,Z(v(Mn),u=>(C(),L("div",{class:f({[r.classes.param]:!0,[r.classes.active]:u.value===l.value}),onClick:d=>o(u),onMouseenter:d=>c(u)},[a("strong",null,B(u.label),1),a("span",null,B(u.value),1)],42,Li))),256))],2),a("div",{class:f(["quickprint-is-scrollable",r.classes.desc])},[g(v(gn),{name:s.value},null,8,["name"])],2)],2))}}),$i="_builtin_m1n0z_2",Ii="_panel_m1n0z_11",Ai="_desc_m1n0z_17",qi="_param_m1n0z_24",Oi="_active_m1n0z_34",Mi={builtin:$i,panel:Ii,desc:Ai,param:qi,active:Oi},Di={classes:Mi},Pi=D(Ni,[["__cssModules",Di]]),pl=[{label:"文本",value:J.STRING},{label:"数字",value:J.NUMBER},{label:"日期",value:J.DATE},{label:"对象",value:J.OBJECT},{label:"数组",value:J.ARRAY}],xi=q({emit:["select"],props:{doc:{type:de,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Oe("classes"),s=xe(),o=i(),c=r();function r(){const S=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render($,M,E){var T;if(n.readonly){const _=$[M.name],k=((T=pl.find(w=>w.value===_))==null?void 0:T.label)??_;return g("div",{class:E.classes.cell},[k])}return g("div",{class:E.classes.cell},[g(X,{options:pl,modelValue:$.type,"onUpdate:modelValue":b.bind(null,$),size:"small"},null)])}},{name:"name",title:"名称",width:180,render($,M,E){return n.readonly?g("div",{class:E.classes.cell},[$[M.name]]):g("div",{class:E.classes.cell},[ge(g("input",{"onUpdate:modelValue":T=>$.name=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Le,$.name]])])}},{name:"title",title:"标题",width:180,render($,M,E){return n.readonly?g("div",{class:E.classes.cell},[$[M.name]]):g("div",{class:E.classes.cell},[ge(g("input",{"onUpdate:modelValue":T=>$.title=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Le,$.title]])])}}];return n.readonly!==!0&&S.push({name:"operate",title:"操作",width:200,render($,M,E){const T=[g("button",{type:"button",class:"quickprint-text-btn",onClick:d.bind(null,$,E.parent)},[g(O,{icon:"icon-subnode"},null),g("span",null,[oe("插入行")])])];return($.type===J.ARRAY||$.type===J.OBJECT)&&T.push(g("button",{type:"button",class:"quickprint-text-btn",onClick:m.bind(null,$)},[g(O,{icon:"icon-sisternode"},null),g("span",null,[oe("插入子级")])])),T.push(g("button",{type:"button",class:"quickprint-text-btn",onClick:h.bind(null,$,E.parent)},[g(O,{icon:"icon-delete"},null),g("span",null,[oe("删除")])])),T}}),S}function i(){const S=ql(n.doc.ds.fields??[]).map(M=>{const E=M.type;return{...M,$expand:E===J.ARRAY||E===J.OBJECT}}),$=K(S);return $.value.length==0&&$.value.push(u()),$}function u(){return{type:J.STRING,name:"",title:""}}function d(S,$){if($){const E=$.children??[],T=E.indexOf(S);T>=0&&E.splice(T+1,0,u());return}const M=o.value.indexOf(S);M>=0&&o.value.splice(M+1,0,u())}function h(S,$){if($){const E=$.children??[],T=E.indexOf(S);T>=0&&E.splice(T,1);return}const M=o.value.indexOf(S);M>=0&&o.value.splice(M,1),o.value.length==0&&o.value.push(u())}function m(S){S.type!==J.ARRAY&&S.type!==J.OBJECT||(S.children==null&&(S.children=[]),S.children.push(u()))}function b(S,$){S.type=$,$===J.ARRAY||$===J.OBJECT?S.$expand=!0:S.children=void 0}function y(){return{fields:o.value.map($=>le($.name)?null:$.type!==J.ARRAY&&$.type!==J.OBJECT?{type:$.type,name:$.name,title:$.title}:{type:$.type,name:$.name,title:$.title,children:($.children??[]).map(M=>le($.name)?null:{type:M.type,name:M.name,title:M.title}).filter(M=>M!=null)}).filter($=>$!=null)}}function p(S,$){n.readonly===!0&&t("select",S,$)}return s==null||s.useHandle("confirm",y),e({submit:y}),function(){return g("div",{class:l.datasource},[g(qs,{columns:c,data:o.value,onSelect:p},null)])}}}),Vi="_datasource_xlc8o_2",zi={datasource:Vi},Bi={classes:zi},ls=D(xi,[["__cssModules",Bi]]),Fi={class:"quickprint-config-group"},Ui={class:"quickprint-config-section quickprint-config-inline"},Hi={class:"quickprint-config-content"},Gi={class:"quickprint-config-section quickprint-config-inline"},Wi={class:"quickprint-config-content"},Yi={class:"quickprint-config-id"},Xi={class:"quickprint-config-section quickprint-config-inline"},ji={class:"quickprint-config-content"},Zi={class:"quickprint-config-group"},Ki={class:"quickprint-config-group-title"},Ji=q({__name:"Detail",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N(()=>{var l,s;return(s=Qn(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:s.content});return(l,s)=>(C(),L("div",{class:f(l.classes.detail)},[a("div",Fi,[a("section",Ui,[s[0]||(s[0]=a("header",{class:"quickprint-config-header"},"类型",-1)),a("div",Hi,B(v(jt)(n.element.type)),1)]),a("section",Gi,[s[1]||(s[1]=a("header",{class:"quickprint-config-header"},"标识",-1)),a("div",Wi,[a("span",Yi,B(n.element.id),1)])]),a("section",Xi,[s[2]||(s[2]=a("header",{class:"quickprint-config-header"},"标题",-1)),a("div",ji,B(n.element.title),1)])]),a("div",Zi,[a("div",Ki,[s[3]||(s[3]=a("span",null,"数据",-1)),a("span",{class:f(l.classes.type)},B(v(bi)(n.element.ds.type)),3)]),a("div",null,B(t.value),1)])],2))}}),Qi="_detail_11ox4_2",er="_type_11ox4_10",tr={detail:Qi,type:er},nr={classes:tr},lr=D(Ji,[["__cssModules",nr]]),sr=q({__name:"index",props:{doc:{type:de,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,s=r(),o=K();function c(m){return m.reduce((b,y)=>{const p=Array.isArray(y.children)?c(y.children):[];if(Hn(y.ds.value)||p.length>0){const S={value:y.id,label:y.title??y.id,data:y,children:p};return b.push(S),b}return b},[])}function r(){const m=l.doc.pages.reduce((y,p)=>y.concat(p.children),[]),b=c(m);return K(b)}function i(m){o.value=m}function u(m){return m.title?m.title:jt(m.type)}function d(m){return ed(m.type)??"icon-zhanweifu"}function h(m){t("select",m.data)}return(m,b)=>(C(),L("div",{class:f(m.classes.reference)},[a("div",{class:f([m.classes.panel,"quickprint-is-scrollable"])},[g(v(ci),{data:v(s),onNodeHover:i,onNodeClick:h},{default:se(({node:y})=>[g(v(O),{icon:d(y.data)},null,8,["icon"]),a("span",{class:f(m.classes.title)},B(u(y.data)),3),a("span",{class:f(m.classes.id)},"<"+B(y.value)+">",3)]),_:1},8,["data"])],2),a("div",{class:f([m.classes.detail,"quickprint-is-scrollable"])},[o.value?(C(),j(lr,{element:o.value.data,key:o.value.value},null,8,["element"])):F("",!0)],2)],2))}}),or="_reference_1ekkx_2",ir="_panel_1ekkx_12",rr="_detail_1ekkx_20",ar="_title_1ekkx_25",cr="_id_1ekkx_29",ur={reference:or,panel:ir,detail:rr,title:ar,id:cr},dr={classes:ur},pr=D(sr,[["__cssModules",dr]]),fr=q({__name:"index",props:{doc:{type:de,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}}},setup(n){const e=n,t=[{label:"数据源",value:"ds"},{label:"内置变量",value:"builtin"},{label:"引用组件",value:"reference"}],l=xe(),s=K(d()),o=N(()=>t.filter(h=>e.include.includes(h.value)));function c(h,m){return h==null?null:m==null?`${je.DS}.${h.type}.${h.name}`:`${je.DS}.${h.type}.${m.name}.${h.name}`}function r(h,m){l==null||l.confirm({type:"ds",value:c(h,m),parent:m})}function i(h){l==null||l.confirm({type:"builtin",value:`${je.BUILTIN}.${h.type}.${h.value}`})}function u(h){l==null||l.confirm({type:"reference",value:h.id})}function d(){const h=e.value;return h==null||h==""?"ds":Wn(h).varType===je.BUILTIN?"builtin":"ds"}return(h,m)=>(C(),L("div",{class:f(h.classes.var)},[g(ns,{modelValue:s.value,"onUpdate:modelValue":m[0]||(m[0]=b=>s.value=b),tabs:o.value},{prefix:se(()=>[g(v(O),{icon:"icon-datasource",size:"16px"}),a("span",{class:f(h.classes.title)},"变量",2)]),_:1},8,["modelValue","tabs"]),s.value==="ds"?(C(),j(ls,{key:0,doc:n.doc,onSelect:r,readonly:""},null,8,["doc"])):F("",!0),s.value==="builtin"?(C(),j(Pi,{key:1,onSelect:i})):F("",!0),s.value==="reference"?(C(),j(pr,{key:2,doc:n.doc,onSelect:u},null,8,["doc"])):F("",!0)],2))}}),mr="_title_wuhum_10",hr={var:"_var_wuhum_2",title:mr},gr={classes:hr},ss=D(fr,[["__cssModules",gr]]),vr=["onClick","onMouseenter"],br=q({__name:"String",emits:["select"],setup(n,{emit:e}){const t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=e,s=K(t[0].value),o=N(()=>`function_${s.value.toLowerCase()}`);function c(i){l("select",i.value)}function r(i){s.value=i.value}return(i,u)=>(C(),L("div",{class:f(i.classes.string)},[a("div",{class:f(["quickprint-is-scrollable",i.classes.panel])},[(C(),L(G,null,Z(t,d=>a("div",{key:d.value,class:f({[i.classes.option]:!0,[i.classes.active]:d.value===s.value}),onClick:h=>c(d),onMouseenter:h=>r(d)},[a("strong",null,B(d.label),1)],42,vr)),64))],2),a("div",{class:f(["quickprint-is-scrollable",i.classes.desc])},[g(v(gn),{name:o.value},null,8,["name"])],2)],2))}}),yr="_string_shs83_2",_r="_panel_shs83_10",Er="_desc_shs83_16",Tr="_option_shs83_23",kr="_active_shs83_33",wr={string:yr,panel:_r,desc:Er,option:Tr,active:kr},Sr={classes:wr},Cr=D(br,[["__cssModules",Sr]]),Rr=["onClick","onMouseenter"],Lr=q({__name:"Number",emits:["select"],setup(n,{emit:e}){const t=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"}],l=e,s=K(t[0].value),o=N(()=>`function_${s.value.toLowerCase()}`);function c(i){l("select",i.value)}function r(i){s.value=i.value}return(i,u)=>(C(),L("div",{class:f(i.classes.string)},[a("div",{class:f(["quickprint-is-scrollable",i.classes.panel])},[(C(),L(G,null,Z(t,d=>a("div",{key:d.value,class:f({[i.classes.option]:!0,[i.classes.active]:d.value===s.value}),onClick:h=>c(d),onMouseenter:h=>r(d)},[a("strong",null,B(d.label),1)],42,Rr)),64))],2),a("div",{class:f(["quickprint-is-scrollable",i.classes.desc])},[g(v(gn),{name:o.value},null,8,["name"])],2)],2))}}),Nr="_string_shs83_2",$r="_panel_shs83_10",Ir="_desc_shs83_16",Ar="_option_shs83_23",qr="_active_shs83_33",Or={string:Nr,panel:$r,desc:Ir,option:Ar,active:qr},Mr={classes:Or},Dr=D(Lr,[["__cssModules",Mr]]),Pr=["onClick","onMouseenter"],xr=q({__name:"Logical",emits:["select"],setup(n,{emit:e}){const t=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],l=e,s=K(t[0].value),o=N(()=>`function_${s.value.toLowerCase()}`);function c(i){l("select",i.value)}function r(i){s.value=i.value}return(i,u)=>(C(),L("div",{class:f(i.classes.string)},[a("div",{class:f(["quickprint-is-scrollable",i.classes.panel])},[(C(),L(G,null,Z(t,d=>a("div",{key:d.value,class:f({[i.classes.option]:!0,[i.classes.active]:d.value===s.value}),onClick:h=>c(d),onMouseenter:h=>r(d)},[a("strong",null,B(d.label),1)],42,Pr)),64))],2),a("div",{class:f(["quickprint-is-scrollable",i.classes.desc])},[g(v(gn),{name:o.value},null,8,["name"])],2)],2))}}),Vr="_string_shs83_2",zr="_panel_shs83_10",Br="_desc_shs83_16",Fr="_option_shs83_23",Ur="_active_shs83_33",Hr={string:Vr,panel:zr,desc:Br,option:Fr,active:Ur},Gr={classes:Hr},Wr=D(xr,[["__cssModules",Gr]]),Yr=q({__name:"index",setup(n){const e=xe(),t=K("string"),l=[{label:"文本",value:"string"},{label:"数字",value:"number"},{label:"逻辑",value:"logical"}];function s(o){return e==null?void 0:e.confirm({type:"function",value:`${o}()`})}return(o,c)=>(C(),L("div",{class:f(o.classes.function)},[g(ns,{modelValue:t.value,"onUpdate:modelValue":c[0]||(c[0]=r=>t.value=r),tabs:l},{prefix:se(()=>[g(v(O),{icon:"icon-function",size:"16px"}),a("span",{class:f(o.classes.title)},"函数",2)]),_:1},8,["modelValue"]),t.value==="string"?(C(),j(Cr,{key:0,onSelect:s})):F("",!0),t.value==="number"?(C(),j(Dr,{key:1,onSelect:s})):F("",!0),t.value==="logical"?(C(),j(Wr,{key:2,onSelect:s})):F("",!0)],2))}}),Xr="_title_vrlfq_11",jr={function:"_function_vrlfq_2",title:Xr},Zr={classes:jr},Kr=D(Yr,[["__cssModules",Zr]]),Jr=["onMouseenter"],Qr=["onClick"],ea={key:1},ta=q({__name:"Formula",props:{doc:{type:de,default:null}},setup(n){const e=n,t=xe(),l=[{id:"pageNumber",name:"页码",options:i(go)}],s=K(l[0]);function o(u){s.value=u}function c(u){return t==null?void 0:t.confirm({type:"formula",value:u})}function r(u){const d=dn.tokenize(u),h=e.doc;return d.reduce((m,b)=>{if(b.type===Ze.VARIABLE)return m.push({type:"highlight",value:st(b.value,h==null?void 0:h.ds)}),m;if(b.type===Ze.REFERENCE)return m.push({type:"highlight",value:ts(b.value,h)}),m;if(b.type===Ze.TEMPLATE){const p=(Array.isArray(b.value)?b.value:[b.value]).map(S=>S.type===Ze.VARIABLE?{type:"highlight",value:st(S.value,h.ds)}:{type:"text",value:S.value});return m.concat(p)}return m.push({type:"text",value:dn.formatTokenValue(b)}),m},[])}function i(u){return u.map(d=>({nodes:r(d),value:d}))}return(u,d)=>(C(),L("div",{class:f(u.classes.formula)},[a("div",{class:f([u.classes.left,"quickprint-is-scrollable"])},[(C(),L(G,null,Z(l,h=>a("div",{key:h.name,onMouseenter:m=>o(h),class:f({[u.classes.group]:!0,[u.classes.active]:h.id===s.value.id})},B(h.name),43,Jr)),64))],2),a("div",{class:f(u.classes.right)},[(C(!0),L(G,null,Z(s.value.options,(h,m)=>(C(),L("div",{key:m,class:f(u.classes.code),onClick:b=>c(h.value)},[(C(!0),L(G,null,Z(h.nodes,b=>(C(),L(G,null,[b.type==="highlight"?(C(),L("span",{key:0,class:f(u.classes.highlight)},"["+B(b.value)+"]",3)):(C(),L("span",ea,B(b.value),1))],64))),256)),a("span",{class:f(u.classes.badge)},"插入",2)],10,Qr))),128))],2)],2))}}),na="_formula_ms7c3_2",la="_left_ms7c3_12",sa="_right_ms7c3_17",oa="_group_ms7c3_24",ia="_active_ms7c3_34",ra="_highlight_ms7c3_39",aa="_code_ms7c3_43",ca="_badge_ms7c3_65",ua={formula:na,left:la,right:sa,group:oa,active:ia,highlight:ra,code:aa,badge:ca},da={classes:ua},pa=D(ta,[["__cssModules",da]]),tl=Ve(function(n){return Zt("变量",g(ss,{doc:n.doc,value:n.value},null),{preset:"variable"}).promisify().catch(qe)}),fa=Ve(function(n){return Et("数据源",g(ls,{doc:n},null),{preset:"variable",icon:g(O,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(qe)}),ma=Ve(function(n){const e=["ds","builtin","reference"];return Zt("变量",g(ss,{doc:n.doc,value:n.value,include:e},null),{preset:"variable"}).promisify().catch(qe)}),ha=Ve(function(){return Zt("函数",g(Kr,null,null),{preset:"variable"}).promisify().catch(qe)}),ga=Ve(function(n){return Et("公式",g(pa,{doc:n.doc},null),{preset:"variable"}).promisify().catch(qe)}),va={key:1},ba=q({__name:"Content",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=ve(),l=Vt("editorRef"),s=Vt("contentRef"),o=K(!1),c=N(()=>{const d=pi(e.element);return d.color&&(d["--quickprint-element-var-color"]=d.color),o.value&&(d.alignItems="flex-start"),d}),r=N(()=>{const d=Qn(e.element,t.doc.ds);return d==null||d.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:d.type===he.CONST?"span":"strong",content:d.content},{tag:"span",content:e.element.attributes.suffix}]});async function i(){var b;const d=await tl({doc:t.doc,value:e.element.ds.value}).catch(Ke);if(d==null||(e.element.setDataSource(he.VARIABLE,d.value),e.element.type!=W.TABLE_CELL||d.type!=="ds"))return;const h=e.element.parent;if(h==null||h.isBindVariable||((b=d.parent)==null?void 0:b.type)!==J.ARRAY)return;const m=d.parent;h.setDataSource(he.VARIABLE,`${je.DS}.${m.type}.${m.name}`)}function u(){const d=l.value,h=s.value;d==null||h==null||(o.value=h.offsetHeight>d.offsetHeight)}return(d,h)=>(C(),L("div",{class:"quickprint-is-element-editor",style:Y(c.value),onVnodeMounted:u,ref_key:"editorRef",ref:l},[a("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:s},[a("span",{class:f({[d.classes.lineThrough]:n.element.style.lineThrough})},[(C(!0),L(G,null,Z(r.value,(m,b)=>(C(),L(G,{key:b},[m.tag=="strong"?(C(),L("strong",{key:0,class:f(d.classes.highlight)},"["+B(m.content)+"]",3)):(C(),L("span",va,B(m.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(C(),j(v(O),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:f(d.classes.dsIcon),onClick:i,onPointerdown:h[0]||(h[0]=te(()=>{},["stop"]))},null,8,["class"])):F("",!0)],4))}}),ya="_dsIcon_ss96n_2",_a="_lineThrough_ss96n_10",Ea="_highlight_ss96n_14",Ta={dsIcon:ya,lineThrough:_a,highlight:Ea},ka={classes:Ta},vn=D(ba,[["__cssModules",ka]]),wa=q({__name:"TextEditor",props:{element:{type:Os,required:!0}},setup(n){return(e,t)=>(C(),j(vn,{element:n.element},null,8,["element"]))}}),bn=Object.freeze({title:"文本",icon:"icon-text",type:W.TEXT,editor:wa,onCreate(){return pe.create({type:W.TEXT,width:_t,height:hn})}}),Sa=q({__name:"NumberEditor",props:{element:{type:Ms,required:!0}},setup(n){return(e,t)=>(C(),j(vn,{element:n.element},null,8,["element"]))}}),Ca=["value","disabled"],Ra=q({__name:"RadioButton",props:kt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=Kt(n,"modelValue");return(t,l)=>(C(),L("div",{class:f({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(C(!0),L(G,null,Z(n.options,s=>(C(),L("label",{class:f({[t.classes.radio]:!0,[t.classes.selected]:s.value===n.modelValue})},[ge(a("input",{type:"radio",value:s.value,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value=o),disabled:n.disabled},null,8,Ca),[[Qs,e.value]]),a("span",null,B(s.label),1)],2))),256))],2))}}),La="_radioGroup_67myk_2",Na="_compacted_67myk_10",$a="_radio_67myk_2",Ia="_selected_67myk_50",Aa="_disabled_67myk_56",qa={radioGroup:La,compacted:Na,radio:$a,selected:Ia,disabled:Aa},Oa={classes:qa},$t=D(Ra,[["__cssModules",Oa]]),Ma={class:"quickprint-config-section quickprint-config-inline"},Da={class:"quickprint-config-content"},Pa={class:"quickprint-config-section quickprint-config-inline"},xa={class:"quickprint-config-content"},Va={class:"quickprint-config-section quickprint-config-inline"},za={class:"quickprint-config-content"},Ba={class:"quickprint-config-section quickprint-config-inline"},Fa={class:"quickprint-config-content"},Ua=q({__name:"NumberConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N({get(){return e.element.attributes.showZero??!0},set(o){const c=e.element.attributes;c.showZero=o}}),l=N({get(){return e.element.attributes.round??Ht.ROUND},set(o){const c=e.element.attributes;c.round=o}}),s=N({get(){return e.element.attributes.format??pt.NONE},set(o){const c=e.element.attributes;c.format=o}});return(o,c)=>(C(),L(G,null,[a("section",Ma,[c[4]||(c[4]=a("header",{class:"quickprint-config-header quickprint-todo"},"小数位数",-1)),a("div",Da,[ge(a("input",{"onUpdate:modelValue":c[0]||(c[0]=r=>n.element.attributes.precision=r),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Le,n.element.attributes.precision]])])]),a("section",Pa,[c[5]||(c[5]=a("header",{class:"quickprint-config-header quickprint-todo"},"舍入规则",-1)),a("div",xa,[g(v(X),{options:v(io),modelValue:l.value,"onUpdate:modelValue":c[1]||(c[1]=r=>l.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),a("section",Va,[c[6]||(c[6]=a("header",{class:"quickprint-config-header quickprint-todo"},"显示类型",-1)),a("div",za,[g(v(X),{options:v(ro),modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=r=>s.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),a("section",Ba,[c[7]||(c[7]=a("header",{class:"quickprint-config-header quickprint-todo"},"值为0时",-1)),a("div",Fa,[g($t,{modelValue:t.value,"onUpdate:modelValue":c[3]||(c[3]=r=>t.value=r),options:v(ao),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),yn=Object.freeze({title:"数字",type:W.NUMBER,icon:"icon-number",editor:Sa,config:{display:Ua},onCreate(){return pe.create({type:W.NUMBER,width:_t,height:hn})}}),Ha=q({__name:"DateEditor",props:{element:{type:Ds,required:!0}},setup(n){return(e,t)=>(C(),j(vn,{element:n.element},null,8,["element"]))}}),Ga={class:"quickprint-config-section"},Wa={class:"quickprint-config-content"},Ya=q({__name:"DateConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=N(()=>[{label:"原始值",value:t.NONE},...Hl]);function s(o){if(o.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=o.value}return(o,c)=>(C(),L("section",Ga,[a("header",{class:f(["quickprint-config-header",o.classes.header])},[c[1]||(c[1]=a("span",null,"格式",-1)),g(v(X),{options:l.value,onSelect:s,class:f(o.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:se(()=>[a("span",{class:f(o.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),a("div",Wa,[ge(a("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=r=>n.element.attributes.format=r),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Le,n.element.attributes.format]])])]))}}),Xa="_header_79607_2",ja="_picker_79607_8",Za="_placeholder_79607_15",Ka={header:Xa,picker:ja,placeholder:Za},Ja={classes:Ka},Qa=D(Ya,[["__cssModules",Ja]]),_n=Object.freeze({title:"日期",type:W.DATE,icon:"icon-date",editor:Ha,config:{display:Qa},onCreate(){return pe.create({type:W.DATE,width:_t,height:hn})}}),ec=["colspan","rowspan"],tc=q({__name:"TableCellEditor",props:{element:{type:Ol,required:!0}},setup(n){const e=n,t=N(()=>e.element.attributes.colspan===0||e.element.attributes.rowspan===0),l=ve(),s=Oe("classes"),o=N(()=>{var i;return{[s.cell]:!0,[U.SELECTED]:(i=e.element.state)==null?void 0:i.selected}}),c=N(()=>{var d;const i=Pn((d=e.element.parent)==null?void 0:d.parent),u=Pn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...mt(i,u)}});function r(i){i.button==0&&l.selectElement(e.element)}return(i,u)=>t.value?F("",!0):(C(),L("td",Vl({key:0,[`.${v(nt)||""}`]:n.element,class:o.value,style:c.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:te(r,["stop"])}),[g(vn,{element:n.element,class:f(v(s).content)},null,8,["element","class"])],48,ec))}}),nc="_cell_rp1x6_2",lc="_content_rp1x6_31",sc={cell:nc,content:lc},oc={classes:sc},os=D(tc,[["__cssModules",oc]]);function ic(n,e){const t={top:[{type:"topMenu",label:"选中表格",icon:"icon-aim",handler:e.selectTable},{type:"topMenu",label:"复制表格",icon:"icon-copy",handler:()=>{console.log("TODO:复制")}}],menus:[]};return e.getTable,t.menus.push({type:"menu",label:"合并",icon:"icon-merge-cells",handler:e.mergeCells}),t.menus.push({type:"menu",label:"拆分",icon:"icon-solit-cells",handler:e.splitCells}),t.menus.push({type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-zhanweifu",handler:e.insertColumnLeft},{type:"menu",label:"右侧插入列",icon:"icon-zhanweifu",handler:e.insertColumnRight},{type:"menu",label:"上侧插入行",icon:"icon-zhanweifu",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-zhanweifu",handler:e.inserRowBottom}]}),t.menus.push({type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:e.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:e.avgTableWidth},{type:"menu",label:"均分表格高度",handler:e.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:e.setOtherRowSameHeight},{type:"menu",label:"将其他列设为相同宽度",handler:e.setOtherColSameWidth}]}),t.menus.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:e.deleteColumns},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]}),Yn.open(n.clientX,n.clientY,t)}function rc(n,e){function t(){return n.element}function l(){const T=t();return e.getSelectedElements().filter(k=>{var R;if(k.type!==W.TABLE_CELL)return!1;const w=(R=k.parent)==null?void 0:R.parent;return w==null?!1:w.id==T.id}).sort(Ol.sort)}function s(T){var V,ie,ke;const[_,...k]=T;let w=_.index,R=_.index,I=((V=_.parent)==null?void 0:V.index)??-1,H=((ie=_.parent)==null?void 0:ie.index)??-1;for(const De of k){const we=((ke=De.parent)==null?void 0:ke.index)??-1,Se=De.index;Se>=0&&Se<w&&(w=Se),Se>=0&&Se>R&&(R=Se),we>=0&&we<I&&(I=we),we>=0&&we>H&&(H=we)}return{colStart:w,colEnd:R,rowStart:I,rowEnd:H,colSpan:R-w+1,rowSpan:H-I+1}}function o(){var k;const T=l()[0];if(T==null)return!1;const _=(k=T.parent)==null?void 0:k.parent;return _==null?!1:e.selectElement(_)}function c(){const T=l();if(T.length===0)return!1;const _=s(T);return t().insertColumn(_.colStart,0),e.history.createSnapshot(),!0}function r(){const T=l();if(T.length===0)return!1;const _=s(T);return t().insertColumn(_.colEnd,1),e.history.createSnapshot(),!0}function i(){const T=l();if(T.length===0)return!1;const _=s(T);return t().inserRow(_.rowStart,0),e.history.createSnapshot(),!0}function u(){const T=l();if(T.length===0)return!1;const _=s(T);return t().inserRow(_.rowEnd,1),e.history.createSnapshot(),!0}function d(){var we,Se;const T=t(),_=T.page;if(_==null)return;const k=T.doc,w=dl((we=k==null?void 0:k.margins)==null?void 0:we.left)??38,R=dl((Se=k==null?void 0:k.margins)==null?void 0:Se.right)??38,I=T.columns,H=I.reduce((rt,Be)=>rt+Be,0),V=qn.mm_to_px(_.width)-w-R,ie=[];for(const rt of I){const Be=Math.round(rt/H*V);ie.push(Be)}const ke=ie.reduce((rt,Be)=>rt+Be,0),De=V-ke;ie[ie.length-1]+=De,T.setColumns(ie),T.updateBoxSize(),e.history.createSnapshot()}function h(){const T=t(),_=T.columns,k=_.reduce((H,V)=>H+V,0),w=Math.floor(k/_.length),R=new Array(_.length).fill(w),I=k-R.reduce((H,V)=>H+V,0);R[R.length-1]+=I,T.setColumns(R),T.updateBoxSize(),e.history.createSnapshot()}function m(){const T=t(),_=Math.round(T.height/T.children.length);T.children.forEach((k,w)=>T.setRowHeight(w,_)),T.updateBoxSize(),e.history.createSnapshot()}function b(){const T=e.getSelectedElements()[0];if(T==null)return;const _=T.parent;if(_==null||_.type!="TableRow")return;const k=t(),w=_.height;k.children.forEach(R=>R.setRowHeight(w)),k.updateBoxSize(),e.history.createSnapshot()}function y(){const T=e.getSelectedElements()[0];if(T==null)return;const _=t(),k=T.width,w=_.attributes.colgroup.map(R=>k);_.setColumns(w),_.updateBoxSize(),e.history.createSnapshot()}function p(){const T=l();if(T.length<2)return;const[_,...k]=T,w=s(T);for(const R of k)R.attributes.colspan=0,R.attributes.rowspan=0;_.attributes.colspan=w.colSpan,_.attributes.rowspan=w.rowSpan,_.attributes.range=k.map(R=>R.id)}function S(){const T=l();if(T.length!=0)for(const _ of T)!_.hasColSpan&&!_.hasRowSpan||_.resetSpan()}function $(){const T=l()[0];if(T==null)return;t().removeColumn(T.index),e.history.createSnapshot()}function M(){const T=l()[0];if(T==null)return;const _=T.parent;if(_==null)return;t().removeRow(_.index),e.history.createSnapshot()}function E(){e.getSelectedElements().forEach(_=>_.resetDS()),e.history.createSnapshot()}return{getTable:t,getSelected:l,selectTable:o,toArea:s,insertColumnLeft:c,insertColumnRight:r,insertRowTop:i,inserRowBottom:u,autoReiszeColumnByPaper:d,avgTableWidth:h,avgTableHeight:m,setOtherRowSameHeight:b,setOtherColSameWidth:y,mergeCells:p,splitCells:S,deleteColumns:$,deleteRows:M,deleteDataSource:E}}function ac(n,e,t){const s={moved:!1,left:0,colIndex:0,target:null,container:null};function o(d,h){if(d==0)return null;const m=h.previousElementSibling;return m==null?0:m.offsetLeft}function c(d,h,m){const b=n.getTable().columns.length;if(d===b)return null;const y=h.nextElementSibling;return y==null?m.offsetWidth:y.offsetLeft}function r(d,h){if(!(d.target instanceof Element))return;const m=d.target.closest("."+e.colResize);if(m==null)return;const b=m.closest("."+e.layer);b!=null&&(d.stopPropagation(),d.preventDefault(),s.left=m.offsetLeft,s.colIndex=h,s.target=m,s.container=b,s.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",i),window.addEventListener("pointerup",u))}function i(d){if(s.target==null||s.container==null)return;const h=s.container.getBoundingClientRect(),m=o(s.colIndex,s.target),b=c(s.colIndex,s.target,s.container);let y=d.clientX-h.left;m!=null&&y<=m+4&&(y=m+4),b!=null&&y>=b-4&&(y=b-4),s.left=y,s.target.style.left=y+"px",s.moved=!0}function u(d){s.moved&&t.onResizeEnd(s.colIndex,Math.round(s.left)),s.left=0,s.target=null,s.container=null,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)}return r}function cc(n,e,t){const s={moved:!1,top:0,rowIndex:0,target:null,container:null};function o(d,h){if(d==0)return null;const m=h.previousElementSibling;return m==null?0:m.offsetTop}function c(d,h,m){const b=n.getTable().children.length;if(d===b)return null;const y=h.nextElementSibling;return y==null?m.offsetHeight:y.offsetTop}function r(d,h){if(!(d.target instanceof Element))return;const m=d.target.closest("."+e.rowResize);if(m==null)return;const b=m.closest("."+e.layer);b!=null&&(d.stopPropagation(),d.preventDefault(),s.top=m.offsetTop,s.rowIndex=h,s.target=m,s.container=b,s.target.setPointerCapture(d.pointerId),window.addEventListener("pointermove",i),window.addEventListener("pointerup",u))}function i(d){if(s.target==null||s.container==null)return;const h=s.container.getBoundingClientRect(),m=o(s.rowIndex,s.target),b=c(s.rowIndex,s.target,s.container);let y=d.clientY-h.top;m!=null&&y<=m+4&&(y=m+4),b!=null&&y>=b-4&&(y=b-4),s.moved=!0,s.top=y,s.target.style.top=y+"px"}function u(d){s.moved&&t.onResizeEnd(s.rowIndex,Math.round(s.top)),s.top=0,s.target=null,s.container=null,window.removeEventListener("pointermove",i),window.removeEventListener("pointerup",u)}return r}const uc=["width"],dc=["onPointerdown"],pc=["onPointerdown"],fc=["onClick"],mc=q({__name:"TableEditor",props:{element:{type:Ps,required:!0}},setup(n){const e=n,t=ve(),l=Oe("classes"),s=rc(e,t),o=ac(s,l,{onResizeEnd:$}),c=cc(s,l,{onResizeEnd:M}),r=N(()=>e.element.attributes.colgroup??[]),i=N(()=>r.value.length+1),u=N(()=>e.element.children.length+1),d=N(()=>t.getSelectedElements().length!=0?!1:e.element.state.selected===!0);function h(E){return{left:(e.element.attributes.colgroup??[]).slice(0,E).reduce((_,k)=>_+k,0)+"px"}}function m(E){return{top:(e.element.children??[]).slice(0,E).reduce((k,w)=>k+w.height,0)-1+"px"}}function b(E){const T=e.element.attributes.colgroup??[],_=T.slice(0,E).reduce((R,I)=>R+I,0),k=E===0?0:1,w=E>0&&E<T.length?-1:0;return{left:_+k+"px",width:T[E]+w+"px"}}function y(E){const T=e.element.children??[],_=T.slice(0,E).reduce((R,I)=>R+I.height,0),k=E===0?0:1,w=E>0&&E<T.length?-1:0;return{top:_+k+"px",height:T[E].height+w+"px"}}function p(E){t.selectElement(E)}async function S(E){const T=E.target.closest("td");if(T==null)return;const _=Reflect.get(T,nt);_!=null&&(t.state.selectMode==lt.SINGLE&&(t.selectElement(_),await xt()),ic(E,s))}function $(E,T){const _=e.element.attributes.colgroup??[];if(E==0){const H=e.element.left,V=e.element.calculateCoord(H+T),ie=_[0]-(V-H);e.element.setLeft(V),e.element.setColWidth(0,ie),e.element.updateBoxSize(),t.createSnapshot();return}if(E==_.length){const H=E-1,V=_.slice(0,H).reduce((ke,De)=>ke+De,0),ie=T-V;e.element.setColWidth(E-1,ie),e.element.updateBoxSize(),t.createSnapshot();return}const k=E-1,w=_[k]+_[E],R=T-_.slice(0,k).reduce((H,V)=>H+V,0),I=w-R;e.element.setColWidth(k,R),e.element.setColWidth(E,I),e.element.updateBoxSize(),t.createSnapshot()}function M(E,T){const _=e.element.children;if(E==0){const H=e.element.top,V=e.element.calculateCoord(H+T),ie=_[0].height-(V-H);e.element.setTop(V),e.element.setRowHeight(E,ie),e.element.updateBoxSize(),t.createSnapshot();return}if(E==_.length){const H=E-1,V=_.slice(0,H).reduce((ke,De)=>ke+De.height,0),ie=T-V;e.element.setRowHeight(E-1,ie),e.element.updateBoxSize(),t.createSnapshot();return}const k=E-1,w=_[k].height+_[E].height,R=T-_.slice(0,k).reduce((H,V)=>H+V.height,0),I=w-R;e.element.setRowHeight(k,R),e.element.setRowHeight(E,I),e.element.updateBoxSize(),t.createSnapshot()}return(E,T)=>(C(),L("div",{class:f(v(l).tableEditor),onContextmenu:te(S,["stop","prevent"]),onClick:T[1]||(T[1]=te(()=>{},["stop"]))},[a("table",{class:f(v(l).table)},[a("colgroup",null,[(C(!0),L(G,null,Z(r.value,(_,k)=>(C(),L("col",{key:k,width:_},null,8,uc))),128))]),a("tbody",null,[(C(!0),L(G,null,Z(n.element.children,_=>(C(),L("tr",{key:_.id},[(C(!0),L(G,null,Z(_.children,k=>(C(),j(os,{key:k.id,element:k},null,8,["element"]))),128))]))),128))])],2),a("div",{class:f(v(l).layer)},[(C(!0),L(G,null,Z(i.value,_=>(C(),L("div",{key:_,style:Y(h(_-1)),class:f(v(l).colResize),title:"调整列宽",onPointerdown:te(k=>v(o)(k,_-1),["stop","prevent"])},null,46,dc))),128)),(C(!0),L(G,null,Z(u.value,_=>(C(),L("div",{key:_,style:Y(m(_-1)),class:f(v(l).rowResize),title:"调整行高",onPointerdown:te(k=>v(c)(k,_-1),["stop","prevent"])},null,46,pc))),128)),(C(!0),L(G,null,Z(r.value,(_,k)=>(C(),L("div",{key:k,style:Y(b(k)),class:f(v(l).colIndicator),title:"选中此列"},null,6))),128)),(C(!0),L(G,null,Z(n.element.children,(_,k)=>(C(),L("div",{key:k,style:Y(y(k)),class:f(v(l).rowIndicator),title:"选中此行",onClick:te(w=>p(_),["stop"])},null,14,fc))),128))],2),d.value?(C(),L("div",{key:0,class:f(v(l).tools)},null,2)):F("",!0),a("div",{class:f(v(l).indicator),onPointerdown:T[0]||(T[0]=(..._)=>v(t).onDragStart&&v(t).onDragStart(..._)),title:"选中/拖动表格"},null,34)],34))}}),hc="_tableEditor_7pon8_2",gc="_table_7pon8_2",vc="_layer_7pon8_14",bc="_colResize_7pon8_24",yc="_rowResize_7pon8_47",_c="_colIndicator_7pon8_70",Ec="_rowIndicator_7pon8_76",Tc="_tools_7pon8_95",kc="_indicator_7pon8_105",wc={tableEditor:hc,table:gc,layer:vc,colResize:bc,rowResize:yc,colIndicator:_c,rowIndicator:Ec,tools:Tc,indicator:kc},Sc={classes:wc},Cc=D(mc,[["__cssModules",Sc]]),Rc={class:"quickprint-config-section quickprint-config-inline"},Lc={class:"quickprint-config-content"},Nc=q({__name:"TableRowConfig",props:{element:{type:tn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:St.HEADER},{label:"表体",value:St.BODY},{label:"表尾",value:St.FOOTER}],l=N({get(){return e.element.attributes.type??St.BODY},set(s){switch(s){case St.HEADER:e.element.asHeader();break;case St.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(s,o)=>(C(),L("section",Rc,[o[1]||(o[1]=a("header",{class:"quickprint-config-header quickprint-todo"},"行模式",-1)),a("div",Lc,[g(v(X),{options:t,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value=c),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),En=Object.freeze({title:"表格",type:W.TABLE,icon:"icon-table",editor:Cc,config:{exclude:[ne.PREFIX,ne.SUFFIX,ne.DISPLAY,ne.OVERFLOW]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[_t,_t,_t],e=pe.create({type:W.TABLE});return e.setColgroup(n),e.append(tn.createDefault(n)),e.append(tn.createDefault(n)),e.append(tn.createDefault(n)),e.updateBoxSize(),e}}),is=Object.freeze({title:"表格行",type:W.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[ne.POSITION,ne.COORD,ne.OVERFLOW],attributes:Nc}}),nl=Object.freeze({title:"单元格",type:W.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:os,config:{exclude:[ne.POSITION,ne.COORD]}});function en(n,e){const t=Math.pow(10,Math.max(0,e));return Math.round(n*t)/t}const In={A:10,B:11,C:12,D:13,E:14,F:15},fl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function $c(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function Ic(n){return typeof n=="string"&&n.includes("%")}function At(n,e){$c(n)&&(n="100%");const t=Ic(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function ut(n){return n.length===2?(In[n[0].toUpperCase()]||+n[0])*16+(In[n[1].toUpperCase()]||+n[1]):In[n[1].toUpperCase()]||+n[1]}function ml(n,e,t){n=At(n,255),e=At(e,255),t=At(t,255);const l=Math.max(n,e,t),s=Math.min(n,e,t);let o;const c=l,r=l-s,i=l===0?0:r/l;if(l===s)o=0;else{switch(l){case n:{o=(e-t)/r+(e<t?6:0);break}case e:{o=(t-n)/r+2;break}case t:{o=(n-e)/r+4;break}}o/=6}return{h:o*360,s:i*100,v:c*100}}const Ac=function(n,e,t){e=e/100,t=t/100;let l=e;const s=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=s<=1?s:2-s;const o=(t+e)/2,c=t===0?2*l/(s+l):2*e/(t+e);return{h:n,s:c*100,v:o*100}},qc=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function An(n,e,t){n=At(n,360)*6,e=At(e,100),t=At(t,100);const l=Math.floor(n),s=n-l,o=t*(1-e),c=t*(1-s*e),r=t*(1-(1-s)*e),i=l%6,u=[t,c,o,o,r,t][i],d=[r,t,t,c,o,o][i],h=[o,o,r,t,t,c][i];return{r:Math.round(u*255),g:Math.round(d*255),b:Math.round(h*255)}}function sn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${fl[e]||e}${fl[t]||t}`}function Oc({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${sn(n)}${sn(e)}${sn(t)}`}class Tn{constructor(e){x(this,"h",0);x(this,"s",100);x(this,"v",100);x(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=en(e,2)}setSaturation(e){this.s=en(e,2)}setValue(e){this.v=en(e,2)}setAlpha(e){this.a=en(e,2)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(s=>s!=="").map((s,o)=>o>2?Number.parseFloat(s):Number.parseInt(s,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,s,o,c=100;t.length===3?(l=ut(t[0]+t[0]),s=ut(t[1]+t[1]),o=ut(t[2]+t[2])):(t.length===6||t.length===8)&&(l=ut(t.slice(0,2)),s=ut(t.slice(2,4)),o=ut(t.slice(4,6))),t.length===8&&(c=ut(t.slice(6))/255*100);const{h:r,s:i,v:u}=ml(l,s,o);return{h:r,s:i,v:u,a:c}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:c}=ml(t[0],t[1],t[2]);return{h:s,s:o,v:c,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:c}=Ac(t[0],t[1],t[2]);return{h:s,s:o,v:c,a:l}}return null}toString(e){switch(e){case"hsl":{const t=qc(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Oc(An(this.h,this.s,this.v))}${sn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:s}=An(this.h,this.s,this.v);return`rgba(${t},${l},${s},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return An(this.h,this.s,this.v)}}function rs(n){const e={init:!1,target:null,container:null,offsetX:0};function t(c){const r=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().width/2;let d=c.clientX-r.left-e.offsetX;return d<-u&&(d=-u),d>r.width-u&&(d=r.width-u),d}function l(c){c.stopPropagation(),c.preventDefault();const r=c.target,i=c.currentTarget;origin==null||r==null||(e.container=i,e.target=r===i?r.firstElementChild:r,e.offsetX=r===i?e.target.offsetWidth/2:c.clientX-r.getBoundingClientRect().left,window.addEventListener("pointermove",s),window.addEventListener("pointerup",o))}function s(c){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(c.pointerId),e.init=!0);const r=t(c);e.target.style.left=r+"px",n("move",r)}function o(c){if(c.preventDefault(),c.stopPropagation(),e.container&&e.target){const r=t(c);n("end",r)}e.target&&e.target.releasePointerCapture(c.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",o)}return l}function Mc(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let h=r.clientX-i.left-e.offsetX;return h<-d&&(h=-d),h>i.width-d&&(h=i.width-d),h}function l(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().height/2;let h=r.clientY-i.top-e.offsetY;return h<-d&&(h=-d),h>i.height-d&&(h=i.height-d),h}function s(r){r.stopPropagation(),r.preventDefault();const i=r.target,u=r.currentTarget;origin==null||i==null||(e.container=u,e.target=i===u?i.firstElementChild:i,e.offsetX=i===u?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,e.offsetY=i===u?e.target.offsetHeight/2:r.clientY-i.getBoundingClientRect().top,window.addEventListener("pointermove",o),window.addEventListener("pointerup",c))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r),u=l(r);e.target.style.left=i+"px",e.target.style.top=u+"px",n("move",{left:i,top:u})}function c(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r),u=l(r);n("end",{top:u,left:i})}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",c)}return s}const Dc=q({__name:"SvPanel",props:{modelValue:{type:Tn,required:!0}},setup(n){const e=n,t=re(),l=re(),s=Pe(r()),o=N(()=>({left:s.left+"px",top:s.top+"px"})),c=Mc((i,u)=>{i=="end"&&(s.top=u.top,s.left=u.left);const d=t.value,h=l.value,m=(u.left+h.offsetWidth/2)/d.offsetWidth*100,b=100-(u.top+h.offsetHeight)/d.offsetHeight*100;e.modelValue.setSaturation(m),e.modelValue.setValue(b)});function r(){const i=t.value,u=l.value;if(i==null||u==null)return{top:-6,left:-6};const d=e.modelValue.s,m=(100-e.modelValue.v)/100*i.offsetHeight,b=d/100*i.offsetWidth;return{top:m-u.offsetHeight/2,left:b-u.offsetWidth/2}}return Jt(()=>{const i=r();s.top=i.top,s.left=i.left}),(i,u)=>(C(),L("div",{class:f(i.classes.svPanel),onPointerdown:u[0]||(u[0]=(...d)=>v(c)&&v(c)(...d)),ref_key:"svPanelRef",ref:t},[a("div",{class:f(i.classes.thumb),style:Y(o.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Pc="_svPanel_1sv6o_2",xc="_thumb_1sv6o_10",Vc={svPanel:Pc,thumb:xc},zc={classes:Vc},Bc=D(Dc,[["__cssModules",zc]]),Fc=q({__name:"HueSlider",props:{modelValue:{type:Tn,required:!0}},setup(n){const e=n,t=K(-6),l=re(),s=re(),o=rs((r,i)=>{r=="end"&&(t.value=i);const u=l.value,d=s.value,h=Math.round((i+d.offsetWidth/2)/u.offsetWidth*360);e.modelValue.setHue(h)});function c(){const r=l.value,i=s.value;if(r==null||i==null)return-6;const u=e.modelValue.h;return Math.round(u/360*r.offsetWidth)-i.offsetWidth/2}return Jt(()=>{t.value=c()}),(r,i)=>(C(),L("div",{class:f(r.classes.hue),onPointerdown:i[0]||(i[0]=(...u)=>v(o)&&v(o)(...u)),ref_key:"hueRef",ref:l},[a("div",{class:f(r.classes.thumb),style:Y({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),Uc="_hue_1ozoc_2",Hc="_thumb_1ozoc_10",Gc={hue:Uc,thumb:Hc},Wc={classes:Gc},Yc=D(Fc,[["__cssModules",Wc]]),Xc=q({__name:"AlphaSlider",props:{modelValue:{type:Tn,required:!0}},setup(n){const e=n,t=K(-6),l=re(),s=re(),o=rs((r,i)=>{r=="end"&&(t.value=i);const u=l.value,d=s.value,h=Math.round((i+d.offsetWidth/2)/u.offsetWidth*100);e.modelValue.setAlpha(h)});function c(){const r=l.value,i=s.value;if(r==null||i==null)return-6;const u=e.modelValue.a;return Math.round(u/100*r.offsetWidth)-i.offsetWidth/2}return Jt(()=>{t.value=c()}),(r,i)=>(C(),L("div",{class:f(r.classes.alpha),onPointerdown:i[0]||(i[0]=(...u)=>v(o)&&v(o)(...u)),ref_key:"alphaRef",ref:l},[a("div",{class:f(r.classes.thumb),style:Y({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),jc="_alpha_1x8jd_2",Zc="_thumb_1x8jd_26",Kc={alpha:jc,thumb:Zc},Jc={classes:Kc},Qc=D(Xc,[["__cssModules",Jc]]),eu=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function tu(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function nu(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const hl={isSupport:tu,open:nu},lu=["title","onClick"],su=["title","onClick"],gl="quickprint-recent-use-colors",ou=q({__name:"index",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,s=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],o=K(new Tn(l.modelValue)),c=re(),r=re(),i=K(M()),u=hl.isSupport(),d=K("hex"),h=N(()=>{const _=l.modelValue;return _?{backgroundColor:_}:null}),m=N(()=>{const _=o.value,{r:k,g:w,b:R}=_.rgb();return{"--hue-channel-color":`hsl(${_.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${k}, ${w}, ${R}, 0)`,"--alpha-channel-color-b":`rgba(${k}, ${w}, ${R}, 1)`}}),b=N({get(){return o.value.toString(d.value)},set(_){o.value.setColor(_)}});function y(){var _;(_=c.value)==null||_.close()}function p(_){_!=null&&(t("update:modelValue",_),t("select",_),E(_),y())}function S(){t("update:modelValue",void 0),t("select",void 0),y()}function $(){hl.open().then(_=>p(_))}function M(){const _=localStorage.getItem(gl);if(_==null||_=="")return[];const k=On(_);return k==null?[]:Array.isArray(k)?k:[]}function E(_){const k=i.value,w=k.indexOf(_);w>=0&&k.splice(w,1),k.length>10&&k.pop(),k.unshift(_),localStorage.setItem(gl,JSON.stringify(k))}function T(){t("update:modelValue",o.value.toString(d.value)),t("select",o.value.toString(d.value)),y()}return jn(()=>l.modelValue,()=>o.value.setColor(l.modelValue)),(_,k)=>(C(),j(v(Kl),{class:f(_.classes.colorPicker),onMousedown:k[7]||(k[7]=te(()=>{},["prevent"])),ref_key:"popoverRef",ref:c},{popover:se(()=>[a("div",{class:f(_.classes.colorPickerPanel)},[a("div",{class:f(_.classes.presetPanel)},[a("div",{class:f(_.classes.presetTools)},[a("button",{type:"button",class:f(_.classes.clearBtn),onClick:S},[a("span",{class:f(_.classes.none)},null,2),k[8]||(k[8]=a("span",null,"无颜色",-1))],2),v(u)?(C(),L("button",{key:0,type:"button",class:f(_.classes.indicator),onClick:$},[g(v(O),{icon:"icon-eye-dropper"}),k[9]||(k[9]=a("span",null,"拾色器",-1))],2)):F("",!0)],2),a("div",{class:f(_.classes.colourAtla)},[(C(!0),L(G,null,Z(v(eu),w=>(C(),L("div",{style:Y({backgroundColor:w}),title:w,class:f(_.classes.color),onClick:R=>p(w)},null,14,lu))),256))],2),a("div",{class:f(_.classes.recentColors)},"最近使用",2),a("div",{class:f(_.classes.colourAtla)},[(C(),L(G,null,Z(10,w=>a("div",{key:w,title:i.value[w-1],style:Y({backgroundColor:i.value[w-1]}),class:f(_.classes.color),onClick:R=>p(i.value[w-1])},null,14,su)),64))],2)],2),a("div",{class:f(_.pacls.panel),style:Y(m.value)},[g(Bc,{class:f(_.pacls.sv),modelValue:o.value,"onUpdate:modelValue":k[1]||(k[1]=w=>o.value=w)},null,8,["class","modelValue"]),a("div",{class:f(_.pacls.sliders)},[g(Yc,{class:f(_.pacls.hua),modelValue:o.value,"onUpdate:modelValue":k[2]||(k[2]=w=>o.value=w)},null,8,["class","modelValue"]),g(Qc,{modelValue:o.value,"onUpdate:modelValue":k[3]||(k[3]=w=>o.value=w)},null,8,["modelValue"]),a("div",{class:f(_.pacls.preview)},[a("div",{class:f(_.pacls.previewColor),style:Y({backgroundColor:o.value.toRGB()})},null,6)],2)],2),a("div",{class:f(_.pacls.tools)},[g(v(X),{options:s,teleport:"none",modelValue:d.value,"onUpdate:modelValue":k[4]||(k[4]=w=>d.value=w),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),ge(a("input",{type:"text","onUpdate:modelValue":k[5]||(k[5]=w=>b.value=w),onMousedown:k[6]||(k[6]=te(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Le,b.value]]),a("button",{type:"button",class:f(_.pacls.confirm),onClick:T},"确定",2)],2)],6)],2)]),default:se(()=>[a("div",{class:f(_.classes.colorPickerInput),ref_key:"inputRef",ref:r},[Ie(_.$slots,"default",{},()=>[a("span",{class:f(_.classes.colorBlock),style:Y(h.value)},null,6)]),n.showText?(C(),L("div",{key:0,class:f(_.classes.colorValue),onClick:k[0]||(k[0]=te(()=>{},["stop"]))},B(n.modelValue),3)):F("",!0)],2)]),_:3},8,["class"]))}}),iu="_colorPicker_qpnrm_2",ru="_colorPickerInput_qpnrm_6",au="_colorBlock_qpnrm_13",cu="_colorValue_qpnrm_22",uu="_colorPickerPanel_qpnrm_27",du="_presetPanel_qpnrm_42",pu="_colourAtla_qpnrm_46",fu="_color_qpnrm_2",mu="_presetTools_qpnrm_73",hu="_clearBtn_qpnrm_79",gu="_indicator_qpnrm_80",vu="_none_qpnrm_98",bu="_recentColors_qpnrm_129",yu={colorPicker:iu,colorPickerInput:ru,colorBlock:au,colorValue:cu,colorPickerPanel:uu,presetPanel:du,colourAtla:pu,color:fu,presetTools:mu,clearBtn:hu,indicator:gu,none:vu,recentColors:bu},_u="_panel_911zv_2",Eu="_sv_911zv_7",Tu="_hua_911zv_11",ku="_sliders_911zv_15",wu="_tools_911zv_20",Su="_confirm_911zv_37 quickprint-text-btn",Cu="_preview_911zv_44",Ru="_previewColor_911zv_59",Lu={panel:_u,sv:Eu,hua:Tu,sliders:ku,tools:wu,confirm:Su,preview:Cu,previewColor:Ru},Nu={classes:yu,pacls:Lu},et=D(ou,[["__cssModules",Nu]]);class $u{constructor(e){x(this,"__v_skip",!0);x(this,"observer");x(this,"callbacks",[]);x(this,"handler");this.handler=ui((t,l)=>{for(const s of this.callbacks)s(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function Iu(n,e){switch(n){case"fontSize":return e===fe.DEFAULT?void 0:e;case"fontFamily":return e===ee.DEFAULT?void 0:e;case"lineHeight":return e===ht.DEFAULT?void 0:e;default:return e}}const vl="texteditor-const-node",Au=Object.freeze({CONST:0});class qu{constructor(e,t={}){x(this,"__v_skip",!0);x(this,"emitter",new un);x(this,"container");x(this,"options");x(this,"observer");x(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new $u(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new un}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new xs(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(le(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await fn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=vl,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,s=e[0],o=e[e.length-1];return!this.container.contains(s)||!this.container.contains(o)?!1:(t.removeAllRanges(),l.setStartBefore(s),l.setEndAfter(o),t.addRange(l),!0)}insertNode(e,t){var m;const l=this.getSelection();if(l==null)return!1;const{selection:s,range:o}=l;if(s.isCollapsed!=!0&&s.deleteFromDocument(),s.isCollapsed!=!0)return!1;const c=s.anchorNode;if(c==null)return!1;const r=this.container,i=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(i),c.parentNode===r||(m=c.parentNode)!=null&&m.contains(r))return o.insertNode(i),this.normalize(),this.focusAfterNode(i),!0;const u=c.parentNode;if(u==null)return!1;const d=u.textContent;if(d==null)return!1;if(s.anchorOffset==d.length)return r.insertBefore(i,u.nextSibling),this.normalize(),this.focusAfterNode(i),!0;const h=document.createElement("span");return h.textContent=d.slice(0,s.anchorOffset),u instanceof HTMLElement&&(h.style.cssText=u.style.cssText),u.textContent=d.slice(s.anchorOffset),r.insertBefore(i,u),r.insertBefore(h,i),this.normalize(),this.focusAfterNode(i),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:s}=t;return l.isCollapsed||l.deleteFromDocument(),s.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,s=e.endContainer,o={};return l===t?(o.startNode=t.childNodes[e.startOffset],o.startOffset=-1):(o.startNode=l.parentNode==t?l:l.parentNode,o.startOffset=e.startOffset),s===t?(o.endNode=t.childNodes[e.endOffset],o.endOffset=-1):(o.endNode=s.parentNode==t?s:s.parentNode,o.endOffset=e.endOffset),o}findNodesBetween(e,t){const l=[];let s=e.nextSibling;for(;s!=null&&s!==t;)l.push(s),s=s.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return le(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var d;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const s=t.range,{startNode:o,startOffset:c,endNode:r,endOffset:i}=this.normalizeRange(s);if(o===r){const h=o.textContent??"";if(o instanceof CharacterData){const y=document.createElement("span");return y.textContent=h.slice(c,i),s.deleteContents(),s.insertNode(y),[y]}const m=document.createElement("span");m.textContent=h.slice(0,c),this.inheritStyle(m,r);const b=document.createElement("span");return b.textContent=h.slice(c,i),this.inheritStyle(b,r),r.textContent=h.slice(i),e.insertBefore(b,r),e.insertBefore(m,b),[b]}const u=this.findNodesBetween(o,r);if(c>0){const h=o.textContent??"",m=document.createElement("span");m.textContent=h.slice(0,c),this.inheritStyle(m,o),o.textContent=h.slice(c),e.insertBefore(m,o)}if(i>=0&&i<=(((d=r.textContent)==null?void 0:d.length)??0)){const h=r.textContent??"";if(r instanceof HTMLElement){r.textContent=h.slice(0,i);const m=document.createElement("span");m.textContent=h.slice(i),this.inheritStyle(m,r),e.insertBefore(m,r.nextSibling),u.push(r)}else{const m=document.createElement("span");m.textContent=h.slice(0,i),e.replaceChild(m,r);const b=document.createTextNode(h.slice(i));e.insertBefore(b,r.nextSibling),u.push(m)}}return u.unshift(o),u}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let s=!0;const o=Al(e),c=Iu(e,t);for(let r=0;r<l.length;r++){const i=l[r];if(i instanceof HTMLElement){this.matchElementStyle(i,o,c)||(s=!1);continue}const u=document.createElement("span");u.textContent=i.textContent,this.container.replaceChild(u,i),l[r]=u,s=!1}for(const r of l){if(s||c==null){this.removeElementStyle(r,o,c);continue}this.setElementStyle(r,o,c)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const s=e.style.getPropertyValue(t);return t==="text-decoration-line"?s.includes(l):s==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=vt.push(s,l);e.style.setProperty("text-decoration-line",o);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=vt.remove(s,l);le(o)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",o);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+vl)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const Ou=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:ee.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],as=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],cs=[{label:"默认",value:ee.DEFAULT},...as],kn=[{label:"默认",value:ee.DEFAULT},...Ou,...as],ll=[{label:"默认",value:fe.DEFAULT},{label:"初号",value:fe.SIZE_0+"pt",short:"56px"},{label:"小初",value:fe.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:fe.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:fe.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:fe.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:fe.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:fe.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:fe.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:fe.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:fe.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:fe.SIZE_5+"pt",short:"14px"},{label:"小五",value:fe.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],us=[{label:"默认",value:ht.DEFAULT},{label:"1.0",value:ht.TIMES_1,short:"单倍行距"},{label:"1.1",value:ht.TIMES_1_1},{label:"1.5",value:ht.TIMES_1_5},{label:"2.0",value:ht.TIMES_2,short:"两倍行距"}],Mu=[{label:"无",value:nn.NONE},{label:"实线",value:Ct.SOLID},{label:"虚线",value:Ct.DASHED},{label:"点划线",value:Ct.DOTTED},{label:"双实线",value:Ct.DOUBLE},{label:"波浪线",value:Ct.WAVY}],Du=[{label:"默认",value:gt.AUTO},{label:"左对齐",value:gt.LEFT},{label:"居中对齐",value:gt.CENTER},{label:"右对齐",value:gt.RIGHT},{label:"两端对齐",value:gt.JUSTIFY}],xn=[{label:"顶部对齐",value:We.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:We.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:We.BOTTOM,icon:"icon-vertical-align-bottom"}],Vn=[{label:"左对齐",value:Je.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:Je.CENTER,icon:"icon-align-center"},{label:"右对齐",value:Je.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:Je.JUSTIFY,icon:"icon-menu"}],Pu=q({__name:"ParagraphEditor",props:{element:{type:Vs,required:!0}},setup(n){const e=n,t=ve(),l=re(),s=N(()=>e.element.isSelected!==!0?!1:t.state.selectMode===lt.SINGLE);let o=null;const c=N(()=>kn.map(_=>(_.style={fontFamily:_.value==ee.DEFAULT?ee.SONG:_.value},_)));function r(){}async function i(){if(o==null)return;const _=await tl({doc:t.doc}).catch(Ke);if(_==null)return;const k=st(_.value,t.doc.ds)??_.value,w={type:Au.CONST,value:_.value,label:k};o.insertNode(w)}function u(){o==null||o.blur()}function d(){o==null||o.autosize()}function h(_){const k=e.element.ds.value,w=new qu(_);return w.on("resize",R=>{var H;const I=(H=R.detail)==null?void 0:H.height;I!=null&&e.element.setHeight(I+2)}),w.watch(()=>{const R=w.getHTML(),I=e.element.ds.value;R!==I&&(e.element.ds.value=R,w.checkHeight())}),le(k)||w.setHTML(k),w}function m(_){o==null||o.setStyle("fontFamily",_.value)}function b(_){o==null||o.setStyle("fontSize",_.value)}function y(_){o==null||o.setStyle("lineHeight",_.value)}function p(_){o==null||o.setStyle("backgroundColor",_)}function S(_){o==null||o.setStyle("color",_)}function $(){o==null||o.setStyle("fontWeight","700")}function M(){o==null||o.setStyle("fontStyle","italic")}function E(){o==null||o.setStyle("textDecorationLine","underline")}function T(){o==null||o.setStyle("textDecorationLine","line-through")}return jn(()=>e.element.ds.value,_=>{o==null||o.getHTML()==_||o.setHTML(_)}),Jt(()=>{e.element.on("blur",u),o=h(l.value)}),Xn(()=>{e.element.off("blur",u),o&&o.cleanup()}),(_,k)=>(C(),L("div",{class:f(_.classes.paragraph),onPointerdown:k[2]||(k[2]=te(()=>{},["stop"])),onContextmenu:te(r,["stop","prevent"])},[a("div",{class:f(_.classes.indicator),onPointerdown:k[0]||(k[0]=(...w)=>v(t).onDragStart&&v(t).onDragStart(...w)),title:"选中/拖动段落"},null,34),s.value?(C(),L("div",{key:0,class:f(_.classes.toolbar),onMousedown:k[1]||(k[1]=te(()=>{},["prevent"]))},[g(v(X),{onSelect:m,title:"字体",width:"60px",options:c.value,class:f(_.classes.tool),button:""},null,8,["options","class"]),g(v(X),{onSelect:b,title:"字号",width:"60px",options:v(ll),class:f(_.classes.tool),button:""},null,8,["options","class"]),g(v(X),{onSelect:y,title:"行高",width:"60px",options:v(us),class:f(_.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),a("div",{class:f(_.classes.divider)},null,2),g(et,{class:f(_.classes.tool),onSelect:p},{default:se(()=>[a("div",{class:f(_.classes.colorIcon),title:"突出显示"},[g(v(O),{icon:"icon-bg-color-b",size:"15px"}),a("div",{class:f(_.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),g(et,{class:f(_.classes.tool),onSelect:S},{default:se(()=>[a("div",{class:f(_.classes.colorIcon),title:"字体颜色"},[g(v(O),{icon:"icon-font",size:"15px"}),a("div",{class:f(_.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),a("button",{onClick:$,type:"button",title:"加粗",class:f(["quickprint-text-btn",_.classes.tool])},[g(v(O),{icon:"icon-font-bold",size:"16px"})],2),a("button",{onClick:M,type:"button",title:"斜体",class:f(["quickprint-text-btn",_.classes.tool])},[g(v(O),{icon:"icon-italic",size:"16px"})],2),a("button",{onClick:E,type:"button",title:"下划线",class:f(["quickprint-text-btn",_.classes.tool])},[g(v(O),{icon:"icon-underline",size:"16px"})],2),a("button",{onClick:T,type:"button",title:"删除线",class:f(["quickprint-text-btn",_.classes.tool])},[g(v(O),{icon:"icon-through-line",size:"16px"})],2),a("div",{class:f(_.classes.divider)},null,2),a("button",{class:"quickprint-text-btn",type:"button",onClick:i},[g(v(O),{icon:"icon-insert-var",size:"16px"}),k[3]||(k[3]=a("span",null,"插入变量",-1))]),a("button",{class:"quickprint-text-btn",type:"button",onClick:d},[g(v(O),{icon:"icon-colum-height",size:"16px"}),k[4]||(k[4]=a("span",null,"调整高度",-1))])],34)):F("",!0),a("div",{ref_key:"editorRef",ref:l,class:f(_.classes.editor)},null,2)],34))}}),xu="_paragraph_1v2pj_2",Vu="_indicator_1v2pj_6",zu="_editor_1v2pj_18",Bu="_toolbar_1v2pj_44",Fu="_tool_1v2pj_44",Uu="_colorIcon_1v2pj_66",Hu="_colorIndicator_1v2pj_86",Gu="_divider_1v2pj_95",Wu={paragraph:xu,indicator:Vu,editor:zu,toolbar:Bu,tool:Fu,colorIcon:Uu,colorIndicator:Hu,divider:Gu},Yu={classes:Wu},Xu=D(Pu,[["__cssModules",Yu]]),wn=Object.freeze({title:"段落",type:W.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:Xu,config:{exclude:[ne.DATASOURCE,ne.BASIC,ne.OVERFLOW]},onCreate(){return pe.create({type:W.PARAGRAPH,width:_t*4,height:hn*6})}}),ds=[bn,yn,_n,En,nl,is,wn],ju=[bn,yn,_n,En,wn],Zu={[W.TEXT]:bn.editor,[W.NUMBER]:yn.editor,[W.DATE]:_n.editor,[W.TABLE]:En.editor,[W.TABLE_CELL]:nl.editor,[W.PARAGRAPH]:wn.editor},Ku={[W.TEXT]:bn.config,[W.NUMBER]:yn.config,[W.DATE]:_n.config,[W.TABLE]:En.config,[W.TABLE_CELL]:nl.config,[W.TABLE_ROW]:is.config,[W.PARAGRAPH]:wn.config},zt=ds.reduce((n,e)=>(n[e.type]=e,n),{});function Ju(n){const e=ds.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function Qu(n){return Reflect.get(Zu,n)}function Lt(n){return Reflect.get(Ku,n)}function jt(n){var e;return((e=zt[n])==null?void 0:e.title)??n}function ed(n){var e;return(e=zt[n])==null?void 0:e.icon}function td(n){var e,t;return((t=(e=zt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function nd(n){var e,t;return((t=(e=zt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function ld(n){var e,t;return((t=(e=zt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function sd(n){var e,t;return((t=(e=zt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function bl(n,e,t,l){const[s,o]=e.top>t.top?[t,e]:[e,t],c=s.top-l.top,r=o.bottom-s.top;return{top:c,left:n,height:r}}function yl(n,e,t,l){const[s,o]=e.left>t.left?[t,e]:[e,t],c=s.left-l.left,r=o.right-s.left;return{top:n,left:c,width:r}}function _l(n,e){const t=n.find(i=>i.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,s=t.top+t.height,o=Math.min(t.top,e.top),r=Math.max(l,s)-o;t.top=o,t.height=r}function El(n,e){const t=n.find(i=>i.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,s=t.left+t.width,o=Math.min(t.left,e.left),r=Math.max(l,s)-o;t.left=o,t.width=r}function od(n){const e=document.createElement("div");return n.appendChild(e),e}function id(n,e){const t=[...e.querySelectorAll(":scope ."+U.GUIDE_LINE)];for(const l of n){const s=t.shift()??od(e);s.className=U.GUIDE_LINE,s.style.top=l.top+"px",s.style.left=l.left+"px",s.style.height=(l.height??1)+"px",s.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function rd(n,e){const l=e.querySelectorAll(":scope ."+U.ELEMENT),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),c=[];for(const r of l){if(n==r)continue;const i=r.getBoundingClientRect();if(Math.abs(o.left-i.left)<=1||Math.abs(o.right-i.left)<=1){const u=i.left-s.left;_l(c,bl(u,o,i,s))}if(Math.abs(o.left-i.right)<=1||Math.abs(o.right-i.right)<=1){const u=i.right-s.left;_l(c,bl(u,o,i,s))}if(Math.abs(o.top-i.top)<=1||Math.abs(o.bottom-i.top)<=1){const u=i.top-s.top;El(c,yl(u,o,i,s))}if(Math.abs(o.bottom-i.bottom)<=1||Math.abs(o.top-i.bottom)<=1){const u=i.bottom-s.top;El(c,yl(u,o,i,s))}}id(c,e)}function ad(){const n=document.querySelectorAll("."+U.GUIDE_LINE);for(const e of n)e.remove()}const pn={create:di(rd,50),clean:ad};async function cd(n){await fn(),n&&Reflect.deleteProperty(n,mn)}async function ud(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const o=document.createElement("div");o.className="quickprint-is-indicator",e.indicatorElement=o,document.body.appendChild(o)}const t=dd(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,s=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=s.left+"px",l.style.top=s.top-Yl(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function dd(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Ce.INSERT){const s=t.closest("."+U.PAGE);if(s==null)return null;const o=s.getBoundingClientRect();return{x:l?Nt(e.left-o.left):Math.round(e.left-o.left),y:l?Nt(e.top-o.top):Math.round(e.top-o.top),w:e.element.width,h:e.element.height}}return{x:l?Nt(e.left):Math.round(e.left),y:l?Nt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function pd(n){return!(n.style.rotate&&!n.isSelected)}function fd(n){const e=new Dn({selector:{container:U.DROPPABLE},scale(t){return t.mode===Ce.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,zl),o=Reflect.get(l.target,Zn);s===Ce.INSERT&&(l.container=n.component.getRootElement(),l.ghost=n.component.getGhostElement()),l.mode=s===Ce.INSERT?s:Ce.MOVE,l.elementType=o,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Ce.INSERT){const o=Ju(l.elementType);l.element=o,l.ghost.style.width=o.width+"px",l.ghost.style.height=o.height+"px";return}const s=Reflect.get(l.target,nt);if(s==null||!pd(s))return t.preventDefault();l.element=s}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Ce.INSERT&&(l.ghost.style.display="block"),l.mode===Ce.MOVE&&Reflect.set(l.target,mn,Kn.DRAG_ELEMENT),l.ghost.classList.add(U.DRAGGING),l.initDragElement=!0),ud(n,l),l.dropTarget&&pn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;pn.clean(),l.ghost.classList.remove(U.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Ce.INSERT&&(l.ghost.style.display="none"),l.mode==Ce.MOVE&&cd(l.target);const s=l.element;if(l.mode==Ce.MOVE){s.setTop(l.top),s.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),n.selectElement(s),n.createSnapshot();return}if(l.dropTarget==null)return;const o=Reflect.get(l.dropTarget,Bl);if(o==null)return;const c=o instanceof Tt||o instanceof pe?o:null;if(c==null)return;const r=l.dropTarget.getBoundingClientRect(),i=n.state.scale/100;s.setTop((l.top-r.top)/i),s.setLeft((l.left-r.left)/i),s.setWidth(s.width/i),s.setHeight(s.height/i),c.append(l.element),n.selectElement(s),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Tl="quickprint-history-0000",md=1,Xe="snapshot",on="health",kl="owner",Ue="INDEX_OWNER",hd=15*60*1e3,gd=10*60*1e3;function vd(){const n={db:null,timer:null,promise:null};async function e(){const d=await i(on,"readwrite");if(d==null)return n.timer=o(),!1;const h=[],m=d.openCursor();m.onsuccess=async function(b){const y=b.target.result;if(y==null){t(h),n.timer=o(),Re.debug("History","已检查无效快照");return}const p=y.value;p!=null&&Date.now()-p.timestamp>hd&&h.push(p),y.continue()},m.onerror=function(b){console.error(b),n.timer=o()}}async function t(d){const h=await Promise.allSettled(d.map(m=>l(m.owner)));for(let m=0;m<h.length;m++){const b=h[m];b.status==="rejected"||b.value!==!0||s(d[m].id)}}async function l(d){const h=await i(Xe,"readwrite");return h==null?!1:new Promise(m=>{const b=h.index(Ue).openCursor(IDBKeyRange.only(d));b.onsuccess=function(y){const p=y.target.result;if(p==null)return m(!0);p.delete(),p.continue()},b.onerror=function(y){console.error(y),m(!1)}})}async function s(d){const h=await i(on,"readwrite");return h==null?!1:Wt(h.delete(d)).then(()=>!0).catch(m=>(console.log(m),!1))}function o(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),gd)}function c(){return new Promise(d=>{const h=indexedDB.open(Tl,md);h.onupgradeneeded=m=>{const y=m.target.result,p=y.createObjectStore(on,{keyPath:"id",autoIncrement:!0}),S=y.createObjectStore(Xe,{keyPath:"id",autoIncrement:!0});p.createIndex(Ue,kl),S.createIndex(Ue,kl)},h.onsuccess=m=>{const b=m.target;n.db=b.result,Re.debug("History",`已连接数据库【${Tl}】`),d(n.db)},h.onerror=function(m){console.error(m),n.db=null,d(null)}})}function r(){return n.promise==null?Promise.resolve(n.db):n.promise}async function i(d,h="readonly"){const m=await r();if(m==null)return null;try{return m.transaction(d,h).objectStore(d)}catch(b){return console.error(b),null}}function u(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=c(),n.timer=o(),e(),{ready:r,findStore:i,cleanup:u}}function Wt(n){return new Promise((e,t)=>{n.onsuccess=function(l){const s=l.target;e(s.result)},n.onerror=function(l){console.error(l),t()}})}const bd=5*60*1e3,dt=vd();var He,Ae,rn,zn,ps;class yd{constructor(e,t={}){Fe(this,Ae);x(this,"state");x(this,"owner");Fe(this,He);this.state=e,this.owner=t.owner??zs(Bs.HISTORY_OWNER),_e(this,Ae,zn).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await dt.findStore(Xe,"readwrite");if(l==null)return!1;await _e(this,Ae,ps).call(this,l);const s=this.state.index+1,o={index:s,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await Wt(l.put(o)).catch(Ke)==null?!1:(this.state.index=s,this.state.count=s+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const s=await dt.findStore(Xe,"readwrite");return!(s==null||(l.data=JSON.stringify(e),await Wt(s.put(l)).catch(Ke)==null))}async getCurrentSnapshot(){const e=await dt.findStore(Xe);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=c=>{const r=c.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return s(i);r.continue()},o.onerror=function(c){console.error(c),s(null)}})}async getPrevSnapshot(){const e=await dt.findStore(Xe);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=c=>{const r=c.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return this.state.index=t,s(r.value);r.continue()},o.onerror=function(c){console.error(c),s(null)}})}async getNextSnapshot(){const e=await dt.findStore(Xe);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Ue).openCursor(IDBKeyRange.only(l),"next");o.onsuccess=c=>{const r=c.target.result;if(r==null)return s(null);const i=r.value;if(i.owner!=l)return r.continue();if(i.index==t)return this.state.index=t,s(r.value);r.continue()},o.onerror=function(c){console.error(c),s(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await dt.findStore(Xe);if(e==null)return[];const t=this.owner;return new Promise(l=>{const s=e.index(Ue).openCursor(IDBKeyRange.only(t),"prev"),o=[];s.onsuccess=c=>{const r=c.target.result;if(r==null)return l(o);const i=r.value;if(i.owner!=t)return r.continue();o.push(i),r.continue()},s.onerror=function(c){console.error(c),l([])}})}cleanup(){ye(this,He)&&(clearTimeout(ye(this,He)),ct(this,He,null))}}He=new WeakMap,Ae=new WeakSet,rn=function(){ct(this,He,setTimeout(()=>_e(this,Ae,zn).call(this),bd))},zn=async function(){ye(this,He)&&clearTimeout(ye(this,He));const e=await dt.findStore(on,"readwrite");if(e==null)return _e(this,Ae,rn).call(this);const t=await Wt(e.index(Ue).get(this.owner)).catch(Ke);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),_e(this,Ae,rn).call(this)}t.timestamp=Date.now(),await Wt(e.put(t)).catch(Ke),_e(this,Ae,rn).call(this)},ps=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const s=this.owner;return new Promise(o=>{const c=e.index(Ue).openCursor(IDBKeyRange.only(s),"prev");c.onsuccess=function(r){const i=r.target.result;if(i==null)return o(!0);const u=i.value;if(u.owner!=s)return i.continue();if(u.index>t){i.delete(),i.continue();return}o(!0)},c.onerror=function(r){console.error(r),o(!1)}})};function _d(n){const e=new yd(Pe({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function s(d){return e.createSnapshot(n.value,d)}function o(d){return e.replaceSnapshot(n.value,d)}async function c(){const d=await e.getPrevSnapshot();if(d==null)return!1;const h=On(d.data);return h==null?!1:(n.value=de.create(h),!0)}async function r(){const d=await e.getNextSnapshot();if(d==null)return!1;const h=On(d.data);return h==null?!1:(n.value=de.create(h),!0)}function i(){return e.list()}function u(){e.cleanup()}return s(),{allowRedo:l,allowUndo:t,createSnapshot:s,undo:c,redo:r,list:i,cleanup:u,replaceSnapshot:o}}class Ed{constructor(e){x(this,"moved",!1);x(this,"position");x(this,"top",0);x(this,"left",0);x(this,"width",0);x(this,"height",0);x(this,"initX",0);x(this,"initY",0);x(this,"indicator");x(this,"container");x(this,"originalEvent");x(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Mt,Dt,it,fs,ms,hs;const be=class be extends un{constructor(t={}){var l,s,o;super();Fe(this,it);x(this,"context",null);x(this,"selector");x(this,"scale");x(this,"onResizeStart");Fe(this,Mt);Fe(this,Dt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??U.PAGE,element:((s=t.selector)==null?void 0:s.element)??U.RESIZEABLE,indicator:((o=t.selector)==null?void 0:o.indicator)??U.RESIZEABLE_INDICATOR},this.onResizeStart=_e(this,it,fs).bind(this),ct(this,Mt,_e(this,it,ms).bind(this)),ct(this,Dt,_e(this,it,hs).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",ye(this,Mt)),window.removeEventListener("pointerup",ye(this,Dt)),this.context=null}};Mt=new WeakMap,Dt=new WeakMap,it=new WeakSet,fs=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Re.warn(be.TAG_NAME,"未找到的可调整元素");const s=Reflect.get(l,Fl);if(s==null)return Re.warn(be.TAG_NAME,"未找到的可调整元素");const o=l.closest("."+this.selector.element);if(o==null)return Re.warn(be.TAG_NAME,"未找到的可调整元素");const c=Wl(o,this.selector.container);this.context=new Ed({event:t,indicator:l,target:o,container:c,position:s});const r=this.createEvent("before-resizestart",this.context);if(this.dispatch(r).defaultPrevented)return Re.warn(be.TAG_NAME,"已取消调整");if(this.context.container==null)return Re.warn(be.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const i=this.createEvent("resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Re.warn(be.TAG_NAME,"已取消调整");window.addEventListener("pointermove",ye(this,Mt)),window.addEventListener("pointerup",ye(this,Dt))},ms=function(t){const l=this.context;if(l==null)return;const s=l.position,o=this.normalizeScale(),c=l.container.getBoundingClientRect(),r=l.target.getBoundingClientRect();if(s&Gt.TOP){const u=Math.max((r.bottom-t.clientY)/o,be.MIN_LENGTH);l.top=(r.bottom-c.top)/o-u,l.height=u}if(s&Gt.BOTTOM&&(l.height=Math.max((t.clientY-r.top)/o,be.MIN_LENGTH)),s&Gt.LEFT){const u=Math.max((r.right-t.clientX)/o,be.MIN_LENGTH);l.left=(r.right-c.left)/o-u,l.width=u}s&Gt.RIGHT&&(l.width=Math.max((t.clientX-r.left)/o,be.MIN_LENGTH));const i=this.createEvent("resizing",l);this.dispatch(i).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},hs=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("resizeend",l);this.dispatch(s).defaultPrevented||this.reset()},x(be,"TAG_NAME","quickprint-resizeable"),x(be,"MIN_LENGTH",12);let Bn=be;async function Td(n,e){if(await Promise.resolve(),e.indicatorElement==null){const r=document.createElement("div");r.className="quickprint-is-indicator",e.indicatorElement=r,document.body.appendChild(r)}const t=n.doc.useGrid,l=t?Nt(e.width):Math.round(e.width),s=t?Nt(e.height):Math.round(e.height),o=e.indicatorElement,c=e.target.getBoundingClientRect();o.style.display="block",o.style.left=c.left+"px",o.style.top=c.top-Yl(e.element)+"px",o.textContent=`x:${e.top},y:${e.left},w:${l},h:${s}`}function kd(n){const e=new Bn({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,nt);if(s==null)return t.preventDefault();l.element=s}),e.on("resizing",t=>{const l=t.detail;l!=null&&(Td(n,l),pn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const s=l.element;s.setTop(l.top),s.setLeft(l.left),s.setWidth(l.width),s.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),pn.clean()}),n.onResizeStart=e.onResizeStart,e}function wd(n){function e(o){const c=document.activeElement,r=o.target;return c instanceof HTMLInputElement||c instanceof HTMLTextAreaElement||c.isContentEditable===!0||r.closest(".quickprint-text-editor")!=null}function t(o){if(!(e(o)||Fs()))switch(o.key){case"Delete":case"Backspace":return o.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(o.ctrlKey)return o.preventDefault(),n.history.redo();case"Z":case"z":if(o.ctrlKey)return o.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const c=n.getSelectedElements();if(c.length==0)return;o.preventDefault(),o.stopPropagation();const r=o.key==="ArrowUp"?-1:1,i=c.map(u=>u.setTop(u.top+r,!0)?u:null).filter(u=>u!=null);i.length>0&&n.replaceSnapshot("top",i);return}case"ArrowLeft":case"ArrowRight":{const c=n.getSelectedElements();if(c.length==0)return;o.preventDefault(),o.stopPropagation();const r=o.key==="ArrowLeft"?-1:1,i=c.map(u=>u.setLeft(u.left+r,!0)?u:null).filter(u=>u!=null);i.length>0&&n.replaceSnapshot("left",i);return}}}function l(){window.addEventListener("keydown",t)}function s(){window.removeEventListener("keydown",t)}return{enable:l,disable:s}}const gs=Symbol();function Sd(){return{panel:{left:!0,right:!0},scale:100,selectedType:ue.NONE,selectedPage:void 0,selectMode:lt.SINGLE,selected:[]}}function Cd(n,e){const t=Pe(Sd()),l=_d(n),o={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:i,selectPage:h,selectElement:m,resetSelectedElement:b,deleteSelectedElement:y,multiSelectElements:p,zoomIn:$,zoomOut:S,toggleBackground:M,toggleElementPanel:E,toggleConfigPanel:T,getSelectedElements:u,getSelectedPage:d,cleanup:k,replaceSnapshot:_},c=fd(o),r=kd(o);o.shortcut=wd(o),o.createSnapshot=l.createSnapshot;function i(w){o.document.value=w,o.history.createSnapshot()}function u(){const w=t.selected;return w.length==0?[]:w.map(R=>o.doc.findElement(R)).filter(R=>R!=null)}function d(){var R;const w=t.selectedPage;if(w!=null)return(R=n.value)==null?void 0:R.findPage(w)}function h(w){return b(),t.selectedPage=w.id,t.selectedType=ue.PAGE,!0}function m(w){t.selectMode=lt.SINGLE,t.selectedType=ue.ELEMENT,t.selectedPage=void 0;const R=u();for(const I of R)I.id!==w.id&&I.blur();return w.focus(),t.selected=[w.id],!0}function b(){const w=u();for(const R of w)R.blur();return t.selected=[],t.selectedType=ue.NONE,!0}function y(){if(t.selectedType!=ue.ELEMENT||t.selected.length==0)return!1;let w=!1;const R=u();for(const I of R)I.remove()&&(w=!0);return w&&o.history.createSnapshot(),!0}function p(w){t.selectMode=lt.MULTIPLE,t.selectedType=ue.ELEMENT,t.selectedPage=void 0;const R=u();for(const I of R)I.blur();for(const I of w)I.focus();return t.selected=w.map(I=>I.id),!0}function S(){const w=t.scale??100,R=Ut.indexOf(w);return R<0?(t.scale=100,!1):R>=Ut.length-1?!1:(t.scale=Ut[R+1],!0)}function $(){const w=t.scale??100,R=Ut.indexOf(w);return R<0?(t.scale=100,!1):R==0?!1:(t.scale=Ut[R-1],!0)}function M(){const R=o.doc.attributes.grid==null?!0:void 0;o.doc.attributes.grid=R}function E(){o.state.panel.left=!o.state.panel.left}function T(){o.state.panel.right=!o.state.panel.right}function _(w,R){const I=R??o.doc,H=Array.isArray(I)?"element":I instanceof de?"document":I instanceof Tt?"page":"element",V=Array.isArray(I)?I.map(ke=>ke.id).join(","):I.id,ie=`${H}:${V}:${w}`;return console.log(ie),l.replaceSnapshot({action:ie})}function k(){c.cleanup(),r.cleanup(),l.cleanup(),o.shortcut.disable(),o.doc.cleanup()}return o.shortcut.enable(),o.selectPage(n.value.firstPage),xl(gs,o),Xn(k),o}function ve(){return Pl(gs)}const Rd=q({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Oe("classes"),l=ve(),s=N(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),o=N(()=>{const p=e.page.id,S=l.doc.pages.find($=>$.id===p);return S==null?0:e.direction=="horizontal"?S.width:S.height}),c=N(()=>{const p=o.value,S=[];for(let $=0;$<=p;$+=10)S.push($/10);return S}),r=N(()=>{const p=o.value,S=[];for(let $=0;$<=p;$+=2.5)S.push($);return S}),i=N(()=>{const p=l.getSelectedElements();return p.length==1?p[0]:null}),u=N(()=>e.direction==="horizontal"?{height:"100%",width:o.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:o.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),d=N(()=>{const p=i.value;if(p==null)return 0;if(p.type==="TableCell"){const S=p.parent;if(S==null)return 0;const $=S.parent;return S==null?0:$.top+S.offsetTop}if(p.type==="TableRow"){const S=p.parent;return S==null?0:S.top+p.offsetTop}return p.top}),h=N(()=>{const p=i.value;if(p==null)return 0;if(p.type==="TableCell"){const S=p.parent;if(S==null)return 0;const $=S.parent;return S==null?0:$.left+p.offsetLeft}if(p.type==="TableRow"){const S=p.parent;return S==null?0:S.left}return p.left});function m(p,S){return e.direction==="horizontal"?{left:p*(e.scale/100)+"mm",height:(S-2)%4==0?"8px":"4px"}:{top:p*(e.scale/100)+"mm",width:(S-2)%4==0?"8px":"4px"}}function b(p){return e.direction==="horizontal"?{left:p*(e.scale/100)+"cm"}:{top:p*(e.scale/100)+"cm"}}function y(p){return e.direction==="horizontal"?{left:h.value*(e.scale/100)+"px",width:p.width*(e.scale/100)+"px",height:"100%"}:{top:d.value*(e.scale/100)+"px",height:p.height*(e.scale/100)+"px",width:"100%"}}return(p,S)=>(C(),L("div",{class:f(s.value)},[a("div",{class:f(v(t).ruler),style:Y(u.value)},[i.value?(C(),L("div",{key:0,class:f(v(t).selected),style:Y(y(i.value))},null,6)):F("",!0),(C(!0),L(G,null,Z(r.value,($,M)=>(C(),L("div",{key:$,class:f(v(t).scale),style:Y(m($,M))},null,6))),128)),(C(!0),L(G,null,Z(c.value,$=>(C(),L("div",{class:f(v(t).number),style:Y(b($))},B($),7))),256))],6)],2))}}),Ld="_horizontalRuler_13w9e_2",Nd="_verticalRuler_13w9e_15",$d="_ruler_13w9e_27",Id="_scale_13w9e_33",Ad="_number_13w9e_47",qd="_selected_13w9e_70",Od={horizontalRuler:Ld,verticalRuler:Nd,ruler:$d,scale:Id,number:Ad,selected:qd},Md={classes:Od},wl=D(Rd,[["__cssModules",Md]]),Dd=["title"],Pd=q({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,s=Oe("classes"),o={},c=ve(),r=N(()=>({top:Math.round(t.top*t.zoom)+"px"}));function i(m){if(m.button!=0||t.disabled===!0)return;const b=m.target.closest("."+s.dragLine);b!=null&&(m.stopPropagation(),o.init=!1,o.target=b,o.parent=b.offsetParent,o.target.setPointerCapture(m.pointerId),window.addEventListener("pointermove",u),window.addEventListener("pointerup",d))}function u(m){m.preventDefault();const b=h(o.parent);let y=m.clientY-b.top;y<0&&(y=0),y>b.height&&(y=b.height),o.target.style.top=y/(c.state.scale/100)+"px",o.top=y,o.init=!0}function d(m){o.init===!0&&l("move",{top:o.top/(c.state.scale/100)}),o.target.releasePointerCapture(m.pointerId),window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",d)}function h(m){return m instanceof HTMLElement?m.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(m,b)=>(C(),L("div",{class:f({[v(s).dragLine]:!0,[v(s).disabled]:n.disabled}),style:Y(r.value),onPointerdown:te(i,["stop"]),title:n.title},null,46,Dd))}}),xd="_dragLine_1m7rt_2",Vd="_disabled_1m7rt_26",zd={dragLine:xd,disabled:Vd},Bd={classes:zd},Sl=D(Pd,[["__cssModules",Bd]]),Fd=q({__name:"Selection",setup(n,{expose:e}){const t=re(),l=re(),s=Vt("selectionRef"),o=re(),c=ve();let r=[];function i(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function u(){const y=[],p=l.value;if(p==null)return y;const S=d(p);if(S.length==0)return y;const $=s.value;return S.forEach(M=>{if(!vo(M,$)){M.classList.remove(U.SELECTED);return}const E=Reflect.get(M,nt);E instanceof pe&&(M.classList.add(U.SELECTED),y.push(E))}),y}function d(y){if(y.matches("."+U.ELEMENT)){const p=Reflect.get(y,nt);if(p&&p.type===W.TABLE)return y.querySelectorAll(":scope td")}return y.querySelectorAll(`:scope .${U.PAGE} > .${U.SELECTABLE}`)}function h(y,p){const S=p.closest("."+U.PAPER);if(S==null)return;y.stopPropagation(),y.preventDefault();const $=i(),M=S.getBoundingClientRect();$.initialX=y.clientX,$.initialY=y.clientY,$.top=y.clientY-M.top,$.left=y.clientX-M.left,l.value=p,o.value=$,t.value=S,r=[],window.addEventListener("pointermove",m),window.addEventListener("pointerup",b)}function m(y){const p=o.value;if(p==null)return;y.stopPropagation(),y.preventDefault();const S=s.value;if(p.init!==!0){if(Math.abs(y.clientX-p.initialX)<4&&Math.abs(y.clientY-p.initialY)<4)return;S.setPointerCapture(y.pointerId),S.style.display="block",p.init=!0}const $=Math.abs(y.clientX-p.initialX),M=Math.abs(y.clientY-p.initialY),E=y.clientX<p.initialX?-$:0,T=y.clientY<p.initialY?-M:0;S.style.top=p.top+T+"px",S.style.left=p.left+E+"px",S.style.width=$+"px",S.style.height=M+"px",r=u()}function b(y){const p=o.value;if(p==null)return;p.init&&(y.stopPropagation(),y.preventDefault()),r.length>0&&c.multiSelectElements(r);const S=s.value;S.releasePointerCapture(y.pointerId),S.style.display="none",o.value=void 0,window.removeEventListener("pointermove",m),window.removeEventListener("pointerup",b)}return e({onSelectStart:h}),(y,p)=>(C(),L("div",{ref_key:"selectionRef",ref:s,class:f(y.classes.selection),onClick:p[0]||(p[0]=te(()=>{},["stop"]))},null,2))}}),Ud="_selection_10jfe_2",Hd={selection:Ud},Gd={classes:Hd},Wd=D(Fd,[["__cssModules",Gd]]),Yd={class:"quickprint-is-row"},Xd=["onClick"],jd=q({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Oe("classes"),s=e,o=n,c=re(),r=N(()=>({height:o.height})),i=N({get(){return Ge(o.modelValue).num??void 0},set(y){if(y==""||Us(y)||y<0){h(void 0);return}const p=Ge(o.modelValue);h(`${y}${p.unit}`)}}),u=N({get(){return Ge(o.modelValue).unit??Te.PX},set(y){const p=Ge(o.modelValue);h(`${p.num}${y}`)}});function d(y){const p=y===fe.DEFAULT?void 0:y;s("update:modelValue",p)}function h(y){s("update:modelValue",y),b()}function m(y){const p=o.modelValue;return p==null&&y.value===fe.DEFAULT?!0:p===y.value}async function b(){await xt();const y=document.querySelector("."+l.fontSelected);y&&y.scrollIntoView({block:"nearest"})}return(y,p)=>(C(),L("div",{class:f(v(l).fontSize),style:Y(r.value)},[a("div",Yd,[ge(a("input",{type:"number",placeholder:"请输入",class:f(["quickprint-form-control",v(l).input]),min:0,"onUpdate:modelValue":p[0]||(p[0]=S=>i.value=S)},null,2),[[Le,i.value]]),g(v(X),{width:"54px",options:t,modelValue:u.value,"onUpdate:modelValue":p[1]||(p[1]=S=>u.value=S)},null,8,["modelValue"])]),a("div",{class:f(["quickprint-is-fill-h quickprint-is-scrollable",v(l).fonts]),ref_key:"scrollRef",ref:c},[(C(!0),L(G,null,Z(v(ll),S=>(C(),L("div",{key:S.value,class:f({[v(l).option]:!0,[v(l).fontSelected]:m(S)}),onClick:$=>d(S.value)},[a("span",null,B(S.label),1)],10,Xd))),128))],2)],6))}}),Zd="_input_9oh9n_2",Kd="_fontSize_9oh9n_8",Jd="_fonts_9oh9n_13",Qd="_option_9oh9n_25",ep="_fontSelected_9oh9n_34",tp={input:Zd,fontSize:Kd,fonts:Jd,option:Qd,fontSelected:ep},np={classes:tp},vs=D(jd,[["__cssModules",np]]),lp=["title"],sp={key:0},op="中文字体 AbBbCc",ip=q({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=N(()=>kn.map(p=>(p.style={fontFamily:p.value==ee.DEFAULT?ee.SONG:p.value},p))),l=N(()=>cs.map(p=>(p.style={fontFamily:p.value==ee.DEFAULT?ee.SONG:p.value},p))),s=N({get(){const p=e.options.style.fontFamily;return le(p)?ee.DEFAULT:p},set(p){e.options.style.fontFamily=p==ee.DEFAULT?void 0:p}}),o=N({get(){const p=e.options.style.enFontFamily;return le(p)?ee.DEFAULT:p},set(p){e.options.style.enFontFamily=p==ee.DEFAULT?void 0:p}}),c=N({get(){const p=e.options.style.color;return le(p)?Ee.DEFAULT:p},set(p){e.options.style.color=p==Ee.DEFAULT?void 0:p}}),r=N({get(){const p=e.options.style.highlightColor;return le(p)?Ee.DEFAULT:p},set(p){e.options.style.highlightColor=p==Ee.DEFAULT?void 0:p}}),i=N({get(){return e.options.style.fontSize},set(p){const S=le(p)?void 0:p;e.options.style.fontSize=S}}),u=N({get(){return e.options.style.fontWeight===700},set(p){e.options.style.fontWeight=p?700:void 0}}),d=N({get(){return e.options.style.fontStyle==="italic"},set(p){e.options.style.fontStyle=p?"italic":void 0}}),h=N({get(){return e.options.style.lineThrough===!0},set(p){e.options.style.lineThrough=p?!0:void 0}}),m=N({get(){const p=e.options.style.underline;if(p==null||p===!1)return nn.NONE;const S=e.options.style.underlineStyle;return le(S)?Ct.SOLID:S},set(p){if(p===nn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=p}}),b=N({get(){const p=e.options.style.underlineColor;return le(p)?Ee.DEFAULT:p},set(p){e.options.style.underlineColor=p==Ee.DEFAULT?void 0:p}}),y=N(()=>{const p=e.options.style,S={},$=Jn(p.fontFamily,p.enFontFamily);$&&(S.fontFamily=$);const M=es(p);return M&&mt(S,M),p.fontSize&&(S.fontSize=p.fontSize),p.fontWeight&&(S.fontWeight=p.fontWeight),p.color&&(S.color=p.color),p.fontStyle&&(S.fontStyle=p.fontStyle),p.highlightColor&&(S["--quickprint-variable-highlight-color"]=p.highlightColor),S});return(p,S)=>(C(),L("div",{class:f(["quickprint-is-scrollable quickprint-is-fill-h",p.classes.font])},[a("div",{class:f(p.classes.fontFamily)},[a("div",{class:f(p.classes.config)},[a("div",{class:f(p.classes.title)},"中文字体",2),a("div",{class:f(p.classes.content)},[g(v(X),{options:t.value,modelValue:s.value,"onUpdate:modelValue":S[0]||(S[0]=$=>s.value=$)},null,8,["options","modelValue"])],2)],2),a("div",{class:f(p.classes.config)},[a("div",{class:f(p.classes.title)},"颜色",2),g(et,{modelValue:c.value,"onUpdate:modelValue":S[1]||(S[1]=$=>c.value=$)},{default:se(()=>[a("div",{class:f(p.classes.indicator)},[a("div",{class:f({[p.classes.colorBlock]:!0,[p.classes.colorNone]:c.value===v(Ee).DEFAULT}),style:Y({backgroundColor:c.value})},null,6),a("div",{class:f(p.classes.colorValue)},B(c.value==v(Ee).DEFAULT?"默认":c.value),3)],2)]),_:1},8,["modelValue"])],2),a("div",{class:f([p.classes.config,p.classes.fontSize])},[a("div",{class:f(p.classes.title)},"字号",2),g(vs,{modelValue:i.value,"onUpdate:modelValue":S[2]||(S[2]=$=>i.value=$),height:"144px"},null,8,["modelValue"])],2),a("div",{class:f(p.classes.config)},[a("div",{class:f(p.classes.title)},"西文字体",2),a("div",{class:f(p.classes.content)},[g(v(X),{options:l.value,modelValue:o.value,"onUpdate:modelValue":S[3]||(S[3]=$=>o.value=$)},null,8,["options","modelValue"])],2)],2),a("div",{class:f(p.classes.config)},[a("div",{class:f(p.classes.title)},"前景色",2),g(et,{modelValue:r.value,"onUpdate:modelValue":S[4]||(S[4]=$=>r.value=$)},{default:se(()=>[a("div",{class:f(p.classes.indicator)},[a("div",{class:f({[p.classes.colorBlock]:!0,[p.classes.colorNone]:r.value===v(Ee).DEFAULT}),style:Y({backgroundColor:r.value})},null,6),a("div",{class:f(p.classes.colorValue)},B(r.value==v(Ee).DEFAULT?"默认":r.value),3)],2)]),_:1},8,["modelValue"])],2),a("div",{class:f(p.classes.config)},[a("div",{class:f(p.classes.title)},"下划线",2),a("div",{class:f(p.classes.content)},[g(v(X),{modelValue:m.value,"onUpdate:modelValue":S[5]||(S[5]=$=>m.value=$),options:v(Mu),width:"138px"},{option:se(({option:$})=>[a("div",{title:$.label,class:f(p.classes.option)},[$.value==v(nn).NONE?(C(),L("div",sp,B($.label),1)):(C(),L("div",{key:1,class:f(p.classes.line),style:Y({textDecorationStyle:$.value})},"--",6))],10,lp)]),_:1},8,["modelValue","options"])],2)],2),a("div",{class:f(p.classes.config)},[a("div",{class:f(p.classes.title)},"线条颜色",2),a("div",{class:f(p.classes.content)},[g(et,{modelValue:b.value,"onUpdate:modelValue":S[6]||(S[6]=$=>b.value=$),class:"quickprint-w-full"},{default:se(()=>[a("div",{class:f(p.classes.indicator)},[a("div",{class:f({[p.classes.colorBlock]:!0,[p.classes.colorNone]:b.value===v(Ee).DEFAULT}),style:Y({backgroundColor:b.value})},null,6),a("div",{class:f(p.classes.colorValue)},B(b.value==v(Ee).DEFAULT?"默认":b.value),3)],2)]),_:1},8,["modelValue"])],2)],2)],2),a("div",{class:f(p.classes.fieldset)},[S[13]||(S[13]=a("header",null,"效果",-1)),a("div",{class:f(p.classes.configs)},[a("label",{class:f(p.classes.checkbox)},[ge(a("input",{type:"checkbox","onUpdate:modelValue":S[7]||(S[7]=$=>u.value=$)},null,512),[[$n,u.value]]),S[10]||(S[10]=a("span",null,"粗体",-1))],2),a("label",{class:f(p.classes.checkbox)},[ge(a("input",{type:"checkbox","onUpdate:modelValue":S[8]||(S[8]=$=>d.value=$)},null,512),[[$n,d.value]]),S[11]||(S[11]=a("span",null,"斜体",-1))],2),a("label",{class:f(p.classes.checkbox)},[ge(a("input",{type:"checkbox","onUpdate:modelValue":S[9]||(S[9]=$=>h.value=$)},null,512),[[$n,h.value]]),S[12]||(S[12]=a("span",null,"删除线",-1))],2)],2)],2),a("div",{class:f(p.classes.fieldset)},[S[14]||(S[14]=a("header",null,"预览",-1)),a("div",{class:f(p.classes.preview)},[a("span",{style:Y(y.value)},[a("span",{class:f({[p.classes.lineThrough]:n.options.style.lineThrough})},B(op),2)],4)],2)],2)],2))}}),rp="_font_d1yo6_2",ap="_fontFamily_d1yo6_7",cp="_config_d1yo6_14",up="_fontSize_d1yo6_19",dp="_fieldset_d1yo6_23",pp="_title_d1yo6_39",fp="_content_d1yo6_44",mp="_indicator_d1yo6_49",hp="_colorBlock_d1yo6_69",gp="_colorValue_d1yo6_80",vp="_colorNone_d1yo6_87",bp="_configs_d1yo6_98",yp="_checkbox_d1yo6_104",_p="_option_d1yo6_119",Ep="_line_d1yo6_127",Tp="_preview_d1yo6_138",kp="_lineThrough_d1yo6_153",wp={font:rp,fontFamily:ap,config:cp,fontSize:up,fieldset:dp,title:pp,content:fp,indicator:mp,colorBlock:hp,colorValue:gp,colorNone:vp,configs:bp,checkbox:yp,option:_p,line:Ep,preview:Tp,lineThrough:kp},Sp={classes:wp},Cp=D(ip,[["__cssModules",Sp]]),Rp=["placeholder","min"],Lp=q({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,s=N(()=>{const i=l.defaultUnit;return l.options.some(u=>u.value===i)?i:l.options[0].value}),o=N({get(){return Ge(l.modelValue).num},set(i){if(Gn(i)){const d=Ge(l.modelValue).unit??s.value;return r(`${i}${d}`)}r()}}),c=N({get(){return Ge(l.modelValue).unit??s.value},set(i){const d=Ge(l.modelValue).num??l.min;r(`${d}${i}`)}});function r(i=void 0){t("update:modelValue",i)}return(i,u)=>(C(),L("div",{class:f(i.classes.input)},[ge(a("input",{type:"number","onUpdate:modelValue":u[0]||(u[0]=d=>o.value=d),class:"quickprint-form-control",placeholder:n.placeholder,min:n.min},null,8,Rp),[[Le,o.value]]),g(v(X),{modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=d=>c.value=d),class:f(i.classes.unit),options:n.options,width:"auto",border:"none"},null,8,["modelValue","class","options"])],2))}}),Np="_input_gtdaq_2",$p="_unit_gtdaq_14",Ip={input:Np,unit:$p},Ap={classes:Ip},ft=D(Lp,[["__cssModules",Ap]]),qp="中文字体 AbBbCc",Op=q({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Te.NONE},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],l=[{label:"字符",value:Te.EM},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],s=[{label:"毫米",value:Te.MM},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],o=N({get(){return e.options.style.textAlign??Je.LEFT},set(b){const y=b===Je.LEFT?void 0:b;e.options.style.textAlign=y}}),c=N({get(){return e.options.style.textAlignLast??gt.AUTO},set(b){const y=b===gt.AUTO?void 0:b;e.options.style.textAlignLast=y}}),r=N({get(){return e.options.style.verticalAlign??We.TOP},set(b){const y=b===We.TOP?void 0:b;e.options.style.verticalAlign=y}}),i=m("top"),u=m("bottom"),d=m("left"),h=m("right");function m(b){return N({get(){var y;return(y=e.options.style.padding)==null?void 0:y[b]},set(y){e.options.style.padding==null&&(e.options.style.padding={});const p=le(y)?void 0:y;e.options.style.padding[b]=p}})}return(b,y)=>(C(),L("div",{class:f(["quickprint-is-scrollable quickprint-is-fill-h",b.classes.paragraph])},[a("div",{class:f(b.classes.textAlign)},[a("div",{class:f(b.classes.configItem)},[a("div",{class:f(b.classes.configItemLabel)},"文本对齐",2),g(v(X),{options:v(Vn),modelValue:o.value,"onUpdate:modelValue":y[0]||(y[0]=p=>o.value=p)},null,8,["options","modelValue"])],2),a("div",{class:f(b.classes.alignLast)},[a("div",{class:f(b.classes.configItemLabel)},"最后一行",2),g(v(X),{options:v(Du),modelValue:c.value,"onUpdate:modelValue":y[1]||(y[1]=p=>c.value=p)},null,8,["options","modelValue"])],2)],2),a("div",{class:f(b.classes.configItem)},[a("div",{class:f(b.classes.configItemLabel)},"垂直对齐",2),g(v(X),{options:v(xn),modelValue:r.value,"onUpdate:modelValue":y[2]||(y[2]=p=>r.value=p)},null,8,["options","modelValue"])],2),a("div",{class:f(b.classes.configItem)},[a("div",{class:f(b.classes.configItemLabel)},"首行缩进",2),g(ft,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":y[3]||(y[3]=p=>n.options.style.textIndent=p),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),a("div",{class:f(b.classes.configItem)},[a("div",{class:f(b.classes.configItemLabel)},"行高",2),g(ft,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":y[4]||(y[4]=p=>n.options.style.lineHeight=p),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),a("div",{class:f(b.classes.fieldset)},[y[9]||(y[9]=a("header",null,"内边距",-1)),a("div",{class:f(b.classes.padding)},[a("div",{class:f(b.classes.paddingItem)},[a("label",{class:f(b.classes.paddingItemLabel)},"上边距",2),g(ft,{modelValue:v(i),"onUpdate:modelValue":y[5]||(y[5]=p=>me(i)?i.value=p:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),a("div",{class:f(b.classes.paddingItem)},[a("label",{class:f(b.classes.paddingItemLabel)},"下边距",2),g(ft,{modelValue:v(u),"onUpdate:modelValue":y[6]||(y[6]=p=>me(u)?u.value=p:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),a("div",{class:f(b.classes.paddingItem)},[a("label",{class:f(b.classes.paddingItemLabel)},"左边距",2),g(ft,{modelValue:v(d),"onUpdate:modelValue":y[7]||(y[7]=p=>me(d)?d.value=p:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),a("div",{class:f(b.classes.paddingItem)},[a("label",{class:f(b.classes.paddingItemLabel)},"右边距",2),g(ft,{modelValue:v(h),"onUpdate:modelValue":y[8]||(y[8]=p=>me(h)?h.value=p:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),a("div",{class:f(b.classes.fieldset)},[y[10]||(y[10]=a("header",null,"预览",-1)),a("div",{class:f(b.classes.preview)},[a("span",null,[a("span",{class:f({[b.classes.lineThrough]:n.options.style.lineThrough})},B(qp),2)])],2)],2)],2))}}),Mp="_paragraph_13aw5_2",Dp="_fieldset_13aw5_7",Pp="_preview_13aw5_23",xp="_textAlign_13aw5_38 quickprint-is-row",Vp="_configItem_13aw5_43 quickprint-is-row",zp="_alignLast_13aw5_48 quickprint-is-row",Bp="_configItemLabel_13aw5_58",Fp="_padding_13aw5_63",Up="_paddingItem_13aw5_70",Hp="_paddingItemLabel_13aw5_76",Gp={paragraph:Mp,fieldset:Dp,preview:Pp,textAlign:xp,configItem:Vp,alignLast:zp,configItemLabel:Bp,padding:Fp,paddingItem:Up,paddingItemLabel:Hp},Wp={classes:Gp},Yp=D(Op,[["__cssModules",Wp]]),Xp=["onClick"],jp=q({__name:"Tabs",props:{active:{type:String,required:!0},tabs:{type:Array,required:!0}},emits:["switch"],setup(n,{emit:e}){const t=e;function l(s){t("switch",s)}return(s,o)=>(C(),L("div",{class:f(s.classes.tabs)},[(C(!0),L(G,null,Z(n.tabs,c=>(C(),L("div",{key:c.value,class:f({[s.classes.tab]:!0,[s.classes.active]:n.active===c.value}),onClick:r=>l(c),onPointerdown:o[0]||(o[0]=te(()=>{},["stop","prevent"]))},[a("span",null,B(c.label),1)],42,Xp))),128))],2))}}),Zp="_tabs_109u2_2",Kp="_tab_109u2_2",Jp="_active_109u2_41",Qp={tabs:Zp,tab:Kp,active:Jp},ef={classes:Qp},bs=D(jp,[["__cssModules",ef]]),tf=q({__name:"index",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=xe(),l=K("font"),s=[{label:"字体",value:"font"},{label:"段落",value:"paragraph"}];function o(i){l.value=i.value}function c(){t==null||t.confirm(e.options)}function r(){t==null||t.cancel()}return(i,u)=>{const d=eo("WindowMenus");return C(),L("div",{class:f(i.classes.setting)},[a("div",{class:f(i.classes.header)},[a("div",{class:f(i.classes.headerLeft)},[g(v(O),{icon:"icon-setting",size:"14px"}),a("span",{class:f(i.classes.title)},"元素",2),g(bs,{tabs:s,active:l.value,onSwitch:o},null,8,["active"])],2),v(t)?(C(),j(d,{key:0,instance:v(t)},null,8,["instance"])):F("",!0)],2),l.value==="font"?(C(),j(Cp,{key:0,options:e.options},null,8,["options"])):F("",!0),l.value==="paragraph"?(C(),j(Yp,{key:1,options:e.options},null,8,["options"])):F("",!0),a("div",{class:f(i.classes.footer)},[a("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),a("button",{type:"button",class:"quickprint-text-btn",onClick:c},"确定")],2)],2)}}}),nf="_setting_92mem_2",lf="_header_92mem_10",sf="_headerLeft_92mem_22",of="_title_92mem_35",rf="_tabs_92mem_42",af="_footer_92mem_47",cf={setting:nf,header:lf,headerLeft:sf,title:of,tabs:rf,footer:af},uf={classes:cf},df=D(tf,[["__cssModules",uf]]);function pf(n){return Pe({style:ql(n.style??{})})}function ff(n,e){n.style=Object.assign({},n.style,e.style)}const mf=Ve(function(n){return Zt("元素设置",g(df,{options:pf(n)},null),{preset:"setting"}).promisify().then(e=>ff(n,e)).catch(qe)});function hf(n,e,t){Yn.open(n.clientX,n.clientY,{menus:[{type:"menu",label:"设置",icon:"icon-setting",handler(){mf(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Ctrl+C",handler(){console.log("TODO: 复制元素")}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){console.log("TODO: 复制数据源")}},{type:"menu",label:"样式",icon:"icon-shuazi",disabled:!0,handler(){console.log("TODO: 复制样式")}}]},{type:"menu",label:"合并",icon:"icon-hebing",submenu:[{type:"menu",label:"数据源",icon:"icon-datasource",handler(){console.log("TODO: 合并数据源")}},{type:"menu",label:"样式",icon:"icon-shuazi",disabled:!0,handler(){console.log("TODO: 合并样式")}}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const l=e.element.page;if(l==null)return;const s=l.topZIndex;e.element.setZIndex(s+1),t.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const l=e.element.zIndex;e.element.setZIndex(l+1),t.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const l=e.element.zIndex;l<=0||(e.element.setZIndex(l-1),t.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.element.setZIndex(0),t.createSnapshot()}}]}]})}const gf=q({props:{element:{type:pe,required:!0}},setup(n){const e=Oe("classes"),t=ve(),l=N(()=>{const h=n.element;h.state.key;const m={"--quickprint-element-top":h.top+"px","--quickprint-element-left":h.left+"px","--quickprint-element-width":h.width+"px","--quickprint-element-height":h.height+"px","z-index":h.zIndex};return c()&&(m.transform=`rotate(${h.style.rotate}deg)`),m}),s={TOP:[e.resizeTop,Rt.TOP],BOTTOM:[e.resizeBottom,Rt.BOTTOM],LEFT:[e.resizeLeft,Rt.LEFT],RIGHT:[e.resizeRight,Rt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Rt.BOTTOM_RIGHT]},o=[s.TOP,s.BOTTOM,s.LEFT,s.RIGHT,s.BOTTOM_RIGHT];function c(){const h=n.element;return h.style.rotate==0||h.style.rotate==null?!1:t.state.selectMode===lt.SINGLE?!h.isSelected:!0}function r(h){const m=Qu(h.type);if(m==null)return g("div",{class:e.unknown},[g("span",null,[oe("未知的打印元素")])]);const b={element:h,key:h.id+"_"+h.state.key};return nd(h.type)?(b.onContextmenu=u,tt(m,b)):tt(m,b)}function i(h,m){m.stopPropagation();const b=m.target.closest("."+U.ELEMENT);b&&Reflect.get(b,mn)===Kn.DRAG_ELEMENT||t.selectElement(h)}function u(h){h.stopPropagation(),h.preventDefault(),hf(h,n,t)}function d(){return!ld(n.element.type)||c()?null:o.map(h=>{const m={class:[U.RESIZEABLE_INDICATOR,h[0]],["."+Fl]:h[1]};return g("div",to(m,{onPointerdown:t.onResizeStart}),null)})}return function(){const h=n.element,m={["."+nt]:h,["."+Zn]:h.type,key:h.id,class:{[U.ELEMENT]:!0,[U.DRAGGABLE]:!0,[U.RESIZEABLE]:!0,[U.SELECTED]:h.state.selected,[U.SELECTABLE]:td(h.type),["quickprint-is-"+h.type.toLowerCase()]:!0},style:l.value,onClick:i.bind(null,h)};return g("div",m,[r(h),d()])}}}),vf="_unknown_za8zh_2",bf="_resizeTop_za8zh_12",yf="_resizeBottom_za8zh_20",_f="_resizeLeft_za8zh_28",Ef="_resizeRight_za8zh_36",Tf="_resizeBottomRight_za8zh_44",kf={unknown:vf,resizeTop:bf,resizeBottom:yf,resizeLeft:_f,resizeRight:Ef,resizeBottomRight:Tf},wf={classes:kf},Sf=D(gf,[["__cssModules",wf]]),ys=$l(()=>Il(()=>import("./component-D1Z1DBw2.js"),__vite__mapDeps([2,3,1,4,5]))),Cf=q({__name:"DocJson",props:{doc:{type:de,required:!0}},setup(n){const e=n,t=xe(),l=K(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(s,o)=>(C(),j(v(ys),{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value=c),language:"json",class:f(s.classes.json)},null,8,["modelValue","class"]))}}),Rf="_json_9crpe_2",Lf={json:Rf},Nf={classes:Lf},$f=D(Cf,[["__cssModules",Nf]]),If=Ve(function(n){return Et("调试",g($f,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(Ke)}),Af=q({props:{doc:{type:de,required:!0},page:{type:Tt,required:!0}},emits:["save","preview"],setup(n,{emit:e}){const t=Oe("classes"),l=ve(),s=Vt("selectionRef"),o=Vt("paperRef"),c=K(0),r=N(()=>n.page.width),i=N(()=>n.page.height);function u(E){E.stopPropagation();const T=E.target.closest("."+U.PAPER);T&&Reflect.get(T,mn)===Kn.SELECTION||(l.resetSelectedElement(),l.selectPage(n.page))}function d(){if(n.page.header.display===!1)return null;const E=n.page.header.height,T="page_header_"+c.value;return g(Sl,{title:"页眉",top:E,onMove:m,key:T},null)}function h(){if(n.page.footer.display===!1)return null;const E=Pt(i.value)-n.page.footer.height,T="page_footer_"+c.value;return g(Sl,{title:"页脚",top:E,onMove:b,key:T},null)}function m(E){n.page.setHeaderHeight(E.top),c.value++}function b(E){n.page.setFooterHeight(Pt(i.value)-E.top),c.value++}function y(E){E.stopPropagation(),E.preventDefault(),Yn.open(E.clientX,E.clientY,{menus:[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const T=n.page.children??[];l.multiSelectElements(T)}},{type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",disabled:!0,handler(){console.log("TODO: 黏贴")}},{type:"divider"},{type:"menu",label:"调试",icon:"icon-bug",handler(){If(l).then(T=>{if(T==null)return;const _=de.create(T);l.setDocument(_)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){e("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){e("save")}}]})}function p(){const E=n.doc.margins;if(E==null)return null;const T=[];return E.top&&T.push(g("div",{title:"上边距参考线",class:t.marginHorizontalGuide,style:{top:E.top+"px"}},null)),E.bottom&&T.push(g("div",{title:"下边距参考线",class:t.marginHorizontalGuide,style:{bottom:E.bottom+"px"}},null)),E.left&&T.push(g("div",{title:"左边距参考线",class:t.marginVerticalGuide,style:{left:E.left+"px"}},null)),E.right&&T.push(g("div",{title:"右边距参考线",class:t.marginVerticalGuide,style:{right:E.right+"px"}},null)),T.length>0?T:null}function S(){const E={["."+Bl]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[U.PAGE]:!0,[U.DROPPABLE]:!0,[t.grid]:n.doc.useGrid},onContextmenu:y},T=n.page.children.map(_=>g(Sf,{element:_},null));return g("div",E,[d(),T,h(),p()])}function $(E){if(E.button!==0)return;E.stopPropagation(),E.preventDefault();const _=E.target.closest("."+U.ELEMENT);if(_==null)return M(E,o.value);const k=Reflect.get(_,nt);return k==null?M(E,o.value):k.type===W.TABLE?M(E,_):sd(k.type)?l.onDragStart(E):M(E,o.value)}function M(E,T){var _;(_=s.value)==null||_.onSelectStart(E,T)}return function(){const E=l.state.scale/100,T={id:"@"+n.page.id,ref:"paperRef",class:{[U.PAPER]:!0,[U.SELECTED]:l.state.selectedPage===n.page.id},style:{width:r.value*E+"mm",height:i.value*E+"mm"},onPointerdown:$,onClick:u};return g("div",T,[S(),g(Wd,{ref:"selectionRef"},null)])}}}),qf="_paper_fdphx_2",Of="_grid_fdphx_12",Mf="_marginHorizontalGuide_fdphx_21",Df="_marginVerticalGuide_fdphx_29",Pf={paper:qf,grid:Of,marginHorizontalGuide:Mf,marginVerticalGuide:Df},xf={classes:Pf},Vf=D(Af,[["__cssModules",xf]]),zf=["title","onClick"],Bf=q({__name:"BorderSelect",setup(n){const e=[Q.ALL,Q.NONE,Q.INSIDE,Q.OUTSIDE],t=ve(),l=N(()=>{if(t.state.selectedType!==ue.ELEMENT)return null;const u=t.getSelectedElements();if(u.length!==1)return null;const h=u[0].getStyle("border");if(h==null||h===Q.NONE)return null;if(h===Q.ALL)return{borderStyle:"solid"};const m={};return h&Q.TOP&&(m.borderTopStyle="solid"),h&Q.RIGHT&&(m.borderRightStyle="solid"),h&Q.BOTTOM&&(m.borderBottomStyle="solid"),h&Q.LEFT&&(m.borderLeftStyle="solid"),m}),s=[{label:"上框线",value:Q.TOP,icon:"icon-border-top"},{label:"下框线",value:Q.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:Q.LEFT,icon:"icon-border-left"},{label:"右框线",value:Q.RIGHT,icon:"icon-border-right"}];function o(i){if(t.state.selectedType!==ue.ELEMENT)return!1;const d=t.getSelectedElements();if(d.length!==1)return!1;const m=d[0].getStyle("border");return m==null?!1:e.includes(i)?m==i:m&i}function c(i){if(t.state.selectedType!==ue.ELEMENT)return;const d=t.getSelectedElements();if(d.length!=0){for(const h of d){const m=h.getStyle("border");if(m==null){h.setStyle("border",i);continue}if(m===Q.ALL){h.setStyle("border",i===Q.ALL?Q.NONE:i);continue}if(e.includes(i)){h.setStyle("border",i);continue}if(e.includes(m)){h.setStyle("border",i);continue}h.setStyle("border",m^i)}t.createSnapshot()}}function r(){if(t.state.selectedType!==ue.ELEMENT)return;const u=t.getSelectedElements();if(u.length!=0){for(const d of u)d.setStyle("border",void 0);t.createSnapshot()}}return(i,u)=>(C(),j(v(Kl),null,{popover:se(()=>[a("div",{class:f(i.classes.popover)},[a("div",null,[(C(),L("button",{type:"button",title:"全部框线",key:v(Q).ALL,class:f({"quickprint-text-btn":!0,[i.classes.tool]:!0,"quickprint-is-selected":o(v(Q).ALL)}),onClick:u[0]||(u[0]=d=>c(v(Q).ALL))},[g(v(O),{icon:"icon-border",size:"16px"})],2)),(C(),L("button",{type:"button",title:"无框线",key:v(Q).ALL,class:f({"quickprint-text-btn":!0,[i.classes.tool]:!0}),onClick:r},[g(v(O),{icon:"icon-border-none",size:"16px"})],2))]),a("div",{class:f(i.classes.divider)},[(C(),L(G,null,Z(s,d=>a("button",{type:"button",title:d.label,key:d.value,class:f({"quickprint-text-btn":!0,[i.classes.tool]:!0,"quickprint-is-selected":o(d.value)}),onClick:h=>c(d.value)},[g(v(O),{icon:d.icon,size:"16px"},null,8,["icon"])],10,zf)),64))],2)],2)]),default:se(()=>[a("div",{class:f(["quickprint-text-btn",i.classes.borderSelect]),title:"边框"},[a("div",{class:f({[i.classes.border]:!0}),style:Y(l.value)},null,6)],2)]),_:1}))}}),Ff="_border_rprfx_2",Uf="_borderSelect_rprfx_10",Hf="_popover_rprfx_14",Gf="_divider_rprfx_18",Wf={border:Ff,borderSelect:Uf,popover:Hf,divider:Gf},Yf={classes:Wf},Xf=D(Bf,[["__cssModules",Yf]]);function ze(n,e){if(n.state.selectedType!==ue.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ne(n,e,t){if(n.state.selectedType!==ue.ELEMENT)return;const s=n.getSelectedElements();if(s.length!=0){for(const o of s)o.setStyle(e,t);n.createSnapshot()}}function Me(n,e){if(n.state.selectedType!==ue.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const s of l)s.removeStyle(e);n.createSnapshot()}}function jf(n){const e="underline";return N({get(){if(n.state.selectedType!==ue.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ne(n,e,t):Me(n,e)}})}function Zf(n){const e="lineThrough";return N({get(){if(n.state.selectedType!==ue.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ne(n,e,t):Me(n,e)}})}function Kf(n){const e="lineHeight";return N({get(){return ze(n,e)},set(t){t===ht.DEFAULT?Me(n,e):Ne(n,e,t)}})}function Jf(n){const e="highlightColor";return N({get(){return ze(n,e)??Un.BLACK},set(t){t===""?Me(n,e):Ne(n,e,t)}})}function Qf(n){const e="backgroundColor";return N({get(){return ze(n,e)??Un.BLACK},set(t){t===""?Me(n,e):Ne(n,e,t)}})}function em(n){const e="fontStyle";return N({get(){return ze(n,e)===rl.ITALIC},set(t){t?Ne(n,e,rl.ITALIC):Me(n,e)}})}function tm(n){const e="textAlign";return N({get(){return ze(n,e)??Je.LEFT},set(t){t===Je.LEFT?Me(n,e):Ne(n,e,t)}})}function nm(n){const e="verticalAlign";return N({get(){return ze(n,e)??We.MIDDLE},set(t){t===We.MIDDLE?Me(n,e):Ne(n,e,t)}})}function lm(n){const e="fontFamily";return N({get(){return ze(n,e)},set(t){t===ee.DEFAULT?Me(n,e):Ne(n,e,t)}})}function sm(n){const e="fontSize";return N({get(){return ze(n,e)},set(t){t===fe.DEFAULT?Me(n,e):Ne(n,e,t)}})}function om(n){const e="color";return N({get(){return ze(n,e)??Ee.REGULAR},set(t){Ne(n,e,t)}})}function im(n){const e="fontWeight";return N({get(){return ze(n,e)===700},set(t){t?Ne(n,e,700):Me(n,e)}})}const rm=["value","placeholder"],am=q({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,s=Vt("inputRef"),o=N({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?al(t.modelValue):t.standard==="mm"&&t.target==="px"?Pt(t.modelValue):0},set(d){if(t.standard===t.target)return l("update:modelValue",d);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Pt(d));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",al(d))}}),c=N(()=>t.clearable&&o.value!=null);function r(d){const m=d.target.value;if(o==null||m===""){if(t.clearable)return;const y=t.min?t.min:t.defaultValue;o.value=y;return}const b=Number(m);if(!Number.isNaN(b)){if(t.min!=null&&b<t.min){o.value=t.min;return}if(t.standard==="px"){o.value=Math.round(b);return}o.value=b}}function i(){l("update:modelValue",void 0)}function u(){var d;(d=s.value)==null||d.blur(),setTimeout(()=>{var h;return(h=s.value)==null?void 0:h.focus()},50)}return(d,h)=>(C(),L("label",{class:f({[d.classes.inputUnit]:!0,[d.classes.withClear]:n.clearable})},[a("span",{class:f(d.classes.label)},B(n.label),3),a("input",{ref_key:"inputRef",ref:s,class:"quickprint-form-control",type:"number",value:o.value,placeholder:n.placeholder,onBlur:r,onKeydown:Dl(u,["enter"])},null,40,rm),c.value?(C(),L("span",{key:0,class:f(d.classes.clearBtn),onClick:te(i,["stop"])},[g(v(O),{icon:"icon-close",size:"11px"})],2)):F("",!0)],2))}}),cm="_inputUnit_2ymft_2",um="_clearBtn_2ymft_7",dm="_label_2ymft_11",pm="_withClear_2ymft_31",fm={inputUnit:cm,clearBtn:um,label:dm,withClear:pm},mm={classes:fm},Qe=D(am,[["__cssModules",mm]]),hm=q({__name:"UnitSelect",props:kt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=Kt(n,"modelValue"),s=N(()=>{var o;return((o=e.find(c=>c.value===t.modelValue))==null?void 0:o.label)??t.modelValue});return(o,c)=>(C(),L("span",{class:f(o.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[g(v(X),{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=r=>l.value=r),options:e,class:f(o.classes.select),appearance:"none",border:"none"},{selected:se(()=>[a("span",{class:f(o.classes.text)},B(s.value),3)]),_:1},8,["modelValue","class"])],2))}}),gm="_unit_135mn_2",vm="_text_135mn_8",bm="_select_135mn_25",ym={unit:gm,text:vm,select:bm},_m={classes:ym},_s=D(hm,[["__cssModules",_m]]),Em=["min","readonly","placeholder"],Tm=q({__name:"LabelNumber",props:kt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=Kt(n,"modelValue");function l(s){const c=s.target.value;if(t==null||c===""){const i=e.min?e.min:e.defaultValue;t.value=i;return}const r=Number(c);if(!Number.isNaN(r)&&(e.min!=null&&r<e.min&&(t.value=e.min),e.precision!=null)){const i=Math.pow(10,e.precision);t.value=Math.round(r*i)/i}}return(s,o)=>(C(),L("label",{class:f({[s.classes.labelNumber]:!0,[s.classes.readonly]:n.readonly})},[ge(a("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":o[0]||(o[0]=c=>t.value=c),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Em),[[Le,t.value]]),a("span",{class:f(s.classes.label)},B(n.label),3)],2))}}),km="_labelNumber_1aifb_2",wm="_label_1aifb_2",Sm="_readonly_1aifb_25",Cm={labelNumber:km,label:wm,readonly:Sm},Rm={classes:Cm},It=D(Tm,[["__cssModules",Rm]]),Lm={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Nm={class:"quickprint-config-section"},$m={class:"quickprint-form-inline"},Im={class:"quickprint-config-section quickprint-config-inline"},Am={class:"quickprint-config-section"},qm={class:"quickprint-config-header quickprint-is-row"},Om={class:"quickprint-is-fill-w"},Mm={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},Dm={class:"quickprint-config-content quickprint-form-inline"},Pm=q({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=K("px"),l=m("top"),s=m("bottom"),o=m("left"),c=m("right"),r=N(()=>Ln.map(b=>({label:b.size===Nn.CUSTOM?"自定义":`${b.size}(${b.width}mm ✕ ${b.height}mm)`,value:b.size})));function i(b){e.config.width=b,h()}function u(b){e.config.height=b,h()}function d(b){const y=Ln.find(p=>p.size===b);y!=null&&(e.config.width=y.width,e.config.height=y.height,e.config.orientation=y.orientation,e.config.margins=y.margins,e.config.size=y.size)}function h(){const b=e.config,y=Ln.find(p=>p.size===Nn.CUSTOM?!1:p.orientation===b.orientation&&p.width===b.width&&p.height===b.height);if(y==null){b.size=Nn.CUSTOM;return}b.size=y.size}function m(b){return N({get(){var y;return(y=e.config.margins)==null?void 0:y[b]},set(y){e.config.margins==null&&(e.config.margins={}),e.config.margins[b]=y}})}return(b,y)=>(C(),L("div",Lm,[a("section",Nm,[y[6]||(y[6]=a("header",{class:"quickprint-config-header"},[a("span",null,"尺寸")],-1)),g(v(X),{options:r.value,modelValue:n.config.size,"onUpdate:modelValue":d,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),a("div",$m,[g(It,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":i},null,8,["modelValue"]),g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":u},null,8,["modelValue"])])]),a("section",Im,[y[7]||(y[7]=a("header",{class:"quickprint-config-header"},"方向",-1)),g($t,{modelValue:n.config.orientation,"onUpdate:modelValue":y[0]||(y[0]=p=>n.config.orientation=p),options:v(Gl)},null,8,["modelValue","options"])]),a("section",Am,[a("header",qm,[a("span",Om,[g(v(So),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:se(()=>y[8]||(y[8]=[oe("参考边距")])),_:1})]),y[9]||(y[9]=a("span",null,"单位：",-1)),g(_s,{modelValue:t.value,"onUpdate:modelValue":y[1]||(y[1]=p=>t.value=p)},null,8,["modelValue"])]),a("div",Mm,[g(Qe,{class:"quickprint-form-inline-item",label:"上",modelValue:v(l),"onUpdate:modelValue":y[2]||(y[2]=p=>me(l)?l.value=p:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),g(Qe,{class:"quickprint-form-inline-item",label:"下",modelValue:v(s),"onUpdate:modelValue":y[3]||(y[3]=p=>me(s)?s.value=p:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),a("div",Dm,[g(Qe,{class:"quickprint-form-inline-item",label:"左",modelValue:v(o),"onUpdate:modelValue":y[4]||(y[4]=p=>me(o)?o.value=p:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),g(Qe,{class:"quickprint-form-inline-item",label:"右",modelValue:v(c),"onUpdate:modelValue":y[5]||(y[5]=p=>me(c)?c.value=p:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),xm={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Vm={class:"quickprint-is-fill-h"},zm={class:"quickprint-is-fill-h"},Bm=q({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Te.NONE},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],l=N(()=>kn.map(u=>(u.style={fontFamily:u.value==ee.DEFAULT?ee.SONG:u.value},u))),s=N(()=>cs.map(u=>(u.style={fontFamily:u.value==ee.DEFAULT?ee.SONG:u.value},u))),o=N({get(){return e.config.style.fontFamily??ee.DEFAULT},set(u){const d=u===ee.DEFAULT?void 0:u;e.config.style.fontFamily=d}}),c=N({get(){return e.config.style.enFontFamily??ee.DEFAULT},set(u){const d=u===ee.DEFAULT?void 0:u;e.config.style.enFontFamily=d}}),r=N({get(){return e.config.style.fontSize},set(u){const d=le(u)?void 0:u;e.config.style.fontSize=d}}),i=N({get(){return e.config.style.lineHeight},set(u){e.config.style.lineHeight=u}});return(u,d)=>(C(),L("div",xm,[a("section",{class:f(u.classes.font)},[a("div",{class:f(u.classes.zhFont)},[a("div",{class:f(u.classes.title)},"中文字体",2),a("div",Vm,[g(v(X),{options:l.value,modelValue:o.value,"onUpdate:modelValue":d[0]||(d[0]=h=>o.value=h)},null,8,["options","modelValue"])])],2),a("div",{class:f(u.classes.enFont)},[a("div",{class:f(u.classes.title)},"西文字体",2),a("div",zm,[g(v(X),{options:s.value,modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=h=>c.value=h)},null,8,["options","modelValue"])])],2),a("div",{class:f(u.classes.lineHeight)},[a("div",{class:f(u.classes.title)},"行高",2),g(ft,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=h=>i.value=h),options:t},null,8,["modelValue"])],2),a("div",{class:f(u.classes.fontSize)},[a("div",{class:f(u.classes.title)},"字号",2),g(vs,{modelValue:r.value,"onUpdate:modelValue":d[3]||(d[3]=h=>r.value=h),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),Fm="_font_145qf_2",Um="_zhFont_145qf_9",Hm="_enFont_145qf_16",Gm="_lineHeight_145qf_23",Wm="_fontSize_145qf_30",Ym="_title_145qf_45",Xm={font:Fm,zhFont:Um,enFont:Hm,lineHeight:Gm,fontSize:Wm,title:Ym},jm={classes:Xm},Zm=D(Bm,[["__cssModules",jm]]),Km=q({__name:"index",props:{doc:{type:de,required:!0}},setup(n){const e=n,t=xe(),l=Pe(c()),s=K("paper"),o=[{label:"纸张",value:"paper"},{label:"字体",value:"font"}];function c(){const d=e.doc;return{size:d.paper.size,width:d.paper.width,height:d.paper.height,orientation:d.paper.orientation,margins:d.margins?{...d.margins}:void 0,style:{...d.style}}}function r(d){s.value=d.value}function i(){t==null||t.confirm(l)}function u(){t==null||t.cancel()}return(d,h)=>(C(),L("div",{class:f(d.classes.setting)},[a("div",{class:f(d.classes.header)},[a("div",{class:f(d.classes.headerLeft)},[g(v(O),{icon:"icon-setting",size:"14px"}),a("span",{class:f(d.classes.title)},"文档",2),g(bs,{tabs:o,active:s.value,onSwitch:r},null,8,["active"])],2),v(t)?(C(),j(v(Nl),{key:0,instance:v(t)},null,8,["instance"])):F("",!0)],2),s.value=="paper"?(C(),j(Pm,{key:0,config:l},null,8,["config"])):F("",!0),s.value=="font"?(C(),j(Zm,{key:1,config:l},null,8,["config"])):F("",!0),a("div",{class:f(d.classes.footer)},[a("button",{type:"button",class:"quickprint-text-btn",onClick:u},"取消"),a("button",{type:"button",class:"quickprint-text-btn",onClick:i},"确定")],2)],2))}}),Jm="_setting_i01g8_2",Qm="_header_i01g8_11",eh="_headerLeft_i01g8_23",th="_title_i01g8_36",nh="_tabs_i01g8_43",lh="_footer_i01g8_48",sh={setting:Jm,header:Qm,headerLeft:eh,title:th,tabs:nh,footer:lh},oh={classes:sh},ih=D(Km,[["__cssModules",oh]]),rh=Ve(function(n){return Zt("文档设置",g(ih,{doc:n},null),{preset:"setting"}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(qe)}),ah=["disabled"],ch=["disabled"],uh=q({__name:"index",setup(n){const e=ve(),t=N(()=>e.history.allowUndo()),l=N(()=>e.history.allowRedo()),s=lm(e),o=sm(e),c=Kf(e),r=Qf(e),i=Jf(e),u=om(e),d=im(e),h=em(e),m=jf(e),b=Zf(e),y=tm(e),p=N(()=>{var w;return((w=Vn.find(R=>R.value===y.value))==null?void 0:w.label)??"水平对齐"}),S=nm(e),$=N(()=>{var w;return((w=xn.find(R=>R.value===S.value))==null?void 0:w.label)??"垂直对齐"}),M=N(()=>kn.map(w=>(w.style={fontFamily:w.value==ee.DEFAULT?ee.SONG:w.value},w)));async function E(){const w=await fa(e.doc);w!=null&&(e.doc.ds=e.doc.createDS(w))}function T(){const w=e.getSelectedElements();if(w.length==0)return;const R=Math.min(...w.map(I=>I.left));for(const I of w)I.setLeft(R,!0);e.createSnapshot()}function _(){const w=e.getSelectedElements();if(w.length==0)return;const R=w[0].page;if(R==null)return;const I=Pt(R.width);for(const H of w)H.setLeft((I-H.width)/2);e.createSnapshot()}function k(){const w=e.getSelectedElements();if(w.length==0)return;const R=Math.max(...w.map(I=>I.left+I.width));for(const I of w)I.setLeft(R-I.width,!0);e.createSnapshot()}return(w,R)=>(C(),L("div",{class:f(w.classes.toolbar),onMousedown:R[20]||(R[20]=te(()=>{},["prevent"]))},[Ie(w.$slots,"toolbarLeft"),a("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:!t.value,onClick:R[0]||(R[0]=(...I)=>v(e).history.undo&&v(e).history.undo(...I))},[g(v(O),{icon:"icon-undo"})],8,ah),a("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:!l.value,onClick:R[1]||(R[1]=(...I)=>v(e).history.redo&&v(e).history.redo(...I))},[g(v(O),{icon:"icon-redo"})],8,ch),a("button",{type:"button",class:f(["quickprint-text-btn",w.classes.tool]),title:"删除",onClick:R[2]||(R[2]=I=>v(e).deleteSelectedElement())},[g(v(O),{icon:"icon-delete",size:"16px"})],2),a("div",{class:f(w.classes.divider)},null,2),g(v(X),{title:"字体",width:"80px",modelValue:v(s),"onUpdate:modelValue":R[3]||(R[3]=I=>me(s)?s.value=I:null),options:M.value,class:f(w.classes.tool),button:""},null,8,["modelValue","options","class"]),g(v(X),{title:"字号",width:"60px",modelValue:v(o),"onUpdate:modelValue":R[4]||(R[4]=I=>me(o)?o.value=I:null),options:v(ll),class:f(w.classes.tool),button:""},null,8,["modelValue","options","class"]),g(v(X),{title:"行高",width:"60px",modelValue:v(c),"onUpdate:modelValue":R[5]||(R[5]=I=>me(c)?c.value=I:null),options:v(us),class:f(w.classes.tool),popoverWidth:120,button:""},null,8,["modelValue","options","class"]),a("div",{class:f(w.classes.divider)},null,2),g(et,{modelValue:v(r),"onUpdate:modelValue":R[6]||(R[6]=I=>me(r)?r.value=I:null),class:f(w.classes.tool)},{default:se(()=>[a("div",{class:f(w.classes.colorIcon),title:"背景色"},[g(v(O),{icon:"icon-bg-color-a",size:"15px"}),a("div",{class:f(w.classes.colorIndicator),style:Y({backgroundColor:v(r)})},null,6)],2)]),_:1},8,["modelValue","class"]),g(et,{modelValue:v(i),"onUpdate:modelValue":R[7]||(R[7]=I=>me(i)?i.value=I:null),class:f(w.classes.tool)},{default:se(()=>[a("div",{class:f(w.classes.colorIcon),title:"突出显示"},[g(v(O),{icon:"icon-bg-color-b",size:"15px"}),a("div",{class:f(w.classes.colorIndicator),style:Y({backgroundColor:v(i)})},null,6)],2)]),_:1},8,["modelValue","class"]),g(et,{modelValue:v(u),"onUpdate:modelValue":R[8]||(R[8]=I=>me(u)?u.value=I:null),class:f(w.classes.tool)},{default:se(()=>[a("div",{class:f(w.classes.colorIcon),title:"字体颜色"},[g(v(O),{icon:"icon-font",size:"15px"}),a("div",{class:f(w.classes.colorIndicator),style:Y({backgroundColor:v(u)})},null,6)],2)]),_:1},8,["modelValue","class"]),a("button",{type:"button",title:"加粗",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0,"quickprint-is-selected":v(d)}),onClick:R[9]||(R[9]=I=>d.value=!v(d))},[g(v(O),{icon:"icon-font-bold",size:"16px"})],2),a("button",{type:"button",title:"斜体",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0,"quickprint-is-selected":v(h)}),onClick:R[10]||(R[10]=I=>h.value=!v(h))},[g(v(O),{icon:"icon-italic",size:"16px"})],2),a("button",{type:"button",title:"下划线",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0,"quickprint-is-selected":v(m)}),onClick:R[11]||(R[11]=I=>m.value=!v(m))},[g(v(O),{icon:"icon-underline",size:"16px"})],2),a("button",{type:"button",title:"删除线",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0,"quickprint-is-selected":v(b)}),onClick:R[12]||(R[12]=I=>b.value=!v(b))},[g(v(O),{icon:"icon-through-line",size:"16px"})],2),a("div",{class:f(w.classes.divider)},null,2),g(Xf),g(v(X),{options:v(Vn),modelValue:v(y),"onUpdate:modelValue":R[13]||(R[13]=I=>me(y)?y.value=I:null),title:p.value,class:f(w.classes.tool),width:"36px",size:"mini",button:""},{selected:se(({option:I})=>[g(v(O),{icon:I==null?void 0:I.icon,class:"quickprint-is-self-center"},null,8,["icon"])]),_:1},8,["options","modelValue","title","class"]),g(v(X),{modelValue:v(S),"onUpdate:modelValue":R[14]||(R[14]=I=>me(S)?S.value=I:null),options:v(xn),title:$.value,class:f(w.classes.tool),width:"36px",size:"mini",button:""},{selected:se(({option:I})=>[g(v(O),{icon:I==null?void 0:I.icon,class:"quickprint-is-self-center"},null,8,["icon"])]),_:1},8,["modelValue","options","title","class"]),a("div",{class:f(w.classes.divider)},null,2),a("button",{type:"button",title:"左侧对齐",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0}),onClick:T},[g(v(O),{icon:"icon-layout-align-left",size:"16px"})],2),a("button",{type:"button",title:"水平居中",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0}),onClick:_},[g(v(O),{icon:"icon-layout-align-center",size:"16px"})],2),a("button",{type:"button",title:"右侧对齐",class:f({"quickprint-text-btn":!0,[w.classes.tool]:!0}),onClick:k},[g(v(O),{icon:"icon-layout-align-right",size:"16px"})],2),a("div",{class:f(w.classes.divider)},null,2),a("button",{type:"button",title:"网格",class:f({"quickprint-text-btn":!0,"quickprint-is-selected":v(e).doc.useGrid}),onClick:R[15]||(R[15]=I=>v(e).toggleBackground())},[g(v(O),{icon:"icon-beijing",size:"16px"})],2),a("button",{type:"button",title:"元素面板",class:f({"quickprint-text-btn":!0,"quickprint-is-selected":v(e).state.panel.left}),onClick:R[16]||(R[16]=I=>v(e).toggleElementPanel())},[g(v(O),{icon:"icon-pintu",size:"16px"})],2),a("button",{type:"button",title:"配置面板",class:f({"quickprint-text-btn":!0,"quickprint-is-selected":v(e).state.panel.right}),onClick:R[17]||(R[17]=I=>v(e).toggleConfigPanel())},[g(v(O),{icon:"icon-config",size:"16px"})],2),R[23]||(R[23]=a("div",{class:"quickprint-is-fill-w"},null,-1)),a("button",{type:"button",class:f({"quickprint-text-btn":!0}),onClick:R[18]||(R[18]=I=>E())},[g(v(O),{icon:"icon-datasource"}),R[21]||(R[21]=a("span",null,"数据源",-1))]),a("button",{type:"button",class:f({"quickprint-text-btn":!0}),onClick:R[19]||(R[19]=I=>v(rh)(v(e).doc))},[g(v(O),{icon:"icon-file-text"}),R[22]||(R[22]=a("span",null,"文档配置",-1))])],34))}}),dh="_toolbar_1bhq2_2",ph="_divider_1bhq2_8",fh="_tool_1bhq2_2",mh="_colorIcon_1bhq2_18",hh="_colorIndicator_1bhq2_38",gh={toolbar:dh,divider:ph,tool:fh,colorIcon:mh,colorIndicator:hh},vh={classes:gh},bh=D(uh,[["__cssModules",vh]]),yh={class:"quickprint-is-fill-h quickprint-is-scrollable"},_h="icon-zhanweifu",Eh=q({__name:"Element",setup(n){const e=ve();return(t,l)=>(C(),L("div",{class:f(t.classes.panel)},[a("div",{class:f(t.classes.header)},"可打印元素",2),a("div",yh,[a("div",{class:f(t.classes.grid)},[(C(!0),L(G,null,Z(v(ju),s=>(C(),L("div",Vl({key:s.type,class:[v(U).DRAGGABLE,t.classes.element],[`.${v(zl)||""}`]:v(Ce).INSERT,[`.${v(Zn)||""}`]:s.type,onPointerdown:l[0]||(l[0]=(...o)=>v(e).onDragStart&&v(e).onDragStart(...o))}),[g(v(O),{icon:s.icon??_h,size:"16px",class:f(t.classes.icon)},null,8,["icon","class"]),a("span",null,B(s.title),1)],48))),128))],2)])],2))}}),Th="_panel_1p36j_2",kh="_header_1p36j_8",wh="_grid_1p36j_18",Sh="_element_1p36j_30",Ch="_icon_1p36j_45",Rh={panel:Th,header:kh,grid:wh,element:Sh,icon:Ch},Lh={classes:Rh},Nh=D(Eh,[["__cssModules",Lh]]),$h=["onClick"],Ih=q({__name:"SelectPath",setup(n){const e=ve(),t=N(()=>{const o=e.state,c=[{id:e.doc.id,title:"文档",type:"document"}];if(o.selectedType===ue.PAGE){const r=e.getSelectedPage();if(r!=null){const i="页面"+(r.index+1);c.push({id:r.id,title:i,type:"page",data:r})}return c}if(o.selectedType===ue.ELEMENT){if(o.selectMode===lt.MULTIPLE){const u=e.getSelectedElements();if(u.length===0)return c;let d=u[0];for(;d.parent;){const h=d.parent;if(h instanceof Tt){const m="页面"+(h.index+1);return c.push({id:h.id,title:m,type:"page",data:h}),c}d=h}return c}let r=e.getSelectedElements()[0];if(r==null)return c;const i=[{id:r.id,title:jt(r.type),type:"element",data:r}];for(;r.parent;){const u=r.parent;if(u instanceof Tt){const d="页面"+(u.index+1);return i.unshift({id:u.id,title:d,type:"page",data:u}),c.concat(i)}i.unshift({id:u.id,title:jt(u.type),type:"element",data:u}),r=u}}return c}),l=N(()=>{if(e.state.selectedType!=ue.ELEMENT)return;const c=e.getSelectedElements();if(c.length!=1)return;const r=c[0],i=Qn(r,e.doc.ds);if(!(i==null||!i.content))return i.type===he.VARIABLE||i.type===he.FORMULA?`[${i.content}]`:i.content});function s(o){if(o.type==="element")return e.selectElement(o.data);if(o.type==="page")return e.selectPage(o.data)}return(o,c)=>(C(),L("div",{class:f(o.classes.paths)},[(C(!0),L(G,null,Z(t.value,(r,i)=>(C(),L(G,{key:r.id},[i>0?(C(),j(v(O),{key:0,class:f(o.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):F("",!0),a("div",{class:f(o.classes.path),onClick:u=>s(r)},B(r.title),11,$h)],64))),128)),l.value?(C(),L(G,{key:0},[g(v(O),{class:f(o.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),a("div",{class:f(o.classes.content)},B(l.value),3)],64)):F("",!0)],2))}}),Ah="_paths_fuk62_2",qh="_path_fuk62_2",Oh="_icon_fuk62_28",Mh="_content_fuk62_33",Dh={paths:Ah,path:qh,icon:Oh,content:Mh},Ph={classes:Dh},xh=D(Ih,[["__cssModules",Ph]]),Vh={class:"quickprint-config"},zh={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},Bh={class:"quickprint-config-group"},Fh={class:"quickprint-config-section quickprint-config-inline"},Uh={class:"quickprint-config-content quickprint-config-inline"},Hh={class:"quickprint-config-section quickprint-config-inline"},Gh={class:"quickprint-config-content quickprint-config-inline"},Wh={class:"quickprint-config-section quickprint-config-inline"},Yh={class:"quickprint-config-content quickprint-form-inline"},Xh={key:0,class:"quickprint-config-section quickprint-config-inline"},jh={class:"quickprint-config-content quickprint-form-inline"},Zh={class:"quickprint-config-section quickprint-config-inline"},Kh={class:"quickprint-config-content quickprint-form-inline"},Jh=q({__name:"PageConfig",props:{page:{type:Tt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=N({get(){return e.page.size.type},set(r){e.page.size.type=r,r===Yt.CONTENT&&(e.page.size.orientation=void 0)}}),s=N({get(){return e.page.orientation},set(r){e.page.size.orientation=r}}),o=N(()=>e.page.width),c=N({get(){return e.page.height},set(r){const i=Number(r);!Gn(i)||i<0||(e.page.size.height=i)}});return(r,i)=>(C(),L("div",Vh,[i[11]||(i[11]=a("div",{class:"quickprint-config-title"},"页面配置",-1)),a("div",zh,[a("div",Bh,[i[10]||(i[10]=a("div",{class:"quickprint-config-group-title"},"布局",-1)),a("section",Fh,[i[5]||(i[5]=a("header",{class:"quickprint-config-header"},"页眉",-1)),a("div",Uh,[g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),g($t,{modelValue:n.page.header.display,"onUpdate:modelValue":i[0]||(i[0]=u=>n.page.header.display=u),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),a("section",Hh,[i[6]||(i[6]=a("header",{class:"quickprint-config-header"},"页脚",-1)),a("div",Gh,[g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),g($t,{modelValue:n.page.footer.display,"onUpdate:modelValue":i[1]||(i[1]=u=>n.page.footer.display=u),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),a("section",Wh,[i[7]||(i[7]=a("header",{class:"quickprint-config-header"},"尺寸",-1)),a("div",Yh,[g($t,{modelValue:l.value,"onUpdate:modelValue":i[2]||(i[2]=u=>l.value=u),options:v(po),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===v(Yt).CONTENT?(C(),L("section",Xh,[i[8]||(i[8]=a("header",{class:"quickprint-config-header"},"内容",-1)),a("div",jh,[g(It,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,readonly:""},null,8,["modelValue"]),g(It,{class:"quickprint-form-inline-item",label:"高",modelValue:c.value,"onUpdate:modelValue":i[3]||(i[3]=u=>c.value=u)},null,8,["modelValue"])])])):F("",!0),a("section",Zh,[i[9]||(i[9]=a("header",{class:"quickprint-config-header"},"方向",-1)),a("div",Kh,[g($t,{modelValue:s.value,"onUpdate:modelValue":i[4]||(i[4]=u=>s.value=u),options:v(Gl),class:"quickprint-w-full",disabled:n.page.size.type===v(Yt).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),Qh={},eg={class:"quickprint-config"};function tg(n,e){return C(),L("div",eg,e[0]||(e[0]=[a("div",{class:"quickprint-config-title"},"多选配置",-1),a("div",{class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},"TODO:",-1)]))}const ng=D(Qh,[["render",tg]]),lg=q({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=K(!1);function s(){t("copy",async function(c){await navigator.clipboard.writeText(c).catch(Hs)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(o,c)=>(C(),L("button",{type:"button",class:f(["quickprint-text-btn",o.classes.btn]),title:"复制",onClick:s},[g(v(O),{icon:"icon-copy"}),g(no,{name:"quickprint-fade"},{default:se(()=>[l.value?(C(),L("span",{key:0,class:f(o.classes.message)},"已复制",2)):F("",!0)]),_:1})],2))}}),sg="_btn_v9scw_2",og="_message_v9scw_6",ig={btn:sg,message:og},rg={classes:ig},ag=D(lg,[["__cssModules",rg]]),cg=q({__name:"window",props:{code:{type:String,default:""},doc:{type:de,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=xe(),l=K(e.code),s=re();function o(){return l.value}function c(){e.doc!=null&&ma({doc:e.doc}).then(h=>{var b;if(h==null)return;const m=h.type=="reference"?`[=${h.value}]`:`[${h.value}]`;(b=s.value)==null||b.insert(m)})}function r(h){var m;return st(h,(m=e.doc)==null?void 0:m.ds)}function i(){var h;(h=s.value)==null||h.insert(`[2.6.${Fn.ELEMENT_VALUR}]`)}function u(){ha().then(h=>{var m;h!=null&&((m=s.value)==null||m.insert(h.value))})}function d(){ga({doc:e.doc}).then(h=>{var m;h!=null&&((m=s.value)==null||m.insert(h.value))})}return t==null||t.useHandle("confirm",o),(h,m)=>(C(),L("div",{class:f(h.classes.window)},[n.mode!=="code"?(C(),L("div",{key:0,class:f(h.classes.toolbar)},[n.mode=="condition"?(C(),L("button",{key:0,type:"button",class:"quickprint-text-btn",onClick:i},"插入元素值")):F("",!0),a("button",{type:"button",onClick:c,class:"quickprint-text-btn"},[g(v(O),{icon:"icon-insert-var"}),m[1]||(m[1]=a("span",null,"插入变量",-1))]),a("button",{type:"button",class:"quickprint-text-btn",onClick:u},[g(v(O),{icon:"icon-function"}),m[2]||(m[2]=a("span",null,"插入函数",-1))]),a("button",{type:"button",class:"quickprint-text-btn",onClick:d},"插入公式")],2)):F("",!0),g(v(ys),{modelValue:l.value,"onUpdate:modelValue":m[0]||(m[0]=b=>l.value=b),language:"javascript",class:f(h.classes.code),formatVariable:r,autofocus:"",ref_key:"codeRef",ref:s},null,8,["modelValue","class"])],2))}}),ug="_window_14zxh_2",dg="_toolbar_14zxh_11",pg="_code_14zxh_22",fg={window:ug,toolbar:dg,code:pg},mg={classes:fg},Es=D(cg,[["__cssModules",mg]]),Ts=Ve(function(n){return Et("公式",g(Es,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(qe)}),hg=Ve(function(n,e){return Et(n,g(Es,{code:e},null),{preset:"editor"}).promisify().catch(qe)}),gg={class:"quickprint-config-section quickprint-config-inline"},vg={class:"quickprint-config-content"},bg=["value"],yg=q({__name:"Visibility",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N({get(){var r;return((r=e.element.visibility)==null?void 0:r.type)??yt.VISIBLE},set(r){e.element.visibility==null&&(e.element.visibility={}),r!==yt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=r}}),l=N({get(){var r;return((r=e.element.visibility)==null?void 0:r.condition)??""},set(r){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=r}}),s=N(()=>{var r;return el((r=e.element.visibility)==null?void 0:r.condition,e.element.doc)}),o=N(()=>{var r;return t.value!==yt.CONDITION?!1:!((r=e.element.visibility)!=null&&r.condition)});function c(){const r=l.value||`[2.6.${Fn.ELEMENT_VALUR}]`;Ts({code:r,doc:e.element.doc,mode:"condition"}).then(i=>{i!=null&&(l.value=i)})}return(r,i)=>(C(),L(G,null,[a("section",gg,[i[1]||(i[1]=a("header",{class:"quickprint-config-header"},"可见性",-1)),a("div",vg,[g(v(X),{class:"quickprint-w-full",options:v(oo),modelValue:t.value,"onUpdate:modelValue":i[0]||(i[0]=u=>t.value=u)},null,8,["options","modelValue"])])]),t.value===v(yt).CONDITION?(C(),L("div",{key:0,class:f([r.classes.condition,"quickprint-config-section"]),onClick:c},[a("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,bg),o.value?(C(),j(v(O),{key:0,icon:"icon-open-new",size:"14px"})):F("",!0)],2)):F("",!0)],64))}}),_g="_condition_siopf_2",Eg={condition:_g},Tg={classes:Eg},kg=D(yg,[["__cssModules",Tg]]);function wg(n){return N({get(){return n.element.attributes.position??an.DEFAULT},set(e){const t=e===an.DEFAULT?void 0:e;n.element.attributes.position=t}})}function Sg(n){return N({get(){return n.element.attributes.printMode??cn.ONCE},set(e){const t=e===cn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function Cg(n){return N({get(){return n.element.attributes.overflow??Xt.HIDDEN},set(e){const t=e===Xt.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function Rg(n){return N({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function Lg(n){return N({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function Ng(n){return N({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function $g(n){return N({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const Ig=q({__name:"Const",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,s)=>ge((C(),L("textarea",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Le,t.value]])}}),Ag={class:"quickprint-config-ds-var-type"},qg=["title"],Og=q({__name:"Variable",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=ve(),l=N(()=>le(e.element.ds.value)),s=N(()=>st(e.element.ds.value,t.doc.ds));function o(r){r.stopPropagation(),e.element.ds.value=void 0}async function c(){var d;const r=await tl({doc:t.doc,value:e.element.ds.value}).catch(Ke);if(r==null||(e.element.setDataSource(he.VARIABLE,r.value),e.element.type!=W.TABLE_CELL||r.type!=="ds"))return;const i=e.element.parent;if(i==null||i.isBindVariable||((d=r.parent)==null?void 0:d.type)!==J.ARRAY)return;const u=r.parent;i.setDataSource(he.VARIABLE,`${je.DS}.${u.type}.${u.name}`)}return(r,i)=>(C(),L("div",{class:"quickprint-config-ds-variable",onClick:c},[l.value?(C(),L(G,{key:0},[i[0]||(i[0]=a("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),g(v(O),{icon:"icon-open-new",size:"14px"})],64)):(C(),L(G,{key:1},[a("span",Ag,"<"+B(v(vi)(e.element.ds.value))+">",1),a("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:s.value},B(s.value),9,qg),a("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:o},[g(v(O),{icon:"icon-close",size:"12px"})])],64))]))}}),Mg=["value"],Dg=q({__name:"Code",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=N(()=>le(e.element.ds.value));function l(){return Hn(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function s(){hg("自定义",l()).then(o=>{o!=null&&(e.element.ds.value=o)})}return(o,c)=>(C(),L("div",{onClick:s,class:f(o.classes.code)},[a("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Mg),t.value?(C(),j(v(O),{key:0,icon:"icon-open-new",size:"14px"})):F("",!0)],2))}}),Pg="_code_1az68_2",xg={code:Pg},Vg={classes:xg},zg=D(Dg,[["__cssModules",Vg]]),Bg=["value"],Fg=q({__name:"Formula",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=ve(),l=N(()=>le(e.element.ds.value)),s=N(()=>el(e.element.ds.value,e.element.doc));function o(){const c=e.element.ds.value;Ts({code:c,doc:t.doc,mode:"formula"}).then(r=>{r!=null&&(e.element.ds.value=r)})}return(c,r)=>(C(),L("div",{onClick:o,class:f(c.classes.code)},[a("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Bg),l.value?(C(),j(v(O),{key:0,icon:"icon-open-new",size:"14px"})):F("",!0)],2))}}),Ug="_code_ipm2q_2",Hg={code:Ug},Gg={classes:Hg},Wg=D(Fg,[["__cssModules",Gg]]);function Yg(n){switch(n.ds.type){case he.CONST:return g(Ig,{element:n},null);case he.VARIABLE:return g(Og,{element:n},null);case he.CODE:return g(zg,{element:n},null);case he.FORMULA:return g(Wg,{element:n},null);default:return null}}const Cl=q({props:{element:{type:pe,required:!0}},setup(n){const e=N(()=>jt(n.element.type)),t=N(()=>co.filter(E=>E.value!=n.element.type)),l=K("px"),s=Rg(n),o=Lg(n),c=Cg(n),r=wg(n),i=Sg(n),u=Ng(n),d=$g(n),h=N(()=>{const E=n.element,T=E.parent;if(T===null||!(T instanceof Tt))return!1;const _=T.header;if(_.display&&E.bottom<=(_.height??0))return!1;const k=T.parent;if(k==null)return!1;const w=T.footer;return!(w.display&&E.top>=Math.floor(Pt(k.paper.height))-(w.height??0))});function m(E,T){return T==null?!1:!!T.includes(E)}function b(){const E=Lt(n.element.type);if(m(ne.LAYOUT,E==null?void 0:E.exclude))return null;const T=n.element,_=m(ne.COORD,E==null?void 0:E.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("位置")]),g("div",{class:"quickprint-config-content quickprint-form-inline"},[g(Qe,{class:"quickprint-form-inline-item",label:"左",modelValue:T.left,"onUpdate:modelValue":V=>T.left=V,target:l.value},null),g(Qe,{class:"quickprint-form-inline-item",label:"上",modelValue:T.top,"onUpdate:modelValue":V=>T.top=V,target:l.value},null)])]),k=m(ne.SIZE)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[g("span",null,[oe("尺寸")])]),g("div",{class:"quickprint-config-content quickprint-form-inline"},[g(Qe,{class:"quickprint-form-inline-item",label:"宽",modelValue:s.value,"onUpdate:modelValue":V=>s.value=V,target:l.value},null),g(Qe,{class:"quickprint-form-inline-item",label:"高",modelValue:o.value,"onUpdate:modelValue":V=>o.value=V,target:l.value},null)])]),w=m(ne.VISIBILITY,E==null?void 0:E.exclude)?null:g(kg,{element:T},null),R=m(ne.OVERFLOW,E==null?void 0:E.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("溢出时")]),g("div",{class:"quickprint-config-content"},[g(X,{modelValue:c.value,"onUpdate:modelValue":V=>c.value=V,options:ho,class:"quickprint-w-full"},null)])]),I=m(ne.PRINT_MODE,E==null?void 0:E.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header "},[oe("打印模式")]),g("div",{class:"quickprint-config-content"},[g(X,{modelValue:i.value,"onUpdate:modelValue":V=>i.value=V,options:mo,class:"quickprint-w-full"},null)])]),H=m(ne.POSITION,E==null?void 0:E.exclude)||!h.value?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("定位模式")]),g("div",{class:"quickprint-config-content"},[g(X,{modelValue:r.value,"onUpdate:modelValue":V=>r.value=V,options:fo,class:"quickprint-w-full"},null)])]);return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title quickprint-is-row"},[g("span",{class:"quickprint-is-fill-w"},[oe("布局")]),g("span",null,[oe("单位：")]),g(_s,{modelValue:l.value,"onUpdate:modelValue":V=>l.value=V},null)]),_,k,w,R,I,H])}function y(){const E=Lt(n.element.type);if(m(ne.BASIC,E==null?void 0:E.exclude))return null;const T=n.element,_=m(ne.PREFIX,E==null?void 0:E.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("前缀")]),g("div",{class:"quickprint-config-content"},[ge(g("input",{"onUpdate:modelValue":R=>T.attributes.prefix=R,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Le,T.attributes.prefix]])])]),k=m(ne.SUFFIX,E==null?void 0:E.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("后缀")]),g("div",{class:"quickprint-config-content"},[ge(g("input",{"onUpdate:modelValue":R=>T.attributes.suffix=R,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Le,T.attributes.suffix]])])]),w=m(ne.DISPLAY,E==null?void 0:E.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("数据类型")]),g("div",{class:"quickprint-config-content"},[g(X,{options:t.value,modelValue:u.value,"onUpdate:modelValue":R=>u.value=R,class:"quickprint-w-full"},null)])]);return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[oe("基础")]),_,k,w])}function p(){const E=Lt(n.element.display);return(E==null?void 0:E.display)==null?null:tt(E.display,{element:n.element})}function S(){const E=Lt(n.element.type);if(m(ne.ATTRIBUTES,E==null?void 0:E.exclude))return null;const T=E!=null&&E.attributes?tt(E.attributes,{element:n.element}):null,_=p();if(T==null&&_==null)return null;const k=_!=null&&T!=null?g("div",{class:"quickprint-config-divider"},null):null;return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[oe("属性")]),_,k,T])}function $(){const E=Lt(n.element.type);return m(ne.DATASOURCE,E==null?void 0:E.exclude)?null:g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[oe("数据")]),g(X,{options:Ul,modelValue:d.value,"onUpdate:modelValue":T=>d.value=T},null),Yg(n.element)])}function M(E){E(n.element.id)}return function(){const T=n.element;return g("div",{class:"quickprint-config"},[g("div",{class:"quickprint-config-title"},[g("span",null,[e.value,oe("配置")]),null]),g("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[g("div",{class:"quickprint-config-group"},[g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("标识")]),g("div",{class:"quickprint-config-content"},[g("span",{class:"quickprint-config-id"},[T.id]),g(ag,{onCopy:M},null)])]),g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[oe("标题")]),g("div",{class:"quickprint-config-content"},[ge(g("input",{type:"text","onUpdate:modelValue":_=>T.title=_,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Le,T.title]])])])]),b(),y(),S(),$()])])}}}),Xg=q({setup(){const n=ve();function e(){return g("div",null,[oe("未知的打印元素")])}function t(){return g("div",null,[oe("请先选择元素")])}function l(){return g("div",null,[oe("请先选择页面")])}return function(){const s=n.state;if(s.selectedType===ue.PAGE){const o=n.getSelectedPage();return o==null?l():g(Jh,{page:o},null)}if(s.selectMode===lt.SINGLE){const o=n.getSelectedElements()[0];return o==null?t():tt(Cl,{element:o,key:o.id})}if(s.selected.length==1){const o=n.getSelectedElements()[0];return Lt(o.type)==null?e():tt(Cl,{element:o,key:o.id})}return g(ng,null,null)}}});function jg(n){let e=null;const t=re(),l=Pe({width:0,height:0,scrollTop:0,scrollLeft:0}),s=re(),o=Pe({id:"",top:0,left:0,width:0,height:0});async function c(){await xt();const b=t.value;b!=null&&(l.width=b.offsetWidth,l.height=b.offsetHeight)}function r(b){const y=b.target;l.scrollLeft=y.scrollLeft,l.scrollTop=y.scrollTop}function i(b){const p=b.target.closest("."+U.PAPER);p!=null&&(s.value=p,d(p),u())}async function u(){await xt();const b=s.value;b!=null&&(o.id=b.id.slice(1),o.width=b.offsetWidth,o.height=b.offsetHeight,o.top=b.offsetTop,o.left=b.offsetLeft)}function d(b){b!=null&&(s.value&&(e==null||e.unobserve(s.value)),e==null||e.observe(b))}function h(){const b=n.doc.firstPage;if(b==null)return;const y=document.querySelector("#\\@"+b.id);s.value=y,e&&y&&e.observe(y),u()}function m(b){b.some(y=>y.target.matches("."+U.CANVAS))&&(c(),u()),b.some(y=>y.target.matches("."+U.PAPER))&&(c(),u())}return jn(()=>n.state.scale,()=>u()),Jt(()=>{e=new ResizeObserver(m),e.observe(t.value),h(),c()}),lo(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:o,onScroll:r,onSelectPage:i}}const Zg=q({__name:"index",props:kt({modelValue:{type:de,required:!0}},{modelValue:{required:!0},modelModifiers:{}}),emits:kt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=re(),s=re(),o=bo(),c=Kt(n,"modelValue"),r=Cd(c,{getGhostElement:$,getRootElement:M}),{canvasRef:i,canvasRect:u,pageRect:d,onScroll:h,onSelectPage:m}=jg(r),b=N(()=>({"--quickprint-page-scale":r.state.scale/100,"--quickprint-dpr":o.value})),y=N(()=>{const k=r.doc.style;return{fontFamily:Jn(k==null?void 0:k.fontFamily,k==null?void 0:k.enFontFamily),fontSize:k==null?void 0:k.fontSize,lineHeight:k==null?void 0:k.lineHeight}});function p(){r.state.panel.left=!1}function S(){r.state.panel.right=!1}function $(){return s.value}function M(){return l.value}function E(k){k.deltaY>0?r.zoomIn():r.zoomOut()}function T(){t("preview",c.value)}function _(){t("save",c.value)}return(k,w)=>(C(),L("div",{class:f(k.classes.designer),ref_key:"rootRef",ref:l,style:Y(b.value)},[a("div",{class:f(k.classes.header)},[a("div",{class:f(k.classes.headerLeft)},[Ie(k.$slots,"headerLeft")],2),g(bh,{class:f(k.classes.toolbar)},{toolbarLeft:se(()=>[Ie(k.$slots,"toolbarLeft")]),_:3},8,["class"]),a("div",{class:f(k.classes.headerRight)},[a("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:T},[g(v(O),{icon:"icon-run"}),w[2]||(w[2]=a("span",null,"预览",-1))]),a("button",{type:"button",onClick:_,class:"quickprint-text-btn",title:"保存"},[g(v(O),{icon:"icon-save"}),w[3]||(w[3]=a("span",null,"保存",-1))])],2)],2),a("div",{class:f(k.classes.main)},[v(r).state.panel.left?(C(),L("div",{key:0,class:f(k.classes.left)},[a("button",{type:"button",onClick:p,class:f(["quickprint-text-btn",k.classes.closePanelBtn])},[g(v(O),{icon:"icon-close",size:"12px"})],2),g(Nh)],2)):F("",!0),a("div",{class:f([k.classes.center,v(U).CANVAS]),onWheelPassive:te(E,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:i},[g(wl,{canvas:v(u),page:v(d),scale:v(r).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),g(wl,{canvas:v(u),page:v(d),scale:v(r).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),a("div",{class:f([v(U).SCROLLABLE,k.classes.canvas]),style:Y(y.value),onScroll:w[0]||(w[0]=(...R)=>v(h)&&v(h)(...R)),onClickCapture:w[1]||(w[1]=(...R)=>v(m)&&v(m)(...R))},[(C(!0),L(G,null,Z(c.value.pages,R=>(C(),j(Vf,{key:R.id,doc:c.value,page:R,onSave:_,onPreview:T},null,8,["doc","page"]))),128))],38),a("div",{class:f(k.classes.footer)},[g(xh),g(v(Gs),{scale:v(r).state.scale,onZoomIn:v(r).zoomIn,onZoomOut:v(r).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),v(r).state.panel.right?(C(),L("div",{key:1,class:f(k.classes.right)},[a("button",{type:"button",onClick:S,class:f(["quickprint-text-btn",k.classes.closePanelBtn])},[g(v(O),{icon:"icon-close",size:"12px"})],2),g(v(Xg))],2)):F("",!0)],2),a("div",{ref_key:"ghostRef",ref:s,class:f(k.classes.ghost)},null,2),g(v(Ws))],6))}}),Kg="_designer_1du88_2",Jg="_header_1du88_17",Qg="_headerLeft_1du88_25",ev="_headerRight_1du88_36",tv="_toolbar_1du88_43",nv="_footer_1du88_49",lv="_main_1du88_65",sv="_left_1du88_73",ov="_center_1du88_81",iv="_right_1du88_93",rv="_canvas_1du88_101",av="_closePanelBtn_1du88_114",cv="_ghost_1du88_121",uv={designer:Kg,header:Jg,headerLeft:Qg,headerRight:ev,toolbar:tv,footer:nv,main:lv,left:sv,center:ov,right:iv,canvas:rv,closePanelBtn:av,ghost:cv},dv={classes:uv},pv=D(Zg,[["__cssModules",dv]]),fv={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:ln.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(qe)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:ln.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:ln.DISABLED}};function mv(n,e={}){const t=Ys(e.zIndexManager);n.use(Xs,{zIndex:t,presets:fv}),js(n._context)}const hv="0.0.0",gv={version:hv,install:mv},vv=["onClick"],bv=q({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=xe();function l(s){t==null||t.confirm(s)}return(s,o)=>(C(),L("div",{class:f(s.classes.panel)},[(C(!0),L(G,null,Z(v(Zs),(c,r)=>(C(),L("div",{key:c.id,class:f(s.classes.item),onClick:i=>l(c)},[a("div",null,[a("span",null,B(r+1)+". ",1),a("span",null,B(c.name),1)])],10,vv))),128))],2))}}),yv="_panel_1he7q_2",_v="_item_1he7q_9",Ev={panel:yv,item:_v},Tv={classes:Ev},kv=D(bv,[["__cssModules",Tv]]),wv="local",Rl="quickprint-local-define",Sv=q({__name:"index",setup(n){const e=Oe("classes"),t=h();function l(){const m=JSON.stringify(t.value);localStorage.setItem(Rl,m)}function s(){l()}function o(){const m=t.value.id,b=m.startsWith("case_")?m:wv,y=`${window.location.origin}/preview.html?id=${b}`;l(),Et("文档预览",tt("iframe",{src:y,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(p){window.open(y,"_blank"),p.close()}}]})}function c(){const m={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:ln.DISABLED};Et("选择示例",tt(kv),m).promisify().then(b=>r(b.id)).catch(qe)}async function r(m){const b=await cl(m,!1);b!=null&&(Ks(m),t.value=de.create(b.define),u())}function i(){const m=de.createNormalDocument();t.value=m,u()}function u(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function d(){const m=localStorage.getItem(Rl);if(m!=null)return de.create(m);const b=Js(),y=await cl(b.id,!1);return y==null?de.createNormalDocument():de.create(y.define)}function h(){const m=K();return d().then(b=>{m.value=b,u()}),m}return(m,b)=>v(t)?(C(),j(v(pv),{modelValue:v(t),"onUpdate:modelValue":b[0]||(b[0]=y=>me(t)?t.value=y:null),class:f(v(e).main),key:v(t).id,onSave:s,onPreview:o},{headerLeft:se(()=>[a("div",{class:f(v(e).logo)},[b[1]||(b[1]=a("h1",null,"OpenPrint",-1)),a("div",{class:f(v(e).dev)},"DEV",2)],2)]),toolbarLeft:se(()=>[a("button",{type:"button",class:"quickprint-text-btn",onClick:i},[g(v(O),{icon:"icon-file-text"}),b[2]||(b[2]=a("span",null,"新建",-1))]),a("button",{type:"button",class:"quickprint-text-btn",onClick:c},[g(v(O),{icon:"icon-import"}),b[3]||(b[3]=a("span",null,"加载示例",-1))]),a("div",{class:f(v(e).divider)},null,2)]),_:1},8,["modelValue","class"])):F("",!0)}}),Cv="_main_1rj7p_2",Rv="_iframe_1rj7p_6",Lv="_divider_1rj7p_14",Nv="_logo_1rj7p_20",$v="_dev_1rj7p_35",Iv={main:Cv,iframe:Rv,divider:Lv,logo:Nv,dev:$v},Av={classes:Iv},qv=D(Sv,[["__cssModules",Av]]),ks=so(qv);ks.use(gv);ks.mount("#app");
