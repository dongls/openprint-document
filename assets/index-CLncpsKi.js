const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-YZCGC2CV.js","assets/vue-G-bsKplX.js","assets/component-D1r_2N_-.js","assets/utils-D26aPeJo.js","assets/utils-BWxIAY5I.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var gs=Object.defineProperty;var Ol=n=>{throw TypeError(n)};var hs=(n,e,t)=>e in n?gs(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var j=(n,e,t)=>hs(n,typeof e!="symbol"?e+"":e,t),rl=(n,e,t)=>e.has(n)||Ol("Cannot "+t);var Pe=(n,e,t)=>(rl(n,e,"read from private field"),t?t.call(n):e.get(n)),ot=(n,e,t)=>e.has(n)?Ol("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),Rt=(n,e,t,l)=>(rl(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),Ve=(n,e,t)=>(rl(n,e,"access private method"),t);import{D as ye,E as Mt,N as dn,a as Ct,b as G,c as We,P as _l,d as mn,e as Nl,f as qn,g as $n,O as gn,h as re,i as Tn,S as Ut,Q as hn,B as Xe,j as An,L as He,I as H,_ as F,k as lo,s as Un,l as vs,m as de,n as oo,p as Bn,C as ze,o as ue,q as El,r as so,t as qt,u as bs,v as ys,w as _s,x as ht,y as io,V as $t,z as Pn,A as vt,F as ro,G as ao,H as co,J as Te,K as tt,M as vn,T as Es,R as Ce,U as ut,W as we,X as Ze,Y as rt,Z as Ts,$ as Ss,a0 as Rs,a1 as Me,a2 as bn,a3 as Y,a4 as se,a5 as ge,a6 as Oe,a7 as It,a8 as Cn,a9 as zt,aa as ne,ab as Ot,ac as at,ad as bt,ae as ks,af as yt,ag as ie,ah as uo,ai as De,aj as Wt,ak as Fe,al as mt,am as gt,an as sn,ao as In,ap as Vt,aq as ws,ar as Ls,as as Cs,at as po,au as Is,av as fo,aw as On,ax as mo,ay as Os,az as At,aA as Ht,aB as Ns,aC as Ds,aD as Ms,aE as xs,aF as qs,aG as Sn,aH as $s,aI as Dl,aJ as Ee,aK as al,aL as cl,aM as As,aN as Bs,aO as Ps,aP as Vs,aQ as zs,aR as Fs,aS as Us,aT as Ml,aU as Hs,aV as Gs}from"./utils-D26aPeJo.js";import{r as he,o as Hn,d as P,c as L,a as E,b as u,e as g,f as Qe,n as m,u as Ie,s as pe,g as xe,h as k,w as ae,i as b,j as ee,k as W,T as go,l as Z,m as Bt,p as _n,q as ho,F as te,t as ce,v as J,x as en,y as xl,z as vo,A as bo,B as tn,C as Tl,D as Re,E as Le,G as Be,H as fe,I as Ws,J as yo,K as ul,L as Ne,M as Vn,N as Je,O as Xs,P as Ys,Q as js,R as Zs}from"./vue-G-bsKplX.js";const _o="@quickprint_drag_mode",Eo="@quickprint_drop_data",Gn="@quickprint_operate",et="@quickprint_element",Sl="@quickprint_element_type",To="@quickprint_resize_flag",Ye=160,Wn=32,rn=[50,75,100,125,150,200,300,400];var pn=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(pn||{}),Ft=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Ft||{});const ct={SINGLE:0,MULTIPLE:1},Ue=Object.freeze({INSERT:0,MOVE:1}),Rl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),Q=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),ve=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),So=[{label:"固定值",value:ye.CONST},{label:"变量",value:ye.VARIABLE},{label:"公式",value:ye.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:ye.CODE,detail:"使用Javascript代码生成数据"}],Ks=[{label:"显示",value:Mt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:Mt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:Mt.CONDITION,detail:"元素只在满足指定条件后显示"}],Js=[{label:"四舍五入",value:dn.ROUND},{label:"向下舍入",value:dn.FLOOR},{label:"向上舍入",value:dn.CEIL},{label:"四舍六入",value:dn.BANKER_ROUND}],Qs=[{label:"原始值",value:Ct.NONE},{label:"固定位数",value:Ct.FIXED},{label:"金额千位",value:Ct.THOUSAND},{label:"金额万位",value:Ct.TEN_THOUSAND},{label:"金额大写",value:Ct.DAXIE},{label:"百分比",value:Ct.PERCENTAGE}],ei=[{label:"显示",value:!0},{label:"隐藏",value:!1}],ti=[{label:"默认",value:void 0},{label:"文本",value:G.TEXT},{label:"数字",value:G.NUMBER},{label:"日期",value:G.DATE}],me={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Ro=[{label:"年-月",value:We.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:We.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:We.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:We.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:We.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:We.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:We.TIME,detail:"示例：12:00:00"},{label:"时:分",value:We.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:We.YEAR,detail:"示例：2024"},{label:"月",value:We.MONTH,detail:"示例：12"},{label:"日",value:We.DAY,detail:"示例：01"}];Ro.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const ni=[{label:"元素值",value:_l.ELEMENT_VALUR}],li=[{label:"基于纸张",value:mn.PAPER},{label:"基于内容",value:mn.CONTENT}],ko=[{label:"纵向",value:Nl.PORTRAIT},{label:"横向",value:Nl.LANDSCAPE}],oi=[{label:"当前位置",value:qn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:qn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],si=[{label:"单次打印",value:$n.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:$n.EACH,detail:"元素将每页打印一次"}],ii=[{label:"按内容调整高度",value:gn.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:gn.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:gn.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],ml=[{label:"页码",value:Tn.PAGE_NUMBER,type:re.NUMBER},{label:"总页数",value:Tn.PAGE_TOTAL,type:re.NUMBER},{label:"行序号",value:Tn.ROW_INDEX,type:re.NUMBER},{label:"当前时间",value:Tn.CURRENT_DATE,type:re.DATE}],ri=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"],ai=[{label:"原始尺寸",value:Ut.NATURAL,detail:"图片原始尺寸"},{label:"填充",value:Ut.FILL,detail:"不保持纵横比缩放图片，图片填满容器"},{label:"裁切",value:Ut.COVER,detail:"保持纵横比缩放图片，只保证图片的短边能完全显示出来，可能会裁切图片"},{label:"包含",value:Ut.CONTAIN,detail:"保持纵横比缩放图片，使图片的长边能完全显示出来，可保证图片完整显示"}],ci=[{label:"快速响应码",short:"QR Code",value:hn.QRCODE,detail:"最常见的二维码形式"},{label:"汉信码",short:"Han Xin Code",value:hn.HANXIN},{label:"数据矩阵码",short:"Data Matrix Code",value:hn.DATA_MATRIX}],ui=[{label:"EAN-8",value:Xe.EAN_8},{label:"EAN-13",value:Xe.EAN_13},{label:"UPC-A",value:Xe.UPC_A},{label:"UPC-E",value:Xe.UPC_E},{label:"CODE-39",value:Xe.CODE_39},{label:"CODE-128",value:Xe.CODE_128},{label:"ITF-14",value:Xe.ITF_14},{label:"GS1-128",value:Xe.GS1_128},{label:"Codabar",value:Xe.CODABAR,short:"库德巴码"},{label:"Interleaved 2 of 5",value:Xe.INTERLEAVED2OF5,short:"交叉25码"}],di=[{label:"显示",value:!0},{label:"隐藏",value:!1}];function wo(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function pi(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function Lo(n){return n.isSelected?n.type===G.PARAGRAPH?52:n.type===G.TABLE?32:20:20}function fi(){const n=he(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),Hn(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class mi{constructor(e,t,l){j(this,"originalEvent");j(this,"target");j(this,"ghost");j(this,"container");j(this,"paths",[]);j(this,"dropTarget");j(this,"top",0);j(this,"left",0);j(this,"deltaX");j(this,"deltaY");j(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var Zt,Kt,_t,Co,Io,Oo;const Dt=class Dt extends An{constructor(t={}){var l,o,s;super();ot(this,_t);j(this,"context",null);j(this,"selector");j(this,"scale");j(this,"onDragStart");ot(this,Zt);ot(this,Kt);this.selector={container:((l=t.selector)==null?void 0:l.container)??Q.PAGE,element:((o=t.selector)==null?void 0:o.element)??Q.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??Q.DROPPABLE},this.onDragStart=Ve(this,_t,Co).bind(this),this.scale=t.scale,Rt(this,Zt,Ve(this,_t,Io).bind(this)),Rt(this,Kt,Ve(this,_t,Oo).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",Pe(this,Zt)),window.removeEventListener("pointerup",Pe(this,Kt)),this.context=null)}};Zt=new WeakMap,Kt=new WeakMap,_t=new WeakSet,Co=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return He.warn(Dt.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=wo(l,o);this.context=new mi(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return He.warn(Dt.TAG_NAME,"已取消拖拽");if(this.context.container==null)return He.warn(Dt.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return He.warn(Dt.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",Pe(this,Zt)),window.addEventListener("pointerup",Pe(this,Kt))},Io=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(a=>!(a===l.ghost||a===l.target||l.ghost.contains(a))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(a=>a.matches("."+Q.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},Oo=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},j(Dt,"TAG_NAME","quickprint-draggable");let gl=Dt;const gi=["title"],hi=P({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(E(),L("span",{title:n.title,class:m(e.classes.help)},[u("span",null,[Qe(e.$slots,"default")]),g(H,{icon:"icon-question-circle"})],10,gi))}}),vi="_help_1l6l8_2",bi={help:vi},yi={classes:bi},_i=F(hi,[["__cssModules",yi]]),Ei=P({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=Ie("classes"),r=he(!1),i=pe(),a=pe(),c=xe({minWidth:0,top:0,left:0,visible:!1}),f=k(()=>({minWidth:l.width==null?c.minWidth+"px":l.width+"px",top:c.top+"px",left:c.left+"px",visibility:c.visible?"visible":"hidden",zIndex:lo()}));async function p(){if(r.value)return h();l.disabled||(r.value=!0,o("show"),await Un(),T())}function h(){N(),r.value=!1,o("close")}function y(A){if(!(A.target instanceof Node))return;const $=i.value;if($&&$.contains(A.target))return A.preventDefault();const I=a.value;if(I&&I.contains(A.target))return A.preventDefault();h()}function _(){const A=i.value,$=a.value;if($==null||A==null)return;const I=A.getBoundingClientRect(),w=$.getBoundingClientRect(),O=l.width==null?I.width:l.width;let B=I.bottom+1;B+w.height>window.innerHeight&&I.top>w.height&&(B=I.top-w.height-1);let M=I.left;M+w.width>window.innerWidth&&(M=window.innerWidth-w.width-2),c.minWidth=O,c.top=B,c.left=M,c.visible=!0}function d(A){const $=A.target;if(!($ instanceof HTMLElement))return;const I=i.value;I==null||!$.contains(I)||h()}function v(A){if(A.key!=="Escape")return;const $=a.value;if($!=null){const I=$.style.zIndex;if(Number(I)<vs())return}A.preventDefault(),h()}function T(){window.addEventListener("click",y,{capture:!0}),window.addEventListener("contextmenu",h,{capture:!0}),window.addEventListener("scroll",d,{capture:!0,passive:!0}),window.addEventListener("resize",_),window.addEventListener("keydown",v)}function N(){window.removeEventListener("click",y,!0),window.removeEventListener("contextmenu",h,!0),window.removeEventListener("scroll",d,!0),window.removeEventListener("resize",_),window.removeEventListener("keydown",v)}return e({close:h}),(A,$)=>(E(),L("div",{class:m(b(s).reference),onClick:ae(p,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[Qe(A.$slots,"default"),r.value?(E(),ee(go,{key:0,to:"body"},[u("div",{class:m(b(s).popover),onVnodeMounted:_,onMousedown:$[0]||($[0]=ae(()=>{},["prevent"])),style:Z(f.value),ref_key:"popoverRef",ref:a},[Qe(A.$slots,"popover")],38)])):W("",!0)],2))}}),Ti="_reference_1arli_2",Si="_popover_1arli_7",Ri={reference:Ti,popover:Si},ki={classes:Ri},No=F(Ei,[["__cssModules",ki]]),wi=["title","onKeydown"],Li=["onMouseover","onClick"],Ci=P({__name:"Select",props:Bt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:Bt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=Ie("classes"),s=pe(),r=pe(),i=_n(n,"modelValue"),a=he(),c=he(!1),f=xe({width:0,top:0,left:0,visible:!1,scrollable:!1}),p=k(()=>l.teleport==="none"),h=k(()=>l.teleport=="none"?"body":l.teleport),y=k(()=>{const U={label:"",options:[]},X=[U];for(const K of l.options){if(Array.isArray(K.options)){X.push({label:K.label,options:K.options});continue}U.options.push(K)}return X}),_=k(()=>y.value.reduce((U,X)=>U.concat(X.options),[])),d=k(()=>{if(l.multiple!==!0){const X=sl();return X?X.label:l.button?l.title:de(l.modelValue)?l.placeholder:l.modelValue}const U=il();return U.length>0?U.map(X=>X.label).join(","):l.button?l.title:l.placeholder}),v=k(()=>l.clearable!==!0?!1:l.modelValue!=null),T=k(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!v.value,[o.button]:l.button,[o.showClearIcon]:v.value,[o.text]:l.size==="text"})),N=k(()=>({width:l.width})),A=k(()=>f.visible?{width:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",top:f.top+"px",left:f.left+"px",visibility:"visible",zIndex:lo()}:{minWidth:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",visibility:"hidden"}),$=k(()=>({[o.content]:!0,[o.placeholder]:oo(l.modelValue)}));async function I(){if(l.disabled)return;const U=_.value;if(U.length===0)return;if(c.value)return w();const X=s.value;X!=null&&(f.width=X.getBoundingClientRect().width,f.visible=!1,a.value=U.find(K=>K.value===l.modelValue),c.value=!0,await Un(),fs())}function w(){ms(),c.value=!1}function O(U){q(),St()}function B(U){U.disabled!==!0&&(a.value=U)}function M(U){if(l.disabled==!0||U.disabled===!0)return;if(l.multiple!==!0){i.value=U.value,t("select",U),w();return}const X=Array.isArray(i.value)?i.value:[],K=X.findIndex(_e=>_e===U.value);K>=0?X.splice(K,1):X.push(U.value),i.value=X,t("select",X)}function D(U){if(!(U.target instanceof Node))return;const X=s.value;if(X&&X.contains(U.target))return U.preventDefault();const K=r.value;if(K&&K.contains(U.target))return U.preventDefault();w()}async function q(){const U=s.value,X=r.value;if(X==null||U==null)return;await en();const K=U.getBoundingClientRect(),_e=X.getBoundingClientRect();let Se=K.bottom+1;Se+_e.height>window.innerHeight&&K.top>_e.height&&(Se=K.top-_e.height-1);let Pt=K.left;Pt+_e.width>window.innerWidth&&(Pt=window.innerWidth-_e.width-2),f.width=_e.width,f.top=Se,f.left=Pt,f.visible=!0;const on=X.querySelector("."+o.list);f.scrollable=on?on.scrollHeight>on.clientHeight:!1}function x(U){const X=U.target;if(!(X instanceof HTMLElement))return;const K=s.value;K==null||!X.contains(K)||w()}function S(){const U=_.value,X=xl(a.value);if(X==null){a.value=qe(0),St();return}const K=U.indexOf(X);if(K==0)return z();const _e=qe(K-1);_e!=null&&(a.value=_e,St())}function R(){const U=_.value,X=xl(a.value);if(X==null){a.value=oe(0),St();return}const K=U.indexOf(X);if(K>=U.length-1){C();return}const _e=qe(K+1);_e!=null&&(a.value=_e,St())}function C(){a.value=oe(0),St()}function z(){const U=_.value;a.value=qe(U.length-1),St()}function V(){i.value=void 0,w()}function oe(U){const K=_.value[U];return K==null?null:K.disabled===!0?oe(U+1):K}function qe(U){const K=_.value[U];return K==null?null:K.disabled===!0?qe(U-1):K}function $e(U){switch(U.key){case"Enter":U.preventDefault(),a.value&&M(a.value);return;case"Escape":U.preventDefault(),w();return;case"ArrowUp":U.preventDefault(),S();return;case"ArrowDown":U.preventDefault(),R();return;case"Home":U.preventDefault(),C();return;case"End":U.preventDefault(),z();return}}function lt(U){if(l.disabled)return;const X=s.value;X!=null&&document.activeElement===X&&(c.value||(U.stopPropagation(),I()))}function ps(U){if(l.multiple!==!0)return l.modelValue===U.value;const X=l.modelValue;return Array.isArray(X)?X.includes(U.value):!1}async function St(){if(a.value==null)return;await en();const U=r.value;if(U==null)return;const X=U.querySelector("."+o.hover);X&&X.scrollIntoView({block:"nearest"})}function sl(){const U=_.value,X=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return U.find(K=>K.value===X)}function il(){const U=_.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(K=>K).map(K=>{const _e=U.find(Se=>Se.value===K);return _e||{value:K,label:K}})}function fs(){window.addEventListener("mousedown",D,{capture:!0}),window.addEventListener("pointerdown",D,{capture:!0}),window.addEventListener("contextmenu",w,{capture:!0}),window.addEventListener("scroll",x,{capture:!0,passive:!0}),window.addEventListener("resize",q),window.addEventListener("keydown",$e)}function ms(){window.removeEventListener("mousedown",D,!0),window.removeEventListener("pointerdown",D,!0),window.removeEventListener("contextmenu",w,!0),window.removeEventListener("scroll",x,!0),window.removeEventListener("resize",q),window.removeEventListener("keydown",$e)}return(U,X)=>{var K;return E(),L("div",{class:m(T.value),title:n.title,style:Z(N.value),onClick:ae(I,["stop"]),onKeydown:ho(ae(lt,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[U.$slots.selected?Qe(U.$slots,"selected",{key:0,option:sl(),options:il()}):Qe(U.$slots,"option",{key:1,option:sl(),options:il()},()=>[u("div",{class:m($.value)},[u("span",null,J(d.value),1),v.value?(E(),ee(H,{key:0,icon:"icon-close",onClick:ae(V,["stop"]),size:"12px",class:m(b(o).clearIcon)},null,8,["class"])):W("",!0)],2)]),c.value?(E(),ee(go,{key:2,to:h.value,disabled:p.value},[u("div",{class:m(b(o).popover),onClick:X[0]||(X[0]=ae(()=>{},["stop"])),onVnodeMounted:O,onMousedown:X[1]||(X[1]=ae(()=>{},["prevent"])),style:Z(A.value),ref_key:"popoverRef",ref:r},[u("div",{class:m(b(o).list)},[(E(!0),L(te,null,ce(y.value,_e=>(E(),L(te,null,[_e.label?(E(),L("div",{key:0,class:m(b(o).groupLabel)},J(_e.label),3)):W("",!0),(E(!0),L(te,null,ce(_e.options,Se=>{var Pt;return E(),L("div",{key:Se.value,class:m({[b(o).option]:!0,[b(o).disabled]:Se.disabled===!0,[b(o).selected]:ps(Se),[b(o).hover]:((Pt=a.value)==null?void 0:Pt.value)==Se.value}),style:Z(Se.style),onMouseover:on=>B(Se),onClick:on=>M(Se)},[Qe(U.$slots,"option",{option:Se},()=>[u("div",{class:m(b(o).label)},[Se.icon?(E(),ee(H,{key:0,icon:Se.icon,class:m(b(o).icon)},null,8,["icon","class"])):W("",!0),u("span",null,J(Se.label),1)],2),Se.short?(E(),L("div",{key:0,class:m(b(o).short)},J(Se.short),3)):W("",!0)])],46,Li)}),128))],64))),256))],2),(K=a.value)!=null&&K.detail&&f.visible?(E(),L("div",{key:0,class:m(b(o).detail)},J(a.value.detail),3)):W("",!0)],38)],8,["to","disabled"])):W("",!0)],46,wi)}}}),Ii="_button_g23yb_2",Oi="_select_g23yb_7",Ni="_appearance_g23yb_16",Di="_content_g23yb_31",Mi="_placeholder_g23yb_37",xi="_popover_g23yb_41",qi="_list_g23yb_51",$i="_option_g23yb_80",Ai="_label_g23yb_95",Bi="_icon_g23yb_102",Pi="_hover_g23yb_106",Vi="_detail_g23yb_117",zi="_short_g23yb_127",Fi="_selected_g23yb_133",Ui="_disabled_g23yb_137",Hi="_showClearIcon_g23yb_142",Gi="_clearIcon_g23yb_146",Wi="_text_g23yb_159",Xi="_mini_g23yb_171",Yi="_groupLabel_g23yb_183",ji={button:Ii,select:Oi,appearance:Ni,content:Di,placeholder:Mi,popover:xi,list:qi,option:$i,label:Ai,icon:Bi,hover:Pi,detail:Vi,short:zi,selected:Fi,disabled:Ui,showClearIcon:Hi,clearIcon:Gi,text:Wi,mini:Xi,groupLabel:Yi},Zi={classes:ji},le=F(Ci,[["__cssModules",Zi]]),Ki="_tree_1p28f_1",Ji="_node_1p28f_5",Qi="_content_1p28f_11",er="_space_1p28f_27",tr="_expand_1p28f_28",nr="_active_1p28f_47",lr="_children_1p28f_55",pt={tree:Ki,node:Ji,content:Qi,space:er,expand:tr,active:nr,children:lr},Do=Symbol(),Mo=P({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=vo(Do),l=k(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=k({get(){const d=t==null?void 0:t.state[n.node.value];return d==null?!1:d.expand},set(d){const v=t==null?void 0:t.state[n.node.value];v!=null&&(v.expand=d)}});function s(d){d.preventDefault(),o.value=!o.value}function r(){if(!l.value)return g("div",{class:pt.space},null);const d={[pt.expand]:!0,[pt.active]:o.value};return g("div",{onMousedown:_,onClick:s,class:d},[g(H,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):g("span",null,[n.node.label])}function a(){return g("div",{class:pt.content,onClick:f,onMouseenter:h},[i()])}function c(){if(!l.value||!o.value)return;const d=n.node.children.map(v=>g(Mo,{node:v,onNodeClick:p,onNodeHover:y},null));return g("div",{class:pt.children},[d])}function f(){e("nodeClick",n.node)}function p(d){e("nodeClick",d)}function h(){e("nodeHover",n.node)}function y(d){e("nodeHover",d)}function _(d){d.preventDefault()}return function(){return g("div",{class:pt.subTree},[g("div",{class:pt.node},[r(),a()]),c()])}}}),or=P({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(a){t("nodeClick",a)}function s(a){t("nodeHover",a)}function r(){const a=xe({}),c=function(f,p){for(const h of f)p[h.value]={expand:h.expand!==!1},h.children&&c(h.children,p)};return c(n.data,a),a}function i(a){return typeof e.default=="function"?e.default(a):null}return bo(Do,{state:l,content:i}),function(){const a=n.data.map(c=>g(Mo,{node:c,onNodeClick:o,onNodeHover:s},null));return g("div",{class:pt.tree},[a])}}});function Rn(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const dl={A:10,B:11,C:12,D:13,E:14,F:15},ql={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function sr(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function ir(n){return typeof n=="string"&&n.includes("%")}function Xt(n,e){sr(n)&&(n="100%");const t=ir(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function kt(n){return n.length===2?(dl[n[0].toUpperCase()]||+n[0])*16+(dl[n[1].toUpperCase()]||+n[1]):dl[n[1].toUpperCase()]||+n[1]}function $l(n,e,t){n=Xt(n,255),e=Xt(e,255),t=Xt(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,a=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:a*100,v:r*100}}const rr=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},ar=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function pl(n,e,t){n=Xt(n,360)*6,e=Xt(e,100),t=Xt(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),a=l%6,c=[t,r,s,s,i,t][a],f=[i,t,t,r,s,s][a],p=[s,s,i,t,t,r][a];return{r:Math.round(c*255),g:Math.round(f*255),b:Math.round(p*255)}}function Nn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${ql[e]||e}${ql[t]||t}`}function cr({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${Nn(n)}${Nn(e)}${Nn(t)}`}class Xn{constructor(e){j(this,"h",0);j(this,"s",100);j(this,"v",100);j(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=Rn(e)}setSaturation(e){this.s=Rn(e)}setValue(e){this.v=Rn(e)}setAlpha(e){this.a=Rn(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=kt(t[0]+t[0]),o=kt(t[1]+t[1]),s=kt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=kt(t.slice(0,2)),o=kt(t.slice(2,4)),s=kt(t.slice(4,6))),t.length===8&&(r=kt(t.slice(6))/255*100);const{h:i,s:a,v:c}=$l(l,o,s);return{h:i,s:a,v:c,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=$l(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=rr(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=ar(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${cr(pl(this.h,this.s,this.v))}${Nn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=pl(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return pl(this.h,this.s,this.v)}}function xo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),c=e.target.getBoundingClientRect().width/2;let f=r.clientX-i.left-e.offsetX;return f<-c&&(f=-c),f>i.width-c&&(f=i.width-c),f}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,a=r.currentTarget;origin==null||i==null||(e.container=a,e.target=i===a?i.firstElementChild:i,e.offsetX=i===a?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function ur(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().width/2;let p=i.clientX-a.left-e.offsetX;return p<-f&&(p=-f),p>a.width-f&&(p=a.width-f),p}function l(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().height/2;let p=i.clientY-a.top-e.offsetY;return p<-f&&(p=-f),p>a.height-f&&(p=a.height-f),p}function o(i){i.stopPropagation(),i.preventDefault();const a=i.target,c=i.currentTarget;origin==null||a==null||(e.container=c,e.target=a===c?a.firstElementChild:a,e.offsetX=a===c?e.target.offsetWidth/2:i.clientX-a.getBoundingClientRect().left,e.offsetY=a===c?e.target.offsetHeight/2:i.clientY-a.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const a=t(i),c=l(i);e.target.style.left=a+"px",e.target.style.top=c+"px",n("move",{left:a,top:c})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const a=t(i),c=l(i);n("end",{top:c,left:a})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const dr=P({__name:"SvPanel",props:{modelValue:{type:Xn,required:!0}},setup(n){const e=n,t=pe(),l=pe(),o=xe(i()),s=k(()=>({left:o.left+"px",top:o.top+"px"})),r=ur((a,c)=>{a=="end"&&(o.top=c.top,o.left=c.left);const f=t.value,p=l.value,h=(c.left+p.offsetWidth/2)/f.offsetWidth*100,y=100-(c.top+p.offsetHeight)/f.offsetHeight*100;e.modelValue.setSaturation(h),e.modelValue.setValue(y)});function i(){const a=t.value,c=l.value;if(a==null||c==null)return{top:-6,left:-6};const f=e.modelValue.s,h=(100-e.modelValue.v)/100*a.offsetHeight,y=f/100*a.offsetWidth;return{top:h-c.offsetHeight/2,left:y-c.offsetWidth/2}}return tn(()=>{const a=i();o.top=a.top,o.left=a.left}),(a,c)=>(E(),L("div",{class:m(a.classes.svPanel),onPointerdown:c[0]||(c[0]=(...f)=>b(r)&&b(r)(...f)),ref_key:"svPanelRef",ref:t},[u("div",{class:m(a.classes.thumb),style:Z(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),pr="_svPanel_1sv6o_2",fr="_thumb_1sv6o_10",mr={svPanel:pr,thumb:fr},gr={classes:mr},hr=F(dr,[["__cssModules",gr]]),vr=P({__name:"HueSlider",props:{modelValue:{type:Xn,required:!0}},setup(n){const e=n,t=he(-6),l=pe(),o=pe(),s=xo((i,a)=>{i=="end"&&(t.value=a);const c=l.value,f=o.value,p=Math.round((a+f.offsetWidth/2)/c.offsetWidth*360);e.modelValue.setHue(p)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const c=e.modelValue.h;return Math.round(c/360*i.offsetWidth)-a.offsetWidth/2}return tn(()=>{t.value=r()}),(i,a)=>(E(),L("div",{class:m(i.classes.hue),onPointerdown:a[0]||(a[0]=(...c)=>b(s)&&b(s)(...c)),ref_key:"hueRef",ref:l},[u("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),br="_hue_1ozoc_2",yr="_thumb_1ozoc_10",_r={hue:br,thumb:yr},Er={classes:_r},Tr=F(vr,[["__cssModules",Er]]),Sr=P({__name:"AlphaSlider",props:{modelValue:{type:Xn,required:!0}},setup(n){const e=n,t=he(-6),l=pe(),o=pe(),s=xo((i,a)=>{i=="end"&&(t.value=a);const c=l.value,f=o.value,p=Math.round((a+f.offsetWidth/2)/c.offsetWidth*100);e.modelValue.setAlpha(p)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const c=e.modelValue.a;return Math.round(c/100*i.offsetWidth)-a.offsetWidth/2}return tn(()=>{t.value=r()}),(i,a)=>(E(),L("div",{class:m(i.classes.alpha),onPointerdown:a[0]||(a[0]=(...c)=>b(s)&&b(s)(...c)),ref_key:"alphaRef",ref:l},[u("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Rr="_alpha_1x8jd_2",kr="_thumb_1x8jd_26",wr={alpha:Rr,thumb:kr},Lr={classes:wr},Cr=F(Sr,[["__cssModules",Lr]]),Ir=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function Or(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function Nr(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const Al={isSupport:Or,open:Nr},Dr=["title","onClick"],Mr=["title","onClick"],Bl="quickprint-recent-use-colors",xr=P({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=he(new Xn(l.modelValue)),r=pe(),i=pe(),a=he(N()),c=Al.isSupport(),f=he("hex"),p=k(()=>{const I=l.modelValue;return I?{backgroundColor:I}:null}),h=k(()=>{const I=s.value,{r:w,g:O,b:B}=I.rgb();return{"--hue-channel-color":`hsl(${I.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${w}, ${O}, ${B}, 0)`,"--alpha-channel-color-b":`rgba(${w}, ${O}, ${B}, 1)`}}),y=k({get(){return s.value.toString(f.value)},set(I){s.value.setColor(I)}});function _(){var I;(I=r.value)==null||I.close()}function d(I){I!=null&&(t("update:modelValue",I),t("select",I),A(I),_())}function v(){t("update:modelValue",void 0),t("select",void 0),_()}function T(){Al.open().then(I=>d(I))}function N(){const I=localStorage.getItem(Bl);if(I==null||I=="")return[];const w=Bn(I);return w==null?[]:Array.isArray(w)?w:[]}function A(I){const w=a.value,O=w.indexOf(I);O>=0&&w.splice(O,1),w.length>10&&w.pop(),w.unshift(I),localStorage.setItem(Bl,JSON.stringify(w))}function $(){t("update:modelValue",s.value.toString(f.value)),t("select",s.value.toString(f.value)),_()}return Tl(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(I,w)=>(E(),ee(No,{class:m(I.classes.colorPicker),onMousedown:w[7]||(w[7]=ae(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:Re(()=>[u("div",{class:m(I.classes.colorPickerPanel)},[u("div",{class:m(I.classes.presetPanel)},[u("div",{class:m(I.classes.presetTools)},[u("button",{type:"button",class:m(I.classes.clearBtn),onClick:v},[u("span",{class:m(I.classes.none)},null,2),w[8]||(w[8]=u("span",null,"无颜色",-1))],2),b(c)?(E(),L("button",{key:0,type:"button",class:m(I.classes.indicator),onClick:T},[g(H,{icon:"icon-eye-dropper"}),w[9]||(w[9]=u("span",null,"拾色器",-1))],2)):W("",!0)],2),u("div",{class:m(I.classes.colourAtla)},[(E(!0),L(te,null,ce(b(Ir),O=>(E(),L("div",{style:Z({backgroundColor:O}),title:O,class:m(I.classes.color),onClick:B=>d(O)},null,14,Dr))),256))],2),u("div",{class:m(I.classes.recentColors)},"最近使用",2),u("div",{class:m(I.classes.colourAtla)},[(E(),L(te,null,ce(10,O=>u("div",{key:O,title:a.value[O-1],style:Z({backgroundColor:a.value[O-1]}),class:m(I.classes.color),onClick:B=>d(a.value[O-1])},null,14,Mr)),64))],2)],2),u("div",{class:m(I.pacls.panel),style:Z(h.value)},[g(hr,{class:m(I.pacls.sv),modelValue:s.value,"onUpdate:modelValue":w[1]||(w[1]=O=>s.value=O)},null,8,["class","modelValue"]),u("div",{class:m(I.pacls.sliders)},[g(Tr,{class:m(I.pacls.hua),modelValue:s.value,"onUpdate:modelValue":w[2]||(w[2]=O=>s.value=O)},null,8,["class","modelValue"]),g(Cr,{modelValue:s.value,"onUpdate:modelValue":w[3]||(w[3]=O=>s.value=O)},null,8,["modelValue"]),u("div",{class:m(I.pacls.preview)},[u("div",{class:m(I.pacls.previewColor),style:Z({backgroundColor:s.value.toRGB()})},null,6)],2)],2),u("div",{class:m(I.pacls.tools)},[g(le,{options:o,teleport:"none",modelValue:f.value,"onUpdate:modelValue":w[4]||(w[4]=O=>f.value=O),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Le(u("input",{type:"text","onUpdate:modelValue":w[5]||(w[5]=O=>y.value=O),onMousedown:w[6]||(w[6]=ae(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Be,y.value]]),u("button",{type:"button",class:m(I.pacls.confirm),onClick:$},"确定",2)],2)],6)],2)]),default:Re(()=>[u("div",{class:m({[I.classes.colorPickerInput]:!0,[I.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[Qe(I.$slots,"default",{},()=>[u("span",{class:m(I.classes.colorBlock),style:Z(p.value)},null,6)]),n.showText?(E(),L("div",{key:0,class:m(I.classes.colorValue),onClick:w[0]||(w[0]=ae(()=>{},["stop"]))},J(n.modelValue),3)):W("",!0)],2)]),_:3},8,["class","disabled"]))}}),qr="_colorPicker_1egpm_2",$r="_disabled_1egpm_6",Ar="_colorPickerInput_1egpm_10",Br="_colorBlock_1egpm_17",Pr="_colorValue_1egpm_26",Vr="_colorPickerPanel_1egpm_31",zr="_presetPanel_1egpm_45",Fr="_colourAtla_1egpm_49",Ur="_color_1egpm_2",Hr="_presetTools_1egpm_76",Gr="_clearBtn_1egpm_82",Wr="_indicator_1egpm_83",Xr="_none_1egpm_101",Yr="_recentColors_1egpm_132",jr={colorPicker:qr,disabled:$r,colorPickerInput:Ar,colorBlock:Br,colorValue:Pr,colorPickerPanel:Vr,presetPanel:zr,colourAtla:Fr,color:Ur,presetTools:Hr,clearBtn:Gr,indicator:Wr,none:Xr,recentColors:Yr},Zr="_panel_911zv_2",Kr="_sv_911zv_7",Jr="_hua_911zv_11",Qr="_sliders_911zv_15",ea="_tools_911zv_20",ta="_confirm_911zv_37 quickprint-text-btn",na="_preview_911zv_44",la="_previewColor_911zv_59",oa={panel:Zr,sv:Kr,hua:Jr,sliders:Qr,tools:ea,confirm:ta,preview:na,previewColor:la},sa={classes:jr,pacls:oa},Yt=F(xr,[["__cssModules",sa]]),ia=P({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=k({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=k(()=>{const i=l.modelValue;return oo(i)||i===ze.INHERIT});function r(i){t("select",i)}return(i,a)=>(E(),ee(Yt,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=c=>o.value=c),disabled:n.disabled,onSelect:r},{default:Re(()=>[u("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[u("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:Z({backgroundColor:o.value})},null,6),u("div",{class:m(i.classes.colorValue)},J(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),ra="_indicator_14ypk_2",aa="_disabled_14ypk_8",ca="_colorBlock_14ypk_27",ua="_colorValue_14ypk_38",da="_colorNone_14ypk_45",pa={indicator:ra,disabled:aa,colorBlock:ca,colorValue:ua,colorNone:da},fa={classes:pa},jt=F(ia,[["__cssModules",fa]]);function En(n,e={}){const t={},l=n.style??{},o=El(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=so(l);return s&&Object.assign(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.writingMode&&(t.writingMode=l.writingMode),fl("border",e)&&Object.assign(t,qt(n)),Object.assign(t,bs(n)),fl("align",e)&&Object.assign(t,ys(n)),fl("padding",e)&&Object.assign(t,_s(n)),t}function kl(n,e={}){const t=[];let l=n;for(;ue.isDefineElement(l);)t.unshift(En(l,e)),l=l.parent;return Object.assign({},...t)}function fl(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const Nt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(Nt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(Nt.SPACE).filter(o=>ht(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(Nt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(Nt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(Nt.SPACE))}};function wt(n){switch(n){case"top":case 0:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case"right":case 1:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case"bottom":case 2:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case"left":case 3:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function Yn(n){var t;const e=n.ds;if(e!=null)return e.type===ye.FORMULA?{type:e.type,content:wl(e.value,n.doc)}:e.type===ye.VARIABLE?{type:e.type,content:dt(e.value,(t=n.doc)==null?void 0:t.ds)}:e.type===ye.CODE?{type:e.type,content:"自定义"}:{type:e.type,content:e.value}}function dt(n,e){var h,y,_;if(de(n))return n;const t=io(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===$t.BUILTIN)return((h=ml.find(d=>d.value===s))==null?void 0:h.label)??s;if(t.varType===$t.SPECIAL)return((y=ni.find(d=>d.value===s))==null?void 0:y.label)??s;if(e==null)return l;const i=(e.fields??[]).find(d=>d.name===s);if(i==null)return l;const a=o[1],c=de(i.title)?i.name:i.title;if(a==null)return c;const f=(_=i.children)==null?void 0:_.find(d=>d.name===a);if(f==null)return`${c}.${a}`;const p=de(f.title)?f.name:f.title;return`${c}.${p}`}function wl(n,e){return de(n)?void 0:Pn.tokenize(n).map(o=>o.type===vt.VARIABLE?`[${dt(o.value,e==null?void 0:e.ds)}]`:o.type===vt.REFERENCE?`[${qo(o.value,e)}]`:o.type===vt.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===vt.VARIABLE?`[${dt(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):Pn.formatTokenValue(o)).join("")}function qo(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===ye.VARIABLE&&t.ds.value?dt(t.ds.value,e.ds):"="+n}function ma(n){switch(io(n).dataType){case re.OBJECT:return"对象";case re.ARRAY:return"数组";case re.STRING:return"文本";case re.NUMBER:return"数字";case re.DATE:return"日期";case re.BOOLEAN:return"布尔";default:return"未知类型"}}function ga(n){var e;return((e=So.find(t=>t.value===n))==null?void 0:e.label)??n}const $o=ro(()=>ao(()=>import("./component-YZCGC2CV.js"),__vite__mapDeps([0,1]))),ha=["onClick","onMouseenter"],va=P({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=he(ml[0].value),o=k(()=>`builtin_${co(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,a)=>(E(),L("div",{class:m(i.classes.builtin)},[u("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(E(!0),L(te,null,ce(b(ml),c=>(E(),L("div",{class:m({[i.classes.param]:!0,[i.classes.active]:c.value===l.value}),onClick:f=>s(c),onMouseenter:f=>r(c)},[u("strong",null,J(c.label),1),u("span",null,J(c.value),1)],42,ha))),256))],2),u("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[g(b($o),{name:o.value},null,8,["name"])],2)],2))}}),ba="_builtin_m1n0z_2",ya="_panel_m1n0z_11",_a="_desc_m1n0z_17",Ea="_param_m1n0z_24",Ta="_active_m1n0z_34",Sa={builtin:ba,panel:ya,desc:_a,param:Ea,active:Ta},Ra={classes:Sa},ka=F(va,[["__cssModules",Ra]]),Pl=[{label:"文本",value:re.STRING},{label:"数字",value:re.NUMBER},{label:"日期",value:re.DATE},{label:"对象",value:re.OBJECT},{label:"数组",value:re.ARRAY}],wa=P({emit:["select"],props:{doc:{type:Te,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Ie("classes"),o=tt(),s=a(),r=i();function i(){const v=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(T,N,A){var $;if(n.readonly){const I=T[N.name],w=(($=Pl.find(O=>O.value===I))==null?void 0:$.label)??I;return g("div",{class:A.classes.cell},[w])}return g("div",{class:A.classes.cell},[g(le,{options:Pl,modelValue:T.type,"onUpdate:modelValue":y.bind(null,T),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(T,N,A){return n.readonly?g("div",{class:A.classes.cell},[T[N.name]]):g("div",{class:A.classes.cell},[Le(g("input",{"onUpdate:modelValue":$=>T.name=$,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Be,T.name]])])}},{name:"title",title:"标题",width:180,render(T,N,A){return n.readonly?g("div",{class:A.classes.cell},[T[N.name]]):g("div",{class:A.classes.cell},[Le(g("input",{"onUpdate:modelValue":$=>T.title=$,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Be,T.title]])])}}];return n.readonly!==!0&&v.push({name:"operate",title:"操作",width:200,render(T,N,A){const $=[g("button",{type:"button",class:"quickprint-text-btn",onClick:f.bind(null,T,A.parent)},[g(H,{icon:"icon-subnode"},null),g("span",null,[fe("插入行")])])];return(T.type===re.ARRAY||T.type===re.OBJECT)&&$.push(g("button",{type:"button",class:"quickprint-text-btn",onClick:h.bind(null,T)},[g(H,{icon:"icon-sisternode"},null),g("span",null,[fe("插入子级")])])),$.push(g("button",{type:"button",class:"quickprint-text-btn",onClick:p.bind(null,T,A.parent)},[g(H,{icon:"icon-delete"},null),g("span",null,[fe("删除")])])),$}}),v}function a(){const v=vn(n.doc.ds.fields??[]).map(N=>{const A=N.type;return{...N,$expand:A===re.ARRAY||A===re.OBJECT}}),T=he(v);return T.value.length==0&&T.value.push(c()),T}function c(){return{type:re.STRING,name:"",title:""}}function f(v,T){if(T){const A=T.children??[],$=A.indexOf(v);$>=0&&A.splice($+1,0,c());return}const N=s.value.indexOf(v);N>=0&&s.value.splice(N+1,0,c())}function p(v,T){if(T){const A=T.children??[],$=A.indexOf(v);$>=0&&A.splice($,1);return}const N=s.value.indexOf(v);N>=0&&s.value.splice(N,1),s.value.length==0&&s.value.push(c())}function h(v){v.type!==re.ARRAY&&v.type!==re.OBJECT||(v.children==null&&(v.children=[]),v.children.push(c()))}function y(v,T){v.type=T,T===re.ARRAY||T===re.OBJECT?v.$expand=!0:v.children=void 0}function _(){return{fields:s.value.map(T=>de(T.name)?null:T.type!==re.ARRAY&&T.type!==re.OBJECT?{type:T.type,name:T.name,title:T.title}:{type:T.type,name:T.name,title:T.title,children:(T.children??[]).map(N=>de(T.name)?null:{type:N.type,name:N.name,title:N.title}).filter(N=>N!=null)}).filter(T=>T!=null)}}function d(v,T){n.readonly===!0&&t("select",v,T)}return o==null||o.useHandle("confirm",_),e({submit:_}),function(){return g("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[g(Es,{columns:r,data:s.value,onSelect:d},null)])}}}),La="_form_6lybl_2",Ca="_readonly_6lybl_6",Ia="_datasource_6lybl_11",Oa={form:La,readonly:Ca,datasource:Ia},Na={classes:Oa},Ao=F(wa,[["__cssModules",Na]]),Da={class:"quickprint-config-group"},Ma={class:"quickprint-config-section quickprint-config-inline"},xa={class:"quickprint-config-content"},qa={class:"quickprint-config-section quickprint-config-inline"},$a={class:"quickprint-config-content"},Aa={class:"quickprint-config-id"},Ba={class:"quickprint-config-section quickprint-config-inline"},Pa={class:"quickprint-config-content"},Va={class:"quickprint-config-group"},za={class:"quickprint-config-group-title"},Fa=P({__name:"Detail",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k(()=>{var l;return(l=Yn(e.element))==null?void 0:l.content});return(l,o)=>(E(),L("div",{class:m(l.classes.detail)},[u("div",Da,[u("section",Ma,[o[0]||(o[0]=u("header",{class:"quickprint-config-header"},"类型",-1)),u("div",xa,J(b(yn)(n.element.type)),1)]),u("section",qa,[o[1]||(o[1]=u("header",{class:"quickprint-config-header"},"标识",-1)),u("div",$a,[u("span",Aa,J(n.element.id),1)])]),u("section",Ba,[o[2]||(o[2]=u("header",{class:"quickprint-config-header"},"标题",-1)),u("div",Pa,J(n.element.title),1)])]),u("div",Va,[u("div",za,[o[3]||(o[3]=u("span",null,"数据",-1)),u("span",{class:m(l.classes.type)},J(b(ga)(n.element.ds.type)),3)]),u("div",null,J(t.value),1)])],2))}}),Ua="_detail_11ox4_2",Ha="_type_11ox4_10",Ga={detail:Ua,type:Ha},Wa={classes:Ga},Xa=F(Fa,[["__cssModules",Wa]]),Ya=P({__name:"index",props:{doc:{type:Te,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=he();function r(h){return h.reduce((y,_)=>{const d=Array.isArray(_.children)?r(_.children):[];if(ht(_.ds.value)||d.length>0){const v={value:_.id,label:_.title??_.id,data:_,children:d};return y.push(v),y}return y},[])}function i(){const h=l.doc.pages.reduce((_,d)=>_.concat(d.children),[]),y=r(h);return he(y)}function a(h){s.value=h}function c(h){return h.title?h.title:yn(h.type)}function f(h){return vg(h.type)??"icon-zhanweifu"}function p(h){t("select",h.data)}return(h,y)=>(E(),L("div",{class:m(h.classes.reference)},[u("div",{class:m([h.classes.panel,"quickprint-is-scrollable"])},[g(b(or),{data:b(o),onNodeHover:a,onNodeClick:p},{default:Re(({node:_})=>[g(b(H),{icon:f(_.data)},null,8,["icon"]),u("span",{class:m(h.classes.title)},J(c(_.data)),3),u("span",{class:m(h.classes.id)},"<"+J(_.value)+">",3)]),_:1},8,["data"])],2),u("div",{class:m([h.classes.detail,"quickprint-is-scrollable"])},[s.value?(E(),ee(Xa,{element:s.value.data,key:s.value.value},null,8,["element"])):W("",!0)],2)],2))}}),ja="_reference_1ekkx_2",Za="_panel_1ekkx_12",Ka="_detail_1ekkx_20",Ja="_title_1ekkx_25",Qa="_id_1ekkx_29",ec={reference:ja,panel:Za,detail:Ka,title:Ja,id:Qa},tc={classes:ec},nc=F(Ya,[["__cssModules",tc]]),lc=P({__name:"index",props:{doc:{type:Te,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=tt();function t(r,i){return r==null?null:i==null?`${$t.DS}.${r.type}.${r.name}`:`${$t.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${$t.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(E(),L("div",{class:m(r.classes.var)},[n.active==="ds"?(E(),ee(Ao,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):W("",!0),n.active==="builtin"?(E(),ee(ka,{key:1,onSelect:o})):W("",!0),n.active==="reference"?(E(),ee(nc,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):W("",!0)],2))}}),oc={var:"_var_12wxd_2"},sc={classes:oc},Bo=F(lc,[["__cssModules",sc]]),ic=["onClick","onMouseenter"],rc=P({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var a;const t=n,l=e,o=he((a=t.options[0])==null?void 0:a.value),s=k(()=>`${t.type}_${o.value.toLowerCase()}`);function r(c){l("select",c.value)}function i(c){o.value=c.value}return(c,f)=>(E(),L("div",{class:m(c.classes.doc)},[u("div",{class:m(["quickprint-is-scrollable",c.classes.panel])},[(E(!0),L(te,null,ce(n.options,p=>(E(),L("div",{key:p.value,class:m({[c.classes.option]:!0,[c.classes.active]:p.value===o.value}),onClick:h=>r(p),onMouseenter:h=>i(p)},[u("strong",null,J(p.label),1)],42,ic))),128))],2),u("div",{class:m(["quickprint-is-scrollable",c.classes.desc])},[g(b($o),{name:s.value},null,8,["name"])],2)],2))}}),ac="_doc_1pdoc_2",cc="_panel_1pdoc_10",uc="_desc_1pdoc_16",dc="_option_1pdoc_23",pc="_active_1pdoc_33",fc={doc:ac,panel:cc,desc:uc,option:dc,active:pc},mc={classes:fc},an=F(rc,[["__cssModules",mc]]),gc=P({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=tt(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(a){return e==null?void 0:e.confirm({type:"function",value:`${a}()`})}return(a,c)=>(E(),L("div",{class:m(a.classes.function)},[n.active==="string"?(E(),ee(an,{options:t,onSelect:i,key:"string"})):W("",!0),n.active==="number"?(E(),ee(an,{options:l,onSelect:i,key:"number"})):W("",!0),n.active==="logical"?(E(),ee(an,{options:o,onSelect:i,key:"logical"})):W("",!0),n.active==="date"?(E(),ee(an,{options:s,onSelect:i,key:"date"})):W("",!0),n.active==="aggregate"?(E(),ee(an,{options:r,onSelect:i,key:"aggregate"})):W("",!0)],2))}}),hc={function:"_function_19szx_2"},vc={classes:hc},bc=F(gc,[["__cssModules",vc]]),yc=["onMouseenter"],_c=["onClick"],Ec={key:1},Tc=P({__name:"Formula",props:{doc:{type:Te,default:null}},setup(n){const e=n,t=tt(),l=[{id:"pageNumber",name:"页码",options:a(ri)}],o=he(l[0]);function s(c){o.value=c}function r(c){return t==null?void 0:t.confirm({type:"formula",value:c})}function i(c){const f=Pn.tokenize(c),p=e.doc;return f.reduce((h,y)=>{if(y.type===vt.VARIABLE)return h.push({type:"highlight",value:dt(y.value,p==null?void 0:p.ds)}),h;if(y.type===vt.REFERENCE)return h.push({type:"highlight",value:qo(y.value,p)}),h;if(y.type===vt.TEMPLATE){const d=(Array.isArray(y.value)?y.value:[y.value]).map(v=>v.type===vt.VARIABLE?{type:"highlight",value:dt(v.value,p.ds)}:{type:"text",value:v.value});return h.concat(d)}return h.push({type:"text",value:Pn.formatTokenValue(y)}),h},[])}function a(c){return c.map(f=>({nodes:i(f),value:f}))}return(c,f)=>(E(),L("div",{class:m(c.classes.formula)},[u("div",{class:m([c.classes.left,"quickprint-is-scrollable"])},[(E(),L(te,null,ce(l,p=>u("div",{key:p.name,onMouseenter:h=>s(p),class:m({[c.classes.group]:!0,[c.classes.active]:p.id===o.value.id})},J(p.name),43,yc)),64))],2),u("div",{class:m(c.classes.right)},[(E(!0),L(te,null,ce(o.value.options,(p,h)=>(E(),L("div",{key:h,class:m(c.classes.code),onClick:y=>r(p.value)},[(E(!0),L(te,null,ce(p.nodes,y=>(E(),L(te,null,[y.type==="highlight"?(E(),L("span",{key:0,class:m(c.classes.highlight)},"["+J(y.value)+"]",3)):(E(),L("span",Ec,J(y.value),1))],64))),256)),u("span",{class:m(c.classes.badge)},"插入",2)],10,_c))),128))],2)],2))}}),Sc="_formula_ms7c3_2",Rc="_left_ms7c3_12",kc="_right_ms7c3_17",wc="_group_ms7c3_24",Lc="_active_ms7c3_34",Cc="_highlight_ms7c3_39",Ic="_code_ms7c3_43",Oc="_badge_ms7c3_65",Nc={formula:Sc,left:Rc,right:kc,group:wc,active:Lc,highlight:Cc,code:Ic,badge:Oc},Dc={classes:Nc},Mc=F(Tc,[["__cssModules",Dc]]),Ll=Ce(function(n){return Ze("变量",(e,t)=>g(Bo,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(we)}),xc=Ce(function(n){return ut("数据源",g(Ao,{doc:n},null),{preset:"variable",icon:g(H,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(we)}),qc=Ce(function(n){const e=["ds","builtin","reference"];return Ze("变量",(t,l)=>g(Bo,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(we)}),$c=Ce(function(){return Ze("函数",(n,e)=>g(bc,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(we)}),Ac=Ce(function(n){return ut("公式",g(Mc,{doc:n.doc},null),{preset:"variable"}).promisify().catch(we)}),Bc={key:1},Pc=P({__name:"Content",props:{element:{type:ue,required:!0},showDS:{type:Boolean,default:!0}},setup(n){const e=n,t=ke(),l=pe(),o=pe(),s=he(!1),r=k(()=>{const f=e.element.type===G.TABLE_CELL?kl(e.element,{exclude:["border"]}):En(e.element);return f.color&&(f["--quickprint-element-var-color"]=f.color),s.value&&(f.alignItems="flex-start"),f}),i=k(()=>{const f=Yn(e.element);return f==null||f.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:f.type===ye.CONST?"span":"strong",content:f.content},{tag:"span",content:e.element.attributes.suffix}]});async function a(){var y;const f=await Ll({doc:t.doc,value:e.element.ds.value}).catch(rt);if(f==null||(e.element.setDataSource(ye.VARIABLE,f.value),e.element.type!=G.TABLE_CELL||f.type!=="ds"))return;const p=e.element.parent;if(p==null||p.isBindVariable||((y=f.parent)==null?void 0:y.type)!==re.ARRAY)return;const h=f.parent;p.setDataSource(ye.VARIABLE,`${$t.DS}.${h.type}.${h.name}`)}function c(){const f=l.value,p=o.value;f==null||p==null||(s.value=p.offsetHeight>f.offsetHeight)}return(f,p)=>(E(),L("div",{class:"quickprint-is-element-editor",style:Z(r.value),onVnodeMounted:c,ref_key:"editorRef",ref:l},[u("span",{ref_key:"contentRef",ref:o,class:m(["quickprint-is-content",{[f.classes.lineThrough]:n.element.style.lineThrough}])},[(E(!0),L(te,null,ce(i.value,(h,y)=>(E(),L(te,{key:y},[h.tag=="strong"?(E(),L("strong",{key:0,class:m(f.classes.highlight)},"["+J(h.content)+"]",3)):h.tag=="span"&&h.content?(E(),L("span",Bc,J(h.content),1)):W("",!0)],64))),128))],2),n.showDS&&n.element.isBindVariable?(E(),ee(b(H),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(f.classes.dsIcon),onClick:a,onPointerdown:p[0]||(p[0]=ae(()=>{},["stop"]))},null,8,["class"])):W("",!0)],4))}}),Vc="_dsIcon_1d2si_2",zc="_lineThrough_1d2si_11",Fc="_highlight_1d2si_15",Uc={dsIcon:Vc,lineThrough:zc,highlight:Fc},Hc={classes:Uc},nn=F(Pc,[["__cssModules",Hc]]),Gc=P({__name:"TextEditor",props:{element:{type:Ts,required:!0}},setup(n){return(e,t)=>(E(),ee(nn,{element:n.element},null,8,["element"]))}}),jn=Object.freeze({title:"文本",icon:"icon-text",type:G.TEXT,editor:Gc,onCreate(){return ue.create({type:G.TEXT,width:Ye,height:Wn})}}),Wc=P({__name:"NumberEditor",props:{element:{type:Ss,required:!0}},setup(n){return(e,t)=>(E(),ee(nn,{element:n.element},null,8,["element"]))}}),Xc=["value","disabled"],Yc=P({__name:"RadioButton",props:Bt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=_n(n,"modelValue");return(t,l)=>(E(),L("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(E(!0),L(te,null,ce(n.options,o=>(E(),L("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[Le(u("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,Xc),[[Ws,e.value]]),u("span",null,J(o.label),1)],2))),256))],2))}}),jc="_radioGroup_67myk_2",Zc="_compacted_67myk_10",Kc="_radio_67myk_2",Jc="_selected_67myk_50",Qc="_disabled_67myk_56",eu={radioGroup:jc,compacted:Zc,radio:Kc,selected:Jc,disabled:Qc},tu={classes:eu},xt=F(Yc,[["__cssModules",tu]]),nu={class:"quickprint-config-section quickprint-config-inline"},lu={class:"quickprint-config-content"},ou={class:"quickprint-config-section quickprint-config-inline"},su={class:"quickprint-config-content"},iu={class:"quickprint-config-section quickprint-config-inline"},ru={class:"quickprint-config-content"},au={class:"quickprint-config-section quickprint-config-inline"},cu={class:"quickprint-config-content"},uu=P({__name:"NumberConfig",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=k({get(){return e.element.attributes.round??dn.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=k({get(){return e.element.attributes.format??Ct.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(E(),L(te,null,[u("section",nu,[r[4]||(r[4]=u("header",{class:"quickprint-config-header"},"小数位数",-1)),u("div",lu,[Le(u("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",step:"1",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Be,n.element.attributes.precision]])])]),u("section",ou,[r[5]||(r[5]=u("header",{class:"quickprint-config-header"},"舍入规则",-1)),u("div",su,[g(b(le),{options:b(Js),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",iu,[r[6]||(r[6]=u("header",{class:"quickprint-config-header"},"显示类型",-1)),u("div",ru,[g(b(le),{options:b(Qs),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",au,[r[7]||(r[7]=u("header",{class:"quickprint-config-header"},"值为0时",-1)),u("div",cu,[g(xt,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:b(ei),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),Zn=Object.freeze({title:"数字",type:G.NUMBER,icon:"icon-number",editor:Wc,config:{display:uu},onCreate(){return ue.create({type:G.NUMBER,width:Ye,height:Wn})}}),du=P({__name:"DateEditor",props:{element:{type:Rs,required:!0}},setup(n){return(e,t)=>(E(),ee(nn,{element:n.element},null,8,["element"]))}}),pu={class:"quickprint-config-section"},fu={class:"quickprint-config-content"},mu=P({__name:"DateConfig",props:{element:{type:ue,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=k(()=>[{label:"原始值",value:t.NONE},...Ro]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(E(),L("section",pu,[u("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=u("span",null,"格式",-1)),g(b(le),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:Re(()=>[u("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),u("div",fu,[Le(u("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Be,n.element.attributes.format]])])]))}}),gu="_header_79607_2",hu="_picker_79607_8",vu="_placeholder_79607_15",bu={header:gu,picker:hu,placeholder:vu},yu={classes:bu},_u=F(mu,[["__cssModules",yu]]),Kn=Object.freeze({title:"日期",type:G.DATE,icon:"icon-date",editor:du,config:{display:_u},onCreate(){return ue.create({type:G.DATE,width:Ye,height:Wn})}}),Eu=["x1","y1","x2","y2"],Tu=P({__name:"Diagonal",props:{mode:{type:Number,default:0},labels:{type:Array,default:null},width:{type:Number,default:null},height:{type:Number,default:null}},setup(n){const e=Ie("classes"),t=n,l=k(()=>t.mode===Me.TL_BR?{x1:"0",y1:"0",x2:"100%",y2:"100%"}:t.mode===Me.TR_BL?{x1:"100%",y1:"0",x2:"0",y2:"100%"}:null),o=k(()=>({[e.biagonal]:!0,[e.tlbr]:t.mode===Me.TL_BR,[e.trbl]:t.mode===Me.TR_BL})),s=k(()=>({width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"})),r=k(()=>{var a,c;return(c=(a=t.labels)==null?void 0:a[0])==null?void 0:c.text}),i=k(()=>{var a,c;return(c=(a=t.labels)==null?void 0:a[1])==null?void 0:c.text});return(a,c)=>(E(),L("div",{class:m(o.value),style:Z(s.value)},[l.value?(E(),L("svg",{key:0,class:m(b(e).line)},[u("line",{x1:l.value.x1,y1:l.value.y1,x2:l.value.x2,y2:l.value.y2},null,8,Eu)],2)):W("",!0),r.value?(E(),L("div",{key:1,class:m(b(e).firstLabel)},J(r.value),3)):W("",!0),i.value?(E(),L("div",{key:2,class:m(b(e).secondLabel)},J(i.value),3)):W("",!0)],6))}}),Su="_biagonal_17a80_2",Ru="_firstLabel_17a80_9",ku="_secondLabel_17a80_10",wu="_tlbr_17a80_15",Lu="_trbl_17a80_26",Cu="_line_17a80_37",Iu={biagonal:Su,firstLabel:Ru,secondLabel:ku,tlbr:wu,trbl:Lu,line:Cu},Ou={classes:Iu},zn=F(Tu,[["__cssModules",Ou]]),Nu=["colspan","rowspan"],Du=P({__name:"TableCellEditor",props:{element:{type:bn,required:!0}},setup(n){const e=n,t=k(()=>e.element.isCollapsed),l=k(()=>{const h=e.element.attributes.diagonalMode;return h==null?!1:h!==Me.NONE}),o=ke(),s=Ie("classes"),r=k(()=>{const h=e.element,y=h.parent;return{[s.cell]:!0,[Q.SELECTED]:(y==null?void 0:y.isSelected)||h.isSelected}}),i=k(()=>{var d;const h=qt((d=e.element.parent)==null?void 0:d.parent),y=qt(e.element.parent),_=qt(e.element);return{...f(e.element),...p(e.element),...Object.assign(h,y,_)}}),a=k(()=>{const h=kl(e.element,{exclude:["border","padding"]});return h.color&&(h["--quickprint-element-var-color"]=h.color),h});function c(h){h.button==0&&(h.ctrlKey?o.toggleMultiSelectedElement(e.element):o.selectElement(e.element))}function f(h){const y=h.findPrevDisplayedCell(),_=h.findNextDisplayedCell(),d=h.table,v=Y(h,"left")??Y(h.parent,"left")??Y(d,"left"),T=Y(y,"right")??Y(y==null?void 0:y.parent,"right")??Y(d,"right"),N=Y(h,"right")??Y(h.parent,"right")??Y(d,"right"),A=Y(_,"left")??Y(_==null?void 0:_.parent,"left")??Y(d,"left"),$=Math.max(se.processLengthToPX(v)??0,se.processLengthToPX(T)??0),I=Math.max(se.processLengthToPX(N)??0,se.processLengthToPX(A)??0);return{"--quickprint-cell-width":e.element.offsetWidth+"px","--quickprint-cell-border-left-width":$+"px","--quickprint-cell-border-right-width":I+"px"}}function p(h){var O,B;const y=h.index,_=h.table,d=(O=h.findPrevDisplayedRow())==null?void 0:O.children[y],v=(B=h.findNextDisplayedRow())==null?void 0:B.children[y],T=Y(h,"top")??Y(h.parent,"top")??Y(_,"top"),N=Y(d,"bottom")??Y(d==null?void 0:d.parent,"bottom")??Y(_,"bottom"),A=Y(h,"bottom")??Y(h.parent,"bottom")??Y(_,"bottom"),$=Y(v,"top")??Y(v==null?void 0:v.parent,"top")??Y(_,"top"),I=Math.max(se.processLengthToPX(T)??0,se.processLengthToPX(N)??0),w=Math.max(se.processLengthToPX(A)??0,se.processLengthToPX($)??0);return{"--quickprint-cell-height":h.offsetHeight+"px","--quickprint-cell-border-top-width":I+"px","--quickprint-cell-border-bottom-width":w+"px"}}return(h,y)=>t.value?W("",!0):(E(),L("td",yo({key:0,[`.${b(et)||""}`]:n.element,class:r.value,style:i.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:ae(c,["stop"])}),[l.value?(E(),ee(zn,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight,style:Z(a.value)},null,8,["mode","labels","width","height","style"])):(E(),ee(nn,{key:1,element:n.element,class:m(b(s).content)},null,8,["element","class"]))],48,Nu))}}),Mu="_cell_10c6k_2",xu="_content_10c6k_32",qu={cell:Mu,content:xu},$u={classes:qu},Po=F(Du,[["__cssModules",$u]]);function Vo(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const Au=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:ge.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],zo=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],Fo=[{label:"默认",value:ge.DEFAULT},...zo],Jn=[{label:"默认",value:ge.DEFAULT},...Au,...zo],Cl=[{label:"默认",value:Oe.DEFAULT},{label:"初号",value:Oe.SIZE_0+"pt",short:"56px"},{label:"小初",value:Oe.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:Oe.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:Oe.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:Oe.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:Oe.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:Oe.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:Oe.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:Oe.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:Oe.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:Oe.SIZE_5+"pt",short:"14px"},{label:"小五",value:Oe.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],Uo=[{label:"默认",value:It.DEFAULT},{label:"1.0",value:It.TIMES_1,short:"单倍行距"},{label:"1.1",value:It.TIMES_1_1},{label:"1.5",value:It.TIMES_1_5},{label:"2.0",value:It.TIMES_2,short:"两倍行距"}],Bu=[{label:"无",value:Cn.NONE},{label:"实线",value:zt.SOLID},{label:"虚线",value:zt.DASHED},{label:"点划线",value:zt.DOTTED},{label:"双实线",value:zt.DOUBLE},{label:"波浪线",value:zt.WAVY}],Pu=[{label:"无",value:ne.NONE},{label:"实线",value:ne.SOLID},{label:"虚线",value:ne.DASHED},{label:"点划线",value:ne.DOTTED},{label:"双实线",value:ne.DOUBLE}],Vu=[{label:"默认",value:Ot.AUTO},{label:"左对齐",value:Ot.LEFT},{label:"居中对齐",value:Ot.CENTER},{label:"右对齐",value:Ot.RIGHT},{label:"两端对齐",value:Ot.JUSTIFY}],hl=[{label:"顶部对齐",value:at.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:at.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:at.BOTTOM,icon:"icon-vertical-align-bottom"}],vl=[{label:"左对齐",value:bt.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:bt.CENTER,icon:"icon-align-center"},{label:"右对齐",value:bt.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:bt.JUSTIFY,icon:"icon-menu"}],zu={class:"quickprint-is-row"},Fu=["onClick"],Uu=P({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Ie("classes"),o=e,s=n,r=pe(),i=k(()=>({height:s.height})),a=k({get(){return yt(s.modelValue).num??void 0},set(_){if(_==""||ks(_)||_<0){p(void 0);return}const d=yt(s.modelValue);p(`${_}${d.unit}`)}}),c=k({get(){return yt(s.modelValue).unit??ie.PX},set(_){const d=yt(s.modelValue);p(`${d.num}${_}`)}});function f(_){const d=_===Oe.DEFAULT?void 0:_;o("update:modelValue",d)}function p(_){o("update:modelValue",_),y()}function h(_){const d=s.modelValue;return d==null&&_.value===Oe.DEFAULT?!0:d===_.value}async function y(){await en();const _=document.querySelector("."+l.fontSelected);_&&_.scrollIntoView({block:"nearest"})}return(_,d)=>(E(),L("div",{class:m(b(l).fontSize),style:Z(i.value)},[u("div",zu,[Le(u("input",{type:"number",step:"any",placeholder:"请输入",class:m(["quickprint-form-control",b(l).input]),min:0,"onUpdate:modelValue":d[0]||(d[0]=v=>a.value=v)},null,2),[[Be,a.value]]),g(b(le),{width:"54px",options:t,modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=v=>c.value=v)},null,8,["modelValue"])]),u("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(l).fonts]),ref_key:"scrollRef",ref:r},[(E(!0),L(te,null,ce(b(Cl),v=>(E(),L("div",{key:v.value,class:m({[b(l).option]:!0,[b(l).fontSelected]:h(v)}),onClick:T=>f(v.value)},[u("span",null,J(v.label),1)],10,Fu))),128))],2)],6))}}),Hu="_input_9oh9n_2",Gu="_fontSize_9oh9n_8",Wu="_fonts_9oh9n_13",Xu="_option_9oh9n_25",Yu="_fontSelected_9oh9n_34",ju={input:Hu,fontSize:Gu,fonts:Wu,option:Xu,fontSelected:Yu},Zu={classes:ju},Ho=F(Uu,[["__cssModules",Zu]]),Ku=["title"],Ju={key:0},Qu="中文字体 AbBbCc",ed=P({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k(()=>Jn.map(d=>(d.style={fontFamily:d.value==ge.DEFAULT?ge.SONG:d.value},d))),l=k(()=>Fo.map(d=>(d.style={fontFamily:d.value==ge.DEFAULT?ge.SONG:d.value},d))),o=k({get(){const d=e.options.style.fontFamily;return de(d)?ge.DEFAULT:d},set(d){e.options.style.fontFamily=d==ge.DEFAULT?void 0:d}}),s=k({get(){const d=e.options.style.enFontFamily;return de(d)?ge.DEFAULT:d},set(d){e.options.style.enFontFamily=d==ge.DEFAULT?void 0:d}}),r=k({get(){const d=e.options.style.color;return de(d)?ze.INHERIT:d},set(d){e.options.style.color=d==ze.INHERIT?void 0:d}}),i=k({get(){const d=e.options.style.highlightColor;return de(d)?ze.INHERIT:d},set(d){e.options.style.highlightColor=d==ze.INHERIT?void 0:d}}),a=k({get(){return e.options.style.fontSize},set(d){const v=de(d)?void 0:d;e.options.style.fontSize=v}}),c=k({get(){return e.options.style.fontWeight===700},set(d){e.options.style.fontWeight=d?700:void 0}}),f=k({get(){return e.options.style.fontStyle==="italic"},set(d){e.options.style.fontStyle=d?"italic":void 0}}),p=k({get(){return e.options.style.lineThrough===!0},set(d){e.options.style.lineThrough=d?!0:void 0}}),h=k({get(){const d=e.options.style.underline;if(d==null||d===!1)return Cn.NONE;const v=e.options.style.underlineStyle;return de(v)?zt.SOLID:v},set(d){if(d===Cn.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=d}}),y=k({get(){const d=e.options.style.underlineColor;return de(d)?ze.INHERIT:d},set(d){e.options.style.underlineColor=d==ze.INHERIT?void 0:d}}),_=k(()=>{const d=e.options.style,v={},T=El(d.fontFamily,d.enFontFamily);T&&(v.fontFamily=T);const N=so(d);return N&&Object.assign(v,N),d.fontSize&&(v.fontSize=d.fontSize),d.fontWeight&&(v.fontWeight=d.fontWeight),d.color&&(v.color=d.color),d.fontStyle&&(v.fontStyle=d.fontStyle),d.highlightColor&&(v["--quickprint-variable-highlight-color"]=d.highlightColor),v});return(d,v)=>(E(),L("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",d.classes.font])},[u("div",{class:m(d.classes.fontFamily)},[u("div",{class:m(d.classes.config)},[u("div",{class:m(d.classes.title)},"中文字体",2),u("div",{class:m(d.classes.content)},[g(b(le),{options:t.value,modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=T=>o.value=T)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(d.classes.config)},[u("div",{class:m(d.classes.title)},"颜色",2),g(b(jt),{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=T=>r.value=T)},null,8,["modelValue"])],2),u("div",{class:m([d.classes.config,d.classes.fontSize])},[u("div",{class:m(d.classes.title)},"字号",2),g(Ho,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=T=>a.value=T),height:"144px"},null,8,["modelValue"])],2),u("div",{class:m(d.classes.config)},[u("div",{class:m(d.classes.title)},"西文字体",2),u("div",{class:m(d.classes.content)},[g(b(le),{options:l.value,modelValue:s.value,"onUpdate:modelValue":v[3]||(v[3]=T=>s.value=T)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(d.classes.config)},[u("div",{class:m(d.classes.title)},"前景色",2),g(b(jt),{modelValue:i.value,"onUpdate:modelValue":v[4]||(v[4]=T=>i.value=T)},null,8,["modelValue"])],2),u("div",{class:m(d.classes.config)},[u("div",{class:m(d.classes.title)},"下划线",2),u("div",{class:m(d.classes.content)},[g(b(le),{modelValue:h.value,"onUpdate:modelValue":v[5]||(v[5]=T=>h.value=T),options:b(Bu),width:"138px"},{option:Re(({option:T})=>[u("div",{title:T.label,class:m(d.classes.option)},[T.value==b(Cn).NONE?(E(),L("div",Ju,J(T.label),1)):(E(),L("div",{key:1,class:m(d.classes.line),style:Z({textDecorationStyle:T.value})},"--",6))],10,Ku)]),_:1},8,["modelValue","options"])],2)],2),u("div",{class:m(d.classes.config)},[u("div",{class:m(d.classes.title)},"线条颜色",2),u("div",{class:m(d.classes.content)},[g(b(jt),{modelValue:y.value,"onUpdate:modelValue":v[6]||(v[6]=T=>y.value=T),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),u("div",{class:m(d.classes.fieldset)},[v[13]||(v[13]=u("header",null,"效果",-1)),u("div",{class:m(d.classes.configs)},[u("label",{class:m(d.classes.checkbox)},[Le(u("input",{type:"checkbox","onUpdate:modelValue":v[7]||(v[7]=T=>c.value=T)},null,512),[[ul,c.value]]),v[10]||(v[10]=u("span",null,"粗体",-1))],2),u("label",{class:m(d.classes.checkbox)},[Le(u("input",{type:"checkbox","onUpdate:modelValue":v[8]||(v[8]=T=>f.value=T)},null,512),[[ul,f.value]]),v[11]||(v[11]=u("span",null,"斜体",-1))],2),u("label",{class:m(d.classes.checkbox)},[Le(u("input",{type:"checkbox","onUpdate:modelValue":v[9]||(v[9]=T=>p.value=T)},null,512),[[ul,p.value]]),v[12]||(v[12]=u("span",null,"删除线",-1))],2)],2)],2),u("div",{class:m(d.classes.fieldset)},[v[14]||(v[14]=u("header",null,"预览",-1)),u("div",{class:m(d.classes.preview)},[u("span",{style:Z(_.value)},[u("span",{class:m({[d.classes.lineThrough]:n.options.style.lineThrough})},J(Qu),2)],4)],2)],2)],2))}}),td="_grid2_7i8m3_1",nd="_item_7i8m3_1",ld="_itemLabel_7i8m3_1",od="_fieldset_7i8m3_1",sd="_font_7i8m3_4",id="_fontFamily_7i8m3_9",rd="_config_7i8m3_16",ad="_fontSize_7i8m3_21",cd="_title_7i8m3_25",ud="_configs_7i8m3_30",dd="_checkbox_7i8m3_36",pd="_option_7i8m3_51",fd="_line_7i8m3_59",md="_preview_7i8m3_70",gd="_lineThrough_7i8m3_85",hd={grid2:td,item:nd,itemLabel:ld,fieldset:od,font:sd,fontFamily:id,config:rd,fontSize:ad,title:cd,configs:ud,checkbox:dd,option:pd,line:fd,preview:md,lineThrough:gd},vd={classes:hd},bd=F(ed,[["__cssModules",vd]]),yd=["placeholder","min","disabled"],_d=P({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=k(()=>{const a=l.defaultUnit;return l.options.some(c=>c.value===a)?a:l.options[0].value}),s=k({get(){return yt(l.modelValue).num},set(a){if(uo(a)){const f=yt(l.modelValue).unit??o.value;return i(`${a}${f}`)}i()}}),r=k({get(){return yt(l.modelValue).unit??o.value},set(a){const f=yt(l.modelValue).num??l.min;i(`${f}${a}`)}});function i(a=void 0){t("update:modelValue",a)}return(a,c)=>(E(),L("div",{class:m(a.classes.input)},[Le(u("input",{type:"number",step:"any","onUpdate:modelValue":c[0]||(c[0]=f=>s.value=f),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,yd),[[Be,s.value]]),g(b(le),{modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=f=>r.value=f),class:m(a.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),Ed="_input_gtdaq_2",Td="_unit_gtdaq_14",Sd={input:Ed,unit:Td},Rd={classes:Sd},be=F(_d,[["__cssModules",Rd]]),kd="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",wd=P({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:ie.NONE},{label:"磅",value:ie.PT},{label:"像素",value:ie.PX}],l=[{label:"字符",value:ie.EM},{label:"磅",value:ie.PT},{label:"像素",value:ie.PX}],o=[{label:"毫米",value:ie.MM},{label:"磅",value:ie.PT},{label:"像素",value:ie.PX}],s=k({get(){return e.options.style.textAlign??bt.LEFT},set(v){const T=v===bt.LEFT?void 0:v;e.options.style.textAlign=T}}),r=k({get(){return e.options.style.textAlignLast??Ot.AUTO},set(v){const T=v===Ot.AUTO?void 0:v;e.options.style.textAlignLast=T}}),i=k({get(){return e.options.style.verticalAlign??at.MIDDLE},set(v){const T=v===at.MIDDLE?void 0:v;e.options.style.verticalAlign=T}}),a=_("paddingTop"),c=_("paddingBottom"),f=_("paddingLeft"),p=_("paddingRight"),h=k(()=>{const v=e.options.style,T={};return v.textAlign&&(T.textAlign=v.textAlign),v.textAlignLast&&(T.textAlignLast=v.textAlignLast),v.textIndent&&(T.textIndent=v.textIndent),v.lineHeight&&(T.lineHeight=v.lineHeight),Object.assign(T,d(v.verticalAlign)),T}),y=k(()=>{const v=e.options.style,T={};return T["--openprint-paragraph-preview-padding-top"]=v.paddingTop??"2px",T["--openprint-paragraph-preview-padding-right"]=v.paddingRight??"2px",T["--openprint-paragraph-preview-padding-bottom"]=v.paddingBottom??"2px",T["--openprint-paragraph-preview-padding-left"]=v.paddingLeft??"2px",T});function _(v){return k({get(){return e.options.style[v]},set(T){const N=de(T)?void 0:T;e.options.style[v]=N}})}function d(v){return v==null?{}:v==at.MIDDLE||v==null?{display:"flex",alignItems:"center"}:v==at.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(v,T)=>(E(),L("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",v.classes.paragraph])},[u("div",{class:m(v.classes.textAlign)},[u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"文本对齐",2),g(b(le),{options:b(vl),modelValue:s.value,"onUpdate:modelValue":T[0]||(T[0]=N=>s.value=N)},null,8,["options","modelValue"])],2),u("div",{class:m(v.classes.alignLast)},[u("div",{class:m(v.classes.configItemLabel)},"最后一行",2),g(b(le),{options:b(Vu),modelValue:r.value,"onUpdate:modelValue":T[1]||(T[1]=N=>r.value=N)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"垂直对齐",2),g(b(le),{options:b(hl),modelValue:i.value,"onUpdate:modelValue":T[2]||(T[2]=N=>i.value=N)},null,8,["options","modelValue"])],2),u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"首行缩进",2),g(be,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":T[3]||(T[3]=N=>n.options.style.textIndent=N),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"行高",2),g(be,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":T[4]||(T[4]=N=>n.options.style.lineHeight=N),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.fieldset)},[T[9]||(T[9]=u("header",null,"内边距",-1)),u("div",{class:m(v.classes.padding)},[u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"上边距",2),g(be,{modelValue:b(a),"onUpdate:modelValue":T[5]||(T[5]=N=>Ne(a)?a.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"下边距",2),g(be,{modelValue:b(c),"onUpdate:modelValue":T[6]||(T[6]=N=>Ne(c)?c.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"左边距",2),g(be,{modelValue:b(f),"onUpdate:modelValue":T[7]||(T[7]=N=>Ne(f)?f.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"右边距",2),g(be,{modelValue:b(p),"onUpdate:modelValue":T[8]||(T[8]=N=>Ne(p)?p.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),u("div",{class:m(v.classes.fieldset)},[T[10]||(T[10]=u("header",null,"预览",-1)),u("div",{class:m(v.classes.preview),style:Z(h.value)},[u("div",{style:Z(y.value),class:m(v.classes.previewText)},[fe(J(kd)+" "),u("div",{class:m(v.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),Ld="_grid2_6gzjg_1",Cd="_item_6gzjg_1",Id="_itemLabel_6gzjg_1",Od="_fieldset_6gzjg_1",Nd="_paragraph_6gzjg_4",Dd="_preview_6gzjg_9",Md="_textAlign_6gzjg_25 quickprint-is-row",xd="_configItem_6gzjg_30 quickprint-is-row",qd="_alignLast_6gzjg_35 quickprint-is-row",$d="_configItemLabel_6gzjg_45",Ad="_padding_6gzjg_50",Bd="_paddingItem_6gzjg_57",Pd="_paddingItemLabel_6gzjg_63",Vd="_previewText_6gzjg_68",zd="_paddingPreview_6gzjg_77",Fd={grid2:Ld,item:Cd,itemLabel:Id,fieldset:Od,paragraph:Nd,preview:Dd,textAlign:Md,configItem:xd,alignLast:qd,configItemLabel:$d,padding:Ad,paddingItem:Bd,paddingItemLabel:Pd,previewText:Vd,paddingPreview:zd},Ud={classes:Fd},Hd=F(wd,[["__cssModules",Ud]]),Gd=["title","onClick"],Wd={key:0},Xd=P({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=Ie("classes"),t=n,l=[{label:"像素",value:ie.PX},{label:"毫米",value:ie.MM},{label:"磅",value:ie.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=he(),i=k(()=>{const S=r.value;return S==null?"全部边框":s[S]}),a=k(()=>{const S=r.value;return S==null?!0:S<=o.BORDER_LEFT}),c=k(()=>{const S=r.value;return S==null?!0:S>=o.RADIUS_TOP_LEFT}),f=k(()=>{const S=r.value;return{[e.box]:!0,[e.highlightTopLeft]:S==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:S==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:S==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:S==o.RADIUS_BOTTOM_RIGHT}}),p=k(()=>({...N(o.BORDER_TOP),...N(o.BORDER_RIGHT),...N(o.BORDER_BOTTOM),...N(o.BORDER_LEFT),...T()})),h=k({get(){var z;const S=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return S.borderWidth;const C=(z=wt(R))==null?void 0:z.width;if(C!=null)return Reflect.get(S,C)},set(S){const R=t.options.style,C=r.value,z=S??void 0;if(C==null||C>o.BORDER_LEFT){R.borderWidth=z;return}const V=wt(C);V!=null&&Reflect.set(R,V.width,z)}}),y=k({get(){var z;const S=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return S.borderStyle??ne.NONE;const C=(z=wt(R))==null?void 0:z.style;return C==null?ne.NONE:Reflect.get(S,C)??ne.NONE},set(S){const R=t.options.style,C=r.value,z=S==null||S==ne.NONE?void 0:S;if(C==null||C>o.BORDER_LEFT){R.borderStyle=z;return}const V=wt(C);V!=null&&Reflect.set(R,V.style,z)}}),_=k({get(){var z;const S=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return S.borderColor;const C=(z=wt(R))==null?void 0:z.color;return C==null?ze.INHERIT:Reflect.get(S,C)??ze.INHERIT},set(S){const R=t.options.style,C=r.value,z=S??void 0;if(C==null||C>o.BORDER_LEFT){R.borderColor=z;return}const V=wt(C);V!=null&&Reflect.set(R,V.color,z)}}),d=k({get(){const S=t.options.style,R=r.value;if(R==null||R<=o.BORDER_LEFT)return S.borderRadius;const C=v(R);if(C!=null)return Reflect.get(S,C)},set(S){const R=t.options.style,C=r.value,z=S??void 0;if(C==null||C<=o.BORDER_LEFT){R.borderRadius=z;return}const V=v(C);V!=null&&Reflect.set(R,V,z)}});function v(S){switch(S){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function T(){const S=t.options.style;return{borderTopLeftRadius:S.borderTopLeftRadius??S.borderRadius,borderTopRightRadius:S.borderTopRightRadius??S.borderRadius,borderBottomRightRadius:S.borderBottomRightRadius??S.borderRadius,borderBottomLeftRadius:S.borderBottomLeftRadius??S.borderRadius}}function N(S){const R=t.options.style;if(S==null||S>o.BORDER_LEFT){const V=R.borderStyle;return V==null||V==ne.NONE?{borderStyle:ne.NONE}:{}}const C=wt(S);if(C==null)return{};const z=Reflect.get(R,C.style)??Reflect.get(R,"borderStyle");return z==null||z===ne.NONE?{}:{[C.style]:z??R.borderStyle,[C.width]:Reflect.get(R,C.width)??R.borderWidth,[C.color]:Reflect.get(R,C.color)??R.borderColor??ze.BLACK}}function A(S){y.value=S}function $(S){r.value=S===r.value?void 0:S}function I(){const S=t.options.style;S.borderStyle=void 0,S.borderColor=void 0,S.borderWidth=void 0,S.borderTopStyle=void 0,S.borderTopColor=void 0,S.borderTopWidth=void 0,S.borderRightStyle=void 0,S.borderRightColor=void 0,S.borderRightWidth=void 0,S.borderBottomStyle=void 0,S.borderBottomColor=void 0,S.borderBottomWidth=void 0,S.borderLeftStyle=void 0,S.borderLeftColor=void 0,S.borderLeftWidth=void 0}function w(){const S=t.options.style;S.borderTopStyle==ne.NONE&&(S.borderTopStyle=void 0),S.borderRightStyle==ne.NONE&&(S.borderRightStyle=void 0),S.borderBottomStyle==ne.NONE&&(S.borderBottomStyle=void 0),S.borderLeftStyle==ne.NONE&&(S.borderLeftStyle=void 0),S.borderStyle=ne.SOLID}function O(){const S=t.options.style;S.borderStyle=void 0,S.borderRightStyle=void 0,S.borderRightColor=void 0,S.borderRightWidth=void 0,S.borderLeftStyle=void 0,S.borderLeftColor=void 0,S.borderLeftWidth=void 0,S.borderTopStyle=ne.SOLID,S.borderBottomStyle=ne.SOLID}function B(S){const R=t.options.style,C=v(S)??"borderRadius",z=Reflect.get(R,C);return De(z)}function M(){const S=t.options.style;return De(S.borderRadius)??0}function D(S){const R=Math.min(Math.max(12,B(S)??M(),q(S)),36),C={width:R+"px",height:R+"px"};return r.value==S&&(C.backgroundColor="var(--radius-highlight-background-color)"),S==o.RADIUS_TOP_LEFT&&(C.top="-6px",C.left="-6px"),S==o.RADIUS_TOP_RIGHT&&(C.top="-6px",C.right="-6px"),S==o.RADIUS_BOTTOM_RIGHT&&(C.bottom="-6px",C.right="-6px"),S==o.RADIUS_BOTTOM_LEFT&&(C.bottom="-6px",C.left="-6px"),C}function q(S){const R=t.options.style;switch(S){case o.RADIUS_TOP_LEFT:{const C=R.borderTopStyle==null||R.borderTopStyle==ne.NONE?0:De(R.borderTopWidth),z=R.borderLeftStyle==null||R.borderLeftStyle==ne.NONE?0:De(R.borderLeftWidth);return Math.max(C??0,z??0)}case o.RADIUS_TOP_RIGHT:{const C=R.borderTopStyle==null||R.borderTopStyle==ne.NONE?0:De(R.borderTopWidth),z=R.borderRightStyle==null||R.borderRightStyle==ne.NONE?0:De(R.borderRightWidth);return Math.max(C??0,z??0)}case o.RADIUS_BOTTOM_RIGHT:{const C=R.borderBottomStyle==null||R.borderBottomStyle==ne.NONE?0:De(R.borderBottomWidth),z=R.borderRightStyle==null||R.borderRightStyle==ne.NONE?0:De(R.borderRightWidth);return Math.max(C??0,z??0)}case o.RADIUS_BOTTOM_LEFT:{const C=R.borderBottomStyle==null||R.borderBottomStyle==ne.NONE?0:De(R.borderBottomWidth),z=R.borderLeftStyle==null||R.borderLeftStyle==ne.NONE?0:De(R.borderLeftWidth);return Math.max(C??0,z??0)}default:return 0}}function x(S){const R=t.options.style;switch(S){case o.BORDER_TOP:{const C=Math.max(6,Math.min(B(o.RADIUS_TOP_LEFT)??M()-6,32)),z=Math.max(6,Math.min(B(o.RADIUS_TOP_RIGHT)??M()-6,32)),V={left:C+"px",right:z+"px",top:"-6px",height:"12px"};if(r.value===S&&(V.backgroundColor="var(--border-highlight-background-color)"),R.borderTopStyle==null||R.borderTopStyle==ne.NONE)return V;const oe=De(R.borderTopWidth);return oe==null||(V.height=12+oe+"px",V.top=-6-oe+"px"),V}case o.BORDER_BOTTOM:{const C=Math.max(6,Math.min(B(o.RADIUS_BOTTOM_LEFT)??M()-6,32)),z=Math.max(6,Math.min(B(o.RADIUS_BOTTOM_RIGHT)??M()-6,32)),V={left:C+"px",right:z+"px",bottom:"-6px",height:"12px"};if(r.value===S&&(V.backgroundColor="var(--border-highlight-background-color)"),R.borderBottomStyle==null||R.borderBottomStyle==ne.NONE)return V;const oe=De(R.borderBottomWidth);return oe==null||(V.height=12+oe+"px",V.bottom=-6-oe+"px"),V}case o.BORDER_LEFT:{const C=Math.max(6,Math.min(B(o.RADIUS_TOP_LEFT)??M()-6,32)),z=Math.max(6,Math.min(B(o.RADIUS_BOTTOM_LEFT)??M()-6,32)),V={top:C+"px",bottom:z+"px",left:"-6px",width:"12px"};if(r.value===S&&(V.backgroundColor="var(--border-highlight-background-color)"),R.borderLeftStyle==null||R.borderLeftStyle==ne.NONE)return V;const oe=De(R.borderLeftWidth);return oe==null||(V.width=12+oe+"px",V.left=-6-oe+"px"),V}case o.BORDER_RIGHT:{const C=Math.max(6,Math.min(B(o.RADIUS_TOP_RIGHT)??M()-6,32)),z=Math.max(6,Math.min(B(o.RADIUS_BOTTOM_RIGHT)??M()-6,32)),V={top:C+"px",bottom:z+"px",right:"-6px",width:"12px"};if(r.value===S&&(V.backgroundColor="var(--border-highlight-background-color)"),R.borderRightStyle==null||R.borderRightStyle==ne.NONE)return V;const oe=De(R.borderRightWidth);return oe==null||(V.width=12+oe+"px",V.right=-6-oe+"px"),V}}}return(S,R)=>(E(),L("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",b(e).settings])},[u("div",{class:m(b(e).presets)},[R[15]||(R[15]=u("span",null,"预设",-1)),u("button",{type:"button",class:"quickprint-text-btn",onClick:I},[u("div",{class:m(b(e).noBorder)},null,2),R[12]||(R[12]=u("span",null,"无边框",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:w},[u("div",{class:m(b(e).outerBorder)},null,2),R[13]||(R[13]=u("span",null,"外部边框",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:O},[u("div",{class:m(b(e).topBottomBorder)},null,2),R[14]||(R[14]=u("span",null,"上下边框",-1))])],2),u("div",{class:m(f.value),style:Z(p.value),onClick:R[8]||(R[8]=ae(()=>{},["stop"]))},[u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_TOP_LEFT)),onClick:R[0]||(R[0]=C=>$(o.RADIUS_TOP_LEFT))},null,6),u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_TOP_RIGHT)),onClick:R[1]||(R[1]=C=>$(o.RADIUS_TOP_RIGHT))},null,6),u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_BOTTOM_LEFT)),onClick:R[2]||(R[2]=C=>$(o.RADIUS_BOTTOM_LEFT))},null,6),u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_BOTTOM_RIGHT)),onClick:R[3]||(R[3]=C=>$(o.RADIUS_BOTTOM_RIGHT))},null,6),u("div",{class:m(b(e).border),style:Z(x(o.BORDER_TOP)),onClick:R[4]||(R[4]=C=>$(o.BORDER_TOP))},null,6),u("div",{class:m(b(e).border),style:Z(x(o.BORDER_BOTTOM)),onClick:R[5]||(R[5]=C=>$(o.BORDER_BOTTOM))},null,6),u("div",{class:m(b(e).border),style:Z(x(o.BORDER_RIGHT)),onClick:R[6]||(R[6]=C=>$(o.BORDER_RIGHT))},null,6),u("div",{class:m(b(e).border),style:Z(x(o.BORDER_LEFT)),onClick:R[7]||(R[7]=C=>$(o.BORDER_LEFT))},null,6),u("div",{class:m(b(e).borderTitle)},J(i.value),3)],6),u("div",{class:m(b(e).borderSetting)},[u("div",{class:m(b(e).borderStyle)},[u("label",{class:m(b(e).borderStyleTitle)},"线型",2),u("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(e).borderStyleOptions])},[(E(!0),L(te,null,ce(b(Pu),C=>(E(),L("div",{key:C.value,title:C.label,class:m({[b(e).option]:!0,[b(e).selected]:C.value===y.value}),onClick:z=>A(C.value)},[C.value==b(ne).NONE?(E(),L("div",Wd,J(C.label),1)):(E(),L("div",{key:1,class:m(b(e).line),style:Z({textDecorationStyle:C.value})},"--",6))],10,Gd))),128))],2)],2),u("div",{class:m(b(e).borderSettingRight)},[u("div",{class:m(b(e).borderItem)},[u("label",{class:m(b(e).borderItemLabel)},"颜色",2),g(b(jt),{modelValue:_.value,"onUpdate:modelValue":R[9]||(R[9]=C=>_.value=C),disabled:!a.value},null,8,["modelValue","disabled"])],2),u("div",{class:m(b(e).borderItem)},[u("label",{class:m(b(e).borderItemLabel)},"宽度",2),g(be,{modelValue:h.value,"onUpdate:modelValue":R[10]||(R[10]=C=>h.value=C),options:l,disabled:!a.value},null,8,["modelValue","disabled"])],2),u("div",{class:m(b(e).borderItem)},[u("label",{class:m(b(e).borderItemLabel)},"圆角",2),g(be,{modelValue:d.value,"onUpdate:modelValue":R[11]||(R[11]=C=>d.value=C),options:l,disabled:!c.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),Yd="_settings_12vtg_2",jd="_box_12vtg_8",Zd="_border_12vtg_19",Kd="_borderTitle_12vtg_30",Jd="_borderRadius_12vtg_39",Qd="_borderItem_12vtg_50",ep="_borderItemLabel_12vtg_59",tp="_borderSetting_12vtg_65",np="_borderSettingRight_12vtg_70",lp="_borderStyle_12vtg_76",op="_borderStyleOptions_12vtg_81",sp="_borderStyleTitle_12vtg_88",ip="_option_12vtg_95",rp="_line_12vtg_114",ap="_selected_12vtg_125",cp="_presets_12vtg_131",up="_noBorder_12vtg_142",dp="_outerBorder_12vtg_143",pp="_topBottomBorder_12vtg_144",fp={settings:Yd,box:jd,border:Zd,borderTitle:Kd,borderRadius:Jd,borderItem:Qd,borderItemLabel:ep,borderSetting:tp,borderSettingRight:np,borderStyle:lp,borderStyleOptions:op,borderStyleTitle:sp,option:ip,line:rp,selected:ap,presets:cp,noBorder:up,outerBorder:dp,topBottomBorder:pp},mp={classes:fp},gp=F(Xd,[["__cssModules",mp]]),hp=P({__name:"QRCode",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"毫米",value:ie.MM},{label:"磅",value:ie.PT},{label:"像素",value:ie.PX}],l=a("paddingTop"),o=a("paddingBottom"),s=a("paddingLeft"),r=a("paddingRight"),i=k({get(){var c;return(c=e.options.qrcode)==null?void 0:c.barcolor},set(c){e.options.qrcode==null&&(e.options.qrcode={}),e.options.qrcode.barcolor=c}});function a(c){return k({get(){return e.options.style[c]},set(f){const p=de(f)?void 0:f;e.options.style[c]=p}})}return(c,f)=>(E(),L("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.qrcode])},[u("div",{class:m(c.classes.grid2)},[u("div",{class:m(c.classes.item)},[u("label",{class:m(c.classes.itemLabel)},"码颜色",2),g(b(jt),{modelValue:i.value,"onUpdate:modelValue":f[0]||(f[0]=p=>i.value=p),class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2),u("div",{class:m(c.classes.fieldset)},[f[5]||(f[5]=u("header",null,"内边距",-1)),u("div",{class:m(c.classes.padding)},[u("div",{class:m(c.classes.paddingItem)},[u("label",{class:m(c.classes.paddingItemLabel)},"上边距",2),g(be,{modelValue:b(l),"onUpdate:modelValue":f[1]||(f[1]=p=>Ne(l)?l.value=p:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(c.classes.paddingItem)},[u("label",{class:m(c.classes.paddingItemLabel)},"下边距",2),g(be,{modelValue:b(o),"onUpdate:modelValue":f[2]||(f[2]=p=>Ne(o)?o.value=p:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(c.classes.paddingItem)},[u("label",{class:m(c.classes.paddingItemLabel)},"左边距",2),g(be,{modelValue:b(s),"onUpdate:modelValue":f[3]||(f[3]=p=>Ne(s)?s.value=p:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(c.classes.paddingItem)},[u("label",{class:m(c.classes.paddingItemLabel)},"右边距",2),g(be,{modelValue:b(r),"onUpdate:modelValue":f[4]||(f[4]=p=>Ne(r)?r.value=p:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2)],2))}}),vp="_grid2_59uck_1",bp="_item_59uck_1",yp="_itemLabel_59uck_1",_p="_fieldset_59uck_1",Ep="_qrcode_59uck_4",Tp="_padding_59uck_9",Sp="_paddingItem_59uck_16",Rp="_paddingItemLabel_59uck_22",kp={grid2:vp,item:bp,itemLabel:yp,fieldset:_p,qrcode:Ep,padding:Tp,paddingItem:Sp,paddingItemLabel:Rp},wp={classes:kp},Lp=F(hp,[["__cssModules",wp]]),Cp=P({__name:"Barcode",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"毫米",value:ie.MM},{label:"磅",value:ie.PT},{label:"像素",value:ie.PX}],l=f("paddingTop"),o=f("paddingBottom"),s=f("paddingLeft"),r=f("paddingRight"),i=k({get(){var p;return(p=e.options.qrcode)==null?void 0:p.barcolor},set(p){e.options.qrcode==null&&(e.options.qrcode={}),e.options.qrcode.barcolor=p}}),a=k({get(){var p;return(p=e.options.barcode)==null?void 0:p.width},set(p){e.options.barcode==null&&(e.options.barcode={}),e.options.barcode.width=p}}),c=k({get(){var p;return(p=e.options.barcode)==null?void 0:p.height},set(p){e.options.barcode==null&&(e.options.barcode={}),e.options.barcode.height=p}});function f(p){return k({get(){return e.options.style[p]},set(h){const y=de(h)?void 0:h;e.options.style[p]=y}})}return(p,h)=>(E(),L("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",p.classes.qrcode])},[u("div",{class:m(p.classes.grid2)},[u("div",{class:m(p.classes.item)},[u("label",{class:m(p.classes.itemLabel)},"宽度",2),g(be,{modelValue:a.value,"onUpdate:modelValue":h[0]||(h[0]=y=>a.value=y),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(p.classes.item)},[u("label",{class:m(p.classes.itemLabel)},"高度",2),g(be,{modelValue:c.value,"onUpdate:modelValue":h[1]||(h[1]=y=>c.value=y),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(p.classes.item)},[u("label",{class:m(p.classes.itemLabel)},"码颜色",2),g(b(jt),{modelValue:i.value,"onUpdate:modelValue":h[2]||(h[2]=y=>i.value=y),class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2),u("div",{class:m(p.classes.fieldset)},[h[7]||(h[7]=u("header",null,"内边距",-1)),u("div",{class:m(p.classes.padding)},[u("div",{class:m(p.classes.paddingItem)},[u("label",{class:m(p.classes.paddingItemLabel)},"上边距",2),g(be,{modelValue:b(l),"onUpdate:modelValue":h[3]||(h[3]=y=>Ne(l)?l.value=y:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(p.classes.paddingItem)},[u("label",{class:m(p.classes.paddingItemLabel)},"下边距",2),g(be,{modelValue:b(o),"onUpdate:modelValue":h[4]||(h[4]=y=>Ne(o)?o.value=y:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(p.classes.paddingItem)},[u("label",{class:m(p.classes.paddingItemLabel)},"左边距",2),g(be,{modelValue:b(s),"onUpdate:modelValue":h[5]||(h[5]=y=>Ne(s)?s.value=y:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(p.classes.paddingItem)},[u("label",{class:m(p.classes.paddingItemLabel)},"右边距",2),g(be,{modelValue:b(r),"onUpdate:modelValue":h[6]||(h[6]=y=>Ne(r)?r.value=y:null),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2)],2))}}),Ip="_grid2_59uck_1",Op="_item_59uck_1",Np="_itemLabel_59uck_1",Dp="_fieldset_59uck_1",Mp="_qrcode_59uck_4",xp="_padding_59uck_9",qp="_paddingItem_59uck_16",$p="_paddingItemLabel_59uck_22",Ap={grid2:Ip,item:Op,itemLabel:Np,fieldset:Dp,qrcode:Mp,padding:xp,paddingItem:qp,paddingItemLabel:$p},Bp={classes:Ap},Pp=F(Cp,[["__cssModules",Bp]]),Vp=P({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=tt();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(E(),L("div",{class:m(s.classes.setting)},[n.active==="font"?(E(),ee(bd,{key:0,options:e.options},null,8,["options"])):W("",!0),n.active==="paragraph"?(E(),ee(Hd,{key:1,options:e.options},null,8,["options"])):W("",!0),n.active==="border"?(E(),ee(gp,{key:2,options:e.options},null,8,["options"])):W("",!0),n.active=="qrcode"?(E(),ee(Lp,{key:3,options:e.options},null,8,["options"])):W("",!0),n.active=="barcode"?(E(),ee(Pp,{key:4,options:e.options},null,8,["options"])):W("",!0),u("div",{class:m(s.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),zp="_setting_1v5ya_2",Fp="_footer_1v5ya_9",Up={setting:zp,footer:Fp},Hp={classes:Up},ln=F(Vp,[["__cssModules",Hp]]),Gp=P({__name:"Footer",emits:["confirm"],setup(n,{emit:e}){const t=e,l=tt();function o(){t("confirm",function(i){l==null||l.confirm(i)})}function s(){l==null||l.cancel()}return(r,i)=>(E(),L("div",{class:m(r.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:s},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:o},"确定")],2))}}),Wp="_footer_1ux18_2",Xp={footer:Wp},Yp={classes:Xp},Go=F(Gp,[["__cssModules",Yp]]),jp=P({__name:"Diagonal",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k({get(){return e.options.diagonalMode??Me.NONE},set(i){const a=i==Me.NONE?void 0:i;e.options.diagonalMode=a}}),l=k({get(){var i,a;return(a=(i=e.options.diagonalLabels)==null?void 0:i[0])==null?void 0:a.text},set(i){const a=e.options;a.diagonalLabels==null&&(a.diagonalLabels=[]),a.diagonalLabels[0]==null&&(a.diagonalLabels[0]={}),a.diagonalLabels[0].text=i}}),o=k({get(){var i,a;return(a=(i=e.options.diagonalLabels)==null?void 0:i[1])==null?void 0:a.text},set(i){const a=e.options;a.diagonalLabels==null&&(a.diagonalLabels=[]),a.diagonalLabels[1]==null&&(a.diagonalLabels[1]={}),a.diagonalLabels[1].text=i}});function s(i){t.value=i}function r(i){i(e.options)}return(i,a)=>(E(),L("div",{class:m(i.classes.setting)},[u("div",{class:m(i.classes.main)},[u("div",{class:m(["quickprint-is-row",i.classes.diagonal])},[u("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Me).NONE}),onClick:a[0]||(a[0]=c=>s(b(Me).NONE))},null,2),u("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Me).TL_BR}),onClick:a[1]||(a[1]=c=>s(b(Me).TL_BR))},[g(zn,{mode:b(Me).TL_BR,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2),u("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Me).TR_BL}),onClick:a[2]||(a[2]=c=>s(b(Me).TR_BL))},[g(zn,{mode:b(Me).TR_BL,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2)],2),u("div",{class:m(i.classes.label)},[u("div",{class:m(i.classes.text)},"顶部文本",2),Le(u("input",{"onUpdate:modelValue":a[3]||(a[3]=c=>l.value=c),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Be,l.value]])],2),u("div",{class:m(i.classes.label)},[u("div",{class:m(i.classes.text)},"底部文本",2),Le(u("input",{"onUpdate:modelValue":a[4]||(a[4]=c=>o.value=c),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Be,o.value]])],2)],2),g(Go,{onConfirm:r})],2))}}),Zp="_setting_1u7dq_2",Kp="_main_1u7dq_6",Jp="_cell_1u7dq_10",Qp="_diagonal_1u7dq_25",ef="_selected_1u7dq_29",tf="_label_1u7dq_34",nf="_text_1u7dq_41",lf={setting:Zp,main:Kp,cell:Jp,diagonal:Qp,selected:ef,label:tf,text:nf},of={classes:lf},sf=F(jp,[["__cssModules",of]]);function Wo(n){return xe({style:vn(n.style??{})})}function rf(n,e){n.style=Object.assign({},n.style,e.style)}function Xo(n){if(Array.isArray(n)&&n.length>1)return xe({style:{}});const e=Array.isArray(n)?n[0]:n;return xe({width:e.width,height:e.height,diagonalMode:e.attributes.diagonalMode,diagonalLabels:vn(e.attributes.diagonalLabels??[]),style:vn(e.style??{})})}const af=Ce(function(n){return Ze("表格",(e,t)=>g(ln,{options:Wo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>rf(n,e)).catch(we)}),cf=Ce(function(n){return Ze("表格行",(e,t)=>g(ln,{options:Wo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(we)}),uf=Ce(function(n){return Ze("单元格",(e,t)=>g(ln,{options:Xo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(we)}),df=Ce(function(n){return ut("斜线表头",g(sf,{options:Xo(n)},null),{width:"360px",top:"15vh",resizeMode:Wt.DISABLED}).promisify().catch(we)}),pf={style:{overflow:"hidden"}},ff=P({__name:"TextDirection",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=k(()=>e.options.style.writingMode??Fe.HORIZONTAL_TB);function l(s){e.options.style.writingMode=s===Fe.HORIZONTAL_TB?void 0:s}function o(s){s(e.options)}return(s,r)=>(E(),L("div",pf,[u("div",{class:m(s.classes.textDirection)},[u("div",{class:m(s.classes.grid)},[u("div",{title:"水平排版，从左到右",class:m({[s.classes.horizontalTb]:!0,[s.classes.selected]:t.value===b(Fe).HORIZONTAL_TB}),onClick:r[0]||(r[0]=i=>l(b(Fe).HORIZONTAL_TB))},r[5]||(r[5]=[u("p",null,"文字abc",-1)]),2),u("div",{title:"垂直排版，从上到下，从左到右",class:m({[s.classes.verticalLr]:!0,[s.classes.selected]:t.value===b(Fe).VERTICAL_LR}),onClick:r[1]||(r[1]=i=>l(b(Fe).VERTICAL_LR))},r[6]||(r[6]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2),u("div",{title:"垂直排版，从上到下，从右到左",class:m({[s.classes.verticalRl]:!0,[s.classes.selected]:t.value===b(Fe).VERTICAL_RL}),onClick:r[2]||(r[2]=i=>l(b(Fe).VERTICAL_RL))},r[7]||(r[7]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2),u("div",{title:"垂直排版，从上到下，从右到左",class:m({[s.classes.sidewaysRl]:!0,[s.classes.selected]:t.value===b(Fe).SIDEWAYS_RL}),onClick:r[3]||(r[3]=i=>l(b(Fe).SIDEWAYS_RL))},r[8]||(r[8]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2),u("div",{title:"垂直排版，从下到上，从左到右",class:m({[s.classes.sidewaysLr]:!0,[s.classes.selected]:t.value===b(Fe).SIDEWAYS_LR}),onClick:r[4]||(r[4]=i=>l(b(Fe).SIDEWAYS_LR))},r[9]||(r[9]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2)],2),u("div",{class:m(s.classes.preview)},r[10]||(r[10]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2)],2),g(Go,{onConfirm:o})]))}}),mf="_textDirection_qsmbx_2",gf="_grid_qsmbx_16",hf="_item_qsmbx_24",vf="_horizontalTb_qsmbx_36 _item_qsmbx_24",bf="_verticalLr_qsmbx_45 _item_qsmbx_24",yf="_verticalRl_qsmbx_54 _item_qsmbx_24",_f="_sidewaysRl_qsmbx_63 _item_qsmbx_24",Ef="_sidewaysLr_qsmbx_72 _item_qsmbx_24",Tf="_preview_qsmbx_81",Sf="_selected_qsmbx_89",Rf={textDirection:mf,grid:gf,item:hf,horizontalTb:vf,verticalLr:bf,verticalRl:yf,sidewaysRl:_f,sidewaysLr:Ef,preview:Tf,selected:Sf},kf={classes:Rf},wf=F(ff,[["__cssModules",kf]]);function Qn(n){const e=Array.isArray(n)?n:[n];if(e.length!==1)return xe({style:{}});const t=e[0],l={style:vn(t.style??{})};return t.type===G.QRCODE&&(l.qrcode={barcolor:t.attributes.barcolor}),t.type===G.BARCODE&&(l.barcode={barcolor:t.attributes.barcolor,scale:t.attributes.scale,width:t.attributes.width,height:t.attributes.height}),xe(l)}const Lf=Ce(function(n){return Ze("元素属性",(e,t)=>g(ln,{options:Qn(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify()}),Yo=Ce(function(n){return ut("文字方向",g(wf,{options:Qn(n)},null),{width:"424px",height:"285px",top:"15vh",resizeMode:Wt.DISABLED}).promisify()}),Cf=Ce(function(n){return Ze("二维码属性",(e,t)=>g(ln,{options:Qn(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"qrcode",active:!0},{label:"边框",name:"border"}]}).promisify()}),If=Ce(function(n){return Ze("条形码属性",(e,t)=>g(ln,{options:Qn(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"barcode",active:!0},{label:"边框",name:"border"}]}).promisify()});function Of(n,e,t){const l={menus:[...jo(e),{type:"menu",label:"行设置",icon:"icon-table-row",handler(){const o=e.getSelectedElements(),s=o[0];s!=null&&cf(s).then(r=>{if(r!=null)for(const i of o)i.style=Object.assign({},i.style,r.style)})}},{type:"divider"},Zo(e),Ko(e),{type:"divider"},Jo(e),Vo(e.getDesignApi(),e.getTable())]};mt.open(n.clientX,n.clientY,l)}function Nf(n,e){const l=e.getDesignApi().getSelectedElements();if(e.isSelectTableRow())return Of(n,e,l[0]);const o=e.getSelectedCells(),s={menus:[...jo(e),{type:"menu",label:"单元格设置",icon:"icon-border",handler(){uf(o).then(i=>{if(i!=null)for(const a of o)a.style=Object.assign({},a.style,i.style)})}},{type:"menu",label:"斜线表头",icon:"icon-diagonal",handler(){df(o).then(i=>{if(i!=null)for(const a of o)i.diagonalMode&&(a.attributes.diagonalMode=i.diagonalMode),i.diagonalLabels&&(a.attributes.diagonalLabels=i.diagonalLabels)})}},{type:"menu",label:"文字方向",icon:"icon-text-direction",handler(){Yo(o)}},{type:"divider"}]},r=[];return o.length>=2&&r.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells,disabled(){const i=o.map(c=>c.parent).filter(c=>c!=null);return new Set(i.map(c=>c.attributes.type)).size>1?!0:new Set(i.map(c=>c.ds.value).filter(c=>ht(c))).size>1}}),o.some(i=>i.hasSpan)&&r.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),o.length===1&&o[0].noSpan&&r.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),r.length>0&&s.menus.push(...r,{type:"divider"}),s.menus.push(Zo(e),Ko(e),{type:"divider"},Jo(e),Vo(e.getDesignApi(),e.getTable())),mt.open(n.clientX,n.clientY,s)}function jo(n){return[{type:"menu",label:"选中表格",icon:"icon-aim",handler:n.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",handler(){af(n.getTable())}}]}function Zo(n){return{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:n.insertColumnLeft,disabled:n.isSelectTableRow},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:n.insertColumnRight,disabled:n.isSelectTableRow},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:n.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:n.inserRowBottom}]}}function Ko(n){return{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:n.deleteColumns,disabled:n.isSelectTableRow},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:n.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:n.deleteDataSource}]}}function Jo(n){return{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:n.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:n.avgTableWidth},{type:"menu",label:"均分表格高度",handler:n.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:n.setOtherRowSameHeight,disabled(){const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:n.setOtherColSameWidth,disabled(){if(n.isSelectTableRow())return!0;const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasColSpan)}}]}}function Df(n,e){function t(){return n.element}function l(){return e.getSelectedElements(t())}function o(){const O=t();return l().filter(M=>{var q;if(M.type!==G.TABLE_CELL)return!1;const D=(q=M.parent)==null?void 0:q.parent;return D==null?!1:D.id==O.id}).sort(bn.sort)}function s(){return e.selectElement(t())}function r(){const O=o();if(O.length===0)return!1;const B=gt.toArea(O);return t().insertColumn(B.colStart,0),e.createSnapshot(),!0}function i(){const O=o();if(O.length===0)return!1;const B=gt.toArea(O);return t().insertColumn(B.colEnd,1),e.createSnapshot(),!0}function a(){if(w()){const M=l()[0];return t().inserRow(M.index,0),e.createSnapshot(),!0}const O=o();if(O.length===0)return!1;const B=gt.toArea(O);return t().inserRow(B.rowStart,0),e.createSnapshot(),!0}function c(){if(w()){const M=l()[0];return t().inserRow(M.index,1),e.createSnapshot(),!0}const O=o();if(O.length===0)return!1;const B=gt.toArea(O);return t().inserRow(B.rowEnd,1),e.createSnapshot(),!0}function f(){var oe,qe;const O=t(),B=O.page;if(B==null)return;const M=O.doc,D=De((oe=M==null?void 0:M.margins)==null?void 0:oe.left)??38,q=De((qe=M==null?void 0:M.margins)==null?void 0:qe.right)??38,x=O.columns,S=x.reduce(($e,lt)=>$e+lt,0),R=se.mm_to_px(B.width)-D-q,C=[];for(const $e of x){const lt=Math.round($e/S*R);C.push(lt)}const z=C.reduce(($e,lt)=>$e+lt,0),V=R-z;C[C.length-1]+=V,O.setColumns(C),O.updateBoxSize(),e.createSnapshot()}function p(){const O=t(),B=O.columns,M=B.reduce((S,R)=>S+R,0),D=Math.floor(M/B.length),q=new Array(B.length).fill(D),x=M-q.reduce((S,R)=>S+R,0);q[q.length-1]+=x,O.setColumns(q),O.updateBoxSize(),e.createSnapshot()}function h(){const O=t(),B=Math.round(O.height/O.children.length);O.children.forEach((M,D)=>O.setRowHeight(D,B)),O.updateBoxSize(),e.createSnapshot()}function y(){const O=l()[0];if(O==null)return;const B=O.type===G.TABLE_ROW?O:O.parent;if(!ue.isDefineElement(B)||B.type!=G.TABLE_ROW)return;const M=t(),D=B.height;M.children.forEach(q=>q.setRowHeight(D)),M.updateBoxSize(),e.createSnapshot()}function _(){const O=l()[0];if(O==null)return;const B=t(),M=O.width,D=B.attributes.colgroup.map(q=>M);B.setColumns(D),B.updateBoxSize(),e.createSnapshot()}function d(){const O=o();if(O.length<2)return;const M=t().mergeCells(O);e.selectElement(M),e.createSnapshot()}function v(){const O=o();if(O.length==0)return;t().splitCells(O),e.createSnapshot()}function T(){const O=o()[0];if(O==null)return;t().removeColumn(O.index),e.resetSelectedElement(),e.createSnapshot()}function N(){if(w()){const D=l()[0];t().removeRow(D.index),e.resetSelectedElement(),e.createSnapshot();return}const O=o();if(O.length==0)return;const B=gt.toArea(O),M=t();for(let D=B.rowEnd;D>=B.rowStart;D--)M.removeRow(D);e.resetSelectedElement(),e.createSnapshot()}function A(){l().forEach(B=>B.resetDS()),e.createSnapshot()}function $(){const O=l();if(O.length!=1)return;const B=O[0];if(B.hasSpan)return;const M=B.index,D=t();D.insertColumn(M,1,!0);for(const q of D.children){const x=q.children[M];if(x.id===B.id)continue;const S=q.children[M+1];if(x.hasSpan){D.mergeRightCell(x,S);continue}if(x.isCollapsed){const R=D.find(x.attributes.control);R&&D.mergeRightCell(R,S);continue}D.mergeCells([x,S])}e.selectElement(B),e.createSnapshot()}function I(){const O=l();if(O.length!=1)return;const B=O[0];if(B.hasSpan)return;const M=B.parent;if(M==null)return;const D=t();D.inserRow(M.index,1);const q=D.children[M.index+1];for(let x=0;x<M.children.length;x++){const S=M.children[x];if(S.id===B.id)continue;const R=q.children[x];if(S.hasSpan){D.mergeBottomCell(S,R);continue}if(S.isCollapsed){const C=D.find(S.attributes.control);C&&D.mergeBottomCell(C,R);continue}D.mergeCells([S,R])}e.selectElement(B),e.createSnapshot()}function w(){const O=l();return O.length==1&&O[0].type==G.TABLE_ROW}return{getDesignApi(){return e},getTable:t,getSelectedElements:l,getSelectedCells:o,selectTable:s,insertColumnLeft:r,insertColumnRight:i,insertRowTop:a,inserRowBottom:c,autoReiszeColumnByPaper:f,avgTableWidth:p,avgTableHeight:h,setOtherRowSameHeight:y,setOtherColSameWidth:_,mergeCells:d,splitCells:v,splitByColumn:$,splitByRow:I,deleteColumns:T,deleteRows:N,deleteDataSource:A,isSelectTableRow:w}}function Mf(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getColumnLeft(f-1)}function r(f){const p=n.getTable(),h=p.attributes.colgroup.length;return f>=h?null:p.getColumnLeft(f+1)}function i(f,p){if(!(f.target instanceof Element))return;const h=f.target.closest("."+e.colResize);if(h==null)return;const y=h.closest("."+e.layer);y!=null&&(f.stopPropagation(),f.preventDefault(),o.left=h.offsetLeft,o.colIndex=p,o.target=h,o.container=y,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",c))}function a(f){if(o.target==null||o.container==null)return;const p=o.container.getBoundingClientRect(),h=n.getDesignApi().state.scale/100,y=s(o.colIndex),_=r(o.colIndex);let d=f.clientX-p.left;y!=null&&d<=y*h+4&&(d=y*h+4),_!=null&&d>=_*h-4&&(d=_*h-4),o.left=d/h,o.target.style.left=d/h+"px",o.moved=!0}function c(f){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",c)}return i}function xf(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getRowTop(f-1)}function r(f){const p=n.getTable(),h=p.children.length;return f>=h?null:p.getRowTop(f+1)}function i(f,p){if(!(f.target instanceof Element))return;const h=f.target.closest("."+e.rowResize);if(h==null)return;const y=h.closest("."+e.layer);y!=null&&(f.stopPropagation(),f.preventDefault(),o.top=h.offsetTop,o.rowIndex=p,o.target=h,o.container=y,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",c))}function a(f){if(o.target==null||o.container==null)return;const p=n.getDesignApi().state.scale/100,h=o.container.getBoundingClientRect(),y=s(o.rowIndex),_=r(o.rowIndex);let d=f.clientY-h.top;y!=null&&d<=y*p+4&&(d=y*p+4),_!=null&&d>=_*p-4&&(d=_*p-4),o.moved=!0,o.top=d/p,o.target.style.top=d/p+"px"}function c(f){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",c)}return i}const qf=["width"],$f=["onClick"],Af=["onClick"],Bf=P({__name:"TableEditor",props:{element:{type:gt,required:!0}},setup(n){const e=n,t=ke(),l=Ie("classes"),o=Df(e,t),s=xe({colIndex:-1,rowIndex:-1,silence:!1}),r=k(()=>e.element.attributes.colgroup??[]),i=Mf(o,l,{onResizeEnd:T,onResizeStart:v}),a=xf(o,l,{onResizeEnd:N,onResizeStart:v});function c(M){return{left:(e.element.attributes.colgroup??[]).slice(0,M).reduce((q,x)=>q+x,0)+"px"}}function f(M){return{top:(e.element.children??[]).slice(0,M).reduce((x,S)=>x+S.height,0)-1+"px"}}function p(M){const D=e.element.attributes.colgroup??[],q=D.slice(0,M).reduce((R,C)=>R+C,0),x=M===0?0:1,S=M>0&&M<D.length?-1:0;return{left:q+x+"px",width:D[M]+S+"px"}}function h(M){const D=e.element.children??[],q=D.slice(0,M).reduce((R,C)=>R+C.height,0),x=M===0?0:1,S=M>0&&M<D.length?-1:0;return{top:q+x+"px",height:D[M].height+S+"px"}}function y(M){t.selectElement(M)}function _(M){const D=[];for(const q of e.element.children){const x=q.children[M];x.isColCollapsed||D.push(x)}t.multiSelectElements(D)}async function d(M){const D=M.target.closest("td");if(D==null)return;const q=Reflect.get(D,et);if(q==null)return;const x=t.getSelectedElements(e.element);(x.length==0||x.length==1&&x[0].type===G.TABLE_CELL||x.length>1&&x.findIndex(S=>S.id===q.id)<0)&&(t.selectElement(q),await en()),Nf(M,o)}function v(){s.silence=!0}function T(M,D){s.silence=!1;const q=e.element.attributes.colgroup??[];if(M==0){const z=e.element.left,V=e.element.calculateCoord(z+D),oe=q[0]-(V-z);e.element.setLeft(V),e.element.setColWidth(0,oe),e.element.updateBoxSize(),t.createSnapshot();return}if(M==q.length){const z=M-1,V=q.slice(0,z).reduce((qe,$e)=>qe+$e,0),oe=D-V;e.element.setColWidth(M-1,oe),e.element.updateBoxSize(),t.createSnapshot();return}const x=M-1,S=q[x]+q[M],R=D-q.slice(0,x).reduce((z,V)=>z+V,0),C=S-R;e.element.setColWidth(x,R),e.element.setColWidth(M,C),e.element.updateBoxSize(),t.createSnapshot()}function N(M,D){s.silence=!1;const q=e.element.children;if(M==0){const z=e.element.top,V=e.element.calculateCoord(z+D),oe=q[0].height-(V-z);e.element.setTop(V),e.element.setRowHeight(M,oe),e.element.updateBoxSize(),t.createSnapshot();return}if(M==q.length){const z=M-1,V=q.slice(0,z).reduce((qe,$e)=>qe+$e.height,0),oe=D-V;e.element.setRowHeight(M-1,oe),e.element.updateBoxSize(),t.createSnapshot();return}const x=M-1,S=q[x].height+q[M].height,R=D-q.slice(0,x).reduce((z,V)=>z+V.height,0),C=S-R;e.element.setRowHeight(x,R),e.element.setRowHeight(M,C),e.element.updateBoxSize(),t.createSnapshot()}function A(){s.rowIndex=-1,s.colIndex=-1}function $(M){const D=M.target.closest("td");if(D==null)return;const q=Reflect.get(D,et);if(q==null||!(q instanceof bn))return;const x=D.getBoundingClientRect(),S=M.clientX-x.left,R=q.index;if(!q.hasColSpan)return S<x.width/2?R:q.getNextColIndex();const C=e.element.attributes.colgroup,z=C[R]/2;if(S>=0&&S<=z)return R;const V=q.offsetWidth,oe=V-C[R+q.colspan-1]/2;if(S>=oe&&S<=V)return q.getNextColIndex()+1}function I(M){const D=M.target.closest("td");if(D==null)return;const q=Reflect.get(D,et);if(q==null||!(q instanceof bn))return;const x=q.parent;if(x==null)return;const S=D.getBoundingClientRect(),R=M.clientY-S.top,C=x.index;if(!q.hasRowSpan)return R<S.height/2?C:q.getNextRowIndex();const z=x.height/2;if(R>=0&&R<=z)return C;const V=e.element.children.slice(x.index,x.index+q.rowspan),oe=V.reduce(($e,lt)=>$e+lt.height,0),qe=oe-V[V.length-1].height;if(R>=qe&&R<=oe)return q.getNextRowIndex()+1}function w(M){s.silence||(s.colIndex=$(M)??-1,s.rowIndex=I(M)??-1)}function O(){const M=e.element;M.insertColumn(M.colSize-1,1)}function B(){const M=e.element;M.inserRow(M.rowSize-1,1)}return(M,D)=>(E(),L("div",{class:m(b(l).tableEditor),onContextmenu:ae(d,["stop","prevent"]),onClick:D[3]||(D[3]=ae(()=>{},["stop"])),onMouseleave:A},[u("table",{class:m(b(l).table),onMousemove:w},[u("colgroup",null,[(E(!0),L(te,null,ce(r.value,(q,x)=>(E(),L("col",{key:x,width:q},null,8,qf))),128))]),u("tbody",null,[(E(!0),L(te,null,ce(n.element.children,q=>(E(),L("tr",{key:q.id},[(E(!0),L(te,null,ce(q.children,x=>(E(),ee(Po,{key:x.id,element:x},null,8,["element"]))),128))]))),128))])],34),u("div",{class:m(b(l).layer)},[s.colIndex>=0?(E(),L("div",{key:0,title:"调整列宽",class:m(b(l).colResize),style:Z(c(s.colIndex)),onPointerdown:D[0]||(D[0]=ae(q=>b(i)(q,s.colIndex),["stop","prevent"]))},null,38)):W("",!0),s.rowIndex>=0?(E(),L("div",{key:1,title:"调整行高",class:m(b(l).rowResize),style:Z(f(s.rowIndex)),onPointerdown:D[1]||(D[1]=ae(q=>b(a)(q,s.rowIndex),["stop","prevent"]))},null,38)):W("",!0),(E(!0),L(te,null,ce(r.value,(q,x)=>(E(),L("div",{title:"选中此列",key:x,style:Z(p(x)),class:m(b(l).colIndicator),onClick:ae(S=>_(x),["stop"])},null,14,$f))),128)),(E(!0),L(te,null,ce(n.element.children,(q,x)=>(E(),L("div",{title:"选中此行",key:x,style:Z(h(x)),class:m(b(l).rowIndicator),onClick:ae(S=>y(q),["stop"])},null,14,Af))),128)),n.element.isSelected?(E(),L("button",{key:2,onClick:ae(O,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addCol]),title:"添加列"},[g(b(H),{icon:"icon-plus",size:"14px"})],2)):W("",!0),n.element.isSelected?(E(),L("button",{key:3,onClick:ae(B,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addRow]),title:"添加行"},[g(b(H),{icon:"icon-plus",size:"14px"})],2)):W("",!0)],2),u("div",{class:m(b(l).indicator),onPointerdown:D[2]||(D[2]=(...q)=>b(t).onDragStart&&b(t).onDragStart(...q)),title:"选中/拖动表格"},null,34)],34))}}),Pf="_tableEditor_5qbkt_2",Vf="_table_5qbkt_2",zf="_layer_5qbkt_33",Ff="_colResize_5qbkt_43",Uf="_rowResize_5qbkt_66",Hf="_colIndicator_5qbkt_89",Gf="_rowIndicator_5qbkt_95",Wf="_indicator_5qbkt_114",Xf="_addCol_5qbkt_151",Yf="_addRow_5qbkt_166",jf={tableEditor:Pf,table:Vf,layer:zf,colResize:Ff,rowResize:Uf,colIndicator:Hf,rowIndicator:Gf,indicator:Wf,addCol:Xf,addRow:Yf},Zf={classes:jf},Kf=F(Bf,[["__cssModules",Zf]]),Jf={class:"quickprint-config-section quickprint-config-inline"},Qf={class:"quickprint-config-content"},em=P({__name:"TableConfig",props:{element:{type:gt,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.rowMode??sn.CONST},set(o){e.element.attributes.rowMode=o===sn.CONST?void 0:o}}),l=[{label:"固定行数",value:sn.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:sn.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:sn.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(E(),L("section",Jf,[s[1]||(s[1]=u("header",{class:"quickprint-config-header"},"行模式",-1)),u("div",Qf,[g(b(le),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),tm={class:"quickprint-config-section quickprint-config-inline"},nm={class:"quickprint-config-content"},lm=P({__name:"TableRowConfig",props:{element:{type:In,required:!0}},setup(n){const e=n,t=[{label:"表头",value:Vt.HEADER},{label:"表体",value:Vt.BODY},{label:"表尾",value:Vt.FOOTER}],l=k({get(){return e.element.attributes.type??Vt.BODY},set(o){switch(o){case Vt.HEADER:e.element.asHeader();break;case Vt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(E(),L("section",tm,[s[1]||(s[1]=u("header",{class:"quickprint-config-header"},"行模式",-1)),u("div",nm,[g(b(le),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),om=["colspan","rowspan"],sm=P({__name:"TableCellDummy",props:{element:{type:bn,required:!0}},setup(n){const e=n,t=k(()=>e.element.isCollapsed),l=k(()=>{const f=e.element.attributes.diagonalMode;return f==null?!1:f!==Me.NONE}),o=Ie("classes"),s=k(()=>{const f=e.element,p=f.parent;return{[o.cell]:!0,[Q.SELECTED]:(p==null?void 0:p.isSelected)||f.isSelected}}),r=k(()=>{var y;const f=qt((y=e.element.parent)==null?void 0:y.parent),p=qt(e.element.parent),h=qt(e.element);return{...a(e.element),...c(e.element),...Object.assign(f,p,h)}}),i=k(()=>{const f=kl(e.element,{exclude:["border","padding"]});return f.color&&(f["--quickprint-element-var-color"]=f.color),f});function a(f){const p=f.findPrevDisplayedCell(),h=f.findNextDisplayedCell(),y=f.table,_=Y(f,"left")??Y(f.parent,"left")??Y(y,"left"),d=Y(p,"right")??Y(p==null?void 0:p.parent,"right")??Y(y,"right"),v=Y(f,"right")??Y(f.parent,"right")??Y(y,"right"),T=Y(h,"left")??Y(h==null?void 0:h.parent,"left")??Y(y,"left"),N=Math.max(se.processLengthToPX(_)??0,se.processLengthToPX(d)??0),A=Math.max(se.processLengthToPX(v)??0,se.processLengthToPX(T)??0);return{"--quickprint-cell-width":e.element.offsetWidth+"px","--quickprint-cell-border-left-width":N+"px","--quickprint-cell-border-right-width":A+"px"}}function c(f){var I,w;const p=f.index,h=f.table,y=(I=f.findPrevDisplayedRow())==null?void 0:I.children[p],_=(w=f.findNextDisplayedRow())==null?void 0:w.children[p],d=Y(f,"top")??Y(f.parent,"top")??Y(h,"top"),v=Y(y,"bottom")??Y(y==null?void 0:y.parent,"bottom")??Y(h,"bottom"),T=Y(f,"bottom")??Y(f.parent,"bottom")??Y(h,"bottom"),N=Y(_,"top")??Y(_==null?void 0:_.parent,"top")??Y(h,"top"),A=Math.max(se.processLengthToPX(d)??0,se.processLengthToPX(v)??0),$=Math.max(se.processLengthToPX(T)??0,se.processLengthToPX(N)??0);return{"--quickprint-cell-height":f.offsetHeight+"px","--quickprint-cell-border-top-width":A+"px","--quickprint-cell-border-bottom-width":$+"px"}}return(f,p)=>t.value?W("",!0):(E(),L("td",{key:0,class:m(s.value),style:Z(r.value),colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan},[l.value?(E(),ee(zn,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight,style:Z(i.value)},null,8,["mode","labels","width","height","style"])):(E(),ee(nn,{key:1,element:n.element,class:m(b(o).content),showDS:!1},null,8,["element","class"]))],14,om))}}),im="_cell_10c6k_2",rm="_content_10c6k_32",am={cell:im,content:rm},cm={classes:am},um=F(sm,[["__cssModules",cm]]),dm=["width"],pm=P({__name:"TableDummy",props:{element:{type:gt,required:!0}},setup(n){const e=n,t=k(()=>e.element.attributes.colgroup??[]);return(l,o)=>(E(),L("table",{class:m(l.classes.table)},[u("colgroup",null,[(E(!0),L(te,null,ce(t.value,(s,r)=>(E(),L("col",{key:r,width:s},null,8,dm))),128))]),u("tbody",null,[(E(!0),L(te,null,ce(n.element.children,s=>(E(),L("tr",{key:s.id},[(E(!0),L(te,null,ce(s.children,r=>(E(),ee(um,{key:r.id,element:r},null,8,["element"]))),128))]))),128))])],2))}}),fm="_table_1kbtq_2",mm={table:fm},gm={classes:mm},hm=F(pm,[["__cssModules",gm]]),el=Object.freeze({title:"表格",type:G.TABLE,icon:"icon-table",dummy:hm,editor:Kf,config:{attributes:em,exclude:[me.DISPLAY,me.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[Ye,Ye,Ye],e=ue.create({type:G.TABLE});return e.style.borderStyle=ne.SOLID,e.setColgroup(n),e.append(In.createDefault(n)),e.append(In.createDefault(n)),e.append(In.createDefault(n)),e.updateBoxSize(),e}}),Qo=Object.freeze({title:"表格行",type:G.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[me.POSITION,me.COORD,me.OVERFLOW],attributes:lm}}),Il=Object.freeze({title:"单元格",type:G.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:Po,config:{exclude:[me.POSITION,me.COORD]}});class vm{constructor(e){j(this,"__v_skip",!0);j(this,"observer");j(this,"callbacks",[]);j(this,"handler");this.handler=ws((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function bm(n,e){switch(n){case"fontSize":return e===Oe.DEFAULT?void 0:e;case"fontFamily":return e===ge.DEFAULT?void 0:e;case"lineHeight":return e===It.DEFAULT?void 0:e;default:return e}}const Vl="texteditor-const-node",ym=Object.freeze({CONST:0});class _m{constructor(e,t={}){j(this,"__v_skip",!0);j(this,"emitter",new An);j(this,"container");j(this,"options");j(this,"observer");j(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new vm(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new An}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Ls(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(de(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await Un(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=Vl,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var h;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,a=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(a),r.parentNode===i||(h=r.parentNode)!=null&&h.contains(i))return s.insertNode(a),this.normalize(),this.focusAfterNode(a),!0;const c=r.parentNode;if(c==null)return!1;const f=c.textContent;if(f==null)return!1;if(o.anchorOffset==f.length)return i.insertBefore(a,c.nextSibling),this.normalize(),this.focusAfterNode(a),!0;const p=document.createElement("span");return p.textContent=f.slice(0,o.anchorOffset),c instanceof HTMLElement&&(p.style.cssText=c.style.cssText),c.textContent=f.slice(o.anchorOffset),i.insertBefore(a,c),i.insertBefore(p,a),this.normalize(),this.focusAfterNode(a),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return de(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var f;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:a}=this.normalizeRange(o);if(s===i){const p=s.textContent??"";if(s instanceof CharacterData){const _=document.createElement("span");return _.textContent=p.slice(r,a),o.deleteContents(),o.insertNode(_),[_]}const h=document.createElement("span");h.textContent=p.slice(0,r),this.inheritStyle(h,i);const y=document.createElement("span");return y.textContent=p.slice(r,a),this.inheritStyle(y,i),i.textContent=p.slice(a),e.insertBefore(y,i),e.insertBefore(h,y),[y]}const c=this.findNodesBetween(s,i);if(r>0){const p=s.textContent??"",h=document.createElement("span");h.textContent=p.slice(0,r),this.inheritStyle(h,s),s.textContent=p.slice(r),e.insertBefore(h,s)}if(a>=0&&a<=(((f=i.textContent)==null?void 0:f.length)??0)){const p=i.textContent??"";if(i instanceof HTMLElement){i.textContent=p.slice(0,a);const h=document.createElement("span");h.textContent=p.slice(a),this.inheritStyle(h,i),e.insertBefore(h,i.nextSibling),c.push(i)}else{const h=document.createElement("span");h.textContent=p.slice(0,a),e.replaceChild(h,i);const y=document.createTextNode(p.slice(a));e.insertBefore(y,i.nextSibling),c.push(h)}}return c.unshift(s),c}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=co(e),r=bm(e,t);for(let i=0;i<l.length;i++){const a=l[i];if(a instanceof HTMLElement){this.matchElementStyle(a,s,r)||(o=!1);continue}const c=document.createElement("span");c.textContent=a.textContent,this.container.replaceChild(c,a),l[i]=c,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=Nt.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=Nt.remove(o,l);de(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+Vl)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const Em=P({__name:"ParagraphEditor",props:{element:{type:Cs,required:!0}},setup(n){const e=n,t=ke(),l=pe(),o=k(()=>e.element.isSelected!==!0?!1:t.state.selectMode===ct.SINGLE);let s=null;const r=k(()=>Jn.map(I=>(I.style={fontFamily:I.value==ge.DEFAULT?ge.SONG:I.value},I)));function i(){}async function a(){if(s==null)return;const I=await Ll({doc:t.doc}).catch(rt);if(I==null)return;const w=dt(I.value,t.doc.ds)??I.value,O={type:ym.CONST,value:I.value,label:w};s.insertNode(O)}function c(){s==null||s.blur()}function f(){s==null||s.autosize()}function p(I){const w=e.element.ds.value,O=new _m(I);return O.on("resize",B=>{var D;const M=(D=B.detail)==null?void 0:D.height;M!=null&&e.element.setHeight(M+2)}),O.watch(()=>{const B=O.getHTML(),M=e.element.ds.value;B!==M&&(e.element.ds.value=B,O.checkHeight())}),de(w)||O.setHTML(w),O}function h(I){s==null||s.setStyle("fontFamily",I.value)}function y(I){s==null||s.setStyle("fontSize",I.value)}function _(I){s==null||s.setStyle("lineHeight",I.value)}function d(I){s==null||s.setStyle("backgroundColor",I)}function v(I){s==null||s.setStyle("color",I)}function T(){s==null||s.setStyle("fontWeight","700")}function N(){s==null||s.setStyle("fontStyle","italic")}function A(){s==null||s.setStyle("textDecorationLine","underline")}function $(){s==null||s.setStyle("textDecorationLine","line-through")}return Tl(()=>e.element.ds.value,I=>{s==null||s.getHTML()==I||s.setHTML(I)}),tn(()=>{e.element.on("blur",c),s=p(l.value)}),Hn(()=>{e.element.off("blur",c),s&&s.cleanup()}),(I,w)=>(E(),L("div",{class:m(I.classes.paragraph),onPointerdown:w[2]||(w[2]=ae(()=>{},["stop"])),onContextmenu:ae(i,["stop","prevent"])},[u("div",{class:m(I.classes.indicator),onPointerdown:w[0]||(w[0]=(...O)=>b(t).onDragStart&&b(t).onDragStart(...O)),title:"选中/拖动段落"},null,34),o.value?(E(),L("div",{key:0,class:m(I.classes.toolbar),onMousedown:w[1]||(w[1]=ae(()=>{},["prevent"]))},[g(b(le),{onSelect:h,title:"字体",width:"60px",options:r.value,class:m(I.classes.tool),button:""},null,8,["options","class"]),g(b(le),{onSelect:y,title:"字号",width:"60px",options:b(Cl),class:m(I.classes.tool),button:""},null,8,["options","class"]),g(b(le),{onSelect:_,title:"行高",width:"60px",options:b(Uo),class:m(I.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),u("div",{class:m(I.classes.divider)},null,2),g(b(Yt),{class:m(I.classes.tool),onSelect:d},{default:Re(()=>[u("div",{class:m(I.classes.colorIcon),title:"突出显示"},[g(b(H),{icon:"icon-bg-color-b",size:"15px"}),u("div",{class:m(I.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),g(b(Yt),{class:m(I.classes.tool),onSelect:v},{default:Re(()=>[u("div",{class:m(I.classes.colorIcon),title:"字体颜色"},[g(b(H),{icon:"icon-font",size:"15px"}),u("div",{class:m(I.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),u("button",{onClick:T,type:"button",title:"加粗",class:m(["quickprint-text-btn",I.classes.tool])},[g(b(H),{icon:"icon-font-bold",size:"16px"})],2),u("button",{onClick:N,type:"button",title:"斜体",class:m(["quickprint-text-btn",I.classes.tool])},[g(b(H),{icon:"icon-italic",size:"16px"})],2),u("button",{onClick:A,type:"button",title:"下划线",class:m(["quickprint-text-btn",I.classes.tool])},[g(b(H),{icon:"icon-underline",size:"16px"})],2),u("button",{onClick:$,type:"button",title:"删除线",class:m(["quickprint-text-btn",I.classes.tool])},[g(b(H),{icon:"icon-through-line",size:"16px"})],2),u("div",{class:m(I.classes.divider)},null,2),u("button",{class:"quickprint-text-btn",type:"button",onClick:a},[g(b(H),{icon:"icon-insert-var",size:"16px"}),w[3]||(w[3]=u("span",null,"插入变量",-1))]),u("button",{class:"quickprint-text-btn",type:"button",onClick:f},[g(b(H),{icon:"icon-colum-height",size:"16px"}),w[4]||(w[4]=u("span",null,"调整高度",-1))])],34)):W("",!0),u("div",{ref_key:"editorRef",ref:l,class:m(I.classes.editor)},null,2)],34))}}),Tm="_paragraph_1v2pj_2",Sm="_indicator_1v2pj_6",Rm="_editor_1v2pj_18",km="_toolbar_1v2pj_44",wm="_tool_1v2pj_44",Lm="_colorIcon_1v2pj_66",Cm="_colorIndicator_1v2pj_86",Im="_divider_1v2pj_95",Om={paragraph:Tm,indicator:Sm,editor:Rm,toolbar:km,tool:wm,colorIcon:Lm,colorIndicator:Cm,divider:Im},Nm={classes:Om},Dm=F(Em,[["__cssModules",Nm]]),tl=Object.freeze({title:"段落",type:G.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:Dm,config:{exclude:[me.DATASOURCE,me.BASIC,me.OVERFLOW]},onCreate(){return ue.create({type:G.PARAGRAPH,width:Ye*4,height:Wn*6})}}),Mm=["src"],xm=P({__name:"ImageEditor",props:{element:{type:po,required:!0}},setup(n){const e=n;ke();const t=k(()=>{var i;const r=e.element.ds;return de(r.value)?{type:"placeholder",value:"请上传图片"}:r.type===ye.CONST?s(r.value)?{type:"image",value:r.value}:{type:"placeholder",value:"无效的图片"}:{type:"content",value:(i=Yn(e.element))==null?void 0:i.content}}),l=k(()=>En(e.element)),o=k(()=>Is(e.element.attributes.size));function s(r){return!!(/^https?:\/\//.test(r)||/^data:image\/(.+);base64,/.test(r))}return(r,i)=>(E(),L("div",{class:m(r.classes.editor),style:Z(l.value)},[t.value.type==="placeholder"?(E(),L("div",{key:0,class:m(r.classes.placeholder)},J(t.value.value),3)):W("",!0),t.value.type==="content"?(E(),L("span",{key:1,class:m(r.classes.highlight)},"["+J(t.value.value)+"]",3)):W("",!0),t.value.type==="image"?(E(),L("img",{key:2,src:t.value.value,style:Z(o.value),class:m(r.classes.image)},null,14,Mm)):W("",!0)],6))}}),qm="_editor_154e6_2",$m="_image_154e6_10",Am="_highlight_154e6_14",Bm="_placeholder_154e6_30",Pm={editor:qm,image:$m,highlight:Am,placeholder:Bm},Vm={classes:Pm},zl=F(xm,[["__cssModules",Vm]]),zm={class:"quickprint-config-section quickprint-config-inline"},Fm={class:"quickprint-config-content"},Um=P({__name:"ImageConfig",props:{element:{type:po,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.size??Ut.NATURAL},set(l){const o=l===Ut.NATURAL?void 0:l;e.element.attributes.size=o}});return(l,o)=>(E(),L("section",zm,[o[1]||(o[1]=u("header",{class:"quickprint-config-header"},"缩放模式",-1)),u("div",Fm,[g(b(le),{options:b(ai),modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-w-full"},null,8,["options","modelValue"])])]))}}),nl=Object.freeze({title:"图片",icon:"icon-image",type:G.IMAGE,editor:zl,dummy:zl,config:{attributes:Um,exclude:[me.BASIC,me.OVERFLOW]},contextmenu(){return["auto-resize","---","copy","delete","---","z-index"]},onCreate(){return ue.create({type:G.IMAGE,width:Ye,height:Ye})}}),Hm=["innerHTML"],Fl="",Gm=P({__name:"BarcodeEditor",props:{element:{type:fo,required:!0}},setup(n){const e=n,t=Ie("classes"),l=k(()=>{const r=e.element.attributes,i=ht(r.width)||ht(r.height);return{"quickprint-is-element-editor":!0,[t.editor]:!0,[t.fixed]:i,[t.contain]:!i}}),o=k(()=>{const r=e.element.attributes,i=En(e.element);return r.width&&(i["--quickprint-barcode-width"]=r.width),r.height&&(i["--quickprint-barcode-height"]=r.height),i}),s=k(()=>{const r=e.element.ds,i=e.element.attributes,a={barcolor:i.barcolor,includetext:i.showText===!0,width:se.processLengthToMM(i.width),height:se.processLengthToMM(i.height)};if(r.type===ye.CONST&&ht(r.value)){const f=On.barcode(i.mode,r.value,a);if(ht(f))return f}const c=On.genDefaultBarcode(i.mode);return c==null?Fl:On.barcode(i.mode,c,a)??Fl});return(r,i)=>(E(),L("div",{class:m(l.value),style:Z(o.value)},[u("span",{innerHTML:s.value,class:m(b(t).barcode)},null,10,Hm)],6))}}),Wm="_editor_1vkh8_2",Xm="_barcode_1vkh8_10",Ym="_fixed_1vkh8_14",jm="_contain_1vkh8_21",Zm={editor:Wm,barcode:Xm,fixed:Ym,contain:jm},Km={classes:Zm},Ul=F(Gm,[["__cssModules",Km]]),Jm={class:"quickprint-config-section quickprint-config-inline"},Qm={class:"quickprint-config-content"},eg={class:"quickprint-config-section quickprint-config-inline"},tg={class:"quickprint-config-content"},ng=P({__name:"BarcodeConfig",props:{element:{type:fo,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.mode},set(o){e.element.attributes.mode=o}}),l=k({get(){return e.element.attributes.showText===!0},set(o){e.element.attributes.showText=o}});return(o,s)=>(E(),L(te,null,[u("section",Jm,[s[2]||(s[2]=u("header",{class:"quickprint-config-header"},"码制",-1)),u("div",Qm,[g(b(le),{options:b(ui),modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",eg,[s[3]||(s[3]=u("header",{class:"quickprint-config-header"},"显示文本",-1)),u("div",tg,[g(xt,{modelValue:l.value,"onUpdate:modelValue":s[1]||(s[1]=r=>l.value=r),options:b(di),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),ll=Object.freeze({title:"条形码",icon:"icon-barcode",type:G.BARCODE,editor:Ul,dummy:Ul,config:{attributes:ng},contextmenu(){return["barcode-setting","auto-resize","---","copy","delete","---","z-index"]},onCreate(){return ue.create({type:G.BARCODE,width:155,height:112,attributes:{mode:Xe.EAN_13,showText:!0}})}}),lg=["innerHTML"],Hl="0",og=P({__name:"QRCodeEditor",props:{element:{type:mo,required:!0}},setup(n){const e=n,t=k(()=>e.element.ds.type===ye.CONST&&e.element.ds.value||Hl),l=k(()=>{const s=t.value,r=e.element.attributes.mode,i=e.element.attributes.barcolor;return On.qrcode(r,s,{barcolor:i})??""}),o=k(()=>En(e.element,{exclude:["align"]}));return(s,r)=>(E(),L("div",{class:m(s.classes.editor),style:Z(o.value)},[u("span",{innerHTML:l.value,class:m(s.classes.qrcode)},null,10,lg)],6))}}),sg="_editor_ymcu8_2",ig="_qrcode_ymcu8_19",rg={editor:sg,qrcode:ig},ag={classes:rg},Gl=F(og,[["__cssModules",ag]]),cg={class:"quickprint-config-section quickprint-config-inline"},ug={class:"quickprint-config-content"},dg=P({__name:"QRCodeConfig",props:{element:{type:mo,required:!0}},setup(n){const e=n,t=k({get(){return e.element.attributes.mode??hn.QRCODE},set(l){const o=l===hn.QRCODE?void 0:l;e.element.attributes.mode=o}});return(l,o)=>(E(),L("section",cg,[o[1]||(o[1]=u("header",{class:"quickprint-config-header"},"码制",-1)),u("div",ug,[g(b(le),{options:b(ci),modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-w-full"},null,8,["options","modelValue"])])]))}}),ol=Object.freeze({title:"二维码",icon:"icon-qrcode",type:G.QRCODE,editor:Gl,dummy:Gl,config:{attributes:dg},contextmenu(){return["qrcode-setting","auto-resize","---","copy","delete","---","z-index"]},onCreate(){return ue.create({type:G.QRCODE,width:Ye,height:Ye})}}),es=[jn,Zn,Kn,el,Il,Qo,tl,nl,ll,ol],pg=[jn,Zn,Kn,el,tl,nl,ll,ol],fg={[G.TEXT]:jn.editor,[G.NUMBER]:Zn.editor,[G.DATE]:Kn.editor,[G.TABLE]:el.editor,[G.TABLE_CELL]:Il.editor,[G.PARAGRAPH]:tl.editor,[G.IMAGE]:nl.editor,[G.BARCODE]:ll.editor,[G.QRCODE]:ol.editor},mg={[G.TEXT]:jn.config,[G.NUMBER]:Zn.config,[G.DATE]:Kn.config,[G.TABLE]:el.config,[G.TABLE_CELL]:Il.config,[G.TABLE_ROW]:Qo.config,[G.PARAGRAPH]:tl.config,[G.IMAGE]:nl.config,[G.BARCODE]:ll.config,[G.QRCODE]:ol.config},Tt=es.reduce((n,e)=>(n[e.type]=e,n),{});function gg(n){const e=es.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function hg(n){return Reflect.get(fg,n)}function cn(n){return Reflect.get(mg,n)}function Wl(n){var e;return(e=Tt[n])==null?void 0:e.contextmenu}function yn(n){var e;return((e=Tt[n])==null?void 0:e.title)??n}function vg(n){var e;return(e=Tt[n])==null?void 0:e.icon}function bg(n){var e,t;return((t=(e=Tt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function yg(n){var e,t;return((t=(e=Tt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function _g(n){var e,t;return((t=(e=Tt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Eg(n){var e,t;return((t=(e=Tt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Tg(n){var e;return(e=Tt[n])==null?void 0:e.dummy}function Xl(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function Yl(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function jl(n,e){const t=n.find(a=>a.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function Zl(n,e){const t=n.find(a=>a.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function Sg(n){const e=document.createElement("div");return n.appendChild(e),e}function Rg(n,e){const t=[...e.querySelectorAll(":scope ."+Q.GUIDE_LINE)];for(const l of n){const o=t.shift()??Sg(e);o.className=Q.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function kg(n,e){const l=e.querySelectorAll(":scope ."+Q.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const a=i.getBoundingClientRect();if(Math.abs(s.left-a.left)<=1||Math.abs(s.right-a.left)<=1){const c=a.left-o.left;jl(r,Xl(c,s,a,o))}if(Math.abs(s.left-a.right)<=1||Math.abs(s.right-a.right)<=1){const c=a.right-o.left;jl(r,Xl(c,s,a,o))}if(Math.abs(s.top-a.top)<=1||Math.abs(s.bottom-a.top)<=1){const c=a.top-o.top;Zl(r,Yl(c,s,a,o))}if(Math.abs(s.bottom-a.bottom)<=1||Math.abs(s.top-a.bottom)<=1){const c=a.bottom-o.top;Zl(r,Yl(c,s,a,o))}}Rg(r,e)}function wg(){const n=document.querySelectorAll("."+Q.GUIDE_LINE);for(const e of n)e.remove()}const Fn={create:Os(kg,50),clean:wg};async function Lg(n){await Un(),n&&Reflect.deleteProperty(n,Gn)}async function Cg(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=Ig(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-Lo(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function Ig(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Ue.INSERT){const o=t.closest("."+Q.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?Ht(e.left-s.left):Math.round(e.left-s.left),y:l?Ht(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?Ht(e.left):Math.round(e.left),y:l?Ht(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function Og(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function Ng(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function Dg(n){return!(n.style.rotate&&!n.isSelected)}function Mg(n){const e=new gl({selector:{container:Q.DROPPABLE},scale(t){return t.mode===Ue.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,_o),s=Reflect.get(l.target,Sl);o===Ue.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===Ue.INSERT?o:Ue.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Ue.INSERT){const s=gg(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,et);if(o==null||!Dg(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Ue.INSERT&&(l.ghost.style.display="block"),l.mode===Ue.MOVE&&Reflect.set(l.target,Gn,Rl.DRAG_ELEMENT),l.ghost.classList.add(Q.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,Cg(n,l),Og(n,l),l.dropTarget&&Fn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;Fn.clean(),l.ghost.classList.remove(Q.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Ue.INSERT&&(l.ghost.style.display="none"),l.mode==Ue.MOVE&&Lg(l.target);const o=l.element;if(l.mode==Ue.MOVE){const c=o.left,f=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-c,l.diffY=o.top-f,Ng(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,Eo);if(s==null)return;const r=s instanceof At||s instanceof ue?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),a=n.state.scale/100;o.setTop((l.top-i.top)/a),o.setLeft((l.left-i.left)/a),o.setWidth(o.width/a),o.setHeight(o.height/a),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Kl="quickprint-history-0000",xg=1,ft="snapshot",Dn="health",Jl="owner",st="INDEX_OWNER",qg=15*60*1e3,$g=10*60*1e3;function Ag(){const n={db:null,timer:null,promise:null};async function e(){const f=await a(Dn,"readwrite");if(f==null)return n.timer=s(),!1;const p=[],h=f.openCursor();h.onsuccess=async function(y){const _=y.target.result;if(_==null){t(p),n.timer=s(),He.debug("History","已检查无效快照");return}const d=_.value;d!=null&&Date.now()-d.timestamp>qg&&p.push(d),_.continue()},h.onerror=function(y){console.error(y),n.timer=s()}}async function t(f){const p=await Promise.allSettled(f.map(h=>l(h.owner)));for(let h=0;h<p.length;h++){const y=p[h];y.status==="rejected"||y.value!==!0||o(f[h].id)}}async function l(f){const p=await a(ft,"readwrite");return p==null?!1:new Promise(h=>{const y=p.index(st).openCursor(IDBKeyRange.only(f));y.onsuccess=function(_){const d=_.target.result;if(d==null)return h(!0);d.delete(),d.continue()},y.onerror=function(_){console.error(_),h(!1)}})}async function o(f){const p=await a(Dn,"readwrite");return p==null?!1:fn(p.delete(f)).then(()=>!0).catch(h=>(console.log(h),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),$g)}function r(){return new Promise(f=>{const p=indexedDB.open(Kl,xg);p.onupgradeneeded=h=>{const _=h.target.result,d=_.createObjectStore(Dn,{keyPath:"id",autoIncrement:!0}),v=_.createObjectStore(ft,{keyPath:"id",autoIncrement:!0});d.createIndex(st,Jl),v.createIndex(st,Jl)},p.onsuccess=h=>{const y=h.target;n.db=y.result,He.debug("History",`已连接数据库【${Kl}】`),f(n.db)},p.onerror=function(h){console.error(h),n.db=null,f(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function a(f,p="readonly"){const h=await i();if(h==null)return null;try{return h.transaction(f,p).objectStore(f)}catch(y){return console.error(y),null}}function c(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:a,cleanup:c}}function fn(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const Bg=5*60*1e3,Lt=Ag();var it,je,Mn,bl,ts;class Pg{constructor(e,t={}){ot(this,je);j(this,"state");j(this,"owner");ot(this,it);this.state=e,this.owner=t.owner??Ns(Ds.HISTORY_OWNER),Ve(this,je,bl).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await Lt.findStore(ft,"readwrite");if(l==null)return!1;await Ve(this,je,ts).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await fn(l.put(s)).catch(rt)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await Lt.findStore(ft,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await fn(o.put(l)).catch(rt)==null))}async getCurrentSnapshot(){const e=await Lt.findStore(ft);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(st).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return o(a);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await Lt.findStore(ft);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(st).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await Lt.findStore(ft);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(st).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await Lt.findStore(ft);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(st).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const a=i.value;if(a.owner!=t)return i.continue();s.push(a),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){Pe(this,it)&&(clearTimeout(Pe(this,it)),Rt(this,it,null))}}it=new WeakMap,je=new WeakSet,Mn=function(){Rt(this,it,setTimeout(()=>Ve(this,je,bl).call(this),Bg))},bl=async function(){Pe(this,it)&&clearTimeout(Pe(this,it));const e=await Lt.findStore(Dn,"readwrite");if(e==null)return Ve(this,je,Mn).call(this);const t=await fn(e.index(st).get(this.owner)).catch(rt);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),Ve(this,je,Mn).call(this)}t.timestamp=Date.now(),await fn(e.put(t)).catch(rt),Ve(this,je,Mn).call(this)},ts=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(st).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const a=i.target.result;if(a==null)return s(!0);const c=a.value;if(c.owner!=o)return a.continue();if(c.index>t){a.delete(),a.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function Vg(n){const e=new Pg(xe({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(f){return e.createSnapshot(n.value,f)}function s(f){return e.replaceSnapshot(n.value,f)}async function r(){const f=await e.getPrevSnapshot();if(f==null)return!1;const p=Bn(f.data);return p==null?!1:(n.value=Te.create(p),!0)}async function i(){const f=await e.getNextSnapshot();if(f==null)return!1;const p=Bn(f.data);return p==null?!1:(n.value=Te.create(p),!0)}function a(){return e.list()}function c(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:a,cleanup:c,replaceSnapshot:s}}class zg{constructor(e){j(this,"moved",!1);j(this,"position");j(this,"top",0);j(this,"left",0);j(this,"width",0);j(this,"height",0);j(this,"initX",0);j(this,"initY",0);j(this,"indicator");j(this,"container");j(this,"originalEvent");j(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Jt,Qt,Et,ns,ls,os;const Ae=class Ae extends An{constructor(t={}){var l,o,s;super();ot(this,Et);j(this,"context",null);j(this,"selector");j(this,"scale");j(this,"onResizeStart");ot(this,Jt);ot(this,Qt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??Q.PAGE,element:((o=t.selector)==null?void 0:o.element)??Q.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??Q.RESIZEABLE_INDICATOR},this.onResizeStart=Ve(this,Et,ns).bind(this),Rt(this,Jt,Ve(this,Et,ls).bind(this)),Rt(this,Qt,Ve(this,Et,os).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",Pe(this,Jt)),window.removeEventListener("pointerup",Pe(this,Qt)),this.context=null}};Jt=new WeakMap,Qt=new WeakMap,Et=new WeakSet,ns=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return He.warn(Ae.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,To);if(o==null)return He.warn(Ae.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return He.warn(Ae.TAG_NAME,"未找到的可调整元素");const r=wo(s,this.selector.container);this.context=new zg({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return He.warn(Ae.TAG_NAME,"已取消调整");if(this.context.container==null)return He.warn(Ae.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const a=this.createEvent("resizestart",this.context);if(this.dispatch(a).defaultPrevented)return He.warn(Ae.TAG_NAME,"已取消调整");window.addEventListener("pointermove",Pe(this,Jt)),window.addEventListener("pointerup",Pe(this,Qt))},ls=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&pn.TOP){const c=Math.max((i.bottom-t.clientY)/s,Ae.MIN_LENGTH);l.top=(i.bottom-r.top)/s-c,l.height=c}if(o&pn.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Ae.MIN_LENGTH)),o&pn.LEFT){const c=Math.max((i.right-t.clientX)/s,Ae.MIN_LENGTH);l.left=(i.right-r.left)/s-c,l.width=c}o&pn.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Ae.MIN_LENGTH));const a=this.createEvent("resizing",l);this.dispatch(a).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},os=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},j(Ae,"TAG_NAME","quickprint-resizeable"),j(Ae,"MIN_LENGTH",12);let yl=Ae;async function Fg(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?Ht(e.width):Math.round(e.width),o=t?Ht(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-Lo(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function Ug(n){const e=new yl({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,et);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(Fg(n,l),Fn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),Fn.clean()}),n.onResizeStart=e.onResizeStart,e}function Hg(n){function e(r){const i=document.activeElement,a=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||a.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===ve.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===ve.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||Ms()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowUp"?-1:1,c=i.map(f=>f.setTop(f.top+a,!0)?f:null).filter(f=>f!=null);c.length>0&&n.replaceSnapshot("top",c);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowLeft"?-1:1,c=i.map(f=>f.setLeft(f.left+a,!0)?f:null).filter(f=>f!=null);c.length>0&&n.replaceSnapshot("left",c);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const a=n.doc.pages.reduce((c,f)=>c.concat(f.children),[]);return n.multiSelectElements(a)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const a=t();for(const c of i)c.setLeft(c.left+8),c.setTop(c.top+8),a.append(c);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const kn="openprint:element,";function Gg(n){function e(){return navigator.clipboard.readText().catch(a=>(console.log(a),null))}function t(a){return navigator.clipboard.writeText(a).catch(c=>{console.log(c)})}async function l(){const a=await e();if(a==null||!a.startsWith(kn))return[];t("");const c=Bn(qs(a.slice(kn.length)),[]);return c.length===0?[]:c.map(f=>(delete f.id,ue.create(f))).sort(ue.sort)}function o(a){const c=`${kn}${xs(JSON.stringify(a))}`;return t(c)}async function s(){const a=await e();return typeof a=="string"&&a.startsWith(kn)}function r(){}function i(a){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const ss=Symbol();function Wg(){return{panel:{left:!0,right:!0},scale:100,selectedType:ve.NONE,selectedPage:void 0,selectMode:ct.SINGLE,selected:[]}}function Xg(n,e){const t=xe(Wg()),l=Vg(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:a,selectPage:p,selectElement:h,resetSelectedElement:y,deleteSelectedElement:_,multiSelectElements:d,toggleMultiSelectedElement:v,isSingleSelectedElement:O,isNoSelectedElement:B,zoomIn:N,zoomOut:T,toggleBackground:A,toggleElementPanel:$,toggleConfigPanel:I,getSelectedElements:c,getSelectedPage:f,cleanup:M,replaceSnapshot:w},r=Mg(s),i=Ug(s);s.shortcut=Hg(s),s.createSnapshot=l.createSnapshot,s.clipboard=Gg();function a(D){s.document.value=D,s.history.createSnapshot()}function c(D){if(s.state.selectedType!==ve.ELEMENT)return[];const q=t.selected;if(q.length==0)return[];const x=q.map(S=>s.doc.findElement(S)).filter(S=>S!=null);return D==null?x:x.filter(S=>D.contains(S))}function f(){var q;const D=t.selectedPage;if(D!=null)return(q=n.value)==null?void 0:q.findPage(D)}function p(D){return y(),t.selectedPage=D.id,t.selectedType=ve.PAGE,!0}function h(D){t.selectMode=ct.SINGLE,t.selectedType=ve.ELEMENT,t.selectedPage=void 0;const q=c();for(const x of q)x.id!==D.id&&x.blur();return D.focus(),t.selected=[D.id],!0}function y(){const D=c();for(const q of D)q.blur();return t.selected=[],t.selectedType=ve.NONE,!0}function _(){if(t.selectedType!=ve.ELEMENT||t.selected.length==0)return!1;let D=!1;const q=c();for(const x of q)x.remove()&&(D=!0);return D&&s.history.createSnapshot(),!0}function d(D){t.selectMode=ct.MULTIPLE,t.selectedType=ve.ELEMENT,t.selectedPage=void 0;const q=c(),x=[];for(const S of q){if(D.some(R=>R.id===S.id)){x.push(S.id);continue}S.blur()}for(const S of D)x.includes(S.id)||S.focus();return t.selected=D.map(S=>S.id),!0}function v(D){let q=c();const x=q.findIndex(S=>S.id===D.id);return(D.type===G.TABLE_CELL&&q.some(S=>S.type!==G.TABLE_CELL)||D.type!==G.TABLE_CELL&&q.some(S=>S.type===G.TABLE_CELL))&&(q=[]),x>=0?q.splice(x,1):q.push(D),d(q)}function T(){const D=t.scale??100,q=rn.indexOf(D);return q<0?(t.scale=100,!1):q>=rn.length-1?!1:(t.scale=rn[q+1],!0)}function N(){const D=t.scale??100,q=rn.indexOf(D);return q<0?(t.scale=100,!1):q==0?!1:(t.scale=rn[q-1],!0)}function A(){const q=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=q}function $(){s.state.panel.left=!s.state.panel.left}function I(){s.state.panel.right=!s.state.panel.right}function w(D,q){const x=q??s.doc,S=Array.isArray(x)?"element":x instanceof Te?"document":x instanceof At?"page":"element",R=Array.isArray(x)?x.map(z=>z.id).join(","):x.id,C=`${S}:${R}:${D}`;return l.replaceSnapshot({action:C})}function O(){return s.state.selectedType!==ve.ELEMENT?!1:s.state.selectMode==ct.SINGLE||s.state.selectMode==ct.MULTIPLE&&s.state.selected.length==1}function B(){return s.state.selectedType!==ve.ELEMENT?!0:s.state.selected.length==0}function M(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),bo(ss,s),Hn(M),s}function ke(){return vo(ss)}const Yg=P({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Ie("classes"),l=ke(),o=k(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=k(()=>{const d=e.page.id,v=l.doc.pages.find(T=>T.id===d);return v==null?0:e.direction=="horizontal"?v.width:v.height}),r=k(()=>{const d=s.value,v=[];for(let T=0;T<=d;T+=10)v.push(T/10);return v}),i=k(()=>{const d=s.value,v=[];for(let T=0;T<=d;T+=2.5)v.push(T);return v}),a=k(()=>{const d=l.getSelectedElements();return d.length==1?d[0]:null}),c=k(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),f=k(()=>{const d=a.value;if(d==null)return 0;if(d.type==="TableCell"){const v=d.parent;if(v==null)return 0;const T=v.parent;return v==null?0:T.top+v.offsetTop}if(d.type==="TableRow"){const v=d.parent;return v==null?0:v.top+d.offsetTop}return d.top}),p=k(()=>{const d=a.value;if(d==null)return 0;if(d.type==="TableCell"){const v=d.parent;if(v==null)return 0;const T=v.parent;return v==null?0:T.left+d.offsetLeft}if(d.type==="TableRow"){const v=d.parent;return v==null?0:v.left}return d.left});function h(d,v){return e.direction==="horizontal"?{left:d*(e.scale/100)+"mm",height:(v-2)%4==0?"8px":"4px"}:{top:d*(e.scale/100)+"mm",width:(v-2)%4==0?"8px":"4px"}}function y(d){return e.direction==="horizontal"?{left:d*(e.scale/100)+"cm"}:{top:d*(e.scale/100)+"cm"}}function _(d){return e.direction==="horizontal"?{left:p.value*(e.scale/100)+"px",width:d.width*(e.scale/100)+"px",height:"100%"}:{top:f.value*(e.scale/100)+"px",height:d.height*(e.scale/100)+"px",width:"100%"}}return(d,v)=>(E(),L("div",{class:m(o.value)},[u("div",{class:m(b(t).ruler),style:Z(c.value)},[a.value?(E(),L("div",{key:0,class:m(b(t).selected),style:Z(_(a.value))},null,6)):W("",!0),(E(!0),L(te,null,ce(i.value,(T,N)=>(E(),L("div",{key:T,class:m(b(t).scale),style:Z(h(T,N))},null,6))),128)),(E(!0),L(te,null,ce(r.value,T=>(E(),L("div",{class:m(b(t).number),style:Z(y(T))},J(T),7))),256))],6)],2))}}),jg="_horizontalRuler_170u5_2",Zg="_verticalRuler_170u5_15",Kg="_ruler_170u5_27",Jg="_scale_170u5_32",Qg="_number_170u5_46",eh="_selected_170u5_71",th={horizontalRuler:jg,verticalRuler:Zg,ruler:Kg,scale:Jg,number:Qg,selected:eh},nh={classes:th},Ql=F(Yg,[["__cssModules",nh]]),lh=["title"],wn=8,oh=P({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=Ie("classes"),s={},r=ke(),i=k(()=>({top:Math.round(t.top*t.zoom)+"px"}));function a(h){if(h.button!=0||t.disabled===!0)return;const y=h.target.closest("."+o.dragLine);y!=null&&(h.stopPropagation(),s.init=!1,s.target=y,s.parent=y.offsetParent,s.target.setPointerCapture(h.pointerId),window.addEventListener("pointermove",c),window.addEventListener("pointerup",f))}function c(h){h.preventDefault();const y=p(s.parent);let _=h.clientY-y.top;_<0&&(_=0),_>y.height&&(_=y.height),t.min>0&&_<t.min+wn&&(_=t.min+wn),t.max>0&&_>t.max-wn&&(_=t.max-wn),s.target.style.top=_/(r.state.scale/100)+"px",s.top=_,s.init=!0}function f(h){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(h.pointerId),window.removeEventListener("pointermove",c),window.removeEventListener("pointerup",f)}function p(h){return h instanceof HTMLElement?h.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(h,y)=>(E(),L("div",{class:m({[b(o).dragLine]:!0,[b(o).disabled]:n.disabled}),style:Z(i.value),onPointerdown:ae(a,["stop"]),title:n.title},null,46,lh))}}),sh="_dragLine_1m7rt_2",ih="_disabled_1m7rt_26",rh={dragLine:sh,disabled:ih},ah={classes:rh},eo=F(oh,[["__cssModules",ah]]),ch=P({__name:"Selection",setup(n,{expose:e}){const t=pe(),l=pe(),o=Vn("selectionRef"),s=pe(),r=ke();let i=[];function a(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function c(){const _=[],d=l.value;if(d==null)return _;const v=f(d);if(v.length==0)return _;const T=o.value;return v.forEach(N=>{if(!pi(N,T)){N.classList.remove(Q.SELECTED);return}const A=Reflect.get(N,et);A instanceof ue&&(N.classList.add(Q.SELECTED),_.push(A))}),_}function f(_){if(_.matches("."+Q.ELEMENT)){const d=Reflect.get(_,et);if(d&&d.type===G.TABLE)return _.querySelectorAll(":scope td")}return _.querySelectorAll(`:scope .${Q.PAGE} > .${Q.SELECTABLE}`)}function p(_,d){const v=d.closest("."+Q.PAPER);if(v==null)return;_.stopPropagation(),_.preventDefault();const T=a(),N=v.getBoundingClientRect();T.initialX=_.clientX,T.initialY=_.clientY,T.top=_.clientY-N.top,T.left=_.clientX-N.left,l.value=d,s.value=T,t.value=v,i=[],window.addEventListener("pointermove",h),window.addEventListener("pointerup",y)}function h(_){const d=s.value;if(d==null)return;_.stopPropagation(),_.preventDefault();const v=o.value;if(d.init!==!0){if(Math.abs(_.clientX-d.initialX)<4&&Math.abs(_.clientY-d.initialY)<4)return;v.setPointerCapture(_.pointerId),v.style.display="block",d.init=!0}const T=Math.abs(_.clientX-d.initialX),N=Math.abs(_.clientY-d.initialY),A=_.clientX<d.initialX?-T:0,$=_.clientY<d.initialY?-N:0;v.style.top=d.top+$+"px",v.style.left=d.left+A+"px",v.style.width=T+"px",v.style.height=N+"px",i=c()}function y(_){const d=s.value;if(d==null)return;d.init&&(_.stopPropagation(),_.preventDefault()),i.length>0&&r.multiSelectElements(i);const v=o.value;v.releasePointerCapture(_.pointerId),v.style.display="none",s.value=void 0,window.removeEventListener("pointermove",h),window.removeEventListener("pointerup",y)}return e({onSelectStart:p}),(_,d)=>(E(),L("div",{ref_key:"selectionRef",ref:o,class:m(_.classes.selection),onClick:d[0]||(d[0]=ae(()=>{},["stop"]))},null,2))}}),uh="_selection_10jfe_2",dh={selection:uh},ph={classes:dh},fh=F(ch,[["__cssModules",ph]]);function mh(n,e,t){e.element.isSelected||t.selectElement(e.element);const l=t.getSelectedElements();if(l.length<=1){const a=Wl(e.element.type);if(typeof a!="function")return mt.open(n.clientX,n.clientY,{menus:to(e,t)});const f=a(e.element).map(p=>xn(p,t,[e.element],e.element)).filter(p=>p!=null);return mt.open(n.clientX,n.clientY,{menus:f})}if(new Set(l.map(a=>a.type)).size>1){const c=["copy","delete","---","z-index"].map(f=>xn(f,t,l,e.element)).filter(f=>f!=null);return mt.open(n.clientX,n.clientY,{menus:c})}const s=Wl(e.element.type);if(typeof s!="function")return mt.open(n.clientX,n.clientY,{menus:to(e,t)});const i=s(e.element).map(a=>xn(a,t,l,e.element)).filter(a=>a!=null);return mt.open(n.clientX,n.clientY,{menus:i})}function to(n,e){return["setting","text-direction","---","copy","delete","---","z-index"].map(l=>xn(l,e,e.getSelectedElements(),n.element)).filter(l=>l!=null)}function gh(n){const e=document.querySelector("#"+n.id);if(e==null)return!1;const t=e.querySelector("img,svg");if(t==null)return!1;const l=t.getBoundingClientRect(),o=se.processLengthToPX(Y(n,"top"))??1,s=se.processLengthToPX(Y(n,"bottom"))??1,r=se.processLengthToPX(Y(n,"left"))??1,i=se.processLengthToPX(Y(n,"right"))??1,a=se.processLengthToPX(n.getStyle("paddingTop"))??0,c=se.processLengthToPX(n.getStyle("paddingBottom"))??0,f=se.processLengthToPX(n.getStyle("paddingLeft"))??0,p=se.processLengthToPX(n.getStyle("paddingRight"))??0;return n.setWidth(l.width+r+i+f+p,!0),n.setHeight(l.height+o+s+a+c,!0),!0}function xn(n,e,t,l){if(typeof n!="string")return n;switch(n){case"---":case"divider":return{type:"divider"};case"copy":return{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){e.clipboard.writeElement(t)}};case"delete":return{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){t.forEach(o=>o.remove()),e.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){t.forEach(o=>o.resetDS()),e.createSnapshot()}}]};case"z-index":return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){for(const o of t)o.id!==l.id&&o.moveToTop();l.moveToTop(),e.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){t.forEach(o=>o.moveUp()),e.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){t.forEach(o=>o.moveDown()),e.createSnapshot()}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){t.forEach(o=>o.moveToBottom()),e.createSnapshot()}}]};case"setting":return{type:"menu",label:"元素属性",icon:"icon-setting",handler(){Lf(t).then(o=>{for(const s of t)s.style=Object.assign({},s.style,o.style);e.createSnapshot()}).catch(we)}};case"text-direction":return{type:"menu",label:"文字方向",icon:"icon-text-direction",handler(){Yo(t).then(o=>{for(const s of t)s.style=Object.assign({},s.style,o.style);e.createSnapshot()}).catch(we)}};case"qrcode-setting":return{type:"menu",label:"二维码属性",icon:"icon-qrcode",handler(){Cf(t).then(o=>{var s;for(const r of t)r.style=Object.assign({},r.style,o.style),r.attributes.barcolor=(s=o.qrcode)==null?void 0:s.barcolor;e.createSnapshot()}).catch(we)}};case"barcode-setting":return{type:"menu",label:"条形码属性",icon:"icon-barcode",handler(){If(t).then(o=>{var s,r,i;for(const a of t)a.style=Object.assign({},a.style,o.style),a.attributes.barcolor=(s=o.barcode)==null?void 0:s.barcolor,a.attributes.width=(r=o.barcode)==null?void 0:r.width,a.attributes.height=(i=o.barcode)==null?void 0:i.height;e.createSnapshot()}).catch(we)}};case"auto-resize":return{type:"menu",label:"自动调整尺寸",icon:"icon-resize",handler(){t.map(s=>gh(s)).some(Boolean)&&e.createSnapshot()}};default:return null}}const hh=P({props:{element:{type:ue,required:!0}},setup(n){const e=Ie("classes"),t=ke(),l=k(()=>{n.element.state.key;const p=n.element,h={"--quickprint-element-top":p.top+"px","--quickprint-element-left":p.left+"px","--quickprint-element-width":p.width+"px","--quickprint-element-height":p.height+"px","z-index":p.zIndex};return r()&&(h.transform=`rotate(${p.style.rotate}deg)`),h}),o={TOP:[e.resizeTop,Ft.TOP],BOTTOM:[e.resizeBottom,Ft.BOTTOM],LEFT:[e.resizeLeft,Ft.LEFT],RIGHT:[e.resizeRight,Ft.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Ft.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const p=n.element;return p.style.rotate==0||p.style.rotate==null?!1:t.state.selectMode===ct.SINGLE?!p.isSelected:!0}function i(p){const h=hg(p.type);if(h==null)return g("div",{class:e.unknown},[g("span",null,[fe("未知的打印元素")])]);const y={element:p,key:p.id+"_"+p.state.key};return yg(p.type)?(y.onContextmenu=c,Je(h,y)):Je(h,y)}function a(p,h){h.stopPropagation();const y=h.target.closest("."+Q.ELEMENT);y&&Reflect.get(y,Gn)===Rl.DRAG_ELEMENT||(h.ctrlKey?t.toggleMultiSelectedElement(p):t.selectElement(p))}function c(p){p.stopPropagation(),p.preventDefault(),mh(p,n,t)}function f(){return!_g(n.element.type)||r()?null:s.map(p=>{const h={class:[Q.RESIZEABLE_INDICATOR,p[0]],["."+To]:p[1]};return g("div",Xs(h,{onPointerdown:t.onResizeStart}),null)})}return function(){const p=n.element,h={["."+et]:p,["."+Sl]:p.type,id:p.id,key:p.id,class:{[Q.ELEMENT]:!0,[Q.DRAGGABLE]:!0,[Q.RESIZEABLE]:!0,[Q.SELECTED]:p.state.selected,[Q.SELECTABLE]:bg(p.type),["quickprint-is-"+p.type.toLowerCase()]:!0},style:l.value,onClick:a.bind(null,p)};return g("div",h,[i(p),f()])}}}),vh="_unknown_za8zh_2",bh="_resizeTop_za8zh_12",yh="_resizeBottom_za8zh_20",_h="_resizeLeft_za8zh_28",Eh="_resizeRight_za8zh_36",Th="_resizeBottomRight_za8zh_44",Sh={unknown:vh,resizeTop:bh,resizeBottom:yh,resizeLeft:_h,resizeRight:Eh,resizeBottomRight:Th},Rh={classes:Sh},kh=F(hh,[["__cssModules",Rh]]),is=ro(()=>ao(()=>import("./component-D1r_2N_-.js"),__vite__mapDeps([2,3,1,4,5]))),wh=P({__name:"DocJson",props:{doc:{type:Te,required:!0}},setup(n){const e=n,t=tt(),l=he(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(E(),ee(b(is),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),Lh="_json_9crpe_2",Ch={json:Lh},Ih={classes:Ch},Oh=F(wh,[["__cssModules",Ih]]),Nh=Ce(function(n){return ut("调试",g(Oh,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(rt)});async function Dh(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+Q.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const a=r.getBoundingClientRect(),c=n.clientX-a.left-i[0].left,f=n.clientY-a.top-i[0].top;for(const p of i)p.setLeft(p.left+c),p.setTop(p.top+f),e.page.append(p);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){Nh(t).then(r=>{if(r==null)return;const i=Te.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),mt.open(n.clientX,n.clientY,{menus:l})}const Mh=P({props:{doc:{type:Te,required:!0},page:{type:At,required:!0}},setup(n){const e=Ie("classes"),t=ke(),l=Vn("selectionRef"),o=Vn("paperRef"),s=he(0),r=k(()=>n.page.width),i=k(()=>n.page.height);function a(N){N.stopPropagation();const A=N.target.closest("."+Q.PAPER);A&&Reflect.get(A,Gn)===Rl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function c(){if(n.page.header.display===!1)return null;const N=n.page.header.height,A="page_header_"+s.value;return g(eo,{title:"页眉",top:N,onMove:p,key:A},null)}function f(){if(n.page.footer.display===!1)return null;const N=se.mm_to_px(i.value)-n.page.footer.height,A="page_footer_"+s.value;return g(eo,{title:"页脚",top:N,onMove:h,key:A},null)}function p(N){n.page.setHeaderHeight(N.top),s.value++}function h(N){n.page.setFooterHeight(se.mm_to_px(i.value)-N.top),s.value++}function y(N){N.stopPropagation(),N.preventDefault(),Dh(N,n,t)}function _(){const N=n.doc.margins;if(N==null)return null;const A=[];return N.top&&A.push(g("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:N.top}},null)),N.bottom&&A.push(g("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:N.bottom}},null)),N.left&&A.push(g("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:N.left}},null)),N.right&&A.push(g("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:N.right}},null)),A.length>0?A:null}function d(){const N={["."+Eo]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[Q.PAGE]:!0,[Q.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:y},A=n.page.children.map($=>g(kh,{element:$},null));return g("div",N,[c(),A,f(),_()])}function v(N){if(N.button!==0)return;N.stopPropagation(),N.preventDefault();const $=N.target.closest("."+Q.ELEMENT);if($==null)return T(N,o.value);const I=Reflect.get($,et);return I==null?T(N,o.value):I.type===G.TABLE?T(N,$):Eg(I.type)?t.onDragStart(N):T(N,o.value)}function T(N,A){var $;($=l.value)==null||$.onSelectStart(N,A)}return function(){const N=t.state.scale/100,A={id:"@"+n.page.id,ref:"paperRef",class:{[Q.PAPER]:!0,[Q.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*N+"mm",height:i.value*N+"mm"},onPointerdown:v,onClick:a};return g("div",A,[d(),g(fh,{ref:"selectionRef"},null)])}}}),xh="_paper_1eq2b_2",qh="_grid_1eq2b_12",$h="_marginHorizontalGuide_1eq2b_19",Ah="_marginVerticalGuide_1eq2b_27",Bh={paper:xh,grid:qh,marginHorizontalGuide:$h,marginVerticalGuide:Ah},Ph={classes:Bh},Vh=F(Mh,[["__cssModules",Ph]]),zh={class:"quickprint-is-fill-h quickprint-is-scrollable"},Fh="icon-zhanweifu",Uh=P({__name:"Element",setup(n){const e=ke();return(t,l)=>(E(),L("div",{class:m(t.classes.panel)},[u("div",{class:m(t.classes.header)},"可打印元素",2),u("div",zh,[u("div",{class:m(t.classes.grid)},[(E(!0),L(te,null,ce(b(pg),o=>(E(),L("div",yo({key:o.type,class:[b(Q).DRAGGABLE,t.classes.element],[`.${b(_o)||""}`]:b(Ue).INSERT,[`.${b(Sl)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>b(e).onDragStart&&b(e).onDragStart(...s))}),[g(b(H),{icon:o.icon??Fh,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),u("span",null,J(o.title),1)],48))),128))],2)])],2))}}),Hh="_panel_1p36j_2",Gh="_header_1p36j_8",Wh="_grid_1p36j_18",Xh="_element_1p36j_30",Yh="_icon_1p36j_45",jh={panel:Hh,header:Gh,grid:Wh,element:Xh,icon:Yh},Zh={classes:jh},Kh=F(Uh,[["__cssModules",Zh]]),Jh=["onClick"],Qh=P({__name:"SelectPath",setup(n){const e=ke(),t=k(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===ve.PAGE){const i=e.getSelectedPage();if(i!=null){const a="页面"+(i.index+1);r.push({id:i.id,title:a,type:"page",data:i})}return r}if(s.selectedType===ve.ELEMENT){if(s.selectMode===ct.MULTIPLE){const c=e.getSelectedElements();if(c.length===0)return r;let f=c[0];for(;f.parent;){const p=f.parent;if(p instanceof At){const h="页面"+(p.index+1);return r.push({id:p.id,title:h,type:"page",data:p}),r}f=p}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const a=[{id:i.id,title:yn(i.type),type:"element",data:i}];for(;i.parent;){const c=i.parent;if(c instanceof At){const f="页面"+(c.index+1);return a.unshift({id:c.id,title:f,type:"page",data:c}),r.concat(a)}a.unshift({id:c.id,title:yn(c.type),type:"element",data:c}),i=c}}return r}),l=k(()=>{if(e.state.selectedType!=ve.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],a=Yn(i);if(!(a==null||!a.content))return a.type===ye.VARIABLE||a.type===ye.FORMULA?`[${a.content}]`:a.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(E(),L("div",{class:m(s.classes.paths)},[(E(!0),L(te,null,ce(t.value,(i,a)=>(E(),L(te,{key:i.id},[a>0?(E(),ee(b(H),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):W("",!0),u("div",{class:m(s.classes.path),onClick:c=>o(i)},J(i.title),11,Jh)],64))),128)),l.value?(E(),L(te,{key:0},[g(b(H),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),u("div",{class:m(s.classes.content)},J(l.value),3)],64)):W("",!0)],2))}}),ev="_paths_fuk62_2",tv="_path_fuk62_2",nv="_icon_fuk62_28",lv="_content_fuk62_33",ov={paths:ev,path:tv,icon:nv,content:lv},sv={classes:ov},iv=F(Qh,[["__cssModules",sv]]),rv=["min","readonly","placeholder"],av=P({__name:"LabelNumber",props:Bt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=_n(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const a=e.min?e.min:e.defaultValue;t.value=a;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const a=Math.pow(10,e.precision);t.value=Math.round(i*a)/a}}return(o,s)=>(E(),L("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[Le(u("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),step:"any",min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,rv),[[Be,t.value]]),u("span",{class:m(o.classes.label)},J(n.label),3)],2))}}),cv="_labelNumber_1aifb_2",uv="_label_1aifb_2",dv="_readonly_1aifb_25",pv={labelNumber:cv,label:uv,readonly:dv},fv={classes:pv},Gt=F(av,[["__cssModules",fv]]),mv={class:"quickprint-config"},gv={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},hv={class:"quickprint-config-group"},vv={class:"quickprint-config-section quickprint-config-inline"},bv={class:"quickprint-config-content quickprint-config-inline"},yv={class:"quickprint-config-group"},_v={class:"quickprint-config-section quickprint-config-inline"},Ev={class:"quickprint-config-content quickprint-config-inline"},Tv={class:"quickprint-config-section quickprint-config-inline"},Sv={class:"quickprint-config-content quickprint-form-inline"},Rv={class:"quickprint-config-group"},kv={class:"quickprint-config-section quickprint-config-inline"},wv={class:"quickprint-config-content quickprint-form-inline"},Lv={key:0,class:"quickprint-config-section quickprint-config-inline"},Cv={class:"quickprint-config-content quickprint-form-inline"},Iv={class:"quickprint-config-section quickprint-config-inline"},Ov={class:"quickprint-config-content quickprint-form-inline"},Nv=P({__name:"PageConfig",props:{page:{type:At,required:!0}},setup(n){const e=n,t=ke(),l=[{label:"显示",value:!0},{label:"隐藏",value:!1}],o=[{label:"禁止",value:Sn.NONE},{label:"跟随表格",value:Sn.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],s=k({get(){return e.page.size.type},set(f){e.page.size.type!==f&&(e.page.size.type=f,f===mn.CONTENT&&(e.page.size.orientation=void 0),t.createSnapshot())}}),r=k({get(){return e.page.orientation},set(f){e.page.size.orientation!==f&&(e.page.size.orientation=f,t.createSnapshot())}}),i=k(()=>e.page.width),a=k({get(){return e.page.height},set(f){if(e.page.size.height===f)return;const p=Number(f);!uo(p)||p<0||(e.page.size.height=p,t.createSnapshot())}}),c=k({get(){return e.page.footer.flow??Sn.NONE},set(f){e.page.footer.flow!==f&&(e.page.footer.flow=f===Sn.NONE?void 0:f,t.createSnapshot())}});return(f,p)=>(E(),L("div",mv,[p[15]||(p[15]=u("div",{class:"quickprint-config-title"},"页面配置",-1)),u("div",gv,[u("div",hv,[p[7]||(p[7]=u("div",{class:"quickprint-config-group-title"},"页眉",-1)),u("section",vv,[p[6]||(p[6]=u("header",{class:"quickprint-config-header"},"位置",-1)),u("div",bv,[g(Gt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),g(xt,{modelValue:n.page.header.display,"onUpdate:modelValue":p[0]||(p[0]=h=>n.page.header.display=h),options:l,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),u("div",yv,[p[10]||(p[10]=u("div",{class:"quickprint-config-group-title"},"页脚",-1)),u("section",_v,[p[8]||(p[8]=u("header",{class:"quickprint-config-header"},"位置",-1)),u("div",Ev,[g(Gt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),g(xt,{modelValue:n.page.footer.display,"onUpdate:modelValue":p[1]||(p[1]=h=>n.page.footer.display=h),options:l,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),u("section",Tv,[p[9]||(p[9]=u("header",{class:"quickprint-config-header"},"跟随",-1)),u("div",Sv,[g(b(le),{modelValue:c.value,"onUpdate:modelValue":p[2]||(p[2]=h=>c.value=h),options:o},null,8,["modelValue"])])])]),u("div",Rv,[p[14]||(p[14]=u("div",{class:"quickprint-config-group-title"},"画布",-1)),u("section",kv,[p[11]||(p[11]=u("header",{class:"quickprint-config-header"},"尺寸",-1)),u("div",wv,[g(xt,{modelValue:s.value,"onUpdate:modelValue":p[3]||(p[3]=h=>s.value=h),options:b(li),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===b(mn).CONTENT?(E(),L("section",Lv,[p[12]||(p[12]=u("header",{class:"quickprint-config-header"},"内容",-1)),u("div",Cv,[g(Gt,{class:"quickprint-form-inline-item",label:"宽",modelValue:i.value,readonly:""},null,8,["modelValue"]),g(Gt,{class:"quickprint-form-inline-item",label:"高",modelValue:a.value,"onUpdate:modelValue":p[4]||(p[4]=h=>a.value=h)},null,8,["modelValue"])])])):W("",!0),u("section",Iv,[p[13]||(p[13]=u("header",{class:"quickprint-config-header"},"方向",-1)),u("div",Ov,[g(xt,{modelValue:r.value,"onUpdate:modelValue":p[5]||(p[5]=h=>r.value=h),class:"quickprint-w-full",options:b(ko),disabled:n.page.size.type===b(mn).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),Dv=["value","placeholder","disabled"],Mv=P({__name:"InputWithLabel",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=Vn("inputRef"),s=k({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?se.px_to_mm(t.modelValue):t.standard==="mm"&&t.target==="px"?se.mm_to_px(t.modelValue):0},set(f){if(!t.disabled){if(t.standard===t.target)return l("update:modelValue",f);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",se.mm_to_px(f));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",se.px_to_mm(f))}}}),r=k(()=>t.disabled!==!0&&t.clearable&&s.value!=null);function i(f){if(t.disabled)return;const h=f.target.value;if(s==null||h===""){if(t.clearable)return;const _=t.min?t.min:t.defaultValue;s.value=_;return}const y=Number(h);if(!Number.isNaN(y)){if(t.min!=null&&y<t.min){s.value=t.min;return}if(t.standard==="px"){s.value=Math.round(y);return}s.value=y}}function a(){t.disabled||l("update:modelValue",void 0)}function c(){var f;t.disabled||((f=o.value)==null||f.blur(),setTimeout(()=>{var p;return(p=o.value)==null?void 0:p.focus()},50))}return(f,p)=>(E(),L("label",{class:m({[f.classes.inputWithLabel]:!0,[f.classes.withClear]:n.clearable})},[u("span",{class:m(f.classes.label)},J(n.label),3),u("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",step:"any",value:s.value,placeholder:n.placeholder,disabled:n.disabled,onBlur:i,onKeydown:ho(c,["enter"])},null,40,Dv),r.value?(E(),L("span",{key:0,class:m(f.classes.clearBtn),onClick:ae(a,["stop"])},[g(b(H),{icon:"icon-close",size:"11px"})],2)):W("",!0)],2))}}),xv="_inputWithLabel_1k5y2_2",qv="_clearBtn_1k5y2_7",$v="_label_1k5y2_11",Av="_withClear_1k5y2_31",Bv={inputWithLabel:xv,clearBtn:qv,label:$v,withClear:Av},Pv={classes:Bv},Ln=F(Mv,[["__cssModules",Pv]]),Vv=P({__name:"UnitSelect",props:Bt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=_n(n,"modelValue"),o=k(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(E(),L("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[g(b(le),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:Re(()=>[u("span",{class:m(s.classes.text)},J(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),zv="_unit_135mn_2",Fv="_text_135mn_8",Uv="_select_135mn_25",Hv={unit:zv,text:Fv,select:Uv},Gv={classes:Hv},Wv=F(Vv,[["__cssModules",Gv]]),Xv=P({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=he(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch($s)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(E(),L("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[g(b(H),{icon:"icon-copy"}),g(Ys,{name:"quickprint-fade"},{default:Re(()=>[l.value?(E(),L("span",{key:0,class:m(s.classes.message)},"已复制",2)):W("",!0)]),_:1})],2))}}),Yv="_btn_v9scw_2",jv="_message_v9scw_6",Zv={btn:Yv,message:jv},Kv={classes:Zv},Jv=F(Xv,[["__cssModules",Kv]]),Qv=P({__name:"window",props:{code:{type:String,default:""},doc:{type:Te,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=tt(),l=he(e.code),o=pe();function s(){return l.value}function r(){e.doc!=null&&qc({doc:e.doc}).then(p=>{var y;if(p==null)return;const h=p.type=="reference"?`[=${p.value}]`:`[${p.value}]`;(y=o.value)==null||y.insert(h)})}function i(p){var h;return dt(p,(h=e.doc)==null?void 0:h.ds)}function a(){var p;(p=o.value)==null||p.insert(`[2.6.${_l.ELEMENT_VALUR}]`)}function c(){$c().then(p=>{var h;p!=null&&((h=o.value)==null||h.insert(p.value))})}function f(){Ac({doc:e.doc}).then(p=>{var h;p!=null&&((h=o.value)==null||h.insert(p.value))})}return t==null||t.useHandle("confirm",s),(p,h)=>(E(),L("div",{class:m(p.classes.window)},[n.mode!=="code"?(E(),L("div",{key:0,class:m(p.classes.toolbar)},[n.mode=="condition"?(E(),L(te,{key:0},[u("button",{type:"button",class:"quickprint-text-btn",onClick:a},[g(b(H),{icon:"icon-number-sign"}),h[1]||(h[1]=u("span",null,"插入元素值",-1))]),u("div",{class:m(p.classes.divider)},null,2)],64)):W("",!0),u("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[g(b(H),{icon:"icon-insert-var"}),h[2]||(h[2]=u("span",null,"插入变量",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:c},[g(b(H),{icon:"icon-function"}),h[3]||(h[3]=u("span",null,"插入函数",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:f},[g(b(H),{icon:"icon-formula"}),h[4]||(h[4]=u("span",null,"插入公式",-1))])],2)):W("",!0),g(b(is),{modelValue:l.value,"onUpdate:modelValue":h[0]||(h[0]=y=>l.value=y),language:"javascript",class:m(p.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),eb="_window_n935p_2",tb="_toolbar_n935p_11",nb="_code_n935p_22",lb="_divider_n935p_27",ob={window:eb,toolbar:tb,code:nb,divider:lb},sb={classes:ob},rs=F(Qv,[["__cssModules",sb]]),as=Ce(function(n){return ut("公式",g(rs,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(we)}),ib=Ce(function(n,e){return ut(n,g(rs,{code:e},null),{preset:"editor"}).promisify().catch(we)}),rb={class:"quickprint-config-section quickprint-config-inline"},ab={class:"quickprint-config-content"},cb=["value"],ub=P({__name:"Visibility",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??Mt.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==Mt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=k({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=k(()=>{var i;return wl((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=k(()=>{var i;return t.value!==Mt.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${_l.ELEMENT_VALUR}]`;as({code:i,doc:e.element.doc,mode:"condition"}).then(a=>{a!=null&&(l.value=a)})}return(i,a)=>(E(),L(te,null,[u("section",rb,[a[1]||(a[1]=u("header",{class:"quickprint-config-header"},"可见性",-1)),u("div",ab,[g(b(le),{class:"quickprint-w-full",options:b(Ks),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=c=>t.value=c)},null,8,["options","modelValue"])])]),t.value===b(Mt).CONDITION?(E(),L("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[u("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,cb),s.value?(E(),ee(b(H),{key:0,icon:"icon-open-new",size:"14px"})):W("",!0)],2)):W("",!0)],64))}}),db="_condition_siopf_2",pb={condition:db},fb={classes:pb},mb=F(ub,[["__cssModules",fb]]);function gb(n,e){return k({get(){return n.element.attributes.position??qn.DEFAULT},set(t){if(n.element.attributes.position===t)return;const l=t===qn.DEFAULT?void 0:t;n.element.attributes.position=l,e.createSnapshot()}})}function hb(n,e){return k({get(){return n.element.attributes.printMode??$n.ONCE},set(t){if(n.element.attributes.printMode===t)return;const l=t===$n.ONCE?void 0:t;n.element.attributes.printMode=l,e.createSnapshot()}})}function vb(n,e){return k({get(){return n.element.attributes.overflow??gn.HIDDEN},set(t){if(n.element.attributes.overflow===t)return;const l=t===gn.HIDDEN?void 0:t;n.element.attributes.overflow=l,e.createSnapshot()}})}function bb(n,e){return k({get(){const t=n.element;return t.type!==G.TABLE_CELL?n.element.width:t.hasColSpan?t.offsetWidth:t.width},set(t){n.element.width!==t&&(n.element.setWidth(t,!0),e.createSnapshot())}})}function yb(n,e){return k({get(){const t=n.element;return t.type!==G.TABLE_CELL?n.element.height:t.hasRowSpan?t.offsetHeight:t.height},set(t){n.element.height!==t&&(n.element.setHeight(t,!0),e.createSnapshot())}})}function _b(n,e){return k({get(){return n.element.attributes.display},set(t){n.element.attributes.display!==t&&(n.element.attributes.display=t??void 0,e.createSnapshot())}})}function Eb(n,e){return k({get(){return n.element.ds.type},set(t){n.element.ds.type!==t&&(n.element.ds.type=t,n.element.ds.value=void 0,e.createSnapshot())}})}const Tb=P({__name:"ImageUpload",emits:["upload"],setup(n,{emit:e}){const t=e,l=pe();function o(){const r=l.value;r!=null&&(r.value="",r.click())}function s(r){var f;const i=r.target;if(i==null)return;const a=(f=i.files)==null?void 0:f[0];if(a==null)return;const c=new FileReader;c.readAsDataURL(a),c.onload=function(p){var y;const h=(y=p.target)==null?void 0:y.result;typeof h=="string"&&t("upload",h)}}return(r,i)=>(E(),L("div",{class:m(r.classes.upload)},[u("button",{type:"button",onClick:o,class:"quickprint-text-btn"},[g(b(H),{icon:"icon-upload"}),i[0]||(i[0]=u("span",null,"上传本地图片",-1))]),u("input",{type:"file",ref_key:"inputRef",ref:l,onChange:s,accept:"image/*",class:m(r.classes.input)},null,34)],2))}}),Sb="_upload_1tbfz_2",Rb="_input_1tbfz_9",kb={upload:Sb,input:Rb},wb={classes:kb},Lb=F(Tb,[["__cssModules",wb]]),Cb=P({__name:"Const",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k(()=>e.element.type===G.IMAGE),l=k({get(){return e.element.ds.value},set(s){e.element.ds.value=s}});function o(s){l.value=s}return(s,r)=>(E(),L("div",{class:m(s.classes.const)},[Le(u("textarea",{"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"5",placeholder:"请输入"},null,512),[[Be,l.value]]),t.value?(E(),L("div",{key:0,class:m(s.classes.upload)},[g(Lb,{onUpload:o})],2)):W("",!0)],2))}}),Ib="_upload_bqfbo_6",Ob={const:"_const_bqfbo_2",upload:Ib},Nb={classes:Ob},Db=F(Cb,[["__cssModules",Nb]]),Mb={class:"quickprint-config-ds-var-type"},xb=["title"],qb=P({__name:"Variable",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=ke(),l=k(()=>de(e.element.ds.value)),o=k(()=>dt(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var f;const i=await Ll({doc:t.doc,value:e.element.ds.value}).catch(rt);if(i==null||(e.element.setDataSource(ye.VARIABLE,i.value),e.element.type!=G.TABLE_CELL||i.type!=="ds"))return;const a=e.element.parent;if(a==null||a.isBindVariable||((f=i.parent)==null?void 0:f.type)!==re.ARRAY)return;const c=i.parent;a.setDataSource(ye.VARIABLE,`${$t.DS}.${c.type}.${c.name}`)}return(i,a)=>(E(),L("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(E(),L(te,{key:0},[a[0]||(a[0]=u("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),g(b(H),{icon:"icon-open-new",size:"14px"})],64)):(E(),L(te,{key:1},[u("span",Mb,"<"+J(b(ma)(e.element.ds.value))+">",1),u("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},J(o.value),9,xb),u("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[g(b(H),{icon:"icon-close",size:"12px"})])],64))]))}}),$b=["value"],Ab=P({__name:"Code",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k(()=>de(e.element.ds.value));function l(){return ht(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){ib("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(E(),L("div",{onClick:o,class:m(s.classes.code)},[u("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,$b),t.value?(E(),ee(b(H),{key:0,icon:"icon-open-new",size:"14px"})):W("",!0)],2))}}),Bb="_code_1az68_2",Pb={code:Bb},Vb={classes:Pb},zb=F(Ab,[["__cssModules",Vb]]),Fb=["value"],Ub=P({__name:"Formula",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=ke(),l=k(()=>de(e.element.ds.value)),o=k(()=>wl(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;as({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(E(),L("div",{onClick:s,class:m(r.classes.code)},[u("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Fb),l.value?(E(),ee(b(H),{key:0,icon:"icon-open-new",size:"14px"})):W("",!0)],2))}}),Hb="_code_ipm2q_2",Gb={code:Hb},Wb={classes:Gb},Xb=F(Ub,[["__cssModules",Wb]]);function Yb(n){switch(n.ds.type){case ye.CONST:return g(Db,{element:n},null);case ye.VARIABLE:return g(qb,{element:n},null);case ye.CODE:return g(zb,{element:n},null);case ye.FORMULA:return g(Xb,{element:n},null);default:return null}}const jb=P({props:{element:{type:ue,required:!0}},setup(n){const e=ke(),t=k(()=>yn(n.element.type)),l=k(()=>ti.filter(w=>w.value!=n.element.type)),o=he("px"),s=bb(n,e),r=yb(n,e),i=vb(n,e),a=gb(n,e),c=hb(n,e),f=_b(n,e),p=Eb(n,e),h=k(()=>{const w=n.element;return w.type!==G.TABLE_CELL?!1:w.hasColSpan}),y=k(()=>{const w=n.element;return w.type!==G.TABLE_CELL?!1:w.hasRowSpan}),_=k(()=>{const w=n.element,O=w.parent;if(O===null||!(O instanceof At))return!1;const B=O.header;if(B.display&&w.bottom<=(B.height??0))return!1;const M=O.parent;if(M==null)return!1;const D=O.footer;return!(D.display&&w.top>=Math.floor(se.mm_to_px(M.paper.height))-(D.height??0))});function d(w,O){return O==null?!1:!!O.includes(w)}function v(){const w=cn(n.element.type);if(d(me.LAYOUT,w==null?void 0:w.exclude))return null;const O=n.element,B=d(me.COORD,w==null?void 0:w.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("位置")]),g("div",{class:"quickprint-config-content quickprint-form-inline"},[g(Ln,{class:"quickprint-form-inline-item",label:"左",modelValue:O.left,"onUpdate:modelValue":R=>O.left=R,target:o.value},null),g(Ln,{class:"quickprint-form-inline-item",label:"上",modelValue:O.top,"onUpdate:modelValue":R=>O.top=R,target:o.value},null)])]),M=d(me.SIZE)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[g("span",null,[fe("尺寸")])]),g("div",{class:"quickprint-config-content quickprint-form-inline"},[g(Ln,{class:"quickprint-form-inline-item",label:"宽",modelValue:s.value,"onUpdate:modelValue":R=>s.value=R,target:o.value,disabled:h.value},null),g(Ln,{class:"quickprint-form-inline-item",label:"高",modelValue:r.value,"onUpdate:modelValue":R=>r.value=R,target:o.value,disabled:y.value},null)])]),D=d(me.VISIBILITY,w==null?void 0:w.exclude)?null:g(mb,{element:O},null),q=d(me.OVERFLOW,w==null?void 0:w.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("溢出时")]),g("div",{class:"quickprint-config-content"},[g(le,{modelValue:i.value,"onUpdate:modelValue":R=>i.value=R,options:ii,class:"quickprint-w-full"},null)])]),x=d(me.PRINT_MODE,w==null?void 0:w.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("打印模式")]),g("div",{class:"quickprint-config-content"},[g(le,{modelValue:c.value,"onUpdate:modelValue":R=>c.value=R,options:si,class:"quickprint-w-full"},null)])]),S=d(me.POSITION,w==null?void 0:w.exclude)||!_.value?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("定位模式")]),g("div",{class:"quickprint-config-content"},[g(le,{modelValue:a.value,"onUpdate:modelValue":R=>a.value=R,options:oi,class:"quickprint-w-full"},null)])]);return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title quickprint-is-row"},[g("span",{class:"quickprint-is-fill-w"},[fe("布局")]),g("span",null,[fe("单位：")]),g(Wv,{modelValue:o.value,"onUpdate:modelValue":R=>o.value=R},null)]),B,M,D,q,x,S])}function T(){const w=cn(n.element.type);if(d(me.BASIC,w==null?void 0:w.exclude))return null;const O=n.element,B=d(me.PREFIX,w==null?void 0:w.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("前缀")]),g("div",{class:"quickprint-config-content"},[Le(g("input",{"onUpdate:modelValue":q=>O.attributes.prefix=q,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Be,O.attributes.prefix]])])]),M=d(me.SUFFIX,w==null?void 0:w.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("后缀")]),g("div",{class:"quickprint-config-content"},[Le(g("input",{"onUpdate:modelValue":q=>O.attributes.suffix=q,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Be,O.attributes.suffix]])])]),D=d(me.DISPLAY,w==null?void 0:w.exclude)?null:g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("数据类型")]),g("div",{class:"quickprint-config-content"},[g(le,{options:l.value,modelValue:f.value,"onUpdate:modelValue":q=>f.value=q,class:"quickprint-w-full"},null)])]);return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[fe("基础")]),B,M,D])}function N(){const w=cn(n.element.display);return(w==null?void 0:w.display)==null?null:Je(w.display,{element:n.element})}function A(){const w=cn(n.element.type);if(d(me.ATTRIBUTES,w==null?void 0:w.exclude))return null;const O=w!=null&&w.attributes?Je(w.attributes,{element:n.element}):null,B=N();if(O==null&&B==null)return null;const M=B!=null&&O!=null?g("div",{class:"quickprint-config-divider"},null):null;return g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[fe("属性")]),B,M,O])}function $(){const w=cn(n.element.type);return d(me.DATASOURCE,w==null?void 0:w.exclude)?null:g("div",{class:"quickprint-config-group"},[g("div",{class:"quickprint-config-group-title"},[fe("数据")]),g(le,{options:So,modelValue:p.value,"onUpdate:modelValue":O=>p.value=O},null),Yb(n.element)])}function I(w){w(n.element.id)}return function(){const O=n.element;return g("div",{class:"quickprint-config"},[g("div",{class:"quickprint-config-title"},[g("span",null,[t.value,fe("配置")]),null]),g("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[g("div",{class:"quickprint-config-group"},[g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("标识")]),g("div",{class:"quickprint-config-content"},[g("span",{class:"quickprint-config-id"},[O.id]),g(Jv,{onCopy:I},null)])]),g("section",{class:"quickprint-config-section quickprint-config-inline"},[g("header",{class:"quickprint-config-header"},[fe("标题")]),g("div",{class:"quickprint-config-content"},[Le(g("input",{type:"text","onUpdate:modelValue":B=>O.title=B,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Be,O.title]])])])]),v(),T(),A(),$()])])}}}),Zb=P({setup(){const n=ke(),e=Ie("classes");function t(){return g("div",{class:e.tip},[fe("未知的打印元素")])}function l(){return g("div",{class:e.tip},[fe("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return g(Nv,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(G).includes(i.type)===!1?t():Je(jb,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==ve.ELEMENT?!1:i.selectMode===ct.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),Kb="_tip_cdonk_2",Jb={tip:Kb},Qb={classes:Jb},ey=F(Zb,[["__cssModules",Qb]]);function nt(n,e){if(n.state.selectedType!==ve.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ge(n,e,t){if(n.state.selectedType!==ve.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function Ke(n,e){if(n.state.selectedType!==ve.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function ty(n){const e="underline";return k({get(){if(n.state.selectedType!==ve.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ge(n,e,t):Ke(n,e)}})}function ny(n){const e="lineThrough";return k({get(){if(n.state.selectedType!==ve.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ge(n,e,t):Ke(n,e)}})}function ly(n){const e="lineHeight";return k({get(){return nt(n,e)},set(t){t===It.DEFAULT?Ke(n,e):Ge(n,e,t)}})}function oy(n){const e="highlightColor";return k({get(){return nt(n,e)??ze.BLACK},set(t){t===""?Ke(n,e):Ge(n,e,t)}})}function sy(n){const e="backgroundColor";return k({get(){return nt(n,e)??ze.BLACK},set(t){t===""?Ke(n,e):Ge(n,e,t)}})}function iy(n){const e="fontStyle";return k({get(){return nt(n,e)===Dl.ITALIC},set(t){t?Ge(n,e,Dl.ITALIC):Ke(n,e)}})}function ry(n){const e="textAlign";return k({get(){return nt(n,e)??bt.LEFT},set(t){t===bt.LEFT?Ke(n,e):Ge(n,e,t)}})}function ay(n){const e="verticalAlign";return k({get(){return nt(n,e)??at.MIDDLE},set(t){t===at.MIDDLE?Ke(n,e):Ge(n,e,t)}})}function cy(n){const e="fontFamily";return k({get(){return nt(n,e)},set(t){t===ge.DEFAULT?Ke(n,e):Ge(n,e,t)}})}function uy(n){const e="fontSize";return k({get(){return nt(n,e)},set(t){t===Oe.DEFAULT?Ke(n,e):Ge(n,e,t)}})}function dy(n){const e="color";return k({get(){return nt(n,e)??ze.BLACK},set(t){Ge(n,e,t)}})}function py(n){const e="fontWeight";return k({get(){return nt(n,e)===700},set(t){t?Ge(n,e,700):Ke(n,e)}})}const fy=["title","onClick"],my=P({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=ke(),l=k(()=>{if(t.state.selectedType!==ve.ELEMENT)return null;const _=t.getSelectedElements();if(_.length!==1)return null;const d=_[0],v={};return Ee(d,"top")&&(v.borderTopStyle="solid"),Ee(d,"right")&&(v.borderRightStyle="solid"),Ee(d,"bottom")&&(v.borderBottomStyle="solid"),Ee(d,"left")&&(v.borderLeftStyle="solid"),v}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(y){if(t.state.selectedType!==ve.ELEMENT)return!1;const d=t.getSelectedElements();if(d.length!==1)return!1;const v=d[0];switch(y){case e.TOP:return Ee(v,"top");case e.RIGHT:return Ee(v,"right");case e.BOTTOM:return Ee(v,"bottom");case e.LEFT:return Ee(v,"left");case e.ALL:return Ee(v,"top")&&Ee(v,"right")&&Ee(v,"bottom")&&Ee(v,"left");default:return!1}}function r(y){if(t.state.selectedType!==ve.ELEMENT)return;const d=t.getSelectedElements();if(d.length!=0){switch(y){case e.TOP:return a(d);case e.BOTTOM:return f(d);case e.LEFT:return p(d);case e.RIGHT:return c(d);case e.ALL:return h(d)}t.createSnapshot()}}function i(){if(t.state.selectedType!==ve.ELEMENT)return;const _=t.getSelectedElements();if(_.length!=0){for(const d of _)d.setStyle("borderStyle",void 0),d.setStyle("borderTopStyle",void 0),d.setStyle("borderRightStyle",void 0),d.setStyle("borderBottomStyle",void 0),d.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function a(y){const _=!y.every(d=>Ee(d,"top"));for(const d of y)_?d.setStyle("borderTopStyle",ne.SOLID):d.removeStyle("borderTopStyle")}function c(y){const _=!y.every(d=>Ee(d,"right"));for(const d of y)_?d.setStyle("borderRightStyle",ne.SOLID):d.removeStyle("borderRightStyle")}function f(y){const _=!y.every(d=>Ee(d,"bottom"));for(const d of y)_?d.setStyle("borderBottomStyle",ne.SOLID):d.removeStyle("borderBottomStyle")}function p(y){const _=!y.every(d=>Ee(d,"left"));for(const d of y)_?d.setStyle("borderLeftStyle",ne.SOLID):d.removeStyle("borderLeftStyle")}function h(y){const _=!y.every(d=>Ee(d,"top")&&Ee(d,"right")&&Ee(d,"bottom")&&Ee(d,"left"));for(const d of y){if(_){d.setStyle("borderStyle",_?"solid":void 0);continue}d.removeStyle("borderStyle"),d.removeStyle("borderTopStyle"),d.removeStyle("borderRightStyle"),d.removeStyle("borderBottomStyle"),d.removeStyle("borderLeftStyle")}}return(y,_)=>(E(),ee(b(No),null,{popover:Re(()=>[u("div",{class:m(y.classes.popover)},[u("div",null,[(E(),L("button",{type:"button",title:"全部框线",key:b(e).ALL,class:m({"quickprint-text-btn":!0,[y.classes.tool]:!0,"quickprint-is-selected":s(b(e).ALL)}),onClick:_[0]||(_[0]=d=>r(b(e).ALL))},[g(b(H),{icon:"icon-border",size:"16px"})],2)),(E(),L("button",{type:"button",title:"无框线",key:b(e).NONE,class:m({"quickprint-text-btn":!0,[y.classes.tool]:!0}),onClick:i},[g(b(H),{icon:"icon-border-none",size:"16px"})],2))]),u("div",{class:m(y.classes.divider)},[(E(),L(te,null,ce(o,d=>u("button",{type:"button",title:d.label,key:d.value,class:m({"quickprint-text-btn":!0,[y.classes.tool]:!0,"quickprint-is-selected":s(d.value)}),onClick:v=>r(d.value)},[g(b(H),{icon:d.icon,size:"16px"},null,8,["icon"])],10,fy)),64))],2)],2)]),default:Re(()=>[u("div",{class:m(["quickprint-text-btn",y.classes.borderSelect]),title:"边框"},[u("div",{class:m({[y.classes.border]:!0}),style:Z(l.value)},null,6)],2)]),_:1}))}}),gy="_border_rprfx_2",hy="_borderSelect_rprfx_10",vy="_popover_rprfx_14",by="_divider_rprfx_18",yy={border:gy,borderSelect:hy,popover:vy,divider:by},_y={classes:yy},Ey=F(my,[["__cssModules",_y]]),Ty="_itemLabel_noxgo_1",Sy="_fieldset_noxgo_7",cs={itemLabel:Ty,fieldset:Sy};function Ry(n,e){var l,o;const t={width:n.width??"54px"};return g("label",{class:"quickprint-is-row"},[g("span",{class:cs.itemLabel,style:t},[n.label]),(o=(l=e.slots).default)==null?void 0:o.call(l)])}function ky(n,e){var l,o;const t=n.desc?g(_i,{title:n.desc},null):null;return g("div",{class:cs.fieldset},[g("header",null,[g("span",null,[n.header]),t]),(o=(l=e.slots).default)==null?void 0:o.call(l)])}const un={Item:Ry,Fieldset:ky},wy={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Ly={class:"quickprint-config-section"},Cy={class:"quickprint-form-inline"},Iy={class:"quickprint-config-section quickprint-config-inline"},Oy=P({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"磅",value:ie.PT},{label:"像素",value:ie.PX},{label:"毫米",value:ie.MM}],l=h("top"),o=h("bottom"),s=h("left"),r=h("right"),i=k(()=>al.map(y=>({label:y.size===cl.CUSTOM?"自定义":`${y.size}(${y.width}mm ✕ ${y.height}mm)`,value:y.size})));function a(y){e.config.width=y,p()}function c(y){e.config.height=y,p()}function f(y){const _=al.find(d=>d.size===y);_!=null&&(e.config.width=_.width,e.config.height=_.height,e.config.orientation=_.orientation,e.config.margins=_.margins,e.config.size=_.size)}function p(){const y=e.config,_=al.find(d=>d.size===cl.CUSTOM?!1:d.orientation===y.orientation&&d.width===y.width&&d.height===y.height);if(_==null){y.size=cl.CUSTOM;return}y.size=_.size}function h(y){return k({get(){var _;return(_=e.config.margins)==null?void 0:_[y]},set(_){e.config.margins==null&&(e.config.margins={}),e.config.margins[y]=_}})}return(y,_)=>(E(),L("div",wy,[u("section",Ly,[_[5]||(_[5]=u("header",{class:"quickprint-config-header"},[u("span",null,"尺寸")],-1)),g(b(le),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":f,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),u("div",Cy,[g(Gt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":a,title:"单位:毫米"},null,8,["modelValue"]),g(Gt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":c,title:"单位:毫米"},null,8,["modelValue"])])]),u("section",Iy,[_[6]||(_[6]=u("header",{class:"quickprint-config-header"},"方向",-1)),g(xt,{modelValue:n.config.orientation,"onUpdate:modelValue":_[0]||(_[0]=d=>n.config.orientation=d),options:b(ko)},null,8,["modelValue","options"])]),g(b(un).Fieldset,{header:"参考边距",desc:"可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:Re(()=>[u("div",{class:m(y.classes.margins)},[g(b(un).Item,{label:"上边距"},{default:Re(()=>[g(be,{modelValue:b(l),"onUpdate:modelValue":_[1]||(_[1]=d=>Ne(l)?l.value=d:null),options:t,defaultUnit:b(ie).MM},null,8,["modelValue","defaultUnit"])]),_:1}),g(b(un).Item,{label:"下边距"},{default:Re(()=>[g(be,{modelValue:b(o),"onUpdate:modelValue":_[2]||(_[2]=d=>Ne(o)?o.value=d:null),options:t,defaultUnit:b(ie).MM},null,8,["modelValue","defaultUnit"])]),_:1}),g(b(un).Item,{label:"左边距"},{default:Re(()=>[g(be,{modelValue:b(s),"onUpdate:modelValue":_[3]||(_[3]=d=>Ne(s)?s.value=d:null),options:t,defaultUnit:b(ie).MM},null,8,["modelValue","defaultUnit"])]),_:1}),g(b(un).Item,{label:"右边距"},{default:Re(()=>[g(be,{modelValue:b(r),"onUpdate:modelValue":_[4]||(_[4]=d=>Ne(r)?r.value=d:null),options:t,defaultUnit:b(ie).MM},null,8,["modelValue","defaultUnit"])]),_:1})],2)]),_:1})]))}}),Ny="_margins_1x2w9_2",Dy={margins:Ny},My={classes:Dy},xy=F(Oy,[["__cssModules",My]]),qy={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},$y={class:"quickprint-is-fill-h"},Ay={class:"quickprint-is-fill-h"},By=P({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:ie.NONE},{label:"磅",value:ie.PT},{label:"像素",value:ie.PX}],l=k(()=>Jn.map(c=>(c.style={fontFamily:c.value==ge.DEFAULT?ge.SONG:c.value},c))),o=k(()=>Fo.map(c=>(c.style={fontFamily:c.value==ge.DEFAULT?ge.SONG:c.value},c))),s=k({get(){return e.config.style.fontFamily??ge.DEFAULT},set(c){const f=c===ge.DEFAULT?void 0:c;e.config.style.fontFamily=f}}),r=k({get(){return e.config.style.enFontFamily??ge.DEFAULT},set(c){const f=c===ge.DEFAULT?void 0:c;e.config.style.enFontFamily=f}}),i=k({get(){return e.config.style.fontSize},set(c){const f=de(c)?void 0:c;e.config.style.fontSize=f}}),a=k({get(){return e.config.style.lineHeight},set(c){e.config.style.lineHeight=c}});return(c,f)=>(E(),L("div",qy,[u("section",{class:m(c.classes.font)},[u("div",{class:m(c.classes.zhFont)},[u("div",{class:m(c.classes.title)},"中文字体",2),u("div",$y,[g(b(le),{options:l.value,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=p=>s.value=p)},null,8,["options","modelValue"])])],2),u("div",{class:m(c.classes.enFont)},[u("div",{class:m(c.classes.title)},"西文字体",2),u("div",Ay,[g(b(le),{options:o.value,modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=p=>r.value=p)},null,8,["options","modelValue"])])],2),u("div",{class:m(c.classes.lineHeight)},[u("div",{class:m(c.classes.title)},"行高",2),g(be,{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=p=>a.value=p),options:t},null,8,["modelValue"])],2),u("div",{class:m(c.classes.fontSize)},[u("div",{class:m(c.classes.title)},"字号",2),g(Ho,{modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=p=>i.value=p),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),Py="_font_145qf_2",Vy="_zhFont_145qf_9",zy="_enFont_145qf_16",Fy="_lineHeight_145qf_23",Uy="_fontSize_145qf_30",Hy="_title_145qf_45",Gy={font:Py,zhFont:Vy,enFont:zy,lineHeight:Fy,fontSize:Uy,title:Hy},Wy={classes:Gy},Xy=F(By,[["__cssModules",Wy]]),Yy=P({__name:"index",props:{doc:{type:Te,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=tt(),l=xe(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,a)=>(E(),L("div",{class:m(i.classes.setting)},[n.active=="paper"?(E(),ee(xy,{key:0,config:l},null,8,["config"])):W("",!0),n.active=="font"?(E(),ee(Xy,{key:1,config:l},null,8,["config"])):W("",!0),u("div",{class:m(i.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),jy="_setting_h98ws_2",Zy="_footer_h98ws_10",Ky={setting:jy,footer:Zy},Jy={classes:Ky},Qy=F(Yy,[["__cssModules",Jy]]),e_=Ce(function(n){return Ze("文档",(e,t)=>g(Qy,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(we)}),t_=P({props:{toolbar:{type:Array,required:!0}},setup(n){const e=ke(),t=Ie("classes"),l=cy(e),o=uy(e),s=ly(e),r=sy(e),i=oy(e),a=dy(e),c=py(e),f=iy(e),p=ty(e),h=ny(e),y=ry(e),_=ay(e),d=k(()=>Jn.map(x=>(x.style={fontFamily:x.value==ge.DEFAULT?ge.SONG:x.value},x)));function v(x){return g("button",{type:"button",class:"quickprint-text-btn",onClick:()=>x.handler(e)},[x.icon&&g(H,{icon:x.icon},null),g("span",null,[x.label])])}function T(x){x.preventDefault()}function N(){c.value=!c.value}function A(){f.value=!f.value}function $(){p.value=!p.value}function I(){h.value=!h.value}function w(){const x=e.getSelectedElements();if(x.length==0)return;const S=Math.min(...x.map(R=>R.left));for(const R of x)R.setLeft(S,!0);e.createSnapshot()}function O(){const x=e.getSelectedElements();if(x.length==0)return;const S=x[0].page;if(S==null)return;const R=se.mm_to_px(S.width);for(const C of x)C.setLeft((R-C.width)/2);e.createSnapshot()}function B(){const x=e.getSelectedElements();if(x.length==0)return;const S=Math.max(...x.map(R=>R.left+R.width));for(const R of x)R.setLeft(S-R.width,!0);e.createSnapshot()}async function M(){const x=await xc(e.doc);x!=null&&(e.doc.ds=e.doc.createDS(x))}function D(){e_(e.doc)}function q(x){var S,R;if(typeof x=="function")return x(e,t);if(typeof x=="object")return v(x);if(typeof x!="string")return null;switch(x){case"divider":case"---":return g("div",{class:t.divider},null);case"space":return g("div",{class:"quickprint-is-fill-w"},null);case"undo":{const C=!e.history.allowUndo();return g("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:C,onClick:e.history.undo},[g(H,{icon:"icon-undo"},null)])}case"redo":{const C=!e.history.allowRedo();return g("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:C,onClick:e.history.redo},[g(H,{icon:"icon-redo"},null)])}case"delete":return g("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[g(H,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return g(le,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":C=>l.value=C,options:d.value,class:t.tool,button:!0},null);case"fontSize":return g(le,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":C=>o.value=C,options:Cl,class:t.tool,button:!0},null);case"lineHeight":return g(le,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":C=>s.value=C,options:Uo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return g(Yt,{modelValue:r.value,"onUpdate:modelValue":C=>r.value=C,class:t.tool},{default:()=>[g("div",{class:t.colorIcon,title:"背景色"},[g(H,{icon:"icon-bg-color-a",size:"15px"},null),g("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return g(Yt,{modelValue:i.value,"onUpdate:modelValue":C=>i.value=C,class:t.tool},{default:()=>[g("div",{class:t.colorIcon,title:"突出显示"},[g(H,{icon:"icon-bg-color-b",size:"15px"},null),g("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return g(Yt,{modelValue:a.value,"onUpdate:modelValue":C=>a.value=C,class:t.tool},{default:()=>[g("div",{class:t.colorIcon,title:"字体颜色"},[g(H,{icon:"icon-font",size:"15px"},null),g("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"fontWeight":{const C={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":c.value};return g("button",{type:"button",title:"加粗",class:C,onClick:N},[g(H,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const C={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":f.value};return g("button",{type:"button",title:"斜体",class:C,onClick:A},[g(H,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const C={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":p.value};return g("button",{type:"button",title:"下划线",class:C,onClick:$},[g(H,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const C={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":h.value};return g("button",{type:"button",title:"删除线",class:C,onClick:I},[g(H,{icon:"icon-through-line",size:"16px"},null)])}case"border":return g(Ey,null,null);case"textAlign":{const C=((S=vl.find(V=>V.value===y.value))==null?void 0:S.label)??"水平对齐",z={selected({option:V}){return g(H,{icon:V==null?void 0:V.icon,class:"quickprint-is-self-center"},null)}};return g(le,{modelValue:y.value,"onUpdate:modelValue":V=>y.value=V,options:vl,title:C,class:t.tool,width:"36px",size:"mini",button:!0},z)}case"verticalAlign":{const C=((R=hl.find(V=>V.value===_.value))==null?void 0:R.label)??"垂直对齐",z={selected({option:V}){return g(H,{icon:V==null?void 0:V.icon,class:"quickprint-is-self-center"},null)}};return g(le,{modelValue:_.value,"onUpdate:modelValue":V=>_.value=V,options:hl,title:C,class:t.tool,width:"36px",size:"mini",button:!0},z)}case"alignLeft":{const C={"quickprint-text-btn":!0,[t.tool]:!0};return g("button",{type:"button",title:"左侧对齐",class:C,onClick:w},[g(H,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const C={"quickprint-text-btn":!0,[t.tool]:!0};return g("button",{type:"button",title:"水平居中",class:C,onClick:O},[g(H,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const C={"quickprint-text-btn":!0,[t.tool]:!0};return g("button",{type:"button",title:"右侧对齐",class:C,onClick:B},[g(H,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const C={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return g("button",{type:"button",title:"网格",class:C,onClick:e.toggleBackground},[g(H,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const C={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return g("button",{type:"button",title:"元素面板",class:C,onClick:e.toggleElementPanel},[g(H,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const C={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return g("button",{type:"button",title:"配置面板",class:C,onClick:e.toggleConfigPanel},[g(H,{icon:"icon-config",size:"16px"},null)])}case"datasource":return g("button",{type:"button",class:"quickprint-text-btn",onClick:M},[g(H,{icon:"icon-datasource"},null),g("span",null,[fe("数据源")])]);case"document":return g("button",{type:"button",class:"quickprint-text-btn",onClick:D},[g(H,{icon:"icon-file-text"},null),g("span",null,[fe("文档配置")])]);default:return null}}return function(){return g("div",{class:t.toolbar,onMousedown:T},[n.toolbar.map(q)])}}}),n_="_toolbar_1bhq2_2",l_="_divider_1bhq2_8",o_="_tool_1bhq2_2",s_="_colorIcon_1bhq2_18",i_="_colorIndicator_1bhq2_38",r_={toolbar:n_,divider:l_,tool:o_,colorIcon:s_,colorIndicator:i_},a_={classes:r_},c_=F(t_,[["__cssModules",a_]]);function u_(n){let e=null;const t=pe(),l=xe({width:0,height:0,scrollTop:0,scrollLeft:0}),o=pe(),s=xe({id:"",top:0,left:0,width:0,height:0});async function r(){await en();const y=t.value;y!=null&&(l.width=y.offsetWidth,l.height=y.offsetHeight)}function i(y){const _=y.target;l.scrollLeft=_.scrollLeft,l.scrollTop=_.scrollTop}function a(y){const d=y.target.closest("."+Q.PAPER);d!=null&&(o.value=d,f(d),c())}async function c(){await en();const y=o.value;y!=null&&(s.id=y.id.slice(1),s.width=y.offsetWidth,s.height=y.offsetHeight,s.top=y.offsetTop,s.left=y.offsetLeft)}function f(y){y!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(y))}function p(){const y=n.doc.firstPage;if(y==null)return;const _=document.querySelector("#\\@"+y.id);o.value=_,e&&_&&e.observe(_),c()}function h(y){y.some(_=>_.target.matches("."+Q.CANVAS))&&(r(),c()),y.some(_=>_.target.matches("."+Q.PAPER))&&(r(),c())}return Tl(()=>n.state.scale,()=>c()),tn(()=>{e=new ResizeObserver(h),e.observe(t.value),p(),r()}),js(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:a}}const us=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),d_=P({__name:"index",props:Bt({modelValue:{type:Te,required:!0},toolbar:{type:Array,default(){return us}}},{modelValue:{required:!0},modelModifiers:{}}),emits:Bt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=pe(),o=pe(),s=fi(),r=_n(n,"modelValue"),i=Xg(r,{queryElement:T,dispatchEvent:N}),{canvasRef:a,canvasRect:c,pageRect:f,onScroll:p,onSelectPage:h}=u_(i),y=k(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),_=k(()=>{const $=i.doc.style;return{fontFamily:El($==null?void 0:$.fontFamily,$==null?void 0:$.enFontFamily),fontSize:$==null?void 0:$.fontSize,lineHeight:$==null?void 0:$.lineHeight}});function d(){i.state.panel.left=!1}function v(){i.state.panel.right=!1}function T($){switch($){case"ghost":return o.value;case"root":return l.value;default:return}}function N($,...I){t($,...I)}function A($){$.deltaY>0?i.zoomIn():i.zoomOut()}return($,I)=>(E(),L("div",{class:m($.classes.designer),ref_key:"rootRef",ref:l,style:Z(y.value)},[u("div",{class:m($.classes.header)},[Qe($.$slots,"headerLeft"),g(c_,{class:m($.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),Qe($.$slots,"headerRight")],2),u("div",{class:m($.classes.main)},[b(i).state.panel.left?(E(),L("div",{key:0,class:m($.classes.left)},[u("button",{type:"button",onClick:d,class:m(["quickprint-text-btn",$.classes.closePanelBtn])},[g(b(H),{icon:"icon-close",size:"12px"})],2),g(Kh)],2)):W("",!0),u("div",{class:m([$.classes.center,b(Q).CANVAS]),onWheel:ae(A,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:a},[g(Ql,{canvas:b(c),page:b(f),scale:b(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),g(Ql,{canvas:b(c),page:b(f),scale:b(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),u("div",{class:m([b(Q).SCROLLABLE,$.classes.canvas]),style:Z(_.value),onScroll:I[0]||(I[0]=(...w)=>b(p)&&b(p)(...w)),onClickCapture:I[1]||(I[1]=(...w)=>b(h)&&b(h)(...w))},[(E(!0),L(te,null,ce(r.value.pages,w=>(E(),ee(Vh,{key:w.id,doc:r.value,page:w},null,8,["doc","page"]))),128))],38),u("div",{class:m($.classes.footer)},[g(iv),g(b(As),{scale:b(i).state.scale,onZoomIn:b(i).zoomIn,onZoomOut:b(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),b(i).state.panel.right?(E(),L("div",{key:1,class:m($.classes.right)},[u("button",{type:"button",onClick:v,class:m(["quickprint-text-btn",$.classes.closePanelBtn])},[g(b(H),{icon:"icon-close",size:"12px"})],2),g(ey)],2)):W("",!0)],2),u("div",{ref_key:"ghostRef",ref:o,class:m($.classes.ghost)},null,2),g(b(Bs))],6))}}),p_="_designer_grxxm_2",f_="_header_grxxm_17",m_="_toolbar_grxxm_25",g_="_footer_grxxm_31",h_="_main_grxxm_47",v_="_left_grxxm_55",b_="_center_grxxm_63",y_="_right_grxxm_75",__="_canvas_grxxm_83",E_="_closePanelBtn_grxxm_96",T_="_ghost_grxxm_103",S_={designer:p_,header:f_,toolbar:m_,footer:g_,main:h_,left:v_,center:b_,right:y_,canvas:__,closePanelBtn:E_,ghost:T_},R_={classes:S_},k_=F(d_,[["__cssModules",R_]]),w_={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:Wt.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(we)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:Wt.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:Wt.DISABLED}},L_=P({__name:"Block",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k(()=>{e.element.state.key;const l=e.element;return{"--quickprint-element-top":l.top+"px","--quickprint-element-left":l.left+"px","--quickprint-element-width":l.width+"px","--quickprint-element-height":l.height+"px","z-index":l.zIndex}});return(l,o)=>(E(),L("div",{style:Z(t.value),class:m(l.classes.element)},null,6))}}),C_="_element_1hint_2",I_={element:C_},O_={classes:I_},N_=F(L_,[["__cssModules",O_]]),D_=P({__name:"Element",props:{element:{type:ue,required:!0}},setup(n){const e=n,t=k(()=>{e.element.state.key;const l=e.element;return{"--quickprint-element-top":l.top+"px","--quickprint-element-left":l.left+"px","--quickprint-element-width":l.width+"px","--quickprint-element-height":l.height+"px","z-index":l.zIndex}});return(l,o)=>(E(),L("div",{style:Z(t.value),class:m(l.classes.element)},[Qe(l.$slots,"default")],6))}}),M_="_element_1l75c_2",x_={element:M_},q_={classes:x_},$_=F(D_,[["__cssModules",q_]]),A_=P({props:{define:{type:Te,required:!0},blocky:{type:Boolean,default:!1}},setup(n){const e=Ie("classes"),t=he(1),l=he(!1),o=pe();let s;const r=k(()=>{const c=n.define.firstPage,f={width:`${c.width}mm`,height:`${c.height}mm`};return l.value&&(f.transform=`scale(${t.value})`),f});function i(c){if(n.blocky)return g(N_,{element:c,key:c.id},null);const f=Tg(c.type);return g($_,{element:c,key:c.id},{default:()=>[f?Je(f,{element:c,key:c.id}):g(nn,{element:c,showDS:!1,key:c.id},null)]})}function a(){const c=o.value;if(c==null||c.parentElement==null)return;const f=c.parentElement;t.value=Math.min(f.offsetWidth/c.offsetWidth,f.offsetHeight/c.offsetHeight)}return tn(()=>{const c=o.value;c==null||c.parentElement==null||(l.value=!0,s=new ResizeObserver(()=>a()),s.observe(c.parentElement))}),Hn(()=>{s&&(s.disconnect(),s=void 0)}),function(){return g("div",{class:e.minimap},[g("div",{style:r.value,ref:o,class:e.paper},[n.define.firstPage.children.map(i)])])}}}),B_="_minimap_iujml_2",P_="_paper_iujml_13",V_={minimap:B_,paper:P_},z_={classes:V_},F_=F(A_,[["__cssModules",z_]]);function U_(n,e={}){const t=Ps(e.zIndexManager);n.use(Vs,{zIndex:t,presets:w_}),zs(n._context)}const H_="0.0.0",G_={version:H_,install:U_},W_=["onClick"],X_=P({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=tt(),l=o();function o(){return xe(Fs.map(i=>({id:i.id,name:i.name,define:null})))}function s(i){t==null||t.confirm(i)}function r(){for(const i of l)Us(i.id).then(a=>{i.define=Te.create(a==null?void 0:a.define)})}return r(),(i,a)=>(E(),L("div",{class:m([i.classes.panel,"quickprint-is-scrollable"])},[(E(!0),L(te,null,ce(b(l),c=>(E(),L("div",{key:c.id,class:m(i.classes.item),onClick:f=>s(c)},[u("div",{class:m(i.classes.card)},[c.define?(E(),ee(b(F_),{key:0,define:c.define,class:m(i.classes.minimap)},null,8,["define","class"])):(E(),L("div",{key:1,class:m(i.classes.loading)},"加载中...",2))],2),u("p",{class:m(i.classes.name)},J(c.name),3)],10,W_))),128))],2))}}),Y_="_panel_1gnat_2",j_="_item_1gnat_16",Z_="_card_1gnat_21",K_="_name_1gnat_36",J_="_loading_1gnat_47",Q_={panel:Y_,item:j_,card:Z_,name:K_,loading:J_},eE={classes:Q_},tE=F(X_,[["__cssModules",eE]]),nE='<div class="quickprint-md"><ul><li><s>feat: [设计器]模板预览</s></li><li>feat: [设计器]模板元素树</li><li><s>feat: [预览]滚动时调整页码</s></li></ul></div>',lE=["innerHTML"],oE=P({__name:"Todo",setup(n){return(e,t)=>(E(),L("div",{innerHTML:b(nE),class:m(e.classes.doc)},null,10,lE))}}),sE="_doc_1ri3b_2",iE={doc:sE},rE={classes:iE},aE=F(oE,[["__cssModules",rE]]),cE='<div class="quickprint-md"><h2>2025-12-20</h2><ul><li>feat: [示例]银行叫号</li><li>feat: [元素]图片</li><li>feat: [元素]二维码</li><li>feat: [元素]条形码</li><li>feat: [预览]支持监听事件</li><li>feat: [设计器]支持自动调整图片、二维码、条形码的尺寸</li><li>fix: 改进图片空白提示</li></ul><h2>2025-12-10</h2><ul><li>feat: 支持设置文字方向</li><li>feat: 支持设置斜线表头</li><li>feat: 调整元素对齐方式</li><li>feat: 调试模式</li><li>feat: 单元格的宽、高会将边框尺寸计算在内</li><li>feat: [设计器]支持按<code>Ctrl</code>多选元素</li><li>fix: 修复<em>每页打印</em>选项不生效</li><li>fix: 修复表格存在行合并时，渲染有误</li></ul></div>',uE=["innerHTML"],dE=P({__name:"ChangeLog",setup(n){return(e,t)=>(E(),L("div",{innerHTML:b(cE),class:m(e.classes.doc)},null,10,uE))}}),pE="_doc_19r5b_2",fE={doc:pE},mE={classes:fE},gE=F(dE,[["__cssModules",mE]]),hE="local",no="quickprint-local-define",vE=P({__name:"index",setup(n){const e=Ie("classes"),t=y(),l="20251225",o=[{label:"新建",icon:"icon-file-text",handler:f},{label:"加载示例",icon:"icon-import",handler:a},"---",...us];function s(){const d=JSON.stringify(t.value);localStorage.setItem(no,d)}function r(){s()}function i(){const d=t.value.id,v=d.startsWith("case_")?d:hE,T=`${window.location.origin}/preview.html?id=${v}`;s(),ut("文档预览",Je("iframe",{src:T,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(N){window.open(T,"_blank"),N.close()}}]})}function a(){const d={mask:!0,top:"5vh",width:"90vw",height:"90vh",resizeMode:Wt.DISABLED};ut("请选择示例",Je(tE),d).promisify().then(v=>c(v.id)).catch(we)}async function c(d){const v=await Ml(d,!1);v!=null&&(Hs(d),t.value=Te.create(v.define),p())}function f(){const d=Te.createNormalDocument();t.value=d,p()}function p(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function h(){const d=localStorage.getItem(no);if(d!=null)return Te.create(d);const v=Gs(),T=await Ml(v.id,!1);return T==null?Te.createNormalDocument():Te.create(T.define)}function y(){const d=he();return h().then(v=>{d.value=v,p()}),d}const _=Ce(function(){return Ze("OpenPrint",(d,v)=>v==="done"?Je(gE):Je(aE),{height:"480px",tabs:[{label:"进行中",name:"todo"},{label:"更新日志",name:"done"}]}).promisify().catch(rt)});return(d,v)=>b(t)?(E(),ee(b(k_),{modelValue:b(t),"onUpdate:modelValue":v[1]||(v[1]=T=>Ne(t)?t.value=T:null),toolbar:o,class:m(b(e).main),key:b(t).id,onSave:r,onPreview:i},{headerLeft:Re(()=>[u("div",{class:m(b(e).logo)},[v[2]||(v[2]=u("h1",null,"OpenPrint",-1)),u("div",{class:m(b(e).dev),onClick:v[0]||(v[0]=(...T)=>b(_)&&b(_)(...T))},"DEV_"+J(b(l)),3)],2)]),headerRight:Re(()=>[u("div",{class:m(b(e).operate)},[u("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[g(b(H),{icon:"icon-run"}),v[3]||(v[3]=u("span",null,"预览",-1))]),u("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[g(b(H),{icon:"icon-save"}),v[4]||(v[4]=u("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):W("",!0)}}),bE="_main_14ojw_2",yE="_iframe_14ojw_6",_E="_divider_14ojw_14",EE="_logo_14ojw_20",TE="_dev_14ojw_39",SE="_operate_14ojw_52",RE={main:bE,iframe:yE,divider:_E,logo:EE,dev:TE,operate:SE},kE={classes:RE},wE=F(vE,[["__cssModules",kE]]),ds=Zs(wE);ds.use(G_);ds.mount("#app");
