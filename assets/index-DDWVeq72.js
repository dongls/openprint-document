const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-BzOvwT-C.js","assets/vue-B00pXJJQ.js","assets/component-m7TpiA7_.js","assets/utils-DYzSvdZV.js","assets/utils-DCW1KeBq.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Po=Object.defineProperty;var hl=n=>{throw TypeError(n)};var Vo=(n,e,t)=>e in n?Po(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var H=(n,e,t)=>Vo(n,typeof e!="symbol"?e+"":e,t),Pn=(n,e,t)=>e.has(n)||hl("Cannot "+t);var Ie=(n,e,t)=>(Pn(n,e,"read from private field"),t?t.call(n):e.get(n)),He=(n,e,t)=>e.has(n)?hl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),pt=(n,e,t,l)=>(Pn(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),Ne=(n,e,t)=>(Pn(n,e,"access private method"),t);import{D as ye,E as Et,N as Zt,a as ht,b as Y,c as Pe,P as el,d as Qt,e as vl,f as vn,g as bn,O as en,h as te,i as on,j as yn,L as Be,I as F,_ as z,k as ql,s as Rn,l as Fo,m as ie,n as $l,p as _n,C as Oe,o as tl,q as nl,U as Gn,r as pe,t as zo,u as ll,v as Pl,w as Ge,x as Wn,y as Uo,z as Ho,A as Go,B as Wo,F as Vl,V as Tt,G as En,H as st,J as Fl,K as zl,M as Ul,Q as be,R as nt,S as Yo,T as Xo,W as xe,X as at,Y as Ae,Z as wt,$ as je,a0 as jo,a1 as Zo,a2 as Ko,a3 as Tn,a4 as se,a5 as Ee,a6 as vt,a7 as un,a8 as It,a9 as ae,aa as bt,ab as Ze,ac as it,ad as Jo,ae as Te,af as ol,ag as kn,ah as Ot,ai as Wt,aj as dn,ak as Lt,al as Qo,am as es,an as Rt,ao as Dt,ap as ts,aq as ns,ar as ls,as as os,at as ss,au as Ft,av as sn,aw as bl,ax as is,ay as yl,az as ge,aA as Vn,aB as Fn,aC as rs,aD as as,aE as fn,aF as cs,aG as us,aH as ds,aI as fs,aJ as _l,aK as ps,aL as ms}from"./utils-DYzSvdZV.js";import{r as ue,o as sl,d as V,c as I,a as R,n as m,b as d,e as p,f as et,u as Le,s as fe,g as De,h as L,w as ne,i as y,j as J,k as G,T as Hl,l as K,m as kt,p as nn,q as Gl,F as Q,t as re,v as Z,x as zt,y as El,z as Wl,A as Yl,B as ln,C as il,D as ke,E as Se,G as qe,H as le,I as Ut,J as gs,K as Xl,L as zn,M as Ke,N as ct,O as hs,P as vs,Q as bs,R as ys}from"./vue-B00pXJJQ.js";const jl="@quickprint_drag_mode",Zl="@quickprint_drop_data",wn="@quickprint_operate",ze="@quickprint_element",rl="@quickprint_element_type",Kl="@quickprint_resize_flag",St=160,Cn=32,Yt=[50,75,100,125,150,200,300,400];var Kt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Kt||{}),Nt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Nt||{});const Je={SINGLE:0,MULTIPLE:1},Me=Object.freeze({INSERT:0,MOVE:1}),al=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),X=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),ce=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Jl=[{label:"固定值",value:ye.CONST},{label:"变量",value:ye.VARIABLE},{label:"公式",value:ye.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:ye.CODE,detail:"使用Javascript代码生成数据"}],_s=[{label:"显示",value:Et.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:Et.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:Et.CONDITION,detail:"元素只在满足指定条件后显示"}],Es=[{label:"四舍五入",value:Zt.ROUND},{label:"向下舍入",value:Zt.FLOOR},{label:"向上舍入",value:Zt.CEIL},{label:"四舍六入",value:Zt.BANKER_ROUND}],Ts=[{label:"原始值",value:ht.NONE},{label:"固定位数",value:ht.FIXED},{label:"金额千位",value:ht.THOUSAND},{label:"金额万位",value:ht.TEN_THOUSAND},{label:"金额大写",value:ht.DAXIE},{label:"百分比",value:ht.PERCENTAGE}],Ss=[{label:"显示",value:!0},{label:"隐藏",value:!1}],Rs=[{label:"默认",value:void 0},{label:"文本",value:Y.TEXT},{label:"数字",value:Y.NUMBER},{label:"日期",value:Y.DATE}],de={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Ql=[{label:"年-月",value:Pe.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:Pe.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:Pe.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:Pe.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:Pe.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:Pe.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:Pe.TIME,detail:"示例：12:00:00"},{label:"时:分",value:Pe.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:Pe.YEAR,detail:"示例：2024"},{label:"月",value:Pe.MONTH,detail:"示例：12"},{label:"日",value:Pe.DAY,detail:"示例：01"}];Ql.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const ks=[{label:"元素值",value:el.ELEMENT_VALUR}],ws=[{label:"基于纸张",value:Qt.PAPER},{label:"基于内容",value:Qt.CONTENT}],eo=[{label:"纵向",value:vl.PORTRAIT},{label:"横向",value:vl.LANDSCAPE}],Cs=[{label:"当前位置",value:vn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:vn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Ls=[{label:"单次打印",value:bn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:bn.EACH,detail:"元素将每页打印一次"}],Is=[{label:"按内容调整高度",value:en.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:en.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:en.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Yn=[{label:"页码",value:on.PAGE_NUMBER,type:te.NUMBER},{label:"总页数",value:on.PAGE_TOTAL,type:te.NUMBER},{label:"行序号",value:on.ROW_INDEX,type:te.NUMBER},{label:"当前时间",value:on.CURRENT_DATE,type:te.DATE}],Ns=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function to(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Os(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function no(n){return n.isSelected?n.type===Y.PARAGRAPH?52:n.type===Y.TABLE?32:20:20}function Ds(){const n=ue(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),sl(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class xs{constructor(e,t,l){H(this,"originalEvent");H(this,"target");H(this,"ghost");H(this,"container");H(this,"paths",[]);H(this,"dropTarget");H(this,"top",0);H(this,"left",0);H(this,"deltaX");H(this,"deltaY");H(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var qt,$t,ut,lo,oo,so;const _t=class _t extends yn{constructor(t={}){var l,o,s;super();He(this,ut);H(this,"context",null);H(this,"selector");H(this,"scale");H(this,"onDragStart");He(this,qt);He(this,$t);this.selector={container:((l=t.selector)==null?void 0:l.container)??X.PAGE,element:((o=t.selector)==null?void 0:o.element)??X.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??X.DROPPABLE},this.onDragStart=Ne(this,ut,lo).bind(this),this.scale=t.scale,pt(this,qt,Ne(this,ut,oo).bind(this)),pt(this,$t,Ne(this,ut,so).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",Ie(this,qt)),window.removeEventListener("pointerup",Ie(this,$t)),this.context=null)}};qt=new WeakMap,$t=new WeakMap,ut=new WeakSet,lo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Be.warn(_t.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=to(l,o);this.context=new xs(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return Be.warn(_t.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Be.warn(_t.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return Be.warn(_t.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",Ie(this,qt)),window.addEventListener("pointerup",Ie(this,$t))},oo=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(a=>!(a===l.ghost||a===l.target||l.ghost.contains(a))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(a=>a.matches("."+X.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},so=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},H(_t,"TAG_NAME","quickprint-draggable");let Xn=_t;const As=["title"],Ms=V({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(R(),I("span",{title:n.title,class:m(e.classes.help)},[d("span",null,[et(e.$slots,"default")]),p(F,{icon:"icon-question-circle"})],10,As))}}),Bs="_help_1l6l8_2",qs={help:Bs},$s={classes:qs},Ps=z(Ms,[["__cssModules",$s]]),Vs=V({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=Le("classes"),r=ue(!1),i=fe(),a=fe(),u=De({minWidth:0,top:0,left:0,visible:!1}),f=L(()=>({minWidth:l.width==null?u.minWidth+"px":l.width+"px",top:u.top+"px",left:u.left+"px",visibility:u.visible?"visible":"hidden",zIndex:ql()}));async function g(){if(r.value)return v();l.disabled||(r.value=!0,o("show"),await Rn(),T())}function v(){N(),r.value=!1,o("close")}function _(C){if(!(C.target instanceof Node))return;const D=i.value;if(D&&D.contains(C.target))return C.preventDefault();const k=a.value;if(k&&k.contains(C.target))return C.preventDefault();v()}function b(){const C=i.value,D=a.value;if(D==null||C==null)return;const k=C.getBoundingClientRect(),w=D.getBoundingClientRect(),A=l.width==null?k.width:l.width;let P=k.bottom+1;P+w.height>window.innerHeight&&k.top>w.height&&(P=k.top-w.height-1);let O=k.left;O+w.width>window.innerWidth&&(O=window.innerWidth-w.width-2),u.minWidth=A,u.top=P,u.left=O,u.visible=!0}function c(C){const D=C.target;if(!(D instanceof HTMLElement))return;const k=i.value;k==null||!D.contains(k)||v()}function h(C){if(C.key!=="Escape")return;const D=a.value;if(D!=null){const k=D.style.zIndex;if(Number(k)<Fo())return}C.preventDefault(),v()}function T(){window.addEventListener("click",_,{capture:!0}),window.addEventListener("contextmenu",v,{capture:!0}),window.addEventListener("scroll",c,{capture:!0,passive:!0}),window.addEventListener("resize",b),window.addEventListener("keydown",h)}function N(){window.removeEventListener("click",_,!0),window.removeEventListener("contextmenu",v,!0),window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",b),window.removeEventListener("keydown",h)}return e({close:v}),(C,D)=>(R(),I("div",{class:m(y(s).reference),onClick:ne(g,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[et(C.$slots,"default"),r.value?(R(),J(Hl,{key:0,to:"body"},[d("div",{class:m(y(s).popover),onVnodeMounted:b,onMousedown:D[0]||(D[0]=ne(()=>{},["prevent"])),style:K(f.value),ref_key:"popoverRef",ref:a},[et(C.$slots,"popover")],38)])):G("",!0)],2))}}),Fs="_reference_1arli_2",zs="_popover_1arli_7",Us={reference:Fs,popover:zs},Hs={classes:Us},io=z(Vs,[["__cssModules",Hs]]),Gs=["title","onKeydown"],Ws=["onMouseover","onClick"],Ys=V({__name:"Select",props:kt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:kt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=Le("classes"),s=fe(),r=fe(),i=nn(n,"modelValue"),a=ue(),u=ue(!1),f=De({width:0,top:0,left:0,visible:!1,scrollable:!1}),g=L(()=>l.teleport==="none"),v=L(()=>l.teleport=="none"?"body":l.teleport),_=L(()=>{const $={label:"",options:[]},U=[$];for(const W of l.options){if(Array.isArray(W.options)){U.push({label:W.label,options:W.options});continue}$.options.push(W)}return U}),b=L(()=>_.value.reduce(($,U)=>$.concat(U.options),[])),c=L(()=>{if(l.multiple!==!0){const U=qn();return U?U.label:l.button?l.title:ie(l.modelValue)?l.placeholder:l.modelValue}const $=$n();return $.length>0?$.map(U=>U.label).join(","):l.button?l.title:l.placeholder}),h=L(()=>l.clearable!==!0?!1:l.modelValue!=null),T=L(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!h.value,[o.button]:l.button,[o.showClearIcon]:h.value,[o.text]:l.size==="text"})),N=L(()=>({width:l.width})),C=L(()=>f.visible?{width:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",top:f.top+"px",left:f.left+"px",visibility:"visible",zIndex:ql()}:{minWidth:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",visibility:"hidden"}),D=L(()=>({[o.content]:!0,[o.placeholder]:$l(l.modelValue)}));async function k(){if(l.disabled)return;const $=b.value;if($.length===0)return;if(u.value)return w();const U=s.value;U!=null&&(f.width=U.getBoundingClientRect().width,f.visible=!1,a.value=$.find(W=>W.value===l.modelValue),u.value=!0,await Rn(),qo())}function w(){$o(),u.value=!1}function A($){E(),ft()}function P($){$.disabled!==!0&&(a.value=$)}function O($){if(l.disabled==!0||$.disabled===!0)return;if(l.multiple!==!0){i.value=$.value,t("select",$),w();return}const U=Array.isArray(i.value)?i.value:[],W=U.findIndex(me=>me===$.value);W>=0?U.splice(W,1):U.push($.value),i.value=U,t("select",U)}function M($){if(!($.target instanceof Node))return;const U=s.value;if(U&&U.contains($.target))return $.preventDefault();const W=r.value;if(W&&W.contains($.target))return $.preventDefault();w()}async function E(){const $=s.value,U=r.value;if(U==null||$==null)return;await zt();const W=$.getBoundingClientRect(),me=U.getBoundingClientRect();let ve=W.bottom+1;ve+me.height>window.innerHeight&&W.top>me.height&&(ve=W.top-me.height-1);let Ct=W.left;Ct+me.width>window.innerWidth&&(Ct=window.innerWidth-me.width-2),f.width=me.width,f.top=ve,f.left=Ct,f.visible=!0;const Gt=U.querySelector("."+o.list);f.scrollable=Gt?Gt.scrollHeight>Gt.clientHeight:!1}function S($){const U=$.target;if(!(U instanceof HTMLElement))return;const W=s.value;W==null||!U.contains(W)||w()}function x(){const $=b.value,U=El(a.value);if(U==null){a.value=_e(0),ft();return}const W=$.indexOf(U);if(W==0)return oe();const me=_e(W-1);me!=null&&(a.value=me,ft())}function q(){const $=b.value,U=El(a.value);if(U==null){a.value=he(0),ft();return}const W=$.indexOf(U);if(W>=$.length-1){B();return}const me=_e(W+1);me!=null&&(a.value=me,ft())}function B(){a.value=he(0),ft()}function oe(){const $=b.value;a.value=_e($.length-1),ft()}function j(){i.value=void 0,w()}function he($){const W=b.value[$];return W==null?null:W.disabled===!0?he($+1):W}function _e($){const W=b.value[$];return W==null?null:W.disabled===!0?_e($-1):W}function we($){switch($.key){case"Enter":$.preventDefault(),a.value&&O(a.value);return;case"Escape":$.preventDefault(),w();return;case"ArrowUp":$.preventDefault(),x();return;case"ArrowDown":$.preventDefault(),q();return;case"Home":$.preventDefault(),B();return;case"End":$.preventDefault(),oe();return}}function Bn($){if(l.disabled)return;const U=s.value;U!=null&&document.activeElement===U&&(u.value||($.stopPropagation(),k()))}function Bo($){if(l.multiple!==!0)return l.modelValue===$.value;const U=l.modelValue;return Array.isArray(U)?U.includes($.value):!1}async function ft(){if(a.value==null)return;await zt();const $=r.value;if($==null)return;const U=$.querySelector("."+o.hover);U&&U.scrollIntoView({block:"nearest"})}function qn(){const $=b.value,U=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return $.find(W=>W.value===U)}function $n(){const $=b.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(W=>W).map(W=>{const me=$.find(ve=>ve.value===W);return me||{value:W,label:W}})}function qo(){window.addEventListener("mousedown",M,{capture:!0}),window.addEventListener("pointerdown",M,{capture:!0}),window.addEventListener("contextmenu",w,{capture:!0}),window.addEventListener("scroll",S,{capture:!0,passive:!0}),window.addEventListener("resize",E),window.addEventListener("keydown",we)}function $o(){window.removeEventListener("mousedown",M,!0),window.removeEventListener("pointerdown",M,!0),window.removeEventListener("contextmenu",w,!0),window.removeEventListener("scroll",S,!0),window.removeEventListener("resize",E),window.removeEventListener("keydown",we)}return($,U)=>{var W;return R(),I("div",{class:m(T.value),title:n.title,style:K(N.value),onClick:ne(k,["stop"]),onKeydown:Gl(ne(Bn,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[$.$slots.selected?et($.$slots,"selected",{key:0,option:qn(),options:$n()}):et($.$slots,"option",{key:1,option:qn(),options:$n()},()=>[d("div",{class:m(D.value)},[d("span",null,Z(c.value),1),h.value?(R(),J(F,{key:0,icon:"icon-close",onClick:ne(j,["stop"]),size:"12px",class:m(y(o).clearIcon)},null,8,["class"])):G("",!0)],2)]),u.value?(R(),J(Hl,{key:2,to:v.value,disabled:g.value},[d("div",{class:m(y(o).popover),onClick:U[0]||(U[0]=ne(()=>{},["stop"])),onVnodeMounted:A,onMousedown:U[1]||(U[1]=ne(()=>{},["prevent"])),style:K(C.value),ref_key:"popoverRef",ref:r},[d("div",{class:m(y(o).list)},[(R(!0),I(Q,null,re(_.value,me=>(R(),I(Q,null,[me.label?(R(),I("div",{key:0,class:m(y(o).groupLabel)},Z(me.label),3)):G("",!0),(R(!0),I(Q,null,re(me.options,ve=>{var Ct;return R(),I("div",{key:ve.value,class:m({[y(o).option]:!0,[y(o).disabled]:ve.disabled===!0,[y(o).selected]:Bo(ve),[y(o).hover]:((Ct=a.value)==null?void 0:Ct.value)==ve.value}),style:K(ve.style),onMouseover:Gt=>P(ve),onClick:Gt=>O(ve)},[et($.$slots,"option",{option:ve},()=>[d("div",{class:m(y(o).label)},[ve.icon?(R(),J(F,{key:0,icon:ve.icon,class:m(y(o).icon)},null,8,["icon","class"])):G("",!0),d("span",null,Z(ve.label),1)],2),ve.short?(R(),I("div",{key:0,class:m(y(o).short)},Z(ve.short),3)):G("",!0)])],46,Ws)}),128))],64))),256))],2),(W=a.value)!=null&&W.detail&&f.visible?(R(),I("div",{key:0,class:m(y(o).detail)},Z(a.value.detail),3)):G("",!0)],38)],8,["to","disabled"])):G("",!0)],46,Gs)}}}),Xs="_button_g23yb_2",js="_select_g23yb_7",Zs="_appearance_g23yb_16",Ks="_content_g23yb_31",Js="_placeholder_g23yb_37",Qs="_popover_g23yb_41",ei="_list_g23yb_51",ti="_option_g23yb_80",ni="_label_g23yb_95",li="_icon_g23yb_102",oi="_hover_g23yb_106",si="_detail_g23yb_117",ii="_short_g23yb_127",ri="_selected_g23yb_133",ai="_disabled_g23yb_137",ci="_showClearIcon_g23yb_142",ui="_clearIcon_g23yb_146",di="_text_g23yb_159",fi="_mini_g23yb_171",pi="_groupLabel_g23yb_183",mi={button:Xs,select:js,appearance:Zs,content:Ks,placeholder:Js,popover:Qs,list:ei,option:ti,label:ni,icon:li,hover:oi,detail:si,short:ii,selected:ri,disabled:ai,showClearIcon:ci,clearIcon:ui,text:di,mini:fi,groupLabel:pi},gi={classes:mi},ee=z(Ys,[["__cssModules",gi]]),hi="_tree_1p28f_1",vi="_node_1p28f_5",bi="_content_1p28f_11",yi="_space_1p28f_27",_i="_expand_1p28f_28",Ei="_active_1p28f_47",Ti="_children_1p28f_55",lt={tree:hi,node:vi,content:bi,space:yi,expand:_i,active:Ei,children:Ti},ro=Symbol(),ao=V({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Wl(ro),l=L(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=L({get(){const c=t==null?void 0:t.state[n.node.value];return c==null?!1:c.expand},set(c){const h=t==null?void 0:t.state[n.node.value];h!=null&&(h.expand=c)}});function s(c){c.preventDefault(),o.value=!o.value}function r(){if(!l.value)return p("div",{class:lt.space},null);const c={[lt.expand]:!0,[lt.active]:o.value};return p("div",{onMousedown:b,onClick:s,class:c},[p(F,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function a(){return p("div",{class:lt.content,onClick:f,onMouseenter:v},[i()])}function u(){if(!l.value||!o.value)return;const c=n.node.children.map(h=>p(ao,{node:h,onNodeClick:g,onNodeHover:_},null));return p("div",{class:lt.children},[c])}function f(){e("nodeClick",n.node)}function g(c){e("nodeClick",c)}function v(){e("nodeHover",n.node)}function _(c){e("nodeHover",c)}function b(c){c.preventDefault()}return function(){return p("div",{class:lt.subTree},[p("div",{class:lt.node},[r(),a()]),u()])}}}),Si=V({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(a){t("nodeClick",a)}function s(a){t("nodeHover",a)}function r(){const a=De({}),u=function(f,g){for(const v of f)g[v.value]={expand:v.expand!==!1},v.children&&u(v.children,g)};return u(n.data,a),a}function i(a){return typeof e.default=="function"?e.default(a):null}return Yl(ro,{state:l,content:i}),function(){const a=n.data.map(u=>p(ao,{node:u,onNodeClick:o,onNodeHover:s},null));return p("div",{class:lt.tree},[a])}}});function rn(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const Un={A:10,B:11,C:12,D:13,E:14,F:15},Tl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function Ri(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function ki(n){return typeof n=="string"&&n.includes("%")}function Mt(n,e){Ri(n)&&(n="100%");const t=ki(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function mt(n){return n.length===2?(Un[n[0].toUpperCase()]||+n[0])*16+(Un[n[1].toUpperCase()]||+n[1]):Un[n[1].toUpperCase()]||+n[1]}function Sl(n,e,t){n=Mt(n,255),e=Mt(e,255),t=Mt(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,a=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:a*100,v:r*100}}const wi=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},Ci=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function Hn(n,e,t){n=Mt(n,360)*6,e=Mt(e,100),t=Mt(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),a=l%6,u=[t,r,s,s,i,t][a],f=[i,t,t,r,s,s][a],g=[s,s,i,t,t,r][a];return{r:Math.round(u*255),g:Math.round(f*255),b:Math.round(g*255)}}function pn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${Tl[e]||e}${Tl[t]||t}`}function Li({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${pn(n)}${pn(e)}${pn(t)}`}class Ln{constructor(e){H(this,"h",0);H(this,"s",100);H(this,"v",100);H(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=rn(e)}setSaturation(e){this.s=rn(e)}setValue(e){this.v=rn(e)}setAlpha(e){this.a=rn(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=mt(t[0]+t[0]),o=mt(t[1]+t[1]),s=mt(t[2]+t[2])):(t.length===6||t.length===8)&&(l=mt(t.slice(0,2)),o=mt(t.slice(2,4)),s=mt(t.slice(4,6))),t.length===8&&(r=mt(t.slice(6))/255*100);const{h:i,s:a,v:u}=Sl(l,o,s);return{h:i,s:a,v:u,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Sl(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=wi(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=Ci(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Li(Hn(this.h,this.s,this.v))}${pn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=Hn(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return Hn(this.h,this.s,this.v)}}function co(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().width/2;let f=r.clientX-i.left-e.offsetX;return f<-u&&(f=-u),f>i.width-u&&(f=i.width-u),f}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,a=r.currentTarget;origin==null||i==null||(e.container=a,e.target=i===a?i.firstElementChild:i,e.offsetX=i===a?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function Ii(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().width/2;let g=i.clientX-a.left-e.offsetX;return g<-f&&(g=-f),g>a.width-f&&(g=a.width-f),g}function l(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().height/2;let g=i.clientY-a.top-e.offsetY;return g<-f&&(g=-f),g>a.height-f&&(g=a.height-f),g}function o(i){i.stopPropagation(),i.preventDefault();const a=i.target,u=i.currentTarget;origin==null||a==null||(e.container=u,e.target=a===u?a.firstElementChild:a,e.offsetX=a===u?e.target.offsetWidth/2:i.clientX-a.getBoundingClientRect().left,e.offsetY=a===u?e.target.offsetHeight/2:i.clientY-a.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const a=t(i),u=l(i);e.target.style.left=a+"px",e.target.style.top=u+"px",n("move",{left:a,top:u})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const a=t(i),u=l(i);n("end",{top:u,left:a})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const Ni=V({__name:"SvPanel",props:{modelValue:{type:Ln,required:!0}},setup(n){const e=n,t=fe(),l=fe(),o=De(i()),s=L(()=>({left:o.left+"px",top:o.top+"px"})),r=Ii((a,u)=>{a=="end"&&(o.top=u.top,o.left=u.left);const f=t.value,g=l.value,v=(u.left+g.offsetWidth/2)/f.offsetWidth*100,_=100-(u.top+g.offsetHeight)/f.offsetHeight*100;e.modelValue.setSaturation(v),e.modelValue.setValue(_)});function i(){const a=t.value,u=l.value;if(a==null||u==null)return{top:-6,left:-6};const f=e.modelValue.s,v=(100-e.modelValue.v)/100*a.offsetHeight,_=f/100*a.offsetWidth;return{top:v-u.offsetHeight/2,left:_-u.offsetWidth/2}}return ln(()=>{const a=i();o.top=a.top,o.left=a.left}),(a,u)=>(R(),I("div",{class:m(a.classes.svPanel),onPointerdown:u[0]||(u[0]=(...f)=>y(r)&&y(r)(...f)),ref_key:"svPanelRef",ref:t},[d("div",{class:m(a.classes.thumb),style:K(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Oi="_svPanel_1sv6o_2",Di="_thumb_1sv6o_10",xi={svPanel:Oi,thumb:Di},Ai={classes:xi},Mi=z(Ni,[["__cssModules",Ai]]),Bi=V({__name:"HueSlider",props:{modelValue:{type:Ln,required:!0}},setup(n){const e=n,t=ue(-6),l=fe(),o=fe(),s=co((i,a)=>{i=="end"&&(t.value=a);const u=l.value,f=o.value,g=Math.round((a+f.offsetWidth/2)/u.offsetWidth*360);e.modelValue.setHue(g)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const u=e.modelValue.h;return Math.round(u/360*i.offsetWidth)-a.offsetWidth/2}return ln(()=>{t.value=r()}),(i,a)=>(R(),I("div",{class:m(i.classes.hue),onPointerdown:a[0]||(a[0]=(...u)=>y(s)&&y(s)(...u)),ref_key:"hueRef",ref:l},[d("div",{class:m(i.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),qi="_hue_1ozoc_2",$i="_thumb_1ozoc_10",Pi={hue:qi,thumb:$i},Vi={classes:Pi},Fi=z(Bi,[["__cssModules",Vi]]),zi=V({__name:"AlphaSlider",props:{modelValue:{type:Ln,required:!0}},setup(n){const e=n,t=ue(-6),l=fe(),o=fe(),s=co((i,a)=>{i=="end"&&(t.value=a);const u=l.value,f=o.value,g=Math.round((a+f.offsetWidth/2)/u.offsetWidth*100);e.modelValue.setAlpha(g)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const u=e.modelValue.a;return Math.round(u/100*i.offsetWidth)-a.offsetWidth/2}return ln(()=>{t.value=r()}),(i,a)=>(R(),I("div",{class:m(i.classes.alpha),onPointerdown:a[0]||(a[0]=(...u)=>y(s)&&y(s)(...u)),ref_key:"alphaRef",ref:l},[d("div",{class:m(i.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Ui="_alpha_1x8jd_2",Hi="_thumb_1x8jd_26",Gi={alpha:Ui,thumb:Hi},Wi={classes:Gi},Yi=z(zi,[["__cssModules",Wi]]),Xi=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function ji(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function Zi(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const Rl={isSupport:ji,open:Zi},Ki=["title","onClick"],Ji=["title","onClick"],kl="quickprint-recent-use-colors",Qi=V({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=ue(new Ln(l.modelValue)),r=fe(),i=fe(),a=ue(N()),u=Rl.isSupport(),f=ue("hex"),g=L(()=>{const k=l.modelValue;return k?{backgroundColor:k}:null}),v=L(()=>{const k=s.value,{r:w,g:A,b:P}=k.rgb();return{"--hue-channel-color":`hsl(${k.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${w}, ${A}, ${P}, 0)`,"--alpha-channel-color-b":`rgba(${w}, ${A}, ${P}, 1)`}}),_=L({get(){return s.value.toString(f.value)},set(k){s.value.setColor(k)}});function b(){var k;(k=r.value)==null||k.close()}function c(k){k!=null&&(t("update:modelValue",k),t("select",k),C(k),b())}function h(){t("update:modelValue",void 0),t("select",void 0),b()}function T(){Rl.open().then(k=>c(k))}function N(){const k=localStorage.getItem(kl);if(k==null||k=="")return[];const w=_n(k);return w==null?[]:Array.isArray(w)?w:[]}function C(k){const w=a.value,A=w.indexOf(k);A>=0&&w.splice(A,1),w.length>10&&w.pop(),w.unshift(k),localStorage.setItem(kl,JSON.stringify(w))}function D(){t("update:modelValue",s.value.toString(f.value)),t("select",s.value.toString(f.value)),b()}return il(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(k,w)=>(R(),J(io,{class:m(k.classes.colorPicker),onMousedown:w[7]||(w[7]=ne(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:ke(()=>[d("div",{class:m(k.classes.colorPickerPanel)},[d("div",{class:m(k.classes.presetPanel)},[d("div",{class:m(k.classes.presetTools)},[d("button",{type:"button",class:m(k.classes.clearBtn),onClick:h},[d("span",{class:m(k.classes.none)},null,2),w[8]||(w[8]=d("span",null,"无颜色",-1))],2),y(u)?(R(),I("button",{key:0,type:"button",class:m(k.classes.indicator),onClick:T},[p(F,{icon:"icon-eye-dropper"}),w[9]||(w[9]=d("span",null,"拾色器",-1))],2)):G("",!0)],2),d("div",{class:m(k.classes.colourAtla)},[(R(!0),I(Q,null,re(y(Xi),A=>(R(),I("div",{style:K({backgroundColor:A}),title:A,class:m(k.classes.color),onClick:P=>c(A)},null,14,Ki))),256))],2),d("div",{class:m(k.classes.recentColors)},"最近使用",2),d("div",{class:m(k.classes.colourAtla)},[(R(),I(Q,null,re(10,A=>d("div",{key:A,title:a.value[A-1],style:K({backgroundColor:a.value[A-1]}),class:m(k.classes.color),onClick:P=>c(a.value[A-1])},null,14,Ji)),64))],2)],2),d("div",{class:m(k.pacls.panel),style:K(v.value)},[p(Mi,{class:m(k.pacls.sv),modelValue:s.value,"onUpdate:modelValue":w[1]||(w[1]=A=>s.value=A)},null,8,["class","modelValue"]),d("div",{class:m(k.pacls.sliders)},[p(Fi,{class:m(k.pacls.hua),modelValue:s.value,"onUpdate:modelValue":w[2]||(w[2]=A=>s.value=A)},null,8,["class","modelValue"]),p(Yi,{modelValue:s.value,"onUpdate:modelValue":w[3]||(w[3]=A=>s.value=A)},null,8,["modelValue"]),d("div",{class:m(k.pacls.preview)},[d("div",{class:m(k.pacls.previewColor),style:K({backgroundColor:s.value.toRGB()})},null,6)],2)],2),d("div",{class:m(k.pacls.tools)},[p(ee,{options:o,teleport:"none",modelValue:f.value,"onUpdate:modelValue":w[4]||(w[4]=A=>f.value=A),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Se(d("input",{type:"text","onUpdate:modelValue":w[5]||(w[5]=A=>_.value=A),onMousedown:w[6]||(w[6]=ne(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[qe,_.value]]),d("button",{type:"button",class:m(k.pacls.confirm),onClick:D},"确定",2)],2)],6)],2)]),default:ke(()=>[d("div",{class:m({[k.classes.colorPickerInput]:!0,[k.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[et(k.$slots,"default",{},()=>[d("span",{class:m(k.classes.colorBlock),style:K(g.value)},null,6)]),n.showText?(R(),I("div",{key:0,class:m(k.classes.colorValue),onClick:w[0]||(w[0]=ne(()=>{},["stop"]))},Z(n.modelValue),3)):G("",!0)],2)]),_:3},8,["class","disabled"]))}}),er="_colorPicker_1egpm_2",tr="_disabled_1egpm_6",nr="_colorPickerInput_1egpm_10",lr="_colorBlock_1egpm_17",or="_colorValue_1egpm_26",sr="_colorPickerPanel_1egpm_31",ir="_presetPanel_1egpm_45",rr="_colourAtla_1egpm_49",ar="_color_1egpm_2",cr="_presetTools_1egpm_76",ur="_clearBtn_1egpm_82",dr="_indicator_1egpm_83",fr="_none_1egpm_101",pr="_recentColors_1egpm_132",mr={colorPicker:er,disabled:tr,colorPickerInput:nr,colorBlock:lr,colorValue:or,colorPickerPanel:sr,presetPanel:ir,colourAtla:rr,color:ar,presetTools:cr,clearBtn:ur,indicator:dr,none:fr,recentColors:pr},gr="_panel_911zv_2",hr="_sv_911zv_7",vr="_hua_911zv_11",br="_sliders_911zv_15",yr="_tools_911zv_20",_r="_confirm_911zv_37 quickprint-text-btn",Er="_preview_911zv_44",Tr="_previewColor_911zv_59",Sr={panel:gr,sv:hr,hua:vr,sliders:br,tools:yr,confirm:_r,preview:Er,previewColor:Tr},Rr={classes:mr,pacls:Sr},Bt=z(Qi,[["__cssModules",Rr]]),kr=V({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=L({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=L(()=>{const i=l.modelValue;return $l(i)||i===Oe.INHERIT});function r(i){t("select",i)}return(i,a)=>(R(),J(Bt,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=u=>o.value=u),disabled:n.disabled,onSelect:r},{default:ke(()=>[d("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[d("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:K({backgroundColor:o.value})},null,6),d("div",{class:m(i.classes.colorValue)},Z(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),wr="_indicator_14ypk_2",Cr="_disabled_14ypk_8",Lr="_colorBlock_14ypk_27",Ir="_colorValue_14ypk_38",Nr="_colorNone_14ypk_45",Or={indicator:wr,disabled:Cr,colorBlock:Lr,colorValue:Ir,colorNone:Nr},Dr={classes:Or},mn=z(kr,[["__cssModules",Dr]]);function xr(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function Ar(n,e=0){let t=0,l=null;return function(...o){const s=Date.now();if(s-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,o),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,o),t=s}}function uo(n,e={}){const t={},l=n.style??{},o=ll(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=Pl(l);return s&&Ge(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),Br("border",e)&&Ge(t,Wn(n)),Ge(t,Uo(n)),Ge(t,Ho(n)),Ge(t,Go(n)),Ge(t,Wo(n)),t}function Mr(n,e={}){const t=[];let l=n;for(;pe.isDefineElement(l);)t.unshift(uo(l,e)),l=l.parent;return zo({},...t)}function Br(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const yt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(yt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(yt.SPACE).filter(o=>tl(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(yt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(yt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(yt.SPACE))}};function Qe(n){if(ie(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em|%)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=nl(t)?t:null,o=ie(e[2])?null:e[2];return{num:l,unit:o}}function jn(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=Qe(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return Gn.pt_to_px(e.num);case"mm":return Gn.mm_to_px(e.num);default:return null}}function cl(n,e){const t=n.ds;if(t!=null)return t.type===ye.FORMULA?{type:t.type,content:ul(t.value,n.doc)}:t.type===ye.VARIABLE?{type:t.type,content:tt(t.value,e)}:{type:t.type,content:t.value}}function tt(n,e){var v,_,b;if(ie(n))return n;const t=Vl(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===Tt.BUILTIN)return((v=Yn.find(c=>c.value===s))==null?void 0:v.label)??s;if(t.varType===Tt.SPECIAL)return((_=ks.find(c=>c.value===s))==null?void 0:_.label)??s;if(e==null)return l;const i=(e.fields??[]).find(c=>c.name===s);if(i==null)return l;const a=o[1],u=ie(i.title)?i.name:i.title;if(a==null)return u;const f=(b=i.children)==null?void 0:b.find(c=>c.name===a);if(f==null)return`${u}.${a}`;const g=ie(f.title)?f.name:f.title;return`${u}.${g}`}function ul(n,e){return ie(n)?void 0:En.tokenize(n).map(o=>o.type===st.VARIABLE?`[${tt(o.value,e==null?void 0:e.ds)}]`:o.type===st.REFERENCE?`[${fo(o.value,e)}]`:o.type===st.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===st.VARIABLE?`[${tt(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):En.formatTokenValue(o)).join("")}function fo(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===ye.VARIABLE&&t.ds.value?tt(t.ds.value,e.ds):"="+n}function qr(n){switch(Vl(n).dataType){case te.OBJECT:return"对象";case te.ARRAY:return"数组";case te.STRING:return"文本";case te.NUMBER:return"数字";case te.DATE:return"日期";case te.BOOLEAN:return"布尔";default:return"未知类型"}}function $r(n){var e;return((e=Jl.find(t=>t.value===n))==null?void 0:e.label)??n}const po=Fl(()=>zl(()=>import("./component-BzOvwT-C.js"),__vite__mapDeps([0,1]))),Pr=["onClick","onMouseenter"],Vr=V({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=ue(Yn[0].value),o=L(()=>`builtin_${Ul(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,a)=>(R(),I("div",{class:m(i.classes.builtin)},[d("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(R(!0),I(Q,null,re(y(Yn),u=>(R(),I("div",{class:m({[i.classes.param]:!0,[i.classes.active]:u.value===l.value}),onClick:f=>s(u),onMouseenter:f=>r(u)},[d("strong",null,Z(u.label),1),d("span",null,Z(u.value),1)],42,Pr))),256))],2),d("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[p(y(po),{name:o.value},null,8,["name"])],2)],2))}}),Fr="_builtin_m1n0z_2",zr="_panel_m1n0z_11",Ur="_desc_m1n0z_17",Hr="_param_m1n0z_24",Gr="_active_m1n0z_34",Wr={builtin:Fr,panel:zr,desc:Ur,param:Hr,active:Gr},Yr={classes:Wr},Xr=z(Vr,[["__cssModules",Yr]]),wl=[{label:"文本",value:te.STRING},{label:"数字",value:te.NUMBER},{label:"日期",value:te.DATE},{label:"对象",value:te.OBJECT},{label:"数组",value:te.ARRAY}],jr=V({emit:["select"],props:{doc:{type:be,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Le("classes"),o=nt(),s=a(),r=i();function i(){const h=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(T,N,C){var D;if(n.readonly){const k=T[N.name],w=((D=wl.find(A=>A.value===k))==null?void 0:D.label)??k;return p("div",{class:C.classes.cell},[w])}return p("div",{class:C.classes.cell},[p(ee,{options:wl,modelValue:T.type,"onUpdate:modelValue":_.bind(null,T),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(T,N,C){return n.readonly?p("div",{class:C.classes.cell},[T[N.name]]):p("div",{class:C.classes.cell},[Se(p("input",{"onUpdate:modelValue":D=>T.name=D,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[qe,T.name]])])}},{name:"title",title:"标题",width:180,render(T,N,C){return n.readonly?p("div",{class:C.classes.cell},[T[N.name]]):p("div",{class:C.classes.cell},[Se(p("input",{"onUpdate:modelValue":D=>T.title=D,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[qe,T.title]])])}}];return n.readonly!==!0&&h.push({name:"operate",title:"操作",width:200,render(T,N,C){const D=[p("button",{type:"button",class:"quickprint-text-btn",onClick:f.bind(null,T,C.parent)},[p(F,{icon:"icon-subnode"},null),p("span",null,[le("插入行")])])];return(T.type===te.ARRAY||T.type===te.OBJECT)&&D.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:v.bind(null,T)},[p(F,{icon:"icon-sisternode"},null),p("span",null,[le("插入子级")])])),D.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:g.bind(null,T,C.parent)},[p(F,{icon:"icon-delete"},null),p("span",null,[le("删除")])])),D}}),h}function a(){const h=Yo(n.doc.ds.fields??[]).map(N=>{const C=N.type;return{...N,$expand:C===te.ARRAY||C===te.OBJECT}}),T=ue(h);return T.value.length==0&&T.value.push(u()),T}function u(){return{type:te.STRING,name:"",title:""}}function f(h,T){if(T){const C=T.children??[],D=C.indexOf(h);D>=0&&C.splice(D+1,0,u());return}const N=s.value.indexOf(h);N>=0&&s.value.splice(N+1,0,u())}function g(h,T){if(T){const C=T.children??[],D=C.indexOf(h);D>=0&&C.splice(D,1);return}const N=s.value.indexOf(h);N>=0&&s.value.splice(N,1),s.value.length==0&&s.value.push(u())}function v(h){h.type!==te.ARRAY&&h.type!==te.OBJECT||(h.children==null&&(h.children=[]),h.children.push(u()))}function _(h,T){h.type=T,T===te.ARRAY||T===te.OBJECT?h.$expand=!0:h.children=void 0}function b(){return{fields:s.value.map(T=>ie(T.name)?null:T.type!==te.ARRAY&&T.type!==te.OBJECT?{type:T.type,name:T.name,title:T.title}:{type:T.type,name:T.name,title:T.title,children:(T.children??[]).map(N=>ie(T.name)?null:{type:N.type,name:N.name,title:N.title}).filter(N=>N!=null)}).filter(T=>T!=null)}}function c(h,T){n.readonly===!0&&t("select",h,T)}return o==null||o.useHandle("confirm",b),e({submit:b}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(Xo,{columns:r,data:s.value,onSelect:c},null)])}}}),Zr="_form_6lybl_2",Kr="_readonly_6lybl_6",Jr="_datasource_6lybl_11",Qr={form:Zr,readonly:Kr,datasource:Jr},ea={classes:Qr},mo=z(jr,[["__cssModules",ea]]),ta={class:"quickprint-config-group"},na={class:"quickprint-config-section quickprint-config-inline"},la={class:"quickprint-config-content"},oa={class:"quickprint-config-section quickprint-config-inline"},sa={class:"quickprint-config-content"},ia={class:"quickprint-config-id"},ra={class:"quickprint-config-section quickprint-config-inline"},aa={class:"quickprint-config-content"},ca={class:"quickprint-config-group"},ua={class:"quickprint-config-group-title"},da=V({__name:"Detail",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=L(()=>{var l,o;return(o=cl(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:o.content});return(l,o)=>(R(),I("div",{class:m(l.classes.detail)},[d("div",ta,[d("section",na,[o[0]||(o[0]=d("header",{class:"quickprint-config-header"},"类型",-1)),d("div",la,Z(y(tn)(n.element.type)),1)]),d("section",oa,[o[1]||(o[1]=d("header",{class:"quickprint-config-header"},"标识",-1)),d("div",sa,[d("span",ia,Z(n.element.id),1)])]),d("section",ra,[o[2]||(o[2]=d("header",{class:"quickprint-config-header"},"标题",-1)),d("div",aa,Z(n.element.title),1)])]),d("div",ca,[d("div",ua,[o[3]||(o[3]=d("span",null,"数据",-1)),d("span",{class:m(l.classes.type)},Z(y($r)(n.element.ds.type)),3)]),d("div",null,Z(t.value),1)])],2))}}),fa="_detail_11ox4_2",pa="_type_11ox4_10",ma={detail:fa,type:pa},ga={classes:ma},ha=z(da,[["__cssModules",ga]]),va=V({__name:"index",props:{doc:{type:be,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=ue();function r(v){return v.reduce((_,b)=>{const c=Array.isArray(b.children)?r(b.children):[];if(tl(b.ds.value)||c.length>0){const h={value:b.id,label:b.title??b.id,data:b,children:c};return _.push(h),_}return _},[])}function i(){const v=l.doc.pages.reduce((b,c)=>b.concat(c.children),[]),_=r(v);return ue(_)}function a(v){s.value=v}function u(v){return v.title?v.title:tn(v.type)}function f(v){return lp(v.type)??"icon-zhanweifu"}function g(v){t("select",v.data)}return(v,_)=>(R(),I("div",{class:m(v.classes.reference)},[d("div",{class:m([v.classes.panel,"quickprint-is-scrollable"])},[p(y(Si),{data:y(o),onNodeHover:a,onNodeClick:g},{default:ke(({node:b})=>[p(y(F),{icon:f(b.data)},null,8,["icon"]),d("span",{class:m(v.classes.title)},Z(u(b.data)),3),d("span",{class:m(v.classes.id)},"<"+Z(b.value)+">",3)]),_:1},8,["data"])],2),d("div",{class:m([v.classes.detail,"quickprint-is-scrollable"])},[s.value?(R(),J(ha,{element:s.value.data,key:s.value.value},null,8,["element"])):G("",!0)],2)],2))}}),ba="_reference_1ekkx_2",ya="_panel_1ekkx_12",_a="_detail_1ekkx_20",Ea="_title_1ekkx_25",Ta="_id_1ekkx_29",Sa={reference:ba,panel:ya,detail:_a,title:Ea,id:Ta},Ra={classes:Sa},ka=z(va,[["__cssModules",Ra]]),wa=V({__name:"index",props:{doc:{type:be,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=nt();function t(r,i){return r==null?null:i==null?`${Tt.DS}.${r.type}.${r.name}`:`${Tt.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${Tt.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(R(),I("div",{class:m(r.classes.var)},[n.active==="ds"?(R(),J(mo,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):G("",!0),n.active==="builtin"?(R(),J(Xr,{key:1,onSelect:o})):G("",!0),n.active==="reference"?(R(),J(ka,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):G("",!0)],2))}}),Ca={var:"_var_12wxd_2"},La={classes:Ca},go=z(wa,[["__cssModules",La]]),Ia=["onClick","onMouseenter"],Na=V({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var a;const t=n,l=e,o=ue((a=t.options[0])==null?void 0:a.value),s=L(()=>`${t.type}_${o.value.toLowerCase()}`);function r(u){l("select",u.value)}function i(u){o.value=u.value}return(u,f)=>(R(),I("div",{class:m(u.classes.doc)},[d("div",{class:m(["quickprint-is-scrollable",u.classes.panel])},[(R(!0),I(Q,null,re(n.options,g=>(R(),I("div",{key:g.value,class:m({[u.classes.option]:!0,[u.classes.active]:g.value===o.value}),onClick:v=>r(g),onMouseenter:v=>i(g)},[d("strong",null,Z(g.label),1)],42,Ia))),128))],2),d("div",{class:m(["quickprint-is-scrollable",u.classes.desc])},[p(y(po),{name:s.value},null,8,["name"])],2)],2))}}),Oa="_doc_1pdoc_2",Da="_panel_1pdoc_10",xa="_desc_1pdoc_16",Aa="_option_1pdoc_23",Ma="_active_1pdoc_33",Ba={doc:Oa,panel:Da,desc:xa,option:Aa,active:Ma},qa={classes:Ba},Xt=z(Na,[["__cssModules",qa]]),$a=V({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=nt(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(a){return e==null?void 0:e.confirm({type:"function",value:`${a}()`})}return(a,u)=>(R(),I("div",{class:m(a.classes.function)},[n.active==="string"?(R(),J(Xt,{options:t,onSelect:i,key:"string"})):G("",!0),n.active==="number"?(R(),J(Xt,{options:l,onSelect:i,key:"number"})):G("",!0),n.active==="logical"?(R(),J(Xt,{options:o,onSelect:i,key:"logical"})):G("",!0),n.active==="date"?(R(),J(Xt,{options:s,onSelect:i,key:"date"})):G("",!0),n.active==="aggregate"?(R(),J(Xt,{options:r,onSelect:i,key:"aggregate"})):G("",!0)],2))}}),Pa={function:"_function_19szx_2"},Va={classes:Pa},Fa=z($a,[["__cssModules",Va]]),za=["onMouseenter"],Ua=["onClick"],Ha={key:1},Ga=V({__name:"Formula",props:{doc:{type:be,default:null}},setup(n){const e=n,t=nt(),l=[{id:"pageNumber",name:"页码",options:a(Ns)}],o=ue(l[0]);function s(u){o.value=u}function r(u){return t==null?void 0:t.confirm({type:"formula",value:u})}function i(u){const f=En.tokenize(u),g=e.doc;return f.reduce((v,_)=>{if(_.type===st.VARIABLE)return v.push({type:"highlight",value:tt(_.value,g==null?void 0:g.ds)}),v;if(_.type===st.REFERENCE)return v.push({type:"highlight",value:fo(_.value,g)}),v;if(_.type===st.TEMPLATE){const c=(Array.isArray(_.value)?_.value:[_.value]).map(h=>h.type===st.VARIABLE?{type:"highlight",value:tt(h.value,g.ds)}:{type:"text",value:h.value});return v.concat(c)}return v.push({type:"text",value:En.formatTokenValue(_)}),v},[])}function a(u){return u.map(f=>({nodes:i(f),value:f}))}return(u,f)=>(R(),I("div",{class:m(u.classes.formula)},[d("div",{class:m([u.classes.left,"quickprint-is-scrollable"])},[(R(),I(Q,null,re(l,g=>d("div",{key:g.name,onMouseenter:v=>s(g),class:m({[u.classes.group]:!0,[u.classes.active]:g.id===o.value.id})},Z(g.name),43,za)),64))],2),d("div",{class:m(u.classes.right)},[(R(!0),I(Q,null,re(o.value.options,(g,v)=>(R(),I("div",{key:v,class:m(u.classes.code),onClick:_=>r(g.value)},[(R(!0),I(Q,null,re(g.nodes,_=>(R(),I(Q,null,[_.type==="highlight"?(R(),I("span",{key:0,class:m(u.classes.highlight)},"["+Z(_.value)+"]",3)):(R(),I("span",Ha,Z(_.value),1))],64))),256)),d("span",{class:m(u.classes.badge)},"插入",2)],10,Ua))),128))],2)],2))}}),Wa="_formula_ms7c3_2",Ya="_left_ms7c3_12",Xa="_right_ms7c3_17",ja="_group_ms7c3_24",Za="_active_ms7c3_34",Ka="_highlight_ms7c3_39",Ja="_code_ms7c3_43",Qa="_badge_ms7c3_65",ec={formula:Wa,left:Ya,right:Xa,group:ja,active:Za,highlight:Ka,code:Ja,badge:Qa},tc={classes:ec},nc=z(Ga,[["__cssModules",tc]]),dl=xe(function(n){return wt("变量",(e,t)=>p(go,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Ae)}),lc=xe(function(n){return at("数据源",p(mo,{doc:n},null),{preset:"variable",icon:p(F,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Ae)}),oc=xe(function(n){const e=["ds","builtin","reference"];return wt("变量",(t,l)=>p(go,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Ae)}),sc=xe(function(){return wt("函数",(n,e)=>p(Fa,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(Ae)}),ic=xe(function(n){return at("公式",p(nc,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Ae)}),rc={key:1},ac=V({__name:"Content",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Re(),l=Ut("editorRef"),o=Ut("contentRef"),s=ue(!1),r=L(()=>{const f=e.element.type===Y.TABLE_CELL?Mr(e.element,{exclude:["border"]}):uo(e.element);return f.color&&(f["--quickprint-element-var-color"]=f.color),s.value&&(f.alignItems="flex-start"),f}),i=L(()=>{const f=cl(e.element,t.doc.ds);return f==null||f.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:f.type===ye.CONST?"span":"strong",content:f.content},{tag:"span",content:e.element.attributes.suffix}]});async function a(){var _;const f=await dl({doc:t.doc,value:e.element.ds.value}).catch(je);if(f==null||(e.element.setDataSource(ye.VARIABLE,f.value),e.element.type!=Y.TABLE_CELL||f.type!=="ds"))return;const g=e.element.parent;if(g==null||g.isBindVariable||((_=f.parent)==null?void 0:_.type)!==te.ARRAY)return;const v=f.parent;g.setDataSource(ye.VARIABLE,`${Tt.DS}.${v.type}.${v.name}`)}function u(){const f=l.value,g=o.value;f==null||g==null||(s.value=g.offsetHeight>f.offsetHeight)}return(f,g)=>(R(),I("div",{class:"quickprint-is-element-editor",style:K(r.value),onVnodeMounted:u,ref_key:"editorRef",ref:l},[d("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:o},[d("span",{class:m({[f.classes.lineThrough]:n.element.style.lineThrough})},[(R(!0),I(Q,null,re(i.value,(v,_)=>(R(),I(Q,{key:_},[v.tag=="strong"?(R(),I("strong",{key:0,class:m(f.classes.highlight)},"["+Z(v.content)+"]",3)):(R(),I("span",rc,Z(v.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(R(),J(y(F),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(f.classes.dsIcon),onClick:a,onPointerdown:g[0]||(g[0]=ne(()=>{},["stop"]))},null,8,["class"])):G("",!0)],4))}}),cc="_dsIcon_ss96n_2",uc="_lineThrough_ss96n_10",dc="_highlight_ss96n_14",fc={dsIcon:cc,lineThrough:uc,highlight:dc},pc={classes:fc},In=z(ac,[["__cssModules",pc]]),mc=V({__name:"TextEditor",props:{element:{type:jo,required:!0}},setup(n){return(e,t)=>(R(),J(In,{element:n.element},null,8,["element"]))}}),Nn=Object.freeze({title:"文本",icon:"icon-text",type:Y.TEXT,editor:mc,onCreate(){return pe.create({type:Y.TEXT,width:St,height:Cn})}}),gc=V({__name:"NumberEditor",props:{element:{type:Zo,required:!0}},setup(n){return(e,t)=>(R(),J(In,{element:n.element},null,8,["element"]))}}),hc=["value","disabled"],vc=V({__name:"RadioButton",props:kt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=nn(n,"modelValue");return(t,l)=>(R(),I("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(R(!0),I(Q,null,re(n.options,o=>(R(),I("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[Se(d("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,hc),[[gs,e.value]]),d("span",null,Z(o.label),1)],2))),256))],2))}}),bc="_radioGroup_67myk_2",yc="_compacted_67myk_10",_c="_radio_67myk_2",Ec="_selected_67myk_50",Tc="_disabled_67myk_56",Sc={radioGroup:bc,compacted:yc,radio:_c,selected:Ec,disabled:Tc},Rc={classes:Sc},xt=z(vc,[["__cssModules",Rc]]),kc={class:"quickprint-config-section quickprint-config-inline"},wc={class:"quickprint-config-content"},Cc={class:"quickprint-config-section quickprint-config-inline"},Lc={class:"quickprint-config-content"},Ic={class:"quickprint-config-section quickprint-config-inline"},Nc={class:"quickprint-config-content"},Oc={class:"quickprint-config-section quickprint-config-inline"},Dc={class:"quickprint-config-content"},xc=V({__name:"NumberConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=L({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=L({get(){return e.element.attributes.round??Zt.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=L({get(){return e.element.attributes.format??ht.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(R(),I(Q,null,[d("section",kc,[r[4]||(r[4]=d("header",{class:"quickprint-config-header"},"小数位数",-1)),d("div",wc,[Se(d("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[qe,n.element.attributes.precision]])])]),d("section",Cc,[r[5]||(r[5]=d("header",{class:"quickprint-config-header"},"舍入规则",-1)),d("div",Lc,[p(y(ee),{options:y(Es),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),d("section",Ic,[r[6]||(r[6]=d("header",{class:"quickprint-config-header"},"显示类型",-1)),d("div",Nc,[p(y(ee),{options:y(Ts),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),d("section",Oc,[r[7]||(r[7]=d("header",{class:"quickprint-config-header"},"值为0时",-1)),d("div",Dc,[p(xt,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:y(Ss),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),On=Object.freeze({title:"数字",type:Y.NUMBER,icon:"icon-number",editor:gc,config:{display:xc},onCreate(){return pe.create({type:Y.NUMBER,width:St,height:Cn})}}),Ac=V({__name:"DateEditor",props:{element:{type:Ko,required:!0}},setup(n){return(e,t)=>(R(),J(In,{element:n.element},null,8,["element"]))}}),Mc={class:"quickprint-config-section"},Bc={class:"quickprint-config-content"},qc=V({__name:"DateConfig",props:{element:{type:pe,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=L(()=>[{label:"原始值",value:t.NONE},...Ql]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(R(),I("section",Mc,[d("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=d("span",null,"格式",-1)),p(y(ee),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:ke(()=>[d("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),d("div",Bc,[Se(d("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[qe,n.element.attributes.format]])])]))}}),$c="_header_79607_2",Pc="_picker_79607_8",Vc="_placeholder_79607_15",Fc={header:$c,picker:Pc,placeholder:Vc},zc={classes:Fc},Uc=z(qc,[["__cssModules",zc]]),Dn=Object.freeze({title:"日期",type:Y.DATE,icon:"icon-date",editor:Ac,config:{display:Uc},onCreate(){return pe.create({type:Y.DATE,width:St,height:Cn})}}),Hc=["colspan","rowspan"],Gc=V({__name:"TableCellEditor",props:{element:{type:Tn,required:!0}},setup(n){const e=n,t=L(()=>e.element.isCollapsed),l=Re(),o=Le("classes"),s=L(()=>{const a=e.element,u=a.parent;return{[o.cell]:!0,[X.SELECTED]:(u==null?void 0:u.isSelected)||a.isSelected}}),r=L(()=>{var f;const a=Wn((f=e.element.parent)==null?void 0:f.parent),u=Wn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Ge(a,u)}});function i(a){a.button==0&&l.selectElement(e.element)}return(a,u)=>t.value?G("",!0):(R(),I("td",Xl({key:0,[`.${y(ze)||""}`]:n.element,class:s.value,style:r.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:ne(i,["stop"])}),[p(In,{element:n.element,class:m(y(o).content)},null,8,["element","class"])],48,Hc))}}),Wc="_cell_rp1x6_2",Yc="_content_rp1x6_31",Xc={cell:Wc,content:Yc},jc={classes:Xc},ho=z(Gc,[["__cssModules",jc]]);function fl(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const Zc=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:se.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],vo=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],bo=[{label:"默认",value:se.DEFAULT},...vo],xn=[{label:"默认",value:se.DEFAULT},...Zc,...vo],pl=[{label:"默认",value:Ee.DEFAULT},{label:"初号",value:Ee.SIZE_0+"pt",short:"56px"},{label:"小初",value:Ee.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:Ee.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:Ee.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:Ee.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:Ee.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:Ee.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:Ee.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:Ee.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:Ee.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:Ee.SIZE_5+"pt",short:"14px"},{label:"小五",value:Ee.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],yo=[{label:"默认",value:vt.DEFAULT},{label:"1.0",value:vt.TIMES_1,short:"单倍行距"},{label:"1.1",value:vt.TIMES_1_1},{label:"1.5",value:vt.TIMES_1_5},{label:"2.0",value:vt.TIMES_2,short:"两倍行距"}],Kc=[{label:"无",value:un.NONE},{label:"实线",value:It.SOLID},{label:"虚线",value:It.DASHED},{label:"点划线",value:It.DOTTED},{label:"双实线",value:It.DOUBLE},{label:"波浪线",value:It.WAVY}],Jc=[{label:"无",value:ae.NONE},{label:"实线",value:ae.SOLID},{label:"虚线",value:ae.DASHED},{label:"点划线",value:ae.DOTTED},{label:"双实线",value:ae.DOUBLE}],Qc=[{label:"默认",value:bt.AUTO},{label:"左对齐",value:bt.LEFT},{label:"居中对齐",value:bt.CENTER},{label:"右对齐",value:bt.RIGHT},{label:"两端对齐",value:bt.JUSTIFY}],Zn=[{label:"顶部对齐",value:Ze.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Ze.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Ze.BOTTOM,icon:"icon-vertical-align-bottom"}],Kn=[{label:"左对齐",value:it.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:it.CENTER,icon:"icon-align-center"},{label:"右对齐",value:it.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:it.JUSTIFY,icon:"icon-menu"}],eu={class:"quickprint-is-row"},tu=["onClick"],nu=V({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Le("classes"),o=e,s=n,r=fe(),i=L(()=>({height:s.height})),a=L({get(){return Qe(s.modelValue).num??void 0},set(b){if(b==""||Jo(b)||b<0){g(void 0);return}const c=Qe(s.modelValue);g(`${b}${c.unit}`)}}),u=L({get(){return Qe(s.modelValue).unit??Te.PX},set(b){const c=Qe(s.modelValue);g(`${c.num}${b}`)}});function f(b){const c=b===Ee.DEFAULT?void 0:b;o("update:modelValue",c)}function g(b){o("update:modelValue",b),_()}function v(b){const c=s.modelValue;return c==null&&b.value===Ee.DEFAULT?!0:c===b.value}async function _(){await zt();const b=document.querySelector("."+l.fontSelected);b&&b.scrollIntoView({block:"nearest"})}return(b,c)=>(R(),I("div",{class:m(y(l).fontSize),style:K(i.value)},[d("div",eu,[Se(d("input",{type:"number",placeholder:"请输入",class:m(["quickprint-form-control",y(l).input]),min:0,"onUpdate:modelValue":c[0]||(c[0]=h=>a.value=h)},null,2),[[qe,a.value]]),p(y(ee),{width:"54px",options:t,modelValue:u.value,"onUpdate:modelValue":c[1]||(c[1]=h=>u.value=h)},null,8,["modelValue"])]),d("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",y(l).fonts]),ref_key:"scrollRef",ref:r},[(R(!0),I(Q,null,re(y(pl),h=>(R(),I("div",{key:h.value,class:m({[y(l).option]:!0,[y(l).fontSelected]:v(h)}),onClick:T=>f(h.value)},[d("span",null,Z(h.label),1)],10,tu))),128))],2)],6))}}),lu="_input_9oh9n_2",ou="_fontSize_9oh9n_8",su="_fonts_9oh9n_13",iu="_option_9oh9n_25",ru="_fontSelected_9oh9n_34",au={input:lu,fontSize:ou,fonts:su,option:iu,fontSelected:ru},cu={classes:au},_o=z(nu,[["__cssModules",cu]]),uu=["title"],du={key:0},fu="中文字体 AbBbCc",pu=V({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=L(()=>xn.map(c=>(c.style={fontFamily:c.value==se.DEFAULT?se.SONG:c.value},c))),l=L(()=>bo.map(c=>(c.style={fontFamily:c.value==se.DEFAULT?se.SONG:c.value},c))),o=L({get(){const c=e.options.style.fontFamily;return ie(c)?se.DEFAULT:c},set(c){e.options.style.fontFamily=c==se.DEFAULT?void 0:c}}),s=L({get(){const c=e.options.style.enFontFamily;return ie(c)?se.DEFAULT:c},set(c){e.options.style.enFontFamily=c==se.DEFAULT?void 0:c}}),r=L({get(){const c=e.options.style.color;return ie(c)?Oe.INHERIT:c},set(c){e.options.style.color=c==Oe.INHERIT?void 0:c}}),i=L({get(){const c=e.options.style.highlightColor;return ie(c)?Oe.INHERIT:c},set(c){e.options.style.highlightColor=c==Oe.INHERIT?void 0:c}}),a=L({get(){return e.options.style.fontSize},set(c){const h=ie(c)?void 0:c;e.options.style.fontSize=h}}),u=L({get(){return e.options.style.fontWeight===700},set(c){e.options.style.fontWeight=c?700:void 0}}),f=L({get(){return e.options.style.fontStyle==="italic"},set(c){e.options.style.fontStyle=c?"italic":void 0}}),g=L({get(){return e.options.style.lineThrough===!0},set(c){e.options.style.lineThrough=c?!0:void 0}}),v=L({get(){const c=e.options.style.underline;if(c==null||c===!1)return un.NONE;const h=e.options.style.underlineStyle;return ie(h)?It.SOLID:h},set(c){if(c===un.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=c}}),_=L({get(){const c=e.options.style.underlineColor;return ie(c)?Oe.INHERIT:c},set(c){e.options.style.underlineColor=c==Oe.INHERIT?void 0:c}}),b=L(()=>{const c=e.options.style,h={},T=ll(c.fontFamily,c.enFontFamily);T&&(h.fontFamily=T);const N=Pl(c);return N&&Ge(h,N),c.fontSize&&(h.fontSize=c.fontSize),c.fontWeight&&(h.fontWeight=c.fontWeight),c.color&&(h.color=c.color),c.fontStyle&&(h.fontStyle=c.fontStyle),c.highlightColor&&(h["--quickprint-variable-highlight-color"]=c.highlightColor),h});return(c,h)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.font])},[d("div",{class:m(c.classes.fontFamily)},[d("div",{class:m(c.classes.config)},[d("div",{class:m(c.classes.title)},"中文字体",2),d("div",{class:m(c.classes.content)},[p(y(ee),{options:t.value,modelValue:o.value,"onUpdate:modelValue":h[0]||(h[0]=T=>o.value=T)},null,8,["options","modelValue"])],2)],2),d("div",{class:m(c.classes.config)},[d("div",{class:m(c.classes.title)},"颜色",2),p(y(mn),{modelValue:r.value,"onUpdate:modelValue":h[1]||(h[1]=T=>r.value=T)},null,8,["modelValue"])],2),d("div",{class:m([c.classes.config,c.classes.fontSize])},[d("div",{class:m(c.classes.title)},"字号",2),p(_o,{modelValue:a.value,"onUpdate:modelValue":h[2]||(h[2]=T=>a.value=T),height:"144px"},null,8,["modelValue"])],2),d("div",{class:m(c.classes.config)},[d("div",{class:m(c.classes.title)},"西文字体",2),d("div",{class:m(c.classes.content)},[p(y(ee),{options:l.value,modelValue:s.value,"onUpdate:modelValue":h[3]||(h[3]=T=>s.value=T)},null,8,["options","modelValue"])],2)],2),d("div",{class:m(c.classes.config)},[d("div",{class:m(c.classes.title)},"前景色",2),p(y(mn),{modelValue:i.value,"onUpdate:modelValue":h[4]||(h[4]=T=>i.value=T)},null,8,["modelValue"])],2),d("div",{class:m(c.classes.config)},[d("div",{class:m(c.classes.title)},"下划线",2),d("div",{class:m(c.classes.content)},[p(y(ee),{modelValue:v.value,"onUpdate:modelValue":h[5]||(h[5]=T=>v.value=T),options:y(Kc),width:"138px"},{option:ke(({option:T})=>[d("div",{title:T.label,class:m(c.classes.option)},[T.value==y(un).NONE?(R(),I("div",du,Z(T.label),1)):(R(),I("div",{key:1,class:m(c.classes.line),style:K({textDecorationStyle:T.value})},"--",6))],10,uu)]),_:1},8,["modelValue","options"])],2)],2),d("div",{class:m(c.classes.config)},[d("div",{class:m(c.classes.title)},"线条颜色",2),d("div",{class:m(c.classes.content)},[p(y(mn),{modelValue:_.value,"onUpdate:modelValue":h[6]||(h[6]=T=>_.value=T),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),d("div",{class:m(c.classes.fieldset)},[h[13]||(h[13]=d("header",null,"效果",-1)),d("div",{class:m(c.classes.configs)},[d("label",{class:m(c.classes.checkbox)},[Se(d("input",{type:"checkbox","onUpdate:modelValue":h[7]||(h[7]=T=>u.value=T)},null,512),[[zn,u.value]]),h[10]||(h[10]=d("span",null,"粗体",-1))],2),d("label",{class:m(c.classes.checkbox)},[Se(d("input",{type:"checkbox","onUpdate:modelValue":h[8]||(h[8]=T=>f.value=T)},null,512),[[zn,f.value]]),h[11]||(h[11]=d("span",null,"斜体",-1))],2),d("label",{class:m(c.classes.checkbox)},[Se(d("input",{type:"checkbox","onUpdate:modelValue":h[9]||(h[9]=T=>g.value=T)},null,512),[[zn,g.value]]),h[12]||(h[12]=d("span",null,"删除线",-1))],2)],2)],2),d("div",{class:m(c.classes.fieldset)},[h[14]||(h[14]=d("header",null,"预览",-1)),d("div",{class:m(c.classes.preview)},[d("span",{style:K(b.value)},[d("span",{class:m({[c.classes.lineThrough]:n.options.style.lineThrough})},Z(fu),2)],4)],2)],2)],2))}}),mu="_font_5dh9t_2",gu="_fontFamily_5dh9t_7",hu="_config_5dh9t_14",vu="_fontSize_5dh9t_19",bu="_fieldset_5dh9t_23",yu="_title_5dh9t_39",_u="_configs_5dh9t_44",Eu="_checkbox_5dh9t_50",Tu="_option_5dh9t_65",Su="_line_5dh9t_73",Ru="_preview_5dh9t_84",ku="_lineThrough_5dh9t_99",wu={font:mu,fontFamily:gu,config:hu,fontSize:vu,fieldset:bu,title:yu,configs:_u,checkbox:Eu,option:Tu,line:Su,preview:Ru,lineThrough:ku},Cu={classes:wu},Lu=z(pu,[["__cssModules",Cu]]),Iu=["placeholder","min","disabled"],Nu=V({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=L(()=>{const a=l.defaultUnit;return l.options.some(u=>u.value===a)?a:l.options[0].value}),s=L({get(){return Qe(l.modelValue).num},set(a){if(nl(a)){const f=Qe(l.modelValue).unit??o.value;return i(`${a}${f}`)}i()}}),r=L({get(){return Qe(l.modelValue).unit??o.value},set(a){const f=Qe(l.modelValue).num??l.min;i(`${f}${a}`)}});function i(a=void 0){t("update:modelValue",a)}return(a,u)=>(R(),I("div",{class:m(a.classes.input)},[Se(d("input",{type:"number","onUpdate:modelValue":u[0]||(u[0]=f=>s.value=f),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,Iu),[[qe,s.value]]),p(y(ee),{modelValue:r.value,"onUpdate:modelValue":u[1]||(u[1]=f=>r.value=f),class:m(a.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),Ou="_input_gtdaq_2",Du="_unit_gtdaq_14",xu={input:Ou,unit:Du},Au={classes:xu},We=z(Nu,[["__cssModules",Au]]),Mu="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",Bu=V({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Te.NONE},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],l=[{label:"字符",value:Te.EM},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],o=[{label:"毫米",value:Te.MM},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],s=L({get(){return e.options.style.textAlign??it.LEFT},set(h){const T=h===it.LEFT?void 0:h;e.options.style.textAlign=T}}),r=L({get(){return e.options.style.textAlignLast??bt.AUTO},set(h){const T=h===bt.AUTO?void 0:h;e.options.style.textAlignLast=T}}),i=L({get(){return e.options.style.verticalAlign??Ze.MIDDLE},set(h){const T=h===Ze.MIDDLE?void 0:h;e.options.style.verticalAlign=T}}),a=b("paddingTop"),u=b("paddingBottom"),f=b("paddingLeft"),g=b("paddingRight"),v=L(()=>{const h=e.options.style,T={};return h.textAlign&&(T.textAlign=h.textAlign),h.textAlignLast&&(T.textAlignLast=h.textAlignLast),h.textIndent&&(T.textIndent=h.textIndent),h.lineHeight&&(T.lineHeight=h.lineHeight),Ge(T,c(h.verticalAlign)),T}),_=L(()=>{const h=e.options.style,T={};return T["--openprint-paragraph-preview-padding-top"]=h.paddingTop??"2px",T["--openprint-paragraph-preview-padding-right"]=h.paddingRight??"2px",T["--openprint-paragraph-preview-padding-bottom"]=h.paddingBottom??"2px",T["--openprint-paragraph-preview-padding-left"]=h.paddingLeft??"2px",T});function b(h){return L({get(){return e.options.style[h]},set(T){const N=ie(T)?void 0:T;e.options.style[h]=N}})}function c(h){return h==null?{}:h==Ze.MIDDLE||h==null?{display:"flex",alignItems:"center"}:h==Ze.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(h,T)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",h.classes.paragraph])},[d("div",{class:m(h.classes.textAlign)},[d("div",{class:m(h.classes.configItem)},[d("div",{class:m(h.classes.configItemLabel)},"文本对齐",2),p(y(ee),{options:y(Kn),modelValue:s.value,"onUpdate:modelValue":T[0]||(T[0]=N=>s.value=N)},null,8,["options","modelValue"])],2),d("div",{class:m(h.classes.alignLast)},[d("div",{class:m(h.classes.configItemLabel)},"最后一行",2),p(y(ee),{options:y(Qc),modelValue:r.value,"onUpdate:modelValue":T[1]||(T[1]=N=>r.value=N)},null,8,["options","modelValue"])],2)],2),d("div",{class:m(h.classes.configItem)},[d("div",{class:m(h.classes.configItemLabel)},"垂直对齐",2),p(y(ee),{options:y(Zn),modelValue:i.value,"onUpdate:modelValue":T[2]||(T[2]=N=>i.value=N)},null,8,["options","modelValue"])],2),d("div",{class:m(h.classes.configItem)},[d("div",{class:m(h.classes.configItemLabel)},"首行缩进",2),p(We,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":T[3]||(T[3]=N=>n.options.style.textIndent=N),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(h.classes.configItem)},[d("div",{class:m(h.classes.configItemLabel)},"行高",2),p(We,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":T[4]||(T[4]=N=>n.options.style.lineHeight=N),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(h.classes.fieldset)},[T[9]||(T[9]=d("header",null,"内边距",-1)),d("div",{class:m(h.classes.padding)},[d("div",{class:m(h.classes.paddingItem)},[d("label",{class:m(h.classes.paddingItemLabel)},"上边距",2),p(We,{modelValue:y(a),"onUpdate:modelValue":T[5]||(T[5]=N=>Ke(a)?a.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(h.classes.paddingItem)},[d("label",{class:m(h.classes.paddingItemLabel)},"下边距",2),p(We,{modelValue:y(u),"onUpdate:modelValue":T[6]||(T[6]=N=>Ke(u)?u.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(h.classes.paddingItem)},[d("label",{class:m(h.classes.paddingItemLabel)},"左边距",2),p(We,{modelValue:y(f),"onUpdate:modelValue":T[7]||(T[7]=N=>Ke(f)?f.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),d("div",{class:m(h.classes.paddingItem)},[d("label",{class:m(h.classes.paddingItemLabel)},"右边距",2),p(We,{modelValue:y(g),"onUpdate:modelValue":T[8]||(T[8]=N=>Ke(g)?g.value=N:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),d("div",{class:m(h.classes.fieldset)},[T[10]||(T[10]=d("header",null,"预览",-1)),d("div",{class:m(h.classes.preview),style:K(v.value)},[d("div",{style:K(_.value),class:m(h.classes.previewText)},[le(Z(Mu)+" "),d("div",{class:m(h.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),qu="_paragraph_1ex97_2",$u="_fieldset_1ex97_7",Pu="_preview_1ex97_23",Vu="_textAlign_1ex97_34 quickprint-is-row",Fu="_configItem_1ex97_39 quickprint-is-row",zu="_alignLast_1ex97_44 quickprint-is-row",Uu="_configItemLabel_1ex97_54",Hu="_padding_1ex97_59",Gu="_paddingItem_1ex97_66",Wu="_paddingItemLabel_1ex97_72",Yu="_previewText_1ex97_77",Xu="_paddingPreview_1ex97_86",ju={paragraph:qu,fieldset:$u,preview:Pu,textAlign:Vu,configItem:Fu,alignLast:zu,configItemLabel:Uu,padding:Hu,paddingItem:Gu,paddingItemLabel:Wu,previewText:Yu,paddingPreview:Xu},Zu={classes:ju},Ku=z(Bu,[["__cssModules",Zu]]),Ju=["title","onClick"],Qu={key:0},ed=V({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=Le("classes"),t=n,l=[{label:"像素",value:Te.PX},{label:"毫米",value:Te.MM},{label:"磅",value:Te.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=ue(),i=L(()=>{const E=r.value;return E==null?"全部边框":s[E]}),a=L(()=>{const E=r.value;return E==null?!0:E<=o.BORDER_LEFT}),u=L(()=>{const E=r.value;return E==null?!0:E>=o.RADIUS_TOP_LEFT}),f=L(()=>{const E=r.value;return{[e.box]:!0,[e.highlightTop]:E==o.BORDER_TOP,[e.highlightRight]:E==o.BORDER_RIGHT,[e.highlightBottom]:E==o.BORDER_BOTTOM,[e.highlightLeft]:E==o.BORDER_LEFT,[e.highlightTopLeft]:E==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:E==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:E==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:E==o.RADIUS_BOTTOM_RIGHT}}),g=L(()=>({...C(o.BORDER_TOP),...C(o.BORDER_RIGHT),...C(o.BORDER_BOTTOM),...C(o.BORDER_LEFT),...N()})),v=L({get(){var q;const E=t.options.style,S=r.value;if(S==null||S>o.BORDER_LEFT)return E.borderWidth;const x=(q=T(S))==null?void 0:q.width;if(x!=null)return Reflect.get(E,x)},set(E){const S=t.options.style,x=r.value,q=E??void 0;if(x==null||x>o.BORDER_LEFT){S.borderWidth=q;return}const B=T(x);B!=null&&Reflect.set(S,B.width,q)}}),_=L({get(){var q;const E=t.options.style,S=r.value;if(S==null||S>o.BORDER_LEFT)return E.borderStyle??ae.NONE;const x=(q=T(S))==null?void 0:q.style;return x==null?ae.NONE:Reflect.get(E,x)??ae.NONE},set(E){const S=t.options.style,x=r.value,q=E==null||E==ae.NONE?void 0:E;if(x==null||x>o.BORDER_LEFT){S.borderStyle=q;return}const B=T(x);B!=null&&Reflect.set(S,B.style,q)}}),b=L({get(){var q;const E=t.options.style,S=r.value;if(S==null||S>o.BORDER_LEFT)return E.borderColor;const x=(q=T(S))==null?void 0:q.color;return x==null?Oe.INHERIT:Reflect.get(E,x)??Oe.INHERIT},set(E){const S=t.options.style,x=r.value,q=E??void 0;if(x==null||x>o.BORDER_LEFT){S.borderColor=q;return}const B=T(x);B!=null&&Reflect.set(S,B.color,q)}}),c=L({get(){const E=t.options.style,S=r.value;if(S==null||S<=o.BORDER_LEFT)return E.borderRadius;const x=h(S);if(x!=null)return Reflect.get(E,x)},set(E){const S=t.options.style,x=r.value,q=E??void 0;if(x==null||x<=o.BORDER_LEFT){S.borderRadius=q;return}const B=h(x);B!=null&&Reflect.set(S,B,q)}});function h(E){switch(E){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function T(E){switch(E){case o.BORDER_TOP:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case o.BORDER_RIGHT:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case o.BORDER_BOTTOM:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case o.BORDER_LEFT:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function N(){const E=t.options.style;return{borderTopLeftRadius:E.borderTopLeftRadius??E.borderRadius,borderTopRightRadius:E.borderTopRightRadius??E.borderRadius,borderBottomRightRadius:E.borderBottomRightRadius??E.borderRadius,borderBottomLeftRadius:E.borderBottomLeftRadius??E.borderRadius}}function C(E){const S=t.options.style;if(E==null||E>o.BORDER_LEFT){const B=S.borderStyle;return B==null||B==ae.NONE?{borderStyle:ae.NONE}:{}}const x=T(E);if(x==null)return{};const q=Reflect.get(S,x.style)??Reflect.get(S,"borderStyle");return q==null||q===ae.NONE?{}:{[x.style]:q??S.borderStyle,[x.width]:Reflect.get(S,x.width)??S.borderWidth,[x.color]:Reflect.get(S,x.color)??S.borderColor??Oe.BLACK}}function D(E){_.value=E}function k(E){r.value=E===r.value?void 0:E}function w(){const E=t.options.style;E.borderStyle=void 0,E.borderColor=void 0,E.borderWidth=void 0,E.borderTopStyle=void 0,E.borderTopColor=void 0,E.borderTopWidth=void 0,E.borderRightStyle=void 0,E.borderRightColor=void 0,E.borderRightWidth=void 0,E.borderBottomStyle=void 0,E.borderBottomColor=void 0,E.borderBottomWidth=void 0,E.borderLeftStyle=void 0,E.borderLeftColor=void 0,E.borderLeftWidth=void 0}function A(){const E=t.options.style;E.borderTopStyle==ae.NONE&&(E.borderTopStyle=void 0),E.borderRightStyle==ae.NONE&&(E.borderRightStyle=void 0),E.borderBottomStyle==ae.NONE&&(E.borderBottomStyle=void 0),E.borderLeftStyle==ae.NONE&&(E.borderLeftStyle=void 0),E.borderStyle=ae.SOLID}function P(){const E=t.options.style;E.borderStyle=void 0,E.borderRightStyle=void 0,E.borderRightColor=void 0,E.borderRightWidth=void 0,E.borderLeftStyle=void 0,E.borderLeftColor=void 0,E.borderLeftWidth=void 0,E.borderTopStyle=ae.SOLID,E.borderBottomStyle=ae.SOLID}function O(E){const S=t.options.style,x=h(E)??"borderRadius",q=Reflect.get(S,x);return jn(q)}function M(E){const S=Math.max(12,O(E)??0);return{width:S+"px",height:S+"px"}}return(E,S)=>(R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",y(e).settings])},[d("div",{class:m(y(e).presets)},[S[15]||(S[15]=d("span",null,"预设：",-1)),d("button",{type:"button",class:"quickprint-text-btn",onClick:w},[d("div",{class:m(y(e).noBorder)},null,2),S[12]||(S[12]=d("span",null,"无边框",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:A},[d("div",{class:m(y(e).outerBorder)},null,2),S[13]||(S[13]=d("span",null,"外部边框",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:P},[d("div",{class:m(y(e).topBottomBorder)},null,2),S[14]||(S[14]=d("span",null,"上下边框",-1))])],2),d("div",{class:m(y(e).borderTitle)},[S[16]||(S[16]=le(" 当前：")),d("strong",null,Z(i.value),1)],2),d("div",{class:m(f.value),style:K(g.value),onClick:S[8]||(S[8]=ne(()=>{},["stop"]))},[d("div",{class:m(y(e).borderTopLeftRadius),style:K(M(o.RADIUS_TOP_LEFT)),onClick:S[0]||(S[0]=x=>k(o.RADIUS_TOP_LEFT))},null,6),d("div",{class:m(y(e).borderTopRightRadius),style:K(M(o.RADIUS_TOP_RIGHT)),onClick:S[1]||(S[1]=x=>k(o.RADIUS_TOP_RIGHT))},null,6),d("div",{class:m(y(e).borderBottomLeftRadius),style:K(M(o.RADIUS_BOTTOM_LEFT)),onClick:S[2]||(S[2]=x=>k(o.RADIUS_BOTTOM_LEFT))},null,6),d("div",{class:m(y(e).borderBottomRightRadius),style:K(M(o.RADIUS_BOTTOM_RIGHT)),onClick:S[3]||(S[3]=x=>k(o.RADIUS_BOTTOM_RIGHT))},null,6),d("div",{class:m(y(e).borderTop),onClick:S[4]||(S[4]=x=>k(o.BORDER_TOP))},null,2),d("div",{class:m(y(e).borderRight),onClick:S[5]||(S[5]=x=>k(o.BORDER_RIGHT))},null,2),d("div",{class:m(y(e).borderBottom),onClick:S[6]||(S[6]=x=>k(o.BORDER_BOTTOM))},null,2),d("div",{class:m(y(e).borderLeft),onClick:S[7]||(S[7]=x=>k(o.BORDER_LEFT))},null,2)],6),d("div",{class:m(y(e).borderSetting)},[d("div",{class:m(y(e).borderStyle)},[d("label",{class:m(y(e).borderStyleTitle)},"线型",2),d("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",y(e).borderStyleOptions])},[(R(!0),I(Q,null,re(y(Jc),x=>(R(),I("div",{key:x.value,title:x.label,class:m({[y(e).option]:!0,[y(e).selected]:x.value===_.value}),onClick:q=>D(x.value)},[x.value==y(ae).NONE?(R(),I("div",Qu,Z(x.label),1)):(R(),I("div",{key:1,class:m(y(e).line),style:K({textDecorationStyle:x.value})},"--",6))],10,Ju))),128))],2)],2),d("div",{class:m(y(e).borderSettingRight)},[d("div",{class:m(y(e).borderItem)},[d("label",{class:m(y(e).borderItemLabel)},"颜色",2),p(y(mn),{modelValue:b.value,"onUpdate:modelValue":S[9]||(S[9]=x=>b.value=x),class:"quickprint-is-fill-w",disabled:!a.value},null,8,["modelValue","disabled"])],2),d("div",{class:m(y(e).borderItem)},[d("label",{class:m(y(e).borderItemLabel)},"宽度",2),p(We,{modelValue:v.value,"onUpdate:modelValue":S[10]||(S[10]=x=>v.value=x),options:l,class:"quickprint-is-fill-w",disabled:!a.value},null,8,["modelValue","disabled"])],2),d("div",{class:m(y(e).borderItem)},[d("label",{class:m(y(e).borderItemLabel)},"圆角",2),p(We,{modelValue:c.value,"onUpdate:modelValue":S[11]||(S[11]=x=>c.value=x),options:l,class:"quickprint-is-fill-w",disabled:!u.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),td="_settings_58on3_2",nd="_borderTitle_58on3_8",ld="_box_58on3_13",od="_border_58on3_8",sd="_borderRadius_58on3_28",id="_highlightTop_58on3_35",rd="_borderTop_58on3_35 _border_58on3_8",ad="_highlightBottom_58on3_36",cd="_borderBottom_58on3_36 _border_58on3_8",ud="_highlightRight_58on3_37",dd="_borderRight_58on3_37 _border_58on3_8",fd="_highlightLeft_58on3_38",pd="_borderLeft_58on3_38 _border_58on3_8",md="_highlightTopLeft_58on3_44",gd="_borderTopLeftRadius_58on3_44 _borderRadius_58on3_28",hd="_highlightTopRight_58on3_45",vd="_borderTopRightRadius_58on3_45 _borderRadius_58on3_28",bd="_highlightBottomLeft_58on3_46",yd="_borderBottomLeftRadius_58on3_46 _borderRadius_58on3_28",_d="_highlightBottomRight_58on3_47",Ed="_borderBottomRightRadius_58on3_47 _borderRadius_58on3_28",Td="_borderItem_58on3_111",Sd="_borderItemLabel_58on3_121",Rd="_borderSetting_58on3_126",kd="_borderSettingRight_58on3_131",wd="_borderStyle_58on3_138",Cd="_borderStyleOptions_58on3_143",Ld="_borderStyleTitle_58on3_150",Id="_option_58on3_155",Nd="_line_58on3_171",Od="_selected_58on3_182",Dd="_presets_58on3_188",xd="_noBorder_58on3_195",Ad="_outerBorder_58on3_196",Md="_topBottomBorder_58on3_197",Bd={settings:td,borderTitle:nd,box:ld,border:od,borderRadius:sd,highlightTop:id,borderTop:rd,highlightBottom:ad,borderBottom:cd,highlightRight:ud,borderRight:dd,highlightLeft:fd,borderLeft:pd,highlightTopLeft:md,borderTopLeftRadius:gd,highlightTopRight:hd,borderTopRightRadius:vd,highlightBottomLeft:bd,borderBottomLeftRadius:yd,highlightBottomRight:_d,borderBottomRightRadius:Ed,borderItem:Td,borderItemLabel:Sd,borderSetting:Rd,borderSettingRight:kd,borderStyle:wd,borderStyleOptions:Cd,borderStyleTitle:Ld,option:Id,line:Nd,selected:Od,presets:Dd,noBorder:xd,outerBorder:Ad,topBottomBorder:Md},qd={classes:Bd},$d=z(ed,[["__cssModules",qd]]),Pd="_setting_joc27_2",Vd={setting:Pd},Fd={};function zd(n,e){return R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const Ud={classes:Vd},Hd=z(Fd,[["render",zd],["__cssModules",Ud]]),Gd="_setting_joc27_2",Wd={setting:Gd},Yd={};function Xd(n,e){return R(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const jd={classes:Wd},Zd=z(Yd,[["render",Xd],["__cssModules",jd]]),Kd=V({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=nt();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(R(),I("div",{class:m(s.classes.setting)},[n.active==="font"?(R(),J(Lu,{key:0,options:e.options},null,8,["options"])):G("",!0),n.active==="paragraph"?(R(),J(Ku,{key:1,options:e.options},null,8,["options"])):G("",!0),n.active==="border"?(R(),J($d,{key:2,options:e.options},null,8,["options"])):G("",!0),n.active==="table"?(R(),J(Hd,{key:3})):G("",!0),n.active==="table-cell"?(R(),J(Zd,{key:4})):G("",!0),d("div",{class:m(s.classes.footer)},[d("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),d("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),Jd="_setting_1v5ya_2",Qd="_footer_1v5ya_9",ef={setting:Jd,footer:Qd},tf={classes:ef},ml=z(Kd,[["__cssModules",tf]]);function nf(n){return De({style:ol(n.style??{})})}function lf(n,e){n.style=Object.assign({},n.style,e.style)}const Eo=xe(function(n){return wt("表格",(e,t)=>p(ml,{options:nf(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table",active:!0},{label:"边框",name:"border"}]}).promisify().then(e=>lf(n,e)).catch(Ae)});function of(n){return De({style:ol(n.style??{})})}function sf(n,e){n.style=Object.assign({},n.style,e.style)}const rf=xe(function(n){return wt("单元格",(e,t)=>p(ml,{options:of(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table-cell",active:!0},{label:"字体",name:"font"},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>sf(n,e)).catch(Ae)});function af(n,e,t){const l={menus:[{type:"menu",label:"选中表格",icon:"icon-aim",handler:e.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",disabled:!0,handler(){Eo(e.getTable())}},{type:"menu",label:"行设置",icon:"icon-setting",disabled:!0,handler(){console.log("TODO:")}},{type:"divider"},{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:e.inserRowBottom}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]},{type:"divider"},To(e),fl(e.getDesignApi(),e.getTable())]};kn.open(n.clientX,n.clientY,l)}function cf(n,e){const l=e.getDesignApi().getSelectedElements();if(l.length==1&&l[0].type===Y.TABLE_ROW)return af(n,e,l[0]);const o=e.getSelected(),s={menus:[{type:"menu",label:"选中表格",icon:"icon-aim",handler:e.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",disabled:!0,handler(){Eo(e.getTable())}},{type:"menu",label:"单元格设置",icon:"icon-setting",disabled:!0,handler(){const i=o[0];i!=null&&rf(i)}},{type:"divider"}]},r=[];return o.length>=2&&r.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells}),o.some(i=>i.hasSpan)&&r.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),o.length===1&&o[0].noSpan&&r.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),r.length>0&&s.menus.push(...r,{type:"divider"}),s.menus.push({type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:e.insertColumnLeft},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:e.insertColumnRight},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:e.inserRowBottom}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:e.deleteColumns},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]},{type:"divider"},To(e),fl(e.getDesignApi(),e.getTable())),kn.open(n.clientX,n.clientY,s)}function To(n){return{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:n.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:n.avgTableWidth},{type:"menu",label:"均分表格高度",handler:n.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:n.setOtherRowSameHeight,disabled(){const e=n.getSelected();return!!(e.length!==1||e[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:n.setOtherColSameWidth,disabled(){if(n.isSelectTableRow())return!0;const e=n.getSelected();return!!(e.length!==1||e[0].hasColSpan)}}]}}function uf(n,e){function t(){return n.element}function l(){const w=t();return e.getSelectedElements().filter(P=>{var M;if(P.type!==Y.TABLE_CELL)return!1;const O=(M=P.parent)==null?void 0:M.parent;return O==null?!1:O.id==w.id}).sort(Tn.sort)}function o(){var P;const w=l()[0];if(w==null)return!1;const A=(P=w.parent)==null?void 0:P.parent;return A==null?!1:e.selectElement(A)}function s(){const w=l();if(w.length===0)return!1;const A=Ot.toArea(w);return t().insertColumn(A.colStart,0),e.createSnapshot(),!0}function r(){const w=l();if(w.length===0)return!1;const A=Ot.toArea(w);return t().insertColumn(A.colEnd,1),e.createSnapshot(),!0}function i(){const w=l();if(w.length===0)return!1;const A=Ot.toArea(w);return t().inserRow(A.rowStart,0),e.createSnapshot(),!0}function a(){const w=l();if(w.length===0)return!1;const A=Ot.toArea(w);return t().inserRow(A.rowEnd,1),e.createSnapshot(),!0}function u(){var j,he;const w=t(),A=w.page;if(A==null)return;const P=w.doc,O=jn((j=P==null?void 0:P.margins)==null?void 0:j.left)??38,M=jn((he=P==null?void 0:P.margins)==null?void 0:he.right)??38,E=w.columns,S=E.reduce((_e,we)=>_e+we,0),x=Gn.mm_to_px(A.width)-O-M,q=[];for(const _e of E){const we=Math.round(_e/S*x);q.push(we)}const B=q.reduce((_e,we)=>_e+we,0),oe=x-B;q[q.length-1]+=oe,w.setColumns(q),w.updateBoxSize(),e.createSnapshot()}function f(){const w=t(),A=w.columns,P=A.reduce((S,x)=>S+x,0),O=Math.floor(P/A.length),M=new Array(A.length).fill(O),E=P-M.reduce((S,x)=>S+x,0);M[M.length-1]+=E,w.setColumns(M),w.updateBoxSize(),e.createSnapshot()}function g(){const w=t(),A=Math.round(w.height/w.children.length);w.children.forEach((P,O)=>w.setRowHeight(O,A)),w.updateBoxSize(),e.createSnapshot()}function v(){const w=e.getSelectedElements()[0];if(w==null)return;const A=w.type===Y.TABLE_ROW?w:w.parent;if(!pe.isDefineElement(A)||A.type!=Y.TABLE_ROW)return;const P=t(),O=A.height;P.children.forEach(M=>M.setRowHeight(O)),P.updateBoxSize(),e.createSnapshot()}function _(){const w=e.getSelectedElements()[0];if(w==null)return;const A=t(),P=w.width,O=A.attributes.colgroup.map(M=>P);A.setColumns(O),A.updateBoxSize(),e.createSnapshot()}function b(){const w=l();if(w.length<2)return;const P=t().mergeCells(w);e.selectElement(P),e.createSnapshot()}function c(){const w=l();if(w.length==0)return;t().splitCells(w),e.createSnapshot()}function h(){const w=l()[0];if(w==null)return;t().removeColumn(w.index),e.resetSelectedElement(),e.createSnapshot()}function T(){const w=l()[0];if(w==null)return;const A=w.parent;if(A==null)return;t().removeRow(A.index),e.resetSelectedElement(),e.createSnapshot()}function N(){e.getSelectedElements().forEach(A=>A.resetDS()),e.createSnapshot()}function C(){const w=e.getSelectedElements();if(w.length!=1)return;const A=w[0];if(A.hasSpan)return;const P=A.index,O=t();O.insertColumn(P,1,!0);for(const M of O.children){const E=M.children[P];if(E.id===A.id)continue;const S=M.children[P+1];O.mergeCells([E,S])}e.selectElement(A),e.createSnapshot()}function D(){const w=e.getSelectedElements();if(w.length!=1)return;const A=w[0];if(A.hasSpan)return;const P=A.parent;if(P==null)return;const O=t();O.inserRow(P.index,1);const M=O.children[P.index+1];for(let E=0;E<P.children.length;E++){const S=P.children[E];if(S.id===A.id)continue;const x=M.children[E];O.mergeCells([S,x])}e.selectElement(A),e.createSnapshot()}function k(){const w=e.getSelectedElements();return w.length==1&&w[0].type==Y.TABLE_ROW}return{getDesignApi(){return e},getTable:t,getSelected:l,selectTable:o,insertColumnLeft:s,insertColumnRight:r,insertRowTop:i,inserRowBottom:a,autoReiszeColumnByPaper:u,avgTableWidth:f,avgTableHeight:g,setOtherRowSameHeight:v,setOtherColSameWidth:_,mergeCells:b,splitCells:c,splitByColumn:C,splitByRow:D,deleteColumns:h,deleteRows:T,deleteDataSource:N,isSelectTableRow:k}}function df(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getColumnLeft(f-1)}function r(f){const g=n.getTable(),v=g.attributes.colgroup.length;return f>=v?null:g.getColumnLeft(f+1)}function i(f,g){if(!(f.target instanceof Element))return;const v=f.target.closest("."+e.colResize);if(v==null)return;const _=v.closest("."+e.layer);_!=null&&(f.stopPropagation(),f.preventDefault(),o.left=v.offsetLeft,o.colIndex=g,o.target=v,o.container=_,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",u))}function a(f){if(o.target==null||o.container==null)return;const g=o.container.getBoundingClientRect(),v=n.getDesignApi().state.scale/100,_=s(o.colIndex),b=r(o.colIndex);let c=f.clientX-g.left;_!=null&&c<=_*v+4&&(c=_*v+4),b!=null&&c>=b*v-4&&(c=b*v-4),o.left=c/v,o.target.style.left=c/v+"px",o.moved=!0}function u(f){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",u)}return i}function ff(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getRowTop(f-1)}function r(f){const g=n.getTable(),v=g.children.length;return f>=v?null:g.getRowTop(f+1)}function i(f,g){if(!(f.target instanceof Element))return;const v=f.target.closest("."+e.rowResize);if(v==null)return;const _=v.closest("."+e.layer);_!=null&&(f.stopPropagation(),f.preventDefault(),o.top=v.offsetTop,o.rowIndex=g,o.target=v,o.container=_,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",u))}function a(f){if(o.target==null||o.container==null)return;const g=n.getDesignApi().state.scale/100,v=o.container.getBoundingClientRect(),_=s(o.rowIndex),b=r(o.rowIndex);let c=f.clientY-v.top;_!=null&&c<=_*g+4&&(c=_*g+4),b!=null&&c>=b*g-4&&(c=b*g-4),o.moved=!0,o.top=c/g,o.target.style.top=c/g+"px"}function u(f){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",u)}return i}const pf=["width"],mf=["onClick"],gf=["onClick"],hf=V({__name:"TableEditor",props:{element:{type:Ot,required:!0}},setup(n){const e=n,t=Re(),l=Le("classes"),o=uf(e,t),s=De({colIndex:-1,rowIndex:-1,silence:!1}),r=L(()=>e.element.attributes.colgroup??[]),i=df(o,l,{onResizeEnd:T,onResizeStart:h}),a=ff(o,l,{onResizeEnd:N,onResizeStart:h});function u(O){return{left:(e.element.attributes.colgroup??[]).slice(0,O).reduce((E,S)=>E+S,0)+"px"}}function f(O){return{top:(e.element.children??[]).slice(0,O).reduce((S,x)=>S+x.height,0)-1+"px"}}function g(O){const M=e.element.attributes.colgroup??[],E=M.slice(0,O).reduce((q,B)=>q+B,0),S=O===0?0:1,x=O>0&&O<M.length?-1:0;return{left:E+S+"px",width:M[O]+x+"px"}}function v(O){const M=e.element.children??[],E=M.slice(0,O).reduce((q,B)=>q+B.height,0),S=O===0?0:1,x=O>0&&O<M.length?-1:0;return{top:E+S+"px",height:M[O].height+x+"px"}}function _(O){t.selectElement(O)}function b(O){const M=[];for(const E of e.element.children){const S=E.children[O];S.isColCollapsed||M.push(S)}t.multiSelectElements(M)}async function c(O){const M=O.target.closest("td");if(M==null)return;const E=Reflect.get(M,ze);if(E==null)return;const S=t.getSelectedElements();(S.length==0||S.length==1&&S[0].type===Y.TABLE_CELL||S.length>1&&S.findIndex(x=>x.id===E.id)<0)&&(t.selectElement(E),await zt()),cf(O,o)}function h(){s.silence=!0}function T(O,M){s.silence=!1;const E=e.element.attributes.colgroup??[];if(O==0){const oe=e.element.left,j=e.element.calculateCoord(oe+M),he=E[0]-(j-oe);e.element.setLeft(j),e.element.setColWidth(0,he),e.element.updateBoxSize(),t.createSnapshot();return}if(O==E.length){const oe=O-1,j=E.slice(0,oe).reduce((_e,we)=>_e+we,0),he=M-j;e.element.setColWidth(O-1,he),e.element.updateBoxSize(),t.createSnapshot();return}const S=O-1,x=E[S]+E[O],q=M-E.slice(0,S).reduce((oe,j)=>oe+j,0),B=x-q;e.element.setColWidth(S,q),e.element.setColWidth(O,B),e.element.updateBoxSize(),t.createSnapshot()}function N(O,M){s.silence=!1;const E=e.element.children;if(O==0){const oe=e.element.top,j=e.element.calculateCoord(oe+M),he=E[0].height-(j-oe);e.element.setTop(j),e.element.setRowHeight(O,he),e.element.updateBoxSize(),t.createSnapshot();return}if(O==E.length){const oe=O-1,j=E.slice(0,oe).reduce((_e,we)=>_e+we.height,0),he=M-j;e.element.setRowHeight(O-1,he),e.element.updateBoxSize(),t.createSnapshot();return}const S=O-1,x=E[S].height+E[O].height,q=M-E.slice(0,S).reduce((oe,j)=>oe+j.height,0),B=x-q;e.element.setRowHeight(S,q),e.element.setRowHeight(O,B),e.element.updateBoxSize(),t.createSnapshot()}function C(){s.rowIndex=-1,s.colIndex=-1}function D(O){const M=O.target.closest("td");if(M==null)return;const E=Reflect.get(M,ze);if(E==null||!(E instanceof Tn))return;const S=M.getBoundingClientRect(),x=O.clientX-S.left,q=E.index;if(!E.hasColSpan)return x<S.width/2?q:E.getNextColIndex();const B=e.element.attributes.colgroup,oe=B[q]/2;if(x>=0&&x<=oe)return q;const j=E.offsetWidth,he=j-B[q+E.colspan-1]/2;if(x>=he&&x<=j)return E.getNextColIndex()+1}function k(O){const M=O.target.closest("td");if(M==null)return;const E=Reflect.get(M,ze);if(E==null||!(E instanceof Tn))return;const S=E.parent;if(S==null)return;const x=M.getBoundingClientRect(),q=O.clientY-x.top,B=S.index;if(!E.hasRowSpan)return q<x.height/2?B:E.getNextRowIndex();const oe=S.height/2;if(q>=0&&q<=oe)return B;const j=e.element.children.slice(S.index,S.index+E.rowspan),he=j.reduce((we,Bn)=>we+Bn.height,0),_e=he-j[j.length-1].height;if(q>=_e&&q<=he)return E.getNextRowIndex()+1}function w(O){s.silence||(s.colIndex=D(O)??-1,s.rowIndex=k(O)??-1)}function A(){const O=e.element;O.insertColumn(O.colSize-1,1)}function P(){const O=e.element;O.inserRow(O.rowSize-1,1)}return(O,M)=>(R(),I("div",{class:m(y(l).tableEditor),onContextmenu:ne(c,["stop","prevent"]),onClick:M[3]||(M[3]=ne(()=>{},["stop"])),onMouseleave:C},[d("table",{class:m(y(l).table),onMousemove:w},[d("colgroup",null,[(R(!0),I(Q,null,re(r.value,(E,S)=>(R(),I("col",{key:S,width:E},null,8,pf))),128))]),d("tbody",null,[(R(!0),I(Q,null,re(n.element.children,E=>(R(),I("tr",{key:E.id},[(R(!0),I(Q,null,re(E.children,S=>(R(),J(ho,{key:S.id,element:S},null,8,["element"]))),128))]))),128))])],34),d("div",{class:m(y(l).layer)},[s.colIndex>=0?(R(),I("div",{key:0,title:"调整列宽",class:m(y(l).colResize),style:K(u(s.colIndex)),onPointerdown:M[0]||(M[0]=ne(E=>y(i)(E,s.colIndex),["stop","prevent"]))},null,38)):G("",!0),s.rowIndex>=0?(R(),I("div",{key:1,title:"调整行高",class:m(y(l).rowResize),style:K(f(s.rowIndex)),onPointerdown:M[1]||(M[1]=ne(E=>y(a)(E,s.rowIndex),["stop","prevent"]))},null,38)):G("",!0),(R(!0),I(Q,null,re(r.value,(E,S)=>(R(),I("div",{title:"选中此列",key:S,style:K(g(S)),class:m(y(l).colIndicator),onClick:ne(x=>b(S),["stop"])},null,14,mf))),128)),(R(!0),I(Q,null,re(n.element.children,(E,S)=>(R(),I("div",{title:"选中此行",key:S,style:K(v(S)),class:m(y(l).rowIndicator),onClick:ne(x=>_(E),["stop"])},null,14,gf))),128)),n.element.isSelected?(R(),I("button",{key:2,onClick:ne(A,["stop"]),type:"button",class:m(["quickprint-text-btn",y(l).addCol]),title:"添加列"},[p(y(F),{icon:"icon-plus",size:"14px"})],2)):G("",!0),n.element.isSelected?(R(),I("button",{key:3,onClick:ne(P,["stop"]),type:"button",class:m(["quickprint-text-btn",y(l).addRow]),title:"添加行"},[p(y(F),{icon:"icon-plus",size:"14px"})],2)):G("",!0)],2),d("div",{class:m(y(l).indicator),onPointerdown:M[2]||(M[2]=(...E)=>y(t).onDragStart&&y(t).onDragStart(...E)),title:"选中/拖动表格"},null,34)],34))}}),vf="_tableEditor_5qbkt_2",bf="_table_5qbkt_2",yf="_layer_5qbkt_33",_f="_colResize_5qbkt_43",Ef="_rowResize_5qbkt_66",Tf="_colIndicator_5qbkt_89",Sf="_rowIndicator_5qbkt_95",Rf="_indicator_5qbkt_114",kf="_addCol_5qbkt_151",wf="_addRow_5qbkt_166",Cf={tableEditor:vf,table:bf,layer:yf,colResize:_f,rowResize:Ef,colIndicator:Tf,rowIndicator:Sf,indicator:Rf,addCol:kf,addRow:wf},Lf={classes:Cf},If=z(hf,[["__cssModules",Lf]]),Nf={class:"quickprint-config-section quickprint-config-inline"},Of={class:"quickprint-config-content"},Df=V({__name:"TableConfig",props:{element:{type:Ot,required:!0}},setup(n){const e=n,t=L({get(){return e.element.attributes.rowMode??Wt.CONST},set(o){e.element.attributes.rowMode=o===Wt.CONST?void 0:o}}),l=[{label:"固定行数",value:Wt.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:Wt.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:Wt.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(R(),I("section",Nf,[s[1]||(s[1]=d("header",{class:"quickprint-config-header"},"行模式",-1)),d("div",Of,[p(y(ee),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),xf={class:"quickprint-config-section quickprint-config-inline"},Af={class:"quickprint-config-content"},Mf=V({__name:"TableRowConfig",props:{element:{type:dn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:Lt.HEADER},{label:"表体",value:Lt.BODY},{label:"表尾",value:Lt.FOOTER}],l=L({get(){return e.element.attributes.type??Lt.BODY},set(o){switch(o){case Lt.HEADER:e.element.asHeader();break;case Lt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(R(),I("section",xf,[s[1]||(s[1]=d("header",{class:"quickprint-config-header"},"行模式",-1)),d("div",Af,[p(y(ee),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),An=Object.freeze({title:"表格",type:Y.TABLE,icon:"icon-table",editor:If,config:{attributes:Df,exclude:[de.DISPLAY,de.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[St,St,St],e=pe.create({type:Y.TABLE});return e.setColgroup(n),e.append(dn.createDefault(n)),e.append(dn.createDefault(n)),e.append(dn.createDefault(n)),e.updateBoxSize(),e}}),So=Object.freeze({title:"表格行",type:Y.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[de.POSITION,de.COORD,de.OVERFLOW],attributes:Mf}}),gl=Object.freeze({title:"单元格",type:Y.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:ho,config:{exclude:[de.POSITION,de.COORD]}});class Bf{constructor(e){H(this,"__v_skip",!0);H(this,"observer");H(this,"callbacks",[]);H(this,"handler");this.handler=xr((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function qf(n,e){switch(n){case"fontSize":return e===Ee.DEFAULT?void 0:e;case"fontFamily":return e===se.DEFAULT?void 0:e;case"lineHeight":return e===vt.DEFAULT?void 0:e;default:return e}}const Cl="texteditor-const-node",$f=Object.freeze({CONST:0});class Pf{constructor(e,t={}){H(this,"__v_skip",!0);H(this,"emitter",new yn);H(this,"container");H(this,"options");H(this,"observer");H(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new Bf(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new yn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Qo(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ie(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await Rn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=Cl,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var v;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,a=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(a),r.parentNode===i||(v=r.parentNode)!=null&&v.contains(i))return s.insertNode(a),this.normalize(),this.focusAfterNode(a),!0;const u=r.parentNode;if(u==null)return!1;const f=u.textContent;if(f==null)return!1;if(o.anchorOffset==f.length)return i.insertBefore(a,u.nextSibling),this.normalize(),this.focusAfterNode(a),!0;const g=document.createElement("span");return g.textContent=f.slice(0,o.anchorOffset),u instanceof HTMLElement&&(g.style.cssText=u.style.cssText),u.textContent=f.slice(o.anchorOffset),i.insertBefore(a,u),i.insertBefore(g,a),this.normalize(),this.focusAfterNode(a),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ie(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var f;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:a}=this.normalizeRange(o);if(s===i){const g=s.textContent??"";if(s instanceof CharacterData){const b=document.createElement("span");return b.textContent=g.slice(r,a),o.deleteContents(),o.insertNode(b),[b]}const v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,i);const _=document.createElement("span");return _.textContent=g.slice(r,a),this.inheritStyle(_,i),i.textContent=g.slice(a),e.insertBefore(_,i),e.insertBefore(v,_),[_]}const u=this.findNodesBetween(s,i);if(r>0){const g=s.textContent??"",v=document.createElement("span");v.textContent=g.slice(0,r),this.inheritStyle(v,s),s.textContent=g.slice(r),e.insertBefore(v,s)}if(a>=0&&a<=(((f=i.textContent)==null?void 0:f.length)??0)){const g=i.textContent??"";if(i instanceof HTMLElement){i.textContent=g.slice(0,a);const v=document.createElement("span");v.textContent=g.slice(a),this.inheritStyle(v,i),e.insertBefore(v,i.nextSibling),u.push(i)}else{const v=document.createElement("span");v.textContent=g.slice(0,a),e.replaceChild(v,i);const _=document.createTextNode(g.slice(a));e.insertBefore(_,i.nextSibling),u.push(v)}}return u.unshift(s),u}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=Ul(e),r=qf(e,t);for(let i=0;i<l.length;i++){const a=l[i];if(a instanceof HTMLElement){this.matchElementStyle(a,s,r)||(o=!1);continue}const u=document.createElement("span");u.textContent=a.textContent,this.container.replaceChild(u,a),l[i]=u,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=yt.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=yt.remove(o,l);ie(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+Cl)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const Vf=V({__name:"ParagraphEditor",props:{element:{type:es,required:!0}},setup(n){const e=n,t=Re(),l=fe(),o=L(()=>e.element.isSelected!==!0?!1:t.state.selectMode===Je.SINGLE);let s=null;const r=L(()=>xn.map(k=>(k.style={fontFamily:k.value==se.DEFAULT?se.SONG:k.value},k)));function i(){}async function a(){if(s==null)return;const k=await dl({doc:t.doc}).catch(je);if(k==null)return;const w=tt(k.value,t.doc.ds)??k.value,A={type:$f.CONST,value:k.value,label:w};s.insertNode(A)}function u(){s==null||s.blur()}function f(){s==null||s.autosize()}function g(k){const w=e.element.ds.value,A=new Pf(k);return A.on("resize",P=>{var M;const O=(M=P.detail)==null?void 0:M.height;O!=null&&e.element.setHeight(O+2)}),A.watch(()=>{const P=A.getHTML(),O=e.element.ds.value;P!==O&&(e.element.ds.value=P,A.checkHeight())}),ie(w)||A.setHTML(w),A}function v(k){s==null||s.setStyle("fontFamily",k.value)}function _(k){s==null||s.setStyle("fontSize",k.value)}function b(k){s==null||s.setStyle("lineHeight",k.value)}function c(k){s==null||s.setStyle("backgroundColor",k)}function h(k){s==null||s.setStyle("color",k)}function T(){s==null||s.setStyle("fontWeight","700")}function N(){s==null||s.setStyle("fontStyle","italic")}function C(){s==null||s.setStyle("textDecorationLine","underline")}function D(){s==null||s.setStyle("textDecorationLine","line-through")}return il(()=>e.element.ds.value,k=>{s==null||s.getHTML()==k||s.setHTML(k)}),ln(()=>{e.element.on("blur",u),s=g(l.value)}),sl(()=>{e.element.off("blur",u),s&&s.cleanup()}),(k,w)=>(R(),I("div",{class:m(k.classes.paragraph),onPointerdown:w[2]||(w[2]=ne(()=>{},["stop"])),onContextmenu:ne(i,["stop","prevent"])},[d("div",{class:m(k.classes.indicator),onPointerdown:w[0]||(w[0]=(...A)=>y(t).onDragStart&&y(t).onDragStart(...A)),title:"选中/拖动段落"},null,34),o.value?(R(),I("div",{key:0,class:m(k.classes.toolbar),onMousedown:w[1]||(w[1]=ne(()=>{},["prevent"]))},[p(y(ee),{onSelect:v,title:"字体",width:"60px",options:r.value,class:m(k.classes.tool),button:""},null,8,["options","class"]),p(y(ee),{onSelect:_,title:"字号",width:"60px",options:y(pl),class:m(k.classes.tool),button:""},null,8,["options","class"]),p(y(ee),{onSelect:b,title:"行高",width:"60px",options:y(yo),class:m(k.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),d("div",{class:m(k.classes.divider)},null,2),p(y(Bt),{class:m(k.classes.tool),onSelect:c},{default:ke(()=>[d("div",{class:m(k.classes.colorIcon),title:"突出显示"},[p(y(F),{icon:"icon-bg-color-b",size:"15px"}),d("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(y(Bt),{class:m(k.classes.tool),onSelect:h},{default:ke(()=>[d("div",{class:m(k.classes.colorIcon),title:"字体颜色"},[p(y(F),{icon:"icon-font",size:"15px"}),d("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),d("button",{onClick:T,type:"button",title:"加粗",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-font-bold",size:"16px"})],2),d("button",{onClick:N,type:"button",title:"斜体",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-italic",size:"16px"})],2),d("button",{onClick:C,type:"button",title:"下划线",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-underline",size:"16px"})],2),d("button",{onClick:D,type:"button",title:"删除线",class:m(["quickprint-text-btn",k.classes.tool])},[p(y(F),{icon:"icon-through-line",size:"16px"})],2),d("div",{class:m(k.classes.divider)},null,2),d("button",{class:"quickprint-text-btn",type:"button",onClick:a},[p(y(F),{icon:"icon-insert-var",size:"16px"}),w[3]||(w[3]=d("span",null,"插入变量",-1))]),d("button",{class:"quickprint-text-btn",type:"button",onClick:f},[p(y(F),{icon:"icon-colum-height",size:"16px"}),w[4]||(w[4]=d("span",null,"调整高度",-1))])],34)):G("",!0),d("div",{ref_key:"editorRef",ref:l,class:m(k.classes.editor)},null,2)],34))}}),Ff="_paragraph_1v2pj_2",zf="_indicator_1v2pj_6",Uf="_editor_1v2pj_18",Hf="_toolbar_1v2pj_44",Gf="_tool_1v2pj_44",Wf="_colorIcon_1v2pj_66",Yf="_colorIndicator_1v2pj_86",Xf="_divider_1v2pj_95",jf={paragraph:Ff,indicator:zf,editor:Uf,toolbar:Hf,tool:Gf,colorIcon:Wf,colorIndicator:Yf,divider:Xf},Zf={classes:jf},Kf=z(Vf,[["__cssModules",Zf]]),Mn=Object.freeze({title:"段落",type:Y.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:Kf,config:{exclude:[de.DATASOURCE,de.BASIC,de.OVERFLOW]},onCreate(){return pe.create({type:Y.PARAGRAPH,width:St*4,height:Cn*6})}}),Ro=[Nn,On,Dn,An,gl,So,Mn],Jf=[Nn,On,Dn,An,Mn],Qf={[Y.TEXT]:Nn.editor,[Y.NUMBER]:On.editor,[Y.DATE]:Dn.editor,[Y.TABLE]:An.editor,[Y.TABLE_CELL]:gl.editor,[Y.PARAGRAPH]:Mn.editor},ep={[Y.TEXT]:Nn.config,[Y.NUMBER]:On.config,[Y.DATE]:Dn.config,[Y.TABLE]:An.config,[Y.TABLE_CELL]:gl.config,[Y.TABLE_ROW]:So.config,[Y.PARAGRAPH]:Mn.config},Ht=Ro.reduce((n,e)=>(n[e.type]=e,n),{});function tp(n){const e=Ro.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function np(n){return Reflect.get(Qf,n)}function jt(n){return Reflect.get(ep,n)}function tn(n){var e;return((e=Ht[n])==null?void 0:e.title)??n}function lp(n){var e;return(e=Ht[n])==null?void 0:e.icon}function op(n){var e,t;return((t=(e=Ht[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function sp(n){var e,t;return((t=(e=Ht[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function ip(n){var e,t;return((t=(e=Ht[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function rp(n){var e,t;return((t=(e=Ht[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Ll(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function Il(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function Nl(n,e){const t=n.find(a=>a.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function Ol(n,e){const t=n.find(a=>a.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function ap(n){const e=document.createElement("div");return n.appendChild(e),e}function cp(n,e){const t=[...e.querySelectorAll(":scope ."+X.GUIDE_LINE)];for(const l of n){const o=t.shift()??ap(e);o.className=X.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function up(n,e){const l=e.querySelectorAll(":scope ."+X.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const a=i.getBoundingClientRect();if(Math.abs(s.left-a.left)<=1||Math.abs(s.right-a.left)<=1){const u=a.left-o.left;Nl(r,Ll(u,s,a,o))}if(Math.abs(s.left-a.right)<=1||Math.abs(s.right-a.right)<=1){const u=a.right-o.left;Nl(r,Ll(u,s,a,o))}if(Math.abs(s.top-a.top)<=1||Math.abs(s.bottom-a.top)<=1){const u=a.top-o.top;Ol(r,Il(u,s,a,o))}if(Math.abs(s.bottom-a.bottom)<=1||Math.abs(s.top-a.bottom)<=1){const u=a.bottom-o.top;Ol(r,Il(u,s,a,o))}}cp(r,e)}function dp(){const n=document.querySelectorAll("."+X.GUIDE_LINE);for(const e of n)e.remove()}const Sn={create:Ar(up,50),clean:dp};async function fp(n){await Rn(),n&&Reflect.deleteProperty(n,wn)}async function pp(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=mp(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-no(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function mp(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Me.INSERT){const o=t.closest("."+X.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?Dt(e.left-s.left):Math.round(e.left-s.left),y:l?Dt(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?Dt(e.left):Math.round(e.left),y:l?Dt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function gp(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function hp(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function vp(n){return!(n.style.rotate&&!n.isSelected)}function bp(n){const e=new Xn({selector:{container:X.DROPPABLE},scale(t){return t.mode===Me.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,jl),s=Reflect.get(l.target,rl);o===Me.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===Me.INSERT?o:Me.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Me.INSERT){const s=tp(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,ze);if(o==null||!vp(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Me.INSERT&&(l.ghost.style.display="block"),l.mode===Me.MOVE&&Reflect.set(l.target,wn,al.DRAG_ELEMENT),l.ghost.classList.add(X.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,pp(n,l),gp(n,l),l.dropTarget&&Sn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;Sn.clean(),l.ghost.classList.remove(X.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Me.INSERT&&(l.ghost.style.display="none"),l.mode==Me.MOVE&&fp(l.target);const o=l.element;if(l.mode==Me.MOVE){const u=o.left,f=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-u,l.diffY=o.top-f,hp(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,Zl);if(s==null)return;const r=s instanceof Rt||s instanceof pe?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),a=n.state.scale/100;o.setTop((l.top-i.top)/a),o.setLeft((l.left-i.left)/a),o.setWidth(o.width/a),o.setHeight(o.height/a),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Dl="quickprint-history-0000",yp=1,ot="snapshot",gn="health",xl="owner",Ye="INDEX_OWNER",_p=15*60*1e3,Ep=10*60*1e3;function Tp(){const n={db:null,timer:null,promise:null};async function e(){const f=await a(gn,"readwrite");if(f==null)return n.timer=s(),!1;const g=[],v=f.openCursor();v.onsuccess=async function(_){const b=_.target.result;if(b==null){t(g),n.timer=s(),Be.debug("History","已检查无效快照");return}const c=b.value;c!=null&&Date.now()-c.timestamp>_p&&g.push(c),b.continue()},v.onerror=function(_){console.error(_),n.timer=s()}}async function t(f){const g=await Promise.allSettled(f.map(v=>l(v.owner)));for(let v=0;v<g.length;v++){const _=g[v];_.status==="rejected"||_.value!==!0||o(f[v].id)}}async function l(f){const g=await a(ot,"readwrite");return g==null?!1:new Promise(v=>{const _=g.index(Ye).openCursor(IDBKeyRange.only(f));_.onsuccess=function(b){const c=b.target.result;if(c==null)return v(!0);c.delete(),c.continue()},_.onerror=function(b){console.error(b),v(!1)}})}async function o(f){const g=await a(gn,"readwrite");return g==null?!1:Jt(g.delete(f)).then(()=>!0).catch(v=>(console.log(v),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),Ep)}function r(){return new Promise(f=>{const g=indexedDB.open(Dl,yp);g.onupgradeneeded=v=>{const b=v.target.result,c=b.createObjectStore(gn,{keyPath:"id",autoIncrement:!0}),h=b.createObjectStore(ot,{keyPath:"id",autoIncrement:!0});c.createIndex(Ye,xl),h.createIndex(Ye,xl)},g.onsuccess=v=>{const _=v.target;n.db=_.result,Be.debug("History",`已连接数据库【${Dl}】`),f(n.db)},g.onerror=function(v){console.error(v),n.db=null,f(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function a(f,g="readonly"){const v=await i();if(v==null)return null;try{return v.transaction(f,g).objectStore(f)}catch(_){return console.error(_),null}}function u(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:a,cleanup:u}}function Jt(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const Sp=5*60*1e3,gt=Tp();var Xe,Ve,hn,Jn,ko;class Rp{constructor(e,t={}){He(this,Ve);H(this,"state");H(this,"owner");He(this,Xe);this.state=e,this.owner=t.owner??ts(ns.HISTORY_OWNER),Ne(this,Ve,Jn).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await gt.findStore(ot,"readwrite");if(l==null)return!1;await Ne(this,Ve,ko).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await Jt(l.put(s)).catch(je)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await gt.findStore(ot,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await Jt(o.put(l)).catch(je)==null))}async getCurrentSnapshot(){const e=await gt.findStore(ot);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ye).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return o(a);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await gt.findStore(ot);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ye).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await gt.findStore(ot);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(Ye).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await gt.findStore(ot);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(Ye).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const a=i.value;if(a.owner!=t)return i.continue();s.push(a),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){Ie(this,Xe)&&(clearTimeout(Ie(this,Xe)),pt(this,Xe,null))}}Xe=new WeakMap,Ve=new WeakSet,hn=function(){pt(this,Xe,setTimeout(()=>Ne(this,Ve,Jn).call(this),Sp))},Jn=async function(){Ie(this,Xe)&&clearTimeout(Ie(this,Xe));const e=await gt.findStore(gn,"readwrite");if(e==null)return Ne(this,Ve,hn).call(this);const t=await Jt(e.index(Ye).get(this.owner)).catch(je);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),Ne(this,Ve,hn).call(this)}t.timestamp=Date.now(),await Jt(e.put(t)).catch(je),Ne(this,Ve,hn).call(this)},ko=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(Ye).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const a=i.target.result;if(a==null)return s(!0);const u=a.value;if(u.owner!=o)return a.continue();if(u.index>t){a.delete(),a.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function kp(n){const e=new Rp(De({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(f){return e.createSnapshot(n.value,f)}function s(f){return e.replaceSnapshot(n.value,f)}async function r(){const f=await e.getPrevSnapshot();if(f==null)return!1;const g=_n(f.data);return g==null?!1:(n.value=be.create(g),!0)}async function i(){const f=await e.getNextSnapshot();if(f==null)return!1;const g=_n(f.data);return g==null?!1:(n.value=be.create(g),!0)}function a(){return e.list()}function u(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:a,cleanup:u,replaceSnapshot:s}}class wp{constructor(e){H(this,"moved",!1);H(this,"position");H(this,"top",0);H(this,"left",0);H(this,"width",0);H(this,"height",0);H(this,"initX",0);H(this,"initY",0);H(this,"indicator");H(this,"container");H(this,"originalEvent");H(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Pt,Vt,dt,wo,Co,Lo;const Ce=class Ce extends yn{constructor(t={}){var l,o,s;super();He(this,dt);H(this,"context",null);H(this,"selector");H(this,"scale");H(this,"onResizeStart");He(this,Pt);He(this,Vt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??X.PAGE,element:((o=t.selector)==null?void 0:o.element)??X.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??X.RESIZEABLE_INDICATOR},this.onResizeStart=Ne(this,dt,wo).bind(this),pt(this,Pt,Ne(this,dt,Co).bind(this)),pt(this,Vt,Ne(this,dt,Lo).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",Ie(this,Pt)),window.removeEventListener("pointerup",Ie(this,Vt)),this.context=null}};Pt=new WeakMap,Vt=new WeakMap,dt=new WeakSet,wo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Be.warn(Ce.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,Kl);if(o==null)return Be.warn(Ce.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return Be.warn(Ce.TAG_NAME,"未找到的可调整元素");const r=to(s,this.selector.container);this.context=new wp({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Be.warn(Ce.TAG_NAME,"已取消调整");if(this.context.container==null)return Be.warn(Ce.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const a=this.createEvent("resizestart",this.context);if(this.dispatch(a).defaultPrevented)return Be.warn(Ce.TAG_NAME,"已取消调整");window.addEventListener("pointermove",Ie(this,Pt)),window.addEventListener("pointerup",Ie(this,Vt))},Co=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&Kt.TOP){const u=Math.max((i.bottom-t.clientY)/s,Ce.MIN_LENGTH);l.top=(i.bottom-r.top)/s-u,l.height=u}if(o&Kt.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Ce.MIN_LENGTH)),o&Kt.LEFT){const u=Math.max((i.right-t.clientX)/s,Ce.MIN_LENGTH);l.left=(i.right-r.left)/s-u,l.width=u}o&Kt.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Ce.MIN_LENGTH));const a=this.createEvent("resizing",l);this.dispatch(a).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},Lo=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},H(Ce,"TAG_NAME","quickprint-resizeable"),H(Ce,"MIN_LENGTH",12);let Qn=Ce;async function Cp(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?Dt(e.width):Math.round(e.width),o=t?Dt(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-no(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function Lp(n){const e=new Qn({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,ze);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(Cp(n,l),Sn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),Sn.clean()}),n.onResizeStart=e.onResizeStart,e}function Ip(n){function e(r){const i=document.activeElement,a=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||a.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===ce.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===ce.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||ls()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowUp"?-1:1,u=i.map(f=>f.setTop(f.top+a,!0)?f:null).filter(f=>f!=null);u.length>0&&n.replaceSnapshot("top",u);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowLeft"?-1:1,u=i.map(f=>f.setLeft(f.left+a,!0)?f:null).filter(f=>f!=null);u.length>0&&n.replaceSnapshot("left",u);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const a=n.doc.pages.reduce((u,f)=>u.concat(f.children),[]);return n.multiSelectElements(a)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const a=t();for(const u of i)u.setLeft(u.left+8),u.setTop(u.top+8),a.append(u);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const an="openprint:element,";function Np(n){function e(){return navigator.clipboard.readText().catch(a=>(console.log(a),null))}function t(a){return navigator.clipboard.writeText(a).catch(u=>{console.log(u)})}async function l(){const a=await e();if(a==null||!a.startsWith(an))return[];t("");const u=_n(ss(a.slice(an.length)),[]);return u.length===0?[]:u.map(f=>(delete f.id,pe.create(f))).sort(pe.sort)}function o(a){const u=`${an}${os(JSON.stringify(a))}`;return t(u)}async function s(){const a=await e();return typeof a=="string"&&a.startsWith(an)}function r(){}function i(a){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const Io=Symbol();function Op(){return{panel:{left:!0,right:!0},scale:100,selectedType:ce.NONE,selectedPage:void 0,selectMode:Je.SINGLE,selected:[]}}function Dp(n,e){const t=De(Op()),l=kp(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:a,selectPage:g,selectElement:v,resetSelectedElement:_,deleteSelectedElement:b,multiSelectElements:c,isSingleSelectedElement:w,isNoSelectedElement:A,zoomIn:T,zoomOut:h,toggleBackground:N,toggleElementPanel:C,toggleConfigPanel:D,getSelectedElements:u,getSelectedPage:f,cleanup:P,replaceSnapshot:k},r=bp(s),i=Lp(s);s.shortcut=Ip(s),s.createSnapshot=l.createSnapshot,s.clipboard=Np();function a(O){s.document.value=O,s.history.createSnapshot()}function u(){if(s.state.selectedType!==ce.ELEMENT)return[];const O=t.selected;return O.length==0?[]:O.map(M=>s.doc.findElement(M)).filter(M=>M!=null)}function f(){var M;const O=t.selectedPage;if(O!=null)return(M=n.value)==null?void 0:M.findPage(O)}function g(O){return _(),t.selectedPage=O.id,t.selectedType=ce.PAGE,!0}function v(O){t.selectMode=Je.SINGLE,t.selectedType=ce.ELEMENT,t.selectedPage=void 0;const M=u();for(const E of M)E.id!==O.id&&E.blur();return O.focus(),t.selected=[O.id],!0}function _(){const O=u();for(const M of O)M.blur();return t.selected=[],t.selectedType=ce.NONE,!0}function b(){if(t.selectedType!=ce.ELEMENT||t.selected.length==0)return!1;let O=!1;const M=u();for(const E of M)E.remove()&&(O=!0);return O&&s.history.createSnapshot(),!0}function c(O){t.selectMode=Je.MULTIPLE,t.selectedType=ce.ELEMENT,t.selectedPage=void 0;const M=u();for(const E of M)E.blur();for(const E of O)E.focus();return t.selected=O.map(E=>E.id),!0}function h(){const O=t.scale??100,M=Yt.indexOf(O);return M<0?(t.scale=100,!1):M>=Yt.length-1?!1:(t.scale=Yt[M+1],!0)}function T(){const O=t.scale??100,M=Yt.indexOf(O);return M<0?(t.scale=100,!1):M==0?!1:(t.scale=Yt[M-1],!0)}function N(){const M=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=M}function C(){s.state.panel.left=!s.state.panel.left}function D(){s.state.panel.right=!s.state.panel.right}function k(O,M){const E=M??s.doc,S=Array.isArray(E)?"element":E instanceof be?"document":E instanceof Rt?"page":"element",x=Array.isArray(E)?E.map(B=>B.id).join(","):E.id,q=`${S}:${x}:${O}`;return l.replaceSnapshot({action:q})}function w(){return s.state.selectedType!==ce.ELEMENT?!1:s.state.selectMode==Je.SINGLE||s.state.selectMode==Je.MULTIPLE&&s.state.selected.length==1}function A(){return s.state.selectedType!==ce.ELEMENT?!0:s.state.selected.length==0}function P(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),Yl(Io,s),sl(P),s}function Re(){return Wl(Io)}const xp=V({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Le("classes"),l=Re(),o=L(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=L(()=>{const c=e.page.id,h=l.doc.pages.find(T=>T.id===c);return h==null?0:e.direction=="horizontal"?h.width:h.height}),r=L(()=>{const c=s.value,h=[];for(let T=0;T<=c;T+=10)h.push(T/10);return h}),i=L(()=>{const c=s.value,h=[];for(let T=0;T<=c;T+=2.5)h.push(T);return h}),a=L(()=>{const c=l.getSelectedElements();return c.length==1?c[0]:null}),u=L(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),f=L(()=>{const c=a.value;if(c==null)return 0;if(c.type==="TableCell"){const h=c.parent;if(h==null)return 0;const T=h.parent;return h==null?0:T.top+h.offsetTop}if(c.type==="TableRow"){const h=c.parent;return h==null?0:h.top+c.offsetTop}return c.top}),g=L(()=>{const c=a.value;if(c==null)return 0;if(c.type==="TableCell"){const h=c.parent;if(h==null)return 0;const T=h.parent;return h==null?0:T.left+c.offsetLeft}if(c.type==="TableRow"){const h=c.parent;return h==null?0:h.left}return c.left});function v(c,h){return e.direction==="horizontal"?{left:c*(e.scale/100)+"mm",height:(h-2)%4==0?"8px":"4px"}:{top:c*(e.scale/100)+"mm",width:(h-2)%4==0?"8px":"4px"}}function _(c){return e.direction==="horizontal"?{left:c*(e.scale/100)+"cm"}:{top:c*(e.scale/100)+"cm"}}function b(c){return e.direction==="horizontal"?{left:g.value*(e.scale/100)+"px",width:c.width*(e.scale/100)+"px",height:"100%"}:{top:f.value*(e.scale/100)+"px",height:c.height*(e.scale/100)+"px",width:"100%"}}return(c,h)=>(R(),I("div",{class:m(o.value)},[d("div",{class:m(y(t).ruler),style:K(u.value)},[a.value?(R(),I("div",{key:0,class:m(y(t).selected),style:K(b(a.value))},null,6)):G("",!0),(R(!0),I(Q,null,re(i.value,(T,N)=>(R(),I("div",{key:T,class:m(y(t).scale),style:K(v(T,N))},null,6))),128)),(R(!0),I(Q,null,re(r.value,T=>(R(),I("div",{class:m(y(t).number),style:K(_(T))},Z(T),7))),256))],6)],2))}}),Ap="_horizontalRuler_170u5_2",Mp="_verticalRuler_170u5_15",Bp="_ruler_170u5_27",qp="_scale_170u5_32",$p="_number_170u5_46",Pp="_selected_170u5_71",Vp={horizontalRuler:Ap,verticalRuler:Mp,ruler:Bp,scale:qp,number:$p,selected:Pp},Fp={classes:Vp},Al=z(xp,[["__cssModules",Fp]]),zp=["title"],cn=8,Up=V({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=Le("classes"),s={},r=Re(),i=L(()=>({top:Math.round(t.top*t.zoom)+"px"}));function a(v){if(v.button!=0||t.disabled===!0)return;const _=v.target.closest("."+o.dragLine);_!=null&&(v.stopPropagation(),s.init=!1,s.target=_,s.parent=_.offsetParent,s.target.setPointerCapture(v.pointerId),window.addEventListener("pointermove",u),window.addEventListener("pointerup",f))}function u(v){v.preventDefault();const _=g(s.parent);let b=v.clientY-_.top;b<0&&(b=0),b>_.height&&(b=_.height),t.min>0&&b<t.min+cn&&(b=t.min+cn),t.max>0&&b>t.max-cn&&(b=t.max-cn),s.target.style.top=b/(r.state.scale/100)+"px",s.top=b,s.init=!0}function f(v){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(v.pointerId),window.removeEventListener("pointermove",u),window.removeEventListener("pointerup",f)}function g(v){return v instanceof HTMLElement?v.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(v,_)=>(R(),I("div",{class:m({[y(o).dragLine]:!0,[y(o).disabled]:n.disabled}),style:K(i.value),onPointerdown:ne(a,["stop"]),title:n.title},null,46,zp))}}),Hp="_dragLine_1m7rt_2",Gp="_disabled_1m7rt_26",Wp={dragLine:Hp,disabled:Gp},Yp={classes:Wp},Ml=z(Up,[["__cssModules",Yp]]),Xp=V({__name:"Selection",setup(n,{expose:e}){const t=fe(),l=fe(),o=Ut("selectionRef"),s=fe(),r=Re();let i=[];function a(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function u(){const b=[],c=l.value;if(c==null)return b;const h=f(c);if(h.length==0)return b;const T=o.value;return h.forEach(N=>{if(!Os(N,T)){N.classList.remove(X.SELECTED);return}const C=Reflect.get(N,ze);C instanceof pe&&(N.classList.add(X.SELECTED),b.push(C))}),b}function f(b){if(b.matches("."+X.ELEMENT)){const c=Reflect.get(b,ze);if(c&&c.type===Y.TABLE)return b.querySelectorAll(":scope td")}return b.querySelectorAll(`:scope .${X.PAGE} > .${X.SELECTABLE}`)}function g(b,c){const h=c.closest("."+X.PAPER);if(h==null)return;b.stopPropagation(),b.preventDefault();const T=a(),N=h.getBoundingClientRect();T.initialX=b.clientX,T.initialY=b.clientY,T.top=b.clientY-N.top,T.left=b.clientX-N.left,l.value=c,s.value=T,t.value=h,i=[],window.addEventListener("pointermove",v),window.addEventListener("pointerup",_)}function v(b){const c=s.value;if(c==null)return;b.stopPropagation(),b.preventDefault();const h=o.value;if(c.init!==!0){if(Math.abs(b.clientX-c.initialX)<4&&Math.abs(b.clientY-c.initialY)<4)return;h.setPointerCapture(b.pointerId),h.style.display="block",c.init=!0}const T=Math.abs(b.clientX-c.initialX),N=Math.abs(b.clientY-c.initialY),C=b.clientX<c.initialX?-T:0,D=b.clientY<c.initialY?-N:0;h.style.top=c.top+D+"px",h.style.left=c.left+C+"px",h.style.width=T+"px",h.style.height=N+"px",i=u()}function _(b){const c=s.value;if(c==null)return;c.init&&(b.stopPropagation(),b.preventDefault()),i.length>0&&r.multiSelectElements(i);const h=o.value;h.releasePointerCapture(b.pointerId),h.style.display="none",s.value=void 0,window.removeEventListener("pointermove",v),window.removeEventListener("pointerup",_)}return e({onSelectStart:g}),(b,c)=>(R(),I("div",{ref_key:"selectionRef",ref:o,class:m(b.classes.selection),onClick:c[0]||(c[0]=ne(()=>{},["stop"]))},null,2))}}),jp="_selection_10jfe_2",Zp={selection:jp},Kp={classes:Zp},Jp=z(Xp,[["__cssModules",Kp]]);function Qp(n){return De({style:ol(n.style??{})})}function em(n,e){n.style=Object.assign({},n.style,e.style)}const tm=xe(function(n){return wt("元素",(e,t)=>p(ml,{options:Qp(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>em(n,e)).catch(Ae)});function nm(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){tm(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},fl(t,e.element)),kn.open(n.clientX,n.clientY,{menus:l})}const lm=V({props:{element:{type:pe,required:!0}},setup(n){const e=Le("classes"),t=Re(),l=L(()=>{const g=n.element;g.state.key;const v={"--quickprint-element-top":g.top+"px","--quickprint-element-left":g.left+"px","--quickprint-element-width":g.width+"px","--quickprint-element-height":g.height+"px","z-index":g.zIndex};return r()&&(v.transform=`rotate(${g.style.rotate}deg)`),v}),o={TOP:[e.resizeTop,Nt.TOP],BOTTOM:[e.resizeBottom,Nt.BOTTOM],LEFT:[e.resizeLeft,Nt.LEFT],RIGHT:[e.resizeRight,Nt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Nt.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const g=n.element;return g.style.rotate==0||g.style.rotate==null?!1:t.state.selectMode===Je.SINGLE?!g.isSelected:!0}function i(g){const v=np(g.type);if(v==null)return p("div",{class:e.unknown},[p("span",null,[le("未知的打印元素")])]);const _={element:g,key:g.id+"_"+g.state.key};return sp(g.type)?(_.onContextmenu=u,ct(v,_)):ct(v,_)}function a(g,v){v.stopPropagation();const _=v.target.closest("."+X.ELEMENT);_&&Reflect.get(_,wn)===al.DRAG_ELEMENT||t.selectElement(g)}function u(g){g.stopPropagation(),g.preventDefault(),nm(g,n,t)}function f(){return!ip(n.element.type)||r()?null:s.map(g=>{const v={class:[X.RESIZEABLE_INDICATOR,g[0]],["."+Kl]:g[1]};return p("div",hs(v,{onPointerdown:t.onResizeStart}),null)})}return function(){const g=n.element,v={["."+ze]:g,["."+rl]:g.type,id:g.id,key:g.id,class:{[X.ELEMENT]:!0,[X.DRAGGABLE]:!0,[X.RESIZEABLE]:!0,[X.SELECTED]:g.state.selected,[X.SELECTABLE]:op(g.type),["quickprint-is-"+g.type.toLowerCase()]:!0},style:l.value,onClick:a.bind(null,g)};return p("div",v,[i(g),f()])}}}),om="_unknown_za8zh_2",sm="_resizeTop_za8zh_12",im="_resizeBottom_za8zh_20",rm="_resizeLeft_za8zh_28",am="_resizeRight_za8zh_36",cm="_resizeBottomRight_za8zh_44",um={unknown:om,resizeTop:sm,resizeBottom:im,resizeLeft:rm,resizeRight:am,resizeBottomRight:cm},dm={classes:um},fm=z(lm,[["__cssModules",dm]]),No=Fl(()=>zl(()=>import("./component-m7TpiA7_.js"),__vite__mapDeps([2,3,1,4,5]))),pm=V({__name:"DocJson",props:{doc:{type:be,required:!0}},setup(n){const e=n,t=nt(),l=ue(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(R(),J(y(No),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),mm="_json_9crpe_2",gm={json:mm},hm={classes:gm},vm=z(pm,[["__cssModules",hm]]),bm=xe(function(n){return at("调试",p(vm,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(je)});async function ym(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+X.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const a=r.getBoundingClientRect(),u=n.clientX-a.left-i[0].left,f=n.clientY-a.top-i[0].top;for(const g of i)g.setLeft(g.left+u),g.setTop(g.top+f),e.page.append(g);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){bm(t).then(r=>{if(r==null)return;const i=be.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),kn.open(n.clientX,n.clientY,{menus:l})}const _m=V({props:{doc:{type:be,required:!0},page:{type:Rt,required:!0}},setup(n){const e=Le("classes"),t=Re(),l=Ut("selectionRef"),o=Ut("paperRef"),s=ue(0),r=L(()=>n.page.width),i=L(()=>n.page.height);function a(N){N.stopPropagation();const C=N.target.closest("."+X.PAPER);C&&Reflect.get(C,wn)===al.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function u(){if(n.page.header.display===!1)return null;const N=n.page.header.height,C="page_header_"+s.value;return p(Ml,{title:"页眉",top:N,onMove:g,key:C},null)}function f(){if(n.page.footer.display===!1)return null;const N=Ft(i.value)-n.page.footer.height,C="page_footer_"+s.value;return p(Ml,{title:"页脚",top:N,onMove:v,key:C},null)}function g(N){n.page.setHeaderHeight(N.top),s.value++}function v(N){n.page.setFooterHeight(Ft(i.value)-N.top),s.value++}function _(N){N.stopPropagation(),N.preventDefault(),ym(N,n,t)}function b(){const N=n.doc.margins;if(N==null)return null;const C=[];return N.top&&C.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:N.top+"px"}},null)),N.bottom&&C.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:N.bottom+"px"}},null)),N.left&&C.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:N.left+"px"}},null)),N.right&&C.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:N.right+"px"}},null)),C.length>0?C:null}function c(){const N={["."+Zl]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[X.PAGE]:!0,[X.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:_},C=n.page.children.map(D=>p(fm,{element:D},null));return p("div",N,[u(),C,f(),b()])}function h(N){if(N.button!==0)return;N.stopPropagation(),N.preventDefault();const D=N.target.closest("."+X.ELEMENT);if(D==null)return T(N,o.value);const k=Reflect.get(D,ze);return k==null?T(N,o.value):k.type===Y.TABLE?T(N,D):rp(k.type)?t.onDragStart(N):T(N,o.value)}function T(N,C){var D;(D=l.value)==null||D.onSelectStart(N,C)}return function(){const N=t.state.scale/100,C={id:"@"+n.page.id,ref:"paperRef",class:{[X.PAPER]:!0,[X.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*N+"mm",height:i.value*N+"mm"},onPointerdown:h,onClick:a};return p("div",C,[c(),p(Jp,{ref:"selectionRef"},null)])}}}),Em="_paper_fdphx_2",Tm="_grid_fdphx_12",Sm="_marginHorizontalGuide_fdphx_21",Rm="_marginVerticalGuide_fdphx_29",km={paper:Em,grid:Tm,marginHorizontalGuide:Sm,marginVerticalGuide:Rm},wm={classes:km},Cm=z(_m,[["__cssModules",wm]]),Lm={class:"quickprint-is-fill-h quickprint-is-scrollable"},Im="icon-zhanweifu",Nm=V({__name:"Element",setup(n){const e=Re();return(t,l)=>(R(),I("div",{class:m(t.classes.panel)},[d("div",{class:m(t.classes.header)},"可打印元素",2),d("div",Lm,[d("div",{class:m(t.classes.grid)},[(R(!0),I(Q,null,re(y(Jf),o=>(R(),I("div",Xl({key:o.type,class:[y(X).DRAGGABLE,t.classes.element],[`.${y(jl)||""}`]:y(Me).INSERT,[`.${y(rl)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>y(e).onDragStart&&y(e).onDragStart(...s))}),[p(y(F),{icon:o.icon??Im,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),d("span",null,Z(o.title),1)],48))),128))],2)])],2))}}),Om="_panel_1p36j_2",Dm="_header_1p36j_8",xm="_grid_1p36j_18",Am="_element_1p36j_30",Mm="_icon_1p36j_45",Bm={panel:Om,header:Dm,grid:xm,element:Am,icon:Mm},qm={classes:Bm},$m=z(Nm,[["__cssModules",qm]]),Pm=["onClick"],Vm=V({__name:"SelectPath",setup(n){const e=Re(),t=L(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===ce.PAGE){const i=e.getSelectedPage();if(i!=null){const a="页面"+(i.index+1);r.push({id:i.id,title:a,type:"page",data:i})}return r}if(s.selectedType===ce.ELEMENT){if(s.selectMode===Je.MULTIPLE){const u=e.getSelectedElements();if(u.length===0)return r;let f=u[0];for(;f.parent;){const g=f.parent;if(g instanceof Rt){const v="页面"+(g.index+1);return r.push({id:g.id,title:v,type:"page",data:g}),r}f=g}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const a=[{id:i.id,title:tn(i.type),type:"element",data:i}];for(;i.parent;){const u=i.parent;if(u instanceof Rt){const f="页面"+(u.index+1);return a.unshift({id:u.id,title:f,type:"page",data:u}),r.concat(a)}a.unshift({id:u.id,title:tn(u.type),type:"element",data:u}),i=u}}return r}),l=L(()=>{if(e.state.selectedType!=ce.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],a=cl(i,e.doc.ds);if(!(a==null||!a.content))return a.type===ye.VARIABLE||a.type===ye.FORMULA?`[${a.content}]`:a.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(R(),I("div",{class:m(s.classes.paths)},[(R(!0),I(Q,null,re(t.value,(i,a)=>(R(),I(Q,{key:i.id},[a>0?(R(),J(y(F),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):G("",!0),d("div",{class:m(s.classes.path),onClick:u=>o(i)},Z(i.title),11,Pm)],64))),128)),l.value?(R(),I(Q,{key:0},[p(y(F),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),d("div",{class:m(s.classes.content)},Z(l.value),3)],64)):G("",!0)],2))}}),Fm="_paths_fuk62_2",zm="_path_fuk62_2",Um="_icon_fuk62_28",Hm="_content_fuk62_33",Gm={paths:Fm,path:zm,icon:Um,content:Hm},Wm={classes:Gm},Ym=z(Vm,[["__cssModules",Wm]]),Xm=["min","readonly","placeholder"],jm=V({__name:"LabelNumber",props:kt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=nn(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const a=e.min?e.min:e.defaultValue;t.value=a;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const a=Math.pow(10,e.precision);t.value=Math.round(i*a)/a}}return(o,s)=>(R(),I("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[Se(d("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Xm),[[qe,t.value]]),d("span",{class:m(o.classes.label)},Z(n.label),3)],2))}}),Zm="_labelNumber_1aifb_2",Km="_label_1aifb_2",Jm="_readonly_1aifb_25",Qm={labelNumber:Zm,label:Km,readonly:Jm},eg={classes:Qm},At=z(jm,[["__cssModules",eg]]),tg={class:"quickprint-config"},ng={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},lg={class:"quickprint-config-group"},og={class:"quickprint-config-section quickprint-config-inline"},sg={class:"quickprint-config-content quickprint-config-inline"},ig={class:"quickprint-config-group"},rg={class:"quickprint-config-section quickprint-config-inline"},ag={class:"quickprint-config-content quickprint-config-inline"},cg={class:"quickprint-config-section quickprint-config-inline"},ug={class:"quickprint-config-content quickprint-form-inline"},dg={class:"quickprint-config-group"},fg={class:"quickprint-config-section quickprint-config-inline"},pg={class:"quickprint-config-content quickprint-form-inline"},mg={key:0,class:"quickprint-config-section quickprint-config-inline"},gg={class:"quickprint-config-content quickprint-form-inline"},hg={class:"quickprint-config-section quickprint-config-inline"},vg={class:"quickprint-config-content quickprint-form-inline"},bg=V({__name:"PageConfig",props:{page:{type:Rt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=[{label:"禁止",value:sn.NONE},{label:"跟随表格",value:sn.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],o=L({get(){return e.page.size.type},set(u){e.page.size.type=u,u===Qt.CONTENT&&(e.page.size.orientation=void 0)}}),s=L({get(){return e.page.orientation},set(u){e.page.size.orientation=u}}),r=L(()=>e.page.width),i=L({get(){return e.page.height},set(u){const f=Number(u);!nl(f)||f<0||(e.page.size.height=f)}}),a=L({get(){return e.page.footer.flow??sn.NONE},set(u){e.page.footer.flow=u===sn.NONE?void 0:u}});return(u,f)=>(R(),I("div",tg,[f[15]||(f[15]=d("div",{class:"quickprint-config-title"},"页面配置",-1)),d("div",ng,[d("div",lg,[f[7]||(f[7]=d("div",{class:"quickprint-config-group-title"},"页眉",-1)),d("section",og,[f[6]||(f[6]=d("header",{class:"quickprint-config-header"},"位置",-1)),d("div",sg,[p(At,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(xt,{modelValue:n.page.header.display,"onUpdate:modelValue":f[0]||(f[0]=g=>n.page.header.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),d("div",ig,[f[10]||(f[10]=d("div",{class:"quickprint-config-group-title"},"页脚",-1)),d("section",rg,[f[8]||(f[8]=d("header",{class:"quickprint-config-header"},"位置",-1)),d("div",ag,[p(At,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(xt,{modelValue:n.page.footer.display,"onUpdate:modelValue":f[1]||(f[1]=g=>n.page.footer.display=g),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),d("section",cg,[f[9]||(f[9]=d("header",{class:"quickprint-config-header"},"跟随",-1)),d("div",ug,[p(y(ee),{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=g=>a.value=g),options:l},null,8,["modelValue"])])])]),d("div",dg,[f[14]||(f[14]=d("div",{class:"quickprint-config-group-title"},"画布",-1)),d("section",fg,[f[11]||(f[11]=d("header",{class:"quickprint-config-header"},"尺寸",-1)),d("div",pg,[p(xt,{modelValue:o.value,"onUpdate:modelValue":f[3]||(f[3]=g=>o.value=g),options:y(ws),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===y(Qt).CONTENT?(R(),I("section",mg,[f[12]||(f[12]=d("header",{class:"quickprint-config-header"},"内容",-1)),d("div",gg,[p(At,{class:"quickprint-form-inline-item",label:"宽",modelValue:r.value,readonly:""},null,8,["modelValue"]),p(At,{class:"quickprint-form-inline-item",label:"高",modelValue:i.value,"onUpdate:modelValue":f[4]||(f[4]=g=>i.value=g)},null,8,["modelValue"])])])):G("",!0),d("section",hg,[f[13]||(f[13]=d("header",{class:"quickprint-config-header"},"方向",-1)),d("div",vg,[p(xt,{modelValue:s.value,"onUpdate:modelValue":f[5]||(f[5]=g=>s.value=g),class:"quickprint-w-full",options:y(eo),disabled:n.page.size.type===y(Qt).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),yg=["value","placeholder"],_g=V({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=Ut("inputRef"),s=L({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?bl(t.modelValue):t.standard==="mm"&&t.target==="px"?Ft(t.modelValue):0},set(f){if(t.standard===t.target)return l("update:modelValue",f);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Ft(f));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",bl(f))}}),r=L(()=>t.clearable&&s.value!=null);function i(f){const v=f.target.value;if(s==null||v===""){if(t.clearable)return;const b=t.min?t.min:t.defaultValue;s.value=b;return}const _=Number(v);if(!Number.isNaN(_)){if(t.min!=null&&_<t.min){s.value=t.min;return}if(t.standard==="px"){s.value=Math.round(_);return}s.value=_}}function a(){l("update:modelValue",void 0)}function u(){var f;(f=o.value)==null||f.blur(),setTimeout(()=>{var g;return(g=o.value)==null?void 0:g.focus()},50)}return(f,g)=>(R(),I("label",{class:m({[f.classes.inputUnit]:!0,[f.classes.withClear]:n.clearable})},[d("span",{class:m(f.classes.label)},Z(n.label),3),d("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",value:s.value,placeholder:n.placeholder,onBlur:i,onKeydown:Gl(u,["enter"])},null,40,yg),r.value?(R(),I("span",{key:0,class:m(f.classes.clearBtn),onClick:ne(a,["stop"])},[p(y(F),{icon:"icon-close",size:"11px"})],2)):G("",!0)],2))}}),Eg="_inputUnit_2ymft_2",Tg="_clearBtn_2ymft_7",Sg="_label_2ymft_11",Rg="_withClear_2ymft_31",kg={inputUnit:Eg,clearBtn:Tg,label:Sg,withClear:Rg},wg={classes:kg},rt=z(_g,[["__cssModules",wg]]),Cg=V({__name:"UnitSelect",props:kt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=nn(n,"modelValue"),o=L(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(R(),I("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(y(ee),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:ke(()=>[d("span",{class:m(s.classes.text)},Z(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),Lg="_unit_135mn_2",Ig="_text_135mn_8",Ng="_select_135mn_25",Og={unit:Lg,text:Ig,select:Ng},Dg={classes:Og},Oo=z(Cg,[["__cssModules",Dg]]),xg=V({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=ue(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch(is)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(R(),I("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[p(y(F),{icon:"icon-copy"}),p(vs,{name:"quickprint-fade"},{default:ke(()=>[l.value?(R(),I("span",{key:0,class:m(s.classes.message)},"已复制",2)):G("",!0)]),_:1})],2))}}),Ag="_btn_v9scw_2",Mg="_message_v9scw_6",Bg={btn:Ag,message:Mg},qg={classes:Bg},$g=z(xg,[["__cssModules",qg]]),Pg=V({__name:"window",props:{code:{type:String,default:""},doc:{type:be,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=nt(),l=ue(e.code),o=fe();function s(){return l.value}function r(){e.doc!=null&&oc({doc:e.doc}).then(g=>{var _;if(g==null)return;const v=g.type=="reference"?`[=${g.value}]`:`[${g.value}]`;(_=o.value)==null||_.insert(v)})}function i(g){var v;return tt(g,(v=e.doc)==null?void 0:v.ds)}function a(){var g;(g=o.value)==null||g.insert(`[2.6.${el.ELEMENT_VALUR}]`)}function u(){sc().then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}function f(){ic({doc:e.doc}).then(g=>{var v;g!=null&&((v=o.value)==null||v.insert(g.value))})}return t==null||t.useHandle("confirm",s),(g,v)=>(R(),I("div",{class:m(g.classes.window)},[n.mode!=="code"?(R(),I("div",{key:0,class:m(g.classes.toolbar)},[n.mode=="condition"?(R(),I(Q,{key:0},[d("button",{type:"button",class:"quickprint-text-btn",onClick:a},[p(y(F),{icon:"icon-number-sign"}),v[1]||(v[1]=d("span",null,"插入元素值",-1))]),d("div",{class:m(g.classes.divider)},null,2)],64)):G("",!0),d("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[p(y(F),{icon:"icon-insert-var"}),v[2]||(v[2]=d("span",null,"插入变量",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:u},[p(y(F),{icon:"icon-function"}),v[3]||(v[3]=d("span",null,"插入函数",-1))]),d("button",{type:"button",class:"quickprint-text-btn",onClick:f},[p(y(F),{icon:"icon-formula"}),v[4]||(v[4]=d("span",null,"插入公式",-1))])],2)):G("",!0),p(y(No),{modelValue:l.value,"onUpdate:modelValue":v[0]||(v[0]=_=>l.value=_),language:"javascript",class:m(g.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),Vg="_window_n935p_2",Fg="_toolbar_n935p_11",zg="_code_n935p_22",Ug="_divider_n935p_27",Hg={window:Vg,toolbar:Fg,code:zg,divider:Ug},Gg={classes:Hg},Do=z(Pg,[["__cssModules",Gg]]),xo=xe(function(n){return at("公式",p(Do,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Ae)}),Wg=xe(function(n,e){return at(n,p(Do,{code:e},null),{preset:"editor"}).promisify().catch(Ae)}),Yg={class:"quickprint-config-section quickprint-config-inline"},Xg={class:"quickprint-config-content"},jg=["value"],Zg=V({__name:"Visibility",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=L({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??Et.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==Et.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=L({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=L(()=>{var i;return ul((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=L(()=>{var i;return t.value!==Et.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${el.ELEMENT_VALUR}]`;xo({code:i,doc:e.element.doc,mode:"condition"}).then(a=>{a!=null&&(l.value=a)})}return(i,a)=>(R(),I(Q,null,[d("section",Yg,[a[1]||(a[1]=d("header",{class:"quickprint-config-header"},"可见性",-1)),d("div",Xg,[p(y(ee),{class:"quickprint-w-full",options:y(_s),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=u=>t.value=u)},null,8,["options","modelValue"])])]),t.value===y(Et).CONDITION?(R(),I("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[d("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,jg),s.value?(R(),J(y(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2)):G("",!0)],64))}}),Kg="_condition_siopf_2",Jg={condition:Kg},Qg={classes:Jg},eh=z(Zg,[["__cssModules",Qg]]);function th(n){return L({get(){return n.element.attributes.position??vn.DEFAULT},set(e){const t=e===vn.DEFAULT?void 0:e;n.element.attributes.position=t}})}function nh(n){return L({get(){return n.element.attributes.printMode??bn.ONCE},set(e){const t=e===bn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function lh(n){return L({get(){return n.element.attributes.overflow??en.HIDDEN},set(e){const t=e===en.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function oh(n){return L({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function sh(n){return L({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function ih(n){return L({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function rh(n){return L({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const ah=V({__name:"Const",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=L({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,o)=>Se((R(),I("textarea",{"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[qe,t.value]])}}),ch={class:"quickprint-config-ds-var-type"},uh=["title"],dh=V({__name:"Variable",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Re(),l=L(()=>ie(e.element.ds.value)),o=L(()=>tt(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var f;const i=await dl({doc:t.doc,value:e.element.ds.value}).catch(je);if(i==null||(e.element.setDataSource(ye.VARIABLE,i.value),e.element.type!=Y.TABLE_CELL||i.type!=="ds"))return;const a=e.element.parent;if(a==null||a.isBindVariable||((f=i.parent)==null?void 0:f.type)!==te.ARRAY)return;const u=i.parent;a.setDataSource(ye.VARIABLE,`${Tt.DS}.${u.type}.${u.name}`)}return(i,a)=>(R(),I("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(R(),I(Q,{key:0},[a[0]||(a[0]=d("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(y(F),{icon:"icon-open-new",size:"14px"})],64)):(R(),I(Q,{key:1},[d("span",ch,"<"+Z(y(qr)(e.element.ds.value))+">",1),d("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},Z(o.value),9,uh),d("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[p(y(F),{icon:"icon-close",size:"12px"})])],64))]))}}),fh=["value"],ph=V({__name:"Code",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=L(()=>ie(e.element.ds.value));function l(){return tl(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){Wg("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(R(),I("div",{onClick:o,class:m(s.classes.code)},[d("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,fh),t.value?(R(),J(y(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2))}}),mh="_code_1az68_2",gh={code:mh},hh={classes:gh},vh=z(ph,[["__cssModules",hh]]),bh=["value"],yh=V({__name:"Formula",props:{element:{type:pe,required:!0}},setup(n){const e=n,t=Re(),l=L(()=>ie(e.element.ds.value)),o=L(()=>ul(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;xo({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(R(),I("div",{onClick:s,class:m(r.classes.code)},[d("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,bh),l.value?(R(),J(y(F),{key:0,icon:"icon-open-new",size:"14px"})):G("",!0)],2))}}),_h="_code_ipm2q_2",Eh={code:_h},Th={classes:Eh},Sh=z(yh,[["__cssModules",Th]]);function Rh(n){switch(n.ds.type){case ye.CONST:return p(ah,{element:n},null);case ye.VARIABLE:return p(dh,{element:n},null);case ye.CODE:return p(vh,{element:n},null);case ye.FORMULA:return p(Sh,{element:n},null);default:return null}}const kh=V({props:{element:{type:pe,required:!0}},setup(n){const e=L(()=>tn(n.element.type)),t=L(()=>Rs.filter(C=>C.value!=n.element.type)),l=ue("px"),o=oh(n),s=sh(n),r=lh(n),i=th(n),a=nh(n),u=ih(n),f=rh(n),g=L(()=>{const C=n.element,D=C.parent;if(D===null||!(D instanceof Rt))return!1;const k=D.header;if(k.display&&C.bottom<=(k.height??0))return!1;const w=D.parent;if(w==null)return!1;const A=D.footer;return!(A.display&&C.top>=Math.floor(Ft(w.paper.height))-(A.height??0))});function v(C,D){return D==null?!1:!!D.includes(C)}function _(){const C=jt(n.element.type);if(v(de.LAYOUT,C==null?void 0:C.exclude))return null;const D=n.element,k=v(de.COORD,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(rt,{class:"quickprint-form-inline-item",label:"左",modelValue:D.left,"onUpdate:modelValue":E=>D.left=E,target:l.value},null),p(rt,{class:"quickprint-form-inline-item",label:"上",modelValue:D.top,"onUpdate:modelValue":E=>D.top=E,target:l.value},null)])]),w=v(de.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[le("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(rt,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,"onUpdate:modelValue":E=>o.value=E,target:l.value},null),p(rt,{class:"quickprint-form-inline-item",label:"高",modelValue:s.value,"onUpdate:modelValue":E=>s.value=E,target:l.value},null)])]),A=v(de.VISIBILITY,C==null?void 0:C.exclude)?null:p(eh,{element:D},null),P=v(de.OVERFLOW,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("溢出时")]),p("div",{class:"quickprint-config-content"},[p(ee,{modelValue:r.value,"onUpdate:modelValue":E=>r.value=E,options:Is,class:"quickprint-w-full"},null)])]),O=v(de.PRINT_MODE,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[le("打印模式")]),p("div",{class:"quickprint-config-content"},[p(ee,{modelValue:a.value,"onUpdate:modelValue":E=>a.value=E,options:Ls,class:"quickprint-w-full"},null)])]),M=v(de.POSITION,C==null?void 0:C.exclude)||!g.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("定位模式")]),p("div",{class:"quickprint-config-content"},[p(ee,{modelValue:i.value,"onUpdate:modelValue":E=>i.value=E,options:Cs,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[le("布局")]),p("span",null,[le("单位：")]),p(Oo,{modelValue:l.value,"onUpdate:modelValue":E=>l.value=E},null)]),k,w,A,P,O,M])}function b(){const C=jt(n.element.type);if(v(de.BASIC,C==null?void 0:C.exclude))return null;const D=n.element,k=v(de.PREFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("前缀")]),p("div",{class:"quickprint-config-content"},[Se(p("input",{"onUpdate:modelValue":P=>D.attributes.prefix=P,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[qe,D.attributes.prefix]])])]),w=v(de.SUFFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("后缀")]),p("div",{class:"quickprint-config-content"},[Se(p("input",{"onUpdate:modelValue":P=>D.attributes.suffix=P,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[qe,D.attributes.suffix]])])]),A=v(de.DISPLAY,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("数据类型")]),p("div",{class:"quickprint-config-content"},[p(ee,{options:t.value,modelValue:u.value,"onUpdate:modelValue":P=>u.value=P,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("基础")]),k,w,A])}function c(){const C=jt(n.element.display);return(C==null?void 0:C.display)==null?null:ct(C.display,{element:n.element})}function h(){const C=jt(n.element.type);if(v(de.ATTRIBUTES,C==null?void 0:C.exclude))return null;const D=C!=null&&C.attributes?ct(C.attributes,{element:n.element}):null,k=c();if(D==null&&k==null)return null;const w=k!=null&&D!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("属性")]),k,w,D])}function T(){const C=jt(n.element.type);return v(de.DATASOURCE,C==null?void 0:C.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("数据")]),p(ee,{options:Jl,modelValue:f.value,"onUpdate:modelValue":D=>f.value=D},null),Rh(n.element)])}function N(C){C(n.element.id)}return function(){const D=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,le("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[D.id]),p($g,{onCopy:N},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("标题")]),p("div",{class:"quickprint-config-content"},[Se(p("input",{type:"text","onUpdate:modelValue":k=>D.title=k,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[qe,D.title]])])])]),_(),b(),h(),T()])])}}}),wh=V({setup(){const n=Re(),e=Le("classes");function t(){return p("div",{class:e.tip},[le("未知的打印元素")])}function l(){return p("div",{class:e.tip},[le("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return p(bg,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(Y).includes(i.type)===!1?t():ct(kh,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==ce.ELEMENT?!1:i.selectMode===Je.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),Ch="_tip_cdonk_2",Lh={tip:Ch},Ih={classes:Lh},Nh=z(wh,[["__cssModules",Ih]]);function Ue(n,e){if(n.state.selectedType!==ce.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function $e(n,e,t){if(n.state.selectedType!==ce.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function Fe(n,e){if(n.state.selectedType!==ce.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function Oh(n){const e="underline";return L({get(){if(n.state.selectedType!==ce.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?$e(n,e,t):Fe(n,e)}})}function Dh(n){const e="lineThrough";return L({get(){if(n.state.selectedType!==ce.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?$e(n,e,t):Fe(n,e)}})}function xh(n){const e="lineHeight";return L({get(){return Ue(n,e)},set(t){t===vt.DEFAULT?Fe(n,e):$e(n,e,t)}})}function Ah(n){const e="highlightColor";return L({get(){return Ue(n,e)??Oe.BLACK},set(t){t===""?Fe(n,e):$e(n,e,t)}})}function Mh(n){const e="backgroundColor";return L({get(){return Ue(n,e)??Oe.BLACK},set(t){t===""?Fe(n,e):$e(n,e,t)}})}function Bh(n){const e="fontStyle";return L({get(){return Ue(n,e)===yl.ITALIC},set(t){t?$e(n,e,yl.ITALIC):Fe(n,e)}})}function qh(n){const e="textAlign";return L({get(){return Ue(n,e)??it.LEFT},set(t){t===it.LEFT?Fe(n,e):$e(n,e,t)}})}function $h(n){const e="verticalAlign";return L({get(){return Ue(n,e)??Ze.MIDDLE},set(t){t===Ze.MIDDLE?Fe(n,e):$e(n,e,t)}})}function Ph(n){const e="fontFamily";return L({get(){return Ue(n,e)},set(t){t===se.DEFAULT?Fe(n,e):$e(n,e,t)}})}function Vh(n){const e="fontSize";return L({get(){return Ue(n,e)},set(t){t===Ee.DEFAULT?Fe(n,e):$e(n,e,t)}})}function Fh(n){const e="color";return L({get(){return Ue(n,e)??Oe.BLACK},set(t){$e(n,e,t)}})}function zh(n){const e="fontWeight";return L({get(){return Ue(n,e)===700},set(t){t?$e(n,e,700):Fe(n,e)}})}const Uh=["title","onClick"],Hh=V({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=Re(),l=L(()=>{if(t.state.selectedType!==ce.ELEMENT)return null;const b=t.getSelectedElements();if(b.length!==1)return null;const c=b[0],h={};return ge(c,"top")&&(h.borderTopStyle="solid"),ge(c,"right")&&(h.borderRightStyle="solid"),ge(c,"bottom")&&(h.borderBottomStyle="solid"),ge(c,"left")&&(h.borderLeftStyle="solid"),h}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(_){if(t.state.selectedType!==ce.ELEMENT)return!1;const c=t.getSelectedElements();if(c.length!==1)return!1;const h=c[0];switch(_){case e.TOP:return ge(h,"top");case e.RIGHT:return ge(h,"right");case e.BOTTOM:return ge(h,"bottom");case e.LEFT:return ge(h,"left");case e.ALL:return ge(h,"top")&&ge(h,"right")&&ge(h,"bottom")&&ge(h,"left");default:return!1}}function r(_){if(t.state.selectedType!==ce.ELEMENT)return;const c=t.getSelectedElements();if(c.length!=0){switch(_){case e.TOP:return a(c);case e.BOTTOM:return f(c);case e.LEFT:return g(c);case e.RIGHT:return u(c);case e.ALL:return v(c)}t.createSnapshot()}}function i(){if(t.state.selectedType!==ce.ELEMENT)return;const b=t.getSelectedElements();if(b.length!=0){for(const c of b)c.setStyle("borderStyle",void 0),c.setStyle("borderTopStyle",void 0),c.setStyle("borderRightStyle",void 0),c.setStyle("borderBottomStyle",void 0),c.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function a(_){const b=!_.every(c=>ge(c,"top"));for(const c of _)b?c.setStyle("borderTopStyle",ae.SOLID):c.removeStyle("borderTopStyle")}function u(_){const b=!_.every(c=>ge(c,"right"));for(const c of _)b?c.setStyle("borderRightStyle",ae.SOLID):c.removeStyle("borderRightStyle")}function f(_){const b=!_.every(c=>ge(c,"bottom"));for(const c of _)b?c.setStyle("borderBottomStyle",ae.SOLID):c.removeStyle("borderBottomStyle")}function g(_){const b=!_.every(c=>ge(c,"left"));for(const c of _)b?c.setStyle("borderLeftStyle",ae.SOLID):c.removeStyle("borderLeftStyle")}function v(_){const b=!_.every(c=>ge(c,"top")&&ge(c,"right")&&ge(c,"bottom")&&ge(c,"left"));for(const c of _){if(b){c.setStyle("borderStyle",b?"solid":void 0);continue}c.removeStyle("borderStyle"),c.removeStyle("borderTopStyle"),c.removeStyle("borderRightStyle"),c.removeStyle("borderBottomStyle"),c.removeStyle("borderLeftStyle")}}return(_,b)=>(R(),J(y(io),null,{popover:ke(()=>[d("div",{class:m(_.classes.popover)},[d("div",null,[(R(),I("button",{type:"button",title:"全部框线",key:y(e).ALL,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0,"quickprint-is-selected":s(y(e).ALL)}),onClick:b[0]||(b[0]=c=>r(y(e).ALL))},[p(y(F),{icon:"icon-border",size:"16px"})],2)),(R(),I("button",{type:"button",title:"无框线",key:y(e).NONE,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0}),onClick:i},[p(y(F),{icon:"icon-border-none",size:"16px"})],2))]),d("div",{class:m(_.classes.divider)},[(R(),I(Q,null,re(o,c=>d("button",{type:"button",title:c.label,key:c.value,class:m({"quickprint-text-btn":!0,[_.classes.tool]:!0,"quickprint-is-selected":s(c.value)}),onClick:h=>r(c.value)},[p(y(F),{icon:c.icon,size:"16px"},null,8,["icon"])],10,Uh)),64))],2)],2)]),default:ke(()=>[d("div",{class:m(["quickprint-text-btn",_.classes.borderSelect]),title:"边框"},[d("div",{class:m({[_.classes.border]:!0}),style:K(l.value)},null,6)],2)]),_:1}))}}),Gh="_border_rprfx_2",Wh="_borderSelect_rprfx_10",Yh="_popover_rprfx_14",Xh="_divider_rprfx_18",jh={border:Gh,borderSelect:Wh,popover:Yh,divider:Xh},Zh={classes:jh},Kh=z(Hh,[["__cssModules",Zh]]),Jh={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Qh={class:"quickprint-config-section"},ev={class:"quickprint-form-inline"},tv={class:"quickprint-config-section quickprint-config-inline"},nv={class:"quickprint-config-section"},lv={class:"quickprint-config-header quickprint-is-row"},ov={class:"quickprint-is-fill-w"},sv={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},iv={class:"quickprint-config-content quickprint-form-inline"},rv=V({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=ue("px"),l=v("top"),o=v("bottom"),s=v("left"),r=v("right"),i=L(()=>Vn.map(_=>({label:_.size===Fn.CUSTOM?"自定义":`${_.size}(${_.width}mm ✕ ${_.height}mm)`,value:_.size})));function a(_){e.config.width=_,g()}function u(_){e.config.height=_,g()}function f(_){const b=Vn.find(c=>c.size===_);b!=null&&(e.config.width=b.width,e.config.height=b.height,e.config.orientation=b.orientation,e.config.margins=b.margins,e.config.size=b.size)}function g(){const _=e.config,b=Vn.find(c=>c.size===Fn.CUSTOM?!1:c.orientation===_.orientation&&c.width===_.width&&c.height===_.height);if(b==null){_.size=Fn.CUSTOM;return}_.size=b.size}function v(_){return L({get(){var b;return(b=e.config.margins)==null?void 0:b[_]},set(b){e.config.margins==null&&(e.config.margins={}),e.config.margins[_]=b}})}return(_,b)=>(R(),I("div",Jh,[d("section",Qh,[b[6]||(b[6]=d("header",{class:"quickprint-config-header"},[d("span",null,"尺寸")],-1)),p(y(ee),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":f,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),d("div",ev,[p(At,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":a},null,8,["modelValue"]),p(At,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":u},null,8,["modelValue"])])]),d("section",tv,[b[7]||(b[7]=d("header",{class:"quickprint-config-header"},"方向",-1)),p(xt,{modelValue:n.config.orientation,"onUpdate:modelValue":b[0]||(b[0]=c=>n.config.orientation=c),options:y(eo)},null,8,["modelValue","options"])]),d("section",nv,[d("header",lv,[d("span",ov,[p(y(Ps),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:ke(()=>b[8]||(b[8]=[le("参考边距")])),_:1})]),b[9]||(b[9]=d("span",null,"单位：",-1)),p(Oo,{modelValue:t.value,"onUpdate:modelValue":b[1]||(b[1]=c=>t.value=c)},null,8,["modelValue"])]),d("div",sv,[p(rt,{class:"quickprint-form-inline-item",label:"上",modelValue:y(l),"onUpdate:modelValue":b[2]||(b[2]=c=>Ke(l)?l.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(rt,{class:"quickprint-form-inline-item",label:"下",modelValue:y(o),"onUpdate:modelValue":b[3]||(b[3]=c=>Ke(o)?o.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),d("div",iv,[p(rt,{class:"quickprint-form-inline-item",label:"左",modelValue:y(s),"onUpdate:modelValue":b[4]||(b[4]=c=>Ke(s)?s.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(rt,{class:"quickprint-form-inline-item",label:"右",modelValue:y(r),"onUpdate:modelValue":b[5]||(b[5]=c=>Ke(r)?r.value=c:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),av={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},cv={class:"quickprint-is-fill-h"},uv={class:"quickprint-is-fill-h"},dv=V({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Te.NONE},{label:"磅",value:Te.PT},{label:"像素",value:Te.PX}],l=L(()=>xn.map(u=>(u.style={fontFamily:u.value==se.DEFAULT?se.SONG:u.value},u))),o=L(()=>bo.map(u=>(u.style={fontFamily:u.value==se.DEFAULT?se.SONG:u.value},u))),s=L({get(){return e.config.style.fontFamily??se.DEFAULT},set(u){const f=u===se.DEFAULT?void 0:u;e.config.style.fontFamily=f}}),r=L({get(){return e.config.style.enFontFamily??se.DEFAULT},set(u){const f=u===se.DEFAULT?void 0:u;e.config.style.enFontFamily=f}}),i=L({get(){return e.config.style.fontSize},set(u){const f=ie(u)?void 0:u;e.config.style.fontSize=f}}),a=L({get(){return e.config.style.lineHeight},set(u){e.config.style.lineHeight=u}});return(u,f)=>(R(),I("div",av,[d("section",{class:m(u.classes.font)},[d("div",{class:m(u.classes.zhFont)},[d("div",{class:m(u.classes.title)},"中文字体",2),d("div",cv,[p(y(ee),{options:l.value,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=g=>s.value=g)},null,8,["options","modelValue"])])],2),d("div",{class:m(u.classes.enFont)},[d("div",{class:m(u.classes.title)},"西文字体",2),d("div",uv,[p(y(ee),{options:o.value,modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=g=>r.value=g)},null,8,["options","modelValue"])])],2),d("div",{class:m(u.classes.lineHeight)},[d("div",{class:m(u.classes.title)},"行高",2),p(We,{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=g=>a.value=g),options:t},null,8,["modelValue"])],2),d("div",{class:m(u.classes.fontSize)},[d("div",{class:m(u.classes.title)},"字号",2),p(_o,{modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=g=>i.value=g),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),fv="_font_145qf_2",pv="_zhFont_145qf_9",mv="_enFont_145qf_16",gv="_lineHeight_145qf_23",hv="_fontSize_145qf_30",vv="_title_145qf_45",bv={font:fv,zhFont:pv,enFont:mv,lineHeight:gv,fontSize:hv,title:vv},yv={classes:bv},_v=z(dv,[["__cssModules",yv]]),Ev=V({__name:"index",props:{doc:{type:be,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=nt(),l=De(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,a)=>(R(),I("div",{class:m(i.classes.setting)},[n.active=="paper"?(R(),J(rv,{key:0,config:l},null,8,["config"])):G("",!0),n.active=="font"?(R(),J(_v,{key:1,config:l},null,8,["config"])):G("",!0),d("div",{class:m(i.classes.footer)},[d("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),d("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),Tv="_setting_h98ws_2",Sv="_footer_h98ws_10",Rv={setting:Tv,footer:Sv},kv={classes:Rv},wv=z(Ev,[["__cssModules",kv]]),Cv=xe(function(n){return wt("文档",(e,t)=>p(wv,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Ae)}),Lv=V({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Re(),t=Le("classes"),l=Ph(e),o=Vh(e),s=xh(e),r=Mh(e),i=Ah(e),a=Fh(e),u=zh(e),f=Bh(e),g=Oh(e),v=Dh(e),_=qh(e),b=$h(e),c=L(()=>xn.map(S=>(S.style={fontFamily:S.value==se.DEFAULT?se.SONG:S.value},S)));function h(S){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>S.handler(e)},[S.icon&&p(F,{icon:S.icon},null),p("span",null,[S.label])])}function T(S){S.preventDefault()}function N(){u.value=!u.value}function C(){f.value=!f.value}function D(){g.value=!g.value}function k(){v.value=!v.value}function w(){const S=e.getSelectedElements();if(S.length==0)return;const x=Math.min(...S.map(q=>q.left));for(const q of S)q.setLeft(x,!0);e.createSnapshot()}function A(){const S=e.getSelectedElements();if(S.length==0)return;const x=S[0].page;if(x==null)return;const q=Ft(x.width);for(const B of S)B.setLeft((q-B.width)/2);e.createSnapshot()}function P(){const S=e.getSelectedElements();if(S.length==0)return;const x=Math.max(...S.map(q=>q.left+q.width));for(const q of S)q.setLeft(x-q.width,!0);e.createSnapshot()}async function O(){const S=await lc(e.doc);S!=null&&(e.doc.ds=e.doc.createDS(S))}function M(){Cv(e.doc)}function E(S){var x,q;if(typeof S=="function")return S(e,t);if(typeof S=="object")return h(S);if(typeof S!="string")return null;switch(S){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const B=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:B,onClick:e.history.undo},[p(F,{icon:"icon-undo"},null)])}case"redo":{const B=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:B,onClick:e.history.redo},[p(F,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(F,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(ee,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":B=>l.value=B,options:c.value,class:t.tool,button:!0},null);case"fontSize":return p(ee,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":B=>o.value=B,options:pl,class:t.tool,button:!0},null);case"lineHeight":return p(ee,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":B=>s.value=B,options:yo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(Bt,{modelValue:r.value,"onUpdate:modelValue":B=>r.value=B,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(F,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return p(Bt,{modelValue:i.value,"onUpdate:modelValue":B=>i.value=B,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(F,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return p(Bt,{modelValue:a.value,"onUpdate:modelValue":B=>a.value=B,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(F,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"fontWeight":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":u.value};return p("button",{type:"button",title:"加粗",class:B,onClick:N},[p(F,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":f.value};return p("button",{type:"button",title:"斜体",class:B,onClick:C},[p(F,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":g.value};return p("button",{type:"button",title:"下划线",class:B,onClick:D},[p(F,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const B={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":v.value};return p("button",{type:"button",title:"删除线",class:B,onClick:k},[p(F,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(Kh,null,null);case"textAlign":{const B=((x=Kn.find(j=>j.value===_.value))==null?void 0:x.label)??"水平对齐",oe={selected({option:j}){return p(F,{icon:j==null?void 0:j.icon,class:"quickprint-is-self-center"},null)}};return p(ee,{modelValue:_.value,"onUpdate:modelValue":j=>_.value=j,options:Kn,title:B,class:t.tool,width:"36px",size:"mini",button:!0},oe)}case"verticalAlign":{const B=((q=Zn.find(j=>j.value===b.value))==null?void 0:q.label)??"垂直对齐",oe={selected({option:j}){return p(F,{icon:j==null?void 0:j.icon,class:"quickprint-is-self-center"},null)}};return p(ee,{modelValue:b.value,"onUpdate:modelValue":j=>b.value=j,options:Zn,title:B,class:t.tool,width:"36px",size:"mini",button:!0},oe)}case"alignLeft":{const B={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:B,onClick:w},[p(F,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const B={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:B,onClick:A},[p(F,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const B={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:B,onClick:P},[p(F,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const B={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:B,onClick:e.toggleBackground},[p(F,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const B={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:B,onClick:e.toggleElementPanel},[p(F,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const B={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:B,onClick:e.toggleConfigPanel},[p(F,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:O},[p(F,{icon:"icon-datasource"},null),p("span",null,[le("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:M},[p(F,{icon:"icon-file-text"},null),p("span",null,[le("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:T},[n.toolbar.map(E)])}}}),Iv="_toolbar_1bhq2_2",Nv="_divider_1bhq2_8",Ov="_tool_1bhq2_2",Dv="_colorIcon_1bhq2_18",xv="_colorIndicator_1bhq2_38",Av={toolbar:Iv,divider:Nv,tool:Ov,colorIcon:Dv,colorIndicator:xv},Mv={classes:Av},Bv=z(Lv,[["__cssModules",Mv]]);function qv(n){let e=null;const t=fe(),l=De({width:0,height:0,scrollTop:0,scrollLeft:0}),o=fe(),s=De({id:"",top:0,left:0,width:0,height:0});async function r(){await zt();const _=t.value;_!=null&&(l.width=_.offsetWidth,l.height=_.offsetHeight)}function i(_){const b=_.target;l.scrollLeft=b.scrollLeft,l.scrollTop=b.scrollTop}function a(_){const c=_.target.closest("."+X.PAPER);c!=null&&(o.value=c,f(c),u())}async function u(){await zt();const _=o.value;_!=null&&(s.id=_.id.slice(1),s.width=_.offsetWidth,s.height=_.offsetHeight,s.top=_.offsetTop,s.left=_.offsetLeft)}function f(_){_!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(_))}function g(){const _=n.doc.firstPage;if(_==null)return;const b=document.querySelector("#\\@"+_.id);o.value=b,e&&b&&e.observe(b),u()}function v(_){_.some(b=>b.target.matches("."+X.CANVAS))&&(r(),u()),_.some(b=>b.target.matches("."+X.PAPER))&&(r(),u())}return il(()=>n.state.scale,()=>u()),ln(()=>{e=new ResizeObserver(v),e.observe(t.value),g(),r()}),bs(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:a}}const Ao=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),$v=V({__name:"index",props:kt({modelValue:{type:be,required:!0},toolbar:{type:Array,default(){return Ao}}},{modelValue:{required:!0},modelModifiers:{}}),emits:kt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=fe(),o=fe(),s=Ds(),r=nn(n,"modelValue"),i=Dp(r,{queryElement:T,dispatchEvent:N}),{canvasRef:a,canvasRect:u,pageRect:f,onScroll:g,onSelectPage:v}=qv(i),_=L(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),b=L(()=>{const D=i.doc.style;return{fontFamily:ll(D==null?void 0:D.fontFamily,D==null?void 0:D.enFontFamily),fontSize:D==null?void 0:D.fontSize,lineHeight:D==null?void 0:D.lineHeight}});function c(){i.state.panel.left=!1}function h(){i.state.panel.right=!1}function T(D){switch(D){case"ghost":return o.value;case"root":return l.value;default:return}}function N(D,...k){t(D,...k)}function C(D){D.deltaY>0?i.zoomIn():i.zoomOut()}return(D,k)=>(R(),I("div",{class:m(D.classes.designer),ref_key:"rootRef",ref:l,style:K(_.value)},[d("div",{class:m(D.classes.header)},[et(D.$slots,"headerLeft"),p(Bv,{class:m(D.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),et(D.$slots,"headerRight")],2),d("div",{class:m(D.classes.main)},[y(i).state.panel.left?(R(),I("div",{key:0,class:m(D.classes.left)},[d("button",{type:"button",onClick:c,class:m(["quickprint-text-btn",D.classes.closePanelBtn])},[p(y(F),{icon:"icon-close",size:"12px"})],2),p($m)],2)):G("",!0),d("div",{class:m([D.classes.center,y(X).CANVAS]),onWheel:ne(C,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:a},[p(Al,{canvas:y(u),page:y(f),scale:y(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Al,{canvas:y(u),page:y(f),scale:y(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),d("div",{class:m([y(X).SCROLLABLE,D.classes.canvas]),style:K(b.value),onScroll:k[0]||(k[0]=(...w)=>y(g)&&y(g)(...w)),onClickCapture:k[1]||(k[1]=(...w)=>y(v)&&y(v)(...w))},[(R(!0),I(Q,null,re(r.value.pages,w=>(R(),J(Cm,{key:w.id,doc:r.value,page:w},null,8,["doc","page"]))),128))],38),d("div",{class:m(D.classes.footer)},[p(Ym),p(y(rs),{scale:y(i).state.scale,onZoomIn:y(i).zoomIn,onZoomOut:y(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),y(i).state.panel.right?(R(),I("div",{key:1,class:m(D.classes.right)},[d("button",{type:"button",onClick:h,class:m(["quickprint-text-btn",D.classes.closePanelBtn])},[p(y(F),{icon:"icon-close",size:"12px"})],2),p(Nh)],2)):G("",!0)],2),d("div",{ref_key:"ghostRef",ref:o,class:m(D.classes.ghost)},null,2),p(y(as))],6))}}),Pv="_designer_grxxm_2",Vv="_header_grxxm_17",Fv="_toolbar_grxxm_25",zv="_footer_grxxm_31",Uv="_main_grxxm_47",Hv="_left_grxxm_55",Gv="_center_grxxm_63",Wv="_right_grxxm_75",Yv="_canvas_grxxm_83",Xv="_closePanelBtn_grxxm_96",jv="_ghost_grxxm_103",Zv={designer:Pv,header:Vv,toolbar:Fv,footer:zv,main:Uv,left:Hv,center:Gv,right:Wv,canvas:Yv,closePanelBtn:Xv,ghost:jv},Kv={classes:Zv},Jv=z($v,[["__cssModules",Kv]]),Qv={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:fn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Ae)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:fn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:fn.DISABLED}};function eb(n,e={}){const t=cs(e.zIndexManager);n.use(us,{zIndex:t,presets:Qv}),ds(n._context)}const tb="0.0.0",nb={version:tb,install:eb},lb=["onClick"],ob=V({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=nt();function l(o){t==null||t.confirm(o)}return(o,s)=>(R(),I("div",{class:m(o.classes.panel)},[(R(!0),I(Q,null,re(y(fs),(r,i)=>(R(),I("div",{key:r.id,class:m(o.classes.item),onClick:a=>l(r)},[d("div",null,[d("span",null,Z(i+1)+". ",1),d("span",null,Z(r.name),1)])],10,lb))),128))],2))}}),sb="_panel_1he7q_2",ib="_item_1he7q_9",rb={panel:sb,item:ib},ab={classes:rb},cb=z(ob,[["__cssModules",ab]]),ub='<div class="quickprint-md"><h2>设计</h2><ul><li>feat: 表格行设置</li><li>feat: 单元格设置<ul><li>单元格支持斜线分割，并设置文字</li><li>单元格设置支持多选</li></ul></li><li>feat: 文字方向<ul><li>参照wps文字方向</li><li>垂直文字合并 text-combine-upright</li></ul></li></ul></div>',db=["innerHTML"],fb=V({__name:"Todo",setup(n){return(e,t)=>(R(),I("div",{innerHTML:y(ub),class:m(e.classes.doc)},null,10,db))}}),pb="_doc_eo2ef_2",mb={doc:pb},gb={classes:mb},hb=z(fb,[["__cssModules",gb]]),vb="local",Bl="quickprint-local-define",bb=V({__name:"index",setup(n){const e=Le("classes"),t=_(),l="20250914",o=[{label:"新建",icon:"icon-file-text",handler:f},{label:"加载示例",icon:"icon-import",handler:a},"---",...Ao];function s(){const c=JSON.stringify(t.value);localStorage.setItem(Bl,c)}function r(){s()}function i(){const c=t.value.id,h=c.startsWith("case_")?c:vb,T=`${window.location.origin}/preview.html?id=${h}`;s(),at("文档预览",ct("iframe",{src:T,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(N){window.open(T,"_blank"),N.close()}}]})}function a(){const c={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:fn.DISABLED};at("选择示例",ct(cb),c).promisify().then(h=>u(h.id)).catch(Ae)}async function u(c){const h=await _l(c,!1);h!=null&&(ps(c),t.value=be.create(h.define),g())}function f(){const c=be.createNormalDocument();t.value=c,g()}function g(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function v(){const c=localStorage.getItem(Bl);if(c!=null)return be.create(c);const h=ms(),T=await _l(h.id,!1);return T==null?be.createNormalDocument():be.create(T.define)}function _(){const c=ue();return v().then(h=>{c.value=h,g()}),c}const b=xe(function(){return at("待办事项",ct(hb)).promisify().catch(je)});return(c,h)=>y(t)?(R(),J(y(Jv),{modelValue:y(t),"onUpdate:modelValue":h[1]||(h[1]=T=>Ke(t)?t.value=T:null),toolbar:o,class:m(y(e).main),key:y(t).id,onSave:r,onPreview:i},{headerLeft:ke(()=>[d("div",{class:m(y(e).logo)},[h[2]||(h[2]=d("h1",null,"OpenPrint",-1)),d("div",{class:m(y(e).dev),onClick:h[0]||(h[0]=(...T)=>y(b)&&y(b)(...T))},"DEV_"+Z(y(l)),3)],2)]),headerRight:ke(()=>[d("div",{class:m(y(e).operate)},[d("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[p(y(F),{icon:"icon-run"}),h[3]||(h[3]=d("span",null,"预览",-1))]),d("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[p(y(F),{icon:"icon-save"}),h[4]||(h[4]=d("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):G("",!0)}}),yb="_main_14ojw_2",_b="_iframe_14ojw_6",Eb="_divider_14ojw_14",Tb="_logo_14ojw_20",Sb="_dev_14ojw_39",Rb="_operate_14ojw_52",kb={main:yb,iframe:_b,divider:Eb,logo:Tb,dev:Sb,operate:Rb},wb={classes:kb},Cb=z(bb,[["__cssModules",wb]]),Mo=ys(Cb);Mo.use(nb);Mo.mount("#app");
