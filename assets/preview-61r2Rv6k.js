const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-ZgllWvX9.js","assets/utils-D4MIW8h4.js","assets/vue-CUY5VN2t.js","assets/utils-BWxIAY5I.css"])))=>i.map(i=>d[i]);
var Yr=Object.defineProperty;var $n=t=>{throw TypeError(t)};var Gr=(t,e,n)=>e in t?Yr(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var P=(t,e,n)=>Gr(t,typeof e!="symbol"?e+"":e,n),sn=(t,e,n)=>e.has(t)||$n("Cannot "+n);var F=(t,e,n)=>(sn(t,e,"read from private field"),n?n.call(t):e.get(t)),ue=(t,e,n)=>e.has(t)?$n("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),Ae=(t,e,n,r)=>(sn(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),on=(t,e,n)=>(sn(t,e,"access private method"),n);var Fn=(t,e,n,r)=>({set _(i){Ae(t,e,i,n)},get _(){return F(t,e,r)}});import{K as pr,aD as Dn,aE as kn,aY as je,q as En,a6 as de,aI as zr,b as te,aZ as Y,G as be,z as vt,A as Ze,j as He,P as jr,n as it,D as an,F as Wr,V as un,a_ as Qe,a as lt,N as cn,O as qt,o as Zr,E as Un,u as It,a7 as Xr,r as mr,t as Kr,v as Jr,w as Qr,x as ei,y as ti,a3 as ft,a5 as W,aw as ni,ay as gr,c as le,aj as ri,M as yn,a$ as Bn,h as ii,_ as Tt,I as Yt,aA as si,aO as oi,R as ai,b0 as wr,i as we,U as ui,W as ci,$ as li,J as fi,al as di,X as hi,b1 as Vn,b2 as Yn,aV as pi,aT as Gn,aQ as mi,aR as gi,aS as wi}from"./utils-D4MIW8h4.js";import{d as st,g as De,c as Me,o as Ee,a as ae,n as J,t as mt,u as Tn,f as xn,k as vi,h as q,b as K,H as Gt,e as Ht,G as Ei,s as zt,A as yi,i as vr,j as ln,r as zn,F as jn,T as Ni,w as bi,x as _i,D as Wn,E as Di,S as ki,N as Ti,R as xi}from"./vue-CUY5VN2t.js";const ye=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),$t=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),Ft=Object.freeze({CREATED:0,MOUNDTED:1}),fe={UNDEFINED:0,PENDING:1,DONE:2},Pe={PENDING:-1,HIDDEN:0,VISIBLE:1},dt=[25,50,75,100,125,150,200,300,400],ge=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDE_LINE:"quickprint-guide-line",GUIDE_HEADER:"quickprint-guide-header",GUIDE_FOOTER:"quickprint-guide-footer"}),Zn="http://www.w3.org/2000/svg",Ri=["class","className","style"],Et=Symbol("QUICKPRINT_EVENT_HANDLERS");function Er(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97)}function Si(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123}function Nn(t){return t==null?"":typeof t=="string"?t.trim():Array.isArray(t)?t.map(Nn).join(" "):typeof t=="object"?Object.keys(t).filter(e=>t[e]).join(" "):""}function Ai(t){return Ri.includes(t)}function jt(t){yr(t),t.parentElement&&t.parentElement.removeChild(t)}function yr(t){const e=t[Et];e&&(Object.keys(e).forEach(n=>bn(t,n)),delete t[Et]);for(const n of t.children)yr(n)}function Pi(t,e,n){if(n==null)return bn(t,e);const r=t[Et]||(t[Et]={});typeof r[e]=="function"&&bn(t,e),t.addEventListener(e,n),r[e]=n}function bn(t,e){const n=t[Et];if(n==null)return;const r=n[e];r&&t.removeEventListener(e,r),n[e]=void 0}function Nr(t,e){if(e!=null){if(e instanceof Element){t.appendChild(e);return}if(Array.isArray(e)){for(const n of e)Nr(t,n);return}t.textContent+=e}}function Mi(t,e){if(!(e==null||typeof e!="object"))for(const n of Object.keys(e)){const r=e[n];if(r==null)continue;const i=pr(n);t.style.setProperty(i,r)}}function Oi(t,e){if(Nn(e)=="")return;const r=t.className==""?"":" ";t.className+=r+Nn(e)}function Ci(t,e,n){const r=pr(e.slice(2));Pi(t,r,n)}function br(t,e,n){switch(e){case"class":case"className":Oi(t,n);break;case"style":Mi(t,n);break;case"children":n!=null&&Nr(t,n);break;case"innerHTML":t.innerHTML=n;break;default:if(Er(e))return Ci(t,e,n);if(e[0]==="@")return Li(t,e,n);e in t&&(t[e]=n),n==null?t.removeAttribute(e):t.setAttribute(e,n)}}function Li(t,e,n){Reflect.set(t,e.slice(1),n)}function qi(t,e,n){const r=t(e);if(r==null)return null;for(const i of Object.keys(e??{}))(Er(i)||Si(i)||Ai(i))&&br(r,i,e[i]);return r}function Ii(t,e,n){const r=document.createElement(t);if(r==null)return null;for(const i of Object.keys(e??{}))br(r,i,e[i]);return r}function z(t,e,n){return typeof t=="function"?qi(t,e):Ii(t,e)}function Xn(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var Xt,Fe;const Kt=class Kt{constructor(e,n){ue(this,Xt,Dn(kn.PRINT_PAGE));ue(this,Fe,Object.create(null));P(this,"file");P(this,"define");P(this,"pageNum",-1);P(this,"pageTotal",-1);P(this,"extra",!1);P(this,"header");P(this,"footer");P(this,"children",[]);P(this,"fixed",[]);P(this,"parent");P(this,"element");P(this,"rendering");P(this,"state",$t.CREATED);P(this,"offsetHeight",0);this.file=n,this.define=e,this.header=this.createHeader(),this.footer=this.createFooter(),je(this,"parent",null),je(this,"element",null),je(this,"rendering",0)}static create(e,n){return new Kt(e,n)}get id(){return"@"+F(this,Xt)}get style(){const e=this.define;return{"--quickprint-paper-header-top":this.header.offsetTop+"px","--quickprint-paper-footer-top":this.footer.offsetTop+"px","--quickprint-paper-width":e.width+"mm","--quickprint-paper-height":`calc(${e.height}mm - 0.5px)`}}get index(){return this.parent==null?-1:this.parent.pages.findIndex(e=>e.id===this.id)}get defines(){const e=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>e.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>e.add(i.id)),this.define.children.filter(i=>!e.has(i.id)).sort(En.sort)}get isLast(){return this.pageNum===this.pageTotal}nextTick(){return this.parent?this.parent.nextTick():Promise.resolve()}createPageHeader(){const e=this.header;if(e.display!==!0)return null;const n=[ge.GUIDE_LINE,ge.GUIDE_HEADER,ge.PRINT_HIDDEN];return[...e.children.map(r=>r.createElement()),z("div",{class:n})]}createPageFooter(){const e=this.footer;if(e.display!==!0)return null;const n=[ge.GUIDE_LINE,ge.GUIDE_FOOTER,ge.PRINT_HIDDEN];return[...e.children.map(r=>r.createElement()),z("div",{class:n})]}render(){return z("div",{id:this.id,class:ge.PAGE,style:this.style,"data-index":this.index+1,children:z("div",{class:ge.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(e){this.state=$t.PAGED,await this.onPaged()}async mountChild(e){if(this.element==null||e.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(e.element),await this.nextTick(),await e.mount(e.element),!0)}async replaceChild(e,n){if(this.element==null||e.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null||r.replaceChild(n,e.element),jt(e.element),await this.nextTick(),await e.mount(n),!0)}beginPaging(){this.state=$t.PAGING}onCreated(){const e=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(e.map(n=>n.onCreated()))}async onPaged(){var r;const e=this.children.map(i=>typeof i.onPaged=="function"?i.onPaged():Promise.resolve()),n=await Promise.allSettled(e);return this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,n}onFinshed(){const e=this.children.map(r=>typeof r.onFinished=="function"?r.onFinished():Promise.resolve()),n=this.adjustFooter();return n&&e.push(n),Promise.allSettled(e)}setParent(e){this.parent=e}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}append(e){e.setParent(this),this.children.push(e),F(this,Fe)[e.id]=e}appendToHeader(e){e.setParent(this),this.header.children.push(e),F(this,Fe)[e.id]=e}appendToFooter(e){e.setParent(this),this.footer.children.push(e),F(this,Fe)[e.id]=e}appendToFixed(e){e.setParent(this),this.fixed.push(e),F(this,Fe)[e.id]=e}createHeader(){const e=this.define.header;if(e.display!==!0)return Xn();const n=e.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const e=this.define.footer;if(e.display!==!0)return Xn();const n=e.height??0,i=de.mm_to_px(this.define.height)-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const e=new Kt(this.define,this.file);e.rendering=0;for(const n of this.header.children){const r=n.clone();e.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();e.appendToFooter(r)}return e}findElement(e){const n=F(this,Fe)[e];if(n)return n;for(const r of this.children){const i=r.findElement(e);if(i)return i}}filterElement(e){const n=typeof e=="string"?e:e.id;return this.children.reduce((r,i)=>(i.define.id===n&&r.push(i),r.concat(i.filterElementFromDefine(e))),[])}adjustFooter(){if(!this.isLast||this.define.footer.flow!==zr.TABLE)return;let e=0,n=null;for(const i of this.children)if(i.offsetBottom>e&&(e=i.offsetBottom),i.type===te.TABLE){if(n==null){n=i;continue}i.offsetBottom>n.offsetBottom&&(n=i)}if(n==null||Math.abs(e-n.offsetBottom)>=4)return;const r=Math.floor(this.footer.offsetTop-n.offsetBottom);return Promise.allSettled(this.footer.children.map(i=>(i.offsetTop-=r,i.updateElement())))}updateHeight(){if(this.element==null)return!1;const e=de.mm_to_px(this.define.height),n=Math.max(...this.children.map(o=>o.define.bottom)),r=e-this.footer.offsetHeight-n,s=Math.max(...this.children.map(o=>o.offsetBottom))+r+this.footer.offsetHeight;return s<=e?!1:(this.offsetHeight=s,this.element.style.setProperty("--quickprint-paper-height",`${s}px`),this.element.style.setProperty("--quickprint-paper-footer-top",`${s-this.footer.offsetHeight}px`),!0)}};Xt=new WeakMap,Fe=new WeakMap;let Wt=Kt;var ot=1e9,Hi={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},Sn,Z=!0,ve="[DecimalError] ",We=ve+"Invalid argument: ",Rn=ve+"Exponent out of range: ",at=Math.floor,Ve=Math.pow,$i=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,he,se=1e7,G=7,_r=9007199254740991,Zt=at(_r/G),E={};E.absoluteValue=E.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};E.comparedTo=E.cmp=function(t){var e,n,r,i,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(r=s.d.length,i=t.d.length,e=0,n=r<i?r:i;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};E.decimalPlaces=E.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*G;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};E.dividedBy=E.div=function(t){return Ce(this,new this.constructor(t))};E.dividedToIntegerBy=E.idiv=function(t){var e=this,n=e.constructor;return U(Ce(e,new n(t),0,1),n.precision)};E.equals=E.eq=function(t){return!this.cmp(t)};E.exponent=function(){return ee(this)};E.greaterThan=E.gt=function(t){return this.cmp(t)>0};E.greaterThanOrEqualTo=E.gte=function(t){return this.cmp(t)>=0};E.isInteger=E.isint=function(){return this.e>this.d.length-2};E.isNegative=E.isneg=function(){return this.s<0};E.isPositive=E.ispos=function(){return this.s>0};E.isZero=function(){return this.s===0};E.lessThan=E.lt=function(t){return this.cmp(t)<0};E.lessThanOrEqualTo=E.lte=function(t){return this.cmp(t)<1};E.logarithm=E.log=function(t){var e,n=this,r=n.constructor,i=r.precision,s=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(he))throw Error(ve+"NaN");if(n.s<1)throw Error(ve+(n.s?"NaN":"-Infinity"));return n.eq(he)?new r(0):(Z=!1,e=Ce(yt(n,s),yt(t,s),s),Z=!0,U(e,i))};E.minus=E.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Tr(e,t):Dr(e,(t.s=-t.s,t))};E.modulo=E.mod=function(t){var e,n=this,r=n.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(ve+"NaN");return n.s?(Z=!1,e=Ce(n,t,0,1).times(t),Z=!0,n.minus(e)):U(new r(n),i)};E.naturalExponential=E.exp=function(){return kr(this)};E.naturalLogarithm=E.ln=function(){return yt(this)};E.negated=E.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};E.plus=E.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?Dr(e,t):Tr(e,(t.s=-t.s,t))};E.precision=E.sd=function(t){var e,n,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(We+t);if(e=ee(i)+1,r=i.d.length-1,n=r*G+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};E.squareRoot=E.sqrt=function(){var t,e,n,r,i,s,o,u=this,a=u.constructor;if(u.s<1){if(!u.s)return new a(0);throw Error(ve+"NaN")}for(t=ee(u),Z=!1,i=Math.sqrt(+u),i==0||i==1/0?(e=ke(u.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=at((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new a(e)):r=new a(i.toString()),n=a.precision,i=o=n+3;;)if(s=r,r=s.plus(Ce(u,s,o+2)).times(.5),ke(s.d).slice(0,o)===(e=ke(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(U(s,n+1,0),s.times(s).eq(u)){r=s;break}}else if(e!="9999")break;o+=4}return Z=!0,U(r,n)};E.times=E.mul=function(t){var e,n,r,i,s,o,u,a,f,c=this,l=c.constructor,m=c.d,h=(t=new l(t)).d;if(!c.s||!t.s)return new l(0);for(t.s*=c.s,n=c.e+t.e,a=m.length,f=h.length,a<f&&(s=m,m=h,h=s,o=a,a=f,f=o),s=[],o=a+f,r=o;r--;)s.push(0);for(r=f;--r>=0;){for(e=0,i=a+r;i>r;)u=s[i]+h[r]*m[i-r-1]+e,s[i--]=u%se|0,e=u/se|0;s[i]=(s[i]+e)%se|0}for(;!s[--o];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,Z?U(t,l.precision):t};E.toDecimalPlaces=E.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(xe(t,0,ot),e===void 0?e=r.rounding:xe(e,0,8),U(n,t+ee(n)+1,e))};E.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=Xe(r,!0):(xe(t,0,ot),e===void 0?e=i.rounding:xe(e,0,8),r=U(new i(r),t+1,e),n=Xe(r,!0,t+1)),n};E.toFixed=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?Xe(i):(xe(t,0,ot),e===void 0?e=s.rounding:xe(e,0,8),r=U(new s(i),t+ee(i)+1,e),n=Xe(r.abs(),!1,t+ee(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};E.toInteger=E.toint=function(){var t=this,e=t.constructor;return U(new e(t),ee(t)+1,e.rounding)};E.toNumber=function(){return+this};E.toPower=E.pow=function(t){var e,n,r,i,s,o,u=this,a=u.constructor,f=12,c=+(t=new a(t));if(!t.s)return new a(he);if(u=new a(u),!u.s){if(t.s<1)throw Error(ve+"Infinity");return u}if(u.eq(he))return u;if(r=a.precision,t.eq(he))return U(u,r);if(e=t.e,n=t.d.length-1,o=e>=n,s=u.s,o){if((n=c<0?-c:c)<=_r){for(i=new a(he),e=Math.ceil(r/G+4),Z=!1;n%2&&(i=i.times(u),Jn(i.d,e)),n=at(n/2),n!==0;)u=u.times(u),Jn(u.d,e);return Z=!0,t.s<0?new a(he).div(i):U(i,r)}}else if(s<0)throw Error(ve+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,u.s=1,Z=!1,i=t.times(yt(u,r+f)),Z=!0,i=kr(i),i.s=s,i};E.toPrecision=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?(n=ee(i),r=Xe(i,n<=s.toExpNeg||n>=s.toExpPos)):(xe(t,1,ot),e===void 0?e=s.rounding:xe(e,0,8),i=U(new s(i),t,e),n=ee(i),r=Xe(i,t<=n||n<=s.toExpNeg,t)),r};E.toSignificantDigits=E.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(xe(t,1,ot),e===void 0?e=r.rounding:xe(e,0,8)),U(new r(n),t,e)};E.toString=E.valueOf=E.val=E.toJSON=E[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=ee(t),n=t.constructor;return Xe(t,e<=n.toExpNeg||e>=n.toExpPos)};function Dr(t,e){var n,r,i,s,o,u,a,f,c=t.constructor,l=c.precision;if(!t.s||!e.s)return e.s||(e=new c(t)),Z?U(e,l):e;if(a=t.d,f=e.d,o=t.e,i=e.e,a=a.slice(),s=o-i,s){for(s<0?(r=a,s=-s,u=f.length):(r=f,i=o,u=a.length),o=Math.ceil(l/G),u=o>u?o+1:u+1,s>u&&(s=u,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(u=a.length,s=f.length,u-s<0&&(s=u,r=f,f=a,a=r),n=0;s;)n=(a[--s]=a[s]+f[s]+n)/se|0,a[s]%=se;for(n&&(a.unshift(n),++i),u=a.length;a[--u]==0;)a.pop();return e.d=a,e.e=i,Z?U(e,l):e}function xe(t,e,n){if(t!==~~t||t<e||t>n)throw Error(We+t)}function ke(t){var e,n,r,i=t.length-1,s="",o=t[0];if(i>0){for(s+=o,e=1;e<i;e++)r=t[e]+"",n=G-r.length,n&&(s+=$e(n)),s+=r;o=t[e],r=o+"",n=G-r.length,n&&(s+=$e(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Ce=function(){function t(r,i){var s,o=0,u=r.length;for(r=r.slice();u--;)s=r[u]*i+o,r[u]=s%se|0,o=s/se|0;return o&&r.unshift(o),r}function e(r,i,s,o){var u,a;if(s!=o)a=s>o?1:-1;else for(u=a=0;u<s;u++)if(r[u]!=i[u]){a=r[u]>i[u]?1:-1;break}return a}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*se+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var u,a,f,c,l,m,h,b,p,d,y,k,S,x,T,M,I,L,j=r.constructor,$=r.s==i.s?1:-1,D=r.d,O=i.d;if(!r.s)return new j(r);if(!i.s)throw Error(ve+"Division by zero");for(a=r.e-i.e,I=O.length,T=D.length,h=new j($),b=h.d=[],f=0;O[f]==(D[f]||0);)++f;if(O[f]>(D[f]||0)&&--a,s==null?k=s=j.precision:o?k=s+(ee(r)-ee(i))+1:k=s,k<0)return new j(0);if(k=k/G+2|0,f=0,I==1)for(c=0,O=O[0],k++;(f<T||c)&&k--;f++)S=c*se+(D[f]||0),b[f]=S/O|0,c=S%O|0;else{for(c=se/(O[0]+1)|0,c>1&&(O=t(O,c),D=t(D,c),I=O.length,T=D.length),x=I,p=D.slice(0,I),d=p.length;d<I;)p[d++]=0;L=O.slice(),L.unshift(0),M=O[0],O[1]>=se/2&&++M;do c=0,u=e(O,p,I,d),u<0?(y=p[0],I!=d&&(y=y*se+(p[1]||0)),c=y/M|0,c>1?(c>=se&&(c=se-1),l=t(O,c),m=l.length,d=p.length,u=e(l,p,m,d),u==1&&(c--,n(l,I<m?L:O,m))):(c==0&&(u=c=1),l=O.slice()),m=l.length,m<d&&l.unshift(0),n(p,l,d),u==-1&&(d=p.length,u=e(O,p,I,d),u<1&&(c++,n(p,I<d?L:O,d))),d=p.length):u===0&&(c++,p=[0]),b[f++]=c,u&&p[0]?p[d++]=D[x]||0:(p=[D[x]],d=1);while((x++<T||p[0]!==void 0)&&k--)}return b[0]||b.shift(),h.e=a,U(h,o?s+ee(h)+1:s)}}();function kr(t,e){var n,r,i,s,o,u,a=0,f=0,c=t.constructor,l=c.precision;if(ee(t)>16)throw Error(Rn+ee(t));if(!t.s)return new c(he);for(Z=!1,u=l,o=new c(.03125);t.abs().gte(.1);)t=t.times(o),f+=5;for(r=Math.log(Ve(2,f))/Math.LN10*2+5|0,u+=r,n=i=s=new c(he),c.precision=u;;){if(i=U(i.times(t),u),n=n.times(++a),o=s.plus(Ce(i,n,u)),ke(o.d).slice(0,u)===ke(s.d).slice(0,u)){for(;f--;)s=U(s.times(s),u);return c.precision=l,e==null?(Z=!0,U(s,l)):s}s=o}}function ee(t){for(var e=t.e*G,n=t.d[0];n>=10;n/=10)e++;return e}function fn(t,e,n){if(e>t.LN10.sd())throw Z=!0,n&&(t.precision=n),Error(ve+"LN10 precision limit exceeded");return U(new t(t.LN10),e)}function $e(t){for(var e="";t--;)e+="0";return e}function yt(t,e){var n,r,i,s,o,u,a,f,c,l=1,m=10,h=t,b=h.d,p=h.constructor,d=p.precision;if(h.s<1)throw Error(ve+(h.s?"NaN":"-Infinity"));if(h.eq(he))return new p(0);if(e==null?(Z=!1,f=d):f=e,h.eq(10))return e==null&&(Z=!0),fn(p,f);if(f+=m,p.precision=f,n=ke(b),r=n.charAt(0),s=ee(h),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)h=h.times(t),n=ke(h.d),r=n.charAt(0),l++;s=ee(h),r>1?(h=new p("0."+n),s++):h=new p(r+"."+n.slice(1))}else return a=fn(p,f+2,d).times(s+""),h=yt(new p(r+"."+n.slice(1)),f-m).plus(a),p.precision=d,e==null?(Z=!0,U(h,d)):h;for(u=o=h=Ce(h.minus(he),h.plus(he),f),c=U(h.times(h),f),i=3;;){if(o=U(o.times(c),f),a=u.plus(Ce(o,new p(i),f)),ke(a.d).slice(0,f)===ke(u.d).slice(0,f))return u=u.times(2),s!==0&&(u=u.plus(fn(p,f+2,d).times(s+""))),u=Ce(u,new p(l),f),p.precision=d,e==null?(Z=!0,U(u,d)):u;u=a,i+=2}}function Kn(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(r,i),e){if(i-=r,n=n-r-1,t.e=at(n/G),t.d=[],r=(n+1)%G,n<0&&(r+=G),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=G;r<i;)t.d.push(+e.slice(r,r+=G));e=e.slice(r),r=G-e.length}else r-=i;for(;r--;)e+="0";if(t.d.push(+e),Z&&(t.e>Zt||t.e<-Zt))throw Error(Rn+n)}else t.s=0,t.e=0,t.d=[0];return t}function U(t,e,n){var r,i,s,o,u,a,f,c,l=t.d;for(o=1,s=l[0];s>=10;s/=10)o++;if(r=e-o,r<0)r+=G,i=e,f=l[c=0];else{if(c=Math.ceil((r+1)/G),s=l.length,c>=s)return t;for(f=s=l[c],o=1;s>=10;s/=10)o++;r%=G,i=r-G+o}if(n!==void 0&&(s=Ve(10,o-i-1),u=f/s%10|0,a=e<0||l[c+1]!==void 0||f%s,a=n<4?(u||a)&&(n==0||n==(t.s<0?3:2)):u>5||u==5&&(n==4||a||n==6&&(r>0?i>0?f/Ve(10,o-i):0:l[c-1])%10&1||n==(t.s<0?8:7))),e<1||!l[0])return a?(s=ee(t),l.length=1,e=e-s-1,l[0]=Ve(10,(G-e%G)%G),t.e=at(-e/G)||0):(l.length=1,l[0]=t.e=t.s=0),t;if(r==0?(l.length=c,s=1,c--):(l.length=c+1,s=Ve(10,G-r),l[c]=i>0?(f/Ve(10,o-i)%Ve(10,i)|0)*s:0),a)for(;;)if(c==0){(l[0]+=s)==se&&(l[0]=1,++t.e);break}else{if(l[c]+=s,l[c]!=se)break;l[c--]=0,s=1}for(r=l.length;l[--r]===0;)l.pop();if(Z&&(t.e>Zt||t.e<-Zt))throw Error(Rn+ee(t));return t}function Tr(t,e){var n,r,i,s,o,u,a,f,c,l,m=t.constructor,h=m.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new m(t),Z?U(e,h):e;if(a=t.d,l=e.d,r=e.e,f=t.e,a=a.slice(),o=f-r,o){for(c=o<0,c?(n=a,o=-o,u=l.length):(n=l,r=f,u=a.length),i=Math.max(Math.ceil(h/G),u)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=a.length,u=l.length,c=i<u,c&&(u=i),i=0;i<u;i++)if(a[i]!=l[i]){c=a[i]<l[i];break}o=0}for(c&&(n=a,a=l,l=n,e.s=-e.s),u=a.length,i=l.length-u;i>0;--i)a[u++]=0;for(i=l.length;i>o;){if(a[--i]<l[i]){for(s=i;s&&a[--s]===0;)a[s]=se-1;--a[s],a[i]+=se}a[i]-=l[i]}for(;a[--u]===0;)a.pop();for(;a[0]===0;a.shift())--r;return a[0]?(e.d=a,e.e=r,Z?U(e,h):e):new m(0)}function Xe(t,e,n){var r,i=ee(t),s=ke(t.d),o=s.length;return e?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+$e(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+$e(-i-1)+s,n&&(r=n-o)>0&&(s+=$e(r))):i>=o?(s+=$e(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+$e(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=$e(r))),t.s<0?"-"+s:s}function Jn(t,e){if(t.length>e)return t.length=e,!0}function xr(t){var e,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(We+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Kn(o,s.toString())}else if(typeof s!="string")throw Error(We+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,$i.test(s))Kn(o,s);else throw Error(We+s)}if(i.prototype=E,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=xr,i.config=i.set=Fi,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function Fi(t){if(!t||typeof t!="object")throw Error(ve+"Object expected");var e,n,r,i=["precision",1,ot,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((r=t[n=i[e]])!==void 0)if(at(r)===r&&r>=i[e+1]&&r<=i[e+2])this[n]=r;else throw Error(We+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(We+n+": "+r);return this}var Sn=xr(Hi);he=new Sn(1);const Te=Sn,Q={of(t){return new Te(t)},sum(...t){let e=new Te(0);for(const n of t)e=e.plus(n);return e},toFormat(t,e,n,r){const i=t.toFixed(e,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[u,a]=i.split("."),f=[];for(let c=u.length;c>0;c-=s)f.unshift(u.slice(Math.max(0,c-s),c));return f.join(o)+(a?`.${a}`:"")},round(t,e,n){return Q.of(t).toDecimalPlaces(e,n).toNumber()}};function Ui(t){switch(t){case Y.Equal:return"==";case Y.NotEqual:return"!=";case Y.Lte:return"<=";case Y.Gte:return">=";case Y.LogicalAnd:return"&&";case Y.LogicalOr:return"||";case Y.Power:return"**";case Y.Nullish:return"??";case Y.Group:return"()";default:return String.fromCharCode(t)}}function me(t){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(t)}function ht(t){return t==null}const ut=new Map;function Bi(t,e){const n=ut.get(t);if(n==null)throw new Error(`不支持的函数：${t}`);return n(...e)}const Rr="Resolve Element Value Pending Error",Sr="ElementValueError";function H(t){const e=Object.create(null);return e.state=fe.DONE,e.raw=t,e}function et(){const t=Object.create(null);return t.state=fe.PENDING,t}function xt(){const t=new Error(Rr);return t.name=Sr,t}function Vi(t){return t instanceof Error&&t.name===Sr&&t.message===Rr}function Ar(){return new Error("Unexpected end of input")}function ie(t){return new Error(`Unexpected end of input at position ${t.start}, near \`${Ui(t.value)}\``)}function Qn(t){return typeof t=="object"&&t.type==="reference"?Wi(t):t}function Yi(t,e,n){switch(t.value){case Y.Plus:{if(t.left==null||t.right==null)throw ie(t);return typeof e=="string"||typeof n=="string"?e+n:me(e)&&me(n)?Q.of(e).plus(n).toNumber():Number.NaN}case Y.Minus:{if(t.left==null&&t.right==null)throw ie(t);return t.left==null&&t.right?-n:me(e)&&me(n)?Q.of(e).minus(n).toNumber():Number.NaN}case Y.Asterisk:{if(t.left==null||t.right==null)throw ie(t);return me(e)&&me(n)?Q.of(e).times(n).toNumber():Number.NaN}case Y.Slash:{if(t.left==null||t.right==null)throw ie(t);return me(e)&&me(n)?Q.of(e).div(n).toNumber():Number.NaN}case Y.Percent:{if(t.left==null||t.right==null)throw ie(t);return me(e)&&me(n)?Q.of(e).mod(n).toNumber():Number.NaN}case Y.Power:{if(t.left==null||t.right==null)throw ie(t);return me(e)&&me(n)?Q.of(e).pow(n).toNumber():Number.NaN}case Y.Equal:{if(t.left==null||t.right==null)throw ie(t);return ht(e)&&ht(n)?!0:e===n}case Y.NotEqual:{if(t.left==null||t.right==null)throw ie(t);return ht(e)&&ht(n)?!1:e!==n}case Y.Lt:{if(t.left==null||t.right==null)throw ie(t);return e<n}case Y.Lte:{if(t.left==null||t.right==null)throw ie(t);return e<=n}case Y.Gt:{if(t.left==null||t.right==null)throw ie(t);return e>n}case Y.Gte:{if(t.left==null||t.right==null)throw ie(t);return e>=n}case Y.LogicalAnd:{if(t.left==null||t.right==null)throw ie(t);return e&&n}case Y.LogicalOr:{if(t.left==null||t.right==null)throw ie(t);return e||n}case Y.LogicalNot:{if(t.right==null)throw ie(t);return!n}case Y.Nullish:{if(t.left==null||t.right==null)throw ie(t);return ht(e)?n:e}default:throw ie(t)}}function Gi(t,e){const r=(t.children??[]).map(i=>{if(i!=null)return Oe(i,e)});return Bi(t.value,r)}function zi(t,e){var n;return e==null||typeof e!="object"?null:(n=e.data)==null?void 0:n[t.value]}function ji(t,e){var n;return e==null||typeof e!="object"?null:(n=e.scope)==null?void 0:n[t.value]}function Wi(t){const e=t.element.doc;if(e==null)return null;const n=e.filterElement(t.value);if(n.length==0)return null;const i=n[0].value;if(i.state!==fe.DONE)throw xt();return i.raw}function Zi(t,e){if(t.left==null||t.right==null||t.condition==null)throw Ar();return Oe(t.condition,e)?(t.result=Oe(t.left,e),t.result):(t.result=Oe(t.right,e),t.result)}function Oe(t,e){switch(t.type){case be.NULL:return null;case be.UNDEFINED:return;case be.NUMBER:return Number(t.value);case be.STRING:return String(t.value);case be.TEMPLATE:{const r=(Array.isArray(t.value)?t.value:[t.value]).map(i=>Oe(i,e));return t.result=r.join(""),t.result}case be.BOOLEAN:return!!t.value;case be.VARIABLE:return t.result=zi(t,e),t.result;case be.REFERENCE:return t.result=ji(t,e),t.result;case be.FUNCTION:return t.result=Gi(t,e),t.result;case be.OPERATOR:{if(t.isQuestion)return Zi(t,e);if(t.isGroup){if(t.right==null)throw ie(t);return t.result=Oe(t.right,e),t.result}const n=t.left?Oe(t.left,e):null,r=t.right?Oe(t.right,e):null;return t.result=Yi(t,Qn(n),Qn(r)),t.result}default:throw Ar()}}function Xi(t,e){return Oe(t,e??{})}function Ki(t,e){var r;const n=typeof e=="string"?vt(e)?Ze(e):null:e;if(n==null)return H();switch(n.value){case He.CURRENT_DATE:return H(Date.now());case He.PAGE_NUMBER:{const i=t.doc;return i==null?H():i.isPaged?H(t.pageNum):et()}case He.PAGE_TOTAL:{const i=t.doc;return i==null?H():i.isPaged?H((r=t.page)==null?void 0:r.pageTotal):et()}case He.ROW_INDEX:{const i=t.doc;if(i==null)return H();if(i.isPaged){if(t.type!==te.TABLE_CELL)return H();const s=t.parent;return s==null?H():H(s.rowIndex)}return et()}case He.DATA_INDEX:{const i=t.parent;return i==null?H():H(Reflect.get(i.rowData,Symbol.for(He.DATA_INDEX)))}default:return H()}}function Ji(t,e){const n=typeof e=="string"?vt(e)?Ze(e):null:e;if(n==null)return H();switch(n.value){case jr.ELEMENT_VALUR:return t.isProcessValueDone?H(t.getRawValue()):et();default:return H()}}function Qi(t,e,n){const r=typeof e=="string"?Ze(e):e,i=t.parent;if(i==null||!i.isBindVariable)return H(Qe(n,r.value));const s=Ze(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?H():H(Qe(i.rowData,r.value)):H(Qe(n,r.value))}async function es(t,e){const n=t.define;if(n.ds==null)return H();const r=n.ds,i=r.value;return it(i)?H():r.type===an.VARIABLE?An(t,i,e):r.type===an.FORMULA?Pr(t,i,e):r.type===an.CODE?ts(t,i):H(r.value)}function An(t,e,n,r=!1){const i=Ze(e);switch(i.varType){case un.DS:return t.type===te.TABLE_CELL?Qi(t,i,n):t.type===te.TABLE_ROW?H(t.rowData):H(Qe(n,r?i.path:i.value));case un.BUILTIN:return Ki(t,i);case un.SPECIAL:return Ji(t,i);default:return H()}}function Pr(t,e,n){try{const r=Wr.compile(e),i={data:{},scope:{}};for(const o of r.variable){const u=An(t,o.value,n);if(u.state===fe.PENDING)return et();Reflect.set(i.data,o.value,u.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{type:"reference",value:o.value,element:t});const s=Xi(r.root,i);return H(s)}catch(r){return Vi(r)?et():(console.log(r),H())}}async function ts(t,e){try{const r=new Function("element",`return (${e})(element)`)(t);if(r instanceof Promise){const i=await r;return H(i)}return H(r)}catch(n){return console.log(n),H()}}function er(){const t=document.createElement("span"),e="important";return t.style.visibility="hidden",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.zIndex="-1",t.style.setProperty("line-height","1",e),t.style.setProperty("font-family","宋体",e),t.style.setProperty("padding","0",e),t.textContent="水",t}function ns(){const t=er();t.style.fontSize="6px",document.body.appendChild(t);const e=er();e.style.fontSize="12px",document.body.appendChild(e);const n=t.clientHeight<e.clientHeight;return document.body.removeChild(t),document.body.removeChild(e),n}let Mr=function(){const t=ns();return Mr=function(){return t},t};function Ut(t){switch(t){case"Microsoft Edge":return"edge";case"Google Chrome":return"chrome";case"Mozilla Firefox":return"firefox";default:return t}}function Pt(){return{brand:"unknow",name:"unknow",chromeLike:!1,version:0}}function rs(){if(navigator.userAgentData)return is();if(/Edg\//.test(navigator.userAgent)){const t=navigator.userAgent.match(/Edg\/([\d.]+)/);if(t==null)return Pt();const e="Microsoft Edge";return{brand:e,name:Ut(e),chromeLike:!0,version:Number.parseInt(t[1].split(".")[0])}}if(/Chrome\//.test(navigator.userAgent)){const t=navigator.userAgent.match(/Chrome\/([\d.]+)/);if(t==null)return Pt();const e="Google Chrome";return{brand:e,name:Ut(e),chromeLike:!0,version:Number.parseInt(t[1].split(".")[0])}}if(/Firefox\//.test(navigator.userAgent)){const t=navigator.userAgent.match(/Firefox\/([\d.]+)/);if(t==null)return Pt();const e="Mozilla Firefox";return{brand:e,name:Ut(e),chromeLike:!1,version:Number.parseInt(t[1].split(".")[0])}}return Pt()}function is(){const t=navigator.userAgentData.brands,e={brand:t[0].brand,name:Ut(t[0].brand),version:Number.parseInt(t[0].version),chromeLike:/Chrome/.test(navigator.userAgent)};return navigator.userAgentData.getHighEntropyValues(["uaFullVersion"]).then(n=>e.fullVersion=n.uaFullVersion).catch(n=>console.log(n)),e}const Mt=rs();function Pn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var _e={},tr;function Or(){if(tr)return _e;tr=1;var t=/^([+-])?0*(\d+)(\.(\d+))?$/,e=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=_e.e2ten=function(i){var s=e.exec(i.toString());if(!s)return i;var o=s[2],u=s[4]||"",a=s[5]?+s[5]:0;if(a>0){var f=u.substr(0,a);f=f.length<a?f+new Array(a-f.length+1).join("0"):f,u=u.substr(a),o+=f}else{a=-a;var c=o.length-a;c=c<0?0:c;var l=o.substr(c,a);l=l.length<a?new Array(a-l.length+1).join("0")+l:l,o=o.substring(0,c),u=l+u}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(u?"."+u:"")};_e.getNumbResult=function(i){var s=t.exec(i.toString());if(!s&&e.test(i.toString())&&(s=t.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},_e.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var u=[].slice.call(arguments,2);u.unshift(s),i.apply(null,u)}return s};var r=_e.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return _e.extend=function(i){for(var s,o=arguments[0]||{},u=Array.prototype.slice.call(arguments,1),a=0;a<u.length;a++){var f=u[a];for(s in f)r(f,s)&&(o[s]=f[s])}return o},_e.getDigit=function(i){return i>=5?(i-4)*4+4:i},_e.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},_e.clearZero=function(i,s,o){if(i==null)return"";var u=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,a=new RegExp("^"+u+"+"),f=new RegExp(u+"+$"),c=new RegExp(u+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(a,"")),(!o||o=="$")&&(i=i.replace(f,"")),(!o||o=="nto1")&&(i=i.replace(c,s)),i},_e}var dn,nr;function ss(){if(nr)return dn;nr=1;var t=Or();function e(i,s){var o=t.getNumbResult(i);if(!o)return i;s=s||{};var u=this.ch,a=this.ch_u,f=this.ch_f||"",c=this.ch_d||".",l=u.charAt(0),m=o.int,h=o.decimal,b=o.minus,p="",d="",y=b?f:"",k=function I(L,j,$){L=t.getNumbResult(L).int;var D="",O=arguments.length>1?arguments[1]:s.tenMin,ne=L.length;if(ne==1)return u.charAt(+L);if(ne<=4)for(var _=0,v=ne;v--;){var g=+L.charAt(_);D+=O&&ne==2&&_==0&&g==1?"":u.charAt(g),D+=g&&v?a.charAt(v):"",_++}else{for(var N=L.length/4>>0,w=L.length%4;w==0||!a.charAt(3+N);)w+=4,N--;var R=L.substr(0,w),A=L.substr(w);D=I(R,O)+a.charAt(3+N)+(A.charAt(0)=="0"?l:"")+I(A,A.length>4?O:!1)}return D=t.clearZero(D,l),D};if(h){h=t.clearZero(h,"0","$");for(var S=0;S<h.length;S++)d+=u.charAt(+h.charAt(S));d=d?c+d:""}if(p=k(m),s.ww&&a.length>5){var x=a.charAt(4),T=a.charAt(5),M=p.lastIndexOf(T);~M&&(p=p.substring(0,M).replace(new RegExp(T,"g"),x+x)+p.substring(M))}return y+p+d}function n(i,s){i=i.toString();var o=i.split(this.ch_d),u=o[0].replace(this.ch_f,""),a=o[1],f=!!~o[0].indexOf(this.ch_f),c=this.ch_u.charAt(1),l=this.ch_u.charAt(4),m=this.ch_u.charAt(5);u=u.replace(new RegExp(l+"{2}(?!"+l+")","g"),m);for(var h=u.split(""),b=0,p=0,d=[],y=[],k=[],S=0;S<h.length;S++){var x=h[S],T=0,M=0;if(~(T=this.ch.indexOf(x)))T>0&&k.unshift(T);else if(~(M=this.ch_u.indexOf(x))){var I=t.getDigit(M);b>M?(t.unshiftZero(k,I),t.centerArray(y,k)):M>=p?(S==0&&(k=[1]),t.centerArray(d,y,k),d.length>0&&t.unshiftZero(d,I),p=M):(k.length==0&&c==x&&(k=[1]),t.centerArray(y,k),t.unshiftZero(y,t.getDigit(M)),b=M)}}t.centerArray(d,y,k).reverse(),d.length==0&&d.push(0);var L=0;if(a){d.push("."),L="0.";for(var S=0;S<a.length;S++)L+=this.ch.indexOf(a.charAt(S)),d.push(this.ch.indexOf(a.charAt(S)));L=+L}return f&&d.unshift("-"),s&&s.outputString?d.join(""):parseFloat(d.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},u=t.getNumbResult(i),a=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!u)return i;s=t.extend(o,s);var f=u.int,c=u.decimal||"",l=s.outSymbol?this.m_t:"",m=u.minus?this.ch_f:"",h="";if(s.complete){for(var b=1;b<this.m_u.length;b++)h+=e.call(this,c.charAt(b-1)||"0")+this.m_u.charAt(b);m+=e.call(this,f,s)+this.m_u.charAt(0)}else{var p=s.unOmitYuan||f!=="0";if(c=c.substr(0,this.m_u.length-1),c=t.clearZero(c,"0","$"),c)for(var d,b=0;b<this.m_u.length-1;b++)c.charAt(b)&&c.charAt(b)!="0"&&(h+=e.call(this,c.charAt(b))+this.m_u.charAt(b+1),d=!1),c.charAt(b)==="0"&&!d&&((b!=0||f!=="0")&&(h+=a),d=!0);(p||!h)&&(m+=e.call(this,f,s)+this.m_u.charAt(0)),s.forceZheng?(h==""||h.charAt(h.length-1)!==this.m_u[2])&&(h+=this.m_z):m+=u.decimal?"":this.m_z,s.forceZheng}return l+m+h}return dn={CL:e,unCL:n,toMoney:r},dn}var hn,rr;function os(){if(rr)return hn;rr=1;var t=ss(),e=Or();function n(r,i){return{encodeS:function(s,o){return o=e.extend({ww:!0,tenMin:!0},o),t.CL.call(r,s,o)},encodeB:function(s,o){return o=e.extend({ww:!0},o),t.CL.call(i,s,o)},decodeS:function(){return t.unCL.apply(r,arguments)},decodeB:function(){return t.unCL.apply(i,arguments)},toMoney:function(s,o){return o=e.extend({ww:!0},o),t.toMoney.call(i,s,o)}}}return hn=n,hn}var pn,ir;function as(){return ir||(ir=1,pn={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),pn}var mn,sr;function us(){return sr||(sr=1,mn={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),mn}var gn,or;function cs(){if(or)return gn;or=1;var t=os(),e={s:as(),b:us()};return gn=t(e.s,e.b),gn}var ls=cs();const fs=Pn(ls);var Bt={exports:{}},ds=Bt.exports,ar;function hs(){return ar||(ar=1,function(t,e){(function(n,r){t.exports=r()})(ds,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",u="minute",a="hour",f="day",c="week",l="month",m="quarter",h="year",b="date",p="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,k={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(_){var v=["th","st","nd","rd"],g=_%100;return"["+_+(v[(g-20)%10]||v[g]||v[0])+"]"}},S=function(_,v,g){var N=String(_);return!N||N.length>=v?_:""+Array(v+1-N.length).join(g)+_},x={s:S,z:function(_){var v=-_.utcOffset(),g=Math.abs(v),N=Math.floor(g/60),w=g%60;return(v<=0?"+":"-")+S(N,2,"0")+":"+S(w,2,"0")},m:function _(v,g){if(v.date()<g.date())return-_(g,v);var N=12*(g.year()-v.year())+(g.month()-v.month()),w=v.clone().add(N,l),R=g-w<0,A=v.clone().add(N+(R?-1:1),l);return+(-(N+(g-w)/(R?w-A:A-w))||0)},a:function(_){return _<0?Math.ceil(_)||0:Math.floor(_)},p:function(_){return{M:l,y:h,w:c,d:f,D:b,h:a,m:u,s:o,ms:s,Q:m}[_]||String(_||"").toLowerCase().replace(/s$/,"")},u:function(_){return _===void 0}},T="en",M={};M[T]=k;var I="$isDayjsObject",L=function(_){return _ instanceof O||!(!_||!_[I])},j=function _(v,g,N){var w;if(!v)return T;if(typeof v=="string"){var R=v.toLowerCase();M[R]&&(w=R),g&&(M[R]=g,w=R);var A=v.split("-");if(!w&&A.length>1)return _(A[0])}else{var C=v.name;M[C]=v,w=C}return!N&&w&&(T=w),w||!N&&T},$=function(_,v){if(L(_))return _.clone();var g=typeof v=="object"?v:{};return g.date=_,g.args=arguments,new O(g)},D=x;D.l=j,D.i=L,D.w=function(_,v){return $(_,{locale:v.$L,utc:v.$u,x:v.$x,$offset:v.$offset})};var O=function(){function _(g){this.$L=j(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[I]=!0}var v=_.prototype;return v.parse=function(g){this.$d=function(N){var w=N.date,R=N.utc;if(w===null)return new Date(NaN);if(D.u(w))return new Date;if(w instanceof Date)return new Date(w);if(typeof w=="string"&&!/Z$/i.test(w)){var A=w.match(d);if(A){var C=A[2]-1||0,V=(A[7]||"0").substring(0,3);return R?new Date(Date.UTC(A[1],C,A[3]||1,A[4]||0,A[5]||0,A[6]||0,V)):new Date(A[1],C,A[3]||1,A[4]||0,A[5]||0,A[6]||0,V)}}return new Date(w)}(g),this.init()},v.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},v.$utils=function(){return D},v.isValid=function(){return this.$d.toString()!==p},v.isSame=function(g,N){var w=$(g);return this.startOf(N)<=w&&w<=this.endOf(N)},v.isAfter=function(g,N){return $(g)<this.startOf(N)},v.isBefore=function(g,N){return this.endOf(N)<$(g)},v.$g=function(g,N,w){return D.u(g)?this[N]:this.set(w,g)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(g,N){var w=this,R=!!D.u(N)||N,A=D.p(g),C=function(Ne,oe){var pe=D.w(w.$u?Date.UTC(w.$y,oe,Ne):new Date(w.$y,oe,Ne),w);return R?pe:pe.endOf(f)},V=function(Ne,oe){return D.w(w.toDate()[Ne].apply(w.toDate("s"),(R?[0,0,0,0]:[23,59,59,999]).slice(oe)),w)},X=this.$W,re=this.$M,ce=this.$D,qe="set"+(this.$u?"UTC":"");switch(A){case h:return R?C(1,0):C(31,11);case l:return R?C(1,re):C(0,re+1);case c:var Re=this.$locale().weekStart||0,Be=(X<Re?X+7:X)-Re;return C(R?ce-Be:ce+(6-Be),re);case f:case b:return V(qe+"Hours",0);case a:return V(qe+"Minutes",1);case u:return V(qe+"Seconds",2);case o:return V(qe+"Milliseconds",3);default:return this.clone()}},v.endOf=function(g){return this.startOf(g,!1)},v.$set=function(g,N){var w,R=D.p(g),A="set"+(this.$u?"UTC":""),C=(w={},w[f]=A+"Date",w[b]=A+"Date",w[l]=A+"Month",w[h]=A+"FullYear",w[a]=A+"Hours",w[u]=A+"Minutes",w[o]=A+"Seconds",w[s]=A+"Milliseconds",w)[R],V=R===f?this.$D+(N-this.$W):N;if(R===l||R===h){var X=this.clone().set(b,1);X.$d[C](V),X.init(),this.$d=X.set(b,Math.min(this.$D,X.daysInMonth())).$d}else C&&this.$d[C](V);return this.init(),this},v.set=function(g,N){return this.clone().$set(g,N)},v.get=function(g){return this[D.p(g)]()},v.add=function(g,N){var w,R=this;g=Number(g);var A=D.p(N),C=function(re){var ce=$(R);return D.w(ce.date(ce.date()+Math.round(re*g)),R)};if(A===l)return this.set(l,this.$M+g);if(A===h)return this.set(h,this.$y+g);if(A===f)return C(1);if(A===c)return C(7);var V=(w={},w[u]=r,w[a]=i,w[o]=n,w)[A]||1,X=this.$d.getTime()+g*V;return D.w(X,this)},v.subtract=function(g,N){return this.add(-1*g,N)},v.format=function(g){var N=this,w=this.$locale();if(!this.isValid())return w.invalidDate||p;var R=g||"YYYY-MM-DDTHH:mm:ssZ",A=D.z(this),C=this.$H,V=this.$m,X=this.$M,re=w.weekdays,ce=w.months,qe=w.meridiem,Re=function(oe,pe,Se,Ie){return oe&&(oe[pe]||oe(N,R))||Se[pe].slice(0,Ie)},Be=function(oe){return D.s(C%12||12,oe,"0")},Ne=qe||function(oe,pe,Se){var Ie=oe<12?"AM":"PM";return Se?Ie.toLowerCase():Ie};return R.replace(y,function(oe,pe){return pe||function(Se){switch(Se){case"YY":return String(N.$y).slice(-2);case"YYYY":return D.s(N.$y,4,"0");case"M":return X+1;case"MM":return D.s(X+1,2,"0");case"MMM":return Re(w.monthsShort,X,ce,3);case"MMMM":return Re(ce,X);case"D":return N.$D;case"DD":return D.s(N.$D,2,"0");case"d":return String(N.$W);case"dd":return Re(w.weekdaysMin,N.$W,re,2);case"ddd":return Re(w.weekdaysShort,N.$W,re,3);case"dddd":return re[N.$W];case"H":return String(C);case"HH":return D.s(C,2,"0");case"h":return Be(1);case"hh":return Be(2);case"a":return Ne(C,V,!0);case"A":return Ne(C,V,!1);case"m":return String(V);case"mm":return D.s(V,2,"0");case"s":return String(N.$s);case"ss":return D.s(N.$s,2,"0");case"SSS":return D.s(N.$ms,3,"0");case"Z":return A}return null}(oe)||A.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(g,N,w){var R,A=this,C=D.p(N),V=$(g),X=(V.utcOffset()-this.utcOffset())*r,re=this-V,ce=function(){return D.m(A,V)};switch(C){case h:R=ce()/12;break;case l:R=ce();break;case m:R=ce()/3;break;case c:R=(re-X)/6048e5;break;case f:R=(re-X)/864e5;break;case a:R=re/i;break;case u:R=re/r;break;case o:R=re/n;break;default:R=re}return w?R:D.a(R)},v.daysInMonth=function(){return this.endOf(l).$D},v.$locale=function(){return M[this.$L]},v.locale=function(g,N){if(!g)return this.$L;var w=this.clone(),R=j(g,N,!0);return R&&(w.$L=R),w},v.clone=function(){return D.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},_}(),ne=O.prototype;return $.prototype=ne,[["$ms",s],["$s",o],["$m",u],["$H",a],["$W",f],["$M",l],["$y",h],["$D",b]].forEach(function(_){ne[_[1]]=function(v){return this.$g(v,_[0],_[1])}}),$.extend=function(_,v){return _.$i||(_(v,O,$),_.$i=!0),$},$.locale=j,$.isDayjs=L,$.unix=function(_){return $(1e3*_)},$.en=M[T],$.Ls=M,$.p={},$})}(Bt)),Bt.exports}var ps=hs();const Le=Pn(ps);var Vt={exports:{}},ms=Vt.exports,ur;function gs(){return ur||(ur=1,function(t,e){(function(n,r){t.exports=r()})(ms,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,u=/\d*[^-_:/,()\s\d]+/,a={},f=function(d){return(d=+d)+(d>68?1900:2e3)},c=function(d){return function(y){this[d]=+y}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(d){(this.zone||(this.zone={})).offset=function(y){if(!y||y==="Z")return 0;var k=y.match(/([+-]|\d\d)/g),S=60*k[1]+(+k[2]||0);return S===0?0:k[0]==="+"?-S:S}(d)}],m=function(d){var y=a[d];return y&&(y.indexOf?y:y.s.concat(y.f))},h=function(d,y){var k,S=a.meridiem;if(S){for(var x=1;x<=24;x+=1)if(d.indexOf(S(x,0,y))>-1){k=x>12;break}}else k=d===(y?"pm":"PM");return k},b={A:[u,function(d){this.afternoon=h(d,!1)}],a:[u,function(d){this.afternoon=h(d,!0)}],Q:[i,function(d){this.month=3*(d-1)+1}],S:[i,function(d){this.milliseconds=100*+d}],SS:[s,function(d){this.milliseconds=10*+d}],SSS:[/\d{3}/,function(d){this.milliseconds=+d}],s:[o,c("seconds")],ss:[o,c("seconds")],m:[o,c("minutes")],mm:[o,c("minutes")],H:[o,c("hours")],h:[o,c("hours")],HH:[o,c("hours")],hh:[o,c("hours")],D:[o,c("day")],DD:[s,c("day")],Do:[u,function(d){var y=a.ordinal,k=d.match(/\d+/);if(this.day=k[0],y)for(var S=1;S<=31;S+=1)y(S).replace(/\[|\]/g,"")===d&&(this.day=S)}],w:[o,c("week")],ww:[s,c("week")],M:[o,c("month")],MM:[s,c("month")],MMM:[u,function(d){var y=m("months"),k=(m("monthsShort")||y.map(function(S){return S.slice(0,3)})).indexOf(d)+1;if(k<1)throw new Error;this.month=k%12||k}],MMMM:[u,function(d){var y=m("months").indexOf(d)+1;if(y<1)throw new Error;this.month=y%12||y}],Y:[/[+-]?\d+/,c("year")],YY:[s,function(d){this.year=f(d)}],YYYY:[/\d{4}/,c("year")],Z:l,ZZ:l};function p(d){var y,k;y=d,k=a&&a.formats;for(var S=(d=y.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function($,D,O){var ne=O&&O.toUpperCase();return D||k[O]||n[O]||k[ne].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(_,v,g){return v||g.slice(1)})})).match(r),x=S.length,T=0;T<x;T+=1){var M=S[T],I=b[M],L=I&&I[0],j=I&&I[1];S[T]=j?{regex:L,parser:j}:M.replace(/^\[|\]$/g,"")}return function($){for(var D={},O=0,ne=0;O<x;O+=1){var _=S[O];if(typeof _=="string")ne+=_.length;else{var v=_.regex,g=_.parser,N=$.slice(ne),w=v.exec(N)[0];g.call(D,w),$=$.replace(w,"")}}return function(R){var A=R.afternoon;if(A!==void 0){var C=R.hours;A?C<12&&(R.hours+=12):C===12&&(R.hours=0),delete R.afternoon}}(D),D}}return function(d,y,k){k.p.customParseFormat=!0,d&&d.parseTwoDigitYear&&(f=d.parseTwoDigitYear);var S=y.prototype,x=S.parse;S.parse=function(T){var M=T.date,I=T.utc,L=T.args;this.$u=I;var j=L[1];if(typeof j=="string"){var $=L[2]===!0,D=L[3]===!0,O=$||D,ne=L[2];D&&(ne=L[2]),a=this.$locale(),!$&&ne&&(a=k.Ls[ne]),this.$d=function(N,w,R,A){try{if(["x","X"].indexOf(w)>-1)return new Date((w==="X"?1e3:1)*N);var C=p(w)(N),V=C.year,X=C.month,re=C.day,ce=C.hours,qe=C.minutes,Re=C.seconds,Be=C.milliseconds,Ne=C.zone,oe=C.week,pe=new Date,Se=re||(V||X?1:pe.getDate()),Ie=V||pe.getFullYear(),St=0;V&&!X||(St=X>0?X-1:pe.getMonth());var At,en=ce||0,tn=qe||0,nn=Re||0,rn=Be||0;return Ne?new Date(Date.UTC(Ie,St,Se,en,tn,nn,rn+60*Ne.offset*1e3)):R?new Date(Date.UTC(Ie,St,Se,en,tn,nn,rn)):(At=new Date(Ie,St,Se,en,tn,nn,rn),oe&&(At=A(At).week(oe).toDate()),At)}catch{return new Date("")}}(M,j,I,k),this.init(),ne&&ne!==!0&&(this.$L=this.locale(ne).$L),O&&M!=this.format(j)&&(this.$d=new Date("")),a={}}else if(j instanceof Array)for(var _=j.length,v=1;v<=_;v+=1){L[1]=j[v-1];var g=k.apply(this,L);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}v===_&&(this.$d=new Date(""))}else x.call(this,T)}}})}(Vt)),Vt.exports}var ws=gs();const vs=Pn(ws);Le.extend(vs);function Es(t){switch(t){case cn.FLOOR:return Te.ROUND_FLOOR;case cn.CEIL:return Te.ROUND_CEIL;case cn.BANKER_ROUND:return Te.ROUND_HALF_EVEN;default:return Te.ROUND_HALF_UP}}function ys(t,e){if(t==null)return"";const n=e.format,r=Es(e.round),i=e.showZero===!1;switch(n){case lt.FIXED:{const s=e.precision;if(s==null||s<0)return t.toString();const o=typeof t=="number"?Q.of(t):t;return o.eq(0)&&i?"":o.toFixed(s,r)}case lt.THOUSAND:{const s=typeof t=="number"?Q.of(t):t;return s.eq(0)&&i?"":Q.toFormat(s,2,r,{groupSize:3})}case lt.TEN_THOUSAND:{const s=typeof t=="number"?Q.of(t):t;return s.eq(0)&&i?"":Q.toFormat(s,2,r,{groupSize:4})}case lt.DAXIE:{const s=typeof t=="number"?Q.of(t):t;return s.eq(0)&&i?"":fs.toMoney(s.toFixed(2,r),{outSymbol:!1})}case lt.PERCENTAGE:{const s=typeof t=="number"?Q.of(t):t;if(s.eq(0)&&i)return"";const o=e.precision??2;return s.times(100).toFixed(o,Te.ROUND_HALF_UP)+"%"}default:return typeof t=="number"?t==0&&i?"":t.toString():t.eq(0)&&i?"":t.toString()}}function Ns(t,e){const n=e.format;return n==null?t:Le(t).format(n)}function bs(t,e){const n=t.attributes;switch(t.display){case te.NUMBER:return ys(e,n);case te.DATE:return Ns(e,n);default:return e}}const cr=Object.create(null);var Jt,tt;const wt=class wt{constructor(e){ue(this,Jt,Dn(kn.PRINT_ELEMENT));ue(this,tt,Object.create(null));P(this,"define");P(this,"children",[]);P(this,"atomized",!1);P(this,"extra",!1);P(this,"parent");P(this,"offsetTop",0);P(this,"offsetLeft",0);P(this,"offsetWidth",0);P(this,"offsetHeight",0);P(this,"element");P(this,"zIndex");P(this,"state",Ft.CREATED);P(this,"visibility",Pe.PENDING);P(this,"value",{state:fe.UNDEFINED});this.define=e,this.offsetTop=e.offsetTop,this.offsetLeft=e.offsetLeft,this.offsetWidth=e.offsetWidth,this.offsetHeight=e.offsetHeight,this.zIndex=e.zIndex,je(this,"parent",null),je(this,"element",null)}static register(e,n){cr[e]=n}static create(e){const n=cr[e.type]??wt;return new n(e)}static isPrintElement(e){return e instanceof wt}get id(){return"@"+F(this,Jt)}get type(){return this.define.type}get index(){const e=this.parent;return e==null?-1:e.children.indexOf(this)}get page(){let e=this.parent;for(;e;){if(e instanceof Wt)return e;e=e.parent}return null}get doc(){var e;return(e=this.page)==null?void 0:e.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const e=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return e+n}get pageNum(){var e;return((e=this.page)==null?void 0:e.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const e=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${e}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===qt.AUTO}get isOverflowScale(){return this.define.attributes.overflow===qt.SCALE}get isOverflowHidden(){const e=this.define.attributes.overflow;return e==null||e===qt.HIDDEN}get isProcessValueDone(){return this.value.state===fe.DONE}get isUndefinedValue(){return this.value.state===fe.UNDEFINED}get isHidden(){return this.visibility===Pe.HIDDEN}get isMounted(){return this.state>=Ft.MOUNDTED}async processValue(){var e,n,r;if(!this.isProcessValueDone)switch(this.value=await es(this,(e=this.doc)==null?void 0:e.data),this.value.state){case fe.DONE:(n=this.doc)==null||n.removeDependency(this);break;case fe.PENDING:(r=this.doc)==null||r.addDependency(this,{state:fe.PENDING});break}}getRawValue(){if(this.value.state===fe.DONE)return this.value.raw}format(){return bs(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(e=>e.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}nextTick(){return this.doc?this.doc.nextTick():Promise.resolve()}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const e=this.content;return Zr(e)?null:z("span",{class:"quickprint-content",children:this.content})}async updateElement(){const e=this.parent;if(e==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await e.replaceChild(this,n)}async mountChild(e){var n;return this.element==null||e.element==null?!1:(this.element.appendChild(e.element),await this.nextTick(),await e.mount(e.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(e,n){var r;return this.element==null||e.element==null?!1:(n==null||this.element.replaceChild(n,e.element),jt(e.element),await this.nextTick(),await e.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(e){e!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=e.offsetWidth,this.offsetHeight=e.offsetHeight,this.state=Ft.MOUNDTED,this.element=e)}setParent(e){this.parent=e}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}append(e){e.setParent(this),this.children.push(e),F(this,tt)[e.id]=e}clone(){const e=wt.create(this.define),n=this.children.map(r=>r.clone());return e.appendMany(n),e}checkOverflow(){if(this.element==null)return!1;const e=this.element.querySelector(".quickprint-content");if(e==null)return!1;const n=e.parentElement;return n==null?!1:n.offsetHeight<e.offsetHeight}processOverflow(){return this.isOverflowScale?Mr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const e=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return e==null||(e.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(e){const n=F(this,tt)[e];if(n)return n;for(const r of this.children){const i=r.findElement(e);if(i)return i}}findElementFromDefine(e){return this.children.find(n=>n.define.id===e)}filterElementFromDefine(e){const n=[],r=typeof e=="string"?e:e.id;for(const i of this.children){i.define.id===r&&n.push(i);const s=i.filterElementFromDefine(e);s.length>0&&n.push(...s)}return n}createElements(){Ae(this,tt,this.children.reduce((e,n)=>(e[n.id]=n,e),Object.create(null)))}checkVisibility(){var i,s,o;const e=this.define;if(e.visibility==null||e.visibility.type===Un.VISIBLE)return Pe.VISIBLE;if(e.visibility.type===Un.HIDDEN)return Pe.HIDDEN;const n=e.visibility.condition;if(it(n))return Pe.VISIBLE;const r=Pr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case fe.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Pe.VISIBLE:Pe.HIDDEN;case fe.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:fe.PENDING}),Pe.PENDING;default:return Pe.PENDING}}updateHeight(){var e;return this.isMounted!==!0?!1:(this.offsetHeight=((e=this.element)==null?void 0:e.offsetHeight)??0,!0)}};Jt=new WeakMap,tt=new WeakMap;let B=wt;function Je(t,e){return e.exclude==null?!0:!e.exclude.includes(t)}function Rt(t){const e={};if(Mt.chromeLike!==!0||Mt.name==="chrome"&&Mt.fullVersion&&Mt.fullVersion>="143.0.7499.193")return e;const n=t.define,r=n.style.fontFamily;if(!(r==null||r===Xr.SONG))return e;const s=n.style.fontWeight;return s!=null&&s>400?e["quickprint-patch-song-blod"]=!0:e["quickprint-patch-song"]=!0,e}function Mn(t,e={}){const n={},r=t.define.style??{},i=mr(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=Kr(r);return s&&Object.assign(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),r.writingMode&&(n.writingMode=r.writingMode),Je("align",e)&&Object.assign(n,Jr(t.define)),Je("padding",e)&&Object.assign(n,Qr(t.define)),n["--quickprint-content-transform"]=ei(t.define),Object.assign(n,ti(t.define)),n}function On(t,e={}){const n={};if(Je("top",e)&&(n.top=t.offsetTop+"px"),Je("left",e)&&(n.left=t.offsetLeft+"px"),Je("width",e)&&(n.width=t.offsetWidth+"px"),Je("height",e)){const r=t.define.attributes.overflow===qt.AUTO?"min-height":"height";n[r]=t.offsetHeight+"px"}return t.zIndex&&(n.zIndex=t.zIndex),n}function ct(t,e={}){return Object.assign(On(t,e),Mn(t,e),It(t.define))}class _s extends B{get style(){return ct(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...Rt(this)}}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class Ds extends B{get style(){return On(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...Rt(this)}}onFinished(){const e=this.element;if(e==null)return Promise.resolve();const n=e.querySelector(".quickprint-content");if(n==null)return Promise.resolve();for(const r of n.children){const i=window.getComputedStyle(r);if(i.fontFamily==="宋体"||i.fontFamily==="SimSun"){const s=this.processWeight(i.fontWeight);r.classList.add(s>400?"quickprint-patch-song-blod":"quickprint-patch-song")}}return Promise.resolve()}processConstNode(e){var i;const n=e.dataset.value;if(it(n))return;const r=An(this,n,(i=this.doc)==null?void 0:i.data);e.textContent=r.raw}processWeight(e){if(e==="bold")return 700;const n=Number(e);return Number.isNaN(n)?400:n}process(e){for(const n of Array.from(e.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return e}render(){if(this.isHidden)return null;const e=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=e,z("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class ks extends B{get style(){return ct(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...Rt(this)}}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class Ts extends B{get style(){return ct(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...Rt(this)}}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class Cr extends B{constructor(){super(...arguments);P(this,"rendering",0)}get style(){return{...On(this),...Mn(this,{exclude:["padding"]}),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>z("col",{width:s}));return z("div",{id:this.id,class:this.className,style:this.style,children:z("table",{children:[z("colgroup",{children:i}),z("tbody",{})]})})}async mountChild(n){if(n.element==null)return!1;const r=this.getTableBody();if(r==null)return!1;r.appendChild(n.element),await this.nextTick(),await n.mount(n.element);for(const i of this.children)i.updateCellHeight();return this.updateHeight(),!0}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await this.nextTick(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n+1),i=this.getTableBody();if(this.children.length=n+1,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class xs extends B{constructor(){super(...arguments);P(this,"repeatGroup");P(this,"rowData");P(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return z("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=Ft.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}updateCellHeight(){for(const n of this.children)n.updateHeight()}}class Cn extends B{get style(){var i;const e=It((i=this.define.parent)==null?void 0:i.parent),n=It(this.define.parent),r=It(this.define);return{...e,...n,...r,...this.createWidthStyle(),...this.createHeightStyle()}}get className(){const e=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(e==null?void 0:e.isOverflowAuto)===!0,"quickprint-fixed-height":(e==null?void 0:e.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...Rt(this)}}get showDiagonal(){const e=this.define.attributes.diagonalMode;return e==null?!1:e!==ft.NONE}findPrevDisplayedCell(){const e=this.parent;if(e==null)return;let n=this.index-1;for(;n>=0;){const r=e.children[n];if(r==null)return;if(r.define.isCollapsed){n-=1;continue}return r}}findNextDisplayedCell(){const e=this.parent;if(e==null)return;let n=this.index+1;for(;n<e.children.length;){const r=e.children[n];if(r==null)return;if(r.define.isCollapsed){n=r.index-1;continue}return r}}findPrevDisplayedRow(){const e=this.parent,n=e==null?void 0:e.parent;if(e==null||n==null)return;let r=e.index-1;const i=this.index;for(;r>=0;){const s=n.children[r],o=s.children[i];if(o==null)return;if(o.define.isRowCollapsed){r-=1;continue}return s}}findNextDisplayedRow(){const e=this.parent,n=e==null?void 0:e.parent;if(e==null||n==null)return;let r=e.index+1;const i=this.index;for(;r<n.children.length;){const s=n.children[r],o=s.children[i];if(o==null)return;if(o.define.isRowCollapsed){r+=1;continue}return s}}createContentStyle(e=!1){var s;const n={exclude:[]};e&&((s=n.exclude)==null||s.push("padding"));let r=this,i={};for(;B.isPrintElement(r);)i={...Mn(r,n),...i},r=r.parent;return i}createWidthStyle(){var c,l,m,h,b;const e=this.findPrevDisplayedCell(),n=this.findNextDisplayedCell(),r=(c=this.parent)==null?void 0:c.parent,i=W(this.define,"left")??W((l=this.parent)==null?void 0:l.define,"left")??W(r==null?void 0:r.define,"left"),s=W(e==null?void 0:e.define,"right")??W((m=e==null?void 0:e.parent)==null?void 0:m.define,"right")??W(r==null?void 0:r.define,"right"),o=W(this.define,"right")??W((h=this.parent)==null?void 0:h.define,"right")??W(r==null?void 0:r.define,"right"),u=W(n==null?void 0:n.define,"left")??W((b=n==null?void 0:n.define)==null?void 0:b.parent,"left")??W(r==null?void 0:r.define,"left"),a=Math.max(de.processLengthToPX(i)??0,de.processLengthToPX(s)??0),f=Math.max(de.processLengthToPX(o)??0,de.processLengthToPX(u)??0);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-border-left-width":a+"px","--quickprint-cell-border-right-width":f+"px"}}createHeightStyle(){var l,m,h,b,p,d,y;const e=this.index,n=(l=this.parent)==null?void 0:l.parent,r=(m=this.findPrevDisplayedRow())==null?void 0:m.children[e],i=(h=this.findNextDisplayedRow())==null?void 0:h.children[e],s=W(this.define,"top")??W((b=this.parent)==null?void 0:b.define,"top")??W(n==null?void 0:n.define,"top"),o=W(r==null?void 0:r.define,"bottom")??W((p=r==null?void 0:r.parent)==null?void 0:p.define,"bottom")??W(n==null?void 0:n.define,"bottom"),u=W(this.define,"bottom")??W((d=this.parent)==null?void 0:d.define,"bottom")??W(n==null?void 0:n.define,"bottom"),a=W(i==null?void 0:i.define,"top")??W((y=i==null?void 0:i.parent)==null?void 0:y.define,"top")??W(n==null?void 0:n.define,"top"),f=Math.max(de.processLengthToPX(s)??0,de.processLengthToPX(o)??0),c=Math.max(de.processLengthToPX(u)??0,de.processLengthToPX(a)??0);return{"--quickprint-cell-height":this.offsetHeight+"px","--quickprint-cell-border-top-width":f+"px","--quickprint-cell-border-bottom-width":c+"px"}}createCoord(){switch(this.define.attributes.diagonalMode){case ft.TL_BR:return{x1:"0",y1:"0",x2:"100%",y2:"100%"};case ft.TR_BL:return{x1:"100%",y1:"0",x2:"0",y2:"100%"};default:return null}}createDiagonal(){const e=this.createCoord();if(e==null)return null;const n=this.define.attributes.diagonalMode,r=this.define.attributes.diagonalLabels??[],i={"quickprint-diagonal":!0,"quickprint-diagonal-tlbr":n===ft.TL_BR,"quickprint-diagonal-trbl":n===ft.TR_BL},s=r[0]?z("div",{class:"quickprint-diagonal-first-label",children:r[0].text}):null,o=r[1]?z("div",{class:"quickprint-diagonal-second-label",children:r[1].text}):null,u=document.createElementNS(Zn,"svg");u.setAttribute("width","100%"),u.setAttribute("height","100%");const a=document.createElementNS(Zn,"line");return a.setAttribute("x1",e.x1),a.setAttribute("y1",e.y1),a.setAttribute("x2",e.x2),a.setAttribute("y2",e.y2),a.setAttribute("stroke","currentColor"),a.setAttribute("stroke-width","1"),u.appendChild(a),z("div",{class:i,style:this.createContentStyle(!0),children:[u,s,o]})}createCell(){return this.isHidden?null:this.showDiagonal?this.createDiagonal():z("div",{class:"quickprint-layout",style:this.createContentStyle(),children:this.createContent()})}render(){return this.define.isCollapsed?null:z("td",{id:this.id,class:this.className,style:this.style,rowspan:this.define.rowspan,colspan:this.define.colspan,children:this.createCell()})}}var nt,bt;class Rs extends B{constructor(n){super(n);ue(this,nt);ue(this,bt);const{promise:r,resolve:i}=Promise.withResolvers();Ae(this,bt,r),Ae(this,nt,i)}get style(){return ct(this,{exclude:["padding"]})}get className(){return{"quickprint-element":!0,"quickprint-image":!0,"quickprint-layout":!0}}onFinished(){return F(this,bt)}onLoad(n){var r;(r=F(this,nt))==null||r.call(this)}onError(n){var r;(r=F(this,nt))==null||r.call(this)}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,children:z("img",{src:this.content,style:ni(this.define.attributes.size),onLoad:this.onLoad.bind(this),onError:this.onError.bind(this)})})}}nt=new WeakMap,bt=new WeakMap;class Ss extends B{get style(){return ct(this,{exclude:["align"]})}get className(){return{"quickprint-element":!0,"quickprint-qrcode":!0,"quickprint-layout":!0}}createCode(){const e=this.content,n=this.define.attributes.mode,r=this.define.attributes.barcolor;return gr.qrcode(n,e,{barcolor:r})??""}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,innerHTML:this.createCode()})}}class As extends B{get style(){const e=this.define.attributes,n=ct(this,{exclude:["align"]});return e.width&&(n["--quickprint-barcode-width"]=e.width),e.height&&(n["--quickprint-barcode-height"]=e.height),n}get className(){const e=this.define.attributes,n=vt(e.width)||vt(e.height);return{"quickprint-element":!0,"quickprint-barcode":!0,"quickprint-layout":!0,"quickprint-barcode-fixed":n,"quickprint-barcode-contain":!n}}createCode(){const e=this.content,n=this.define.attributes;return gr.barcode(n.mode,e,{barcolor:n.barcolor,includetext:n.showText===!0,width:de.processLengthToMM(n.width),height:de.processLengthToMM(n.height)})??""}render(){return this.isHidden?null:z("div",{id:this.id,class:this.className,style:this.style,innerHTML:this.createCode()})}}B.register(te.TEXT,_s);B.register(te.PARAGRAPH,Ds);B.register(te.NUMBER,ks);B.register(te.DATE,Ts);B.register(te.TABLE,Cr);B.register(te.TABLE_ROW,xs);B.register(te.TABLE_CELL,Cn);B.register(te.IMAGE,Rs);B.register(te.QRCODE,Ss);B.register(te.BARCODE,As);function Ps(t){return Number(t)}function Ms(t){return Math.abs(t)}function Os(t){return Math.trunc(t)}function Cs(...t){return Math.min(...t)}function Ls(...t){return Math.max(...t)}function qs(t,e){return Q.round(t,e??0,Te.ROUND_CEIL)}function Is(t,e){return Q.round(t,e??0,Te.ROUND_FLOOR)}function Hs(t,e,n){return Q.round(t,e??0,n??Te.ROUND_HALF_UP)}function $s(t){t.set("NUMBER",Ps),t.set("ABS",Ms),t.set("TRUNC",Os),t.set("MIN",Cs),t.set("MAX",Ls),t.set("CEIL",qs),t.set("FLOOR",Is),t.set("ROUND",Hs)}function Fs(t){return String(t)}function Us(t){return String(t).length}function Bs(t){return String(t).toLowerCase()}function Vs(t){return String(t).toUpperCase()}function Ys(t){const e=String(t);return e[0].toUpperCase()+e.slice(1)}function Gs(t){return String(t).trim()}function zs(t,e,n){return String(t).replace(e,n)}function js(t,e,n){return String(t).replaceAll(e,n)}function Ws(t,e,n){return String(t).slice(e,n)}function Zs(t,e,n){return String(t).includes(String(e),n)}function Xs(t,e,n){return String(t).indexOf(String(e),n)}function Ks(t,e,n){return String(t).lastIndexOf(String(e),n)}function Js(t,e,n){return String(t).startsWith(String(e),n)}function Qs(t,e,n){return String(t).endsWith(String(e),n)}function eo(t){t.set("STRING",Fs),t.set("LENGTH",Us),t.set("LOWER",Bs),t.set("UPPER",Vs),t.set("TRIM",Gs),t.set("UPPER_FIRST",Ys),t.set("REPLACE",zs),t.set("REPLACE_ALL",js),t.set("SLICE",Ws),t.set("INCLUDES",Zs),t.set("INDEX_OF",Xs),t.set("LAST_INDEX_OF",Ks),t.set("STARTS_WITH",Js),t.set("ENDS_WITH",Qs)}function to(t,e,n){return t?e:n}function no(t,e){return Number.isNaN(t)?e:t}function ro(t,e){return Number.isNaN(t)||t==null?e:t}function io(t,...e){for(let r=0;r<e.length;r+=2){const i=e[r],s=e[r+1];if(i===t)return s}return e.length%2===0?void 0:e[e.length-1]}function Lr(t){return Number.isNaN(t)}function so(t){return Number.isInteger(t)}function qr(t){return typeof t=="number"}function Ir(t){return typeof t=="string"}function oo(t){return typeof t=="boolean"}function Hr(t){return t===null}function $r(t){return t===void 0}function Fr(t){return Hr(t)||$r(t)}function ao(t){return Fr(t)?!0:Ir(t)?t.length==0:qr(t)?!Lr(t):!1}function uo(t){t.set("IF",to),t.set("IFNA",no),t.set("IFERROR",ro),t.set("IS_NAN",Lr),t.set("IS_INTEGER",so),t.set("IS_NUMBER",qr),t.set("IS_STRING",Ir),t.set("IS_BOOLEAN",oo),t.set("IS_NULL",Hr),t.set("IS_UNDEFINED",$r),t.set("IS_NULLISH",Fr),t.set("IS_EMPTY",ao),t.set("SWITCH",io)}const co=[le.YEAR_MONTH,le.YEAR_MONTH_CHS,le.YEAR_MONTH_DAY,le.YEAR_MONTH_DAY_CHS,le.DATETIME_SHORT,le.DATETIME_SHORT_CHS,le.DATETIME,le.DATETIME_CHS,le.TIME,le.TIME_SHORT,le.YEAR,le.MONTH,le.DAY];function Ue(t){if(t!=null){if(typeof t=="number")return co[t];if(typeof t=="string")return t}}function Ur(t,e,n){return t===null&&(t=void 0),Le(t,Ue(n)).format(Ue(e)??le.DATETIME)}function lo(t){return Ur(void 0,t)}function fo(t,e){return t===null&&(t=void 0),Le(t,Ue(e)).year()}function ho(t,e){return t===null&&(t=void 0),Le(t,Ue(e)).month()+1}function po(t,e){return t===null&&(t=void 0),Le(t,Ue(e)).date()}function mo(t,e){return t===null&&(t=void 0),Le(t,Ue(e)).hour()}function go(t,e){return t===null&&(t=void 0),Le(t,Ue(e)).minute()}function wo(t,e){return t===null&&(t=void 0),Le(t,Ue(e)).second()}function vo(t){t.set("DATE",Ur),t.set("NOW",lo),t.set("YEAR",fo),t.set("MONTH",ho),t.set("DAY",po),t.set("HOUR",mo),t.set("MINUTE",go),t.set("SECOND",wo)}function Br(t,e){return t.children.reduce((n,r)=>{const i=r.findElementFromDefine(e);if(i==null)return n;if(!i.isProcessValueDone)throw xt();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(ri(o)?o:0),n},[])}function Ln(t,e){var r;const n=(r=t.parent)==null?void 0:r.parent;if(!(n==null||n.type!==te.TABLE))return Br(n,e)}function qn(t,e){var i,s;const n=(i=t.parent)==null?void 0:i.parent;if(n==null||n.type!==te.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,u)=>o.concat(u.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,u)=>o.concat(Br(u,e)),[])}function Eo(t,e){if(!t.doc.isPaged)throw xt();const r=t.page,i=r.pageNum<r.pageTotal?Ln(t,e):qn(t,e);return i==null||i.length==0?0:Q.sum(...i).toNumber()}function yo(t,e){const n=t.element,r=t.value;if(!(n instanceof Cn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw xt();if(e===2)return Eo(n,r);const s=e==1?Ln(n,r):qn(n,r);return s==null||s.length==0?0:Q.sum(...s).toNumber()}function No(t,e){const n=t.element,r=t.value;if(!(n instanceof Cn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw xt();const s=e==1?Ln(n,r):qn(n,r);return s==null||s.length==0?0:Q.sum(...s).div(s.length).toNumber()}function bo(t){t.set("COL_SUM",yo),t.set("COL_AVG",No)}$s(ut);eo(ut);uo(ut);vo(ut);bo(ut);const _o=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-doc-column-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-doc-column-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-guide-header{top:var(--quickprint-paper-header-top)}.quickprint-guide-footer{top:var(--quickprint-paper-footer-top)}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table{padding:0!important}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-table-cell .quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - calc(var(--quickprint-cell-border-left-width) / 2 / var(--quickprint-dpr)) - calc(var(--quickprint-cell-border-right-width) / 2 / var(--quickprint-dpr)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - calc(var(--quickprint-cell-border-top-width) / 2) - calc(var(--quickprint-cell-border-bottom-width) / 2))!important}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - calc(var(--quickprint-cell-border-top-width) / 2 / var(--quickprint-dpr)) - calc(var(--quickprint-cell-border-bottom-width) / 2 / var(--quickprint-dpr)))!important}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-wrap;background-color:var(--quickprint-variable-highlight-color, transparent);transform:var(--quickprint-content-transform, none)}.quickprint-diagonal{display:block;width:var(--quickprint-cell-width);height:var(--quickprint-cell-height);position:relative}.quickprint-diagonal-first-label,.quickprint-diagonal-second-label{position:absolute;z-index:2}.quickprint-diagonal-tlbr .quickprint-diagonal-first-label{top:2px;right:2px;text-align:right}.quickprint-diagonal-tlbr .quickprint-diagonal-second-label{left:2px;bottom:2px}.quickprint-diagonal-trbl .quickprint-diagonal-first-label{top:2px;left:2px}.quickprint-diagonal-trbl .quickprint-diagonal-second-label{right:2px;bottom:2px;text-align:right}.quickprint-image{padding:0}.quickprint-image>img{display:block}.quickprint-qrcode,.quickprint-barcode{padding:0;display:flex;align-items:center;justify-content:center}.quickprint-qrcode svg{display:flex;max-width:100%;max-height:100%}.quickprint-barcode-fixed svg{display:block;width:var(--quickprint-barcode-width);height:var(--quickprint-barcode-height);flex-shrink:0}.quickprint-barcode-contain svg{display:block;max-width:100%;max-height:100%}",Do="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-document{--quickprint-dpr: 1 !important}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none!important}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song{text-shadow:0 0 currentColor}.quickprint-patch-song-blod{--quickprint-patch-song-shadow-1: .125px;--quickprint-patch-song-shadow-2: -.125px;text-shadow:var(--quickprint-patch-song-shadow-1) 0 0 currentColor,var(--quickprint-patch-song-shadow-2) 0 0 currentColor,0 var(--quickprint-patch-song-shadow-1) 0 currentColor,0 var(--quickprint-patch-song-shadow-2) 0 currentColor}}";function lr(){return _o}function ko(){return Do}class To{constructor(){P(this,"skip",0);P(this,"count",0);P(this,"resolvedPromise",Promise.resolve())}nextTick(){return this.skip<=2e3?(this.skip++,this.resolvedPromise):this.count<48?(this.count++,this.resolvedPromise):new Promise(e=>{this.count=0,setTimeout(e)})}}var Qt,rt,_t,Ye,Dt,Ge,kt,_n;const Hn=class Hn{constructor(e,n){ue(this,kt);ue(this,Qt,Dn(kn.PRINT_DOCUMENT));ue(this,rt);ue(this,_t);ue(this,Ye,Object.create(null));ue(this,Dt,0);P(this,"define");P(this,"data");P(this,"state");P(this,"pages",[]);P(this,"element");P(this,"renderer",null);P(this,"rendering");P(this,"devicePixelRatio",window.devicePixelRatio);P(this,"tick",new To);ue(this,Ge,[]);const{promise:r,resolve:i}=Promise.withResolvers();Ae(this,_t,r),Ae(this,rt,i),this.define=e,this.state=n,je(this,"element",null),je(this,"rendering",0),this.state.renderState=ye.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(e,n={}){const r=e instanceof yn?e:yn.create(e);return new Hn(r,n)}get id(){return"@"+F(this,Qt)}get style(){const e=this.state.scale??100,n=this.define.style,r=Math.max(...this.pages.map(i=>i.define.width));return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":e/100,"--quickprint-doc-column-width":r+"mm",fontFamily:mr(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get renderState(){return this.state.renderState}get isPaged(){return this.renderState===ye.PAGED||this.renderState===ye.READY}get isFirstRount(){return F(this,Dt)===0}get debug(){return this.state.debug}onCreated(){return Promise.allSettled(this.pages.map(e=>e.onCreated()))}onBeforeUnmount(e){F(this,Ge).indexOf(e)>=0||F(this,Ge).push(e)}unmount(){for(const e of F(this,Ge))typeof e=="function"&&e();F(this,Ge).length=0,this.setRenderState(ye.UNMOUNT),this.element=null}nextTick(){return this.tick.nextTick()}render(){const e=[ge.DOCUMENT];return z("div",{class:e,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(e){return this.element==null||e.element==null?!1:(this.element.appendChild(e.element),!0)}async mount(){this.state.total=this.pages.length,this.refreshPageTotal(),this.setRenderState(ye.PAGED),await on(this,kt,_n).call(this),this.setRenderState(ye.READY);const e=this.pages.map(n=>n.onFinshed());await Promise.allSettled(e),typeof F(this,rt)=="function"&&(F(this,rt).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(e){this.pages.push(e),e.setParent(this)}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}insert(e,n){this.pages.splice(n,0,e),e.setParent(this)}ready(){return F(this,_t)}injectElementStyle(){if(document.querySelector('style[data-from="quickprint-element"]'))return;const n=document.createElement("style");n.textContent=lr(),n.dataset.from="quickprint-element",document.head.appendChild(n)}async print(){return await this.ready(),new Promise(e=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),e()})})}genPapeStyle(){const e=this.define;if(e.isPaginated)return`@page{ size: ${e.paper.width}mm ${e.paper.height}mm }`;const n=this.pages[0];return`@page{ size: ${e.paper.width}mm ${n.offsetHeight}px }`}genPrintHtml(){var r;const e=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${e}</title>`,`<style>${lr()}</style>`,`<style>${ko()}</style>`,`<style>${this.genPapeStyle()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const e=this.state.scale??100,n=dt.indexOf(e);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=dt[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const e=this.state.scale??100,n=dt.indexOf(e);if(n<0)return this.resetZoom(),!1;if(n>=dt.length-1)return!1;const r=dt[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const e=100;this.state.scale=e,this.element.style.setProperty("--quickprint-doc-scale",`${e/100}`)}addDependency(e,n){F(this,Ye)[e.id]={element:e,...n}}removeDependency(e){delete F(this,Ye)[e.id]}setRenderState(e){this.state.renderState=e}watchDevicePixelRatio(){const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);e.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{e.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}findElement(e){for(const n of this.pages){const r=n.findElement(e);if(r)return r}}filterElement(e){return this.pages.reduce((n,r)=>n.concat(r.filterElement(e)),[])}refreshPageTotal(){const e={};for(const n of this.pages){const r=n.file;if(e[r]!=null){n.pageTotal=e[r];continue}const i=this.pages.filter(s=>s.file===r);e[r]=i.length,n.pageTotal=i.length}}};Qt=new WeakMap,rt=new WeakMap,_t=new WeakMap,Ye=new WeakMap,Dt=new WeakMap,Ge=new WeakMap,kt=new WeakSet,_n=async function(){for(const r of Object.values(F(this,Ye))){const i=r.element;await i.processValue(),i.isProcessValueDone&&(this.removeDependency(i),await i.updateElement())}const e=this.pages[0].filterElement("e0_hxq59pklk")[0];e&&await e.updateElement(),Object.keys(F(this,Ye)).length!=0&&(++Fn(this,Dt)._>=100||await on(this,kt,_n).call(this))};let Nt=Hn;function gt(t){const e=B.create(t),n=t.children.map(r=>B.create(r));return e.appendMany(n),e}function xo(t,e={},n=t.id){function r(c){const l=Wt.create(c,n);i(l);for(const m of l.defines){const h=o(m);h.define.isFixed?l.appendToFixed(h):l.append(h)}return s(l),l.state=$t.INIT,l}function i(c){if(!(c.header.display!=!0||c.header.defines.length==0))for(const l of c.header.defines)c.appendToHeader(o(l))}function s(c){if(!(c.footer.display!=!0||c.footer.defines.length==0))for(const l of c.footer.defines)c.appendToFooter(o(l))}function o(c){switch(c.type){case"Table":return u(c);default:return B.create(c)}}function u(c){let l=0;const m=B.create(c),h=c.children;for(;l<h.length;){const b=h[l];if(b.isRepeat&&b.repeatGroup){const p=c.children.filter(y=>y.repeatGroup===b.repeatGroup),d=a(c,l,p);m.appendMany(d.rows),l=d.next;continue}if(b.isRepeat&&b.rowspan>1){const p=c.children.slice(l,l+b.rowspan),d=a(c,l,p);m.appendMany(d.rows),l=d.next;continue}if(b.isRepeat){m.appendMany(f(b)),l++;continue}m.append(gt(b)),l++}return m}function a(c,l,m){const h=c.children[l],b=Ze(h.ds.value),p=Bn(Qe(e,b.value)),d=[];for(let y=0;y<p.length;y++){const k=`${h.id}_${y}`;for(const S of m){const x=gt(S),T=p[y];Reflect.defineProperty(T,Symbol.for(He.DATA_INDEX),{value:y}),x.repeatGroup=k,x.rowData=T,d.push(x)}}return{rows:d,next:l+m.length}}function f(c){const l=Ze(c.ds.value),m=Qe(e,l.value);return Bn(m).map((h,b)=>{const p=gt(c);return Reflect.defineProperty(h,Symbol.for(He.DATA_INDEX),{value:b}),p.rowData=h,p})}return t.data=e,t.appendMany(t.define.pages.map(c=>r(c))),t}function Ro(t,e={}){return xo(t,e)}const Ot="__QUICKPRINT_STREAM_RENDERER_HANDLER_0__",pt="__QUICKPRINT_STREAM_RENDERER_LISTENER_0__";var ze;class So{constructor(e,n,r={}){P(this,"container");P(this,"doc");P(this,"data");P(this,"currentFile",null);P(this,"pageNum",1);ue(this,ze,null);this.container=e,this.doc=n,this.data=r,n.renderer=this}createDebug(){if(this.doc.debug!==!0)return;const e=window;if(typeof e[pt]!="function"){const r=i=>{i.key==="F10"&&(i.preventDefault(),i.stopPropagation(),this.next())};e[pt]=r,e.addEventListener("keydown",r)}const n=new CustomEvent("quickprint-debug:start",{detail:{renderer:Ot}});e.dispatchEvent(n),e[Ot]=this}cleanup(){const e=window;typeof e[pt]=="function"&&(window.removeEventListener("keydown",e[pt]),delete e[pt]),e[Ot]&&delete e[Ot];const n=new CustomEvent("quickprint-debug:end");e.dispatchEvent(n),this.doc.renderer=null}next(){typeof F(this,ze)=="function"&&(F(this,ze).call(this),Ae(this,ze,null))}resume(){this.doc.state.debug=!1,this.next()}createNextTask(e){return this.doc.debug!==!0?e():new Promise(n=>{Ae(this,ze,()=>{e().then(n)})})}async render(){Ro(this.doc,this.data),await this.doc.onCreated(),this.doc.setRenderState(ye.RENDERING);const e=this.doc.createElement();return e&&this.container.appendChild(e),this.currentFile=this.doc.pages[0].file,this.createDebug(),this.renderPage()}async renderPage(){const e=this.doc,n=e.rendering,r=e.pages[n];if(r==null){await e.mount(),this.cleanup();return}return r.beginPaging(),r.createElement()==null?this.createNextTask(()=>(e.rendering+=1,this.renderPage())):(await e.mountChild(r),await this.renderPageElement(r),await this.renderPageFixedElement(r),r.file!==this.currentFile&&(this.pageNum=1),r.pageNum=this.pageNum++,await r.onPaged(),this.createNextTask(()=>(e.rendering+=1,e.state.total=e.pages.length,this.renderPage())))}async renderPageElement(e){const n=e.children[e.rendering];return n==null?void 0:(n.offsetTop=this.findNewOffsetTop(e,n),n.createElement()==null?this.createNextTask(()=>(e.rendering+=1,this.renderPageElement(e))):(await this.mountChild(e,n),this.doc.define.isPaginated||e.updateHeight(),this.createNextTask(()=>(e.rendering+=1,this.renderPageElement(e)))))}async renderPageFixedElement(e){let n=0;for(;n<e.fixed.length;){const r=e.fixed[n];await e.mountChild(r),await this.createNextTask(()=>(n++,Promise.resolve()))}}findNewOffsetTop(e,n){const r=e.children[e.rendering-1];return r==null?e.extra?e.header.offsetHeight+4:n.offsetTop:!r.isChanged||En.isIsolated(r.define,n.define)?n.offsetTop:r.offsetBottom+n.define.top-r.define.top-r.define.height}mountChild(e,n){switch(n.define.type){case te.TABLE:return this.renderTable(e,n);case te.TEXT:return this.renderText(e,n);default:return this.defaultRender(e,n)}}findNextFragment(e,n){const r=e.children[n],i=[r];if(r.repeatGroup==null)return{height:r.offsetHeight,length:1};for(let s=n+1;s<e.children.length;s++){const o=e.children[s];if(o.repeatGroup!==r.repeatGroup)break;i.push(o)}return{start:n,length:i.length,height:i.reduce((s,o)=>s+o.offsetHeight,0)-i.reduce((s,o)=>{if(o.define.hasRowCollapsed){const u=o.children.find(a=>!(a.define.isRowCollapsed||a.define.hasRowSpan));return s+((u==null?void 0:u.offsetHeight)??Math.min(...i.map(a=>a.offsetHeight)))}return s},0)}}findSplitRowIndex(e,n){let r=e.offsetTop,i=0;for(;i<e.children.length;){const s=this.findNextFragment(e,i);if(r+=s.height,r==n)return i+s.length-1;if(r>n)return i-1;i+=s.length}return e.children.length-1}splitTable(e,n,r){const i=n.define.footer.map(l=>{const m=gt(l);return m.extra=!0,m}),s=r-i.reduce((l,m)=>l+m.offsetHeight,0),o=this.findSplitRowIndex(n,s),u=n.splitRows(o);n.appendMany(i),n.atomized=!0,n.rendering=o;const a=e.clone(),f=new Cr(n.define),c=n.define.header.map(l=>gt(l));f.extra=!0,f.appendMany(c),f.appendMany(u);for(let l=0;l<e.children.length;l++){const m=e.children[l];if(m.define.id===n.define.id){Reflect.set(a.children,l,f);continue}if(m.define.attributes.printMode===ii.EACH){const h=m.clone();Reflect.set(a.children,l,h);continue}l<e.rendering+1||En.isIsolated(m.define,n.define)||(Reflect.set(a.children,l,m),Reflect.set(e.children,l,null))}return e.children=e.children.filter(l=>l==null?!1:(l.setParent(e),!0)),a.children=a.children.filter(l=>l==null?!1:(l.setParent(a),!0)),a}async renderTableRow(e,n){const r=n.children[n.rendering];if(r==null)return;if(r.extra&&r.isUndefinedValue&&await r.onCreated(),r.createElement()==null)return n.rendering+=1,this.renderTableRow(e,n);if(await n.mountChild(r),!e.parent.define.isPaginated)return e.updateHeight(),this.createNextTask(()=>(n.rendering+=1,this.renderTableRow(e,n)));const s=de.mm_to_px(e.define.height)-e.footer.offsetHeight;if(n.offsetBottom-s>=2){const o=this.splitTable(e,n,s),u=n.children.filter(a=>a.extra);return this.doc.insert(o,e.index+1),await Promise.allSettled(u.map(a=>a.onCreated())),await o.onCreated(),this.createNextTask(()=>this.renderTableRow(e,n))}return this.createNextTask(()=>(n.rendering+=1,this.renderTableRow(e,n)))}async renderTable(e,n){return await e.mountChild(n),this.renderTableRow(e,n)}async renderText(e,n){return n.extra&&n.isUndefinedValue&&await n.onCreated(),e.mountChild(n)}async defaultRender(e,n){return n.extra&&n.isUndefinedValue&&await n.onCreated(),e.mountChild(n)}}ze=new WeakMap;function Ao(t){const e=Date.now(),n=Nt.create(t.define,t.state);return new So(t.container,n,t.data).render().then(()=>{n.state.renderTime=Date.now()-e}),n}const Po=st({__name:"DocState",props:{state:{type:Object,required:!0}},setup(t){const e=t,n=De(()=>e.state.renderState===ye.READY),r=De(()=>e.state.renderState===ye.READY?"已就绪":e.state.renderState===ye.RENDERING?`正在生成(${e.state.total??0}页)...`:"正在生成...");return(i,s)=>(Ee(),Me("div",null,[s[0]||(s[0]=ae("span",null,"文档：",-1)),ae("span",{class:J({[i.classes.finished]:n.value})},mt(r.value),3)]))}}),Mo="_finished_7h37m_2",Oo={finished:Mo},Co={classes:Oo},Lo=Tt(Po,[["__cssModules",Co]]),qo=st({__name:"Debug",props:{doc:{type:Nt,required:!0}},setup(t){const e=t,n=Tn("classes"),r=xn({x:40,y:40,diffx:0,diffy:0}),i=De(()=>({top:r.y+"px",left:r.x+"px"}));function s(){var c;(c=e.doc.renderer)==null||c.next()}function o(){var c;(c=e.doc.renderer)==null||c.resume()}function u(c){c.preventDefault(),c.stopPropagation();const l=c.target.closest("."+n.indicator);if(l==null)return;l.setPointerCapture(c.pointerId);const m=l.getBoundingClientRect();r.diffx=c.clientX-m.left,r.diffy=c.clientY-m.top,window.addEventListener("pointermove",a),window.addEventListener("pointerup",f),l.releasePointerCapture(c.pointerId)}function a(c){c.preventDefault(),c.stopPropagation(),r.x=c.clientX-r.diffx,r.y=c.clientY-r.diffy}function f(c){window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",f)}return(c,l)=>(Ee(),Me("div",{class:J(q(n).debug),style:vi(i.value)},[ae("div",{class:J(q(n).indicator),onPointerdown:u},[K(q(Yt),{icon:"icon-tuozhuai",size:"16px"})],34),ae("div",{class:J(q(n).tools)},[ae("button",{type:"button",class:J(["quickprint-text-btn",q(n).next]),onClick:s},"下一步(F10)",2),ae("button",{type:"button",class:J(["quickprint-text-btn",q(n).resume]),onClick:o},"结束(ESC)",2)],2)],6))}}),Io="_debug_yym8k_2",Ho="_indicator_yym8k_14",$o="_tools_yym8k_21",Fo="_next_yym8k_26",Uo="_resume_yym8k_31",Bo={debug:Io,indicator:Ho,tools:$o,next:Fo,resume:Uo},Vo={classes:Bo},Yo=Tt(qo,[["__cssModules",Vo]]),Go="_toolbar_3etac_1",zo="_button_3etac_9",jo="_actived_3etac_33",Wo="_divider_3etac_46",Ke={toolbar:Go,button:zo,actived:jo,divider:Wo},Zo=["viewMode","debug","space","print"],Xo=st({props:{doc:{type:Nt},buttons:{type:Array,required:!0}},setup(t){function e(){var a;(a=t.doc)==null||a.print()}function n(){var a;(a=t.doc)==null||a.toggleViewMode()}function r(){var f;const a={[Ke.button]:!0,[Ke.actived]:((f=t.doc)==null?void 0:f.state.viewMode)==="multiple"};return K("button",{type:"button",title:"切换单页/多页视图",class:a,onClick:n},[K(Yt,{icon:"icon-multi-page"},null),K("span",null,[Gt("多页")])])}function i(){return K("button",{type:"button",class:Ke.button,onClick:e,title:"打印 Ctrl + P"},[K(Yt,{icon:"icon-printer"},null),K("span",null,[Gt("打印")])])}function s(){return K("div",{class:Ke.divider},null)}function o(){return K("div",{class:"quickprint-is-fill-w"},null)}function u(a){if(typeof a=="function")return a(Ke,t.doc);switch(a){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return K("div",{class:Ke.toolbar},[t.buttons.map(u)])}}});function Ko(t){function e(i){const s=t.value;if(s!=null)switch(i.key){case"p":case"P":if(i.ctrlKey)return i.preventDefault(),s.print();case"Add":if(i.ctrlKey)return i.preventDefault(),s.zoomOut();case"Subtract":if(i.ctrlKey)return i.preventDefault(),s.zoomIn();case"0":if(i.ctrlKey)return i.preventDefault(),s.resetZoom();case"m":case"M":if(i.ctrlKey)return i.preventDefault(),s.toggleViewMode()}}function n(){window.addEventListener("keydown",e)}function r(){window.removeEventListener("keydown",e)}return{enable:n,disable:r}}const wn="quickprint_renderer_debug";function Jo(){const t=Ht(!1),e=xn({current:1,debug:sessionStorage.getItem(wn)==="true"});function n(s){t.value=!0}function r(){t.value=!1,sessionStorage.removeItem(wn)}function i(){sessionStorage.setItem(wn,"true"),window.location.reload()}return window.addEventListener("quickprint-debug:start",n),window.addEventListener("quickprint-debug:end",r),Ei(()=>{window.removeEventListener("quickprint-debug:start",n),window.removeEventListener("quickprint-debug:end",r)}),{enable:t,state:e,startDebug:i}}const Qo={key:3,class:"quickprint-is-fill-w"},ea=st({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return Zo}}},emits:["mock"],setup(t,{emit:e}){const n=t,r=Tn("classes"),i=si(S,100),s=zt(),o=zt(),u=Ko(o),{state:a,enable:f,startDebug:c}=Jo(),l=De(()=>a.renderState===ye.READY),m=De(()=>a.total??"--"),h=De(()=>{const x=a.renderTime??0;if(x<=6e4)return`${x/1e3}秒`;const T=Math.floor(x/1e3),M=T%60,I=(T-M)/60;return M==0?`${I}分`:`${I}分${M}秒`}),b=De(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function p(){var x;(x=o.value)==null||x.zoomIn()}function d(){var x;(x=o.value)==null||x.zoomOut()}function y(x){var T,M;x.deltaY>0?(T=o.value)==null||T.zoomIn():(M=o.value)==null||M.zoomOut()}async function k(){const x=Ao({container:s.value,define:yn.create(n.define),state:a,data:n.data});o.value=x,document.title=x?`${x.define.name} - OpenPrint`:"OpenPrint",await x.ready(),u.enable()}function S(x){const T=s.value;if(T==null)return;const M=T.querySelectorAll(`.${ge.PAGE}`),I=T.scrollTop;for(let L=0;L<M.length;L++){const j=M[L];if(j.offsetTop+j.offsetHeight/2>I){a.current=Number(j.dataset.index);break}}}return yi(()=>{k()}),(x,T)=>(Ee(),Me("div",{class:J(q(r).preview),onWheel:bi(y,["ctrl","prevent"])},[ae("div",{class:J([q(ge).PRINT_HIDDEN,q(r).header])},[ae("div",{class:J(q(r).headerLeft)},[zn(x.$slots,"headerLeft")],2),K(q(Xo),{doc:o.value,buttons:t.buttons},null,8,["doc","buttons"]),ae("div",{class:J(q(r).headerRight)},[zn(x.$slots,"headerRight")],2)],2),ae("div",{class:J(b.value),ref_key:"containerRef",ref:s,onScrollPassive:T[0]||(T[0]=(...M)=>q(i)&&q(i)(...M))},null,34),ae("div",{class:J([q(ge).PRINT_HIDDEN,q(r).footer])},[K(Lo,{state:q(a),class:J(q(r).status)},null,8,["state","class"]),l.value?(Ee(),Me(jn,{key:0},[ae("div",{class:J(q(r).status)},"用时："+mt(h.value),3),T[2]||(T[2]=ae("div",{class:"quickprint-is-fill-w"},null,-1))],64)):ln("",!0),q(a).debug!==!0?(Ee(),Me("button",{key:1,type:"button",class:"quickprint-text-btn",title:"进入调试模式",onClick:T[1]||(T[1]=(...M)=>q(c)&&q(c)(...M))},[K(q(Yt),{icon:"icon-bug"})])):ln("",!0),l.value?(Ee(),Me(jn,{key:2},[T[3]||(T[3]=ae("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ae("div",{class:J(q(r).divider)},null,2),ae("div",{class:J(q(r).status)},"第"+mt(q(a).current)+"页，共"+mt(m.value)+"页",3),ae("div",{class:J(q(r).divider)},null,2)],64)):(Ee(),Me("div",Qo)),K(q(oi),{class:J(q(r).zoom),scale:q(a).scale,onZoomIn:p,onZoomOut:d},null,8,["class","scale"])],2),q(f)&&o.value?(Ee(),vr(Ni,{key:0,to:"body"},[K(Yo,{doc:o.value},null,8,["doc"])])):ln("",!0)],34))}}),ta="_preview_6q7hh_6",na="_header_6q7hh_17",ra="_headerLeft_6q7hh_26",ia="_headerRight_6q7hh_32",sa="_body_6q7hh_38",oa="_footer_6q7hh_57",aa="_status_6q7hh_77",ua="_divider_6q7hh_83",ca="_zoom_6q7hh_90",la={preview:ta,header:na,headerLeft:ra,headerRight:ia,body:sa,footer:oa,status:aa,divider:ua,zoom:ca},fa={classes:la},da=Tt(ea,[["__cssModules",fa]]),ha=st({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(t){const e=t,n=Tn("classes"),r=ai(),i=wr(e.local??[]),s=xn(e.ds.fields.map(f=>a(f))),o=[{label:"文本",value:we.STRING},{label:"数字",value:we.NUMBER},{label:"日期",value:we.DATE},{label:"对象",value:we.OBJECT},{label:"数组",value:we.ARRAY}],u=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(f,c){var m;const l=f[c.name];return((m=o.find(h=>h.value===l))==null?void 0:m.label)??l}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(f,c){if(f.type===we.OBJECT)return null;if(f.type===we.ARRAY)return Wn(K("input",{type:"number","onUpdate:modelValue":m=>f.total=m,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[Di,f.total]]);const l=e.options.find(m=>m.classify===f.type);return l==null?null:Wn(K("select",{"onUpdate:modelValue":m=>f.func=m,class:n.select},[K("option",{value:"",class:n.placeholder},[Gt("请选择")]),l.rules.map(m=>K("option",{value:m.func,key:m.func},[m.name]))]),[[ki,f.func]])}}];function a(f,c){const l=c?`${c}.${f.name}`:f.name,m=f.children?f.children.map(b=>a(b,f.name)):void 0,h=i[l];return{type:f.type,name:f.name,title:f.title,children:m,$expand:!0,func:(h==null?void 0:h.func)??"",total:h==null?void 0:h.total}}return r==null||r.useHandle("confirm",()=>_i(s)),(f,c)=>(Ee(),Me("div",{class:J(q(n).ds)},[K(q(ui),{columns:u,data:s},null,8,["data"])],2))}}),pa="_ds_6a9ph_2",ma="_placeholder_6a9ph_8",ga="_select_6a9ph_12",wa="_input_6a9ph_13",va={ds:pa,placeholder:ma,select:ga,input:wa},Ea={classes:va},ya=Tt(ha,[["__cssModules",Ea]]);let Ct=null;const fr=490;function Vr(){return Ct!=null?Promise.resolve(Ct):fi(()=>import("./mock-ZgllWvX9.js"),__vite__mapDeps([0,1,2,3])).then(t=>(Ct=t.default,Ct))}function dr(t,e){switch(e){case we.DATE:return t.randDate();case we.NUMBER:return t.randDecimal();case we.STRING:return t.randName();default:return null}}function Na(t){if((t==null?void 0:t.total)==null)return fr;const e=Number(t.total);return Number.isNaN(e)||!Number.isFinite(e)||e<=0?fr:Math.round(e)}function vn(t,e,n){if(n==null||it(n.func))return dr(t,e.type);const r=t[n.func];return typeof r!="function"?dr(t,e.type):r(n)}const ba=ci(function(t,e,n){const r={ds:e,options:t.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:di.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return hi("创建模拟数据",Ti(ya,r),i).promisify()});async function hr(t,e){if(t==null||t.fields.filter(i=>i.name).length==0)return[];const n=await Vr(),r=await ba(n,t,e).catch(li);return Array.isArray(r)?r:[]}async function Lt(t,e){if(t==null||!Array.isArray(e)||e.length==0)return{};const n=await Vr(),r=wr(e);return t.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===we.OBJECT){const u=s.children??[];return i[s.name]=u.reduce((a,f)=>{if(it(f.name))return a;const c=`${s.name}.${f.name}`;return a[f.name]=vn(n,f,r[c]),a},{}),i}if(s.type===we.ARRAY){const u=s.children??[],a=Na(o),f=10+Math.round(Math.random()*a);return i[s.name]=Array(f).fill("").map(()=>u.reduce((c,l)=>{if(it(l.name))return c;const m=`${s.name}.${l.name}`;return c[l.name]=vn(n,l,r[m]),c},{})),i}return i[s.name]=vn(n,s,o),i},{})}const _a=st({__name:"index",setup(t){const e={INIT:0,LOADED_CASE:1,READY:2},n=zt(),r=zt(),i=Ht(0),s=Ht(!1),o=De(()=>{var d;return`${((d=n.value)==null?void 0:d.id)??Date.now()}-${i.value}`}),u=Ht(e.INIT),a=De(()=>["viewMode","debug","space",s.value?h:null,"print"]),f=De(()=>u.value===e.INIT?"正在加载...":u.value===e.LOADED_CASE?"已加载模板，正在准备数据...":u.value===e.READY?"开始渲染...":"");function c(){const d=new URLSearchParams(window.location.search).get("id");return vt(d)&&(d==="local"||Gn.some(y=>y.id===d))?d:Gn[0].id}async function l(p){var S,x,T,M;if(p==null)return{};if(p.data)return s.value=!1,p.data;const d=Vn(p.id);if(Array.isArray(d)&&d.length>0)return Lt((S=p.define)==null?void 0:S.ds,d);const y=p.rules;if(Array.isArray(y)&&y.length>0)return Lt((x=p.define)==null?void 0:x.ds,y);const k=await hr((T=n.value)==null?void 0:T.ds);return Yn(k,p.id),Lt((M=p.define)==null?void 0:M.ds,k)}async function m(){if(n.value==null)return;const p=n.value.id;if(p==null||p=="")return;const d=Vn(p),y=await hr(n.value.ds,d);Yn(y,n.value.id),r.value=await Lt(n.value.ds,y),i.value++}function h(p){return K("button",{type:"button",class:p.button,onClick:m},[K("span",null,[Gt("模拟数据")])])}async function b(){u.value=e.INIT,s.value=!0;const p=await pi(c());n.value=(p==null?void 0:p.define)??{},u.value=e.LOADED_CASE,r.value=await l(p),u.value=e.READY}return b(),(p,d)=>u.value<e.READY?(Ee(),Me("div",{key:0,class:J(p.classes.logs)},mt(f.value),3)):(Ee(),vr(q(da),{define:n.value,data:r.value,buttons:a.value,key:o.value,class:J(p.classes.preview),onMock:m},null,8,["define","data","buttons","class"]))}}),Da="_preview_17t3s_7",ka="_logs_17t3s_11",Ta={preview:Da,logs:ka},xa={classes:Ta},Ra=Tt(_a,[["__cssModules",xa]]),In=xi(Ra),Sa=mi();In.use(gi,{zIndex:Sa});In.mount("#app");wi(In._context);
