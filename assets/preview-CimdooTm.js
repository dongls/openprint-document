const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-BeWaslGC.js","assets/utils-DvQwHNsq.js","assets/vue-B00pXJJQ.js","assets/utils-BWxIAY5I.css"])))=>i.map(i=>d[i]);
var br=Object.defineProperty;var bn=e=>{throw TypeError(e)};var Rr=(e,t,n)=>t in e?br(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var L=(e,t,n)=>Rr(e,typeof t!="symbol"?t+"":t,n),Vt=(e,t,n)=>t.has(e)||bn("Cannot "+n);var H=(e,t,n)=>(Vt(e,t,"read from private field"),n?n.call(e):t.get(e)),de=(e,t,n)=>t.has(e)?bn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),st=(e,t,n,r)=>(Vt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ot=(e,t,n)=>(Vt(e,t,"access private method"),n);var Rn=(e,t,n,r)=>({set _(i){st(e,t,i,n)},get _(){return H(e,t,r)}});import{M as Or,aq as fn,ar as hn,aN as Be,r as tn,av as Mr,aw as Pr,b as se,aO as Y,H as we,o as dn,F as Ge,i as wt,P as Ir,m as tt,D as Et,G as Cr,V as Gt,aP as Xe,a as at,N as zt,O as _t,n as Lr,E as On,t as pn,x as nn,a5 as kr,u as er,v as xr,w as Ze,y as qr,z as $r,A as Fr,B as Hr,c as ae,q as Ur,Q as rn,L as Br,aQ as Mn,U as Yr,_ as $t,I as sn,aD as Vr,R as Gr,aR as tr,h as me,T as zr,W as jr,$ as Wr,K as Zr,aF as Xr,X as Kr,aS as Pn,aT as In,aK as Jr,aJ as Cn,aG as Qr,aH as ei,aI as ti}from"./utils-DvQwHNsq.js";import{d as pt,h as be,c as Ke,a as Ye,b as ue,n as ie,v as Rt,e as Z,H as Ot,u as nr,s as Mt,g as rr,B as ni,i as Q,f as Ln,F as ri,w as ii,y as si,E as kn,G as oi,S as ai,N as ui,r as jt,j as ci,R as li}from"./vue-B00pXJJQ.js";const le=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),Tt=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),on=Object.freeze({CREATED:0,MOUNDTED:1}),ce={UNDEFINED:0,PENDING:1,DONE:2},Se={PENDING:-1,HIDDEN:0,VISIBLE:1},ut=[25,50,75,100,125,150,200,300,400],fi=["class","className","style"],Ae=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDDE_LINE:"quickprint-guide-line"}),xn=Promise.resolve(),hi=2e3,di=48;let an=0,St=0;function pi(){an=0,St=0}function ze(){return an<=hi?(an++,xn):St<di?(St++,xn):new Promise(e=>{St=0,setTimeout(e)})}function mi(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)}function gi(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123}function un(e){return e==null?"":typeof e=="string"?e.trim():Array.isArray(e)?e.map(un).join(" "):typeof e=="object"?Object.keys(e).filter(t=>e[t]).join(" "):""}function ir(e,t){if(t!=null){if(t instanceof Element){e.appendChild(t);return}if(Array.isArray(t)){for(const n of t)ir(e,n);return}e.textContent+=t}}function vi(e,t){if(!(t==null||typeof t!="object"))for(const n of Object.keys(t)){const r=t[n];if(r==null)continue;const i=Or(n);e.style.setProperty(i,r)}}function wi(e,t){if(un(t)=="")return;const r=e.className==""?"":" ";e.className+=r+un(t)}function sr(e,t,n){switch(t){case"class":case"className":wi(e,n);break;case"style":vi(e,n);break;case"children":n!=null&&ir(e,n);break;case"innerHTML":break;default:if(t[0]==="@")return Ei(e,t,n);t in e&&(e[t]=n),n==null?e.removeAttribute(t):e.setAttribute(t,n)}}function Ei(e,t,n){Reflect.set(e,t.slice(1),n)}function yi(e,t,n){const r=e(t);if(r==null)return null;for(const i of Object.keys(t??{}))(mi(i)||gi(i)||fi.includes(i))&&sr(r,i,t[i]);return r}function Ni(e,t,n){const r=document.createElement(e);if(r==null)return null;for(const i of Object.keys(t??{}))sr(r,i,t[i]);return r}function K(e,t,n){return typeof e=="function"?yi(e,t):Ni(e,t)}function qn(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var Lt,Le;const kt=class kt{constructor(t,n,r){de(this,Lt,fn(hn.PRINT_PAGE));de(this,Le,Object.create(null));L(this,"file");L(this,"define");L(this,"pageNum",-1);L(this,"pageTotal",-1);L(this,"extra",!1);L(this,"paper");L(this,"header");L(this,"footer");L(this,"children",[]);L(this,"fixed",[]);L(this,"parent");L(this,"element");L(this,"rendering");L(this,"state",Tt.CREATED);this.file=r,this.define=t,this.paper=this.createPaper(t,n),this.header=this.createHeader(),this.footer=this.createFooter(),Be(this,"parent",null),Be(this,"element",null),Be(this,"rendering",0)}static create(t,n,r="0000"){return new kt(t,n,r)}get id(){return"@"+H(this,Lt)}get index(){return this.parent==null?-1:this.parent.pages.findIndex(t=>t.id===this.id)}get defines(){const t=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>t.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>t.add(i.id)),this.define.children.filter(i=>!t.has(i.id)).sort(tn.sort)}get style(){const{offsetWidth:t,offsetHeight:n}=this.paper;return{width:t+"px",height:n+"px"}}get isLast(){return this.pageNum===this.pageTotal}createPageHeader(){const t=this.header;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[Ae.GUIDDE_LINE,Ae.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),K("div",{class:r,style:n})]}createPageFooter(){const t=this.footer;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[Ae.GUIDDE_LINE,Ae.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),K("div",{class:r,style:n})]}render(){return K("div",{id:this.id,class:Ae.PAGE,"data-index":this.index+1,children:K("div",{class:Ae.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(t){this.state=Tt.PAGED,await this.onPaged()}async mountChild(t){if(this.element==null||t.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(t.element),await ze(),await t.mount(t.element),!0)}async replaceChild(t,n){if(this.element==null||t.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null?r.removeChild(t.element):r.replaceChild(n,t.element),await ze(),await t.mount(n),!0)}beginPaging(){this.state=Tt.PAGING}onCreated(){const t=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(t.map(n=>n.onCreated()))}onPaged(){const t=this.children.map(n=>typeof n.onPaged=="function"?n.onPaged():Promise.resolve());return Promise.allSettled(t)}onFinshed(){const t=this.children.map(r=>typeof r.onFinished=="function"?r.onFinished():Promise.resolve()),n=this.adjustFooter();return n&&t.push(n),Promise.allSettled(t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),H(this,Le)[t.id]=t}appendToHeader(t){t.setParent(this),this.header.children.push(t),H(this,Le)[t.id]=t}appendToFooter(t){t.setParent(this),this.footer.children.push(t),H(this,Le)[t.id]=t}appendToFixed(t){t.setParent(this),this.fixed.push(t),H(this,Le)[t.id]=t}createPaper(t,n){return{size:n.size,width:n.width,height:n.height,orientation:t.orientation,offsetWidth:Math.round(n.width),offsetHeight:Math.round(n.height)}}createHeader(){const t=this.define.header;if(t.display!==!0)return qn();const n=t.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const t=this.define.footer;if(t.display!==!0)return qn();const n=t.height??0,i=Math.floor(Mr(this.paper.height))-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const t=new kt(this.define,this.paper,this.file);t.rendering=0;for(const n of this.header.children){const r=n.clone();t.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();t.appendToFooter(r)}return t}findElement(t){const n=H(this,Le)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}filterElement(t){const n=typeof t=="string"?t:t.id;return this.children.filter(r=>r.define.id===n)}adjustFooter(){if(!this.isLast||this.define.footer.flow!==Pr.TABLE)return;let t=0,n=null;for(const i of this.children)if(i.offsetBottom>t&&(t=i.offsetBottom),i.type===se.TABLE){if(n==null){n=i;continue}i.offsetBottom>n.offsetBottom&&(n=i)}if(n==null||Math.abs(t-n.offsetBottom)>=4)return;const r=Math.floor(this.footer.offsetTop-n.offsetBottom);return Promise.allSettled(this.footer.children.map(i=>(i.offsetTop-=r,i.updateElement())))}};Lt=new WeakMap,Le=new WeakMap;let Pt=kt;var nt=1e9,Di={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},gn,G=!0,ge="[DecimalError] ",Ve=ge+"Invalid argument: ",mn=ge+"Exponent out of range: ",rt=Math.floor,$e=Math.pow,_i=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe,ne=1e7,V=7,or=9007199254740991,It=rt(or/V),_={};_.absoluteValue=_.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};_.comparedTo=_.cmp=function(e){var t,n,r,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(r=s.d.length,i=e.d.length,t=0,n=r<i?r:i;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};_.decimalPlaces=_.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*V;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};_.dividedBy=_.div=function(e){return Oe(this,new this.constructor(e))};_.dividedToIntegerBy=_.idiv=function(e){var t=this,n=t.constructor;return F(Oe(t,new n(e),0,1),n.precision)};_.equals=_.eq=function(e){return!this.cmp(e)};_.exponent=function(){return J(this)};_.greaterThan=_.gt=function(e){return this.cmp(e)>0};_.greaterThanOrEqualTo=_.gte=function(e){return this.cmp(e)>=0};_.isInteger=_.isint=function(){return this.e>this.d.length-2};_.isNegative=_.isneg=function(){return this.s<0};_.isPositive=_.ispos=function(){return this.s>0};_.isZero=function(){return this.s===0};_.lessThan=_.lt=function(e){return this.cmp(e)<0};_.lessThanOrEqualTo=_.lte=function(e){return this.cmp(e)<1};_.logarithm=_.log=function(e){var t,n=this,r=n.constructor,i=r.precision,s=i+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(fe))throw Error(ge+"NaN");if(n.s<1)throw Error(ge+(n.s?"NaN":"-Infinity"));return n.eq(fe)?new r(0):(G=!1,t=Oe(ht(n,s),ht(e,s),s),G=!0,F(t,i))};_.minus=_.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?cr(t,e):ar(t,(e.s=-e.s,e))};_.modulo=_.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(e=new r(e),!e.s)throw Error(ge+"NaN");return n.s?(G=!1,t=Oe(n,e,0,1).times(e),G=!0,n.minus(t)):F(new r(n),i)};_.naturalExponential=_.exp=function(){return ur(this)};_.naturalLogarithm=_.ln=function(){return ht(this)};_.negated=_.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};_.plus=_.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ar(t,e):cr(t,(e.s=-e.s,e))};_.precision=_.sd=function(e){var t,n,r,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ve+e);if(t=J(i)+1,r=i.d.length-1,n=r*V+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};_.squareRoot=_.sqrt=function(){var e,t,n,r,i,s,o,a=this,c=a.constructor;if(a.s<1){if(!a.s)return new c(0);throw Error(ge+"NaN")}for(e=J(a),G=!1,i=Math.sqrt(+a),i==0||i==1/0?(t=ye(a.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=rt((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new c(t)):r=new c(i.toString()),n=c.precision,i=o=n+3;;)if(s=r,r=s.plus(Oe(a,s,o+2)).times(.5),ye(s.d).slice(0,o)===(t=ye(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(F(s,n+1,0),s.times(s).eq(a)){r=s;break}}else if(t!="9999")break;o+=4}return G=!0,F(r,n)};_.times=_.mul=function(e){var t,n,r,i,s,o,a,c,f,u=this,d=u.constructor,N=u.d,m=(e=new d(e)).d;if(!u.s||!e.s)return new d(0);for(e.s*=u.s,n=u.e+e.e,c=N.length,f=m.length,c<f&&(s=N,N=m,m=s,o=c,c=f,f=o),s=[],o=c+f,r=o;r--;)s.push(0);for(r=f;--r>=0;){for(t=0,i=c+r;i>r;)a=s[i]+m[r]*N[i-r-1]+t,s[i--]=a%ne|0,t=a/ne|0;s[i]=(s[i]+t)%ne|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,G?F(e,d.precision):e};_.toDecimalPlaces=_.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(De(e,0,nt),t===void 0?t=r.rounding:De(t,0,8),F(n,e+J(n)+1,t))};_.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=je(r,!0):(De(e,0,nt),t===void 0?t=i.rounding:De(t,0,8),r=F(new i(r),e+1,t),n=je(r,!0,e+1)),n};_.toFixed=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?je(i):(De(e,0,nt),t===void 0?t=s.rounding:De(t,0,8),r=F(new s(i),e+J(i)+1,t),n=je(r.abs(),!1,e+J(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};_.toInteger=_.toint=function(){var e=this,t=e.constructor;return F(new t(e),J(e)+1,t.rounding)};_.toNumber=function(){return+this};_.toPower=_.pow=function(e){var t,n,r,i,s,o,a=this,c=a.constructor,f=12,u=+(e=new c(e));if(!e.s)return new c(fe);if(a=new c(a),!a.s){if(e.s<1)throw Error(ge+"Infinity");return a}if(a.eq(fe))return a;if(r=c.precision,e.eq(fe))return F(a,r);if(t=e.e,n=e.d.length-1,o=t>=n,s=a.s,o){if((n=u<0?-u:u)<=or){for(i=new c(fe),t=Math.ceil(r/V+4),G=!1;n%2&&(i=i.times(a),Fn(i.d,t)),n=rt(n/2),n!==0;)a=a.times(a),Fn(a.d,t);return G=!0,e.s<0?new c(fe).div(i):F(i,r)}}else if(s<0)throw Error(ge+"NaN");return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,a.s=1,G=!1,i=e.times(ht(a,r+f)),G=!0,i=ur(i),i.s=s,i};_.toPrecision=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?(n=J(i),r=je(i,n<=s.toExpNeg||n>=s.toExpPos)):(De(e,1,nt),t===void 0?t=s.rounding:De(t,0,8),i=F(new s(i),e,t),n=J(i),r=je(i,e<=n||n<=s.toExpNeg,e)),r};_.toSignificantDigits=_.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(De(e,1,nt),t===void 0?t=r.rounding:De(t,0,8)),F(new r(n),e,t)};_.toString=_.valueOf=_.val=_.toJSON=_[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=J(e),n=e.constructor;return je(e,t<=n.toExpNeg||t>=n.toExpPos)};function ar(e,t){var n,r,i,s,o,a,c,f,u=e.constructor,d=u.precision;if(!e.s||!t.s)return t.s||(t=new u(e)),G?F(t,d):t;if(c=e.d,f=t.d,o=e.e,i=t.e,c=c.slice(),s=o-i,s){for(s<0?(r=c,s=-s,a=f.length):(r=f,i=o,a=c.length),o=Math.ceil(d/V),a=o>a?o+1:a+1,s>a&&(s=a,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(a=c.length,s=f.length,a-s<0&&(s=a,r=f,f=c,c=r),n=0;s;)n=(c[--s]=c[s]+f[s]+n)/ne|0,c[s]%=ne;for(n&&(c.unshift(n),++i),a=c.length;c[--a]==0;)c.pop();return t.d=c,t.e=i,G?F(t,d):t}function De(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ve+e)}function ye(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)r=e[t]+"",n=V-r.length,n&&(s+=Ce(n)),s+=r;o=e[t],r=o+"",n=V-r.length,n&&(s+=Ce(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Oe=function(){function e(r,i){var s,o=0,a=r.length;for(r=r.slice();a--;)s=r[a]*i+o,r[a]=s%ne|0,o=s/ne|0;return o&&r.unshift(o),r}function t(r,i,s,o){var a,c;if(s!=o)c=s>o?1:-1;else for(a=c=0;a<s;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*ne+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var a,c,f,u,d,N,m,A,g,p,l,h,v,O,P,I,x,C,U=r.constructor,q=r.s==i.s?1:-1,D=r.d,M=i.d;if(!r.s)return new U(r);if(!i.s)throw Error(ge+"Division by zero");for(c=r.e-i.e,x=M.length,P=D.length,m=new U(q),A=m.d=[],f=0;M[f]==(D[f]||0);)++f;if(M[f]>(D[f]||0)&&--c,s==null?h=s=U.precision:o?h=s+(J(r)-J(i))+1:h=s,h<0)return new U(0);if(h=h/V+2|0,f=0,x==1)for(u=0,M=M[0],h++;(f<P||u)&&h--;f++)v=u*ne+(D[f]||0),A[f]=v/M|0,u=v%M|0;else{for(u=ne/(M[0]+1)|0,u>1&&(M=e(M,u),D=e(D,u),x=M.length,P=D.length),O=x,g=D.slice(0,x),p=g.length;p<x;)g[p++]=0;C=M.slice(),C.unshift(0),I=M[0],M[1]>=ne/2&&++I;do u=0,a=t(M,g,x,p),a<0?(l=g[0],x!=p&&(l=l*ne+(g[1]||0)),u=l/I|0,u>1?(u>=ne&&(u=ne-1),d=e(M,u),N=d.length,p=g.length,a=t(d,g,N,p),a==1&&(u--,n(d,x<N?C:M,N))):(u==0&&(a=u=1),d=M.slice()),N=d.length,N<p&&d.unshift(0),n(g,d,p),a==-1&&(p=g.length,a=t(M,g,x,p),a<1&&(u++,n(g,x<p?C:M,p))),p=g.length):a===0&&(u++,g=[0]),A[f++]=u,a&&g[0]?g[p++]=D[O]||0:(g=[D[O]],p=1);while((O++<P||g[0]!==void 0)&&h--)}return A[0]||A.shift(),m.e=c,F(m,o?s+J(m)+1:s)}}();function ur(e,t){var n,r,i,s,o,a,c=0,f=0,u=e.constructor,d=u.precision;if(J(e)>16)throw Error(mn+J(e));if(!e.s)return new u(fe);for(G=!1,a=d,o=new u(.03125);e.abs().gte(.1);)e=e.times(o),f+=5;for(r=Math.log($e(2,f))/Math.LN10*2+5|0,a+=r,n=i=s=new u(fe),u.precision=a;;){if(i=F(i.times(e),a),n=n.times(++c),o=s.plus(Oe(i,n,a)),ye(o.d).slice(0,a)===ye(s.d).slice(0,a)){for(;f--;)s=F(s.times(s),a);return u.precision=d,t==null?(G=!0,F(s,d)):s}s=o}}function J(e){for(var t=e.e*V,n=e.d[0];n>=10;n/=10)t++;return t}function Wt(e,t,n){if(t>e.LN10.sd())throw G=!0,n&&(e.precision=n),Error(ge+"LN10 precision limit exceeded");return F(new e(e.LN10),t)}function Ce(e){for(var t="";e--;)t+="0";return t}function ht(e,t){var n,r,i,s,o,a,c,f,u,d=1,N=10,m=e,A=m.d,g=m.constructor,p=g.precision;if(m.s<1)throw Error(ge+(m.s?"NaN":"-Infinity"));if(m.eq(fe))return new g(0);if(t==null?(G=!1,f=p):f=t,m.eq(10))return t==null&&(G=!0),Wt(g,f);if(f+=N,g.precision=f,n=ye(A),r=n.charAt(0),s=J(m),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(e),n=ye(m.d),r=n.charAt(0),d++;s=J(m),r>1?(m=new g("0."+n),s++):m=new g(r+"."+n.slice(1))}else return c=Wt(g,f+2,p).times(s+""),m=ht(new g(r+"."+n.slice(1)),f-N).plus(c),g.precision=p,t==null?(G=!0,F(m,p)):m;for(a=o=m=Oe(m.minus(fe),m.plus(fe),f),u=F(m.times(m),f),i=3;;){if(o=F(o.times(u),f),c=a.plus(Oe(o,new g(i),f)),ye(c.d).slice(0,f)===ye(a.d).slice(0,f))return a=a.times(2),s!==0&&(a=a.plus(Wt(g,f+2,p).times(s+""))),a=Oe(a,new g(d),f),g.precision=p,t==null?(G=!0,F(a,p)):a;a=c,i+=2}}function $n(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(r,i),t){if(i-=r,n=n-r-1,e.e=rt(n/V),e.d=[],r=(n+1)%V,n<0&&(r+=V),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=V;r<i;)e.d.push(+t.slice(r,r+=V));t=t.slice(r),r=V-t.length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),G&&(e.e>It||e.e<-It))throw Error(mn+n)}else e.s=0,e.e=0,e.d=[0];return e}function F(e,t,n){var r,i,s,o,a,c,f,u,d=e.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(r=t-o,r<0)r+=V,i=t,f=d[u=0];else{if(u=Math.ceil((r+1)/V),s=d.length,u>=s)return e;for(f=s=d[u],o=1;s>=10;s/=10)o++;r%=V,i=r-V+o}if(n!==void 0&&(s=$e(10,o-i-1),a=f/s%10|0,c=t<0||d[u+1]!==void 0||f%s,c=n<4?(a||c)&&(n==0||n==(e.s<0?3:2)):a>5||a==5&&(n==4||c||n==6&&(r>0?i>0?f/$e(10,o-i):0:d[u-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return c?(s=J(e),d.length=1,t=t-s-1,d[0]=$e(10,(V-t%V)%V),e.e=rt(-t/V)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=u,s=1,u--):(d.length=u+1,s=$e(10,V-r),d[u]=i>0?(f/$e(10,o-i)%$e(10,i)|0)*s:0),c)for(;;)if(u==0){(d[0]+=s)==ne&&(d[0]=1,++e.e);break}else{if(d[u]+=s,d[u]!=ne)break;d[u--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(G&&(e.e>It||e.e<-It))throw Error(mn+J(e));return e}function cr(e,t){var n,r,i,s,o,a,c,f,u,d,N=e.constructor,m=N.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new N(e),G?F(t,m):t;if(c=e.d,d=t.d,r=t.e,f=e.e,c=c.slice(),o=f-r,o){for(u=o<0,u?(n=c,o=-o,a=d.length):(n=d,r=f,a=c.length),i=Math.max(Math.ceil(m/V),a)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=c.length,a=d.length,u=i<a,u&&(a=i),i=0;i<a;i++)if(c[i]!=d[i]){u=c[i]<d[i];break}o=0}for(u&&(n=c,c=d,d=n,t.s=-t.s),a=c.length,i=d.length-a;i>0;--i)c[a++]=0;for(i=d.length;i>o;){if(c[--i]<d[i]){for(s=i;s&&c[--s]===0;)c[s]=ne-1;--c[s],c[i]+=ne}c[i]-=d[i]}for(;c[--a]===0;)c.pop();for(;c[0]===0;c.shift())--r;return c[0]?(t.d=c,t.e=r,G?F(t,m):t):new N(0)}function je(e,t,n){var r,i=J(e),s=ye(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Ce(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Ce(-i-1)+s,n&&(r=n-o)>0&&(s+=Ce(r))):i>=o?(s+=Ce(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+Ce(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=Ce(r))),e.s<0?"-"+s:s}function Fn(e,t){if(e.length>t)return e.length=t,!0}function lr(e){var t,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ve+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return $n(o,s.toString())}else if(typeof s!="string")throw Error(Ve+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,_i.test(s))$n(o,s);else throw Error(Ve+s)}if(i.prototype=_,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=lr,i.config=i.set=Ti,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Ti(e){if(!e||typeof e!="object")throw Error(ge+"Object expected");var t,n,r,i=["precision",1,nt,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((r=e[n=i[t]])!==void 0)if(rt(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(Ve+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ve+n+": "+r);return this}var gn=lr(Di);fe=new gn(1);const Ne=gn,X={of(e){return new Ne(e)},sum(...e){let t=new Ne(0);for(const n of e)t=t.plus(n);return t},toFormat(e,t,n,r){const i=e.toFixed(t,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[a,c]=i.split("."),f=[];for(let u=a.length;u>0;u-=s)f.unshift(a.slice(Math.max(0,u-s),u));return f.join(o)+(c?`.${c}`:"")},round(e,t,n){return X.of(e).toDecimalPlaces(t,n).toNumber()}};function Si(e){switch(e){case Y.Equal:return"==";case Y.NotEqual:return"!=";case Y.Lte:return"<=";case Y.Gte:return">=";case Y.LogicalAnd:return"&&";case Y.LogicalOr:return"||";case Y.Power:return"**";case Y.Nullish:return"??";case Y.Group:return"()";default:return String.fromCharCode(e)}}function pe(e){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(e)}function ct(e){return e==null}const it=new Map;function Ai(e,t){const n=it.get(e);if(n==null)throw new Error(`不支持的函数：${e}`);return n(...t)}function fr(){return new Error("Unexpected end of input")}function te(e){return new Error(`Unexpected end of input at position ${e.start}, near \`${Si(e.value)}\``)}function bi(e,t,n){switch(e.value){case Y.Plus:{if(e.left==null||e.right==null)throw te(e);return typeof t=="string"||typeof n=="string"?t+n:pe(t)&&pe(n)?X.of(t).plus(n).toNumber():Number.NaN}case Y.Minus:{if(e.left==null&&e.right==null)throw te(e);return e.left==null&&e.right?-n:pe(t)&&pe(n)?X.of(t).minus(n).toNumber():Number.NaN}case Y.Asterisk:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?X.of(t).times(n).toNumber():Number.NaN}case Y.Slash:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?X.of(t).div(n).toNumber():Number.NaN}case Y.Percent:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?X.of(t).mod(n).toNumber():Number.NaN}case Y.Power:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?X.of(t).pow(n).toNumber():Number.NaN}case Y.Equal:{if(e.left==null||e.right==null)throw te(e);return ct(t)&&ct(n)?!0:t===n}case Y.NotEqual:{if(e.left==null||e.right==null)throw te(e);return ct(t)&&ct(n)?!1:t!==n}case Y.Lt:{if(e.left==null||e.right==null)throw te(e);return t<n}case Y.Lte:{if(e.left==null||e.right==null)throw te(e);return t<=n}case Y.Gt:{if(e.left==null||e.right==null)throw te(e);return t>n}case Y.Gte:{if(e.left==null||e.right==null)throw te(e);return t>=n}case Y.LogicalAnd:{if(e.left==null||e.right==null)throw te(e);return t&&n}case Y.LogicalOr:{if(e.left==null||e.right==null)throw te(e);return t||n}case Y.LogicalNot:{if(e.right==null)throw te(e);return!n}case Y.Nullish:{if(e.left==null||e.right==null)throw te(e);return ct(t)?n:t}default:throw te(e)}}function Ri(e,t){const r=(e.children??[]).map(i=>{if(i!=null)return Re(i,t)});return Ai(e.value,r)}function Oi(e,t){var n;return t==null||typeof t!="object"?null:(n=t.data)==null?void 0:n[e.value]}function Mi(e,t){var n;return t==null||typeof t!="object"?null:(n=t.scope)==null?void 0:n[e.value]}function Pi(e,t){if(e.left==null||e.right==null||e.condition==null)throw fr();return Re(e.condition,t)?(e.result=Re(e.left,t),e.result):(e.result=Re(e.right,t),e.result)}function Re(e,t){switch(e.type){case we.NULL:return null;case we.UNDEFINED:return;case we.NUMBER:return Number(e.value);case we.STRING:return String(e.value);case we.TEMPLATE:{const r=(Array.isArray(e.value)?e.value:[e.value]).map(i=>Re(i,t));return e.result=r.join(""),e.result}case we.BOOLEAN:return!!e.value;case we.VARIABLE:return e.result=Oi(e,t),e.result;case we.REFERENCE:return e.result=Mi(e,t),e.result;case we.FUNCTION:return e.result=Ri(e,t),e.result;case we.OPERATOR:{if(e.isQuestion)return Pi(e,t);if(e.isGroup){if(e.right==null)throw te(e);return e.result=Re(e.right,t),e.result}const n=e.left?Re(e.left,t):null,r=e.right?Re(e.right,t):null;return e.result=bi(e,n,r),e.result}default:throw fr()}}function Ii(e,t){return Re(e,t??{})}const hr="Resolve Element Value Pending Error",dr="ElementValueError";function $(e){const t=Object.create(null);return t.state=ce.DONE,t.raw=e,t}function Je(){const e=Object.create(null);return e.state=ce.PENDING,e}function Ft(){const e=new Error(hr);return e.name=dr,e}function Ci(e){return e instanceof Error&&e.name===dr&&e.message===hr}function Li(e,t){var r;const n=typeof t=="string"?dn(t)?Ge(t):null:t;if(n==null)return $();switch(n.value){case wt.CURRENT_DATE:return $(Date.now());case wt.PAGE_NUMBER:{const i=e.doc;return i==null?$():i.isPaged?$(e.pageNum):Je()}case wt.PAGE_TOTAL:{const i=e.doc;return i==null?$():i.isPaged?$((r=e.page)==null?void 0:r.pageTotal):Je()}case wt.ROW_INDEX:{const i=e.doc;if(i==null)return $();if(i.isPaged){if(e.type!==se.TABLE_CELL)return $();const s=e.parent;return s==null?$():$(s.rowIndex)}return Je()}default:return $()}}function ki(e,t){const n=typeof t=="string"?dn(t)?Ge(t):null:t;if(n==null)return $();switch(n.value){case Ir.ELEMENT_VALUR:return e.isProcessValueDone?$(e.getRawValue()):Je();default:return $()}}function xi(e,t,n){const r=typeof t=="string"?Ge(t):t,i=e.parent;if(i==null||!i.isBindVariable)return $(Xe(n,r.value));const s=Ge(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?$():$(Xe(i.rowData,r.value)):$(Xe(n,r.value))}async function qi(e,t){const n=e.define;if(n.ds==null)return $();const r=n.ds,i=r.value;return tt(i)?$():r.type===Et.TEMPLATE?$i(e,i):r.type===Et.VARIABLE?vn(e,i,t):r.type===Et.FORMULA?pr(e,i,t):r.type===Et.CODE?Fi(e,i):$(r.value)}function vn(e,t,n,r=!1){const i=Ge(t);switch(i.varType){case Gt.DS:return e.type===se.TABLE_CELL?xi(e,i,n):e.type===se.TABLE_ROW?$(e.rowData):$(Xe(n,r?i.path:i.value));case Gt.BUILTIN:return Li(e,i);case Gt.SPECIAL:return ki(e,i);default:return $()}}function $i(e,t){return console.log("TODO: template:"+t),$()}function pr(e,t,n){try{const r=Cr.compile(t),i={data:{},scope:{}};for(const o of r.variable){const a=vn(e,o.value,n);if(a.state===ce.PENDING)return Je();Reflect.set(i.data,o.value,a.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{value:o.value,element:e});const s=Ii(r.root,i);return $(s)}catch(r){return Ci(r)?Je():(console.log(r),$())}}async function Fi(e,t){try{const r=new Function("element",`return (${t})(element)`)(e);if(r instanceof Promise){const i=await r;return $(i)}return $(r)}catch(n){return console.log(n),$()}}function Hn(){const e=document.createElement("span"),t="important";return e.style.visibility="hidden",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.zIndex="-1",e.style.setProperty("line-height","1",t),e.style.setProperty("font-family","宋体",t),e.style.setProperty("padding","0",t),e.textContent="水",e}function Hi(){const e=Hn();e.style.fontSize="6px",document.body.appendChild(e);const t=Hn();t.style.fontSize="12px",document.body.appendChild(t);const n=e.clientHeight<t.clientHeight;return document.body.removeChild(e),document.body.removeChild(t),n}let mr=function(){const e=Hi();return mr=function(){return e},e};const Ui=/Chrome/.test(navigator.userAgent);function wn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ee={},Un;function gr(){if(Un)return Ee;Un=1;var e=/^([+-])?0*(\d+)(\.(\d+))?$/,t=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=Ee.e2ten=function(i){var s=t.exec(i.toString());if(!s)return i;var o=s[2],a=s[4]||"",c=s[5]?+s[5]:0;if(c>0){var f=a.substr(0,c);f=f.length<c?f+new Array(c-f.length+1).join("0"):f,a=a.substr(c),o+=f}else{c=-c;var u=o.length-c;u=u<0?0:u;var d=o.substr(u,c);d=d.length<c?new Array(c-d.length+1).join("0")+d:d,o=o.substring(0,u),a=d+a}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(a?"."+a:"")};Ee.getNumbResult=function(i){var s=e.exec(i.toString());if(!s&&t.test(i.toString())&&(s=e.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},Ee.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var a=[].slice.call(arguments,2);a.unshift(s),i.apply(null,a)}return s};var r=Ee.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return Ee.extend=function(i){for(var s,o=arguments[0]||{},a=Array.prototype.slice.call(arguments,1),c=0;c<a.length;c++){var f=a[c];for(s in f)r(f,s)&&(o[s]=f[s])}return o},Ee.getDigit=function(i){return i>=5?(i-4)*4+4:i},Ee.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},Ee.clearZero=function(i,s,o){if(i==null)return"";var a=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,c=new RegExp("^"+a+"+"),f=new RegExp(a+"+$"),u=new RegExp(a+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(c,"")),(!o||o=="$")&&(i=i.replace(f,"")),(!o||o=="nto1")&&(i=i.replace(u,s)),i},Ee}var Zt,Bn;function Bi(){if(Bn)return Zt;Bn=1;var e=gr();function t(i,s){var o=e.getNumbResult(i);if(!o)return i;s=s||{};var a=this.ch,c=this.ch_u,f=this.ch_f||"",u=this.ch_d||".",d=a.charAt(0),N=o.int,m=o.decimal,A=o.minus,g="",p="",l=A?f:"",h=function x(C,U,q){C=e.getNumbResult(C).int;var D="",M=arguments.length>1?arguments[1]:s.tenMin,j=C.length;if(j==1)return a.charAt(+C);if(j<=4)for(var S=0,y=j;y--;){var w=+C.charAt(S);D+=M&&j==2&&S==0&&w==1?"":a.charAt(w),D+=w&&y?c.charAt(y):"",S++}else{for(var T=C.length/4>>0,E=C.length%4;E==0||!c.charAt(3+T);)E+=4,T--;var b=C.substr(0,E),R=C.substr(E);D=x(b,M)+c.charAt(3+T)+(R.charAt(0)=="0"?d:"")+x(R,R.length>4?M:!1)}return D=e.clearZero(D,d),D};if(m){m=e.clearZero(m,"0","$");for(var v=0;v<m.length;v++)p+=a.charAt(+m.charAt(v));p=p?u+p:""}if(g=h(N),s.ww&&c.length>5){var O=c.charAt(4),P=c.charAt(5),I=g.lastIndexOf(P);~I&&(g=g.substring(0,I).replace(new RegExp(P,"g"),O+O)+g.substring(I))}return l+g+p}function n(i,s){i=i.toString();var o=i.split(this.ch_d),a=o[0].replace(this.ch_f,""),c=o[1],f=!!~o[0].indexOf(this.ch_f),u=this.ch_u.charAt(1),d=this.ch_u.charAt(4),N=this.ch_u.charAt(5);a=a.replace(new RegExp(d+"{2}(?!"+d+")","g"),N);for(var m=a.split(""),A=0,g=0,p=[],l=[],h=[],v=0;v<m.length;v++){var O=m[v],P=0,I=0;if(~(P=this.ch.indexOf(O)))P>0&&h.unshift(P);else if(~(I=this.ch_u.indexOf(O))){var x=e.getDigit(I);A>I?(e.unshiftZero(h,x),e.centerArray(l,h)):I>=g?(v==0&&(h=[1]),e.centerArray(p,l,h),p.length>0&&e.unshiftZero(p,x),g=I):(h.length==0&&u==O&&(h=[1]),e.centerArray(l,h),e.unshiftZero(l,e.getDigit(I)),A=I)}}e.centerArray(p,l,h).reverse(),p.length==0&&p.push(0);var C=0;if(c){p.push("."),C="0.";for(var v=0;v<c.length;v++)C+=this.ch.indexOf(c.charAt(v)),p.push(this.ch.indexOf(c.charAt(v)));C=+C}return f&&p.unshift("-"),s&&s.outputString?p.join(""):parseFloat(p.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},a=e.getNumbResult(i),c=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!a)return i;s=e.extend(o,s);var f=a.int,u=a.decimal||"",d=s.outSymbol?this.m_t:"",N=a.minus?this.ch_f:"",m="";if(s.complete){for(var A=1;A<this.m_u.length;A++)m+=t.call(this,u.charAt(A-1)||"0")+this.m_u.charAt(A);N+=t.call(this,f,s)+this.m_u.charAt(0)}else{var g=s.unOmitYuan||f!=="0";if(u=u.substr(0,this.m_u.length-1),u=e.clearZero(u,"0","$"),u)for(var p,A=0;A<this.m_u.length-1;A++)u.charAt(A)&&u.charAt(A)!="0"&&(m+=t.call(this,u.charAt(A))+this.m_u.charAt(A+1),p=!1),u.charAt(A)==="0"&&!p&&((A!=0||f!=="0")&&(m+=c),p=!0);(g||!m)&&(N+=t.call(this,f,s)+this.m_u.charAt(0)),s.forceZheng?(m==""||m.charAt(m.length-1)!==this.m_u[2])&&(m+=this.m_z):N+=a.decimal?"":this.m_z,s.forceZheng}return d+N+m}return Zt={CL:t,unCL:n,toMoney:r},Zt}var Xt,Yn;function Yi(){if(Yn)return Xt;Yn=1;var e=Bi(),t=gr();function n(r,i){return{encodeS:function(s,o){return o=t.extend({ww:!0,tenMin:!0},o),e.CL.call(r,s,o)},encodeB:function(s,o){return o=t.extend({ww:!0},o),e.CL.call(i,s,o)},decodeS:function(){return e.unCL.apply(r,arguments)},decodeB:function(){return e.unCL.apply(i,arguments)},toMoney:function(s,o){return o=t.extend({ww:!0},o),e.toMoney.call(i,s,o)}}}return Xt=n,Xt}var Kt,Vn;function Vi(){return Vn||(Vn=1,Kt={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),Kt}var Jt,Gn;function Gi(){return Gn||(Gn=1,Jt={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),Jt}var Qt,zn;function zi(){if(zn)return Qt;zn=1;var e=Yi(),t={s:Vi(),b:Gi()};return Qt=e(t.s,t.b),Qt}var ji=zi();const Wi=wn(ji);var At={exports:{}},Zi=At.exports,jn;function Xi(){return jn||(jn=1,function(e,t){(function(n,r){e.exports=r()})(Zi,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",a="minute",c="hour",f="day",u="week",d="month",N="quarter",m="year",A="date",g="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,l=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,h={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(S){var y=["th","st","nd","rd"],w=S%100;return"["+S+(y[(w-20)%10]||y[w]||y[0])+"]"}},v=function(S,y,w){var T=String(S);return!T||T.length>=y?S:""+Array(y+1-T.length).join(w)+S},O={s:v,z:function(S){var y=-S.utcOffset(),w=Math.abs(y),T=Math.floor(w/60),E=w%60;return(y<=0?"+":"-")+v(T,2,"0")+":"+v(E,2,"0")},m:function S(y,w){if(y.date()<w.date())return-S(w,y);var T=12*(w.year()-y.year())+(w.month()-y.month()),E=y.clone().add(T,d),b=w-E<0,R=y.clone().add(T+(b?-1:1),d);return+(-(T+(w-E)/(b?E-R:R-E))||0)},a:function(S){return S<0?Math.ceil(S)||0:Math.floor(S)},p:function(S){return{M:d,y:m,w:u,d:f,D:A,h:c,m:a,s:o,ms:s,Q:N}[S]||String(S||"").toLowerCase().replace(/s$/,"")},u:function(S){return S===void 0}},P="en",I={};I[P]=h;var x="$isDayjsObject",C=function(S){return S instanceof M||!(!S||!S[x])},U=function S(y,w,T){var E;if(!y)return P;if(typeof y=="string"){var b=y.toLowerCase();I[b]&&(E=b),w&&(I[b]=w,E=b);var R=y.split("-");if(!E&&R.length>1)return S(R[0])}else{var k=y.name;I[k]=y,E=k}return!T&&E&&(P=E),E||!T&&P},q=function(S,y){if(C(S))return S.clone();var w=typeof y=="object"?y:{};return w.date=S,w.args=arguments,new M(w)},D=O;D.l=U,D.i=C,D.w=function(S,y){return q(S,{locale:y.$L,utc:y.$u,x:y.$x,$offset:y.$offset})};var M=function(){function S(w){this.$L=U(w.locale,null,!0),this.parse(w),this.$x=this.$x||w.x||{},this[x]=!0}var y=S.prototype;return y.parse=function(w){this.$d=function(T){var E=T.date,b=T.utc;if(E===null)return new Date(NaN);if(D.u(E))return new Date;if(E instanceof Date)return new Date(E);if(typeof E=="string"&&!/Z$/i.test(E)){var R=E.match(p);if(R){var k=R[2]-1||0,B=(R[7]||"0").substring(0,3);return b?new Date(Date.UTC(R[1],k,R[3]||1,R[4]||0,R[5]||0,R[6]||0,B)):new Date(R[1],k,R[3]||1,R[4]||0,R[5]||0,R[6]||0,B)}}return new Date(E)}(w),this.init()},y.init=function(){var w=this.$d;this.$y=w.getFullYear(),this.$M=w.getMonth(),this.$D=w.getDate(),this.$W=w.getDay(),this.$H=w.getHours(),this.$m=w.getMinutes(),this.$s=w.getSeconds(),this.$ms=w.getMilliseconds()},y.$utils=function(){return D},y.isValid=function(){return this.$d.toString()!==g},y.isSame=function(w,T){var E=q(w);return this.startOf(T)<=E&&E<=this.endOf(T)},y.isAfter=function(w,T){return q(w)<this.startOf(T)},y.isBefore=function(w,T){return this.endOf(T)<q(w)},y.$g=function(w,T,E){return D.u(w)?this[T]:this.set(E,w)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(w,T){var E=this,b=!!D.u(T)||T,R=D.p(w),k=function(ve,re){var he=D.w(E.$u?Date.UTC(E.$y,re,ve):new Date(E.$y,re,ve),E);return b?he:he.endOf(f)},B=function(ve,re){return D.w(E.toDate()[ve].apply(E.toDate("s"),(b?[0,0,0,0]:[23,59,59,999]).slice(re)),E)},z=this.$W,ee=this.$M,oe=this.$D,Pe="set"+(this.$u?"UTC":"");switch(R){case m:return b?k(1,0):k(31,11);case d:return b?k(1,ee):k(0,ee+1);case u:var _e=this.$locale().weekStart||0,qe=(z<_e?z+7:z)-_e;return k(b?oe-qe:oe+(6-qe),ee);case f:case A:return B(Pe+"Hours",0);case c:return B(Pe+"Minutes",1);case a:return B(Pe+"Seconds",2);case o:return B(Pe+"Milliseconds",3);default:return this.clone()}},y.endOf=function(w){return this.startOf(w,!1)},y.$set=function(w,T){var E,b=D.p(w),R="set"+(this.$u?"UTC":""),k=(E={},E[f]=R+"Date",E[A]=R+"Date",E[d]=R+"Month",E[m]=R+"FullYear",E[c]=R+"Hours",E[a]=R+"Minutes",E[o]=R+"Seconds",E[s]=R+"Milliseconds",E)[b],B=b===f?this.$D+(T-this.$W):T;if(b===d||b===m){var z=this.clone().set(A,1);z.$d[k](B),z.init(),this.$d=z.set(A,Math.min(this.$D,z.daysInMonth())).$d}else k&&this.$d[k](B);return this.init(),this},y.set=function(w,T){return this.clone().$set(w,T)},y.get=function(w){return this[D.p(w)]()},y.add=function(w,T){var E,b=this;w=Number(w);var R=D.p(T),k=function(ee){var oe=q(b);return D.w(oe.date(oe.date()+Math.round(ee*w)),b)};if(R===d)return this.set(d,this.$M+w);if(R===m)return this.set(m,this.$y+w);if(R===f)return k(1);if(R===u)return k(7);var B=(E={},E[a]=r,E[c]=i,E[o]=n,E)[R]||1,z=this.$d.getTime()+w*B;return D.w(z,this)},y.subtract=function(w,T){return this.add(-1*w,T)},y.format=function(w){var T=this,E=this.$locale();if(!this.isValid())return E.invalidDate||g;var b=w||"YYYY-MM-DDTHH:mm:ssZ",R=D.z(this),k=this.$H,B=this.$m,z=this.$M,ee=E.weekdays,oe=E.months,Pe=E.meridiem,_e=function(re,he,Te,Ie){return re&&(re[he]||re(T,b))||Te[he].slice(0,Ie)},qe=function(re){return D.s(k%12||12,re,"0")},ve=Pe||function(re,he,Te){var Ie=re<12?"AM":"PM";return Te?Ie.toLowerCase():Ie};return b.replace(l,function(re,he){return he||function(Te){switch(Te){case"YY":return String(T.$y).slice(-2);case"YYYY":return D.s(T.$y,4,"0");case"M":return z+1;case"MM":return D.s(z+1,2,"0");case"MMM":return _e(E.monthsShort,z,oe,3);case"MMMM":return _e(oe,z);case"D":return T.$D;case"DD":return D.s(T.$D,2,"0");case"d":return String(T.$W);case"dd":return _e(E.weekdaysMin,T.$W,ee,2);case"ddd":return _e(E.weekdaysShort,T.$W,ee,3);case"dddd":return ee[T.$W];case"H":return String(k);case"HH":return D.s(k,2,"0");case"h":return qe(1);case"hh":return qe(2);case"a":return ve(k,B,!0);case"A":return ve(k,B,!1);case"m":return String(B);case"mm":return D.s(B,2,"0");case"s":return String(T.$s);case"ss":return D.s(T.$s,2,"0");case"SSS":return D.s(T.$ms,3,"0");case"Z":return R}return null}(re)||R.replace(":","")})},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(w,T,E){var b,R=this,k=D.p(T),B=q(w),z=(B.utcOffset()-this.utcOffset())*r,ee=this-B,oe=function(){return D.m(R,B)};switch(k){case m:b=oe()/12;break;case d:b=oe();break;case N:b=oe()/3;break;case u:b=(ee-z)/6048e5;break;case f:b=(ee-z)/864e5;break;case c:b=ee/i;break;case a:b=ee/r;break;case o:b=ee/n;break;default:b=ee}return E?b:D.a(b)},y.daysInMonth=function(){return this.endOf(d).$D},y.$locale=function(){return I[this.$L]},y.locale=function(w,T){if(!w)return this.$L;var E=this.clone(),b=U(w,T,!0);return b&&(E.$L=b),E},y.clone=function(){return D.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},S}(),j=M.prototype;return q.prototype=j,[["$ms",s],["$s",o],["$m",a],["$H",c],["$W",f],["$M",d],["$y",m],["$D",A]].forEach(function(S){j[S[1]]=function(y){return this.$g(y,S[0],S[1])}}),q.extend=function(S,y){return S.$i||(S(y,M,q),S.$i=!0),q},q.locale=U,q.isDayjs=C,q.unix=function(S){return q(1e3*S)},q.en=I[P],q.Ls=I,q.p={},q})}(At)),At.exports}var Ki=Xi();const Me=wn(Ki);var bt={exports:{}},Ji=bt.exports,Wn;function Qi(){return Wn||(Wn=1,function(e,t){(function(n,r){e.exports=r()})(Ji,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,c={},f=function(p){return(p=+p)+(p>68?1900:2e3)},u=function(p){return function(l){this[p]=+l}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(p){(this.zone||(this.zone={})).offset=function(l){if(!l||l==="Z")return 0;var h=l.match(/([+-]|\d\d)/g),v=60*h[1]+(+h[2]||0);return v===0?0:h[0]==="+"?-v:v}(p)}],N=function(p){var l=c[p];return l&&(l.indexOf?l:l.s.concat(l.f))},m=function(p,l){var h,v=c.meridiem;if(v){for(var O=1;O<=24;O+=1)if(p.indexOf(v(O,0,l))>-1){h=O>12;break}}else h=p===(l?"pm":"PM");return h},A={A:[a,function(p){this.afternoon=m(p,!1)}],a:[a,function(p){this.afternoon=m(p,!0)}],Q:[i,function(p){this.month=3*(p-1)+1}],S:[i,function(p){this.milliseconds=100*+p}],SS:[s,function(p){this.milliseconds=10*+p}],SSS:[/\d{3}/,function(p){this.milliseconds=+p}],s:[o,u("seconds")],ss:[o,u("seconds")],m:[o,u("minutes")],mm:[o,u("minutes")],H:[o,u("hours")],h:[o,u("hours")],HH:[o,u("hours")],hh:[o,u("hours")],D:[o,u("day")],DD:[s,u("day")],Do:[a,function(p){var l=c.ordinal,h=p.match(/\d+/);if(this.day=h[0],l)for(var v=1;v<=31;v+=1)l(v).replace(/\[|\]/g,"")===p&&(this.day=v)}],w:[o,u("week")],ww:[s,u("week")],M:[o,u("month")],MM:[s,u("month")],MMM:[a,function(p){var l=N("months"),h=(N("monthsShort")||l.map(function(v){return v.slice(0,3)})).indexOf(p)+1;if(h<1)throw new Error;this.month=h%12||h}],MMMM:[a,function(p){var l=N("months").indexOf(p)+1;if(l<1)throw new Error;this.month=l%12||l}],Y:[/[+-]?\d+/,u("year")],YY:[s,function(p){this.year=f(p)}],YYYY:[/\d{4}/,u("year")],Z:d,ZZ:d};function g(p){var l,h;l=p,h=c&&c.formats;for(var v=(p=l.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(q,D,M){var j=M&&M.toUpperCase();return D||h[M]||n[M]||h[j].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(S,y,w){return y||w.slice(1)})})).match(r),O=v.length,P=0;P<O;P+=1){var I=v[P],x=A[I],C=x&&x[0],U=x&&x[1];v[P]=U?{regex:C,parser:U}:I.replace(/^\[|\]$/g,"")}return function(q){for(var D={},M=0,j=0;M<O;M+=1){var S=v[M];if(typeof S=="string")j+=S.length;else{var y=S.regex,w=S.parser,T=q.slice(j),E=y.exec(T)[0];w.call(D,E),q=q.replace(E,"")}}return function(b){var R=b.afternoon;if(R!==void 0){var k=b.hours;R?k<12&&(b.hours+=12):k===12&&(b.hours=0),delete b.afternoon}}(D),D}}return function(p,l,h){h.p.customParseFormat=!0,p&&p.parseTwoDigitYear&&(f=p.parseTwoDigitYear);var v=l.prototype,O=v.parse;v.parse=function(P){var I=P.date,x=P.utc,C=P.args;this.$u=x;var U=C[1];if(typeof U=="string"){var q=C[2]===!0,D=C[3]===!0,M=q||D,j=C[2];D&&(j=C[2]),c=this.$locale(),!q&&j&&(c=h.Ls[j]),this.$d=function(T,E,b,R){try{if(["x","X"].indexOf(E)>-1)return new Date((E==="X"?1e3:1)*T);var k=g(E)(T),B=k.year,z=k.month,ee=k.day,oe=k.hours,Pe=k.minutes,_e=k.seconds,qe=k.milliseconds,ve=k.zone,re=k.week,he=new Date,Te=ee||(B||z?1:he.getDate()),Ie=B||he.getFullYear(),gt=0;B&&!z||(gt=z>0?z-1:he.getMonth());var vt,Ht=oe||0,Ut=Pe||0,Bt=_e||0,Yt=qe||0;return ve?new Date(Date.UTC(Ie,gt,Te,Ht,Ut,Bt,Yt+60*ve.offset*1e3)):b?new Date(Date.UTC(Ie,gt,Te,Ht,Ut,Bt,Yt)):(vt=new Date(Ie,gt,Te,Ht,Ut,Bt,Yt),re&&(vt=R(vt).week(re).toDate()),vt)}catch{return new Date("")}}(I,U,x,h),this.init(),j&&j!==!0&&(this.$L=this.locale(j).$L),M&&I!=this.format(U)&&(this.$d=new Date("")),c={}}else if(U instanceof Array)for(var S=U.length,y=1;y<=S;y+=1){C[1]=U[y-1];var w=h.apply(this,C);if(w.isValid()){this.$d=w.$d,this.$L=w.$L,this.init();break}y===S&&(this.$d=new Date(""))}else O.call(this,P)}}})}(bt)),bt.exports}var es=Qi();const ts=wn(es);Me.extend(ts);function ns(e){switch(e){case zt.FLOOR:return Ne.ROUND_FLOOR;case zt.CEIL:return Ne.ROUND_CEIL;case zt.BANKER_ROUND:return Ne.ROUND_HALF_EVEN;default:return Ne.ROUND_HALF_UP}}function rs(e,t){if(e==null)return"";const n=t.format,r=ns(t.round),i=t.showZero===!1;switch(n){case at.FIXED:{const s=t.precision;if(s==null||s<0)return e.toString();const o=typeof e=="number"?X.of(e):e;return o.eq(0)&&i?"":o.toFixed(s,r)}case at.THOUSAND:{const s=typeof e=="number"?X.of(e):e;return s.eq(0)&&i?"":X.toFormat(s,2,r,{groupSize:3})}case at.TEN_THOUSAND:{const s=typeof e=="number"?X.of(e):e;return s.eq(0)&&i?"":X.toFormat(s,2,r,{groupSize:4})}case at.DAXIE:{const s=typeof e=="number"?X.of(e):e;return s.eq(0)&&i?"":Wi.toMoney(s.toFixed(2,r),{outSymbol:!1})}case at.PERCENTAGE:{const s=typeof e=="number"?X.of(e):e;if(s.eq(0)&&i)return"";const o=t.precision??2;return s.times(100).toFixed(o,Ne.ROUND_HALF_UP)+"%"}default:return typeof e=="number"?e==0&&i?"":e.toString():e.eq(0)&&i?"":e.toString()}}function is(e,t){const n=t.format;return n==null?e:Me(e).format(n)}function ss(e,t){const n=e.attributes;switch(e.display){case se.NUMBER:return rs(t,n);case se.DATE:return is(t,n);default:return t}}const Zn=Object.create(null);var xt,Qe;const ft=class ft{constructor(t){de(this,xt,fn(hn.PRINT_ELEMENT));de(this,Qe,Object.create(null));L(this,"define");L(this,"children",[]);L(this,"atomized",!1);L(this,"extra",!1);L(this,"parent");L(this,"offsetTop",0);L(this,"offsetLeft",0);L(this,"offsetWidth",0);L(this,"offsetHeight",0);L(this,"element");L(this,"zIndex");L(this,"state",on.CREATED);L(this,"visibility",Se.PENDING);L(this,"value",{state:ce.UNDEFINED});this.define=t,this.offsetTop=t.offsetTop,this.offsetLeft=t.offsetLeft,this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.zIndex=t.zIndex,Be(this,"parent",null),Be(this,"element",null)}static register(t,n){Zn[t]=n}static create(t){const n=Zn[t.type]??ft;return new n(t)}static isPrintElement(t){return t instanceof ft}get id(){return"@"+H(this,xt)}get type(){return this.define.type}get page(){let t=this.parent;for(;t;){if(t instanceof Pt)return t;t=t.parent}return null}get doc(){var t;return(t=this.page)==null?void 0:t.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const t=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return t+n}get pageNum(){var t;return((t=this.page)==null?void 0:t.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const t=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${t}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===_t.AUTO}get isOverflowScale(){return this.define.attributes.overflow===_t.SCALE}get isOverflowHidden(){const t=this.define.attributes.overflow;return t==null||t===_t.HIDDEN}get isProcessValueDone(){return this.value.state===ce.DONE}get isUndefinedValue(){return this.value.state===ce.UNDEFINED}get isHidden(){return this.visibility===Se.HIDDEN}async processValue(){var t,n,r;if(!this.isProcessValueDone)switch(this.value=await qi(this,(t=this.doc)==null?void 0:t.data),this.value.state){case ce.DONE:(n=this.doc)==null||n.removeDependency(this);break;case ce.PENDING:(r=this.doc)==null||r.addDependency(this,{state:ce.PENDING});break}}getRawValue(){if(this.value.state===ce.DONE)return this.value.raw}format(){return ss(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(t=>t.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const t=this.content;return Lr(t)?null:K("div",{class:"quickprint-content",children:K("span",{children:this.content})})}async updateElement(){const t=this.parent;if(t==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await t.replaceChild(this,n)}async mountChild(t){var n;return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),await ze(),await t.mount(t.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(t,n){var r;return this.element==null||t.element==null?!1:(n==null?this.element.removeChild(t.element):this.element.replaceChild(n,t.element),await ze(),await t.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(t){t!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.state=on.MOUNDTED,this.element=t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),H(this,Qe)[t.id]=t}clone(){const t=ft.create(this.define),n=this.children.map(r=>r.clone());return t.appendMany(n),t}checkOverflow(){if(this.element==null)return!1;const t=this.element.querySelector(".quickprint-content");if(t==null)return!1;const n=t.parentElement;return n==null?!1:n.offsetHeight<t.offsetHeight}processOverflow(){return this.isOverflowScale?mr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const t=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return t==null||(t.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(t){const n=H(this,Qe)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}findElementFromDefine(t){return this.children.find(n=>n.define.id===t)}createElements(){st(this,Qe,this.children.reduce((t,n)=>(t[n.id]=n,t),Object.create(null)))}checkVisibility(){var i,s,o;const t=this.define;if(t.visibility==null||t.visibility.type===On.VISIBLE)return Se.VISIBLE;if(t.visibility.type===On.HIDDEN)return Se.HIDDEN;const n=t.visibility.condition;if(tt(n))return Se.VISIBLE;const r=pr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case ce.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Se.VISIBLE:Se.HIDDEN;case ce.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:ce.PENDING}),Se.PENDING;default:return Se.PENDING}}};xt=new WeakMap,Qe=new WeakMap;let W=ft;function yt(e,t){return t.exclude==null?!0:!t.exclude.includes(e)}function mt(e){var s;const t={};if(!Ui)return t;const n=e.define,r=n.style.fontFamily;return(r==null||r===kr.SONG)&&((s=n.style)==null?void 0:s.fontWeight)===700&&(t["quickprint-patch-song-blod"]=!0),t}function En(e,t={}){const n={},r=e.define.style??{},i=er(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=xr(r);return s&&Ze(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),Ze(n,qr(e.define)),Ze(n,$r(e.define)),Ze(n,Fr(e.define)),Ze(n,Hr(e.define)),n}function yn(e,t={}){const n={};if(yt("top",t)&&(n.top=e.offsetTop+"px"),yt("left",t)&&(n.left=e.offsetLeft+"px"),yt("width",t)&&(n.width=e.offsetWidth+"px"),yt("height",t)){const r=e.define.attributes.overflow===_t.AUTO?"min-height":"height";n[r]=e.offsetHeight+"px"}return e.zIndex&&(n.zIndex=e.zIndex),n}function Nn(e,t={}){return pn(yn(e,t),En(e,t),nn(e.define))}class os extends W{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:K("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class as extends W{get style(){return yn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...mt(this)}}processConstNode(t){var i;const n=t.dataset.value;if(tt(n))return;const r=vn(this,n,(i=this.doc)==null?void 0:i.data);t.textContent=r.raw}process(t){for(const n of Array.from(t.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return t}render(){if(this.isHidden)return null;const t=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=t,K("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class us extends W{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:K("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class cs extends W{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:K("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class vr extends W{constructor(){super(...arguments);L(this,"rendering",0)}get style(){return{...pn(yn(this),En(this)),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>K("col",{width:s}));return K("div",{id:this.id,class:this.className,style:this.style,children:K("table",{children:[K("colgroup",{children:i}),K("tbody",{})]})})}async mountChild(n){var i;if(n.element==null)return!1;const r=this.getTableBody();return r==null?!1:(r.appendChild(n.element),await ze(),await n.mount(n.element),this.offsetHeight=((i=this.element)==null?void 0:i.offsetHeight)??0,!0)}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await ze(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n+1),i=this.getTableBody();if(this.children.length=n+1,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class ls extends W{constructor(){super(...arguments);L(this,"repeatGroup");L(this,"rowData");L(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return K("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=on.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}}function fs(){return null}class Dn extends W{get style(){var r;const t=nn((r=this.define.parent)==null?void 0:r.parent),n=nn(this.define);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-height":this.offsetHeight+"px",...Ze(t,n)}}get className(){const t=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(t==null?void 0:t.isOverflowAuto)===!0,"quickprint-fixed-height":(t==null?void 0:t.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}createContentStyle(){const t=[];let n=this;for(;W.isPrintElement(n);)t.unshift(En(n)),n=n.parent;return pn({},...t)}render(){if(this.define.isCollapsed)return null;const t=this.define,n=this.isHidden?null:K("div",{class:"quickprint-layout",style:this.createContentStyle(),children:[this.createContent(),K(fs,{})]});return K("td",{id:this.id,class:this.className,style:this.style,rowspan:t.rowspan,colspan:t.colspan,children:n})}}W.register(se.TEXT,os);W.register(se.PARAGRAPH,as);W.register(se.NUMBER,us);W.register(se.DATE,cs);W.register(se.TABLE,vr);W.register(se.TABLE_ROW,ls);W.register(se.TABLE_CELL,Dn);function hs(e){return Number(e)}function ds(e){return Math.abs(e)}function ps(e){return Math.trunc(e)}function ms(...e){return Math.min(...e)}function gs(...e){return Math.max(...e)}function vs(e,t){return X.round(e,t??0,Ne.ROUND_CEIL)}function ws(e,t){return X.round(e,t??0,Ne.ROUND_FLOOR)}function Es(e,t,n){return X.round(e,t??0,n??Ne.ROUND_HALF_UP)}function ys(e){e.set("NUMBER",hs),e.set("ABS",ds),e.set("TRUNC",ps),e.set("MIN",ms),e.set("MAX",gs),e.set("CEIL",vs),e.set("FLOOR",ws),e.set("ROUND",Es)}function Ns(e){return String(e)}function Ds(e){return String(e).length}function _s(e){return String(e).toLowerCase()}function Ts(e){return String(e).toUpperCase()}function Ss(e){const t=String(e);return t[0].toUpperCase()+t.slice(1)}function As(e){return String(e).trim()}function bs(e,t,n){return String(e).replace(t,n)}function Rs(e,t,n){return String(e).replaceAll(t,n)}function Os(e,t,n){return String(e).slice(t,n)}function Ms(e,t,n){return String(e).includes(String(t),n)}function Ps(e,t,n){return String(e).indexOf(String(t),n)}function Is(e,t,n){return String(e).lastIndexOf(String(t),n)}function Cs(e,t,n){return String(e).startsWith(String(t),n)}function Ls(e,t,n){return String(e).endsWith(String(t),n)}function ks(e){e.set("STRING",Ns),e.set("LENGTH",Ds),e.set("LOWER",_s),e.set("UPPER",Ts),e.set("TRIM",As),e.set("UPPER_FIRST",Ss),e.set("REPLACE",bs),e.set("REPLACE_ALL",Rs),e.set("SLICE",Os),e.set("INCLUDES",Ms),e.set("INDEX_OF",Ps),e.set("LAST_INDEX_OF",Is),e.set("STARTS_WITH",Cs),e.set("ENDS_WITH",Ls)}function xs(e,t,n){return e?t:n}function qs(e,t){return Number.isNaN(e)?t:e}function $s(e,t){return Number.isNaN(e)||e==null?t:e}function Fs(e,...t){for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];if(i===e)return s}return t.length%2===0?void 0:t[t.length-1]}function wr(e){return Number.isNaN(e)}function Hs(e){return Number.isInteger(e)}function Er(e){return typeof e=="number"}function yr(e){return typeof e=="string"}function Us(e){return typeof e=="boolean"}function Nr(e){return e===null}function Dr(e){return e===void 0}function _r(e){return Nr(e)||Dr(e)}function Bs(e){return _r(e)?!0:yr(e)?e.length==0:Er(e)?!wr(e):!1}function Ys(e){e.set("IF",xs),e.set("IFNA",qs),e.set("IFERROR",$s),e.set("IS_NAN",wr),e.set("IS_INTEGER",Hs),e.set("IS_NUMBER",Er),e.set("IS_STRING",yr),e.set("IS_BOOLEAN",Us),e.set("IS_NULL",Nr),e.set("IS_UNDEFINED",Dr),e.set("IS_NULLISH",_r),e.set("IS_EMPTY",Bs),e.set("SWITCH",Fs)}const Vs=[ae.YEAR_MONTH,ae.YEAR_MONTH_CHS,ae.YEAR_MONTH_DAY,ae.YEAR_MONTH_DAY_CHS,ae.DATETIME_SHORT,ae.DATETIME_SHORT_CHS,ae.DATETIME,ae.DATETIME_CHS,ae.TIME,ae.TIME_SHORT,ae.YEAR,ae.MONTH,ae.DAY];function ke(e){if(e!=null){if(typeof e=="number")return Vs[e];if(typeof e=="string")return e}}function Tr(e,t,n){return e===null&&(e=void 0),Me(e,ke(n)).format(ke(t)??ae.DATETIME)}function Gs(e){return Tr(void 0,e)}function zs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).year()}function js(e,t){return e===null&&(e=void 0),Me(e,ke(t)).month()+1}function Ws(e,t){return e===null&&(e=void 0),Me(e,ke(t)).date()}function Zs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).hour()}function Xs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).minute()}function Ks(e,t){return e===null&&(e=void 0),Me(e,ke(t)).second()}function Js(e){e.set("DATE",Tr),e.set("NOW",Gs),e.set("YEAR",zs),e.set("MONTH",js),e.set("DAY",Ws),e.set("HOUR",Zs),e.set("MINUTE",Xs),e.set("SECOND",Ks)}function Sr(e,t){return e.children.reduce((n,r)=>{const i=r.findElementFromDefine(t);if(i==null)return n;if(!i.isProcessValueDone)throw Ft();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(Ur(o)?o:0),n},[])}function _n(e,t){var r;const n=(r=e.parent)==null?void 0:r.parent;if(!(n==null||n.type!==se.TABLE))return Sr(n,t)}function Tn(e,t){var i,s;const n=(i=e.parent)==null?void 0:i.parent;if(n==null||n.type!==se.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,a)=>o.concat(a.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,a)=>o.concat(Sr(a,t)),[])}function Qs(e,t){if(!e.doc.isPaged)throw Ft();const r=e.page,i=r.pageNum<r.pageTotal?_n(e,t):Tn(e,t);return i==null||i.length==0?0:X.sum(...i).toNumber()}function eo(e,t){const n=e.element,r=e.value;if(!(n instanceof Dn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();if(t===2)return Qs(n,r);const s=t==1?_n(n,r):Tn(n,r);return s==null||s.length==0?0:X.sum(...s).toNumber()}function to(e,t){const n=e.element,r=e.value;if(!(n instanceof Dn))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();const s=t==1?_n(n,r):Tn(n,r);return s==null||s.length==0?0:X.sum(...s).div(s.length).toNumber()}function no(e){e.set("COL_SUM",eo),e.set("COL_AVG",to)}ys(it);ks(it);Ys(it);Js(it);no(it);const ro=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-line;min-width:100%}.quickprint-content>span{background-color:var(--quickprint-variable-highlight-color, transparent)}",io="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none!important}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song-blod{text-shadow:0 0 currentColor,0 0 currentColor}}";function Xn(){return ro}function so(){return io}var qt,et,dt,Fe,He,Ue,xe,cn,ln;const An=class An{constructor(t,n){de(this,xe);de(this,qt,fn(hn.PRINT_DOCUMENT));de(this,et);de(this,dt);de(this,Fe,Object.create(null));de(this,He,0);L(this,"define");L(this,"data");L(this,"state");L(this,"pages",[]);L(this,"element");L(this,"rendering");L(this,"renderState",le.CREATED);L(this,"devicePixelRatio",window.devicePixelRatio);de(this,Ue,[]);const{promise:r,resolve:i}=Promise.withResolvers();st(this,dt,r),st(this,et,i),this.define=t,this.state=n,Be(this,"element",null),Be(this,"rendering",0),this.state.renderState=le.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(t,n={}){const r=t instanceof rn?t:rn.create(t);return new An(r,n)}get id(){return"@"+H(this,qt)}get style(){const t=this.state.scale??100,n=this.define.style;return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":t/100,"--quickprint-paper-width":this.define.paper.width+"mm","--quickprint-paper-height":`calc(${this.define.paper.height}mm - 1px)`,fontFamily:er(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get isPaged(){return this.renderState===le.PAGED||this.renderState===le.READY}get isFirstRount(){return H(this,He)===0}onCreated(){return Promise.allSettled(this.pages.map(t=>t.onCreated()))}onBeforeUnmount(t){H(this,Ue).indexOf(t)>=0||H(this,Ue).push(t)}unmount(){for(const t of H(this,Ue))typeof t=="function"&&t();H(this,Ue).length=0,this.renderState=le.UNMOUNT,this.element=null}render(){return K("div",{class:Ae.DOCUMENT,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(t){return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),!0)}async mount(){this.state.total=this.pages.length,this.refreshPageTotal(),ot(this,xe,ln).call(this,le.PAGED),await ot(this,xe,cn).call(this),ot(this,xe,ln).call(this,le.READY);const t=this.pages.map(n=>n.onFinshed());await Promise.allSettled(t),typeof H(this,et)=="function"&&(H(this,et).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(t){this.pages.push(t),t.setParent(this)}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}insert(t,n){this.pages.splice(n,0,t),t.setParent(this)}ready(){return H(this,dt)}injectElementStyle(){const t=document.createElement("style");t.textContent=Xn(),document.head.appendChild(t)}async print(){return await this.ready(),new Promise(t=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),t()})})}genPapeStyle(){const t=this.define;return`@page{ size: ${t.paper.width}mm ${t.paper.height}mm }`}genPrintHtml(){var r;const t=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${t}</title>`,`<style>${Xn()}</style>`,`<style>${so()}</style>`,`<style>${this.genPapeStyle()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const t=this.state.scale??100,n=ut.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=ut[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const t=this.state.scale??100,n=ut.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n>=ut.length-1)return!1;const r=ut[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const t=100;this.state.scale=t,this.element.style.setProperty("--quickprint-doc-scale",`${t/100}`)}addDependency(t,n){H(this,Fe)[t.id]={element:t,...n}}removeDependency(t){delete H(this,Fe)[t.id]}watchDevicePixelRatio(){const t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);t.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{t.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}debug(){var t;this.state.debug=!0,(t=this.element)==null||t.classList.add("quickprint-document-debug")}toggleDebug(){var t;this.state.debug=this.state.debug!==!0,(t=this.element)==null||t.classList.toggle("quickprint-document-debug")}findElement(t){for(const n of this.pages){const r=n.findElement(t);if(r)return r}}refreshPageTotal(){const t={};for(const n of this.pages){const r=n.file;if(t[r]!=null){n.pageTotal=t[r];continue}const i=this.pages.filter(s=>s.file===r);t[r]=i.length,n.pageTotal=i.length}}};qt=new WeakMap,et=new WeakMap,dt=new WeakMap,Fe=new WeakMap,He=new WeakMap,Ue=new WeakMap,xe=new WeakSet,cn=async function(){for(const n of Object.values(H(this,Fe))){const r=n.element;await r.processValue(),r.isProcessValueDone&&(this.removeDependency(r),await r.updateElement())}if(Object.keys(H(this,Fe)).length==0){Br.debug("Document",`已完成第计算, 共${H(this,He)+1}轮`);return}Rn(this,He)._++,!(H(this,He)>=100)&&await ot(this,xe,cn).call(this)},ln=function(t){this.renderState=t,this.state.renderState=t};let Ct=An;function lt(e){const t=W.create(e),n=e.children.map(r=>W.create(r));return t.appendMany(n),t}async function oo(e,t={}){const n=e.define.pages.map(u=>r(u));e.data=t,e.appendMany(n),await e.onCreated(),e.renderState=le.RENDERING,e.state.renderState=le.RENDERING;function r(u){const d=Pt.create(u,e.define.paper);i(d);for(const N of d.defines){const m=o(N);m.define.isFixed?d.appendToFixed(m):d.append(m)}return s(d),d.state=Tt.INIT,d}function i(u){if(!(u.header.display!=!0||u.header.defines.length==0))for(const d of u.header.defines)u.appendToHeader(o(d))}function s(u){if(!(u.footer.display!=!0||u.footer.defines.length==0))for(const d of u.footer.defines)u.appendToFooter(o(d))}function o(u){switch(u.type){case"Table":return a(u);default:return W.create(u)}}function a(u){let d=0;const N=W.create(u),m=u.children;for(;d<m.length;){const A=m[d];if(A.isRepeat&&A.rowspan>1){const g=c(u,d);N.appendMany(g.rows),d=g.next;continue}if(A.isRepeat){N.appendMany(f(A)),d++;continue}N.append(lt(A)),d++}return N}function c(u,d){const N=u.children[d],m=u.children.slice(d,d+N.rowspan),A=Ge(N.ds.value),g=Mn(Xe(t,A.value)),p=[];for(let l=0;l<g.length;l++){const h=`${N.id}_${l}`;for(const v of m){const O=lt(v);O.repeatGroup=h,O.rowData=g[l],p.push(O)}}return{rows:p,next:d+N.rowspan}}function f(u){const d=Ge(u.ds.value),N=Xe(t,d.value);return Mn(N).map(m=>{const A=lt(u);return A.rowData=m,A})}return e}function ao(e,t,n){let r=null,i=1;async function s(){const l=t.rendering,h=t.pages[l];return h==null?t.mount():(h.beginPaging(),h.createElement()==null?(t.rendering+=1,s()):(await t.mountChild(h),await a(h),await c(h),h.file!==r&&(i=1),h.pageNum=i++,await h.onPaged(),t.rendering+=1,t.state.total=t.pages.length,s()))}function o(l,h){const v=l.children[l.rendering-1];return v==null?l.extra?l.header.offsetHeight+4:h.offsetTop:!v.isChanged||tn.isIsolated(v.define,h.define)?h.offsetTop:v.offsetBottom+h.define.top-v.define.top-v.define.height}async function a(l){const h=l.children[l.rendering];return h==null?void 0:(h.offsetTop=o(l,h),h.createElement()==null?(l.rendering+=1,a(l)):(await f(l,h),l.rendering+=1,a(l)))}async function c(l){for(const h of l.fixed)h.createElement(),await l.mountChild(h)}function f(l,h){switch(h.define.type){case se.TABLE:return A(l,h);case se.TEXT:return g(l,h);default:return p(l,h)}}async function u(l,h){const v=h.children[h.rendering];if(v==null)return;if(v.extra&&v.isUndefinedValue&&await v.onCreated(),v.createElement()==null)return h.rendering+=1,u(l,h);await h.mountChild(v);const P=Yr.mm_to_px(l.paper.offsetHeight)-l.footer.offsetHeight;if(h.offsetBottom-P>=2){const I=d(l,h,P),x=h.children.filter(C=>C.extra);return t.insert(I,l.index+1),await Promise.allSettled(x.map(C=>C.onCreated())),await I.onCreated(),u(l,h)}return h.rendering+=1,u(l,h)}function d(l,h,v){const O=h.define.footer.map(D=>{const M=lt(D);return M.extra=!0,M}),P=v-O.reduce((D,M)=>D+M.offsetHeight,0),I=m(h,P),x=h.splitRows(I);h.appendMany(O),h.atomized=!0,h.rendering=I;const C=l.clone(),U=new vr(h.define),q=h.define.header.map(D=>lt(D));U.extra=!0,U.appendMany(q),U.appendMany(x),C.append(U);for(let D=l.rendering+1,M=l.children.length;D<M;D++){const j=l.children[D];tn.isIsolated(j.define,h.define)||(C.append(j),Reflect.set(l.children,D,null))}return l.children=l.children.filter(D=>D!=null),C}function N(l,h){const v=l.children[h],O=[v];if(v.repeatGroup==null)return{height:v.offsetHeight,length:1};for(let P=h+1;P<l.children.length;P++){const I=l.children[P];if(I.repeatGroup!==v.repeatGroup)break;O.push(I)}return{height:Math.max(...O.map(P=>P.offsetHeight)),length:O.length}}function m(l,h){let v=l.offsetTop,O=0;for(;O<l.children.length;){const P=N(l,O);if(v+=P.height,v==h)return O+P.length-1;if(v>h)return O-1;O+=P.length}return l.children.length-1}async function A(l,h){return await l.mountChild(h),u(l,h)}async function g(l,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),l.mountChild(h)}async function p(l,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),l.mountChild(h)}return async function(){pi(),await ze(),await oo(t,n);const l=t.createElement();return l&&e.appendChild(l),r=t.pages[0].file,s()}}function uo(e){const t=Date.now(),n=Ct.create(e.define,e.state);return ao(e.container,n,e.data??{})().then(()=>{n.state.renderTime=Date.now()-t}),n}const co=pt({__name:"DocState",props:{state:{type:Object,required:!0}},setup(e){const t=e,n=be(()=>t.state.renderState===le.READY),r=be(()=>t.state.renderState===le.READY?"已就绪":t.state.renderState===le.RENDERING?`正在生成(${t.state.total??0}页)...`:"正在生成...");return(i,s)=>(Ye(),Ke("div",null,[s[0]||(s[0]=ue("span",null,"文档：",-1)),ue("span",{class:ie({[i.classes.finished]:n.value})},Rt(r.value),3)]))}}),lo="_finished_7h37m_2",fo={finished:lo},ho={classes:fo},po=$t(co,[["__cssModules",ho]]),mo="_toolbar_3etac_1",go="_button_3etac_9",vo="_actived_3etac_33",wo="_divider_3etac_46",We={toolbar:mo,button:go,actived:vo,divider:wo},Eo=["viewMode","debug","space","print"],yo=pt({props:{doc:{type:Ct},buttons:{type:Array,required:!0}},setup(e){function t(){var c;(c=e.doc)==null||c.print()}function n(){var c;(c=e.doc)==null||c.toggleViewMode()}function r(){var f;const c={[We.button]:!0,[We.actived]:((f=e.doc)==null?void 0:f.state.viewMode)==="multiple"};return Z("button",{type:"button",title:"切换单页/多页视图",class:c,onClick:n},[Z(sn,{icon:"icon-multi-page"},null),Z("span",null,[Ot("多页")])])}function i(){return Z("button",{type:"button",class:We.button,onClick:t,title:"打印 Ctrl + P"},[Z(sn,{icon:"icon-printer"},null),Z("span",null,[Ot("打印")])])}function s(){return Z("div",{class:We.divider},null)}function o(){return Z("div",{class:"quickprint-is-fill-w"},null)}function a(c){if(typeof c=="function")return c(We,e.doc);switch(c){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return Z("div",{class:We.toolbar},[e.buttons.map(a)])}}});function No(e){function t(i){const s=e.value;if(s!=null)switch(i.key){case"p":case"P":if(i.ctrlKey)return i.preventDefault(),s.print();case"Add":if(i.ctrlKey)return i.preventDefault(),s.zoomOut();case"Subtract":if(i.ctrlKey)return i.preventDefault(),s.zoomIn();case"0":if(i.ctrlKey)return i.preventDefault(),s.resetZoom();case"m":case"M":if(i.ctrlKey)return i.preventDefault(),s.toggleViewMode()}}function n(){window.addEventListener("keydown",t)}function r(){window.removeEventListener("keydown",t)}return{enable:n,disable:r}}const Do={key:1,class:"quickprint-is-fill-w"},_o=pt({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return Eo}}},emits:["mock"],setup(e,{emit:t}){const n=e,r=nr("classes"),i=Mt(),s=Mt(),o=rr({}),a=No(s),c=be(()=>o.renderState===le.READY),f=be(()=>{const l=o.renderTime??0;if(l<=6e4)return`${l/1e3}秒`;const h=Math.floor(l/1e3),v=h%60,O=(h-v)/60;return v==0?`${O}分`:`${O}分${v}秒`}),u=be(()=>o.total??"--"),d=be(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function N(){var l;(l=s.value)==null||l.zoomIn()}function m(){var l;(l=s.value)==null||l.zoomOut()}function A(l){var h,v;l.deltaY>0?(h=s.value)==null||h.zoomIn():(v=s.value)==null||v.zoomOut()}function g(){var l;(l=s.value)==null||l.toggleDebug()}async function p(){const l=uo({container:i.value,define:rn.create(n.define),state:o,data:n.data});s.value=l,document.title=l?`${l.define.name} - OpenPrint`:"OpenPrint",await l.ready(),a.enable();const h=window.location.hostname;(h==="localhost"||h==="127.0.0.1")&&l.debug()}return ni(()=>{p()}),(l,h)=>{var v;return Ye(),Ke("div",{class:ie(Q(r).preview),onWheel:ii(A,["ctrl","prevent"])},[ue("div",{class:ie([Q(Ae).PRINT_HIDDEN,Q(r).header])},[ue("div",{class:ie(Q(r).headerLeft)},[Ln(l.$slots,"headerLeft")],2),Z(Q(yo),{doc:s.value,buttons:e.buttons},null,8,["doc","buttons"]),ue("div",{class:ie(Q(r).headerRight)},[Ln(l.$slots,"headerRight")],2)],2),ue("div",{class:ie(d.value),ref_key:"containerRef",ref:i},null,2),ue("div",{class:ie([Q(Ae).PRINT_HIDDEN,Q(r).footer])},[Z(po,{state:o,class:ie(Q(r).status)},null,8,["state","class"]),c.value?(Ye(),Ke(ri,{key:0},[ue("div",{class:ie(Q(r).status)},"用时："+Rt(f.value),3),h[0]||(h[0]=ue("div",{class:"quickprint-is-fill-w"},null,-1)),ue("button",{type:"button",class:ie({"quickprint-text-btn":!0,"quickprint-is-selected":(v=s.value)==null?void 0:v.state.debug}),title:"调试模式",onClick:g},[Z(Q(sn),{icon:"icon-bug"})],2),h[1]||(h[1]=ue("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ue("div",{class:ie(Q(r).divider)},null,2),ue("div",{class:ie(Q(r).status)},"第1页，共"+Rt(u.value)+"页",3),ue("div",{class:ie(Q(r).divider)},null,2)],64)):(Ye(),Ke("div",Do)),Z(Q(Vr),{class:ie(Q(r).zoom),scale:o.scale,onZoomIn:N,onZoomOut:m},null,8,["class","scale"])],2)],34)}}}),To="_preview_1hc69_2",So="_header_1hc69_13",Ao="_headerLeft_1hc69_22",bo="_headerRight_1hc69_28",Ro="_body_1hc69_34",Oo="_footer_1hc69_53",Mo="_status_1hc69_73",Po="_divider_1hc69_79",Io="_zoom_1hc69_86",Co={preview:To,header:So,headerLeft:Ao,headerRight:bo,body:Ro,footer:Oo,status:Mo,divider:Po,zoom:Io},Lo={classes:Co},ko=$t(_o,[["__cssModules",Lo]]),xo=pt({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(e){const t=e,n=nr("classes"),r=Gr(),i=tr(t.local??[]),s=rr(t.ds.fields.map(f=>c(f))),o=[{label:"文本",value:me.STRING},{label:"数字",value:me.NUMBER},{label:"日期",value:me.DATE},{label:"对象",value:me.OBJECT},{label:"数组",value:me.ARRAY}],a=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(f,u){var N;const d=f[u.name];return((N=o.find(m=>m.value===d))==null?void 0:N.label)??d}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(f,u){if(f.type===me.OBJECT)return null;if(f.type===me.ARRAY)return kn(Z("input",{type:"number","onUpdate:modelValue":N=>f.total=N,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[oi,f.total]]);const d=t.options.find(N=>N.classify===f.type);return d==null?null:kn(Z("select",{"onUpdate:modelValue":N=>f.func=N,class:n.select},[Z("option",{value:"",class:n.placeholder},[Ot("请选择")]),d.rules.map(N=>Z("option",{value:N.func,key:N.func},[N.name]))]),[[ai,f.func]])}}];function c(f,u){const d=u?`${u}.${f.name}`:f.name,N=f.children?f.children.map(A=>c(A,f.name)):void 0,m=i[d];return{type:f.type,name:f.name,title:f.title,children:N,$expand:!0,func:(m==null?void 0:m.func)??"",total:m==null?void 0:m.total}}return r==null||r.useHandle("confirm",()=>si(s)),(f,u)=>(Ye(),Ke("div",{class:ie(Q(n).ds)},[Z(Q(zr),{columns:a,data:s},null,8,["data"])],2))}}),qo="_ds_6a9ph_2",$o="_placeholder_6a9ph_8",Fo="_select_6a9ph_12",Ho="_input_6a9ph_13",Uo={ds:qo,placeholder:$o,select:Fo,input:Ho},Bo={classes:Uo},Yo=$t(xo,[["__cssModules",Bo]]);let Nt=null;const Kn=490;function Ar(){return Nt!=null?Promise.resolve(Nt):Zr(()=>import("./mock-BeWaslGC.js"),__vite__mapDeps([0,1,2,3])).then(e=>(Nt=e.default,Nt))}function Jn(e,t){switch(t){case me.DATE:return e.randDate();case me.NUMBER:return e.randDecimal();case me.STRING:return e.randName();default:return null}}function Vo(e){if((e==null?void 0:e.total)==null)return Kn;const t=Number(e.total);return Number.isNaN(t)||!Number.isFinite(t)||t<=0?Kn:Math.round(t)}function en(e,t,n){if(n==null||tt(n.func))return Jn(e,t.type);const r=e[n.func];return typeof r!="function"?Jn(e,t.type):r(n)}const Go=jr(function(e,t,n){const r={ds:t,options:e.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:Xr.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return Kr("创建模拟数据",ui(Yo,r),i).promisify()});async function Qn(e,t){if(e==null)return[];const n=await Ar(),r=await Go(n,e,t).catch(Wr);return Array.isArray(r)?r:[]}async function Dt(e,t){if(e==null||!Array.isArray(t)||t.length==0)return{};const n=await Ar(),r=tr(t);return e.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===me.OBJECT){const a=s.children??[];return i[s.name]=a.reduce((c,f)=>{if(tt(f.name))return c;const u=`${s.name}.${f.name}`;return c[f.name]=en(n,f,r[u]),c},{}),i}if(s.type===me.ARRAY){const a=s.children??[],c=Vo(o),f=10+Math.round(Math.random()*c);return i[s.name]=Array(f).fill("").map(()=>a.reduce((u,d)=>{if(tt(d.name))return u;const N=`${s.name}.${d.name}`;return u[d.name]=en(n,d,r[N]),u},{})),i}return i[s.name]=en(n,s,o),i},{})}const zo=pt({__name:"index",setup(e){const t={INIT:0,LOADED_CASE:1,LOADED_DATA:2,READY:3},n=Mt(),r=Mt(),i=jt(0),s=jt(!1),o=be(()=>{var p;return`${((p=n.value)==null?void 0:p.id)??Date.now()}-${i.value}`}),a=jt(t.INIT),c=be(()=>["viewMode","debug","space",s.value?m:null,"print"]),f=be(()=>a.value===t.INIT?"正在加载...":a.value===t.LOADED_CASE?"已加载模板，正在准备数据...":a.value===t.LOADED_DATA?"开始渲染模板":"");function u(){const p=new URLSearchParams(window.location.search).get("id");return dn(p)&&(p==="local"||Cn.some(l=>l.id===p))?p:Cn[0].id}async function d(g){var v,O,P,I;if(g==null)return{};if(g.data)return s.value=!1,g.data;const p=Pn(g.id);if(Array.isArray(p)&&p.length>0)return Dt((v=g.define)==null?void 0:v.ds,p);const l=g.rules;if(Array.isArray(l)&&l.length>0)return Dt((O=g.define)==null?void 0:O.ds,l);const h=await Qn((P=n.value)==null?void 0:P.ds);return In(h,g.id),Dt((I=g.define)==null?void 0:I.ds,h)}async function N(){if(n.value==null)return;const g=n.value.id;if(g==null||g=="")return;const p=Pn(g),l=await Qn(n.value.ds,p);In(l,n.value.id),r.value=await Dt(n.value.ds,l),i.value++}function m(g){return Z("button",{type:"button",class:g.button,onClick:N},[Z("span",null,[Ot("模拟数据")])])}async function A(){a.value=t.INIT,s.value=!0;const g=await Jr(u());n.value=(g==null?void 0:g.define)??{},a.value=t.LOADED_CASE,r.value=await d(g),a.value=t.LOADED_DATA,a.value=t.READY}return A(),(g,p)=>a.value<=t.LOADED_DATA?(Ye(),Ke("div",{key:0,class:ie(g.classes.logs)},Rt(f.value),3)):(Ye(),ci(Q(ko),{define:n.value,data:r.value,buttons:c.value,key:o.value,class:ie(g.classes.preview),onMock:N},null,8,["define","data","buttons","class"]))}}),jo="_preview_17t3s_7",Wo="_logs_17t3s_11",Zo={preview:jo,logs:Wo},Xo={classes:Zo},Ko=$t(zo,[["__cssModules",Xo]]),Sn=li(Ko),Jo=Qr();Sn.use(ei,{zIndex:Jo});Sn.mount("#app");ti(Sn._context);
