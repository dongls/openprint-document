const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-Dftd_N4J.js","assets/vue-C4hvfNT6.js","assets/component-L55ah7FP.css","assets/component-CupdP2um.js","assets/utils-D0ReC0S-.js","assets/utils-B7EFy5Gd.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var Do=Object.defineProperty;var cl=n=>{throw TypeError(n)};var Oo=(n,e,t)=>e in n?Do(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var B=(n,e,t)=>Oo(n,typeof e!="symbol"?e+"":e,t),An=(n,e,t)=>e.has(n)||cl("Cannot "+t);var we=(n,e,t)=>(An(n,e,"read from private field"),t?t.call(n):e.get(n)),Be=(n,e,t)=>e.has(n)?cl("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),at=(n,e,t,l)=>(An(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),ke=(n,e,t)=>(An(n,e,"access private method"),t);import{D as ve,E as vt,N as Wt,a as dt,b as j,c as qe,P as Wn,d as Xt,e as ul,f as pn,g as mn,O as Zt,h as ee,i as tn,j as gn,L as Ie,I as O,_ as z,k as xl,s as yn,l as Mo,m as ie,n as $o,B as Q,o as Po,S as Yn,p as jn,F as oe,V as Ge,q as Xn,r as me,t as Vo,u as Je,U as Pn,v as Al,w as bt,x as hn,y as Qe,z as ql,A as Dl,C as Ol,G as he,H as Xe,J as Bo,T as Fo,K as Pe,R as Et,M as Me,Q as Jt,W as et,X as zo,Y as Uo,Z as Ho,$ as Zn,a0 as Kn,a1 as Ml,a2 as zt,a3 as rn,a4 as kt,a5 as vn,a6 as pt,a7 as be,a8 as Go,a9 as an,aa as Ct,ab as mt,ac as tt,ad as Wo,ae as _t,af as Nt,ag as Yo,ah as jo,ai as Xo,aj as Zo,ak as Ko,al as Jo,am as Re,an as Ce,ao as Qo,ap as Mt,aq as nn,ar as dl,as as es,at as fl,au as qn,av as Dn,aw as ts,ax as ns,ay as cn,az as ls,aA as os,aB as ss,aC as is,aD as pl,aE as rs,aF as as}from"./utils-D0ReC0S-.js";import{r as ue,o as Jn,d as M,c as N,a as w,n as h,b as f,e as p,f as We,u as Ne,s as de,g as Oe,h as R,w as se,i as y,j as J,k as H,T as $l,l as K,m as Tt,p as Qt,q as Pl,F as X,t as ae,v as W,x as $t,y as ml,z as Vl,A as Bl,B as Ee,C as xe,D as le,E as ye,G as Pt,H as cs,I as Fl,J as en,K as Qn,L as On,M as Ue,N as St,O as us,P as ds,Q as fs,R as ps}from"./vue-C4hvfNT6.js";const zl="@quickprint_drag_mode",Ul="@quickprint_drop_data",En="@quickprint_operate",Ye="@quickprint_element",el="@quickprint_element_type",Hl="@quickprint_resize_flag",yt=160,_n=32,Ut=[50,75,100,125,150,200,300,400];var Yt=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(Yt||{}),Rt=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))(Rt||{});const ot={SINGLE:0,MULTIPLE:1},Le=Object.freeze({INSERT:0,MOVE:1}),tl=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),G=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),pe=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),Gl=[{label:"固定值",value:ve.CONST},{label:"变量",value:ve.VARIABLE},{label:"公式",value:ve.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:ve.CODE,detail:"使用Javascript代码生成数据"}],ms=[{label:"显示",value:vt.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:vt.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:vt.CONDITION,detail:"元素只在满足指定条件后显示"}],gs=[{label:"四舍五入",value:Wt.ROUND},{label:"向下舍入",value:Wt.FLOOR},{label:"向上舍入",value:Wt.CEIL},{label:"四舍六入",value:Wt.BANKER_ROUND}],hs=[{label:"原始值",value:dt.NONE},{label:"固定位数",value:dt.FIXED},{label:"金额千位",value:dt.THOUSAND},{label:"金额万位",value:dt.TEN_THOUSAND},{label:"金额大写",value:dt.DAXIE},{label:"百分比",value:dt.PERCENTAGE}],vs=[{label:"显示",value:!0},{label:"隐藏",value:!1}],bs=[{label:"默认",value:void 0},{label:"文本",value:j.TEXT},{label:"数字",value:j.NUMBER},{label:"日期",value:j.DATE}],ce={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},Wl=[{label:"年-月",value:qe.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:qe.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:qe.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:qe.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:qe.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:qe.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:qe.TIME,detail:"示例：12:00:00"},{label:"时:分",value:qe.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:qe.YEAR,detail:"示例：2024"},{label:"月",value:qe.MONTH,detail:"示例：12"},{label:"日",value:qe.DAY,detail:"示例：01"}];Wl.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const ys=[{label:"元素值",value:Wn.ELEMENT_VALUR}],Es=[{label:"基于纸张",value:Xt.PAPER},{label:"基于内容",value:Xt.CONTENT}],Yl=[{label:"纵向",value:ul.PORTRAIT},{label:"横向",value:ul.LANDSCAPE}],_s=[{label:"当前位置",value:pn.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:pn.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Ts=[{label:"单次打印",value:mn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:mn.EACH,detail:"元素将每页打印一次"}],Ss=[{label:"按内容调整高度",value:Zt.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:Zt.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:Zt.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],Vn=[{label:"页码",value:tn.PAGE_NUMBER,type:ee.NUMBER},{label:"总页数",value:tn.PAGE_TOTAL,type:ee.NUMBER},{label:"行序号",value:tn.ROW_INDEX,type:ee.NUMBER},{label:"当前时间",value:tn.CURRENT_DATE,type:ee.DATE}],ws=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function jl(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function ks(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function Xl(n){return n.isSelected?n.type===j.PARAGRAPH?52:n.type===j.TABLE?32:20:20}function Cs(){const n=ue(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),Jn(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class Rs{constructor(e,t,l){B(this,"originalEvent");B(this,"target");B(this,"ghost");B(this,"container");B(this,"paths",[]);B(this,"dropTarget");B(this,"top",0);B(this,"left",0);B(this,"deltaX");B(this,"deltaY");B(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const s=t.getBoundingClientRect();this.deltaX=s.left-e.clientX,this.deltaY=s.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var At,qt,st,Zl,Kl,Jl;const ht=class ht extends gn{constructor(t={}){var l,s,o;super();Be(this,st);B(this,"context",null);B(this,"selector");B(this,"scale");B(this,"onDragStart");Be(this,At);Be(this,qt);this.selector={container:((l=t.selector)==null?void 0:l.container)??G.PAGE,element:((s=t.selector)==null?void 0:s.element)??G.DRAGGABLE,droppable:((o=t.selector)==null?void 0:o.droppable)??G.DROPPABLE},this.onDragStart=ke(this,st,Zl).bind(this),this.scale=t.scale,at(this,At,ke(this,st,Kl).bind(this)),at(this,qt,ke(this,st,Jl).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",we(this,At)),window.removeEventListener("pointerup",we(this,qt)),this.context=null)}};At=new WeakMap,qt=new WeakMap,st=new WeakSet,Zl=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return Ie.warn(ht.TAG_NAME,"未找到的可拖拽元素");const s=this.selector.container,o=jl(l,s);this.context=new Rs(t,l,o);const c=this.createEvent("before-dragstart",this.context);if(this.dispatch(c).defaultPrevented)return Ie.warn(ht.TAG_NAME,"已取消拖拽");if(this.context.container==null)return Ie.warn(ht.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return Ie.warn(ht.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",we(this,At)),window.addEventListener("pointerup",we(this,qt))},Kl=function(t){const l=this.context;if(l==null)return;const s=l.container.getBoundingClientRect(),o=document.elementsFromPoint(t.clientX,t.clientY),c=Array.from(o).filter(r=>!(r===l.ghost||r===l.target||l.ghost.contains(r))),i=this.normalizeScale();l.originalEvent=t,l.paths=c,l.dropTarget=c.find(r=>r.matches("."+G.DROPPABLE)),l.top=(t.clientY+l.deltaY-s.top)/i,l.left=(t.clientX+l.deltaX-s.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},Jl=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("dragend",l);this.dispatch(s).defaultPrevented||this.reset()},B(ht,"TAG_NAME","quickprint-draggable");let Bn=ht;const Ns=["title"],Ls=M({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(w(),N("span",{title:n.title,class:h(e.classes.help)},[f("span",null,[We(e.$slots,"default")]),p(O,{icon:"icon-question-circle"})],10,Ns))}}),Is="_help_1l6l8_2",xs={help:Is},As={classes:xs},qs=z(Ls,[["__cssModules",As]]),Ds=M({__name:"Popover",props:{width:{type:Number,default:null}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,s=t,o=Ne("classes"),c=ue(!1),i=de(),r=de(),d=Oe({minWidth:0,top:0,left:0,visible:!1}),u=R(()=>({minWidth:l.width==null?d.minWidth+"px":l.width+"px",top:d.top+"px",left:d.left+"px",visibility:d.visible?"visible":"hidden",zIndex:xl()}));async function m(){if(c.value)return g();c.value=!0,s("show"),await yn(),S()}function g(){x(),c.value=!1,s("close")}function E(C){if(!(C.target instanceof Node))return;const T=i.value;if(T&&T.contains(C.target))return C.preventDefault();const _=r.value;if(_&&_.contains(C.target))return C.preventDefault();g()}function v(){const C=i.value,T=r.value;if(T==null||C==null)return;const _=C.getBoundingClientRect(),L=T.getBoundingClientRect(),k=l.width==null?_.width:l.width;let I=_.bottom+1;I+L.height>window.innerHeight&&_.top>L.height&&(I=_.top-L.height-1);let A=_.left;A+L.width>window.innerWidth&&(A=window.innerWidth-L.width-2),d.minWidth=k,d.top=I,d.left=A,d.visible=!0}function a(C){const T=C.target;if(!(T instanceof HTMLElement))return;const _=i.value;_==null||!T.contains(_)||g()}function b(C){if(C.key!=="Escape")return;const T=r.value;if(T!=null){const _=T.style.zIndex;if(Number(_)<Mo())return}C.preventDefault(),g()}function S(){window.addEventListener("click",E,{capture:!0}),window.addEventListener("contextmenu",g,{capture:!0}),window.addEventListener("scroll",a,{capture:!0,passive:!0}),window.addEventListener("resize",v),window.addEventListener("keydown",b)}function x(){window.removeEventListener("click",E,!0),window.removeEventListener("contextmenu",g,!0),window.removeEventListener("scroll",a,!0),window.removeEventListener("resize",v),window.removeEventListener("keydown",b)}return e({close:g}),(C,T)=>(w(),N("div",{class:h(y(o).reference),onClick:se(m,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[We(C.$slots,"default"),c.value?(w(),J($l,{key:0,to:"body"},[f("div",{class:h(y(o).popover),onVnodeMounted:v,onMousedown:T[0]||(T[0]=se(()=>{},["prevent"])),style:K(u.value),ref_key:"popoverRef",ref:r},[We(C.$slots,"popover")],38)])):H("",!0)],2))}}),Os="_reference_1arli_2",Ms="_popover_1arli_7",$s={reference:Os,popover:Ms},Ps={classes:$s},Ql=z(Ds,[["__cssModules",Ps]]),Vs=["title","onKeydown"],Bs=["onMouseover","onClick"],Fs=M({__name:"Select",props:Tt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:Tt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,s=Ne("classes"),o=de(),c=de(),i=Qt(n,"modelValue"),r=ue(),d=ue(!1),u=Oe({width:0,top:0,left:0,visible:!1,scrollable:!1}),m=R(()=>l.teleport==="none"),g=R(()=>l.teleport=="none"?"body":l.teleport),E=R(()=>{const D={label:"",options:[]},V=[D];for(const U of l.options){if(Array.isArray(U.options)){V.push({label:U.label,options:U.options});continue}D.options.push(U)}return V}),v=R(()=>E.value.reduce((D,V)=>D.concat(V.options),[])),a=R(()=>{if(l.multiple!==!0){const V=In();return V?V.label:l.button?l.title:ie(l.modelValue)?l.placeholder:l.modelValue}const D=xn();return D.length>0?D.map(V=>V.label).join(","):l.button?l.title:l.placeholder}),b=R(()=>l.clearable!==!0?!1:l.modelValue!=null),S=R(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[s.mini]:l.size==="mini",[s.select]:!0,[s.appearance]:l.appearance!=="none"&&!b.value,[s.button]:l.button,[s.showClearIcon]:b.value,[s.text]:l.size==="text"})),x=R(()=>({width:l.width})),C=R(()=>u.visible?{width:l.popoverWidth==null?u.width+"px":l.popoverWidth+"px",top:u.top+"px",left:u.left+"px",visibility:"visible",zIndex:xl()}:{minWidth:l.popoverWidth==null?u.width+"px":l.popoverWidth+"px",visibility:"hidden"}),T=R(()=>({[s.content]:!0,[s.placeholder]:$o(l.modelValue)}));async function _(){if(l.disabled)return;const D=v.value;if(D.length===0)return;if(d.value)return L();const V=o.value;V!=null&&(u.width=V.getBoundingClientRect().width,u.visible=!1,r.value=D.find(U=>U.value===l.modelValue),d.value=!0,await yn(),Ao())}function L(){qo(),d.value=!1}function k(D){F(),rt()}function I(D){D.disabled!==!0&&(r.value=D)}function A(D){if(l.disabled==!0||D.disabled===!0)return;if(l.multiple!==!0){i.value=D.value,t("select",D),L();return}const V=Array.isArray(i.value)?i.value:[],U=V.findIndex(fe=>fe===D.value);U>=0?V.splice(U,1):V.push(D.value),i.value=V,t("select",V)}function $(D){if(!(D.target instanceof Node))return;const V=o.value;if(V&&V.contains(D.target))return D.preventDefault();const U=c.value;if(U&&U.contains(D.target))return D.preventDefault();L()}async function F(){const D=o.value,V=c.value;if(V==null||D==null)return;await $t();const U=D.getBoundingClientRect(),fe=V.getBoundingClientRect();let ge=U.bottom+1;ge+fe.height>window.innerHeight&&U.top>fe.height&&(ge=U.top-fe.height-1);let wt=U.left;wt+fe.width>window.innerWidth&&(wt=window.innerWidth-fe.width-2),u.width=fe.width,u.top=ge,u.left=wt,u.visible=!0;const Ft=V.querySelector("."+s.list);u.scrollable=Ft?Ft.scrollHeight>Ft.clientHeight:!1}function P(D){const V=D.target;if(!(V instanceof HTMLElement))return;const U=o.value;U==null||!V.contains(U)||L()}function te(){const D=v.value,V=ml(r.value);if(V==null){r.value=Bt(0),rt();return}const U=D.indexOf(V);if(U==0)return re();const fe=Bt(U-1);fe!=null&&(r.value=fe,rt())}function Y(){const D=v.value,V=ml(r.value);if(V==null){r.value=Se(0),rt();return}const U=D.indexOf(V);if(U>=D.length-1){q();return}const fe=Bt(U+1);fe!=null&&(r.value=fe,rt())}function q(){r.value=Se(0),rt()}function re(){const D=v.value;r.value=Bt(D.length-1),rt()}function ne(){i.value=void 0,L()}function Se(D){const U=v.value[D];return U==null?null:U.disabled===!0?Se(D+1):U}function Bt(D){const U=v.value[D];return U==null?null:U.disabled===!0?Bt(D-1):U}function al(D){switch(D.key){case"Enter":D.preventDefault(),r.value&&A(r.value);return;case"Escape":D.preventDefault(),L();return;case"ArrowUp":D.preventDefault(),te();return;case"ArrowDown":D.preventDefault(),Y();return;case"Home":D.preventDefault(),q();return;case"End":D.preventDefault(),re();return}}function Io(D){if(l.disabled)return;const V=o.value;V!=null&&document.activeElement===V&&(d.value||(D.stopPropagation(),_()))}function xo(D){if(l.multiple!==!0)return l.modelValue===D.value;const V=l.modelValue;return Array.isArray(V)?V.includes(D.value):!1}async function rt(){if(r.value==null)return;await $t();const D=c.value;if(D==null)return;const V=D.querySelector("."+s.hover);V&&V.scrollIntoView({block:"nearest"})}function In(){const D=v.value,V=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return D.find(U=>U.value===V)}function xn(){const D=v.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(U=>U).map(U=>{const fe=D.find(ge=>ge.value===U);return fe||{value:U,label:U}})}function Ao(){window.addEventListener("mousedown",$,{capture:!0}),window.addEventListener("pointerdown",$,{capture:!0}),window.addEventListener("contextmenu",L,{capture:!0}),window.addEventListener("scroll",P,{capture:!0,passive:!0}),window.addEventListener("resize",F),window.addEventListener("keydown",al)}function qo(){window.removeEventListener("mousedown",$,!0),window.removeEventListener("pointerdown",$,!0),window.removeEventListener("contextmenu",L,!0),window.removeEventListener("scroll",P,!0),window.removeEventListener("resize",F),window.removeEventListener("keydown",al)}return(D,V)=>{var U;return w(),N("div",{class:h(S.value),title:n.title,style:K(x.value),onClick:se(_,["stop"]),onKeydown:Pl(se(Io,["prevent"]),["enter"]),ref_key:"selectRef",ref:o,tabindex:"0"},[D.$slots.selected?We(D.$slots,"selected",{key:0,option:In(),options:xn()}):We(D.$slots,"option",{key:1,option:In(),options:xn()},()=>[f("div",{class:h(T.value)},[f("span",null,W(a.value),1),b.value?(w(),J(O,{key:0,icon:"icon-close",onClick:se(ne,["stop"]),size:"12px",class:h(y(s).clearIcon)},null,8,["class"])):H("",!0)],2)]),d.value?(w(),J($l,{key:2,to:g.value,disabled:m.value},[f("div",{class:h(y(s).popover),onClick:V[0]||(V[0]=se(()=>{},["stop"])),onVnodeMounted:k,onMousedown:V[1]||(V[1]=se(()=>{},["prevent"])),style:K(C.value),ref_key:"popoverRef",ref:c},[f("div",{class:h(y(s).list)},[(w(!0),N(X,null,ae(E.value,fe=>(w(),N(X,null,[fe.label?(w(),N("div",{key:0,class:h(y(s).groupLabel)},W(fe.label),3)):H("",!0),(w(!0),N(X,null,ae(fe.options,ge=>{var wt;return w(),N("div",{key:ge.value,class:h({[y(s).option]:!0,[y(s).disabled]:ge.disabled===!0,[y(s).selected]:xo(ge),[y(s).hover]:((wt=r.value)==null?void 0:wt.value)==ge.value}),style:K(ge.style),onMouseover:Ft=>I(ge),onClick:Ft=>A(ge)},[We(D.$slots,"option",{option:ge},()=>[f("div",{class:h(y(s).label)},[ge.icon?(w(),J(O,{key:0,icon:ge.icon,class:h(y(s).icon)},null,8,["icon","class"])):H("",!0),f("span",null,W(ge.label),1)],2),ge.short?(w(),N("div",{key:0,class:h(y(s).short)},W(ge.short),3)):H("",!0)])],46,Bs)}),128))],64))),256))],2),(U=r.value)!=null&&U.detail&&u.visible?(w(),N("div",{key:0,class:h(y(s).detail)},W(r.value.detail),3)):H("",!0)],38)],8,["to","disabled"])):H("",!0)],46,Vs)}}}),zs="_button_qag3j_2",Us="_select_qag3j_7",Hs="_appearance_qag3j_16",Gs="_content_qag3j_31",Ws="_placeholder_qag3j_37",Ys="_popover_qag3j_41",js="_list_qag3j_51",Xs="_option_qag3j_80",Zs="_label_qag3j_95",Ks="_icon_qag3j_102",Js="_hover_qag3j_106",Qs="_detail_qag3j_117",ei="_short_qag3j_127",ti="_selected_qag3j_133",ni="_disabled_qag3j_137",li="_showClearIcon_qag3j_142",oi="_clearIcon_qag3j_146",si="_text_qag3j_159",ii="_mini_qag3j_171",ri="_groupLabel_qag3j_183",ai={button:zs,select:Us,appearance:Hs,content:Gs,placeholder:Ws,popover:Ys,list:js,option:Xs,label:Zs,icon:Ks,hover:Js,detail:Qs,short:ei,selected:ti,disabled:ni,showClearIcon:li,clearIcon:oi,text:si,mini:ii,groupLabel:ri},ci={classes:ai},Z=z(Fs,[["__cssModules",ci]]),ui="_tree_1p28f_1",di="_node_1p28f_5",fi="_content_1p28f_11",pi="_space_1p28f_27",mi="_expand_1p28f_28",gi="_active_1p28f_47",hi="_children_1p28f_55",Ze={tree:ui,node:di,content:fi,space:pi,expand:mi,active:gi,children:hi},eo=Symbol(),to=M({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Vl(eo),l=R(()=>Array.isArray(n.node.children)&&n.node.children.length>0),s=R({get(){const a=t==null?void 0:t.state[n.node.value];return a==null?!1:a.expand},set(a){const b=t==null?void 0:t.state[n.node.value];b!=null&&(b.expand=a)}});function o(a){a.preventDefault(),s.value=!s.value}function c(){if(!l.value)return p("div",{class:Ze.space},null);const a={[Ze.expand]:!0,[Ze.active]:s.value};return p("div",{onMousedown:v,onClick:o,class:a},[p(O,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function r(){return p("div",{class:Ze.content,onClick:u,onMouseenter:g},[i()])}function d(){if(!l.value||!s.value)return;const a=n.node.children.map(b=>p(to,{node:b,onNodeClick:m,onNodeHover:E},null));return p("div",{class:Ze.children},[a])}function u(){e("nodeClick",n.node)}function m(a){e("nodeClick",a)}function g(){e("nodeHover",n.node)}function E(a){e("nodeHover",a)}function v(a){a.preventDefault()}return function(){return p("div",{class:Ze.subTree},[p("div",{class:Ze.node},[c(),r()]),d()])}}}),vi=M({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=c();function s(r){t("nodeClick",r)}function o(r){t("nodeHover",r)}function c(){const r=Oe({}),d=function(u,m){for(const g of u)m[g.value]={expand:g.expand!==!1},g.children&&d(g.children,m)};return d(n.data,r),r}function i(r){return typeof e.default=="function"?e.default(r):null}return Bl(eo,{state:l,content:i}),function(){const r=n.data.map(d=>p(to,{node:d,onNodeClick:s,onNodeHover:o},null));return p("div",{class:Ze.tree},[r])}}});function bi(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function yi(n,e=0){let t=0,l=null;return function(...s){const o=Date.now();if(o-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,s),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,s),t=o}}function nl(n,e){const t=[];if(e&&e!=oe.DEFAULT&&t.push(`"${e}"`),n&&n!==oe.DEFAULT&&t.push(`"${n}"`),t.length!=0)return t.join(",")}function no(n){if(n.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:n.underlineStyle,textDecorationColor:n.underlineColor}}function lo(n,e={}){const t={},l=n.style??{},s=nl(l.fontFamily,l.enFontFamily);s&&(t.fontFamily=s);const o=no(l);return o&&Je(t,o),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),_i("border",e)&&l.border&&Je(t,Fn(n)),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.padding&&Je(t,Si(n)),Je(t,Ti(n)),Je(t,oo(l.verticalAlign)),t}function Ei(n,e={}){const t=[];let l=n;for(;me.isDefineElement(l);)t.unshift(lo(l,e)),l=l.parent;return Vo({},...t)}function _i(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}function Ti(n){if(n==null)return{};const e=n.style??{},t={};return e.textAlign&&(t.textAlign=e.textAlign),e.textAlignLast&&(t.textAlignLast=e.textAlignLast),t}function oo(n){return n==null||n==Ge.MIDDLE?{display:"flex",alignItems:"center"}:n==Ge.BOTTOM?{display:"flex",alignItems:"end"}:{}}function Si(n){if(n==null)return{};const e=n.style??{};if(e.padding==null)return{};const t={};return e.padding.top&&(t.paddingTop=e.padding.top),e.padding.right&&(t.paddingRight=e.padding.right),e.padding.bottom&&(t.paddingBottom=e.padding.bottom),e.padding.left&&(t.paddingLeft=e.padding.left),t}function Fn(n){if(n==null)return{};const e=n.style??{};if(e.border==null||e.border===Q.NONE)return{};const t={},l=e.borderWidth??1,s=e.borderStyle??Po.SOLID,o=e.borderColor??Yn.BLACK;if(e.border==Q.ALL||e.border&Q.TOP){const c=e.borderTopWidth??l,i=e.borderTopStyle??s,r=e.borderTopColor??o;t.borderTop=`${c}px ${i} ${r}`}if(e.border==Q.ALL||e.border&Q.RIGHT){const c=e.borderRightWidth??l,i=e.borderRightStyle??s,r=e.borderRightColor??o;t.borderRight=`${c}px ${i} ${r}`}if(e.border==Q.ALL||e.border&Q.BOTTOM){const c=e.borderBottomWidth??l,i=e.borderBottomStyle??s,r=e.borderBottomColor??o;t.borderBottom=`${c}px ${i} ${r}`}if(e.border==Q.ALL||e.border&Q.LEFT){const c=e.borderLeftWidth??l,i=e.borderLeftStyle??s,r=e.borderLeftColor??o;t.borderLeft=`${c}px ${i} ${r}`}return t}const gt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(gt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(gt.SPACE).filter(s=>jn(s));return t.indexOf(e)>=0?n:(t.push(e),t.join(gt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(gt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(gt.SPACE))}};function He(n){if(ie(n))return{num:null,unit:null};const e=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em)?$/);if(e==null)return{num:null,unit:null};const t=Number(e[1]),l=Xn(t)?t:null,s=ie(e[2])?null:e[2];return{num:l,unit:s}}function gl(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const e=He(n);if(e.num==null)return null;switch(e.unit){case"px":return e.num;case"pt":return Pn.pt_to_px(e.num);case"mm":return Pn.mm_to_px(e.num);default:return null}}function ll(n,e){const t=n.ds;if(t!=null)return t.type===ve.FORMULA?{type:t.type,content:ol(t.value,n.doc)}:t.type===ve.VARIABLE?{type:t.type,content:je(t.value,e)}:{type:t.type,content:t.value}}function je(n,e){var g,E,v;if(ie(n))return n;const t=Al(n),l=t.path;if(l==null||l=="")return;const s=l.split(".");if(s.length==0)return l;const o=s[0];if(t.varType===bt.BUILTIN)return((g=Vn.find(a=>a.value===o))==null?void 0:g.label)??o;if(t.varType===bt.SPECIAL)return((E=ys.find(a=>a.value===o))==null?void 0:E.label)??o;if(e==null)return l;const i=(e.fields??[]).find(a=>a.name===o);if(i==null)return l;const r=s[1],d=ie(i.title)?i.name:i.title;if(r==null)return d;const u=(v=i.children)==null?void 0:v.find(a=>a.name===r);if(u==null)return`${d}.${r}`;const m=ie(u.title)?u.name:u.title;return`${d}.${m}`}function ol(n,e){return ie(n)?void 0:hn.tokenize(n).map(s=>s.type===Qe.VARIABLE?`[${je(s.value,e==null?void 0:e.ds)}]`:s.type===Qe.REFERENCE?`[${so(s.value,e)}]`:s.type===Qe.TEMPLATE?(Array.isArray(s.value)?s.value:[s.value]).map(c=>c.type===Qe.VARIABLE?`[${je(c.value,e==null?void 0:e.ds)}]`:c.value).join(""):hn.formatTokenValue(s)).join("")}function so(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===ve.VARIABLE&&t.ds.value?je(t.ds.value,e.ds):"="+n}function wi(n){switch(Al(n).dataType){case ee.OBJECT:return"对象";case ee.ARRAY:return"数组";case ee.STRING:return"文本";case ee.NUMBER:return"数字";case ee.DATE:return"日期";case ee.BOOLEAN:return"布尔";default:return"未知类型"}}function ki(n){var e;return((e=Gl.find(t=>t.value===n))==null?void 0:e.label)??n}const io=ql(()=>Dl(()=>import("./component-Dftd_N4J.js"),__vite__mapDeps([0,1,2]))),Ci=["onClick","onMouseenter"],Ri=M({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=ue(Vn[0].value),s=R(()=>`builtin_${Ol(l.value,"_").toLowerCase()}`);function o(i){t("select",i)}function c(i){l.value=i.value}return(i,r)=>(w(),N("div",{class:h(i.classes.builtin)},[f("div",{class:h(["quickprint-is-scrollable",i.classes.panel])},[(w(!0),N(X,null,ae(y(Vn),d=>(w(),N("div",{class:h({[i.classes.param]:!0,[i.classes.active]:d.value===l.value}),onClick:u=>o(d),onMouseenter:u=>c(d)},[f("strong",null,W(d.label),1),f("span",null,W(d.value),1)],42,Ci))),256))],2),f("div",{class:h(["quickprint-is-scrollable",i.classes.desc])},[p(y(io),{name:s.value},null,8,["name"])],2)],2))}}),Ni="_builtin_m1n0z_2",Li="_panel_m1n0z_11",Ii="_desc_m1n0z_17",xi="_param_m1n0z_24",Ai="_active_m1n0z_34",qi={builtin:Ni,panel:Li,desc:Ii,param:xi,active:Ai},Di={classes:qi},Oi=z(Ri,[["__cssModules",Di]]),hl=[{label:"文本",value:ee.STRING},{label:"数字",value:ee.NUMBER},{label:"日期",value:ee.DATE},{label:"对象",value:ee.OBJECT},{label:"数组",value:ee.ARRAY}],Mi=M({emit:["select"],props:{doc:{type:he,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Ne("classes"),s=Xe(),o=r(),c=i();function i(){const b=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(S,x,C){var T;if(n.readonly){const _=S[x.name],L=((T=hl.find(k=>k.value===_))==null?void 0:T.label)??_;return p("div",{class:C.classes.cell},[L])}return p("div",{class:C.classes.cell},[p(Z,{options:hl,modelValue:S.type,"onUpdate:modelValue":E.bind(null,S),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(S,x,C){return n.readonly?p("div",{class:C.classes.cell},[S[x.name]]):p("div",{class:C.classes.cell},[Ee(p("input",{"onUpdate:modelValue":T=>S.name=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[xe,S.name]])])}},{name:"title",title:"标题",width:180,render(S,x,C){return n.readonly?p("div",{class:C.classes.cell},[S[x.name]]):p("div",{class:C.classes.cell},[Ee(p("input",{"onUpdate:modelValue":T=>S.title=T,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[xe,S.title]])])}}];return n.readonly!==!0&&b.push({name:"operate",title:"操作",width:200,render(S,x,C){const T=[p("button",{type:"button",class:"quickprint-text-btn",onClick:u.bind(null,S,C.parent)},[p(O,{icon:"icon-subnode"},null),p("span",null,[le("插入行")])])];return(S.type===ee.ARRAY||S.type===ee.OBJECT)&&T.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:g.bind(null,S)},[p(O,{icon:"icon-sisternode"},null),p("span",null,[le("插入子级")])])),T.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:m.bind(null,S,C.parent)},[p(O,{icon:"icon-delete"},null),p("span",null,[le("删除")])])),T}}),b}function r(){const b=Bo(n.doc.ds.fields??[]).map(x=>{const C=x.type;return{...x,$expand:C===ee.ARRAY||C===ee.OBJECT}}),S=ue(b);return S.value.length==0&&S.value.push(d()),S}function d(){return{type:ee.STRING,name:"",title:""}}function u(b,S){if(S){const C=S.children??[],T=C.indexOf(b);T>=0&&C.splice(T+1,0,d());return}const x=o.value.indexOf(b);x>=0&&o.value.splice(x+1,0,d())}function m(b,S){if(S){const C=S.children??[],T=C.indexOf(b);T>=0&&C.splice(T,1);return}const x=o.value.indexOf(b);x>=0&&o.value.splice(x,1),o.value.length==0&&o.value.push(d())}function g(b){b.type!==ee.ARRAY&&b.type!==ee.OBJECT||(b.children==null&&(b.children=[]),b.children.push(d()))}function E(b,S){b.type=S,S===ee.ARRAY||S===ee.OBJECT?b.$expand=!0:b.children=void 0}function v(){return{fields:o.value.map(S=>ie(S.name)?null:S.type!==ee.ARRAY&&S.type!==ee.OBJECT?{type:S.type,name:S.name,title:S.title}:{type:S.type,name:S.name,title:S.title,children:(S.children??[]).map(x=>ie(S.name)?null:{type:x.type,name:x.name,title:x.title}).filter(x=>x!=null)}).filter(S=>S!=null)}}function a(b,S){n.readonly===!0&&t("select",b,S)}return s==null||s.useHandle("confirm",v),e({submit:v}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(Fo,{columns:c,data:o.value,onSelect:a},null)])}}}),$i="_form_6lybl_2",Pi="_readonly_6lybl_6",Vi="_datasource_6lybl_11",Bi={form:$i,readonly:Pi,datasource:Vi},Fi={classes:Bi},ro=z(Mi,[["__cssModules",Fi]]),zi={class:"quickprint-config-group"},Ui={class:"quickprint-config-section quickprint-config-inline"},Hi={class:"quickprint-config-content"},Gi={class:"quickprint-config-section quickprint-config-inline"},Wi={class:"quickprint-config-content"},Yi={class:"quickprint-config-id"},ji={class:"quickprint-config-section quickprint-config-inline"},Xi={class:"quickprint-config-content"},Zi={class:"quickprint-config-group"},Ki={class:"quickprint-config-group-title"},Ji=M({__name:"Detail",props:{element:{type:me,required:!0}},setup(n){const e=n,t=R(()=>{var l,s;return(s=ll(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:s.content});return(l,s)=>(w(),N("div",{class:h(l.classes.detail)},[f("div",zi,[f("section",Ui,[s[0]||(s[0]=f("header",{class:"quickprint-config-header"},"类型",-1)),f("div",Hi,W(y(Kt)(n.element.type)),1)]),f("section",Gi,[s[1]||(s[1]=f("header",{class:"quickprint-config-header"},"标识",-1)),f("div",Wi,[f("span",Yi,W(n.element.id),1)])]),f("section",ji,[s[2]||(s[2]=f("header",{class:"quickprint-config-header"},"标题",-1)),f("div",Xi,W(n.element.title),1)])]),f("div",Zi,[f("div",Ki,[s[3]||(s[3]=f("span",null,"数据",-1)),f("span",{class:h(l.classes.type)},W(y(ki)(n.element.ds.type)),3)]),f("div",null,W(t.value),1)])],2))}}),Qi="_detail_11ox4_2",er="_type_11ox4_10",tr={detail:Qi,type:er},nr={classes:tr},lr=z(Ji,[["__cssModules",nr]]),or=M({__name:"index",props:{doc:{type:he,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,s=i(),o=ue();function c(g){return g.reduce((E,v)=>{const a=Array.isArray(v.children)?c(v.children):[];if(jn(v.ds.value)||a.length>0){const b={value:v.id,label:v.title??v.id,data:v,children:a};return E.push(b),E}return E},[])}function i(){const g=l.doc.pages.reduce((v,a)=>v.concat(a.children),[]),E=c(g);return ue(E)}function r(g){o.value=g}function d(g){return g.title?g.title:Kt(g.type)}function u(g){return Du(g.type)??"icon-zhanweifu"}function m(g){t("select",g.data)}return(g,E)=>(w(),N("div",{class:h(g.classes.reference)},[f("div",{class:h([g.classes.panel,"quickprint-is-scrollable"])},[p(y(vi),{data:y(s),onNodeHover:r,onNodeClick:m},{default:ye(({node:v})=>[p(y(O),{icon:u(v.data)},null,8,["icon"]),f("span",{class:h(g.classes.title)},W(d(v.data)),3),f("span",{class:h(g.classes.id)},"<"+W(v.value)+">",3)]),_:1},8,["data"])],2),f("div",{class:h([g.classes.detail,"quickprint-is-scrollable"])},[o.value?(w(),J(lr,{element:o.value.data,key:o.value.value},null,8,["element"])):H("",!0)],2)],2))}}),sr="_reference_1ekkx_2",ir="_panel_1ekkx_12",rr="_detail_1ekkx_20",ar="_title_1ekkx_25",cr="_id_1ekkx_29",ur={reference:sr,panel:ir,detail:rr,title:ar,id:cr},dr={classes:ur},fr=z(or,[["__cssModules",dr]]),pr=M({__name:"index",props:{doc:{type:he,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=Xe();function t(c,i){return c==null?null:i==null?`${bt.DS}.${c.type}.${c.name}`:`${bt.DS}.${c.type}.${i.name}.${c.name}`}function l(c,i){e==null||e.confirm({type:"ds",value:t(c,i),parent:i})}function s(c){e==null||e.confirm({type:"builtin",value:`${bt.BUILTIN}.${c.type}.${c.value}`})}function o(c){e==null||e.confirm({type:"reference",value:c.id})}return(c,i)=>(w(),N("div",{class:h(c.classes.var)},[n.active==="ds"?(w(),J(ro,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):H("",!0),n.active==="builtin"?(w(),J(Oi,{key:1,onSelect:s})):H("",!0),n.active==="reference"?(w(),J(fr,{key:2,doc:n.doc,onSelect:o},null,8,["doc"])):H("",!0)],2))}}),mr={var:"_var_12wxd_2"},gr={classes:mr},ao=z(pr,[["__cssModules",gr]]),hr=["onClick","onMouseenter"],vr=M({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var r;const t=n,l=e,s=ue((r=t.options[0])==null?void 0:r.value),o=R(()=>`${t.type}_${s.value.toLowerCase()}`);function c(d){l("select",d.value)}function i(d){s.value=d.value}return(d,u)=>(w(),N("div",{class:h(d.classes.doc)},[f("div",{class:h(["quickprint-is-scrollable",d.classes.panel])},[(w(!0),N(X,null,ae(n.options,m=>(w(),N("div",{key:m.value,class:h({[d.classes.option]:!0,[d.classes.active]:m.value===s.value}),onClick:g=>c(m),onMouseenter:g=>i(m)},[f("strong",null,W(m.label),1)],42,hr))),128))],2),f("div",{class:h(["quickprint-is-scrollable",d.classes.desc])},[p(y(io),{name:o.value},null,8,["name"])],2)],2))}}),br="_doc_1pdoc_2",yr="_panel_1pdoc_10",Er="_desc_1pdoc_16",_r="_option_1pdoc_23",Tr="_active_1pdoc_33",Sr={doc:br,panel:yr,desc:Er,option:_r,active:Tr},wr={classes:Sr},Ht=z(vr,[["__cssModules",wr]]),kr=M({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=Xe(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"}],s=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],o=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],c=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(r){return e==null?void 0:e.confirm({type:"function",value:`${r}()`})}return(r,d)=>(w(),N("div",{class:h(r.classes.function)},[n.active==="string"?(w(),J(Ht,{options:t,onSelect:i,key:"string"})):H("",!0),n.active==="number"?(w(),J(Ht,{options:l,onSelect:i,key:"number"})):H("",!0),n.active==="logical"?(w(),J(Ht,{options:s,onSelect:i,key:"logical"})):H("",!0),n.active==="date"?(w(),J(Ht,{options:o,onSelect:i,key:"date"})):H("",!0),n.active==="aggregate"?(w(),J(Ht,{options:c,onSelect:i,key:"aggregate"})):H("",!0)],2))}}),Cr={function:"_function_19szx_2"},Rr={classes:Cr},Nr=z(kr,[["__cssModules",Rr]]),Lr=["onMouseenter"],Ir=["onClick"],xr={key:1},Ar=M({__name:"Formula",props:{doc:{type:he,default:null}},setup(n){const e=n,t=Xe(),l=[{id:"pageNumber",name:"页码",options:r(ws)}],s=ue(l[0]);function o(d){s.value=d}function c(d){return t==null?void 0:t.confirm({type:"formula",value:d})}function i(d){const u=hn.tokenize(d),m=e.doc;return u.reduce((g,E)=>{if(E.type===Qe.VARIABLE)return g.push({type:"highlight",value:je(E.value,m==null?void 0:m.ds)}),g;if(E.type===Qe.REFERENCE)return g.push({type:"highlight",value:so(E.value,m)}),g;if(E.type===Qe.TEMPLATE){const a=(Array.isArray(E.value)?E.value:[E.value]).map(b=>b.type===Qe.VARIABLE?{type:"highlight",value:je(b.value,m.ds)}:{type:"text",value:b.value});return g.concat(a)}return g.push({type:"text",value:hn.formatTokenValue(E)}),g},[])}function r(d){return d.map(u=>({nodes:i(u),value:u}))}return(d,u)=>(w(),N("div",{class:h(d.classes.formula)},[f("div",{class:h([d.classes.left,"quickprint-is-scrollable"])},[(w(),N(X,null,ae(l,m=>f("div",{key:m.name,onMouseenter:g=>o(m),class:h({[d.classes.group]:!0,[d.classes.active]:m.id===s.value.id})},W(m.name),43,Lr)),64))],2),f("div",{class:h(d.classes.right)},[(w(!0),N(X,null,ae(s.value.options,(m,g)=>(w(),N("div",{key:g,class:h(d.classes.code),onClick:E=>c(m.value)},[(w(!0),N(X,null,ae(m.nodes,E=>(w(),N(X,null,[E.type==="highlight"?(w(),N("span",{key:0,class:h(d.classes.highlight)},"["+W(E.value)+"]",3)):(w(),N("span",xr,W(E.value),1))],64))),256)),f("span",{class:h(d.classes.badge)},"插入",2)],10,Ir))),128))],2)],2))}}),qr="_formula_ms7c3_2",Dr="_left_ms7c3_12",Or="_right_ms7c3_17",Mr="_group_ms7c3_24",$r="_active_ms7c3_34",Pr="_highlight_ms7c3_39",Vr="_code_ms7c3_43",Br="_badge_ms7c3_65",Fr={formula:qr,left:Dr,right:Or,group:Mr,active:$r,highlight:Pr,code:Vr,badge:Br},zr={classes:Fr},Ur=z(Ar,[["__cssModules",zr]]),sl=Pe(function(n){return Jt("变量",(e,t)=>p(ao,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Me)}),Hr=Pe(function(n){return Et("数据源",p(ro,{doc:n},null),{preset:"variable",icon:p(O,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Me)}),Gr=Pe(function(n){const e=["ds","builtin","reference"];return Jt("变量",(t,l)=>p(ao,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Me)}),Wr=Pe(function(){return Jt("函数",(n,e)=>p(Nr,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(Me)}),Yr=Pe(function(n){return Et("公式",p(Ur,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Me)}),jr={key:1},Xr=M({__name:"Content",props:{element:{type:me,required:!0}},setup(n){const e=n,t=_e(),l=Pt("editorRef"),s=Pt("contentRef"),o=ue(!1),c=R(()=>{const u=e.element.type===j.TABLE_CELL?Ei(e.element,{exclude:["border"]}):lo(e.element);return u.color&&(u["--quickprint-element-var-color"]=u.color),o.value&&(u.alignItems="flex-start"),u}),i=R(()=>{const u=ll(e.element,t.doc.ds);return u==null||u.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:u.type===ve.CONST?"span":"strong",content:u.content},{tag:"span",content:e.element.attributes.suffix}]});async function r(){var E;const u=await sl({doc:t.doc,value:e.element.ds.value}).catch(et);if(u==null||(e.element.setDataSource(ve.VARIABLE,u.value),e.element.type!=j.TABLE_CELL||u.type!=="ds"))return;const m=e.element.parent;if(m==null||m.isBindVariable||((E=u.parent)==null?void 0:E.type)!==ee.ARRAY)return;const g=u.parent;m.setDataSource(ve.VARIABLE,`${bt.DS}.${g.type}.${g.name}`)}function d(){const u=l.value,m=s.value;u==null||m==null||(o.value=m.offsetHeight>u.offsetHeight)}return(u,m)=>(w(),N("div",{class:"quickprint-is-element-editor",style:K(c.value),onVnodeMounted:d,ref_key:"editorRef",ref:l},[f("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:s},[f("span",{class:h({[u.classes.lineThrough]:n.element.style.lineThrough})},[(w(!0),N(X,null,ae(i.value,(g,E)=>(w(),N(X,{key:E},[g.tag=="strong"?(w(),N("strong",{key:0,class:h(u.classes.highlight)},"["+W(g.content)+"]",3)):(w(),N("span",jr,W(g.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(w(),J(y(O),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:h(u.classes.dsIcon),onClick:r,onPointerdown:m[0]||(m[0]=se(()=>{},["stop"]))},null,8,["class"])):H("",!0)],4))}}),Zr="_dsIcon_ss96n_2",Kr="_lineThrough_ss96n_10",Jr="_highlight_ss96n_14",Qr={dsIcon:Zr,lineThrough:Kr,highlight:Jr},ea={classes:Qr},Tn=z(Xr,[["__cssModules",ea]]),ta=M({__name:"TextEditor",props:{element:{type:zo,required:!0}},setup(n){return(e,t)=>(w(),J(Tn,{element:n.element},null,8,["element"]))}}),Sn=Object.freeze({title:"文本",icon:"icon-text",type:j.TEXT,editor:ta,onCreate(){return me.create({type:j.TEXT,width:yt,height:_n})}}),na=M({__name:"NumberEditor",props:{element:{type:Uo,required:!0}},setup(n){return(e,t)=>(w(),J(Tn,{element:n.element},null,8,["element"]))}}),la=["value","disabled"],oa=M({__name:"RadioButton",props:Tt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=Qt(n,"modelValue");return(t,l)=>(w(),N("div",{class:h({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(w(!0),N(X,null,ae(n.options,s=>(w(),N("label",{class:h({[t.classes.radio]:!0,[t.classes.selected]:s.value===n.modelValue})},[Ee(f("input",{type:"radio",value:s.value,"onUpdate:modelValue":l[0]||(l[0]=o=>e.value=o),disabled:n.disabled},null,8,la),[[cs,e.value]]),f("span",null,W(s.label),1)],2))),256))],2))}}),sa="_radioGroup_67myk_2",ia="_compacted_67myk_10",ra="_radio_67myk_2",aa="_selected_67myk_50",ca="_disabled_67myk_56",ua={radioGroup:sa,compacted:ia,radio:ra,selected:aa,disabled:ca},da={classes:ua},Lt=z(oa,[["__cssModules",da]]),fa={class:"quickprint-config-section quickprint-config-inline"},pa={class:"quickprint-config-content"},ma={class:"quickprint-config-section quickprint-config-inline"},ga={class:"quickprint-config-content"},ha={class:"quickprint-config-section quickprint-config-inline"},va={class:"quickprint-config-content"},ba={class:"quickprint-config-section quickprint-config-inline"},ya={class:"quickprint-config-content"},Ea=M({__name:"NumberConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t=R({get(){return e.element.attributes.showZero??!0},set(o){const c=e.element.attributes;c.showZero=o}}),l=R({get(){return e.element.attributes.round??Wt.ROUND},set(o){const c=e.element.attributes;c.round=o}}),s=R({get(){return e.element.attributes.format??dt.NONE},set(o){const c=e.element.attributes;c.format=o}});return(o,c)=>(w(),N(X,null,[f("section",fa,[c[4]||(c[4]=f("header",{class:"quickprint-config-header"},"小数位数",-1)),f("div",pa,[Ee(f("input",{"onUpdate:modelValue":c[0]||(c[0]=i=>n.element.attributes.precision=i),type:"number",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[xe,n.element.attributes.precision]])])]),f("section",ma,[c[5]||(c[5]=f("header",{class:"quickprint-config-header"},"舍入规则",-1)),f("div",ga,[p(y(Z),{options:y(gs),modelValue:l.value,"onUpdate:modelValue":c[1]||(c[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",ha,[c[6]||(c[6]=f("header",{class:"quickprint-config-header"},"显示类型",-1)),f("div",va,[p(y(Z),{options:y(hs),modelValue:s.value,"onUpdate:modelValue":c[2]||(c[2]=i=>s.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),f("section",ba,[c[7]||(c[7]=f("header",{class:"quickprint-config-header"},"值为0时",-1)),f("div",ya,[p(Lt,{modelValue:t.value,"onUpdate:modelValue":c[3]||(c[3]=i=>t.value=i),options:y(vs),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),wn=Object.freeze({title:"数字",type:j.NUMBER,icon:"icon-number",editor:na,config:{display:Ea},onCreate(){return me.create({type:j.NUMBER,width:yt,height:_n})}}),_a=M({__name:"DateEditor",props:{element:{type:Ho,required:!0}},setup(n){return(e,t)=>(w(),J(Tn,{element:n.element},null,8,["element"]))}}),Ta={class:"quickprint-config-section"},Sa={class:"quickprint-config-content"},wa=M({__name:"DateConfig",props:{element:{type:me,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=R(()=>[{label:"原始值",value:t.NONE},...Wl]);function s(o){if(o.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=o.value}return(o,c)=>(w(),N("section",Ta,[f("header",{class:h(["quickprint-config-header",o.classes.header])},[c[1]||(c[1]=f("span",null,"格式",-1)),p(y(Z),{options:l.value,onSelect:s,class:h(o.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:ye(()=>[f("span",{class:h(o.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),f("div",Sa,[Ee(f("input",{type:"text","onUpdate:modelValue":c[0]||(c[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[xe,n.element.attributes.format]])])]))}}),ka="_header_79607_2",Ca="_picker_79607_8",Ra="_placeholder_79607_15",Na={header:ka,picker:Ca,placeholder:Ra},La={classes:Na},Ia=z(wa,[["__cssModules",La]]),kn=Object.freeze({title:"日期",type:j.DATE,icon:"icon-date",editor:_a,config:{display:Ia},onCreate(){return me.create({type:j.DATE,width:yt,height:_n})}}),xa=["colspan","rowspan"],Aa=M({__name:"TableCellEditor",props:{element:{type:Zn,required:!0}},setup(n){const e=n,t=R(()=>e.element.attributes.colspan===0||e.element.attributes.rowspan===0),l=_e(),s=Ne("classes"),o=R(()=>{var r;return{[s.cell]:!0,[G.SELECTED]:(r=e.element.state)==null?void 0:r.selected}}),c=R(()=>{var u;const r=Fn((u=e.element.parent)==null?void 0:u.parent),d=Fn(e.element);return{"--quickprint-cell-editor-width":e.element.offsetWidth+"px","--quickprint-cell-editor-height":e.element.offsetHeight+"px",...Je(r,d)}});function i(r){r.button==0&&l.selectElement(e.element)}return(r,d)=>t.value?H("",!0):(w(),N("td",Fl({key:0,[`.${y(Ye)||""}`]:n.element,class:o.value,style:c.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:se(i,["stop"])}),[p(Tn,{element:n.element,class:h(y(s).content)},null,8,["element","class"])],48,xa))}}),qa="_cell_rp1x6_2",Da="_content_rp1x6_31",Oa={cell:qa,content:Da},Ma={classes:Oa},co=z(Aa,[["__cssModules",Ma]]);function uo(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}function $a(n,e){const t=e.getSelected(),l={menus:[]};return t.length>=2&&l.menus.push({type:"menu",label:"合并",icon:"icon-merge-cells",handler:e.mergeCells}),t.some(s=>s.hasColSpan||s.hasRowSpan)&&l.menus.push({type:"menu",label:"拆分",icon:"icon-solit-cells",handler:e.splitCells}),l.menus.length>0&&l.menus.push({type:"divider"}),l.menus.push({type:"menu",label:"选中表格",icon:"icon-aim",handler:e.selectTable},{type:"divider"},{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",handler:e.insertColumnLeft},{type:"menu",label:"右侧插入列",handler:e.insertColumnRight},{type:"menu",label:"上侧插入行",handler:e.insertRowTop},{type:"menu",label:"下侧插入行",handler:e.inserRowBottom}]},{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:e.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:e.avgTableWidth},{type:"menu",label:"均分表格高度",handler:e.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:e.setOtherRowSameHeight,disabled(){return e.toArea(t).rowSpan!==1}},{type:"menu",label:"将其他列设为相同宽度",handler:e.setOtherColSameWidth,disabled(){return e.toArea(t).colSpan!==1}}]},{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:e.deleteColumns},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:e.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:e.deleteDataSource}]},{type:"divider"},uo(e.getDesignApi(),e.getTable())),Kn.open(n.clientX,n.clientY,l)}function Pa(n,e){function t(){return n.element}function l(){const T=t();return e.getSelectedElements().filter(L=>{var I;if(L.type!==j.TABLE_CELL)return!1;const k=(I=L.parent)==null?void 0:I.parent;return k==null?!1:k.id==T.id}).sort(Zn.sort)}function s(T){var F,P,te;const[_,...L]=T;let k=_.index,I=_.index,A=((F=_.parent)==null?void 0:F.index)??-1,$=((P=_.parent)==null?void 0:P.index)??-1;for(const Y of L){const q=((te=Y.parent)==null?void 0:te.index)??-1,re=Y.index;re>=0&&re<k&&(k=re),re>=0&&re>I&&(I=re),q>=0&&q<A&&(A=q),q>=0&&q>$&&($=q)}return{colStart:k,colEnd:I,rowStart:A,rowEnd:$,colSpan:I-k+1,rowSpan:$-A+1}}function o(){var L;const T=l()[0];if(T==null)return!1;const _=(L=T.parent)==null?void 0:L.parent;return _==null?!1:e.selectElement(_)}function c(){const T=l();if(T.length===0)return!1;const _=s(T);return t().insertColumn(_.colStart,0),e.createSnapshot(),!0}function i(){const T=l();if(T.length===0)return!1;const _=s(T);return t().insertColumn(_.colEnd,1),e.createSnapshot(),!0}function r(){const T=l();if(T.length===0)return!1;const _=s(T);return t().inserRow(_.rowStart,0),e.createSnapshot(),!0}function d(){const T=l();if(T.length===0)return!1;const _=s(T);return t().inserRow(_.rowEnd,1),e.createSnapshot(),!0}function u(){var q,re;const T=t(),_=T.page;if(_==null)return;const L=T.doc,k=gl((q=L==null?void 0:L.margins)==null?void 0:q.left)??38,I=gl((re=L==null?void 0:L.margins)==null?void 0:re.right)??38,A=T.columns,$=A.reduce((ne,Se)=>ne+Se,0),F=Pn.mm_to_px(_.width)-k-I,P=[];for(const ne of A){const Se=Math.round(ne/$*F);P.push(Se)}const te=P.reduce((ne,Se)=>ne+Se,0),Y=F-te;P[P.length-1]+=Y,T.setColumns(P),T.updateBoxSize(),e.createSnapshot()}function m(){const T=t(),_=T.columns,L=_.reduce(($,F)=>$+F,0),k=Math.floor(L/_.length),I=new Array(_.length).fill(k),A=L-I.reduce(($,F)=>$+F,0);I[I.length-1]+=A,T.setColumns(I),T.updateBoxSize(),e.createSnapshot()}function g(){const T=t(),_=Math.round(T.height/T.children.length);T.children.forEach((L,k)=>T.setRowHeight(k,_)),T.updateBoxSize(),e.createSnapshot()}function E(){const T=e.getSelectedElements()[0];if(T==null)return;const _=T.parent;if(_==null||_.type!="TableRow")return;const L=t(),k=_.height;L.children.forEach(I=>I.setRowHeight(k)),L.updateBoxSize(),e.createSnapshot()}function v(){const T=e.getSelectedElements()[0];if(T==null)return;const _=t(),L=T.width,k=_.attributes.colgroup.map(I=>L);_.setColumns(k),_.updateBoxSize(),e.createSnapshot()}function a(){const T=l();if(T.length<2)return;const[_,...L]=T,k=s(T);for(const I of L)I.attributes.colspan=0,I.attributes.rowspan=0;_.attributes.colspan=k.colSpan,_.attributes.rowspan=k.rowSpan,_.attributes.range=L.map(I=>I.id),e.selectElement(_),e.createSnapshot()}function b(){const T=l();if(T.length!=0){for(const _ of T)!_.hasColSpan&&!_.hasRowSpan||_.resetSpan();e.createSnapshot()}}function S(){const T=l()[0];if(T==null)return;t().removeColumn(T.index),e.createSnapshot()}function x(){const T=l()[0];if(T==null)return;const _=T.parent;if(_==null)return;t().removeRow(_.index),e.createSnapshot()}function C(){e.getSelectedElements().forEach(_=>_.resetDS()),e.createSnapshot()}return{getDesignApi(){return e},getTable:t,getSelected:l,selectTable:o,toArea:s,insertColumnLeft:c,insertColumnRight:i,insertRowTop:r,inserRowBottom:d,autoReiszeColumnByPaper:u,avgTableWidth:m,avgTableHeight:g,setOtherRowSameHeight:E,setOtherColSameWidth:v,mergeCells:a,splitCells:b,deleteColumns:S,deleteRows:x,deleteDataSource:C}}function Va(n,e,t){const s={moved:!1,left:0,colIndex:0,target:null,container:null};function o(u){return u<=0?null:n.getTable().getColumnLeft(u-1)}function c(u){const m=n.getTable(),g=m.attributes.colgroup.length;return u>=g?null:m.getColumnLeft(u+1)}function i(u,m){if(!(u.target instanceof Element))return;const g=u.target.closest("."+e.colResize);if(g==null)return;const E=g.closest("."+e.layer);E!=null&&(u.stopPropagation(),u.preventDefault(),s.left=g.offsetLeft,s.colIndex=m,s.target=g,s.container=E,s.target.setPointerCapture(u.pointerId),window.addEventListener("pointermove",r),window.addEventListener("pointerup",d))}function r(u){if(s.target==null||s.container==null)return;const m=s.container.getBoundingClientRect(),g=n.getDesignApi().state.scale/100,E=o(s.colIndex),v=c(s.colIndex);let a=u.clientX-m.left;E!=null&&a<=E*g+4&&(a=E*g+4),v!=null&&a>=v*g-4&&(a=v*g-4),s.left=a/g,s.target.style.left=a/g+"px",s.moved=!0}function d(u){s.moved&&t.onResizeEnd(s.colIndex,Math.round(s.left)),s.left=0,s.target=null,s.container=null,window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",d)}return i}function Ba(n,e,t){const s={moved:!1,top:0,rowIndex:0,target:null,container:null};function o(u){return u<=0?null:n.getTable().getRowTop(u-1)}function c(u){const m=n.getTable(),g=m.children.length;return u>=g?null:m.getRowTop(u+1)}function i(u,m){if(!(u.target instanceof Element))return;const g=u.target.closest("."+e.rowResize);if(g==null)return;const E=g.closest("."+e.layer);E!=null&&(u.stopPropagation(),u.preventDefault(),s.top=g.offsetTop,s.rowIndex=m,s.target=g,s.container=E,s.target.setPointerCapture(u.pointerId),window.addEventListener("pointermove",r),window.addEventListener("pointerup",d))}function r(u){if(s.target==null||s.container==null)return;const m=n.getDesignApi().state.scale/100,g=s.container.getBoundingClientRect(),E=o(s.rowIndex),v=c(s.rowIndex);let a=u.clientY-g.top;E!=null&&a<=E*m+4&&(a=E*m+4),v!=null&&a>=v*m-4&&(a=v*m-4),s.moved=!0,s.top=a/m,s.target.style.top=a/m+"px"}function d(u){s.moved&&t.onResizeEnd(s.rowIndex,Math.round(s.top)),s.top=0,s.target=null,s.container=null,window.removeEventListener("pointermove",r),window.removeEventListener("pointerup",d)}return i}const Fa=["width"],za=["onClick"],Ua=["onClick"],Ha=M({__name:"TableEditor",props:{element:{type:Ml,required:!0}},setup(n){const e=n,t=_e(),l=Ne("classes"),s=Pa(e,t),o=Oe({colIndex:-1,rowIndex:-1,silence:!1}),c=R(()=>e.element.attributes.colgroup??[]),i=Va(s,l,{onResizeEnd:S,onResizeStart:b}),r=Ba(s,l,{onResizeEnd:x,onResizeStart:b});function d(k){return{left:(e.element.attributes.colgroup??[]).slice(0,k).reduce((A,$)=>A+$,0)+"px"}}function u(k){return{top:(e.element.children??[]).slice(0,k).reduce(($,F)=>$+F.height,0)-1+"px"}}function m(k){const I=e.element.attributes.colgroup??[],A=I.slice(0,k).reduce((P,te)=>P+te,0),$=k===0?0:1,F=k>0&&k<I.length?-1:0;return{left:A+$+"px",width:I[k]+F+"px"}}function g(k){const I=e.element.children??[],A=I.slice(0,k).reduce((P,te)=>P+te.height,0),$=k===0?0:1,F=k>0&&k<I.length?-1:0;return{top:A+$+"px",height:I[k].height+F+"px"}}function E(k){t.selectElement(k)}function v(k){const I=[];for(const A of e.element.children){const $=A.children[k];$.isColCollapse||I.push($)}t.multiSelectElements(I)}async function a(k){const I=k.target.closest("td");if(I==null)return;const A=Reflect.get(I,Ye);A!=null&&(t.state.selectMode==ot.SINGLE&&(t.selectElement(A),await $t()),$a(k,s))}function b(){o.silence=!0}function S(k,I){o.silence=!1;const A=e.element.attributes.colgroup??[];if(k==0){const Y=e.element.left,q=e.element.calculateCoord(Y+I),re=A[0]-(q-Y);e.element.setLeft(q),e.element.setColWidth(0,re),e.element.updateBoxSize(),t.createSnapshot();return}if(k==A.length){const Y=k-1,q=A.slice(0,Y).reduce((ne,Se)=>ne+Se,0),re=I-q;e.element.setColWidth(k-1,re),e.element.updateBoxSize(),t.createSnapshot();return}const $=k-1,F=A[$]+A[k],P=I-A.slice(0,$).reduce((Y,q)=>Y+q,0),te=F-P;e.element.setColWidth($,P),e.element.setColWidth(k,te),e.element.updateBoxSize(),t.createSnapshot()}function x(k,I){o.silence=!1;const A=e.element.children;if(k==0){const Y=e.element.top,q=e.element.calculateCoord(Y+I),re=A[0].height-(q-Y);e.element.setTop(q),e.element.setRowHeight(k,re),e.element.updateBoxSize(),t.createSnapshot();return}if(k==A.length){const Y=k-1,q=A.slice(0,Y).reduce((ne,Se)=>ne+Se.height,0),re=I-q;e.element.setRowHeight(k-1,re),e.element.updateBoxSize(),t.createSnapshot();return}const $=k-1,F=A[$].height+A[k].height,P=I-A.slice(0,$).reduce((Y,q)=>Y+q.height,0),te=F-P;e.element.setRowHeight($,P),e.element.setRowHeight(k,te),e.element.updateBoxSize(),t.createSnapshot()}function C(){o.rowIndex=-1,o.colIndex=-1}function T(k){if(o.silence)return;const I=k.target.closest("td");if(I==null)return;const A=Reflect.get(I,Ye);if(A==null||!(A instanceof Zn))return;const $=A.parent;if($==null)return;const F=I.getBoundingClientRect(),P=k.clientY-F.top,Y=k.clientX-F.left<F.width/2,q=P<F.height/2;o.colIndex=Y?A.index:A.getNextColIndex(),o.rowIndex=q?$.index:A.getNextRowIndex()}function _(){const k=e.element;k.insertColumn(k.colSize-1,1)}function L(){const k=e.element;k.inserRow(k.rowSize-1,1)}return(k,I)=>(w(),N("div",{class:h(y(l).tableEditor),onContextmenu:se(a,["stop","prevent"]),onClick:I[3]||(I[3]=se(()=>{},["stop"])),onMouseleave:C},[f("table",{class:h(y(l).table),onMousemove:T},[f("colgroup",null,[(w(!0),N(X,null,ae(c.value,(A,$)=>(w(),N("col",{key:$,width:A},null,8,Fa))),128))]),f("tbody",null,[(w(!0),N(X,null,ae(n.element.children,A=>(w(),N("tr",{key:A.id,class:h({[y(G).SELECTED]:A.isSelected})},[(w(!0),N(X,null,ae(A.children,$=>(w(),J(co,{key:$.id,element:$},null,8,["element"]))),128))],2))),128))])],34),f("div",{class:h(y(l).layer)},[o.colIndex>=0?(w(),N("div",{key:0,title:"调整列宽",class:h(y(l).colResize),style:K(d(o.colIndex)),onPointerdown:I[0]||(I[0]=se(A=>y(i)(A,o.colIndex),["stop","prevent"]))},null,38)):H("",!0),o.rowIndex>=0?(w(),N("div",{key:1,title:"调整行高",class:h(y(l).rowResize),style:K(u(o.rowIndex)),onPointerdown:I[1]||(I[1]=se(A=>y(r)(A,o.rowIndex),["stop","prevent"]))},null,38)):H("",!0),(w(!0),N(X,null,ae(c.value,(A,$)=>(w(),N("div",{title:"选中此列",key:$,style:K(m($)),class:h(y(l).colIndicator),onClick:se(F=>v($),["stop"])},null,14,za))),128)),(w(!0),N(X,null,ae(n.element.children,(A,$)=>(w(),N("div",{title:"选中此行",key:$,style:K(g($)),class:h(y(l).rowIndicator),onClick:se(F=>E(A),["stop"])},null,14,Ua))),128)),n.element.isSelected?(w(),N("button",{key:2,onClick:se(_,["stop"]),type:"button",class:h(["quickprint-text-btn",y(l).addCol]),title:"添加列"},[p(y(O),{icon:"icon-plus",size:"14px"})],2)):H("",!0),n.element.isSelected?(w(),N("button",{key:3,onClick:se(L,["stop"]),type:"button",class:h(["quickprint-text-btn",y(l).addRow]),title:"添加行"},[p(y(O),{icon:"icon-plus",size:"14px"})],2)):H("",!0)],2),f("div",{class:h(y(l).indicator),onPointerdown:I[2]||(I[2]=(...A)=>y(t).onDragStart&&y(t).onDragStart(...A)),title:"选中/拖动表格"},null,34)],34))}}),Ga="_tableEditor_5qbkt_2",Wa="_table_5qbkt_2",Ya="_layer_5qbkt_33",ja="_colResize_5qbkt_43",Xa="_rowResize_5qbkt_66",Za="_colIndicator_5qbkt_89",Ka="_rowIndicator_5qbkt_95",Ja="_indicator_5qbkt_114",Qa="_addCol_5qbkt_151",ec="_addRow_5qbkt_166",tc={tableEditor:Ga,table:Wa,layer:Ya,colResize:ja,rowResize:Xa,colIndicator:Za,rowIndicator:Ka,indicator:Ja,addCol:Qa,addRow:ec},nc={classes:tc},lc=z(Ha,[["__cssModules",nc]]),oc={class:"quickprint-config-section quickprint-config-inline"},sc={class:"quickprint-config-content"},ic=M({__name:"TableConfig",props:{element:{type:Ml,required:!0}},setup(n){const e=n,t=R({get(){return e.element.attributes.rowMode??zt.CONST},set(s){e.element.attributes.rowMode=s===zt.CONST?void 0:s}}),l=[{label:"固定行数",value:zt.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:zt.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:zt.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(s,o)=>(w(),N("section",oc,[o[1]||(o[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",sc,[p(y(Z),{options:l,modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=c=>t.value=c),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),rc={class:"quickprint-config-section quickprint-config-inline"},ac={class:"quickprint-config-content"},cc=M({__name:"TableRowConfig",props:{element:{type:rn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:kt.HEADER},{label:"表体",value:kt.BODY},{label:"表尾",value:kt.FOOTER}],l=R({get(){return e.element.attributes.type??kt.BODY},set(s){switch(s){case kt.HEADER:e.element.asHeader();break;case kt.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(s,o)=>(w(),N("section",rc,[o[1]||(o[1]=f("header",{class:"quickprint-config-header"},"行模式",-1)),f("div",ac,[p(y(Z),{options:t,modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value=c),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),Cn=Object.freeze({title:"表格",type:j.TABLE,icon:"icon-table",editor:lc,config:{attributes:ic,exclude:[ce.DISPLAY,ce.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[yt,yt,yt],e=me.create({type:j.TABLE});return e.setColgroup(n),e.append(rn.createDefault(n)),e.append(rn.createDefault(n)),e.append(rn.createDefault(n)),e.updateBoxSize(),e}}),fo=Object.freeze({title:"表格行",type:j.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[ce.POSITION,ce.COORD,ce.OVERFLOW],attributes:cc}}),il=Object.freeze({title:"单元格",type:j.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:co,config:{exclude:[ce.POSITION,ce.COORD]}});function ln(n,e){const t=Math.pow(10,Math.max(0,e));return Math.round(n*t)/t}const Mn={A:10,B:11,C:12,D:13,E:14,F:15},vl={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function uc(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function dc(n){return typeof n=="string"&&n.includes("%")}function xt(n,e){uc(n)&&(n="100%");const t=dc(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function ct(n){return n.length===2?(Mn[n[0].toUpperCase()]||+n[0])*16+(Mn[n[1].toUpperCase()]||+n[1]):Mn[n[1].toUpperCase()]||+n[1]}function bl(n,e,t){n=xt(n,255),e=xt(e,255),t=xt(t,255);const l=Math.max(n,e,t),s=Math.min(n,e,t);let o;const c=l,i=l-s,r=l===0?0:i/l;if(l===s)o=0;else{switch(l){case n:{o=(e-t)/i+(e<t?6:0);break}case e:{o=(t-n)/i+2;break}case t:{o=(n-e)/i+4;break}}o/=6}return{h:o*360,s:r*100,v:c*100}}const fc=function(n,e,t){e=e/100,t=t/100;let l=e;const s=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=s<=1?s:2-s;const o=(t+e)/2,c=t===0?2*l/(s+l):2*e/(t+e);return{h:n,s:c*100,v:o*100}},pc=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function $n(n,e,t){n=xt(n,360)*6,e=xt(e,100),t=xt(t,100);const l=Math.floor(n),s=n-l,o=t*(1-e),c=t*(1-s*e),i=t*(1-(1-s)*e),r=l%6,d=[t,c,o,o,i,t][r],u=[i,t,t,c,o,o][r],m=[o,o,i,t,t,c][r];return{r:Math.round(d*255),g:Math.round(u*255),b:Math.round(m*255)}}function un(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${vl[e]||e}${vl[t]||t}`}function mc({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${un(n)}${un(e)}${un(t)}`}class Rn{constructor(e){B(this,"h",0);B(this,"s",100);B(this,"v",100);B(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=ln(e,2)}setSaturation(e){this.s=ln(e,2)}setValue(e){this.v=ln(e,2)}setAlpha(e){this.a=ln(e,2)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(s=>s!=="").map((s,o)=>o>2?Number.parseFloat(s):Number.parseInt(s,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,s,o,c=100;t.length===3?(l=ct(t[0]+t[0]),s=ct(t[1]+t[1]),o=ct(t[2]+t[2])):(t.length===6||t.length===8)&&(l=ct(t.slice(0,2)),s=ct(t.slice(2,4)),o=ct(t.slice(4,6))),t.length===8&&(c=ct(t.slice(6))/255*100);const{h:i,s:r,v:d}=bl(l,s,o);return{h:i,s:r,v:d,a:c}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:c}=bl(t[0],t[1],t[2]);return{h:s,s:o,v:c,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,s)=>s>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:s,s:o,v:c}=fc(t[0],t[1],t[2]);return{h:s,s:o,v:c,a:l}}return null}toString(e){switch(e){case"hsl":{const t=pc(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${mc($n(this.h,this.s,this.v))}${un(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:s}=$n(this.h,this.s,this.v);return`rgba(${t},${l},${s},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return $n(this.h,this.s,this.v)}}function po(n){const e={init:!1,target:null,container:null,offsetX:0};function t(c){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let u=c.clientX-i.left-e.offsetX;return u<-d&&(u=-d),u>i.width-d&&(u=i.width-d),u}function l(c){c.stopPropagation(),c.preventDefault();const i=c.target,r=c.currentTarget;origin==null||i==null||(e.container=r,e.target=i===r?i.firstElementChild:i,e.offsetX=i===r?e.target.offsetWidth/2:c.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",s),window.addEventListener("pointerup",o))}function s(c){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(c.pointerId),e.init=!0);const i=t(c);e.target.style.left=i+"px",n("move",i)}function o(c){if(c.preventDefault(),c.stopPropagation(),e.container&&e.target){const i=t(c);n("end",i)}e.target&&e.target.releasePointerCapture(c.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",o)}return l}function gc(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const r=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().width/2;let m=i.clientX-r.left-e.offsetX;return m<-u&&(m=-u),m>r.width-u&&(m=r.width-u),m}function l(i){const r=e.container.getBoundingClientRect(),u=e.target.getBoundingClientRect().height/2;let m=i.clientY-r.top-e.offsetY;return m<-u&&(m=-u),m>r.height-u&&(m=r.height-u),m}function s(i){i.stopPropagation(),i.preventDefault();const r=i.target,d=i.currentTarget;origin==null||r==null||(e.container=d,e.target=r===d?r.firstElementChild:r,e.offsetX=r===d?e.target.offsetWidth/2:i.clientX-r.getBoundingClientRect().left,e.offsetY=r===d?e.target.offsetHeight/2:i.clientY-r.getBoundingClientRect().top,window.addEventListener("pointermove",o),window.addEventListener("pointerup",c))}function o(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const r=t(i),d=l(i);e.target.style.left=r+"px",e.target.style.top=d+"px",n("move",{left:r,top:d})}function c(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const r=t(i),d=l(i);n("end",{top:d,left:r})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",c)}return s}const hc=M({__name:"SvPanel",props:{modelValue:{type:Rn,required:!0}},setup(n){const e=n,t=de(),l=de(),s=Oe(i()),o=R(()=>({left:s.left+"px",top:s.top+"px"})),c=gc((r,d)=>{r=="end"&&(s.top=d.top,s.left=d.left);const u=t.value,m=l.value,g=(d.left+m.offsetWidth/2)/u.offsetWidth*100,E=100-(d.top+m.offsetHeight)/u.offsetHeight*100;e.modelValue.setSaturation(g),e.modelValue.setValue(E)});function i(){const r=t.value,d=l.value;if(r==null||d==null)return{top:-6,left:-6};const u=e.modelValue.s,g=(100-e.modelValue.v)/100*r.offsetHeight,E=u/100*r.offsetWidth;return{top:g-d.offsetHeight/2,left:E-d.offsetWidth/2}}return en(()=>{const r=i();s.top=r.top,s.left=r.left}),(r,d)=>(w(),N("div",{class:h(r.classes.svPanel),onPointerdown:d[0]||(d[0]=(...u)=>y(c)&&y(c)(...u)),ref_key:"svPanelRef",ref:t},[f("div",{class:h(r.classes.thumb),style:K(o.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),vc="_svPanel_1sv6o_2",bc="_thumb_1sv6o_10",yc={svPanel:vc,thumb:bc},Ec={classes:yc},_c=z(hc,[["__cssModules",Ec]]),Tc=M({__name:"HueSlider",props:{modelValue:{type:Rn,required:!0}},setup(n){const e=n,t=ue(-6),l=de(),s=de(),o=po((i,r)=>{i=="end"&&(t.value=r);const d=l.value,u=s.value,m=Math.round((r+u.offsetWidth/2)/d.offsetWidth*360);e.modelValue.setHue(m)});function c(){const i=l.value,r=s.value;if(i==null||r==null)return-6;const d=e.modelValue.h;return Math.round(d/360*i.offsetWidth)-r.offsetWidth/2}return en(()=>{t.value=c()}),(i,r)=>(w(),N("div",{class:h(i.classes.hue),onPointerdown:r[0]||(r[0]=(...d)=>y(o)&&y(o)(...d)),ref_key:"hueRef",ref:l},[f("div",{class:h(i.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),Sc="_hue_1ozoc_2",wc="_thumb_1ozoc_10",kc={hue:Sc,thumb:wc},Cc={classes:kc},Rc=z(Tc,[["__cssModules",Cc]]),Nc=M({__name:"AlphaSlider",props:{modelValue:{type:Rn,required:!0}},setup(n){const e=n,t=ue(-6),l=de(),s=de(),o=po((i,r)=>{i=="end"&&(t.value=r);const d=l.value,u=s.value,m=Math.round((r+u.offsetWidth/2)/d.offsetWidth*100);e.modelValue.setAlpha(m)});function c(){const i=l.value,r=s.value;if(i==null||r==null)return-6;const d=e.modelValue.a;return Math.round(d/100*i.offsetWidth)-r.offsetWidth/2}return en(()=>{t.value=c()}),(i,r)=>(w(),N("div",{class:h(i.classes.alpha),onPointerdown:r[0]||(r[0]=(...d)=>y(o)&&y(o)(...d)),ref_key:"alphaRef",ref:l},[f("div",{class:h(i.classes.thumb),style:K({left:t.value+"px"}),ref_key:"thumbRef",ref:s},null,6)],34))}}),Lc="_alpha_1x8jd_2",Ic="_thumb_1x8jd_26",xc={alpha:Lc,thumb:Ic},Ac={classes:xc},qc=z(Nc,[["__cssModules",Ac]]),Dc=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function Oc(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function Mc(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const yl={isSupport:Oc,open:Mc},$c=["title","onClick"],Pc=["title","onClick"],El="quickprint-recent-use-colors",Vc=M({__name:"index",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,s=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],o=ue(new Rn(l.modelValue)),c=de(),i=de(),r=ue(x()),d=yl.isSupport(),u=ue("hex"),m=R(()=>{const _=l.modelValue;return _?{backgroundColor:_}:null}),g=R(()=>{const _=o.value,{r:L,g:k,b:I}=_.rgb();return{"--hue-channel-color":`hsl(${_.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${L}, ${k}, ${I}, 0)`,"--alpha-channel-color-b":`rgba(${L}, ${k}, ${I}, 1)`}}),E=R({get(){return o.value.toString(u.value)},set(_){o.value.setColor(_)}});function v(){var _;(_=c.value)==null||_.close()}function a(_){_!=null&&(t("update:modelValue",_),t("select",_),C(_),v())}function b(){t("update:modelValue",void 0),t("select",void 0),v()}function S(){yl.open().then(_=>a(_))}function x(){const _=localStorage.getItem(El);if(_==null||_=="")return[];const L=vn(_);return L==null?[]:Array.isArray(L)?L:[]}function C(_){const L=r.value,k=L.indexOf(_);k>=0&&L.splice(k,1),L.length>10&&L.pop(),L.unshift(_),localStorage.setItem(El,JSON.stringify(L))}function T(){t("update:modelValue",o.value.toString(u.value)),t("select",o.value.toString(u.value)),v()}return Qn(()=>l.modelValue,()=>o.value.setColor(l.modelValue)),(_,L)=>(w(),J(y(Ql),{class:h(_.classes.colorPicker),onMousedown:L[7]||(L[7]=se(()=>{},["prevent"])),ref_key:"popoverRef",ref:c},{popover:ye(()=>[f("div",{class:h(_.classes.colorPickerPanel)},[f("div",{class:h(_.classes.presetPanel)},[f("div",{class:h(_.classes.presetTools)},[f("button",{type:"button",class:h(_.classes.clearBtn),onClick:b},[f("span",{class:h(_.classes.none)},null,2),L[8]||(L[8]=f("span",null,"无颜色",-1))],2),y(d)?(w(),N("button",{key:0,type:"button",class:h(_.classes.indicator),onClick:S},[p(y(O),{icon:"icon-eye-dropper"}),L[9]||(L[9]=f("span",null,"拾色器",-1))],2)):H("",!0)],2),f("div",{class:h(_.classes.colourAtla)},[(w(!0),N(X,null,ae(y(Dc),k=>(w(),N("div",{style:K({backgroundColor:k}),title:k,class:h(_.classes.color),onClick:I=>a(k)},null,14,$c))),256))],2),f("div",{class:h(_.classes.recentColors)},"最近使用",2),f("div",{class:h(_.classes.colourAtla)},[(w(),N(X,null,ae(10,k=>f("div",{key:k,title:r.value[k-1],style:K({backgroundColor:r.value[k-1]}),class:h(_.classes.color),onClick:I=>a(r.value[k-1])},null,14,Pc)),64))],2)],2),f("div",{class:h(_.pacls.panel),style:K(g.value)},[p(_c,{class:h(_.pacls.sv),modelValue:o.value,"onUpdate:modelValue":L[1]||(L[1]=k=>o.value=k)},null,8,["class","modelValue"]),f("div",{class:h(_.pacls.sliders)},[p(Rc,{class:h(_.pacls.hua),modelValue:o.value,"onUpdate:modelValue":L[2]||(L[2]=k=>o.value=k)},null,8,["class","modelValue"]),p(qc,{modelValue:o.value,"onUpdate:modelValue":L[3]||(L[3]=k=>o.value=k)},null,8,["modelValue"]),f("div",{class:h(_.pacls.preview)},[f("div",{class:h(_.pacls.previewColor),style:K({backgroundColor:o.value.toRGB()})},null,6)],2)],2),f("div",{class:h(_.pacls.tools)},[p(y(Z),{options:s,teleport:"none",modelValue:u.value,"onUpdate:modelValue":L[4]||(L[4]=k=>u.value=k),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Ee(f("input",{type:"text","onUpdate:modelValue":L[5]||(L[5]=k=>E.value=k),onMousedown:L[6]||(L[6]=se(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[xe,E.value]]),f("button",{type:"button",class:h(_.pacls.confirm),onClick:T},"确定",2)],2)],6)],2)]),default:ye(()=>[f("div",{class:h(_.classes.colorPickerInput),ref_key:"inputRef",ref:i},[We(_.$slots,"default",{},()=>[f("span",{class:h(_.classes.colorBlock),style:K(m.value)},null,6)]),n.showText?(w(),N("div",{key:0,class:h(_.classes.colorValue),onClick:L[0]||(L[0]=se(()=>{},["stop"]))},W(n.modelValue),3)):H("",!0)],2)]),_:3},8,["class"]))}}),Bc="_colorPicker_qpnrm_2",Fc="_colorPickerInput_qpnrm_6",zc="_colorBlock_qpnrm_13",Uc="_colorValue_qpnrm_22",Hc="_colorPickerPanel_qpnrm_27",Gc="_presetPanel_qpnrm_42",Wc="_colourAtla_qpnrm_46",Yc="_color_qpnrm_2",jc="_presetTools_qpnrm_73",Xc="_clearBtn_qpnrm_79",Zc="_indicator_qpnrm_80",Kc="_none_qpnrm_98",Jc="_recentColors_qpnrm_129",Qc={colorPicker:Bc,colorPickerInput:Fc,colorBlock:zc,colorValue:Uc,colorPickerPanel:Hc,presetPanel:Gc,colourAtla:Wc,color:Yc,presetTools:jc,clearBtn:Xc,indicator:Zc,none:Kc,recentColors:Jc},eu="_panel_911zv_2",tu="_sv_911zv_7",nu="_hua_911zv_11",lu="_sliders_911zv_15",ou="_tools_911zv_20",su="_confirm_911zv_37 quickprint-text-btn",iu="_preview_911zv_44",ru="_previewColor_911zv_59",au={panel:eu,sv:tu,hua:nu,sliders:lu,tools:ou,confirm:su,preview:iu,previewColor:ru},cu={classes:Qc,pacls:au},lt=z(Vc,[["__cssModules",cu]]);class uu{constructor(e){B(this,"__v_skip",!0);B(this,"observer");B(this,"callbacks",[]);B(this,"handler");this.handler=bi((t,l)=>{for(const s of this.callbacks)s(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function du(n,e){switch(n){case"fontSize":return e===be.DEFAULT?void 0:e;case"fontFamily":return e===oe.DEFAULT?void 0:e;case"lineHeight":return e===pt.DEFAULT?void 0:e;default:return e}}const _l="texteditor-const-node",fu=Object.freeze({CONST:0});class pu{constructor(e,t={}){B(this,"__v_skip",!0);B(this,"emitter",new gn);B(this,"container");B(this,"options");B(this,"observer");B(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new uu(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new gn}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new Go(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(ie(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await yn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=_l,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,s=e[0],o=e[e.length-1];return!this.container.contains(s)||!this.container.contains(o)?!1:(t.removeAllRanges(),l.setStartBefore(s),l.setEndAfter(o),t.addRange(l),!0)}insertNode(e,t){var g;const l=this.getSelection();if(l==null)return!1;const{selection:s,range:o}=l;if(s.isCollapsed!=!0&&s.deleteFromDocument(),s.isCollapsed!=!0)return!1;const c=s.anchorNode;if(c==null)return!1;const i=this.container,r=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(r),c.parentNode===i||(g=c.parentNode)!=null&&g.contains(i))return o.insertNode(r),this.normalize(),this.focusAfterNode(r),!0;const d=c.parentNode;if(d==null)return!1;const u=d.textContent;if(u==null)return!1;if(s.anchorOffset==u.length)return i.insertBefore(r,d.nextSibling),this.normalize(),this.focusAfterNode(r),!0;const m=document.createElement("span");return m.textContent=u.slice(0,s.anchorOffset),d instanceof HTMLElement&&(m.style.cssText=d.style.cssText),d.textContent=u.slice(s.anchorOffset),i.insertBefore(r,d),i.insertBefore(m,r),this.normalize(),this.focusAfterNode(r),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:s}=t;return l.isCollapsed||l.deleteFromDocument(),s.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,s=e.endContainer,o={};return l===t?(o.startNode=t.childNodes[e.startOffset],o.startOffset=-1):(o.startNode=l.parentNode==t?l:l.parentNode,o.startOffset=e.startOffset),s===t?(o.endNode=t.childNodes[e.endOffset],o.endOffset=-1):(o.endNode=s.parentNode==t?s:s.parentNode,o.endOffset=e.endOffset),o}findNodesBetween(e,t){const l=[];let s=e.nextSibling;for(;s!=null&&s!==t;)l.push(s),s=s.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return ie(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var u;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const s=t.range,{startNode:o,startOffset:c,endNode:i,endOffset:r}=this.normalizeRange(s);if(o===i){const m=o.textContent??"";if(o instanceof CharacterData){const v=document.createElement("span");return v.textContent=m.slice(c,r),s.deleteContents(),s.insertNode(v),[v]}const g=document.createElement("span");g.textContent=m.slice(0,c),this.inheritStyle(g,i);const E=document.createElement("span");return E.textContent=m.slice(c,r),this.inheritStyle(E,i),i.textContent=m.slice(r),e.insertBefore(E,i),e.insertBefore(g,E),[E]}const d=this.findNodesBetween(o,i);if(c>0){const m=o.textContent??"",g=document.createElement("span");g.textContent=m.slice(0,c),this.inheritStyle(g,o),o.textContent=m.slice(c),e.insertBefore(g,o)}if(r>=0&&r<=(((u=i.textContent)==null?void 0:u.length)??0)){const m=i.textContent??"";if(i instanceof HTMLElement){i.textContent=m.slice(0,r);const g=document.createElement("span");g.textContent=m.slice(r),this.inheritStyle(g,i),e.insertBefore(g,i.nextSibling),d.push(i)}else{const g=document.createElement("span");g.textContent=m.slice(0,r),e.replaceChild(g,i);const E=document.createTextNode(m.slice(r));e.insertBefore(E,i.nextSibling),d.push(g)}}return d.unshift(o),d}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let s=!0;const o=Ol(e),c=du(e,t);for(let i=0;i<l.length;i++){const r=l[i];if(r instanceof HTMLElement){this.matchElementStyle(r,o,c)||(s=!1);continue}const d=document.createElement("span");d.textContent=r.textContent,this.container.replaceChild(d,r),l[i]=d,s=!1}for(const i of l){if(s||c==null){this.removeElementStyle(i,o,c);continue}this.setElementStyle(i,o,c)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const s=e.style.getPropertyValue(t);return t==="text-decoration-line"?s.includes(l):s==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=gt.push(s,l);e.style.setProperty("text-decoration-line",o);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const s=e.style.getPropertyValue("text-decoration-line"),o=gt.remove(s,l);ie(o)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",o);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+_l)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const mu=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:oe.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],mo=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],go=[{label:"默认",value:oe.DEFAULT},...mo],Nn=[{label:"默认",value:oe.DEFAULT},...mu,...mo],rl=[{label:"默认",value:be.DEFAULT},{label:"初号",value:be.SIZE_0+"pt",short:"56px"},{label:"小初",value:be.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:be.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:be.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:be.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:be.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:be.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:be.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:be.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:be.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:be.SIZE_5+"pt",short:"14px"},{label:"小五",value:be.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],ho=[{label:"默认",value:pt.DEFAULT},{label:"1.0",value:pt.TIMES_1,short:"单倍行距"},{label:"1.1",value:pt.TIMES_1_1},{label:"1.5",value:pt.TIMES_1_5},{label:"2.0",value:pt.TIMES_2,short:"两倍行距"}],gu=[{label:"无",value:an.NONE},{label:"实线",value:Ct.SOLID},{label:"虚线",value:Ct.DASHED},{label:"点划线",value:Ct.DOTTED},{label:"双实线",value:Ct.DOUBLE},{label:"波浪线",value:Ct.WAVY}],hu=[{label:"默认",value:mt.AUTO},{label:"左对齐",value:mt.LEFT},{label:"居中对齐",value:mt.CENTER},{label:"右对齐",value:mt.RIGHT},{label:"两端对齐",value:mt.JUSTIFY}],zn=[{label:"顶部对齐",value:Ge.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:Ge.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:Ge.BOTTOM,icon:"icon-vertical-align-bottom"}],Un=[{label:"左对齐",value:tt.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:tt.CENTER,icon:"icon-align-center"},{label:"右对齐",value:tt.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:tt.JUSTIFY,icon:"icon-menu"}],vu=M({__name:"ParagraphEditor",props:{element:{type:Wo,required:!0}},setup(n){const e=n,t=_e(),l=de(),s=R(()=>e.element.isSelected!==!0?!1:t.state.selectMode===ot.SINGLE);let o=null;const c=R(()=>Nn.map(_=>(_.style={fontFamily:_.value==oe.DEFAULT?oe.SONG:_.value},_)));function i(){}async function r(){if(o==null)return;const _=await sl({doc:t.doc}).catch(et);if(_==null)return;const L=je(_.value,t.doc.ds)??_.value,k={type:fu.CONST,value:_.value,label:L};o.insertNode(k)}function d(){o==null||o.blur()}function u(){o==null||o.autosize()}function m(_){const L=e.element.ds.value,k=new pu(_);return k.on("resize",I=>{var $;const A=($=I.detail)==null?void 0:$.height;A!=null&&e.element.setHeight(A+2)}),k.watch(()=>{const I=k.getHTML(),A=e.element.ds.value;I!==A&&(e.element.ds.value=I,k.checkHeight())}),ie(L)||k.setHTML(L),k}function g(_){o==null||o.setStyle("fontFamily",_.value)}function E(_){o==null||o.setStyle("fontSize",_.value)}function v(_){o==null||o.setStyle("lineHeight",_.value)}function a(_){o==null||o.setStyle("backgroundColor",_)}function b(_){o==null||o.setStyle("color",_)}function S(){o==null||o.setStyle("fontWeight","700")}function x(){o==null||o.setStyle("fontStyle","italic")}function C(){o==null||o.setStyle("textDecorationLine","underline")}function T(){o==null||o.setStyle("textDecorationLine","line-through")}return Qn(()=>e.element.ds.value,_=>{o==null||o.getHTML()==_||o.setHTML(_)}),en(()=>{e.element.on("blur",d),o=m(l.value)}),Jn(()=>{e.element.off("blur",d),o&&o.cleanup()}),(_,L)=>(w(),N("div",{class:h(_.classes.paragraph),onPointerdown:L[2]||(L[2]=se(()=>{},["stop"])),onContextmenu:se(i,["stop","prevent"])},[f("div",{class:h(_.classes.indicator),onPointerdown:L[0]||(L[0]=(...k)=>y(t).onDragStart&&y(t).onDragStart(...k)),title:"选中/拖动段落"},null,34),s.value?(w(),N("div",{key:0,class:h(_.classes.toolbar),onMousedown:L[1]||(L[1]=se(()=>{},["prevent"]))},[p(y(Z),{onSelect:g,title:"字体",width:"60px",options:c.value,class:h(_.classes.tool),button:""},null,8,["options","class"]),p(y(Z),{onSelect:E,title:"字号",width:"60px",options:y(rl),class:h(_.classes.tool),button:""},null,8,["options","class"]),p(y(Z),{onSelect:v,title:"行高",width:"60px",options:y(ho),class:h(_.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),f("div",{class:h(_.classes.divider)},null,2),p(lt,{class:h(_.classes.tool),onSelect:a},{default:ye(()=>[f("div",{class:h(_.classes.colorIcon),title:"突出显示"},[p(y(O),{icon:"icon-bg-color-b",size:"15px"}),f("div",{class:h(_.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(lt,{class:h(_.classes.tool),onSelect:b},{default:ye(()=>[f("div",{class:h(_.classes.colorIcon),title:"字体颜色"},[p(y(O),{icon:"icon-font",size:"15px"}),f("div",{class:h(_.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),f("button",{onClick:S,type:"button",title:"加粗",class:h(["quickprint-text-btn",_.classes.tool])},[p(y(O),{icon:"icon-font-bold",size:"16px"})],2),f("button",{onClick:x,type:"button",title:"斜体",class:h(["quickprint-text-btn",_.classes.tool])},[p(y(O),{icon:"icon-italic",size:"16px"})],2),f("button",{onClick:C,type:"button",title:"下划线",class:h(["quickprint-text-btn",_.classes.tool])},[p(y(O),{icon:"icon-underline",size:"16px"})],2),f("button",{onClick:T,type:"button",title:"删除线",class:h(["quickprint-text-btn",_.classes.tool])},[p(y(O),{icon:"icon-through-line",size:"16px"})],2),f("div",{class:h(_.classes.divider)},null,2),f("button",{class:"quickprint-text-btn",type:"button",onClick:r},[p(y(O),{icon:"icon-insert-var",size:"16px"}),L[3]||(L[3]=f("span",null,"插入变量",-1))]),f("button",{class:"quickprint-text-btn",type:"button",onClick:u},[p(y(O),{icon:"icon-colum-height",size:"16px"}),L[4]||(L[4]=f("span",null,"调整高度",-1))])],34)):H("",!0),f("div",{ref_key:"editorRef",ref:l,class:h(_.classes.editor)},null,2)],34))}}),bu="_paragraph_1v2pj_2",yu="_indicator_1v2pj_6",Eu="_editor_1v2pj_18",_u="_toolbar_1v2pj_44",Tu="_tool_1v2pj_44",Su="_colorIcon_1v2pj_66",wu="_colorIndicator_1v2pj_86",ku="_divider_1v2pj_95",Cu={paragraph:bu,indicator:yu,editor:Eu,toolbar:_u,tool:Tu,colorIcon:Su,colorIndicator:wu,divider:ku},Ru={classes:Cu},Nu=z(vu,[["__cssModules",Ru]]),Ln=Object.freeze({title:"段落",type:j.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:Nu,config:{exclude:[ce.DATASOURCE,ce.BASIC,ce.OVERFLOW]},onCreate(){return me.create({type:j.PARAGRAPH,width:yt*4,height:_n*6})}}),vo=[Sn,wn,kn,Cn,il,fo,Ln],Lu=[Sn,wn,kn,Cn,Ln],Iu={[j.TEXT]:Sn.editor,[j.NUMBER]:wn.editor,[j.DATE]:kn.editor,[j.TABLE]:Cn.editor,[j.TABLE_CELL]:il.editor,[j.PARAGRAPH]:Ln.editor},xu={[j.TEXT]:Sn.config,[j.NUMBER]:wn.config,[j.DATE]:kn.config,[j.TABLE]:Cn.config,[j.TABLE_CELL]:il.config,[j.TABLE_ROW]:fo.config,[j.PARAGRAPH]:Ln.config},Vt=vo.reduce((n,e)=>(n[e.type]=e,n),{});function Au(n){const e=vo.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function qu(n){return Reflect.get(Iu,n)}function Gt(n){return Reflect.get(xu,n)}function Kt(n){var e;return((e=Vt[n])==null?void 0:e.title)??n}function Du(n){var e;return(e=Vt[n])==null?void 0:e.icon}function Ou(n){var e,t;return((t=(e=Vt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function Mu(n){var e,t;return((t=(e=Vt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function $u(n){var e,t;return((t=(e=Vt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Pu(n){var e,t;return((t=(e=Vt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Tl(n,e,t,l){const[s,o]=e.top>t.top?[t,e]:[e,t],c=s.top-l.top,i=o.bottom-s.top;return{top:c,left:n,height:i}}function Sl(n,e,t,l){const[s,o]=e.left>t.left?[t,e]:[e,t],c=s.left-l.left,i=o.right-s.left;return{top:n,left:c,width:i}}function wl(n,e){const t=n.find(r=>r.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,s=t.top+t.height,o=Math.min(t.top,e.top),i=Math.max(l,s)-o;t.top=o,t.height=i}function kl(n,e){const t=n.find(r=>r.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,s=t.left+t.width,o=Math.min(t.left,e.left),i=Math.max(l,s)-o;t.left=o,t.width=i}function Vu(n){const e=document.createElement("div");return n.appendChild(e),e}function Bu(n,e){const t=[...e.querySelectorAll(":scope ."+G.GUIDE_LINE)];for(const l of n){const s=t.shift()??Vu(e);s.className=G.GUIDE_LINE,s.style.top=l.top+"px",s.style.left=l.left+"px",s.style.height=(l.height??1)+"px",s.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function Fu(n,e){const l=e.querySelectorAll(":scope ."+G.ELEMENT),s=e.getBoundingClientRect(),o=n.getBoundingClientRect(),c=[];for(const i of l){if(n==i)continue;const r=i.getBoundingClientRect();if(Math.abs(o.left-r.left)<=1||Math.abs(o.right-r.left)<=1){const d=r.left-s.left;wl(c,Tl(d,o,r,s))}if(Math.abs(o.left-r.right)<=1||Math.abs(o.right-r.right)<=1){const d=r.right-s.left;wl(c,Tl(d,o,r,s))}if(Math.abs(o.top-r.top)<=1||Math.abs(o.bottom-r.top)<=1){const d=r.top-s.top;kl(c,Sl(d,o,r,s))}if(Math.abs(o.bottom-r.bottom)<=1||Math.abs(o.top-r.bottom)<=1){const d=r.bottom-s.top;kl(c,Sl(d,o,r,s))}}Bu(c,e)}function zu(){const n=document.querySelectorAll("."+G.GUIDE_LINE);for(const e of n)e.remove()}const bn={create:yi(Fu,50),clean:zu};async function Uu(n){await yn(),n&&Reflect.deleteProperty(n,En)}async function Hu(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const o=document.createElement("div");o.className="quickprint-is-indicator",e.indicatorElement=o,document.body.appendChild(o)}const t=Gu(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,s=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=s.left+"px",l.style.top=s.top-Xl(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function Gu(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Le.INSERT){const s=t.closest("."+G.PAGE);if(s==null)return null;const o=s.getBoundingClientRect();return{x:l?Nt(e.left-o.left):Math.round(e.left-o.left),y:l?Nt(e.top-o.top):Math.round(e.top-o.top),w:e.element.width,h:e.element.height}}return{x:l?Nt(e.left):Math.round(e.left),y:l?Nt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function Wu(n){return!(n.style.rotate&&!n.isSelected)}function Yu(n){const e=new Bn({selector:{container:G.DROPPABLE},scale(t){return t.mode===Le.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,zl),o=Reflect.get(l.target,el);s===Le.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=s===Le.INSERT?s:Le.MOVE,l.elementType=o,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Le.INSERT){const o=Au(l.elementType);l.element=o,l.ghost.style.width=o.width+"px",l.ghost.style.height=o.height+"px";return}const s=Reflect.get(l.target,Ye);if(s==null||!Wu(s))return t.preventDefault();l.element=s}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Le.INSERT&&(l.ghost.style.display="block"),l.mode===Le.MOVE&&Reflect.set(l.target,En,tl.DRAG_ELEMENT),l.ghost.classList.add(G.DRAGGING),l.initDragElement=!0),Hu(n,l),l.dropTarget&&bn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;bn.clean(),l.ghost.classList.remove(G.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Le.INSERT&&(l.ghost.style.display="none"),l.mode==Le.MOVE&&Uu(l.target);const s=l.element;if(l.mode==Le.MOVE){s.setTop(l.top),s.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),n.selectElement(s),n.createSnapshot();return}if(l.dropTarget==null)return;const o=Reflect.get(l.dropTarget,Ul);if(o==null)return;const c=o instanceof _t||o instanceof me?o:null;if(c==null)return;const i=l.dropTarget.getBoundingClientRect(),r=n.state.scale/100;s.setTop((l.top-i.top)/r),s.setLeft((l.left-i.left)/r),s.setWidth(s.width/r),s.setHeight(s.height/r),c.append(l.element),n.selectElement(s),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const Cl="quickprint-history-0000",ju=1,Ke="snapshot",dn="health",Rl="owner",Fe="INDEX_OWNER",Xu=15*60*1e3,Zu=10*60*1e3;function Ku(){const n={db:null,timer:null,promise:null};async function e(){const u=await r(dn,"readwrite");if(u==null)return n.timer=o(),!1;const m=[],g=u.openCursor();g.onsuccess=async function(E){const v=E.target.result;if(v==null){t(m),n.timer=o(),Ie.debug("History","已检查无效快照");return}const a=v.value;a!=null&&Date.now()-a.timestamp>Xu&&m.push(a),v.continue()},g.onerror=function(E){console.error(E),n.timer=o()}}async function t(u){const m=await Promise.allSettled(u.map(g=>l(g.owner)));for(let g=0;g<m.length;g++){const E=m[g];E.status==="rejected"||E.value!==!0||s(u[g].id)}}async function l(u){const m=await r(Ke,"readwrite");return m==null?!1:new Promise(g=>{const E=m.index(Fe).openCursor(IDBKeyRange.only(u));E.onsuccess=function(v){const a=v.target.result;if(a==null)return g(!0);a.delete(),a.continue()},E.onerror=function(v){console.error(v),g(!1)}})}async function s(u){const m=await r(dn,"readwrite");return m==null?!1:jt(m.delete(u)).then(()=>!0).catch(g=>(console.log(g),!1))}function o(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),Zu)}function c(){return new Promise(u=>{const m=indexedDB.open(Cl,ju);m.onupgradeneeded=g=>{const v=g.target.result,a=v.createObjectStore(dn,{keyPath:"id",autoIncrement:!0}),b=v.createObjectStore(Ke,{keyPath:"id",autoIncrement:!0});a.createIndex(Fe,Rl),b.createIndex(Fe,Rl)},m.onsuccess=g=>{const E=g.target;n.db=E.result,Ie.debug("History",`已连接数据库【${Cl}】`),u(n.db)},m.onerror=function(g){console.error(g),n.db=null,u(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function r(u,m="readonly"){const g=await i();if(g==null)return null;try{return g.transaction(u,m).objectStore(u)}catch(E){return console.error(E),null}}function d(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=c(),n.timer=o(),e(),{ready:i,findStore:r,cleanup:d}}function jt(n){return new Promise((e,t)=>{n.onsuccess=function(l){const s=l.target;e(s.result)},n.onerror=function(l){console.error(l),t()}})}const Ju=5*60*1e3,ut=Ku();var ze,De,fn,Hn,bo;class Qu{constructor(e,t={}){Be(this,De);B(this,"state");B(this,"owner");Be(this,ze);this.state=e,this.owner=t.owner??Yo(jo.HISTORY_OWNER),ke(this,De,Hn).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await ut.findStore(Ke,"readwrite");if(l==null)return!1;await ke(this,De,bo).call(this,l);const s=this.state.index+1,o={index:s,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await jt(l.put(o)).catch(et)==null?!1:(this.state.index=s,this.state.count=s+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const s=await ut.findStore(Ke,"readwrite");return!(s==null||(l.data=JSON.stringify(e),await jt(s.put(l)).catch(et)==null))}async getCurrentSnapshot(){const e=await ut.findStore(Ke);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Fe).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=c=>{const i=c.target.result;if(i==null)return s(null);const r=i.value;if(r.owner!=l)return i.continue();if(r.index==t)return s(r);i.continue()},o.onerror=function(c){console.error(c),s(null)}})}async getPrevSnapshot(){const e=await ut.findStore(Ke);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Fe).openCursor(IDBKeyRange.only(l),"prev");o.onsuccess=c=>{const i=c.target.result;if(i==null)return s(null);const r=i.value;if(r.owner!=l)return i.continue();if(r.index==t)return this.state.index=t,s(i.value);i.continue()},o.onerror=function(c){console.error(c),s(null)}})}async getNextSnapshot(){const e=await ut.findStore(Ke);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(s=>{const o=e.index(Fe).openCursor(IDBKeyRange.only(l),"next");o.onsuccess=c=>{const i=c.target.result;if(i==null)return s(null);const r=i.value;if(r.owner!=l)return i.continue();if(r.index==t)return this.state.index=t,s(i.value);i.continue()},o.onerror=function(c){console.error(c),s(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await ut.findStore(Ke);if(e==null)return[];const t=this.owner;return new Promise(l=>{const s=e.index(Fe).openCursor(IDBKeyRange.only(t),"prev"),o=[];s.onsuccess=c=>{const i=c.target.result;if(i==null)return l(o);const r=i.value;if(r.owner!=t)return i.continue();o.push(r),i.continue()},s.onerror=function(c){console.error(c),l([])}})}cleanup(){we(this,ze)&&(clearTimeout(we(this,ze)),at(this,ze,null))}}ze=new WeakMap,De=new WeakSet,fn=function(){at(this,ze,setTimeout(()=>ke(this,De,Hn).call(this),Ju))},Hn=async function(){we(this,ze)&&clearTimeout(we(this,ze));const e=await ut.findStore(dn,"readwrite");if(e==null)return ke(this,De,fn).call(this);const t=await jt(e.index(Fe).get(this.owner)).catch(et);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),ke(this,De,fn).call(this)}t.timestamp=Date.now(),await jt(e.put(t)).catch(et),ke(this,De,fn).call(this)},bo=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const s=this.owner;return new Promise(o=>{const c=e.index(Fe).openCursor(IDBKeyRange.only(s),"prev");c.onsuccess=function(i){const r=i.target.result;if(r==null)return o(!0);const d=r.value;if(d.owner!=s)return r.continue();if(d.index>t){r.delete(),r.continue();return}o(!0)},c.onerror=function(i){console.error(i),o(!1)}})};function ed(n){const e=new Qu(Oe({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function s(u){return e.createSnapshot(n.value,u)}function o(u){return e.replaceSnapshot(n.value,u)}async function c(){const u=await e.getPrevSnapshot();if(u==null)return!1;const m=vn(u.data);return m==null?!1:(n.value=he.create(m),!0)}async function i(){const u=await e.getNextSnapshot();if(u==null)return!1;const m=vn(u.data);return m==null?!1:(n.value=he.create(m),!0)}function r(){return e.list()}function d(){e.cleanup()}return s(),{allowRedo:l,allowUndo:t,createSnapshot:s,undo:c,redo:i,list:r,cleanup:d,replaceSnapshot:o}}class td{constructor(e){B(this,"moved",!1);B(this,"position");B(this,"top",0);B(this,"left",0);B(this,"width",0);B(this,"height",0);B(this,"initX",0);B(this,"initY",0);B(this,"indicator");B(this,"container");B(this,"originalEvent");B(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Dt,Ot,it,yo,Eo,_o;const Te=class Te extends gn{constructor(t={}){var l,s,o;super();Be(this,it);B(this,"context",null);B(this,"selector");B(this,"scale");B(this,"onResizeStart");Be(this,Dt);Be(this,Ot);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??G.PAGE,element:((s=t.selector)==null?void 0:s.element)??G.RESIZEABLE,indicator:((o=t.selector)==null?void 0:o.indicator)??G.RESIZEABLE_INDICATOR},this.onResizeStart=ke(this,it,yo).bind(this),at(this,Dt,ke(this,it,Eo).bind(this)),at(this,Ot,ke(this,it,_o).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",we(this,Dt)),window.removeEventListener("pointerup",we(this,Ot)),this.context=null}};Dt=new WeakMap,Ot=new WeakMap,it=new WeakSet,yo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return Ie.warn(Te.TAG_NAME,"未找到的可调整元素");const s=Reflect.get(l,Hl);if(s==null)return Ie.warn(Te.TAG_NAME,"未找到的可调整元素");const o=l.closest("."+this.selector.element);if(o==null)return Ie.warn(Te.TAG_NAME,"未找到的可调整元素");const c=jl(o,this.selector.container);this.context=new td({event:t,indicator:l,target:o,container:c,position:s});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return Ie.warn(Te.TAG_NAME,"已取消调整");if(this.context.container==null)return Ie.warn(Te.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const r=this.createEvent("resizestart",this.context);if(this.dispatch(r).defaultPrevented)return Ie.warn(Te.TAG_NAME,"已取消调整");window.addEventListener("pointermove",we(this,Dt)),window.addEventListener("pointerup",we(this,Ot))},Eo=function(t){const l=this.context;if(l==null)return;const s=l.position,o=this.normalizeScale(),c=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(s&Yt.TOP){const d=Math.max((i.bottom-t.clientY)/o,Te.MIN_LENGTH);l.top=(i.bottom-c.top)/o-d,l.height=d}if(s&Yt.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/o,Te.MIN_LENGTH)),s&Yt.LEFT){const d=Math.max((i.right-t.clientX)/o,Te.MIN_LENGTH);l.left=(i.right-c.left)/o-d,l.width=d}s&Yt.RIGHT&&(l.width=Math.max((t.clientX-i.left)/o,Te.MIN_LENGTH));const r=this.createEvent("resizing",l);this.dispatch(r).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},_o=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const s=this.createEvent("resizeend",l);this.dispatch(s).defaultPrevented||this.reset()},B(Te,"TAG_NAME","quickprint-resizeable"),B(Te,"MIN_LENGTH",12);let Gn=Te;async function nd(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?Nt(e.width):Math.round(e.width),s=t?Nt(e.height):Math.round(e.height),o=e.indicatorElement,c=e.target.getBoundingClientRect();o.style.display="block",o.style.left=c.left+"px",o.style.top=c.top-Xl(e.element)+"px",o.textContent=`x:${e.top},y:${e.left},w:${l},h:${s}`}function ld(n){const e=new Gn({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const s=Reflect.get(l.target,Ye);if(s==null)return t.preventDefault();l.element=s}),e.on("resizing",t=>{const l=t.detail;l!=null&&(nd(n,l),bn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const s=l.element;s.setTop(l.top),s.setLeft(l.left),s.setWidth(l.width),s.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),bn.clean()}),n.onResizeStart=e.onResizeStart,e}function od(n){function e(c){const i=document.activeElement,r=c.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||r.closest(".quickprint-text-editor")!=null}function t(){const c=n.doc.firstPage;if(n.state.selectMode===pe.PAGE){const i=n.state.selectedPage;return i==null?c:n.doc.findPage(i)??c}if(n.state.selectMode===pe.ELEMENT){const i=n.getSelectedElements()[0];return i==null?c:i.page??c}return c}function l(c){if(!(e(c)||Xo()))switch(c.key){case"Delete":case"Backspace":return c.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(c.ctrlKey)return c.preventDefault(),n.history.redo();case"Z":case"z":if(c.ctrlKey)return c.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;c.preventDefault(),c.stopPropagation();const r=c.key==="ArrowUp"?-1:1,d=i.map(u=>u.setTop(u.top+r,!0)?u:null).filter(u=>u!=null);d.length>0&&n.replaceSnapshot("top",d);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;c.preventDefault(),c.stopPropagation();const r=c.key==="ArrowLeft"?-1:1,d=i.map(u=>u.setLeft(u.left+r,!0)?u:null).filter(u=>u!=null);d.length>0&&n.replaceSnapshot("left",d);return}case"P":case"p":if(c.ctrlKey)return c.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(c.ctrlKey)return c.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(c.ctrlKey){c.preventDefault();const r=n.doc.pages.reduce((d,u)=>d.concat(u.children),[]);return n.multiSelectElements(r)}case"C":case"c":{const i=n.getSelectedElements();if(c.ctrlKey&&i.length>0)return c.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(c.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const r=t();for(const d of i)d.setLeft(d.left+8),d.setTop(d.top+8),r.append(d);n.createSnapshot()})}}function s(){window.addEventListener("keydown",l)}function o(){window.removeEventListener("keydown",l)}return{enable:s,disable:o}}const on="openprint:element,";function sd(n){function e(){return navigator.clipboard.readText().catch(r=>(console.log(r),null))}function t(r){return navigator.clipboard.writeText(r).catch(d=>{console.log(d)})}async function l(){const r=await e();if(r==null||!r.startsWith(on))return[];t("");const d=vn(Ko(r.slice(on.length)),[]);return d.length===0?[]:d.map(u=>(delete u.id,me.create(u))).sort(me.sort)}function s(r){const d=`${on}${Zo(JSON.stringify(r))}`;return t(d)}async function o(){const r=await e();return typeof r=="string"&&r.startsWith(on)}function c(){}function i(r){}return{readElement:l,writeElement:s,hasElement:o,readStyle:c,writeStyle:i}}const To=Symbol();function id(){return{panel:{left:!0,right:!0},scale:100,selectedType:pe.NONE,selectedPage:void 0,selectMode:ot.SINGLE,selected:[]}}function rd(n,e){const t=Oe(id()),l=ed(n),o={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:r,selectPage:m,selectElement:g,resetSelectedElement:E,deleteSelectedElement:v,multiSelectElements:a,zoomIn:S,zoomOut:b,toggleBackground:x,toggleElementPanel:C,toggleConfigPanel:T,getSelectedElements:d,getSelectedPage:u,cleanup:L,replaceSnapshot:_},c=Yu(o),i=ld(o);o.shortcut=od(o),o.createSnapshot=l.createSnapshot,o.clipboard=sd();function r(k){o.document.value=k,o.history.createSnapshot()}function d(){const k=t.selected;return k.length==0?[]:k.map(I=>o.doc.findElement(I)).filter(I=>I!=null)}function u(){var I;const k=t.selectedPage;if(k!=null)return(I=n.value)==null?void 0:I.findPage(k)}function m(k){return E(),t.selectedPage=k.id,t.selectedType=pe.PAGE,!0}function g(k){t.selectMode=ot.SINGLE,t.selectedType=pe.ELEMENT,t.selectedPage=void 0;const I=d();for(const A of I)A.id!==k.id&&A.blur();return k.focus(),t.selected=[k.id],!0}function E(){const k=d();for(const I of k)I.blur();return t.selected=[],t.selectedType=pe.NONE,!0}function v(){if(t.selectedType!=pe.ELEMENT||t.selected.length==0)return!1;let k=!1;const I=d();for(const A of I)A.remove()&&(k=!0);return k&&o.history.createSnapshot(),!0}function a(k){t.selectMode=ot.MULTIPLE,t.selectedType=pe.ELEMENT,t.selectedPage=void 0;const I=d();for(const A of I)A.blur();for(const A of k)A.focus();return t.selected=k.map(A=>A.id),!0}function b(){const k=t.scale??100,I=Ut.indexOf(k);return I<0?(t.scale=100,!1):I>=Ut.length-1?!1:(t.scale=Ut[I+1],!0)}function S(){const k=t.scale??100,I=Ut.indexOf(k);return I<0?(t.scale=100,!1):I==0?!1:(t.scale=Ut[I-1],!0)}function x(){const I=o.doc.attributes.grid==null?!0:void 0;o.doc.attributes.grid=I}function C(){o.state.panel.left=!o.state.panel.left}function T(){o.state.panel.right=!o.state.panel.right}function _(k,I){const A=I??o.doc,$=Array.isArray(A)?"element":A instanceof he?"document":A instanceof _t?"page":"element",F=Array.isArray(A)?A.map(te=>te.id).join(","):A.id,P=`${$}:${F}:${k}`;return l.replaceSnapshot({action:P})}function L(){c.cleanup(),i.cleanup(),l.cleanup(),o.shortcut.disable(),o.doc.cleanup()}return o.shortcut.enable(),o.selectPage(n.value.firstPage),Bl(To,o),Jn(L),o}function _e(){return Vl(To)}const ad=M({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Ne("classes"),l=_e(),s=R(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),o=R(()=>{const a=e.page.id,b=l.doc.pages.find(S=>S.id===a);return b==null?0:e.direction=="horizontal"?b.width:b.height}),c=R(()=>{const a=o.value,b=[];for(let S=0;S<=a;S+=10)b.push(S/10);return b}),i=R(()=>{const a=o.value,b=[];for(let S=0;S<=a;S+=2.5)b.push(S);return b}),r=R(()=>{const a=l.getSelectedElements();return a.length==1?a[0]:null}),d=R(()=>e.direction==="horizontal"?{height:"100%",width:o.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:o.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),u=R(()=>{const a=r.value;if(a==null)return 0;if(a.type==="TableCell"){const b=a.parent;if(b==null)return 0;const S=b.parent;return b==null?0:S.top+b.offsetTop}if(a.type==="TableRow"){const b=a.parent;return b==null?0:b.top+a.offsetTop}return a.top}),m=R(()=>{const a=r.value;if(a==null)return 0;if(a.type==="TableCell"){const b=a.parent;if(b==null)return 0;const S=b.parent;return b==null?0:S.left+a.offsetLeft}if(a.type==="TableRow"){const b=a.parent;return b==null?0:b.left}return a.left});function g(a,b){return e.direction==="horizontal"?{left:a*(e.scale/100)+"mm",height:(b-2)%4==0?"8px":"4px"}:{top:a*(e.scale/100)+"mm",width:(b-2)%4==0?"8px":"4px"}}function E(a){return e.direction==="horizontal"?{left:a*(e.scale/100)+"cm"}:{top:a*(e.scale/100)+"cm"}}function v(a){return e.direction==="horizontal"?{left:m.value*(e.scale/100)+"px",width:a.width*(e.scale/100)+"px",height:"100%"}:{top:u.value*(e.scale/100)+"px",height:a.height*(e.scale/100)+"px",width:"100%"}}return(a,b)=>(w(),N("div",{class:h(s.value)},[f("div",{class:h(y(t).ruler),style:K(d.value)},[r.value?(w(),N("div",{key:0,class:h(y(t).selected),style:K(v(r.value))},null,6)):H("",!0),(w(!0),N(X,null,ae(i.value,(S,x)=>(w(),N("div",{key:S,class:h(y(t).scale),style:K(g(S,x))},null,6))),128)),(w(!0),N(X,null,ae(c.value,S=>(w(),N("div",{class:h(y(t).number),style:K(E(S))},W(S),7))),256))],6)],2))}}),cd="_horizontalRuler_170u5_2",ud="_verticalRuler_170u5_15",dd="_ruler_170u5_27",fd="_scale_170u5_32",pd="_number_170u5_46",md="_selected_170u5_71",gd={horizontalRuler:cd,verticalRuler:ud,ruler:dd,scale:fd,number:pd,selected:md},hd={classes:gd},Nl=z(ad,[["__cssModules",hd]]),vd=["title"],sn=8,bd=M({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,s=Ne("classes"),o={},c=_e(),i=R(()=>({top:Math.round(t.top*t.zoom)+"px"}));function r(g){if(g.button!=0||t.disabled===!0)return;const E=g.target.closest("."+s.dragLine);E!=null&&(g.stopPropagation(),o.init=!1,o.target=E,o.parent=E.offsetParent,o.target.setPointerCapture(g.pointerId),window.addEventListener("pointermove",d),window.addEventListener("pointerup",u))}function d(g){g.preventDefault();const E=m(o.parent);let v=g.clientY-E.top;v<0&&(v=0),v>E.height&&(v=E.height),t.min>0&&v<t.min+sn&&(v=t.min+sn),t.max>0&&v>t.max-sn&&(v=t.max-sn),o.target.style.top=v/(c.state.scale/100)+"px",o.top=v,o.init=!0}function u(g){o.init===!0&&l("move",{top:o.top/(c.state.scale/100)}),o.target.releasePointerCapture(g.pointerId),window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",u)}function m(g){return g instanceof HTMLElement?g.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(g,E)=>(w(),N("div",{class:h({[y(s).dragLine]:!0,[y(s).disabled]:n.disabled}),style:K(i.value),onPointerdown:se(r,["stop"]),title:n.title},null,46,vd))}}),yd="_dragLine_1m7rt_2",Ed="_disabled_1m7rt_26",_d={dragLine:yd,disabled:Ed},Td={classes:_d},Ll=z(bd,[["__cssModules",Td]]),Sd=M({__name:"Selection",setup(n,{expose:e}){const t=de(),l=de(),s=Pt("selectionRef"),o=de(),c=_e();let i=[];function r(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function d(){const v=[],a=l.value;if(a==null)return v;const b=u(a);if(b.length==0)return v;const S=s.value;return b.forEach(x=>{if(!ks(x,S)){x.classList.remove(G.SELECTED);return}const C=Reflect.get(x,Ye);C instanceof me&&(x.classList.add(G.SELECTED),v.push(C))}),v}function u(v){if(v.matches("."+G.ELEMENT)){const a=Reflect.get(v,Ye);if(a&&a.type===j.TABLE)return v.querySelectorAll(":scope td")}return v.querySelectorAll(`:scope .${G.PAGE} > .${G.SELECTABLE}`)}function m(v,a){const b=a.closest("."+G.PAPER);if(b==null)return;v.stopPropagation(),v.preventDefault();const S=r(),x=b.getBoundingClientRect();S.initialX=v.clientX,S.initialY=v.clientY,S.top=v.clientY-x.top,S.left=v.clientX-x.left,l.value=a,o.value=S,t.value=b,i=[],window.addEventListener("pointermove",g),window.addEventListener("pointerup",E)}function g(v){const a=o.value;if(a==null)return;v.stopPropagation(),v.preventDefault();const b=s.value;if(a.init!==!0){if(Math.abs(v.clientX-a.initialX)<4&&Math.abs(v.clientY-a.initialY)<4)return;b.setPointerCapture(v.pointerId),b.style.display="block",a.init=!0}const S=Math.abs(v.clientX-a.initialX),x=Math.abs(v.clientY-a.initialY),C=v.clientX<a.initialX?-S:0,T=v.clientY<a.initialY?-x:0;b.style.top=a.top+T+"px",b.style.left=a.left+C+"px",b.style.width=S+"px",b.style.height=x+"px",i=d()}function E(v){const a=o.value;if(a==null)return;a.init&&(v.stopPropagation(),v.preventDefault()),i.length>0&&c.multiSelectElements(i);const b=s.value;b.releasePointerCapture(v.pointerId),b.style.display="none",o.value=void 0,window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",E)}return e({onSelectStart:m}),(v,a)=>(w(),N("div",{ref_key:"selectionRef",ref:s,class:h(v.classes.selection),onClick:a[0]||(a[0]=se(()=>{},["stop"]))},null,2))}}),wd="_selection_10jfe_2",kd={selection:wd},Cd={classes:kd},Rd=z(Sd,[["__cssModules",Cd]]),Nd={class:"quickprint-is-row"},Ld=["onClick"],Id=M({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Ne("classes"),s=e,o=n,c=de(),i=R(()=>({height:o.height})),r=R({get(){return He(o.modelValue).num??void 0},set(v){if(v==""||Jo(v)||v<0){m(void 0);return}const a=He(o.modelValue);m(`${v}${a.unit}`)}}),d=R({get(){return He(o.modelValue).unit??Re.PX},set(v){const a=He(o.modelValue);m(`${a.num}${v}`)}});function u(v){const a=v===be.DEFAULT?void 0:v;s("update:modelValue",a)}function m(v){s("update:modelValue",v),E()}function g(v){const a=o.modelValue;return a==null&&v.value===be.DEFAULT?!0:a===v.value}async function E(){await $t();const v=document.querySelector("."+l.fontSelected);v&&v.scrollIntoView({block:"nearest"})}return(v,a)=>(w(),N("div",{class:h(y(l).fontSize),style:K(i.value)},[f("div",Nd,[Ee(f("input",{type:"number",placeholder:"请输入",class:h(["quickprint-form-control",y(l).input]),min:0,"onUpdate:modelValue":a[0]||(a[0]=b=>r.value=b)},null,2),[[xe,r.value]]),p(y(Z),{width:"54px",options:t,modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=b=>d.value=b)},null,8,["modelValue"])]),f("div",{class:h(["quickprint-is-fill-h quickprint-is-scrollable",y(l).fonts]),ref_key:"scrollRef",ref:c},[(w(!0),N(X,null,ae(y(rl),b=>(w(),N("div",{key:b.value,class:h({[y(l).option]:!0,[y(l).fontSelected]:g(b)}),onClick:S=>u(b.value)},[f("span",null,W(b.label),1)],10,Ld))),128))],2)],6))}}),xd="_input_9oh9n_2",Ad="_fontSize_9oh9n_8",qd="_fonts_9oh9n_13",Dd="_option_9oh9n_25",Od="_fontSelected_9oh9n_34",Md={input:xd,fontSize:Ad,fonts:qd,option:Dd,fontSelected:Od},$d={classes:Md},So=z(Id,[["__cssModules",$d]]),Pd=["title"],Vd={key:0},Bd="中文字体 AbBbCc",Fd=M({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=R(()=>Nn.map(a=>(a.style={fontFamily:a.value==oe.DEFAULT?oe.SONG:a.value},a))),l=R(()=>go.map(a=>(a.style={fontFamily:a.value==oe.DEFAULT?oe.SONG:a.value},a))),s=R({get(){const a=e.options.style.fontFamily;return ie(a)?oe.DEFAULT:a},set(a){e.options.style.fontFamily=a==oe.DEFAULT?void 0:a}}),o=R({get(){const a=e.options.style.enFontFamily;return ie(a)?oe.DEFAULT:a},set(a){e.options.style.enFontFamily=a==oe.DEFAULT?void 0:a}}),c=R({get(){const a=e.options.style.color;return ie(a)?Ce.DEFAULT:a},set(a){e.options.style.color=a==Ce.DEFAULT?void 0:a}}),i=R({get(){const a=e.options.style.highlightColor;return ie(a)?Ce.DEFAULT:a},set(a){e.options.style.highlightColor=a==Ce.DEFAULT?void 0:a}}),r=R({get(){return e.options.style.fontSize},set(a){const b=ie(a)?void 0:a;e.options.style.fontSize=b}}),d=R({get(){return e.options.style.fontWeight===700},set(a){e.options.style.fontWeight=a?700:void 0}}),u=R({get(){return e.options.style.fontStyle==="italic"},set(a){e.options.style.fontStyle=a?"italic":void 0}}),m=R({get(){return e.options.style.lineThrough===!0},set(a){e.options.style.lineThrough=a?!0:void 0}}),g=R({get(){const a=e.options.style.underline;if(a==null||a===!1)return an.NONE;const b=e.options.style.underlineStyle;return ie(b)?Ct.SOLID:b},set(a){if(a===an.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=a}}),E=R({get(){const a=e.options.style.underlineColor;return ie(a)?Ce.DEFAULT:a},set(a){e.options.style.underlineColor=a==Ce.DEFAULT?void 0:a}}),v=R(()=>{const a=e.options.style,b={},S=nl(a.fontFamily,a.enFontFamily);S&&(b.fontFamily=S);const x=no(a);return x&&Je(b,x),a.fontSize&&(b.fontSize=a.fontSize),a.fontWeight&&(b.fontWeight=a.fontWeight),a.color&&(b.color=a.color),a.fontStyle&&(b.fontStyle=a.fontStyle),a.highlightColor&&(b["--quickprint-variable-highlight-color"]=a.highlightColor),b});return(a,b)=>(w(),N("div",{class:h(["quickprint-is-scrollable quickprint-is-fill-h",a.classes.font])},[f("div",{class:h(a.classes.fontFamily)},[f("div",{class:h(a.classes.config)},[f("div",{class:h(a.classes.title)},"中文字体",2),f("div",{class:h(a.classes.content)},[p(y(Z),{options:t.value,modelValue:s.value,"onUpdate:modelValue":b[0]||(b[0]=S=>s.value=S)},null,8,["options","modelValue"])],2)],2),f("div",{class:h(a.classes.config)},[f("div",{class:h(a.classes.title)},"颜色",2),p(lt,{modelValue:c.value,"onUpdate:modelValue":b[1]||(b[1]=S=>c.value=S)},{default:ye(()=>[f("div",{class:h(a.classes.indicator)},[f("div",{class:h({[a.classes.colorBlock]:!0,[a.classes.colorNone]:c.value===y(Ce).DEFAULT}),style:K({backgroundColor:c.value})},null,6),f("div",{class:h(a.classes.colorValue)},W(c.value==y(Ce).DEFAULT?"默认":c.value),3)],2)]),_:1},8,["modelValue"])],2),f("div",{class:h([a.classes.config,a.classes.fontSize])},[f("div",{class:h(a.classes.title)},"字号",2),p(So,{modelValue:r.value,"onUpdate:modelValue":b[2]||(b[2]=S=>r.value=S),height:"144px"},null,8,["modelValue"])],2),f("div",{class:h(a.classes.config)},[f("div",{class:h(a.classes.title)},"西文字体",2),f("div",{class:h(a.classes.content)},[p(y(Z),{options:l.value,modelValue:o.value,"onUpdate:modelValue":b[3]||(b[3]=S=>o.value=S)},null,8,["options","modelValue"])],2)],2),f("div",{class:h(a.classes.config)},[f("div",{class:h(a.classes.title)},"前景色",2),p(lt,{modelValue:i.value,"onUpdate:modelValue":b[4]||(b[4]=S=>i.value=S)},{default:ye(()=>[f("div",{class:h(a.classes.indicator)},[f("div",{class:h({[a.classes.colorBlock]:!0,[a.classes.colorNone]:i.value===y(Ce).DEFAULT}),style:K({backgroundColor:i.value})},null,6),f("div",{class:h(a.classes.colorValue)},W(i.value==y(Ce).DEFAULT?"默认":i.value),3)],2)]),_:1},8,["modelValue"])],2),f("div",{class:h(a.classes.config)},[f("div",{class:h(a.classes.title)},"下划线",2),f("div",{class:h(a.classes.content)},[p(y(Z),{modelValue:g.value,"onUpdate:modelValue":b[5]||(b[5]=S=>g.value=S),options:y(gu),width:"138px"},{option:ye(({option:S})=>[f("div",{title:S.label,class:h(a.classes.option)},[S.value==y(an).NONE?(w(),N("div",Vd,W(S.label),1)):(w(),N("div",{key:1,class:h(a.classes.line),style:K({textDecorationStyle:S.value})},"--",6))],10,Pd)]),_:1},8,["modelValue","options"])],2)],2),f("div",{class:h(a.classes.config)},[f("div",{class:h(a.classes.title)},"线条颜色",2),f("div",{class:h(a.classes.content)},[p(lt,{modelValue:E.value,"onUpdate:modelValue":b[6]||(b[6]=S=>E.value=S),class:"quickprint-w-full"},{default:ye(()=>[f("div",{class:h(a.classes.indicator)},[f("div",{class:h({[a.classes.colorBlock]:!0,[a.classes.colorNone]:E.value===y(Ce).DEFAULT}),style:K({backgroundColor:E.value})},null,6),f("div",{class:h(a.classes.colorValue)},W(E.value==y(Ce).DEFAULT?"默认":E.value),3)],2)]),_:1},8,["modelValue"])],2)],2)],2),f("div",{class:h(a.classes.fieldset)},[b[13]||(b[13]=f("header",null,"效果",-1)),f("div",{class:h(a.classes.configs)},[f("label",{class:h(a.classes.checkbox)},[Ee(f("input",{type:"checkbox","onUpdate:modelValue":b[7]||(b[7]=S=>d.value=S)},null,512),[[On,d.value]]),b[10]||(b[10]=f("span",null,"粗体",-1))],2),f("label",{class:h(a.classes.checkbox)},[Ee(f("input",{type:"checkbox","onUpdate:modelValue":b[8]||(b[8]=S=>u.value=S)},null,512),[[On,u.value]]),b[11]||(b[11]=f("span",null,"斜体",-1))],2),f("label",{class:h(a.classes.checkbox)},[Ee(f("input",{type:"checkbox","onUpdate:modelValue":b[9]||(b[9]=S=>m.value=S)},null,512),[[On,m.value]]),b[12]||(b[12]=f("span",null,"删除线",-1))],2)],2)],2),f("div",{class:h(a.classes.fieldset)},[b[14]||(b[14]=f("header",null,"预览",-1)),f("div",{class:h(a.classes.preview)},[f("span",{style:K(v.value)},[f("span",{class:h({[a.classes.lineThrough]:n.options.style.lineThrough})},W(Bd),2)],4)],2)],2)],2))}}),zd="_font_16792_2",Ud="_fontFamily_16792_7",Hd="_config_16792_14",Gd="_fontSize_16792_19",Wd="_fieldset_16792_23",Yd="_title_16792_39",jd="_content_16792_44",Xd="_indicator_16792_49",Zd="_colorBlock_16792_69",Kd="_colorValue_16792_80",Jd="_colorNone_16792_87",Qd="_configs_16792_98",ef="_checkbox_16792_104",tf="_option_16792_119",nf="_line_16792_127",lf="_preview_16792_138",of="_lineThrough_16792_153",sf={font:zd,fontFamily:Ud,config:Hd,fontSize:Gd,fieldset:Wd,title:Yd,content:jd,indicator:Xd,colorBlock:Zd,colorValue:Kd,colorNone:Jd,configs:Qd,checkbox:ef,option:tf,line:nf,preview:lf,lineThrough:of},rf={classes:sf},af=z(Fd,[["__cssModules",rf]]),cf=["placeholder","min"],uf=M({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,s=R(()=>{const r=l.defaultUnit;return l.options.some(d=>d.value===r)?r:l.options[0].value}),o=R({get(){return He(l.modelValue).num},set(r){if(Xn(r)){const u=He(l.modelValue).unit??s.value;return i(`${r}${u}`)}i()}}),c=R({get(){return He(l.modelValue).unit??s.value},set(r){const u=He(l.modelValue).num??l.min;i(`${u}${r}`)}});function i(r=void 0){t("update:modelValue",r)}return(r,d)=>(w(),N("div",{class:h(r.classes.input)},[Ee(f("input",{type:"number","onUpdate:modelValue":d[0]||(d[0]=u=>o.value=u),class:"quickprint-form-control",placeholder:n.placeholder,min:n.min},null,8,cf),[[xe,o.value]]),p(y(Z),{modelValue:c.value,"onUpdate:modelValue":d[1]||(d[1]=u=>c.value=u),class:h(r.classes.unit),options:n.options,width:"auto",border:"none"},null,8,["modelValue","class","options"])],2))}}),df="_input_gtdaq_2",ff="_unit_gtdaq_14",pf={input:df,unit:ff},mf={classes:pf},ft=z(uf,[["__cssModules",mf]]),gf="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",hf=M({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Re.NONE},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],l=[{label:"字符",value:Re.EM},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],s=[{label:"毫米",value:Re.MM},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],o=R({get(){return e.options.style.textAlign??tt.LEFT},set(a){const b=a===tt.LEFT?void 0:a;e.options.style.textAlign=b}}),c=R({get(){return e.options.style.textAlignLast??mt.AUTO},set(a){const b=a===mt.AUTO?void 0:a;e.options.style.textAlignLast=b}}),i=R({get(){return e.options.style.verticalAlign??Ge.MIDDLE},set(a){const b=a===Ge.MIDDLE?void 0:a;e.options.style.verticalAlign=b}}),r=v("top"),d=v("bottom"),u=v("left"),m=v("right"),g=R(()=>{const a=e.options.style,b={};return a.textAlign&&(b.textAlign=a.textAlign),a.textAlignLast&&(b.textAlignLast=a.textAlignLast),a.textIndent&&(b.textIndent=a.textIndent),a.lineHeight&&(b.lineHeight=a.lineHeight),Je(b,oo(a.verticalAlign)),b}),E=R(()=>{var S,x,C,T;const a=e.options.style,b={};return b["--openprint-paragraph-preview-padding-top"]=((S=a.padding)==null?void 0:S.top)??"2px",b["--openprint-paragraph-preview-padding-right"]=((x=a.padding)==null?void 0:x.right)??"2px",b["--openprint-paragraph-preview-padding-bottom"]=((C=a.padding)==null?void 0:C.bottom)??"2px",b["--openprint-paragraph-preview-padding-left"]=((T=a.padding)==null?void 0:T.left)??"2px",b});function v(a){return R({get(){var b;return(b=e.options.style.padding)==null?void 0:b[a]},set(b){e.options.style.padding==null&&(e.options.style.padding={});const S=ie(b)?void 0:b;e.options.style.padding[a]=S}})}return(a,b)=>(w(),N("div",{class:h(["quickprint-is-scrollable quickprint-is-fill-h",a.classes.paragraph])},[f("div",{class:h(a.classes.textAlign)},[f("div",{class:h(a.classes.configItem)},[f("div",{class:h(a.classes.configItemLabel)},"文本对齐",2),p(y(Z),{options:y(Un),modelValue:o.value,"onUpdate:modelValue":b[0]||(b[0]=S=>o.value=S)},null,8,["options","modelValue"])],2),f("div",{class:h(a.classes.alignLast)},[f("div",{class:h(a.classes.configItemLabel)},"最后一行",2),p(y(Z),{options:y(hu),modelValue:c.value,"onUpdate:modelValue":b[1]||(b[1]=S=>c.value=S)},null,8,["options","modelValue"])],2)],2),f("div",{class:h(a.classes.configItem)},[f("div",{class:h(a.classes.configItemLabel)},"垂直对齐",2),p(y(Z),{options:y(zn),modelValue:i.value,"onUpdate:modelValue":b[2]||(b[2]=S=>i.value=S)},null,8,["options","modelValue"])],2),f("div",{class:h(a.classes.configItem)},[f("div",{class:h(a.classes.configItemLabel)},"首行缩进",2),p(ft,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":b[3]||(b[3]=S=>n.options.style.textIndent=S),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:h(a.classes.configItem)},[f("div",{class:h(a.classes.configItemLabel)},"行高",2),p(ft,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":b[4]||(b[4]=S=>n.options.style.lineHeight=S),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:h(a.classes.fieldset)},[b[9]||(b[9]=f("header",null,"内边距",-1)),f("div",{class:h(a.classes.padding)},[f("div",{class:h(a.classes.paddingItem)},[f("label",{class:h(a.classes.paddingItemLabel)},"上边距",2),p(ft,{modelValue:y(r),"onUpdate:modelValue":b[5]||(b[5]=S=>Ue(r)?r.value=S:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:h(a.classes.paddingItem)},[f("label",{class:h(a.classes.paddingItemLabel)},"下边距",2),p(ft,{modelValue:y(d),"onUpdate:modelValue":b[6]||(b[6]=S=>Ue(d)?d.value=S:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:h(a.classes.paddingItem)},[f("label",{class:h(a.classes.paddingItemLabel)},"左边距",2),p(ft,{modelValue:y(u),"onUpdate:modelValue":b[7]||(b[7]=S=>Ue(u)?u.value=S:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),f("div",{class:h(a.classes.paddingItem)},[f("label",{class:h(a.classes.paddingItemLabel)},"右边距",2),p(ft,{modelValue:y(m),"onUpdate:modelValue":b[8]||(b[8]=S=>Ue(m)?m.value=S:null),options:s,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),f("div",{class:h(a.classes.fieldset)},[b[10]||(b[10]=f("header",null,"预览",-1)),f("div",{class:h(a.classes.preview),style:K(g.value)},[f("div",{style:K(E.value),class:h(a.classes.previewText)},[le(W(gf)+" "),f("div",{class:h(a.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),vf="_paragraph_1ex97_2",bf="_fieldset_1ex97_7",yf="_preview_1ex97_23",Ef="_textAlign_1ex97_34 quickprint-is-row",_f="_configItem_1ex97_39 quickprint-is-row",Tf="_alignLast_1ex97_44 quickprint-is-row",Sf="_configItemLabel_1ex97_54",wf="_padding_1ex97_59",kf="_paddingItem_1ex97_66",Cf="_paddingItemLabel_1ex97_72",Rf="_previewText_1ex97_77",Nf="_paddingPreview_1ex97_86",Lf={paragraph:vf,fieldset:bf,preview:yf,textAlign:Ef,configItem:_f,alignLast:Tf,configItemLabel:Sf,padding:wf,paddingItem:kf,paddingItemLabel:Cf,previewText:Rf,paddingPreview:Nf},If={classes:Lf},xf=z(hf,[["__cssModules",If]]),Af=M({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=Xe();function l(){t==null||t.confirm(e.options)}function s(){t==null||t.cancel()}return(o,c)=>(w(),N("div",{class:h(o.classes.setting)},[n.active==="font"?(w(),J(af,{key:0,options:e.options},null,8,["options"])):H("",!0),n.active==="paragraph"?(w(),J(xf,{key:1,options:e.options},null,8,["options"])):H("",!0),f("div",{class:h(o.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:s},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),qf="_setting_1v5ya_2",Df="_footer_1v5ya_9",Of={setting:qf,footer:Df},Mf={classes:Of},$f=z(Af,[["__cssModules",Mf]]);function Pf(n){return Oe({style:Qo(n.style??{})})}function Vf(n,e){n.style=Object.assign({},n.style,e.style)}const Bf=Pe(function(n){return Jt("元素",(e,t)=>p($f,{options:Pf(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"}]}).promisify().then(e=>Vf(n,e)).catch(Me)});function Ff(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){Bf(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},uo(t,e.element)),Kn.open(n.clientX,n.clientY,{menus:l})}const zf=M({props:{element:{type:me,required:!0}},setup(n){const e=Ne("classes"),t=_e(),l=R(()=>{const m=n.element;m.state.key;const g={"--quickprint-element-top":m.top+"px","--quickprint-element-left":m.left+"px","--quickprint-element-width":m.width+"px","--quickprint-element-height":m.height+"px","z-index":m.zIndex};return c()&&(g.transform=`rotate(${m.style.rotate}deg)`),g}),s={TOP:[e.resizeTop,Rt.TOP],BOTTOM:[e.resizeBottom,Rt.BOTTOM],LEFT:[e.resizeLeft,Rt.LEFT],RIGHT:[e.resizeRight,Rt.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,Rt.BOTTOM_RIGHT]},o=[s.TOP,s.BOTTOM,s.LEFT,s.RIGHT,s.BOTTOM_RIGHT];function c(){const m=n.element;return m.style.rotate==0||m.style.rotate==null?!1:t.state.selectMode===ot.SINGLE?!m.isSelected:!0}function i(m){const g=qu(m.type);if(g==null)return p("div",{class:e.unknown},[p("span",null,[le("未知的打印元素")])]);const E={element:m,key:m.id+"_"+m.state.key};return Mu(m.type)?(E.onContextmenu=d,St(g,E)):St(g,E)}function r(m,g){g.stopPropagation();const E=g.target.closest("."+G.ELEMENT);E&&Reflect.get(E,En)===tl.DRAG_ELEMENT||t.selectElement(m)}function d(m){m.stopPropagation(),m.preventDefault(),Ff(m,n,t)}function u(){return!$u(n.element.type)||c()?null:o.map(m=>{const g={class:[G.RESIZEABLE_INDICATOR,m[0]],["."+Hl]:m[1]};return p("div",us(g,{onPointerdown:t.onResizeStart}),null)})}return function(){const m=n.element,g={["."+Ye]:m,["."+el]:m.type,key:m.id,class:{[G.ELEMENT]:!0,[G.DRAGGABLE]:!0,[G.RESIZEABLE]:!0,[G.SELECTED]:m.state.selected,[G.SELECTABLE]:Ou(m.type),["quickprint-is-"+m.type.toLowerCase()]:!0},style:l.value,onClick:r.bind(null,m)};return p("div",g,[i(m),u()])}}}),Uf="_unknown_za8zh_2",Hf="_resizeTop_za8zh_12",Gf="_resizeBottom_za8zh_20",Wf="_resizeLeft_za8zh_28",Yf="_resizeRight_za8zh_36",jf="_resizeBottomRight_za8zh_44",Xf={unknown:Uf,resizeTop:Hf,resizeBottom:Gf,resizeLeft:Wf,resizeRight:Yf,resizeBottomRight:jf},Zf={classes:Xf},Kf=z(zf,[["__cssModules",Zf]]),wo=ql(()=>Dl(()=>import("./component-CupdP2um.js"),__vite__mapDeps([3,4,1,5,6]))),Jf=M({__name:"DocJson",props:{doc:{type:he,required:!0}},setup(n){const e=n,t=Xe(),l=ue(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(s,o)=>(w(),J(y(wo),{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=c=>l.value=c),language:"json",class:h(s.classes.json)},null,8,["modelValue","class"]))}}),Qf="_json_9crpe_2",ep={json:Qf},tp={classes:ep},np=z(Jf,[["__cssModules",tp]]),lp=Pe(function(n){return Et("调试",p(np,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(et)});async function op(n,e,t){const l=[];await t.clipboard.hasElement()&&l.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const o=n.target.closest("."+G.PAGE);if(o==null)return;const c=await t.clipboard.readElement();if(c.length==0)return;const i=o.getBoundingClientRect(),r=n.clientX-i.left-c[0].left,d=n.clientY-i.top-c[0].top;for(const u of c)u.setLeft(u.left+r),u.setTop(u.top+d),e.page.append(u);t.createSnapshot()}});const s=t.getSelectedElements();s.length>0&&l.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),l.length>0&&l.push({type:"divider"}),l.push({type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const o=e.page.children??[];t.multiSelectElements(o)}},{type:"divider"},{type:"menu",label:"调试",icon:"icon-bug",handler(){lp(t).then(o=>{if(o==null)return;const c=he.create(o);t.setDocument(c)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),Kn.open(n.clientX,n.clientY,{menus:l})}const sp=M({props:{doc:{type:he,required:!0},page:{type:_t,required:!0}},setup(n){const e=Ne("classes"),t=_e(),l=Pt("selectionRef"),s=Pt("paperRef"),o=ue(0),c=R(()=>n.page.width),i=R(()=>n.page.height);function r(x){x.stopPropagation();const C=x.target.closest("."+G.PAPER);C&&Reflect.get(C,En)===tl.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function d(){if(n.page.header.display===!1)return null;const x=n.page.header.height,C="page_header_"+o.value;return p(Ll,{title:"页眉",top:x,onMove:m,key:C},null)}function u(){if(n.page.footer.display===!1)return null;const x=Mt(i.value)-n.page.footer.height,C="page_footer_"+o.value;return p(Ll,{title:"页脚",top:x,onMove:g,key:C},null)}function m(x){n.page.setHeaderHeight(x.top),o.value++}function g(x){n.page.setFooterHeight(Mt(i.value)-x.top),o.value++}function E(x){x.stopPropagation(),x.preventDefault(),op(x,n,t)}function v(){const x=n.doc.margins;if(x==null)return null;const C=[];return x.top&&C.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:x.top+"px"}},null)),x.bottom&&C.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:x.bottom+"px"}},null)),x.left&&C.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:x.left+"px"}},null)),x.right&&C.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:x.right+"px"}},null)),C.length>0?C:null}function a(){const x={["."+Ul]:n.page,key:n.page.id,style:{width:c.value+"mm",height:i.value+"mm"},class:{[G.PAGE]:!0,[G.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:E},C=n.page.children.map(T=>p(Kf,{element:T},null));return p("div",x,[d(),C,u(),v()])}function b(x){if(x.button!==0)return;x.stopPropagation(),x.preventDefault();const T=x.target.closest("."+G.ELEMENT);if(T==null)return S(x,s.value);const _=Reflect.get(T,Ye);return _==null?S(x,s.value):_.type===j.TABLE?S(x,T):Pu(_.type)?t.onDragStart(x):S(x,s.value)}function S(x,C){var T;(T=l.value)==null||T.onSelectStart(x,C)}return function(){const x=t.state.scale/100,C={id:"@"+n.page.id,ref:"paperRef",class:{[G.PAPER]:!0,[G.SELECTED]:t.state.selectedPage===n.page.id},style:{width:c.value*x+"mm",height:i.value*x+"mm"},onPointerdown:b,onClick:r};return p("div",C,[a(),p(Rd,{ref:"selectionRef"},null)])}}}),ip="_paper_fdphx_2",rp="_grid_fdphx_12",ap="_marginHorizontalGuide_fdphx_21",cp="_marginVerticalGuide_fdphx_29",up={paper:ip,grid:rp,marginHorizontalGuide:ap,marginVerticalGuide:cp},dp={classes:up},fp=z(sp,[["__cssModules",dp]]),pp={class:"quickprint-is-fill-h quickprint-is-scrollable"},mp="icon-zhanweifu",gp=M({__name:"Element",setup(n){const e=_e();return(t,l)=>(w(),N("div",{class:h(t.classes.panel)},[f("div",{class:h(t.classes.header)},"可打印元素",2),f("div",pp,[f("div",{class:h(t.classes.grid)},[(w(!0),N(X,null,ae(y(Lu),s=>(w(),N("div",Fl({key:s.type,class:[y(G).DRAGGABLE,t.classes.element],[`.${y(zl)||""}`]:y(Le).INSERT,[`.${y(el)||""}`]:s.type,onPointerdown:l[0]||(l[0]=(...o)=>y(e).onDragStart&&y(e).onDragStart(...o))}),[p(y(O),{icon:s.icon??mp,size:"16px",class:h(t.classes.icon)},null,8,["icon","class"]),f("span",null,W(s.title),1)],48))),128))],2)])],2))}}),hp="_panel_1p36j_2",vp="_header_1p36j_8",bp="_grid_1p36j_18",yp="_element_1p36j_30",Ep="_icon_1p36j_45",_p={panel:hp,header:vp,grid:bp,element:yp,icon:Ep},Tp={classes:_p},Sp=z(gp,[["__cssModules",Tp]]),wp=["onClick"],kp=M({__name:"SelectPath",setup(n){const e=_e(),t=R(()=>{const o=e.state,c=[{id:e.doc.id,title:"文档",type:"document"}];if(o.selectedType===pe.PAGE){const i=e.getSelectedPage();if(i!=null){const r="页面"+(i.index+1);c.push({id:i.id,title:r,type:"page",data:i})}return c}if(o.selectedType===pe.ELEMENT){if(o.selectMode===ot.MULTIPLE){const d=e.getSelectedElements();if(d.length===0)return c;let u=d[0];for(;u.parent;){const m=u.parent;if(m instanceof _t){const g="页面"+(m.index+1);return c.push({id:m.id,title:g,type:"page",data:m}),c}u=m}return c}let i=e.getSelectedElements()[0];if(i==null)return c;const r=[{id:i.id,title:Kt(i.type),type:"element",data:i}];for(;i.parent;){const d=i.parent;if(d instanceof _t){const u="页面"+(d.index+1);return r.unshift({id:d.id,title:u,type:"page",data:d}),c.concat(r)}r.unshift({id:d.id,title:Kt(d.type),type:"element",data:d}),i=d}}return c}),l=R(()=>{if(e.state.selectedType!=pe.ELEMENT)return;const c=e.getSelectedElements();if(c.length!=1)return;const i=c[0],r=ll(i,e.doc.ds);if(!(r==null||!r.content))return r.type===ve.VARIABLE||r.type===ve.FORMULA?`[${r.content}]`:r.content});function s(o){if(o.type==="element")return e.selectElement(o.data);if(o.type==="page")return e.selectPage(o.data)}return(o,c)=>(w(),N("div",{class:h(o.classes.paths)},[(w(!0),N(X,null,ae(t.value,(i,r)=>(w(),N(X,{key:i.id},[r>0?(w(),J(y(O),{key:0,class:h(o.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):H("",!0),f("div",{class:h(o.classes.path),onClick:d=>s(i)},W(i.title),11,wp)],64))),128)),l.value?(w(),N(X,{key:0},[p(y(O),{class:h(o.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),f("div",{class:h(o.classes.content)},W(l.value),3)],64)):H("",!0)],2))}}),Cp="_paths_fuk62_2",Rp="_path_fuk62_2",Np="_icon_fuk62_28",Lp="_content_fuk62_33",Ip={paths:Cp,path:Rp,icon:Np,content:Lp},xp={classes:Ip},Ap=z(kp,[["__cssModules",xp]]),qp=["min","readonly","placeholder"],Dp=M({__name:"LabelNumber",props:Tt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=Qt(n,"modelValue");function l(s){const c=s.target.value;if(t==null||c===""){const r=e.min?e.min:e.defaultValue;t.value=r;return}const i=Number(c);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const r=Math.pow(10,e.precision);t.value=Math.round(i*r)/r}}return(s,o)=>(w(),N("label",{class:h({[s.classes.labelNumber]:!0,[s.classes.readonly]:n.readonly})},[Ee(f("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":o[0]||(o[0]=c=>t.value=c),min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,qp),[[xe,t.value]]),f("span",{class:h(s.classes.label)},W(n.label),3)],2))}}),Op="_labelNumber_1aifb_2",Mp="_label_1aifb_2",$p="_readonly_1aifb_25",Pp={labelNumber:Op,label:Mp,readonly:$p},Vp={classes:Pp},It=z(Dp,[["__cssModules",Vp]]),Bp={class:"quickprint-config"},Fp={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},zp={class:"quickprint-config-group"},Up={class:"quickprint-config-section quickprint-config-inline"},Hp={class:"quickprint-config-content quickprint-config-inline"},Gp={class:"quickprint-config-group"},Wp={class:"quickprint-config-section quickprint-config-inline"},Yp={class:"quickprint-config-content quickprint-config-inline"},jp={class:"quickprint-config-section quickprint-config-inline"},Xp={class:"quickprint-config-content quickprint-form-inline"},Zp={class:"quickprint-config-group"},Kp={class:"quickprint-config-section quickprint-config-inline"},Jp={class:"quickprint-config-content quickprint-form-inline"},Qp={key:0,class:"quickprint-config-section quickprint-config-inline"},em={class:"quickprint-config-content quickprint-form-inline"},tm={class:"quickprint-config-section quickprint-config-inline"},nm={class:"quickprint-config-content quickprint-form-inline"},lm=M({__name:"PageConfig",props:{page:{type:_t,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=[{label:"禁止",value:nn.NONE},{label:"跟随表格",value:nn.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],s=R({get(){return e.page.size.type},set(d){e.page.size.type=d,d===Xt.CONTENT&&(e.page.size.orientation=void 0)}}),o=R({get(){return e.page.orientation},set(d){e.page.size.orientation=d}}),c=R(()=>e.page.width),i=R({get(){return e.page.height},set(d){const u=Number(d);!Xn(u)||u<0||(e.page.size.height=u)}}),r=R({get(){return e.page.footer.flow??nn.NONE},set(d){e.page.footer.flow=d===nn.NONE?void 0:d}});return(d,u)=>(w(),N("div",Bp,[u[15]||(u[15]=f("div",{class:"quickprint-config-title"},"页面配置",-1)),f("div",Fp,[f("div",zp,[u[7]||(u[7]=f("div",{class:"quickprint-config-group-title"},"页眉",-1)),f("section",Up,[u[6]||(u[6]=f("header",{class:"quickprint-config-header"},"位置",-1)),f("div",Hp,[p(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(Lt,{modelValue:n.page.header.display,"onUpdate:modelValue":u[0]||(u[0]=m=>n.page.header.display=m),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),f("div",Gp,[u[10]||(u[10]=f("div",{class:"quickprint-config-group-title"},"页脚",-1)),f("section",Wp,[u[8]||(u[8]=f("header",{class:"quickprint-config-header"},"位置",-1)),f("div",Yp,[p(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(Lt,{modelValue:n.page.footer.display,"onUpdate:modelValue":u[1]||(u[1]=m=>n.page.footer.display=m),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),f("section",jp,[u[9]||(u[9]=f("header",{class:"quickprint-config-header"},"跟随",-1)),f("div",Xp,[p(y(Z),{modelValue:r.value,"onUpdate:modelValue":u[2]||(u[2]=m=>r.value=m),options:l},null,8,["modelValue"])])])]),f("div",Zp,[u[14]||(u[14]=f("div",{class:"quickprint-config-group-title"},"画布",-1)),f("section",Kp,[u[11]||(u[11]=f("header",{class:"quickprint-config-header"},"尺寸",-1)),f("div",Jp,[p(Lt,{modelValue:s.value,"onUpdate:modelValue":u[3]||(u[3]=m=>s.value=m),options:y(Es),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===y(Xt).CONTENT?(w(),N("section",Qp,[u[12]||(u[12]=f("header",{class:"quickprint-config-header"},"内容",-1)),f("div",em,[p(It,{class:"quickprint-form-inline-item",label:"宽",modelValue:c.value,readonly:""},null,8,["modelValue"]),p(It,{class:"quickprint-form-inline-item",label:"高",modelValue:i.value,"onUpdate:modelValue":u[4]||(u[4]=m=>i.value=m)},null,8,["modelValue"])])])):H("",!0),f("section",tm,[u[13]||(u[13]=f("header",{class:"quickprint-config-header"},"方向",-1)),f("div",nm,[p(Lt,{modelValue:o.value,"onUpdate:modelValue":u[5]||(u[5]=m=>o.value=m),class:"quickprint-w-full",options:y(Yl),disabled:n.page.size.type===y(Xt).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),om=["value","placeholder"],sm=M({__name:"InputUnit",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,s=Pt("inputRef"),o=R({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?dl(t.modelValue):t.standard==="mm"&&t.target==="px"?Mt(t.modelValue):0},set(u){if(t.standard===t.target)return l("update:modelValue",u);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Mt(u));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",dl(u))}}),c=R(()=>t.clearable&&o.value!=null);function i(u){const g=u.target.value;if(o==null||g===""){if(t.clearable)return;const v=t.min?t.min:t.defaultValue;o.value=v;return}const E=Number(g);if(!Number.isNaN(E)){if(t.min!=null&&E<t.min){o.value=t.min;return}if(t.standard==="px"){o.value=Math.round(E);return}o.value=E}}function r(){l("update:modelValue",void 0)}function d(){var u;(u=s.value)==null||u.blur(),setTimeout(()=>{var m;return(m=s.value)==null?void 0:m.focus()},50)}return(u,m)=>(w(),N("label",{class:h({[u.classes.inputUnit]:!0,[u.classes.withClear]:n.clearable})},[f("span",{class:h(u.classes.label)},W(n.label),3),f("input",{ref_key:"inputRef",ref:s,class:"quickprint-form-control",type:"number",value:o.value,placeholder:n.placeholder,onBlur:i,onKeydown:Pl(d,["enter"])},null,40,om),c.value?(w(),N("span",{key:0,class:h(u.classes.clearBtn),onClick:se(r,["stop"])},[p(y(O),{icon:"icon-close",size:"11px"})],2)):H("",!0)],2))}}),im="_inputUnit_2ymft_2",rm="_clearBtn_2ymft_7",am="_label_2ymft_11",cm="_withClear_2ymft_31",um={inputUnit:im,clearBtn:rm,label:am,withClear:cm},dm={classes:um},nt=z(sm,[["__cssModules",dm]]),fm=M({__name:"UnitSelect",props:Tt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=Qt(n,"modelValue"),s=R(()=>{var o;return((o=e.find(c=>c.value===t.modelValue))==null?void 0:o.label)??t.modelValue});return(o,c)=>(w(),N("span",{class:h(o.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(y(Z),{modelValue:l.value,"onUpdate:modelValue":c[0]||(c[0]=i=>l.value=i),options:e,class:h(o.classes.select),appearance:"none",border:"none"},{selected:ye(()=>[f("span",{class:h(o.classes.text)},W(s.value),3)]),_:1},8,["modelValue","class"])],2))}}),pm="_unit_135mn_2",mm="_text_135mn_8",gm="_select_135mn_25",hm={unit:pm,text:mm,select:gm},vm={classes:hm},ko=z(fm,[["__cssModules",vm]]),bm=M({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=ue(!1);function s(){t("copy",async function(c){await navigator.clipboard.writeText(c).catch(es)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(o,c)=>(w(),N("button",{type:"button",class:h(["quickprint-text-btn",o.classes.btn]),title:"复制",onClick:s},[p(y(O),{icon:"icon-copy"}),p(ds,{name:"quickprint-fade"},{default:ye(()=>[l.value?(w(),N("span",{key:0,class:h(o.classes.message)},"已复制",2)):H("",!0)]),_:1})],2))}}),ym="_btn_v9scw_2",Em="_message_v9scw_6",_m={btn:ym,message:Em},Tm={classes:_m},Sm=z(bm,[["__cssModules",Tm]]),wm=M({__name:"window",props:{code:{type:String,default:""},doc:{type:he,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=Xe(),l=ue(e.code),s=de();function o(){return l.value}function c(){e.doc!=null&&Gr({doc:e.doc}).then(m=>{var E;if(m==null)return;const g=m.type=="reference"?`[=${m.value}]`:`[${m.value}]`;(E=s.value)==null||E.insert(g)})}function i(m){var g;return je(m,(g=e.doc)==null?void 0:g.ds)}function r(){var m;(m=s.value)==null||m.insert(`[2.6.${Wn.ELEMENT_VALUR}]`)}function d(){Wr().then(m=>{var g;m!=null&&((g=s.value)==null||g.insert(m.value))})}function u(){Yr({doc:e.doc}).then(m=>{var g;m!=null&&((g=s.value)==null||g.insert(m.value))})}return t==null||t.useHandle("confirm",o),(m,g)=>(w(),N("div",{class:h(m.classes.window)},[n.mode!=="code"?(w(),N("div",{key:0,class:h(m.classes.toolbar)},[n.mode=="condition"?(w(),N(X,{key:0},[f("button",{type:"button",class:"quickprint-text-btn",onClick:r},[p(y(O),{icon:"icon-number-sign"}),g[1]||(g[1]=f("span",null,"插入元素值",-1))]),f("div",{class:h(m.classes.divider)},null,2)],64)):H("",!0),f("button",{type:"button",onClick:c,class:"quickprint-text-btn"},[p(y(O),{icon:"icon-insert-var"}),g[2]||(g[2]=f("span",null,"插入变量",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:d},[p(y(O),{icon:"icon-function"}),g[3]||(g[3]=f("span",null,"插入函数",-1))]),f("button",{type:"button",class:"quickprint-text-btn",onClick:u},[p(y(O),{icon:"icon-formula"}),g[4]||(g[4]=f("span",null,"插入公式",-1))])],2)):H("",!0),p(y(wo),{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=E=>l.value=E),language:"javascript",class:h(m.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:s},null,8,["modelValue","class"])],2))}}),km="_window_n935p_2",Cm="_toolbar_n935p_11",Rm="_code_n935p_22",Nm="_divider_n935p_27",Lm={window:km,toolbar:Cm,code:Rm,divider:Nm},Im={classes:Lm},Co=z(wm,[["__cssModules",Im]]),Ro=Pe(function(n){return Et("公式",p(Co,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Me)}),xm=Pe(function(n,e){return Et(n,p(Co,{code:e},null),{preset:"editor"}).promisify().catch(Me)}),Am={class:"quickprint-config-section quickprint-config-inline"},qm={class:"quickprint-config-content"},Dm=["value"],Om=M({__name:"Visibility",props:{element:{type:me,required:!0}},setup(n){const e=n,t=R({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??vt.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==vt.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=R({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),s=R(()=>{var i;return ol((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),o=R(()=>{var i;return t.value!==vt.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function c(){const i=l.value||`[2.6.${Wn.ELEMENT_VALUR}]`;Ro({code:i,doc:e.element.doc,mode:"condition"}).then(r=>{r!=null&&(l.value=r)})}return(i,r)=>(w(),N(X,null,[f("section",Am,[r[1]||(r[1]=f("header",{class:"quickprint-config-header"},"可见性",-1)),f("div",qm,[p(y(Z),{class:"quickprint-w-full",options:y(ms),modelValue:t.value,"onUpdate:modelValue":r[0]||(r[0]=d=>t.value=d)},null,8,["options","modelValue"])])]),t.value===y(vt).CONDITION?(w(),N("div",{key:0,class:h([i.classes.condition,"quickprint-config-section"]),onClick:c},[f("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Dm),o.value?(w(),J(y(O),{key:0,icon:"icon-open-new",size:"14px"})):H("",!0)],2)):H("",!0)],64))}}),Mm="_condition_siopf_2",$m={condition:Mm},Pm={classes:$m},Vm=z(Om,[["__cssModules",Pm]]);function Bm(n){return R({get(){return n.element.attributes.position??pn.DEFAULT},set(e){const t=e===pn.DEFAULT?void 0:e;n.element.attributes.position=t}})}function Fm(n){return R({get(){return n.element.attributes.printMode??mn.ONCE},set(e){const t=e===mn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function zm(n){return R({get(){return n.element.attributes.overflow??Zt.HIDDEN},set(e){const t=e===Zt.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function Um(n){return R({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function Hm(n){return R({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function Gm(n){return R({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function Wm(n){return R({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const Ym=M({__name:"Const",props:{element:{type:me,required:!0}},setup(n){const e=n,t=R({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,s)=>Ee((w(),N("textarea",{"onUpdate:modelValue":s[0]||(s[0]=o=>t.value=o),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[xe,t.value]])}}),jm={class:"quickprint-config-ds-var-type"},Xm=["title"],Zm=M({__name:"Variable",props:{element:{type:me,required:!0}},setup(n){const e=n,t=_e(),l=R(()=>ie(e.element.ds.value)),s=R(()=>je(e.element.ds.value,t.doc.ds));function o(i){i.stopPropagation(),e.element.ds.value=void 0}async function c(){var u;const i=await sl({doc:t.doc,value:e.element.ds.value}).catch(et);if(i==null||(e.element.setDataSource(ve.VARIABLE,i.value),e.element.type!=j.TABLE_CELL||i.type!=="ds"))return;const r=e.element.parent;if(r==null||r.isBindVariable||((u=i.parent)==null?void 0:u.type)!==ee.ARRAY)return;const d=i.parent;r.setDataSource(ve.VARIABLE,`${bt.DS}.${d.type}.${d.name}`)}return(i,r)=>(w(),N("div",{class:"quickprint-config-ds-variable",onClick:c},[l.value?(w(),N(X,{key:0},[r[0]||(r[0]=f("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(y(O),{icon:"icon-open-new",size:"14px"})],64)):(w(),N(X,{key:1},[f("span",jm,"<"+W(y(wi)(e.element.ds.value))+">",1),f("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:s.value},W(s.value),9,Xm),f("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:o},[p(y(O),{icon:"icon-close",size:"12px"})])],64))]))}}),Km=["value"],Jm=M({__name:"Code",props:{element:{type:me,required:!0}},setup(n){const e=n,t=R(()=>ie(e.element.ds.value));function l(){return jn(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function s(){xm("自定义",l()).then(o=>{o!=null&&(e.element.ds.value=o)})}return(o,c)=>(w(),N("div",{onClick:s,class:h(o.classes.code)},[f("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Km),t.value?(w(),J(y(O),{key:0,icon:"icon-open-new",size:"14px"})):H("",!0)],2))}}),Qm="_code_1az68_2",eg={code:Qm},tg={classes:eg},ng=z(Jm,[["__cssModules",tg]]),lg=["value"],og=M({__name:"Formula",props:{element:{type:me,required:!0}},setup(n){const e=n,t=_e(),l=R(()=>ie(e.element.ds.value)),s=R(()=>ol(e.element.ds.value,e.element.doc));function o(){const c=e.element.ds.value;Ro({code:c,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(c,i)=>(w(),N("div",{onClick:o,class:h(c.classes.code)},[f("textarea",{value:s.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,lg),l.value?(w(),J(y(O),{key:0,icon:"icon-open-new",size:"14px"})):H("",!0)],2))}}),sg="_code_ipm2q_2",ig={code:sg},rg={classes:ig},ag=z(og,[["__cssModules",rg]]);function cg(n){switch(n.ds.type){case ve.CONST:return p(Ym,{element:n},null);case ve.VARIABLE:return p(Zm,{element:n},null);case ve.CODE:return p(ng,{element:n},null);case ve.FORMULA:return p(ag,{element:n},null);default:return null}}const ug=M({props:{element:{type:me,required:!0}},setup(n){const e=R(()=>Kt(n.element.type)),t=R(()=>bs.filter(C=>C.value!=n.element.type)),l=ue("px"),s=Um(n),o=Hm(n),c=zm(n),i=Bm(n),r=Fm(n),d=Gm(n),u=Wm(n),m=R(()=>{const C=n.element,T=C.parent;if(T===null||!(T instanceof _t))return!1;const _=T.header;if(_.display&&C.bottom<=(_.height??0))return!1;const L=T.parent;if(L==null)return!1;const k=T.footer;return!(k.display&&C.top>=Math.floor(Mt(L.paper.height))-(k.height??0))});function g(C,T){return T==null?!1:!!T.includes(C)}function E(){const C=Gt(n.element.type);if(g(ce.LAYOUT,C==null?void 0:C.exclude))return null;const T=n.element,_=g(ce.COORD,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(nt,{class:"quickprint-form-inline-item",label:"左",modelValue:T.left,"onUpdate:modelValue":F=>T.left=F,target:l.value},null),p(nt,{class:"quickprint-form-inline-item",label:"上",modelValue:T.top,"onUpdate:modelValue":F=>T.top=F,target:l.value},null)])]),L=g(ce.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[le("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(nt,{class:"quickprint-form-inline-item",label:"宽",modelValue:s.value,"onUpdate:modelValue":F=>s.value=F,target:l.value},null),p(nt,{class:"quickprint-form-inline-item",label:"高",modelValue:o.value,"onUpdate:modelValue":F=>o.value=F,target:l.value},null)])]),k=g(ce.VISIBILITY,C==null?void 0:C.exclude)?null:p(Vm,{element:T},null),I=g(ce.OVERFLOW,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("溢出时")]),p("div",{class:"quickprint-config-content"},[p(Z,{modelValue:c.value,"onUpdate:modelValue":F=>c.value=F,options:Ss,class:"quickprint-w-full"},null)])]),A=g(ce.PRINT_MODE,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[le("打印模式")]),p("div",{class:"quickprint-config-content"},[p(Z,{modelValue:r.value,"onUpdate:modelValue":F=>r.value=F,options:Ts,class:"quickprint-w-full"},null)])]),$=g(ce.POSITION,C==null?void 0:C.exclude)||!m.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("定位模式")]),p("div",{class:"quickprint-config-content"},[p(Z,{modelValue:i.value,"onUpdate:modelValue":F=>i.value=F,options:_s,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[le("布局")]),p("span",null,[le("单位：")]),p(ko,{modelValue:l.value,"onUpdate:modelValue":F=>l.value=F},null)]),_,L,k,I,A,$])}function v(){const C=Gt(n.element.type);if(g(ce.BASIC,C==null?void 0:C.exclude))return null;const T=n.element,_=g(ce.PREFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("前缀")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{"onUpdate:modelValue":I=>T.attributes.prefix=I,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[xe,T.attributes.prefix]])])]),L=g(ce.SUFFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("后缀")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{"onUpdate:modelValue":I=>T.attributes.suffix=I,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[xe,T.attributes.suffix]])])]),k=g(ce.DISPLAY,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("数据类型")]),p("div",{class:"quickprint-config-content"},[p(Z,{options:t.value,modelValue:d.value,"onUpdate:modelValue":I=>d.value=I,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("基础")]),_,L,k])}function a(){const C=Gt(n.element.display);return(C==null?void 0:C.display)==null?null:St(C.display,{element:n.element})}function b(){const C=Gt(n.element.type);if(g(ce.ATTRIBUTES,C==null?void 0:C.exclude))return null;const T=C!=null&&C.attributes?St(C.attributes,{element:n.element}):null,_=a();if(T==null&&_==null)return null;const L=_!=null&&T!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("属性")]),_,L,T])}function S(){const C=Gt(n.element.type);return g(ce.DATASOURCE,C==null?void 0:C.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[le("数据")]),p(Z,{options:Gl,modelValue:u.value,"onUpdate:modelValue":T=>u.value=T},null),cg(n.element)])}function x(C){C(n.element.id)}return function(){const T=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,le("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[T.id]),p(Sm,{onCopy:x},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[le("标题")]),p("div",{class:"quickprint-config-content"},[Ee(p("input",{type:"text","onUpdate:modelValue":_=>T.title=_,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[xe,T.title]])])])]),E(),v(),b(),S()])])}}}),dg=M({setup(){const n=_e(),e=Ne("classes");function t(){return p("div",{class:e.tip},[le("未知的打印元素")])}function l(){return p("div",{class:e.tip},[le("请先选择元素")])}function s(){return p("div",{class:e.tip},[le("请先选择页面")])}function o(){const r=n.getSelectedPage();return r==null?s():p(lm,{page:r},null)}function c(){const r=n.getSelectedElements()[0];return r==null?l():Object.values(j).includes(r.type)===!1?t():St(ug,{element:r,key:r.id})}function i(){const r=n.state;return r.selectedType!==pe.ELEMENT?!1:r.selectMode===ot.SINGLE?!0:r.selected.length===1}return function(){return i()?c():o()}}}),fg="_tip_cdonk_2",pg={tip:fg},mg={classes:pg},gg=z(dg,[["__cssModules",mg]]);function Ve(n,e){if(n.state.selectedType!==pe.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ae(n,e,t){if(n.state.selectedType!==pe.ELEMENT)return;const s=n.getSelectedElements();if(s.length!=0){for(const o of s)o.setStyle(e,t);n.createSnapshot()}}function $e(n,e){if(n.state.selectedType!==pe.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const s of l)s.removeStyle(e);n.createSnapshot()}}function hg(n){const e="underline";return R({get(){if(n.state.selectedType!==pe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ae(n,e,t):$e(n,e)}})}function vg(n){const e="lineThrough";return R({get(){if(n.state.selectedType!==pe.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ae(n,e,t):$e(n,e)}})}function bg(n){const e="lineHeight";return R({get(){return Ve(n,e)},set(t){t===pt.DEFAULT?$e(n,e):Ae(n,e,t)}})}function yg(n){const e="highlightColor";return R({get(){return Ve(n,e)??Yn.BLACK},set(t){t===""?$e(n,e):Ae(n,e,t)}})}function Eg(n){const e="backgroundColor";return R({get(){return Ve(n,e)??Yn.BLACK},set(t){t===""?$e(n,e):Ae(n,e,t)}})}function _g(n){const e="fontStyle";return R({get(){return Ve(n,e)===fl.ITALIC},set(t){t?Ae(n,e,fl.ITALIC):$e(n,e)}})}function Tg(n){const e="textAlign";return R({get(){return Ve(n,e)??tt.LEFT},set(t){t===tt.LEFT?$e(n,e):Ae(n,e,t)}})}function Sg(n){const e="verticalAlign";return R({get(){return Ve(n,e)??Ge.MIDDLE},set(t){t===Ge.MIDDLE?$e(n,e):Ae(n,e,t)}})}function wg(n){const e="fontFamily";return R({get(){return Ve(n,e)},set(t){t===oe.DEFAULT?$e(n,e):Ae(n,e,t)}})}function kg(n){const e="fontSize";return R({get(){return Ve(n,e)},set(t){t===be.DEFAULT?$e(n,e):Ae(n,e,t)}})}function Cg(n){const e="color";return R({get(){return Ve(n,e)??Ce.REGULAR},set(t){Ae(n,e,t)}})}function Rg(n){const e="fontWeight";return R({get(){return Ve(n,e)===700},set(t){t?Ae(n,e,700):$e(n,e)}})}const Ng=["title","onClick"],Lg=M({__name:"BorderSelect",setup(n){const e=[Q.ALL,Q.NONE,Q.INSIDE,Q.OUTSIDE],t=_e(),l=R(()=>{if(t.state.selectedType!==pe.ELEMENT)return null;const d=t.getSelectedElements();if(d.length!==1)return null;const m=d[0].getStyle("border");if(m==null||m===Q.NONE)return null;if(m===Q.ALL)return{borderStyle:"solid"};const g={};return m&Q.TOP&&(g.borderTopStyle="solid"),m&Q.RIGHT&&(g.borderRightStyle="solid"),m&Q.BOTTOM&&(g.borderBottomStyle="solid"),m&Q.LEFT&&(g.borderLeftStyle="solid"),g}),s=[{label:"上框线",value:Q.TOP,icon:"icon-border-top"},{label:"下框线",value:Q.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:Q.LEFT,icon:"icon-border-left"},{label:"右框线",value:Q.RIGHT,icon:"icon-border-right"}];function o(r){if(t.state.selectedType!==pe.ELEMENT)return!1;const u=t.getSelectedElements();if(u.length!==1)return!1;const g=u[0].getStyle("border");return g==null?!1:e.includes(r)?g==r:g&r}function c(r){if(t.state.selectedType!==pe.ELEMENT)return;const u=t.getSelectedElements();if(u.length!=0){for(const m of u){const g=m.getStyle("border");if(g==null){m.setStyle("border",r);continue}if(g===Q.ALL){m.setStyle("border",r===Q.ALL?Q.NONE:r);continue}if(e.includes(r)){m.setStyle("border",r);continue}if(e.includes(g)){m.setStyle("border",r);continue}m.setStyle("border",g^r)}t.createSnapshot()}}function i(){if(t.state.selectedType!==pe.ELEMENT)return;const d=t.getSelectedElements();if(d.length!=0){for(const u of d)u.setStyle("border",void 0);t.createSnapshot()}}return(r,d)=>(w(),J(y(Ql),null,{popover:ye(()=>[f("div",{class:h(r.classes.popover)},[f("div",null,[(w(),N("button",{type:"button",title:"全部框线",key:y(Q).ALL,class:h({"quickprint-text-btn":!0,[r.classes.tool]:!0,"quickprint-is-selected":o(y(Q).ALL)}),onClick:d[0]||(d[0]=u=>c(y(Q).ALL))},[p(y(O),{icon:"icon-border",size:"16px"})],2)),(w(),N("button",{type:"button",title:"无框线",key:y(Q).ALL,class:h({"quickprint-text-btn":!0,[r.classes.tool]:!0}),onClick:i},[p(y(O),{icon:"icon-border-none",size:"16px"})],2))]),f("div",{class:h(r.classes.divider)},[(w(),N(X,null,ae(s,u=>f("button",{type:"button",title:u.label,key:u.value,class:h({"quickprint-text-btn":!0,[r.classes.tool]:!0,"quickprint-is-selected":o(u.value)}),onClick:m=>c(u.value)},[p(y(O),{icon:u.icon,size:"16px"},null,8,["icon"])],10,Ng)),64))],2)],2)]),default:ye(()=>[f("div",{class:h(["quickprint-text-btn",r.classes.borderSelect]),title:"边框"},[f("div",{class:h({[r.classes.border]:!0}),style:K(l.value)},null,6)],2)]),_:1}))}}),Ig="_border_rprfx_2",xg="_borderSelect_rprfx_10",Ag="_popover_rprfx_14",qg="_divider_rprfx_18",Dg={border:Ig,borderSelect:xg,popover:Ag,divider:qg},Og={classes:Dg},Mg=z(Lg,[["__cssModules",Og]]),$g={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Pg={class:"quickprint-config-section"},Vg={class:"quickprint-form-inline"},Bg={class:"quickprint-config-section quickprint-config-inline"},Fg={class:"quickprint-config-section"},zg={class:"quickprint-config-header quickprint-is-row"},Ug={class:"quickprint-is-fill-w"},Hg={class:"quickprint-config-content quickprint-form-inline quickprint-form-bottom-gap"},Gg={class:"quickprint-config-content quickprint-form-inline"},Wg=M({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=ue("px"),l=g("top"),s=g("bottom"),o=g("left"),c=g("right"),i=R(()=>qn.map(E=>({label:E.size===Dn.CUSTOM?"自定义":`${E.size}(${E.width}mm ✕ ${E.height}mm)`,value:E.size})));function r(E){e.config.width=E,m()}function d(E){e.config.height=E,m()}function u(E){const v=qn.find(a=>a.size===E);v!=null&&(e.config.width=v.width,e.config.height=v.height,e.config.orientation=v.orientation,e.config.margins=v.margins,e.config.size=v.size)}function m(){const E=e.config,v=qn.find(a=>a.size===Dn.CUSTOM?!1:a.orientation===E.orientation&&a.width===E.width&&a.height===E.height);if(v==null){E.size=Dn.CUSTOM;return}E.size=v.size}function g(E){return R({get(){var v;return(v=e.config.margins)==null?void 0:v[E]},set(v){e.config.margins==null&&(e.config.margins={}),e.config.margins[E]=v}})}return(E,v)=>(w(),N("div",$g,[f("section",Pg,[v[6]||(v[6]=f("header",{class:"quickprint-config-header"},[f("span",null,"尺寸")],-1)),p(y(Z),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":u,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),f("div",Vg,[p(It,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":r},null,8,["modelValue"]),p(It,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":d},null,8,["modelValue"])])]),f("section",Bg,[v[7]||(v[7]=f("header",{class:"quickprint-config-header"},"方向",-1)),p(Lt,{modelValue:n.config.orientation,"onUpdate:modelValue":v[0]||(v[0]=a=>n.config.orientation=a),options:y(Yl)},null,8,["modelValue","options"])]),f("section",Fg,[f("header",zg,[f("span",Ug,[p(y(qs),{title:"纸张的打印边距，可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:ye(()=>v[8]||(v[8]=[le("参考边距")])),_:1})]),v[9]||(v[9]=f("span",null,"单位：",-1)),p(ko,{modelValue:t.value,"onUpdate:modelValue":v[1]||(v[1]=a=>t.value=a)},null,8,["modelValue"])]),f("div",Hg,[p(nt,{class:"quickprint-form-inline-item",label:"上",modelValue:y(l),"onUpdate:modelValue":v[2]||(v[2]=a=>Ue(l)?l.value=a:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(nt,{class:"quickprint-form-inline-item",label:"下",modelValue:y(s),"onUpdate:modelValue":v[3]||(v[3]=a=>Ue(s)?s.value=a:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])]),f("div",Gg,[p(nt,{class:"quickprint-form-inline-item",label:"左",modelValue:y(o),"onUpdate:modelValue":v[4]||(v[4]=a=>Ue(o)?o.value=a:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"]),p(nt,{class:"quickprint-form-inline-item",label:"右",modelValue:y(c),"onUpdate:modelValue":v[5]||(v[5]=a=>Ue(c)?c.value=a:null),min:0,target:t.value,clearable:""},null,8,["modelValue","target"])])])]))}}),Yg={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},jg={class:"quickprint-is-fill-h"},Xg={class:"quickprint-is-fill-h"},Zg=M({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:Re.NONE},{label:"磅",value:Re.PT},{label:"像素",value:Re.PX}],l=R(()=>Nn.map(d=>(d.style={fontFamily:d.value==oe.DEFAULT?oe.SONG:d.value},d))),s=R(()=>go.map(d=>(d.style={fontFamily:d.value==oe.DEFAULT?oe.SONG:d.value},d))),o=R({get(){return e.config.style.fontFamily??oe.DEFAULT},set(d){const u=d===oe.DEFAULT?void 0:d;e.config.style.fontFamily=u}}),c=R({get(){return e.config.style.enFontFamily??oe.DEFAULT},set(d){const u=d===oe.DEFAULT?void 0:d;e.config.style.enFontFamily=u}}),i=R({get(){return e.config.style.fontSize},set(d){const u=ie(d)?void 0:d;e.config.style.fontSize=u}}),r=R({get(){return e.config.style.lineHeight},set(d){e.config.style.lineHeight=d}});return(d,u)=>(w(),N("div",Yg,[f("section",{class:h(d.classes.font)},[f("div",{class:h(d.classes.zhFont)},[f("div",{class:h(d.classes.title)},"中文字体",2),f("div",jg,[p(y(Z),{options:l.value,modelValue:o.value,"onUpdate:modelValue":u[0]||(u[0]=m=>o.value=m)},null,8,["options","modelValue"])])],2),f("div",{class:h(d.classes.enFont)},[f("div",{class:h(d.classes.title)},"西文字体",2),f("div",Xg,[p(y(Z),{options:s.value,modelValue:c.value,"onUpdate:modelValue":u[1]||(u[1]=m=>c.value=m)},null,8,["options","modelValue"])])],2),f("div",{class:h(d.classes.lineHeight)},[f("div",{class:h(d.classes.title)},"行高",2),p(ft,{modelValue:r.value,"onUpdate:modelValue":u[2]||(u[2]=m=>r.value=m),options:t},null,8,["modelValue"])],2),f("div",{class:h(d.classes.fontSize)},[f("div",{class:h(d.classes.title)},"字号",2),p(So,{modelValue:i.value,"onUpdate:modelValue":u[3]||(u[3]=m=>i.value=m),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),Kg="_font_145qf_2",Jg="_zhFont_145qf_9",Qg="_enFont_145qf_16",eh="_lineHeight_145qf_23",th="_fontSize_145qf_30",nh="_title_145qf_45",lh={font:Kg,zhFont:Jg,enFont:Qg,lineHeight:eh,fontSize:th,title:nh},oh={classes:lh},sh=z(Zg,[["__cssModules",oh]]),ih=M({__name:"index",props:{doc:{type:he,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=Xe(),l=Oe(s());function s(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function o(){t==null||t.confirm(l)}function c(){t==null||t.cancel()}return(i,r)=>(w(),N("div",{class:h(i.classes.setting)},[n.active=="paper"?(w(),J(Wg,{key:0,config:l},null,8,["config"])):H("",!0),n.active=="font"?(w(),J(sh,{key:1,config:l},null,8,["config"])):H("",!0),f("div",{class:h(i.classes.footer)},[f("button",{type:"button",class:"quickprint-text-btn",onClick:c},"取消"),f("button",{type:"button",class:"quickprint-text-btn",onClick:o},"确定")],2)],2))}}),rh="_setting_h98ws_2",ah="_footer_h98ws_10",ch={setting:rh,footer:ah},uh={classes:ch},dh=z(ih,[["__cssModules",uh]]),fh=Pe(function(n){return Jt("文档",(e,t)=>p(dh,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Me)}),ph=M({props:{toolbar:{type:Array,required:!0}},setup(n){const e=_e(),t=Ne("classes"),l=wg(e),s=kg(e),o=bg(e),c=Eg(e),i=yg(e),r=Cg(e),d=Rg(e),u=_g(e),m=hg(e),g=vg(e),E=Tg(e),v=Sg(e),a=R(()=>Nn.map(P=>(P.style={fontFamily:P.value==oe.DEFAULT?oe.SONG:P.value},P)));function b(P){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>P.handler(e)},[P.icon&&p(O,{icon:P.icon},null),p("span",null,[P.label])])}function S(P){P.preventDefault()}function x(){d.value=!d.value}function C(){u.value=!u.value}function T(){m.value=!m.value}function _(){g.value=!g.value}function L(){const P=e.getSelectedElements();if(P.length==0)return;const te=Math.min(...P.map(Y=>Y.left));for(const Y of P)Y.setLeft(te,!0);e.createSnapshot()}function k(){const P=e.getSelectedElements();if(P.length==0)return;const te=P[0].page;if(te==null)return;const Y=Mt(te.width);for(const q of P)q.setLeft((Y-q.width)/2);e.createSnapshot()}function I(){const P=e.getSelectedElements();if(P.length==0)return;const te=Math.max(...P.map(Y=>Y.left+Y.width));for(const Y of P)Y.setLeft(te-Y.width,!0);e.createSnapshot()}async function A(){const P=await Hr(e.doc);P!=null&&(e.doc.ds=e.doc.createDS(P))}function $(){fh(e.doc)}function F(P){var te,Y;if(typeof P=="function")return P(e,t);if(typeof P=="object")return b(P);if(typeof P!="string")return null;switch(P){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const q=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:q,onClick:e.history.undo},[p(O,{icon:"icon-undo"},null)])}case"redo":{const q=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:q,onClick:e.history.redo},[p(O,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(O,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(Z,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":q=>l.value=q,options:a.value,class:t.tool,button:!0},null);case"fontSize":return p(Z,{title:"字号",width:"60px",modelValue:s.value,"onUpdate:modelValue":q=>s.value=q,options:rl,class:t.tool,button:!0},null);case"lineHeight":return p(Z,{title:"行高",width:"60px",modelValue:o.value,"onUpdate:modelValue":q=>o.value=q,options:ho,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(lt,{modelValue:c.value,"onUpdate:modelValue":q=>c.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(O,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:c.value}},null)])]});case"highlightColor":return p(lt,{modelValue:i.value,"onUpdate:modelValue":q=>i.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(O,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return p(lt,{modelValue:r.value,"onUpdate:modelValue":q=>r.value=q,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(O,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"fontWeight":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":d.value};return p("button",{type:"button",title:"加粗",class:q,onClick:x},[p(O,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":u.value};return p("button",{type:"button",title:"斜体",class:q,onClick:C},[p(O,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":m.value};return p("button",{type:"button",title:"下划线",class:q,onClick:T},[p(O,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const q={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":g.value};return p("button",{type:"button",title:"删除线",class:q,onClick:_},[p(O,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(Mg,null,null);case"textAlign":{const q=((te=Un.find(ne=>ne.value===E.value))==null?void 0:te.label)??"水平对齐",re={selected({option:ne}){return p(O,{icon:ne==null?void 0:ne.icon,class:"quickprint-is-self-center"},null)}};return p(Z,{modelValue:E.value,"onUpdate:modelValue":ne=>E.value=ne,options:Un,title:q,class:t.tool,width:"36px",size:"mini",button:!0},re)}case"verticalAlign":{const q=((Y=zn.find(ne=>ne.value===v.value))==null?void 0:Y.label)??"垂直对齐",re={selected({option:ne}){return p(O,{icon:ne==null?void 0:ne.icon,class:"quickprint-is-self-center"},null)}};return p(Z,{modelValue:v.value,"onUpdate:modelValue":ne=>v.value=ne,options:zn,title:q,class:t.tool,width:"36px",size:"mini",button:!0},re)}case"alignLeft":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:q,onClick:L},[p(O,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:q,onClick:k},[p(O,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const q={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:q,onClick:I},[p(O,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:q,onClick:e.toggleBackground},[p(O,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:q,onClick:e.toggleElementPanel},[p(O,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const q={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:q,onClick:e.toggleConfigPanel},[p(O,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:A},[p(O,{icon:"icon-datasource"},null),p("span",null,[le("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:$},[p(O,{icon:"icon-file-text"},null),p("span",null,[le("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:S},[n.toolbar.map(F)])}}}),mh="_toolbar_1bhq2_2",gh="_divider_1bhq2_8",hh="_tool_1bhq2_2",vh="_colorIcon_1bhq2_18",bh="_colorIndicator_1bhq2_38",yh={toolbar:mh,divider:gh,tool:hh,colorIcon:vh,colorIndicator:bh},Eh={classes:yh},_h=z(ph,[["__cssModules",Eh]]);function Th(n){let e=null;const t=de(),l=Oe({width:0,height:0,scrollTop:0,scrollLeft:0}),s=de(),o=Oe({id:"",top:0,left:0,width:0,height:0});async function c(){await $t();const E=t.value;E!=null&&(l.width=E.offsetWidth,l.height=E.offsetHeight)}function i(E){const v=E.target;l.scrollLeft=v.scrollLeft,l.scrollTop=v.scrollTop}function r(E){const a=E.target.closest("."+G.PAPER);a!=null&&(s.value=a,u(a),d())}async function d(){await $t();const E=s.value;E!=null&&(o.id=E.id.slice(1),o.width=E.offsetWidth,o.height=E.offsetHeight,o.top=E.offsetTop,o.left=E.offsetLeft)}function u(E){E!=null&&(s.value&&(e==null||e.unobserve(s.value)),e==null||e.observe(E))}function m(){const E=n.doc.firstPage;if(E==null)return;const v=document.querySelector("#\\@"+E.id);s.value=v,e&&v&&e.observe(v),d()}function g(E){E.some(v=>v.target.matches("."+G.CANVAS))&&(c(),d()),E.some(v=>v.target.matches("."+G.PAPER))&&(c(),d())}return Qn(()=>n.state.scale,()=>d()),en(()=>{e=new ResizeObserver(g),e.observe(t.value),m(),c()}),fs(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:o,onScroll:i,onSelectPage:r}}const No=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),Sh=M({__name:"index",props:Tt({modelValue:{type:he,required:!0},toolbar:{type:Array,default(){return No}}},{modelValue:{required:!0},modelModifiers:{}}),emits:Tt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=de(),s=de(),o=Cs(),c=Qt(n,"modelValue"),i=rd(c,{queryElement:S,dispatchEvent:x}),{canvasRef:r,canvasRect:d,pageRect:u,onScroll:m,onSelectPage:g}=Th(i),E=R(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":o.value})),v=R(()=>{const T=i.doc.style;return{fontFamily:nl(T==null?void 0:T.fontFamily,T==null?void 0:T.enFontFamily),fontSize:T==null?void 0:T.fontSize,lineHeight:T==null?void 0:T.lineHeight}});function a(){i.state.panel.left=!1}function b(){i.state.panel.right=!1}function S(T){switch(T){case"ghost":return s.value;case"root":return l.value;default:return}}function x(T,..._){t(T,..._)}function C(T){T.deltaY>0?i.zoomIn():i.zoomOut()}return(T,_)=>(w(),N("div",{class:h(T.classes.designer),ref_key:"rootRef",ref:l,style:K(E.value)},[f("div",{class:h(T.classes.header)},[We(T.$slots,"headerLeft"),p(_h,{class:h(T.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),We(T.$slots,"headerRight")],2),f("div",{class:h(T.classes.main)},[y(i).state.panel.left?(w(),N("div",{key:0,class:h(T.classes.left)},[f("button",{type:"button",onClick:a,class:h(["quickprint-text-btn",T.classes.closePanelBtn])},[p(y(O),{icon:"icon-close",size:"12px"})],2),p(Sp)],2)):H("",!0),f("div",{class:h([T.classes.center,y(G).CANVAS]),onWheel:se(C,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:r},[p(Nl,{canvas:y(d),page:y(u),scale:y(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Nl,{canvas:y(d),page:y(u),scale:y(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),f("div",{class:h([y(G).SCROLLABLE,T.classes.canvas]),style:K(v.value),onScroll:_[0]||(_[0]=(...L)=>y(m)&&y(m)(...L)),onClickCapture:_[1]||(_[1]=(...L)=>y(g)&&y(g)(...L))},[(w(!0),N(X,null,ae(c.value.pages,L=>(w(),J(fp,{key:L.id,doc:c.value,page:L},null,8,["doc","page"]))),128))],38),f("div",{class:h(T.classes.footer)},[p(Ap),p(y(ts),{scale:y(i).state.scale,onZoomIn:y(i).zoomIn,onZoomOut:y(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),y(i).state.panel.right?(w(),N("div",{key:1,class:h(T.classes.right)},[f("button",{type:"button",onClick:b,class:h(["quickprint-text-btn",T.classes.closePanelBtn])},[p(y(O),{icon:"icon-close",size:"12px"})],2),p(gg)],2)):H("",!0)],2),f("div",{ref_key:"ghostRef",ref:s,class:h(T.classes.ghost)},null,2),p(y(ns))],6))}}),wh="_designer_grxxm_2",kh="_header_grxxm_17",Ch="_toolbar_grxxm_25",Rh="_footer_grxxm_31",Nh="_main_grxxm_47",Lh="_left_grxxm_55",Ih="_center_grxxm_63",xh="_right_grxxm_75",Ah="_canvas_grxxm_83",qh="_closePanelBtn_grxxm_96",Dh="_ghost_grxxm_103",Oh={designer:wh,header:kh,toolbar:Ch,footer:Rh,main:Nh,left:Lh,center:Ih,right:xh,canvas:Ah,closePanelBtn:qh,ghost:Dh},Mh={classes:Oh},$h=z(Sh,[["__cssModules",Mh]]),Ph={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:cn.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Me)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:cn.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:cn.DISABLED}};function Vh(n,e={}){const t=ls(e.zIndexManager);n.use(os,{zIndex:t,presets:Ph}),ss(n._context)}const Bh="0.0.0",Fh={version:Bh,install:Vh},zh=["onClick"],Uh=M({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=Xe();function l(s){t==null||t.confirm(s)}return(s,o)=>(w(),N("div",{class:h(s.classes.panel)},[(w(!0),N(X,null,ae(y(is),(c,i)=>(w(),N("div",{key:c.id,class:h(s.classes.item),onClick:r=>l(c)},[f("div",null,[f("span",null,W(i+1)+". ",1),f("span",null,W(c.name),1)])],10,zh))),128))],2))}}),Hh="_panel_1he7q_2",Gh="_item_1he7q_9",Wh={panel:Hh,item:Gh},Yh={classes:Wh},jh=z(Uh,[["__cssModules",Yh]]),Xh="local",Il="quickprint-local-define",Zh=M({__name:"index",setup(n){const e=Ne("classes"),t=E(),l="20250824",s=[{label:"新建",icon:"icon-file-text",handler:u},{label:"加载示例",icon:"icon-import",handler:r},"---",...No];function o(){const v=JSON.stringify(t.value);localStorage.setItem(Il,v)}function c(){o()}function i(){const v=t.value.id,a=v.startsWith("case_")?v:Xh,b=`${window.location.origin}/preview.html?id=${a}`;o(),Et("文档预览",St("iframe",{src:b,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(S){window.open(b,"_blank"),S.close()}}]})}function r(){const v={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:cn.DISABLED};Et("选择示例",St(jh),v).promisify().then(a=>d(a.id)).catch(Me)}async function d(v){const a=await pl(v,!1);a!=null&&(rs(v),t.value=he.create(a.define),m())}function u(){const v=he.createNormalDocument();t.value=v,m()}function m(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function g(){const v=localStorage.getItem(Il);if(v!=null)return he.create(v);const a=as(),b=await pl(a.id,!1);return b==null?he.createNormalDocument():he.create(b.define)}function E(){const v=ue();return g().then(a=>{v.value=a,m()}),v}return(v,a)=>y(t)?(w(),J(y($h),{modelValue:y(t),"onUpdate:modelValue":a[0]||(a[0]=b=>Ue(t)?t.value=b:null),toolbar:s,class:h(y(e).main),key:y(t).id,onSave:c,onPreview:i},{headerLeft:ye(()=>[f("div",{class:h(y(e).logo)},[a[1]||(a[1]=f("h1",null,"OpenPrint",-1)),f("div",{class:h(y(e).dev)},"DEV_"+W(y(l)),3)],2)]),headerRight:ye(()=>[f("div",{class:h(y(e).operate)},[f("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[p(y(O),{icon:"icon-run"}),a[2]||(a[2]=f("span",null,"预览",-1))]),f("button",{type:"button",onClick:o,class:"quickprint-text-btn",title:"保存"},[p(y(O),{icon:"icon-save"}),a[3]||(a[3]=f("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):H("",!0)}}),Kh="_main_he2u6_2",Jh="_iframe_he2u6_6",Qh="_divider_he2u6_14",ev="_logo_he2u6_20",tv="_dev_he2u6_39",nv="_operate_he2u6_51",lv={main:Kh,iframe:Jh,divider:Qh,logo:ev,dev:tv,operate:nv},ov={classes:lv},sv=z(Zh,[["__cssModules",ov]]),Lo=ps(sv);Lo.use(Fh);Lo.mount("#app");
