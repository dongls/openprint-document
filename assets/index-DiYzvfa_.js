const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/component-BzOvwT-C.js","assets/vue-B00pXJJQ.js","assets/component-DnlbD_FW.js","assets/utils-B9e9aOIh.js","assets/utils-BWxIAY5I.css","assets/component-DVhZYvzc.css"])))=>i.map(i=>d[i]);
var es=Object.defineProperty;var El=n=>{throw TypeError(n)};var ts=(n,e,t)=>e in n?es(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var W=(n,e,t)=>ts(n,typeof e!="symbol"?e+"":e,t),Zn=(n,e,t)=>e.has(n)||El("Cannot "+t);var Be=(n,e,t)=>(Zn(n,e,"read from private field"),t?t.call(n):e.get(n)),Qe=(n,e,t)=>e.has(n)?El("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(n):e.set(n,t),yt=(n,e,t,l)=>(Zn(n,e,"write to private field"),l?l.call(n,t):e.set(n,t),t),$e=(n,e,t)=>(Zn(n,e,"access private method"),t);import{D as Te,E as It,N as on,a as St,b as j,c as He,P as cl,d as an,e as Tl,f as Ln,g as Cn,O as cn,h as oe,i as mn,j as In,L as ze,I as U,_ as H,k as Ul,s as Mn,l as ns,m as me,n as Hl,p as On,C as qe,o as he,q as ls,r as ul,t as Gl,u as Ye,v as _n,w as os,x as ss,y as is,z as rs,A as An,B as Wl,V as Ot,F as Nn,G as dt,H as Yl,J as Xl,K as jl,M as Ee,Q as Ze,R as as,T as cs,S as ke,U as Xe,W as Le,X as vt,Y as lt,Z as us,$ as ds,a0 as fs,a1 as Ie,a2 as xn,a3 as ce,a4 as et,a5 as re,a6 as Re,a7 as Rt,a8 as En,a9 as Bt,aa as Q,ab as wt,ac as ot,ad as ft,ae as ps,af as pt,ag as pe,ah as Zl,ai as we,aj as Ft,ak as un,al as Ve,am as Bn,an as kt,ao as Qt,ap as Tn,aq as At,ar as ms,as as gs,at as xt,au as qt,av as hs,aw as vs,ax as bs,ay as ys,az as _s,aA as Xt,aB as gn,aC as Sl,aD as Es,aE as Rl,aF as be,aG as Kn,aH as Jn,aI as Ts,aJ as Ss,aK as Rs,aL as ws,aM as ks,aN as Ls,aO as wl,aP as Cs,aQ as Is}from"./utils-B9e9aOIh.js";import{r as de,o as dl,d as F,c as I,a as S,b as u,e as p,f as rt,n as m,u as Ne,s as ge,g as Oe,h as L,w as se,i as b,j as ee,k as Y,T as Kl,l as Z,m as Dt,p as fn,q as Jl,F as ne,t as ae,v as K,x as jt,y as kl,z as Ql,A as eo,B as pn,C as fl,D as _e,E as Se,G as Ae,H as ie,I as Zt,J as Os,K as to,L as Qn,M as st,N as mt,O as Ns,P as xs,Q as Ds,R as Ms}from"./vue-B00pXJJQ.js";const no="@quickprint_drag_mode",lo="@quickprint_drop_data",$n="@quickprint_operate",je="@quickprint_element",pl="@quickprint_element_type",oo="@quickprint_resize_flag",Nt=160,qn=32,en=[50,75,100,125,150,200,300,400];var sn=(n=>(n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n))(sn||{}),$t=(n=>(n[n.NONE=0]="NONE",n[n.TOP=1]="TOP",n[n.BOTTOM=2]="BOTTOM",n[n.LEFT=4]="LEFT",n[n.RIGHT=8]="RIGHT",n[n.BOTTOM_RIGHT=10]="BOTTOM_RIGHT",n))($t||{});const it={SINGLE:0,MULTIPLE:1},Fe=Object.freeze({INSERT:0,MOVE:1}),ml=Object.freeze({DRAG_ELEMENT:0,SELECTION:1}),J=Object.freeze({CANVAS:"quickprint-is-canvas",DRAGGABLE:"quickprint-is-draggable",DRAGGING:"quickprint-is-dragging",RESIZEABLE:"quickprint-is-resizeable",RESIZEABLE_INDICATOR:"quickprint-is-resizeable-indicator",RESIZING:"quickprint-is-resizing",DROPPABLE:"quickprint-is-droppable",ELEMENT:"quickprint-is-element",ELEMENT_EDITOR:"quickprint-is-element-editor",PAGE:"quickprint-is-page",PAPER:"quickprint-is-paper",SCROLLABLE:"quickprint-is-scrollable",SELECTABLE:"quickprint-is-selectable",SELECTED:"quickprint-is-selected",GUIDE_LINE:"quickprint-is-guideline"}),ue=Object.freeze({NONE:0,ELEMENT:1,PAGE:2}),so=[{label:"固定值",value:Te.CONST},{label:"变量",value:Te.VARIABLE},{label:"公式",value:Te.FORMULA,detail:"使用内置的公式生成数据"},{label:"自定义",value:Te.CODE,detail:"使用Javascript代码生成数据"}],As=[{label:"显示",value:It.VISIBLE,detail:"元素总是可见"},{label:"隐藏",value:It.HIDDEN,detail:"元素在打印时隐藏"},{label:"满足条件时显示",value:It.CONDITION,detail:"元素只在满足指定条件后显示"}],Bs=[{label:"四舍五入",value:on.ROUND},{label:"向下舍入",value:on.FLOOR},{label:"向上舍入",value:on.CEIL},{label:"四舍六入",value:on.BANKER_ROUND}],$s=[{label:"原始值",value:St.NONE},{label:"固定位数",value:St.FIXED},{label:"金额千位",value:St.THOUSAND},{label:"金额万位",value:St.TEN_THOUSAND},{label:"金额大写",value:St.DAXIE},{label:"百分比",value:St.PERCENTAGE}],qs=[{label:"显示",value:!0},{label:"隐藏",value:!1}],Ps=[{label:"默认",value:void 0},{label:"文本",value:j.TEXT},{label:"数字",value:j.NUMBER},{label:"日期",value:j.DATE}],fe={LAYOUT:0,COORD:1,SIZE:2,POSITION:3,VISIBILITY:5,OVERFLOW:6,PRINT_MODE:7,BASIC:100,PREFIX:101,SUFFIX:102,DISPLAY:103,ATTRIBUTES:200,DATASOURCE:300},io=[{label:"年-月",value:He.YEAR_MONTH,detail:"示例：2024-12"},{label:"年月",value:He.YEAR_MONTH_CHS,detail:"示例：2024年12月"},{label:"年-月-日",value:He.YEAR_MONTH_DAY,detail:"示例：2024-12-01"},{label:"年月日",value:He.YEAR_MONTH_DAY_CHS,detail:"示例：2024年12月01日"},{label:"年-月-日 时:分",value:He.DATETIME_SHORT,detail:"示例：2024-12-01 12:00"},{label:"年-月-日 时:分:秒",value:He.DATETIME,detail:"示例：2024-12-01 12:00:00"},{label:"时:分:秒",value:He.TIME,detail:"示例：12:00:00"},{label:"时:分",value:He.TIME_SHORT,detail:"示例：12:00"},{label:"年",value:He.YEAR,detail:"示例：2024"},{label:"月",value:He.MONTH,detail:"示例：12"},{label:"日",value:He.DAY,detail:"示例：01"}];io.forEach(n=>n.detail=`模板：${n.value}
${n.detail}`);const Vs=[{label:"元素值",value:cl.ELEMENT_VALUR}],Fs=[{label:"基于纸张",value:an.PAPER},{label:"基于内容",value:an.CONTENT}],ro=[{label:"纵向",value:Tl.PORTRAIT},{label:"横向",value:Tl.LANDSCAPE}],zs=[{label:"当前位置",value:Ln.DEFAULT,detail:"元素按当前位置进行定位，参与分页。如果之前的元素尺寸变化，会进行相应调整"},{label:"固定位置",value:Ln.FIXED,detail:"元素会在固定位置显示，不参与分页"}],Us=[{label:"单次打印",value:Cn.ONCE,detail:"元素只打印一次"},{label:"每页打印",value:Cn.EACH,detail:"元素将每页打印一次"}],Hs=[{label:"按内容调整高度",value:cn.AUTO,detail:"元素内容溢出时，将会根据内容自动调整元素高度"},{label:"隐藏溢出内容",value:cn.HIDDEN,detail:"元素内容溢出时，内容将会被隐藏"},{label:"缩放内容",value:cn.SCALE,detail:"元素内容溢出时，会对内容进行缩放，确保内容全部显示",disabled:!0}],nl=[{label:"页码",value:mn.PAGE_NUMBER,type:oe.NUMBER},{label:"总页数",value:mn.PAGE_TOTAL,type:oe.NUMBER},{label:"行序号",value:mn.ROW_INDEX,type:oe.NUMBER},{label:"当前时间",value:mn.CURRENT_DATE,type:oe.DATE}],Gs=["[0.3.pageNumber]","'[0.3.pageNumber]/[0.3.pageTotal]'","'第[0.3.pageNumber]页/共[0.3.pageTotal]页'"];function ao(n,e){return e=="body"?document.body:e=="parent"?n.parentElement:n.closest("."+e)}function Ws(n,e){const t=n.getBoundingClientRect(),l=e.getBoundingClientRect();return!(t.top>l.bottom||t.right<l.left||t.bottom<l.top||t.left>l.right)}function co(n){return n.isSelected?n.type===j.PARAGRAPH?52:n.type===j.TABLE?32:20:20}function Ys(){const n=de(window.devicePixelRatio),e=()=>n.value=window.devicePixelRatio,t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);return t.addEventListener("change",e),window.addEventListener("resize",e),dl(()=>{t.removeEventListener("change",e),window.removeEventListener("resize",e)}),n}class Xs{constructor(e,t,l){W(this,"originalEvent");W(this,"target");W(this,"ghost");W(this,"container");W(this,"paths",[]);W(this,"dropTarget");W(this,"top",0);W(this,"left",0);W(this,"deltaX");W(this,"deltaY");W(this,"moved",!1);this.originalEvent=e,this.ghost=t,this.target=t,this.container=l;const o=t.getBoundingClientRect();this.deltaX=o.left-e.clientX,this.deltaY=o.top-e.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.ghost.setPointerCapture(this.originalEvent.pointerId)}}var Ht,Gt,gt,uo,fo,po;const Ct=class Ct extends In{constructor(t={}){var l,o,s;super();Qe(this,gt);W(this,"context",null);W(this,"selector");W(this,"scale");W(this,"onDragStart");Qe(this,Ht);Qe(this,Gt);this.selector={container:((l=t.selector)==null?void 0:l.container)??J.PAGE,element:((o=t.selector)==null?void 0:o.element)??J.DRAGGABLE,droppable:((s=t.selector)==null?void 0:s.droppable)??J.DROPPABLE},this.onDragStart=$e(this,gt,uo).bind(this),this.scale=t.scale,yt(this,Ht,$e(this,gt,fo).bind(this)),yt(this,Gt,$e(this,gt,po).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){this.context!=null&&(window.removeEventListener("pointermove",Be(this,Ht)),window.removeEventListener("pointerup",Be(this,Gt)),this.context=null)}};Ht=new WeakMap,Gt=new WeakMap,gt=new WeakSet,uo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.element);if(l==null)return ze.warn(Ct.TAG_NAME,"未找到的可拖拽元素");const o=this.selector.container,s=ao(l,o);this.context=new Xs(t,l,s);const r=this.createEvent("before-dragstart",this.context);if(this.dispatch(r).defaultPrevented)return ze.warn(Ct.TAG_NAME,"已取消拖拽");if(this.context.container==null)return ze.warn(Ct.TAG_NAME,"未找到的拖拽元素的容器");this.context.init(this.normalizeScale());const i=this.createEvent("dragstart",this.context);if(this.dispatch(i).defaultPrevented)return ze.warn(Ct.TAG_NAME,"已取消拖拽");t.stopPropagation(),t.preventDefault(),window.addEventListener("pointermove",Be(this,Ht)),window.addEventListener("pointerup",Be(this,Gt))},fo=function(t){const l=this.context;if(l==null)return;const o=l.container.getBoundingClientRect(),s=document.elementsFromPoint(t.clientX,t.clientY),r=Array.from(s).filter(a=>!(a===l.ghost||a===l.target||l.ghost.contains(a))),i=this.normalizeScale();l.originalEvent=t,l.paths=r,l.dropTarget=r.find(a=>a.matches("."+J.DROPPABLE)),l.top=(t.clientY+l.deltaY-o.top)/i,l.left=(t.clientX+l.deltaX-o.left)/i,!this.dispatch(this.createEvent("dragging",l)).defaultPrevented&&(l.ghost.style.top=l.top+"px",l.ghost.style.left=l.left+"px")},po=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("dragend",l);this.dispatch(o).defaultPrevented||this.reset()},W(Ct,"TAG_NAME","quickprint-draggable");let ll=Ct;const js=["title"],Zs=F({__name:"HelpTitle",props:{title:{type:String,required:!0}},setup(n){return(e,t)=>(S(),I("span",{title:n.title,class:m(e.classes.help)},[u("span",null,[rt(e.$slots,"default")]),p(U,{icon:"icon-question-circle"})],10,js))}}),Ks="_help_1l6l8_2",Js={help:Ks},Qs={classes:Js},ei=H(Zs,[["__cssModules",Qs]]),ti=F({__name:"Popover",props:{width:{type:Number,default:null},disabled:{type:Boolean,default:!1}},emits:["show","close"],setup(n,{expose:e,emit:t}){const l=n,o=t,s=Ne("classes"),r=de(!1),i=ge(),a=ge(),d=Oe({minWidth:0,top:0,left:0,visible:!1}),f=L(()=>({minWidth:l.width==null?d.minWidth+"px":l.width+"px",top:d.top+"px",left:d.left+"px",visibility:d.visible?"visible":"hidden",zIndex:Ul()}));async function h(){if(r.value)return g();l.disabled||(r.value=!0,o("show"),await Mn(),E())}function g(){x(),r.value=!1,o("close")}function y(C){if(!(C.target instanceof Node))return;const O=i.value;if(O&&O.contains(C.target))return C.preventDefault();const k=a.value;if(k&&k.contains(C.target))return C.preventDefault();g()}function _(){const C=i.value,O=a.value;if(O==null||C==null)return;const k=C.getBoundingClientRect(),$=O.getBoundingClientRect(),B=l.width==null?k.width:l.width;let q=k.bottom+1;q+$.height>window.innerHeight&&k.top>$.height&&(q=k.top-$.height-1);let A=k.left;A+$.width>window.innerWidth&&(A=window.innerWidth-$.width-2),d.minWidth=B,d.top=q,d.left=A,d.visible=!0}function c(C){const O=C.target;if(!(O instanceof HTMLElement))return;const k=i.value;k==null||!O.contains(k)||g()}function v(C){if(C.key!=="Escape")return;const O=a.value;if(O!=null){const k=O.style.zIndex;if(Number(k)<ns())return}C.preventDefault(),g()}function E(){window.addEventListener("click",y,{capture:!0}),window.addEventListener("contextmenu",g,{capture:!0}),window.addEventListener("scroll",c,{capture:!0,passive:!0}),window.addEventListener("resize",_),window.addEventListener("keydown",v)}function x(){window.removeEventListener("click",y,!0),window.removeEventListener("contextmenu",g,!0),window.removeEventListener("scroll",c,!0),window.removeEventListener("resize",_),window.removeEventListener("keydown",v)}return e({close:g}),(C,O)=>(S(),I("div",{class:m(b(s).reference),onClick:se(h,["stop"]),ref_key:"referenceRef",ref:i,tabindex:"0"},[rt(C.$slots,"default"),r.value?(S(),ee(Kl,{key:0,to:"body"},[u("div",{class:m(b(s).popover),onVnodeMounted:_,onMousedown:O[0]||(O[0]=se(()=>{},["prevent"])),style:Z(f.value),ref_key:"popoverRef",ref:a},[rt(C.$slots,"popover")],38)])):Y("",!0)],2))}}),ni="_reference_1arli_2",li="_popover_1arli_7",oi={reference:ni,popover:li},si={classes:oi},mo=H(ti,[["__cssModules",si]]),ii=["title","onKeydown"],ri=["onMouseover","onClick"],ai=F({__name:"Select",props:Dt({modelValue:{type:[String,Number,Array]},options:{type:Array,default(){return[]}},size:{type:String,default:"default"},button:{type:Boolean,default:!1},width:{type:String,default:"100%"},popoverWidth:{type:Number,default:null},placeholder:{type:String,default:"请选择"},title:{type:String,default:null},border:{type:String,default:"auto"},appearance:{type:String,default:"auto"},clearable:{type:Boolean,default:!1},teleport:{type:String,default:"body"},multiple:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:Dt(["select","update:modelValue"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=n,o=Ne("classes"),s=ge(),r=ge(),i=fn(n,"modelValue"),a=de(),d=de(!1),f=Oe({width:0,top:0,left:0,visible:!1,scrollable:!1}),h=L(()=>l.teleport==="none"),g=L(()=>l.teleport=="none"?"body":l.teleport),y=L(()=>{const z={label:"",options:[]},G=[z];for(const X of l.options){if(Array.isArray(X.options)){G.push({label:X.label,options:X.options});continue}z.options.push(X)}return G}),_=L(()=>y.value.reduce((z,G)=>z.concat(G.options),[])),c=L(()=>{if(l.multiple!==!0){const G=Xn();return G?G.label:l.button?l.title:me(l.modelValue)?l.placeholder:l.modelValue}const z=jn();return z.length>0?z.map(G=>G.label).join(","):l.button?l.title:l.placeholder}),v=L(()=>l.clearable!==!0?!1:l.modelValue!=null),E=L(()=>({"quickprint-form-control":!0,"quickprint-form-control-small":l.size==="small"||l.button,"quickprint-form-hidden-border":l.button||l.border==="none","quickprint-form-disabled":l.disabled,[o.mini]:l.size==="mini",[o.select]:!0,[o.appearance]:l.appearance!=="none"&&!v.value,[o.button]:l.button,[o.showClearIcon]:v.value,[o.text]:l.size==="text"})),x=L(()=>({width:l.width})),C=L(()=>f.visible?{width:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",top:f.top+"px",left:f.left+"px",visibility:"visible",zIndex:Ul()}:{minWidth:l.popoverWidth==null?f.width+"px":l.popoverWidth+"px",visibility:"hidden"}),O=L(()=>({[o.content]:!0,[o.placeholder]:Hl(l.modelValue)}));async function k(){if(l.disabled)return;const z=_.value;if(z.length===0)return;if(d.value)return $();const G=s.value;G!=null&&(f.width=G.getBoundingClientRect().width,f.visible=!1,a.value=z.find(X=>X.value===l.modelValue),d.value=!0,await Mn(),Jo())}function $(){Qo(),d.value=!1}function B(z){N(),bt()}function q(z){z.disabled!==!0&&(a.value=z)}function A(z){if(l.disabled==!0||z.disabled===!0)return;if(l.multiple!==!0){i.value=z.value,t("select",z),$();return}const G=Array.isArray(i.value)?i.value:[],X=G.findIndex(ve=>ve===z.value);X>=0?G.splice(X,1):G.push(z.value),i.value=G,t("select",G)}function D(z){if(!(z.target instanceof Node))return;const G=s.value;if(G&&G.contains(z.target))return z.preventDefault();const X=r.value;if(X&&X.contains(z.target))return z.preventDefault();$()}async function N(){const z=s.value,G=r.value;if(G==null||z==null)return;await jt();const X=z.getBoundingClientRect(),ve=G.getBoundingClientRect();let ye=X.bottom+1;ye+ve.height>window.innerHeight&&X.top>ve.height&&(ye=X.top-ve.height-1);let Mt=X.left;Mt+ve.width>window.innerWidth&&(Mt=window.innerWidth-ve.width-2),f.width=ve.width,f.top=ye,f.left=Mt,f.visible=!0;const Jt=G.querySelector("."+o.list);f.scrollable=Jt?Jt.scrollHeight>Jt.clientHeight:!1}function M(z){const G=z.target;if(!(G instanceof HTMLElement))return;const X=s.value;X==null||!G.contains(X)||$()}function T(){const z=_.value,G=kl(a.value);if(G==null){a.value=xe(0),bt();return}const X=z.indexOf(G);if(X==0)return V();const ve=xe(X-1);ve!=null&&(a.value=ve,bt())}function R(){const z=_.value,G=kl(a.value);if(G==null){a.value=te(0),bt();return}const X=z.indexOf(G);if(X>=z.length-1){w();return}const ve=xe(X+1);ve!=null&&(a.value=ve,bt())}function w(){a.value=te(0),bt()}function V(){const z=_.value;a.value=xe(z.length-1),bt()}function P(){i.value=void 0,$()}function te(z){const X=_.value[z];return X==null?null:X.disabled===!0?te(z+1):X}function xe(z){const X=_.value[z];return X==null?null:X.disabled===!0?xe(z-1):X}function De(z){switch(z.key){case"Enter":z.preventDefault(),a.value&&A(a.value);return;case"Escape":z.preventDefault(),$();return;case"ArrowUp":z.preventDefault(),T();return;case"ArrowDown":z.preventDefault(),R();return;case"Home":z.preventDefault(),w();return;case"End":z.preventDefault(),V();return}}function Je(z){if(l.disabled)return;const G=s.value;G!=null&&document.activeElement===G&&(d.value||(z.stopPropagation(),k()))}function Ko(z){if(l.multiple!==!0)return l.modelValue===z.value;const G=l.modelValue;return Array.isArray(G)?G.includes(z.value):!1}async function bt(){if(a.value==null)return;await jt();const z=r.value;if(z==null)return;const G=z.querySelector("."+o.hover);G&&G.scrollIntoView({block:"nearest"})}function Xn(){const z=_.value,G=Array.isArray(l.modelValue)?l.modelValue[0]:l.modelValue;return z.find(X=>X.value===G)}function jn(){const z=_.value;return(Array.isArray(l.modelValue)?l.modelValue:[l.modelValue]).filter(X=>X).map(X=>{const ve=z.find(ye=>ye.value===X);return ve||{value:X,label:X}})}function Jo(){window.addEventListener("mousedown",D,{capture:!0}),window.addEventListener("pointerdown",D,{capture:!0}),window.addEventListener("contextmenu",$,{capture:!0}),window.addEventListener("scroll",M,{capture:!0,passive:!0}),window.addEventListener("resize",N),window.addEventListener("keydown",De)}function Qo(){window.removeEventListener("mousedown",D,!0),window.removeEventListener("pointerdown",D,!0),window.removeEventListener("contextmenu",$,!0),window.removeEventListener("scroll",M,!0),window.removeEventListener("resize",N),window.removeEventListener("keydown",De)}return(z,G)=>{var X;return S(),I("div",{class:m(E.value),title:n.title,style:Z(x.value),onClick:se(k,["stop"]),onKeydown:Jl(se(Je,["prevent"]),["enter"]),ref_key:"selectRef",ref:s,tabindex:"0"},[z.$slots.selected?rt(z.$slots,"selected",{key:0,option:Xn(),options:jn()}):rt(z.$slots,"option",{key:1,option:Xn(),options:jn()},()=>[u("div",{class:m(O.value)},[u("span",null,K(c.value),1),v.value?(S(),ee(U,{key:0,icon:"icon-close",onClick:se(P,["stop"]),size:"12px",class:m(b(o).clearIcon)},null,8,["class"])):Y("",!0)],2)]),d.value?(S(),ee(Kl,{key:2,to:g.value,disabled:h.value},[u("div",{class:m(b(o).popover),onClick:G[0]||(G[0]=se(()=>{},["stop"])),onVnodeMounted:B,onMousedown:G[1]||(G[1]=se(()=>{},["prevent"])),style:Z(C.value),ref_key:"popoverRef",ref:r},[u("div",{class:m(b(o).list)},[(S(!0),I(ne,null,ae(y.value,ve=>(S(),I(ne,null,[ve.label?(S(),I("div",{key:0,class:m(b(o).groupLabel)},K(ve.label),3)):Y("",!0),(S(!0),I(ne,null,ae(ve.options,ye=>{var Mt;return S(),I("div",{key:ye.value,class:m({[b(o).option]:!0,[b(o).disabled]:ye.disabled===!0,[b(o).selected]:Ko(ye),[b(o).hover]:((Mt=a.value)==null?void 0:Mt.value)==ye.value}),style:Z(ye.style),onMouseover:Jt=>q(ye),onClick:Jt=>A(ye)},[rt(z.$slots,"option",{option:ye},()=>[u("div",{class:m(b(o).label)},[ye.icon?(S(),ee(U,{key:0,icon:ye.icon,class:m(b(o).icon)},null,8,["icon","class"])):Y("",!0),u("span",null,K(ye.label),1)],2),ye.short?(S(),I("div",{key:0,class:m(b(o).short)},K(ye.short),3)):Y("",!0)])],46,ri)}),128))],64))),256))],2),(X=a.value)!=null&&X.detail&&f.visible?(S(),I("div",{key:0,class:m(b(o).detail)},K(a.value.detail),3)):Y("",!0)],38)],8,["to","disabled"])):Y("",!0)],46,ii)}}}),ci="_button_g23yb_2",ui="_select_g23yb_7",di="_appearance_g23yb_16",fi="_content_g23yb_31",pi="_placeholder_g23yb_37",mi="_popover_g23yb_41",gi="_list_g23yb_51",hi="_option_g23yb_80",vi="_label_g23yb_95",bi="_icon_g23yb_102",yi="_hover_g23yb_106",_i="_detail_g23yb_117",Ei="_short_g23yb_127",Ti="_selected_g23yb_133",Si="_disabled_g23yb_137",Ri="_showClearIcon_g23yb_142",wi="_clearIcon_g23yb_146",ki="_text_g23yb_159",Li="_mini_g23yb_171",Ci="_groupLabel_g23yb_183",Ii={button:ci,select:ui,appearance:di,content:fi,placeholder:pi,popover:mi,list:gi,option:hi,label:vi,icon:bi,hover:yi,detail:_i,short:Ei,selected:Ti,disabled:Si,showClearIcon:Ri,clearIcon:wi,text:ki,mini:Li,groupLabel:Ci},Oi={classes:Ii},le=H(ai,[["__cssModules",Oi]]),Ni="_tree_1p28f_1",xi="_node_1p28f_5",Di="_content_1p28f_11",Mi="_space_1p28f_27",Ai="_expand_1p28f_28",Bi="_active_1p28f_47",$i="_children_1p28f_55",ct={tree:Ni,node:xi,content:Di,space:Mi,expand:Ai,active:Bi,children:$i},go=Symbol(),ho=F({emits:["nodeClick","nodeHover"],props:{node:{type:Object,required:!0}},setup(n,{emit:e}){const t=Ql(go),l=L(()=>Array.isArray(n.node.children)&&n.node.children.length>0),o=L({get(){const c=t==null?void 0:t.state[n.node.value];return c==null?!1:c.expand},set(c){const v=t==null?void 0:t.state[n.node.value];v!=null&&(v.expand=c)}});function s(c){c.preventDefault(),o.value=!o.value}function r(){if(!l.value)return p("div",{class:ct.space},null);const c={[ct.expand]:!0,[ct.active]:o.value};return p("div",{onMousedown:_,onClick:s,class:c},[p(U,{icon:"icon-right",size:"12px"},null)])}function i(){return typeof(t==null?void 0:t.content)=="function"?t.content({node:n.node}):p("span",null,[n.node.label])}function a(){return p("div",{class:ct.content,onClick:f,onMouseenter:g},[i()])}function d(){if(!l.value||!o.value)return;const c=n.node.children.map(v=>p(ho,{node:v,onNodeClick:h,onNodeHover:y},null));return p("div",{class:ct.children},[c])}function f(){e("nodeClick",n.node)}function h(c){e("nodeClick",c)}function g(){e("nodeHover",n.node)}function y(c){e("nodeHover",c)}function _(c){c.preventDefault()}return function(){return p("div",{class:ct.subTree},[p("div",{class:ct.node},[r(),a()]),d()])}}}),qi=F({props:{data:{type:Array,required:!0}},emits:["nodeClick","nodeHover"],setup(n,{slots:e,emit:t}){const l=r();function o(a){t("nodeClick",a)}function s(a){t("nodeHover",a)}function r(){const a=Oe({}),d=function(f,h){for(const g of f)h[g.value]={expand:g.expand!==!1},g.children&&d(g.children,h)};return d(n.data,a),a}function i(a){return typeof e.default=="function"?e.default(a):null}return eo(go,{state:l,content:i}),function(){const a=n.data.map(d=>p(ho,{node:d,onNodeClick:o,onNodeHover:s},null));return p("div",{class:ct.tree},[a])}}});function hn(n){const e=Math.pow(10,Math.max(0,2));return Math.round(n*e)/e}const el={A:10,B:11,C:12,D:13,E:14,F:15},Ll={10:"A",11:"B",12:"C",13:"D",14:"E",15:"F"};function Pi(n){return typeof n=="string"&&n.includes(".")&&Number.parseFloat(n)===1}function Vi(n){return typeof n=="string"&&n.includes("%")}function zt(n,e){Pi(n)&&(n="100%");const t=Vi(n);return n=Math.min(e,Math.max(0,Number.parseFloat(`${n}`))),t&&(n=Number.parseInt(`${n*e}`,10)/100),Math.abs(n-e)<1e-6?1:n%e/Number.parseFloat(e)}function _t(n){return n.length===2?(el[n[0].toUpperCase()]||+n[0])*16+(el[n[1].toUpperCase()]||+n[1]):el[n[1].toUpperCase()]||+n[1]}function Cl(n,e,t){n=zt(n,255),e=zt(e,255),t=zt(t,255);const l=Math.max(n,e,t),o=Math.min(n,e,t);let s;const r=l,i=l-o,a=l===0?0:i/l;if(l===o)s=0;else{switch(l){case n:{s=(e-t)/i+(e<t?6:0);break}case e:{s=(t-n)/i+2;break}case t:{s=(n-e)/i+4;break}}s/=6}return{h:s*360,s:a*100,v:r*100}}const Fi=function(n,e,t){e=e/100,t=t/100;let l=e;const o=Math.max(t,.01);t*=2,e*=t<=1?t:2-t,l*=o<=1?o:2-o;const s=(t+e)/2,r=t===0?2*l/(o+l):2*e/(t+e);return{h:n,s:r*100,v:s*100}},zi=function(n,e,t){return[n,e*t/((n=(2-e)*t)<1?n:2-n)||0,n/2]};function tl(n,e,t){n=zt(n,360)*6,e=zt(e,100),t=zt(t,100);const l=Math.floor(n),o=n-l,s=t*(1-e),r=t*(1-o*e),i=t*(1-(1-o)*e),a=l%6,d=[t,r,s,s,i,t][a],f=[i,t,t,r,s,s][a],h=[s,s,i,t,t,r][a];return{r:Math.round(d*255),g:Math.round(f*255),b:Math.round(h*255)}}function Sn(n){n=Math.min(Math.round(n),255);const e=Math.floor(n/16),t=n%16;return`${Ll[e]||e}${Ll[t]||t}`}function Ui({r:n,g:e,b:t}){return Number.isNaN(+n)||Number.isNaN(+e)||Number.isNaN(+t)?"":`#${Sn(n)}${Sn(e)}${Sn(t)}`}class Pn{constructor(e){W(this,"h",0);W(this,"s",100);W(this,"v",100);W(this,"a",100);e&&this.setColor(e)}setColor(e){const t=this.processColor(e);t!=null&&(this.setHue(t.h),this.setSaturation(t.s),this.setValue(t.v),this.setAlpha(t.a))}setHue(e){this.h=hn(e)}setSaturation(e){this.s=hn(e)}setValue(e){this.v=hn(e)}setAlpha(e){this.a=hn(e)}processColor(e){return e==null||e==""?null:e.startsWith("#")?this.processHEX(e):e.startsWith("rgb")?this.processRGB(e):e.startsWith("hsl")?this.processHSL(e):this.processHSV(e)}processHSV(e){const t=e.replace(/hsva|hsv|\(|\)/gm,"").split(/\s|,/g).filter(o=>o!=="").map((o,s)=>s>2?Number.parseFloat(o):Number.parseInt(o,10)),l=t.length===4?t[3]*100:100;return{h:t[0],s:t[1],v:t[2],a:l}}processHEX(e){const t=e.replace("#","").trim();if(!/^[0-9a-fA-F]{3}$|^[0-9a-fA-F]{6}$|^[0-9a-fA-F]{8}$/.test(t))return null;let l,o,s,r=100;t.length===3?(l=_t(t[0]+t[0]),o=_t(t[1]+t[1]),s=_t(t[2]+t[2])):(t.length===6||t.length===8)&&(l=_t(t.slice(0,2)),o=_t(t.slice(2,4)),s=_t(t.slice(4,6))),t.length===8&&(r=_t(t.slice(6))/255*100);const{h:i,s:a,v:d}=Cl(l,o,s);return{h:i,s:a,v:d,a:r}}processRGB(e){const t=e.replace(/rgba|rgb|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Cl(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}processHSL(e){const t=e.replace(/hsla|hsl|\(|\)/gm,"").split(/\s|,/g).filter(l=>l!=="").map((l,o)=>o>2?Number.parseFloat(l):Number.parseInt(l,10));if(t.length>=3){const l=t.length===4?t[3]*100:100,{h:o,s,v:r}=Fi(t[0],t[1],t[2]);return{h:o,s,v:r,a:l}}return null}toString(e){switch(e){case"hsl":{const t=zi(this.h,this.s/100,this.v/100);return`hsla(${this.h},${Math.round(t[1]*100)}%,${Math.round(t[2]*100)}%,${this.a/100})`}case"hex":return`${Ui(tl(this.h,this.s,this.v))}${Sn(this.a*255/100)}`;case"rgb":{const{r:t,g:l,b:o}=tl(this.h,this.s,this.v);return`rgba(${t},${l},${o},${this.a/100})`}default:return`hsva(${this.h},${Math.round(this.s)}%,${Math.round(this.v)}%,${this.a/100})`}}toRGB(){return this.toString("rgb")}toHSL(){return this.toString("hsl")}toHEX(){return this.toString("hex")}rgb(){return tl(this.h,this.s,this.v)}}function vo(n){const e={init:!1,target:null,container:null,offsetX:0};function t(r){const i=e.container.getBoundingClientRect(),d=e.target.getBoundingClientRect().width/2;let f=r.clientX-i.left-e.offsetX;return f<-d&&(f=-d),f>i.width-d&&(f=i.width-d),f}function l(r){r.stopPropagation(),r.preventDefault();const i=r.target,a=r.currentTarget;origin==null||i==null||(e.container=a,e.target=i===a?i.firstElementChild:i,e.offsetX=i===a?e.target.offsetWidth/2:r.clientX-i.getBoundingClientRect().left,window.addEventListener("pointermove",o),window.addEventListener("pointerup",s))}function o(r){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(r.pointerId),e.init=!0);const i=t(r);e.target.style.left=i+"px",n("move",i)}function s(r){if(r.preventDefault(),r.stopPropagation(),e.container&&e.target){const i=t(r);n("end",i)}e.target&&e.target.releasePointerCapture(r.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",o),window.removeEventListener("pointerup",s)}return l}function Hi(n){const e={init:!1,target:null,container:null,offsetX:0,offsetY:0};function t(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().width/2;let h=i.clientX-a.left-e.offsetX;return h<-f&&(h=-f),h>a.width-f&&(h=a.width-f),h}function l(i){const a=e.container.getBoundingClientRect(),f=e.target.getBoundingClientRect().height/2;let h=i.clientY-a.top-e.offsetY;return h<-f&&(h=-f),h>a.height-f&&(h=a.height-f),h}function o(i){i.stopPropagation(),i.preventDefault();const a=i.target,d=i.currentTarget;origin==null||a==null||(e.container=d,e.target=a===d?a.firstElementChild:a,e.offsetX=a===d?e.target.offsetWidth/2:i.clientX-a.getBoundingClientRect().left,e.offsetY=a===d?e.target.offsetHeight/2:i.clientY-a.getBoundingClientRect().top,window.addEventListener("pointermove",s),window.addEventListener("pointerup",r))}function s(i){if(e.container==null||e.target==null)return;e.init||(e.target.setPointerCapture(i.pointerId),e.init=!0);const a=t(i),d=l(i);e.target.style.left=a+"px",e.target.style.top=d+"px",n("move",{left:a,top:d})}function r(i){if(i.preventDefault(),i.stopPropagation(),e.container&&e.target){const a=t(i),d=l(i);n("end",{top:d,left:a})}e.target&&e.target.releasePointerCapture(i.pointerId),e.target=null,e.container=null,e.init=!1,window.removeEventListener("pointermove",s),window.removeEventListener("pointerup",r)}return o}const Gi=F({__name:"SvPanel",props:{modelValue:{type:Pn,required:!0}},setup(n){const e=n,t=ge(),l=ge(),o=Oe(i()),s=L(()=>({left:o.left+"px",top:o.top+"px"})),r=Hi((a,d)=>{a=="end"&&(o.top=d.top,o.left=d.left);const f=t.value,h=l.value,g=(d.left+h.offsetWidth/2)/f.offsetWidth*100,y=100-(d.top+h.offsetHeight)/f.offsetHeight*100;e.modelValue.setSaturation(g),e.modelValue.setValue(y)});function i(){const a=t.value,d=l.value;if(a==null||d==null)return{top:-6,left:-6};const f=e.modelValue.s,g=(100-e.modelValue.v)/100*a.offsetHeight,y=f/100*a.offsetWidth;return{top:g-d.offsetHeight/2,left:y-d.offsetWidth/2}}return pn(()=>{const a=i();o.top=a.top,o.left=a.left}),(a,d)=>(S(),I("div",{class:m(a.classes.svPanel),onPointerdown:d[0]||(d[0]=(...f)=>b(r)&&b(r)(...f)),ref_key:"svPanelRef",ref:t},[u("div",{class:m(a.classes.thumb),style:Z(s.value),ref_key:"thumbRef",ref:l},null,6)],34))}}),Wi="_svPanel_1sv6o_2",Yi="_thumb_1sv6o_10",Xi={svPanel:Wi,thumb:Yi},ji={classes:Xi},Zi=H(Gi,[["__cssModules",ji]]),Ki=F({__name:"HueSlider",props:{modelValue:{type:Pn,required:!0}},setup(n){const e=n,t=de(-6),l=ge(),o=ge(),s=vo((i,a)=>{i=="end"&&(t.value=a);const d=l.value,f=o.value,h=Math.round((a+f.offsetWidth/2)/d.offsetWidth*360);e.modelValue.setHue(h)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const d=e.modelValue.h;return Math.round(d/360*i.offsetWidth)-a.offsetWidth/2}return pn(()=>{t.value=r()}),(i,a)=>(S(),I("div",{class:m(i.classes.hue),onPointerdown:a[0]||(a[0]=(...d)=>b(s)&&b(s)(...d)),ref_key:"hueRef",ref:l},[u("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),Ji="_hue_1ozoc_2",Qi="_thumb_1ozoc_10",er={hue:Ji,thumb:Qi},tr={classes:er},nr=H(Ki,[["__cssModules",tr]]),lr=F({__name:"AlphaSlider",props:{modelValue:{type:Pn,required:!0}},setup(n){const e=n,t=de(-6),l=ge(),o=ge(),s=vo((i,a)=>{i=="end"&&(t.value=a);const d=l.value,f=o.value,h=Math.round((a+f.offsetWidth/2)/d.offsetWidth*100);e.modelValue.setAlpha(h)});function r(){const i=l.value,a=o.value;if(i==null||a==null)return-6;const d=e.modelValue.a;return Math.round(d/100*i.offsetWidth)-a.offsetWidth/2}return pn(()=>{t.value=r()}),(i,a)=>(S(),I("div",{class:m(i.classes.alpha),onPointerdown:a[0]||(a[0]=(...d)=>b(s)&&b(s)(...d)),ref_key:"alphaRef",ref:l},[u("div",{class:m(i.classes.thumb),style:Z({left:t.value+"px"}),ref_key:"thumbRef",ref:o},null,6)],34))}}),or="_alpha_1x8jd_2",sr="_thumb_1x8jd_26",ir={alpha:or,thumb:sr},rr={classes:ir},ar=H(lr,[["__cssModules",rr]]),cr=["#FFFFFF","#000000","#485368","#2972F4","#00A3F5","#319B62","#DE3C36","#F88825","#F5C400","#9A38D7","#F2F2F2","#7F7F7F","#F3F5F7","#E5EFFF","#E5F6FF","#EAFAF1","#FFE9E8","#FFF3EB","#FFF9E3","#FDEBFF","#D8D8D8","#595959","#C5CAD3","#C7DCFF","#C7ECFF","#C3EAD5","#FFC9C7","#FFDCC4","#FFEEAD","#F2C7FF","#BFBFBF","#3F3F3F","#808B9E","#99BEFF","#99DDFF","#98D7B6","#FF9C99","#FFBA84","#FFE270","#D58EFF","#A5A5A5","#262626","#353B45","#1450B8","#1274A5","#277C4F","#9E1E1A","#B86014","#A38200","#5E2281","#939393","#0D0D0D","#24272E","#0C306E","#0A415C","#184E32","#58110E","#5C300A","#665200","#3B1551"];function ur(){try{return typeof window.EyeDropper=="function"}catch(n){return console.log(n),!1}}async function dr(){try{return(await new EyeDropper().open()).sRGBHex}catch(n){return console.error(n),null}}const Il={isSupport:ur,open:dr},fr=["title","onClick"],pr=["title","onClick"],Ol="quickprint-recent-use-colors",mr=F({__name:"Picker",props:{modelValue:{type:String,default:null},showText:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=[{value:"hex",label:"HEX"},{value:"rgb",label:"RGB"},{value:"hsl",label:"HSL"}],s=de(new Pn(l.modelValue)),r=ge(),i=ge(),a=de(x()),d=Il.isSupport(),f=de("hex"),h=L(()=>{const k=l.modelValue;return k?{backgroundColor:k}:null}),g=L(()=>{const k=s.value,{r:$,g:B,b:q}=k.rgb();return{"--hue-channel-color":`hsl(${k.h}, 100%, 50%)`,"--alpha-channel-color-a":`rgba(${$}, ${B}, ${q}, 0)`,"--alpha-channel-color-b":`rgba(${$}, ${B}, ${q}, 1)`}}),y=L({get(){return s.value.toString(f.value)},set(k){s.value.setColor(k)}});function _(){var k;(k=r.value)==null||k.close()}function c(k){k!=null&&(t("update:modelValue",k),t("select",k),C(k),_())}function v(){t("update:modelValue",void 0),t("select",void 0),_()}function E(){Il.open().then(k=>c(k))}function x(){const k=localStorage.getItem(Ol);if(k==null||k=="")return[];const $=On(k);return $==null?[]:Array.isArray($)?$:[]}function C(k){const $=a.value,B=$.indexOf(k);B>=0&&$.splice(B,1),$.length>10&&$.pop(),$.unshift(k),localStorage.setItem(Ol,JSON.stringify($))}function O(){t("update:modelValue",s.value.toString(f.value)),t("select",s.value.toString(f.value)),_()}return fl(()=>l.modelValue,()=>s.value.setColor(l.modelValue)),(k,$)=>(S(),ee(mo,{class:m(k.classes.colorPicker),onMousedown:$[7]||($[7]=se(()=>{},["prevent"])),ref_key:"popoverRef",ref:r,disabled:n.disabled},{popover:_e(()=>[u("div",{class:m(k.classes.colorPickerPanel)},[u("div",{class:m(k.classes.presetPanel)},[u("div",{class:m(k.classes.presetTools)},[u("button",{type:"button",class:m(k.classes.clearBtn),onClick:v},[u("span",{class:m(k.classes.none)},null,2),$[8]||($[8]=u("span",null,"无颜色",-1))],2),b(d)?(S(),I("button",{key:0,type:"button",class:m(k.classes.indicator),onClick:E},[p(U,{icon:"icon-eye-dropper"}),$[9]||($[9]=u("span",null,"拾色器",-1))],2)):Y("",!0)],2),u("div",{class:m(k.classes.colourAtla)},[(S(!0),I(ne,null,ae(b(cr),B=>(S(),I("div",{style:Z({backgroundColor:B}),title:B,class:m(k.classes.color),onClick:q=>c(B)},null,14,fr))),256))],2),u("div",{class:m(k.classes.recentColors)},"最近使用",2),u("div",{class:m(k.classes.colourAtla)},[(S(),I(ne,null,ae(10,B=>u("div",{key:B,title:a.value[B-1],style:Z({backgroundColor:a.value[B-1]}),class:m(k.classes.color),onClick:q=>c(a.value[B-1])},null,14,pr)),64))],2)],2),u("div",{class:m(k.pacls.panel),style:Z(g.value)},[p(Zi,{class:m(k.pacls.sv),modelValue:s.value,"onUpdate:modelValue":$[1]||($[1]=B=>s.value=B)},null,8,["class","modelValue"]),u("div",{class:m(k.pacls.sliders)},[p(nr,{class:m(k.pacls.hua),modelValue:s.value,"onUpdate:modelValue":$[2]||($[2]=B=>s.value=B)},null,8,["class","modelValue"]),p(ar,{modelValue:s.value,"onUpdate:modelValue":$[3]||($[3]=B=>s.value=B)},null,8,["modelValue"]),u("div",{class:m(k.pacls.preview)},[u("div",{class:m(k.pacls.previewColor),style:Z({backgroundColor:s.value.toRGB()})},null,6)],2)],2),u("div",{class:m(k.pacls.tools)},[p(le,{options:o,teleport:"none",modelValue:f.value,"onUpdate:modelValue":$[4]||($[4]=B=>f.value=B),width:"42px",border:"none",size:"text"},null,8,["modelValue"]),Se(u("input",{type:"text","onUpdate:modelValue":$[5]||($[5]=B=>y.value=B),onMousedown:$[6]||($[6]=se(()=>{},["stop"])),class:"quickprint-form-control",style:{width:"120px"}},null,544),[[Ae,y.value]]),u("button",{type:"button",class:m(k.pacls.confirm),onClick:O},"确定",2)],2)],6)],2)]),default:_e(()=>[u("div",{class:m({[k.classes.colorPickerInput]:!0,[k.classes.disabled]:n.disabled}),ref_key:"inputRef",ref:i},[rt(k.$slots,"default",{},()=>[u("span",{class:m(k.classes.colorBlock),style:Z(h.value)},null,6)]),n.showText?(S(),I("div",{key:0,class:m(k.classes.colorValue),onClick:$[0]||($[0]=se(()=>{},["stop"]))},K(n.modelValue),3)):Y("",!0)],2)]),_:3},8,["class","disabled"]))}}),gr="_colorPicker_1egpm_2",hr="_disabled_1egpm_6",vr="_colorPickerInput_1egpm_10",br="_colorBlock_1egpm_17",yr="_colorValue_1egpm_26",_r="_colorPickerPanel_1egpm_31",Er="_presetPanel_1egpm_45",Tr="_colourAtla_1egpm_49",Sr="_color_1egpm_2",Rr="_presetTools_1egpm_76",wr="_clearBtn_1egpm_82",kr="_indicator_1egpm_83",Lr="_none_1egpm_101",Cr="_recentColors_1egpm_132",Ir={colorPicker:gr,disabled:hr,colorPickerInput:vr,colorBlock:br,colorValue:yr,colorPickerPanel:_r,presetPanel:Er,colourAtla:Tr,color:Sr,presetTools:Rr,clearBtn:wr,indicator:kr,none:Lr,recentColors:Cr},Or="_panel_911zv_2",Nr="_sv_911zv_7",xr="_hua_911zv_11",Dr="_sliders_911zv_15",Mr="_tools_911zv_20",Ar="_confirm_911zv_37 quickprint-text-btn",Br="_preview_911zv_44",$r="_previewColor_911zv_59",qr={panel:Or,sv:Nr,hua:xr,sliders:Dr,tools:Mr,confirm:Ar,preview:Br,previewColor:$r},Pr={classes:Ir,pacls:qr},Ut=H(mr,[["__cssModules",Pr]]),Vr=F({__name:"Input",props:{modelValue:{type:String,default:null},disabled:{type:Boolean,default:!1}},emits:["update:modelValue","select"],setup(n,{emit:e}){const t=e,l=n,o=L({get(){return l.modelValue},set(i){t("update:modelValue",i)}}),s=L(()=>{const i=l.modelValue;return Hl(i)||i===qe.INHERIT});function r(i){t("select",i)}return(i,a)=>(S(),ee(Ut,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=d=>o.value=d),disabled:n.disabled,onSelect:r},{default:_e(()=>[u("div",{class:m({[i.classes.indicator]:!0,[i.classes.disabled]:n.disabled})},[u("div",{class:m({[i.classes.colorBlock]:!0,[i.classes.colorNone]:s.value}),style:Z({backgroundColor:o.value})},null,6),u("div",{class:m(i.classes.colorValue)},K(s.value?"默认":o.value),3)],2)]),_:1},8,["modelValue","disabled"]))}}),Fr="_indicator_14ypk_2",zr="_disabled_14ypk_8",Ur="_colorBlock_14ypk_27",Hr="_colorValue_14ypk_38",Gr="_colorNone_14ypk_45",Wr={indicator:Fr,disabled:zr,colorBlock:Ur,colorValue:Hr,colorNone:Gr},Yr={classes:Wr},Rn=H(Vr,[["__cssModules",Yr]]);function Xr(n,e=0){let t=null;return function(...l){t&&clearTimeout(t),t=window.setTimeout(()=>{n.apply(this,l),t=null},e)}}function jr(n,e=0){let t=0,l=null;return function(...o){const s=Date.now();if(s-t<e){l&&clearTimeout(l),l=window.setTimeout(()=>{l=null,n.apply(this,o),t=Date.now()},e);return}l&&clearTimeout(l),n.apply(this,o),t=s}}function bo(n,e={}){const t={},l=n.style??{},o=ul(l.fontFamily,l.enFontFamily);o&&(t.fontFamily=o);const s=Gl(l);return s&&Ye(t,s),l.fontSize&&(t.fontSize=l.fontSize),l.fontWeight&&(t.fontWeight=l.fontWeight),l.color&&(t.color=l.color),l.lineHeight&&(t.lineHeight=l.lineHeight),l.highlightColor&&(t["--quickprint-variable-highlight-color"]=l.highlightColor),l.backgroundColor&&(t.backgroundColor=l.backgroundColor),l.fontStyle&&(t.fontStyle=l.fontStyle),l.textIndent&&(t.textIndent=l.textIndent),l.writingMode&&(t.writingMode=l.writingMode),Nl("border",e)&&Ye(t,_n(n)),Ye(t,os(n)),Ye(t,ss(n)),Ye(t,is(n)),Nl("padding",e)&&Ye(t,rs(n)),t}function yo(n,e={}){const t=[];let l=n;for(;he.isDefineElement(l);)t.unshift(bo(l,e)),l=l.parent;return ls({},...t)}function Nl(n,e){return e.exclude==null?!0:!e.exclude.includes(n)}const Lt={SPACE:" ",has(n,e){return typeof n!="string"?!1:n.split(Lt.SPACE).includes(e)},push(n,e){if(typeof n!="string")return e;const t=n.split(Lt.SPACE).filter(o=>An(o));return t.indexOf(e)>=0?n:(t.push(e),t.join(Lt.SPACE))},remove(n,e){if(typeof n!="string"||n=="")return n;const t=n.split(Lt.SPACE),l=t.indexOf(e);return l<0?n:(t.splice(l,1),t.join(Lt.SPACE))}};function Et(n){switch(n){case"top":case 0:return{width:"borderTopWidth",color:"borderTopColor",style:"borderTopStyle"};case"right":case 1:return{width:"borderRightWidth",color:"borderRightColor",style:"borderRightStyle"};case"bottom":case 2:return{width:"borderBottomWidth",color:"borderBottomColor",style:"borderBottomStyle"};case"left":case 3:return{width:"borderLeftWidth",color:"borderLeftColor",style:"borderLeftStyle"}}}function gl(n,e){const t=n.ds;if(t!=null)return t.type===Te.FORMULA?{type:t.type,content:hl(t.value,n.doc)}:t.type===Te.VARIABLE?{type:t.type,content:at(t.value,e)}:{type:t.type,content:t.value}}function at(n,e){var g,y,_;if(me(n))return n;const t=Wl(n),l=t.path;if(l==null||l=="")return;const o=l.split(".");if(o.length==0)return l;const s=o[0];if(t.varType===Ot.BUILTIN)return((g=nl.find(c=>c.value===s))==null?void 0:g.label)??s;if(t.varType===Ot.SPECIAL)return((y=Vs.find(c=>c.value===s))==null?void 0:y.label)??s;if(e==null)return l;const i=(e.fields??[]).find(c=>c.name===s);if(i==null)return l;const a=o[1],d=me(i.title)?i.name:i.title;if(a==null)return d;const f=(_=i.children)==null?void 0:_.find(c=>c.name===a);if(f==null)return`${d}.${a}`;const h=me(f.title)?f.name:f.title;return`${d}.${h}`}function hl(n,e){return me(n)?void 0:Nn.tokenize(n).map(o=>o.type===dt.VARIABLE?`[${at(o.value,e==null?void 0:e.ds)}]`:o.type===dt.REFERENCE?`[${_o(o.value,e)}]`:o.type===dt.TEMPLATE?(Array.isArray(o.value)?o.value:[o.value]).map(r=>r.type===dt.VARIABLE?`[${at(r.value,e==null?void 0:e.ds)}]`:r.value).join(""):Nn.formatTokenValue(o)).join("")}function _o(n,e){if(e==null)return"="+n;const t=e.findElement(n);return t==null?"="+n:t.title?"="+t.title:t.ds.type===Te.VARIABLE&&t.ds.value?at(t.ds.value,e.ds):"="+n}function Zr(n){switch(Wl(n).dataType){case oe.OBJECT:return"对象";case oe.ARRAY:return"数组";case oe.STRING:return"文本";case oe.NUMBER:return"数字";case oe.DATE:return"日期";case oe.BOOLEAN:return"布尔";default:return"未知类型"}}function Kr(n){var e;return((e=so.find(t=>t.value===n))==null?void 0:e.label)??n}const Eo=Yl(()=>Xl(()=>import("./component-BzOvwT-C.js"),__vite__mapDeps([0,1]))),Jr=["onClick","onMouseenter"],Qr=F({__name:"Builtin",emits:["select"],setup(n,{emit:e}){const t=e,l=de(nl[0].value),o=L(()=>`builtin_${jl(l.value,"_").toLowerCase()}`);function s(i){t("select",i)}function r(i){l.value=i.value}return(i,a)=>(S(),I("div",{class:m(i.classes.builtin)},[u("div",{class:m(["quickprint-is-scrollable",i.classes.panel])},[(S(!0),I(ne,null,ae(b(nl),d=>(S(),I("div",{class:m({[i.classes.param]:!0,[i.classes.active]:d.value===l.value}),onClick:f=>s(d),onMouseenter:f=>r(d)},[u("strong",null,K(d.label),1),u("span",null,K(d.value),1)],42,Jr))),256))],2),u("div",{class:m(["quickprint-is-scrollable",i.classes.desc])},[p(b(Eo),{name:o.value},null,8,["name"])],2)],2))}}),ea="_builtin_m1n0z_2",ta="_panel_m1n0z_11",na="_desc_m1n0z_17",la="_param_m1n0z_24",oa="_active_m1n0z_34",sa={builtin:ea,panel:ta,desc:na,param:la,active:oa},ia={classes:sa},ra=H(Qr,[["__cssModules",ia]]),xl=[{label:"文本",value:oe.STRING},{label:"数字",value:oe.NUMBER},{label:"日期",value:oe.DATE},{label:"对象",value:oe.OBJECT},{label:"数组",value:oe.ARRAY}],aa=F({emit:["select"],props:{doc:{type:Ee,required:!0},readonly:{type:Boolean,default:!1}},setup(n,{expose:e,emit:t}){const l=Ne("classes"),o=Ze(),s=a(),r=i();function i(){const v=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:110,render(E,x,C){var O;if(n.readonly){const k=E[x.name],$=((O=xl.find(B=>B.value===k))==null?void 0:O.label)??k;return p("div",{class:C.classes.cell},[$])}return p("div",{class:C.classes.cell},[p(le,{options:xl,modelValue:E.type,"onUpdate:modelValue":y.bind(null,E),size:"small"},null)])}},{name:"name",title:"名称",width:180,render(E,x,C){return n.readonly?p("div",{class:C.classes.cell},[E[x.name]]):p("div",{class:C.classes.cell},[Se(p("input",{"onUpdate:modelValue":O=>E.name=O,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[必填] 请输入"},null),[[Ae,E.name]])])}},{name:"title",title:"标题",width:180,render(E,x,C){return n.readonly?p("div",{class:C.classes.cell},[E[x.name]]):p("div",{class:C.classes.cell},[Se(p("input",{"onUpdate:modelValue":O=>E.title=O,type:"text",class:"quickprint-form-control quickprint-form-control-small",placeholder:"[可选] 请输入"},null),[[Ae,E.title]])])}}];return n.readonly!==!0&&v.push({name:"operate",title:"操作",width:200,render(E,x,C){const O=[p("button",{type:"button",class:"quickprint-text-btn",onClick:f.bind(null,E,C.parent)},[p(U,{icon:"icon-subnode"},null),p("span",null,[ie("插入行")])])];return(E.type===oe.ARRAY||E.type===oe.OBJECT)&&O.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:g.bind(null,E)},[p(U,{icon:"icon-sisternode"},null),p("span",null,[ie("插入子级")])])),O.push(p("button",{type:"button",class:"quickprint-text-btn",onClick:h.bind(null,E,C.parent)},[p(U,{icon:"icon-delete"},null),p("span",null,[ie("删除")])])),O}}),v}function a(){const v=as(n.doc.ds.fields??[]).map(x=>{const C=x.type;return{...x,$expand:C===oe.ARRAY||C===oe.OBJECT}}),E=de(v);return E.value.length==0&&E.value.push(d()),E}function d(){return{type:oe.STRING,name:"",title:""}}function f(v,E){if(E){const C=E.children??[],O=C.indexOf(v);O>=0&&C.splice(O+1,0,d());return}const x=s.value.indexOf(v);x>=0&&s.value.splice(x+1,0,d())}function h(v,E){if(E){const C=E.children??[],O=C.indexOf(v);O>=0&&C.splice(O,1);return}const x=s.value.indexOf(v);x>=0&&s.value.splice(x,1),s.value.length==0&&s.value.push(d())}function g(v){v.type!==oe.ARRAY&&v.type!==oe.OBJECT||(v.children==null&&(v.children=[]),v.children.push(d()))}function y(v,E){v.type=E,E===oe.ARRAY||E===oe.OBJECT?v.$expand=!0:v.children=void 0}function _(){return{fields:s.value.map(E=>me(E.name)?null:E.type!==oe.ARRAY&&E.type!==oe.OBJECT?{type:E.type,name:E.name,title:E.title}:{type:E.type,name:E.name,title:E.title,children:(E.children??[]).map(x=>me(E.name)?null:{type:x.type,name:x.name,title:x.title}).filter(x=>x!=null)}).filter(E=>E!=null)}}function c(v,E){n.readonly===!0&&t("select",v,E)}return o==null||o.useHandle("confirm",_),e({submit:_}),function(){return p("div",{class:[l.datasource,n.readonly?l.readonly:l.form]},[p(cs,{columns:r,data:s.value,onSelect:c},null)])}}}),ca="_form_6lybl_2",ua="_readonly_6lybl_6",da="_datasource_6lybl_11",fa={form:ca,readonly:ua,datasource:da},pa={classes:fa},To=H(aa,[["__cssModules",pa]]),ma={class:"quickprint-config-group"},ga={class:"quickprint-config-section quickprint-config-inline"},ha={class:"quickprint-config-content"},va={class:"quickprint-config-section quickprint-config-inline"},ba={class:"quickprint-config-content"},ya={class:"quickprint-config-id"},_a={class:"quickprint-config-section quickprint-config-inline"},Ea={class:"quickprint-config-content"},Ta={class:"quickprint-config-group"},Sa={class:"quickprint-config-group-title"},Ra=F({__name:"Detail",props:{element:{type:he,required:!0}},setup(n){const e=n,t=L(()=>{var l,o;return(o=gl(e.element,(l=e.element.doc)==null?void 0:l.ds))==null?void 0:o.content});return(l,o)=>(S(),I("div",{class:m(l.classes.detail)},[u("div",ma,[u("section",ga,[o[0]||(o[0]=u("header",{class:"quickprint-config-header"},"类型",-1)),u("div",ha,K(b(dn)(n.element.type)),1)]),u("section",va,[o[1]||(o[1]=u("header",{class:"quickprint-config-header"},"标识",-1)),u("div",ba,[u("span",ya,K(n.element.id),1)])]),u("section",_a,[o[2]||(o[2]=u("header",{class:"quickprint-config-header"},"标题",-1)),u("div",Ea,K(n.element.title),1)])]),u("div",Ta,[u("div",Sa,[o[3]||(o[3]=u("span",null,"数据",-1)),u("span",{class:m(l.classes.type)},K(b(Kr)(n.element.ds.type)),3)]),u("div",null,K(t.value),1)])],2))}}),wa="_detail_11ox4_2",ka="_type_11ox4_10",La={detail:wa,type:ka},Ca={classes:La},Ia=H(Ra,[["__cssModules",Ca]]),Oa=F({__name:"index",props:{doc:{type:Ee,required:!0}},emits:["select"],setup(n,{emit:e}){const t=e,l=n,o=i(),s=de();function r(g){return g.reduce((y,_)=>{const c=Array.isArray(_.children)?r(_.children):[];if(An(_.ds.value)||c.length>0){const v={value:_.id,label:_.title??_.id,data:_,children:c};return y.push(v),y}return y},[])}function i(){const g=l.doc.pages.reduce((_,c)=>_.concat(c.children),[]),y=r(g);return de(y)}function a(g){s.value=g}function d(g){return g.title?g.title:dn(g.type)}function f(g){return Up(g.type)??"icon-zhanweifu"}function h(g){t("select",g.data)}return(g,y)=>(S(),I("div",{class:m(g.classes.reference)},[u("div",{class:m([g.classes.panel,"quickprint-is-scrollable"])},[p(b(qi),{data:b(o),onNodeHover:a,onNodeClick:h},{default:_e(({node:_})=>[p(b(U),{icon:f(_.data)},null,8,["icon"]),u("span",{class:m(g.classes.title)},K(d(_.data)),3),u("span",{class:m(g.classes.id)},"<"+K(_.value)+">",3)]),_:1},8,["data"])],2),u("div",{class:m([g.classes.detail,"quickprint-is-scrollable"])},[s.value?(S(),ee(Ia,{element:s.value.data,key:s.value.value},null,8,["element"])):Y("",!0)],2)],2))}}),Na="_reference_1ekkx_2",xa="_panel_1ekkx_12",Da="_detail_1ekkx_20",Ma="_title_1ekkx_25",Aa="_id_1ekkx_29",Ba={reference:Na,panel:xa,detail:Da,title:Ma,id:Aa},$a={classes:Ba},qa=H(Oa,[["__cssModules",$a]]),Pa=F({__name:"index",props:{doc:{type:Ee,required:!0},value:{type:String,default:null},include:{type:Array,default(){return["ds","builtin"]}},active:{type:String,default:null}},setup(n){const e=Ze();function t(r,i){return r==null?null:i==null?`${Ot.DS}.${r.type}.${r.name}`:`${Ot.DS}.${r.type}.${i.name}.${r.name}`}function l(r,i){e==null||e.confirm({type:"ds",value:t(r,i),parent:i})}function o(r){e==null||e.confirm({type:"builtin",value:`${Ot.BUILTIN}.${r.type}.${r.value}`})}function s(r){e==null||e.confirm({type:"reference",value:r.id})}return(r,i)=>(S(),I("div",{class:m(r.classes.var)},[n.active==="ds"?(S(),ee(To,{key:0,doc:n.doc,onSelect:l,readonly:""},null,8,["doc"])):Y("",!0),n.active==="builtin"?(S(),ee(ra,{key:1,onSelect:o})):Y("",!0),n.active==="reference"?(S(),ee(qa,{key:2,doc:n.doc,onSelect:s},null,8,["doc"])):Y("",!0)],2))}}),Va={var:"_var_12wxd_2"},Fa={classes:Va},So=H(Pa,[["__cssModules",Fa]]),za=["onClick","onMouseenter"],Ua=F({__name:"Document",props:{options:{type:Array,required:!0},type:{type:String,default:"function"}},emits:["select"],setup(n,{emit:e}){var a;const t=n,l=e,o=de((a=t.options[0])==null?void 0:a.value),s=L(()=>`${t.type}_${o.value.toLowerCase()}`);function r(d){l("select",d.value)}function i(d){o.value=d.value}return(d,f)=>(S(),I("div",{class:m(d.classes.doc)},[u("div",{class:m(["quickprint-is-scrollable",d.classes.panel])},[(S(!0),I(ne,null,ae(n.options,h=>(S(),I("div",{key:h.value,class:m({[d.classes.option]:!0,[d.classes.active]:h.value===o.value}),onClick:g=>r(h),onMouseenter:g=>i(h)},[u("strong",null,K(h.label),1)],42,za))),128))],2),u("div",{class:m(["quickprint-is-scrollable",d.classes.desc])},[p(b(Eo),{name:s.value},null,8,["name"])],2)],2))}}),Ha="_doc_1pdoc_2",Ga="_panel_1pdoc_10",Wa="_desc_1pdoc_16",Ya="_option_1pdoc_23",Xa="_active_1pdoc_33",ja={doc:Ha,panel:Ga,desc:Wa,option:Ya,active:Xa},Za={classes:ja},tn=H(Ua,[["__cssModules",Za]]),Ka=F({__name:"index",props:{active:{type:String,default:null}},setup(n){const e=Ze(),t=[{label:"STRING",value:"STRING"},{label:"LENGTH",value:"LENGTH"},{label:"LOWER",value:"LOWER"},{label:"UPPER",value:"UPPER"},{label:"UPPER_FIRST",value:"UPPER_FIRST"},{label:"TRIM",value:"TRIM"},{label:"REPLACE",value:"REPLACE"},{label:"REPLACE_ALL",value:"REPLACE_ALL"},{label:"SLICE",value:"SLICE"},{label:"INCLUDES",value:"INCLUDES"},{label:"INDEX_OF",value:"INDEX_OF"},{label:"LAST_INDEX_OF",value:"LAST_INDEX_OF"},{label:"STARTS_WITH",value:"STARTS_WITH"},{label:"ENDS_WITH",value:"ENDS_WITH"}],l=[{label:"NUMBER",value:"NUMBER"},{label:"ABS",value:"ABS"},{label:"TRUNC",value:"TRUNC"},{label:"MIN",value:"MIN"},{label:"MAX",value:"MAX"},{label:"CEIL",value:"CEIL"},{label:"FLOOR",value:"FLOOR"},{label:"ROUND",value:"ROUND"},{label:"DIGIT",value:"DIGIT"},{label:"NUMBER_FORMAT",value:"NUMBER_FORMAT"}],o=[{label:"IF",value:"IF"},{label:"IFNA",value:"IFNA"},{label:"IFERROR",value:"IFERROR"},{label:"SWITCH",value:"SWITCH"},{label:"IS_NAN",value:"IS_NAN"},{label:"IS_NUMBER",value:"IS_NUMBER"},{label:"IS_INTEGER",value:"IS_INTEGER"},{label:"IS_STRING",value:"IS_STRING"},{label:"IS_BOOLEAN",value:"IS_BOOLEAN"},{label:"IS_NULL",value:"IS_NULL"},{label:"IS_UNDEFINED",value:"IS_UNDEFINED"},{label:"IS_NULLISH",value:"IS_NULLISH"},{label:"IS_EMPTY",value:"IS_EMPTY"}],s=[{label:"DATE",value:"DATE"},{label:"NOW",value:"NOW"},{label:"YEAR",value:"YEAR"},{label:"MONTH",value:"MONTH"},{label:"DAY",value:"DAY"},{label:"HOUR",value:"HOUR"},{label:"MINUTE",value:"MINUTE"},{label:"SECOND",value:"SECOND"}],r=[{label:"COL_SUM",value:"COL_SUM"},{label:"COL_AVG",value:"COL_AVG"}];function i(a){return e==null?void 0:e.confirm({type:"function",value:`${a}()`})}return(a,d)=>(S(),I("div",{class:m(a.classes.function)},[n.active==="string"?(S(),ee(tn,{options:t,onSelect:i,key:"string"})):Y("",!0),n.active==="number"?(S(),ee(tn,{options:l,onSelect:i,key:"number"})):Y("",!0),n.active==="logical"?(S(),ee(tn,{options:o,onSelect:i,key:"logical"})):Y("",!0),n.active==="date"?(S(),ee(tn,{options:s,onSelect:i,key:"date"})):Y("",!0),n.active==="aggregate"?(S(),ee(tn,{options:r,onSelect:i,key:"aggregate"})):Y("",!0)],2))}}),Ja={function:"_function_19szx_2"},Qa={classes:Ja},ec=H(Ka,[["__cssModules",Qa]]),tc=["onMouseenter"],nc=["onClick"],lc={key:1},oc=F({__name:"Formula",props:{doc:{type:Ee,default:null}},setup(n){const e=n,t=Ze(),l=[{id:"pageNumber",name:"页码",options:a(Gs)}],o=de(l[0]);function s(d){o.value=d}function r(d){return t==null?void 0:t.confirm({type:"formula",value:d})}function i(d){const f=Nn.tokenize(d),h=e.doc;return f.reduce((g,y)=>{if(y.type===dt.VARIABLE)return g.push({type:"highlight",value:at(y.value,h==null?void 0:h.ds)}),g;if(y.type===dt.REFERENCE)return g.push({type:"highlight",value:_o(y.value,h)}),g;if(y.type===dt.TEMPLATE){const c=(Array.isArray(y.value)?y.value:[y.value]).map(v=>v.type===dt.VARIABLE?{type:"highlight",value:at(v.value,h.ds)}:{type:"text",value:v.value});return g.concat(c)}return g.push({type:"text",value:Nn.formatTokenValue(y)}),g},[])}function a(d){return d.map(f=>({nodes:i(f),value:f}))}return(d,f)=>(S(),I("div",{class:m(d.classes.formula)},[u("div",{class:m([d.classes.left,"quickprint-is-scrollable"])},[(S(),I(ne,null,ae(l,h=>u("div",{key:h.name,onMouseenter:g=>s(h),class:m({[d.classes.group]:!0,[d.classes.active]:h.id===o.value.id})},K(h.name),43,tc)),64))],2),u("div",{class:m(d.classes.right)},[(S(!0),I(ne,null,ae(o.value.options,(h,g)=>(S(),I("div",{key:g,class:m(d.classes.code),onClick:y=>r(h.value)},[(S(!0),I(ne,null,ae(h.nodes,y=>(S(),I(ne,null,[y.type==="highlight"?(S(),I("span",{key:0,class:m(d.classes.highlight)},"["+K(y.value)+"]",3)):(S(),I("span",lc,K(y.value),1))],64))),256)),u("span",{class:m(d.classes.badge)},"插入",2)],10,nc))),128))],2)],2))}}),sc="_formula_ms7c3_2",ic="_left_ms7c3_12",rc="_right_ms7c3_17",ac="_group_ms7c3_24",cc="_active_ms7c3_34",uc="_highlight_ms7c3_39",dc="_code_ms7c3_43",fc="_badge_ms7c3_65",pc={formula:sc,left:ic,right:rc,group:ac,active:cc,highlight:uc,code:dc,badge:fc},mc={classes:pc},gc=H(oc,[["__cssModules",mc]]),vl=ke(function(n){return vt("变量",(e,t)=>p(So,{doc:n.doc,value:n.value,active:t},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Le)}),hc=ke(function(n){return Xe("数据源",p(To,{doc:n},null),{preset:"variable",icon:p(U,{icon:"icon-datasource",class:"quickprint-ds-icon",size:"16px"},null),menus:[{label:"保存",handler:e=>e.dispatchConfirm()}]}).promisify().catch(Le)}),vc=ke(function(n){const e=["ds","builtin","reference"];return vt("变量",(t,l)=>p(So,{doc:n.doc,value:n.value,include:e,active:l},null),{preset:"variable",icon:"svg:icon-var",tabs:[{label:"数据源",name:"ds",active:!0},{label:"内置变量",name:"builtin"},{label:"引用组件",name:"reference"}]}).promisify().catch(Le)}),bc=ke(function(){return vt("函数",(n,e)=>p(ec,{active:e},null),{preset:"variable",icon:"svg:icon-function",tabs:[{label:"文本",name:"string",active:!0},{label:"数字",name:"number"},{label:"日期",name:"date"},{label:"逻辑",name:"logical"},{label:"聚合",name:"aggregate"}]}).promisify().catch(Le)}),yc=ke(function(n){return Xe("公式",p(gc,{doc:n.doc},null),{preset:"variable"}).promisify().catch(Le)}),_c={key:1},Ec=F({__name:"Content",props:{element:{type:he,required:!0}},setup(n){const e=n,t=Ce(),l=Zt("editorRef"),o=Zt("contentRef"),s=de(!1),r=L(()=>{const f=e.element.type===j.TABLE_CELL?yo(e.element,{exclude:["border"]}):bo(e.element);return f.color&&(f["--quickprint-element-var-color"]=f.color),s.value&&(f.alignItems="flex-start"),f}),i=L(()=>{const f=gl(e.element,t.doc.ds);return f==null||f.content==null?null:[{tag:"span",content:e.element.attributes.prefix},{tag:f.type===Te.CONST?"span":"strong",content:f.content},{tag:"span",content:e.element.attributes.suffix}]});async function a(){var y;const f=await vl({doc:t.doc,value:e.element.ds.value}).catch(lt);if(f==null||(e.element.setDataSource(Te.VARIABLE,f.value),e.element.type!=j.TABLE_CELL||f.type!=="ds"))return;const h=e.element.parent;if(h==null||h.isBindVariable||((y=f.parent)==null?void 0:y.type)!==oe.ARRAY)return;const g=f.parent;h.setDataSource(Te.VARIABLE,`${Ot.DS}.${g.type}.${g.name}`)}function d(){const f=l.value,h=o.value;f==null||h==null||(s.value=h.offsetHeight>f.offsetHeight)}return(f,h)=>(S(),I("div",{class:"quickprint-is-element-editor",style:Z(r.value),onVnodeMounted:d,ref_key:"editorRef",ref:l},[u("div",{class:"quickprint-is-content",ref_key:"contentRef",ref:o},[u("span",{class:m({[f.classes.lineThrough]:n.element.style.lineThrough})},[(S(!0),I(ne,null,ae(i.value,(g,y)=>(S(),I(ne,{key:y},[g.tag=="strong"?(S(),I("strong",{key:0,class:m(f.classes.highlight)},"["+K(g.content)+"]",3)):(S(),I("span",_c,K(g.content),1))],64))),128))],2)],512),n.element.isBindVariable||n.element.isBindTemplate?(S(),ee(b(U),{key:0,icon:"icon-ds",size:"11px",color:"#da7f00",class:m(f.classes.dsIcon),onClick:a,onPointerdown:h[0]||(h[0]=se(()=>{},["stop"]))},null,8,["class"])):Y("",!0)],4))}}),Tc="_dsIcon_1d2si_2",Sc="_lineThrough_1d2si_11",Rc="_highlight_1d2si_15",wc={dsIcon:Tc,lineThrough:Sc,highlight:Rc},kc={classes:wc},Vn=H(Ec,[["__cssModules",kc]]),Lc=F({__name:"TextEditor",props:{element:{type:us,required:!0}},setup(n){return(e,t)=>(S(),ee(Vn,{element:n.element},null,8,["element"]))}}),Fn=Object.freeze({title:"文本",icon:"icon-text",type:j.TEXT,editor:Lc,onCreate(){return he.create({type:j.TEXT,width:Nt,height:qn})}}),Cc=F({__name:"NumberEditor",props:{element:{type:ds,required:!0}},setup(n){return(e,t)=>(S(),ee(Vn,{element:n.element},null,8,["element"]))}}),Ic=["value","disabled"],Oc=F({__name:"RadioButton",props:Dt({modelValue:{},options:{type:Array,default(){return[]}},compacted:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=fn(n,"modelValue");return(t,l)=>(S(),I("div",{class:m({[t.classes.radioGroup]:!0,[t.classes.compacted]:n.compacted,[t.classes.disabled]:n.disabled})},[(S(!0),I(ne,null,ae(n.options,o=>(S(),I("label",{class:m({[t.classes.radio]:!0,[t.classes.selected]:o.value===n.modelValue})},[Se(u("input",{type:"radio",value:o.value,"onUpdate:modelValue":l[0]||(l[0]=s=>e.value=s),disabled:n.disabled},null,8,Ic),[[Os,e.value]]),u("span",null,K(o.label),1)],2))),256))],2))}}),Nc="_radioGroup_67myk_2",xc="_compacted_67myk_10",Dc="_radio_67myk_2",Mc="_selected_67myk_50",Ac="_disabled_67myk_56",Bc={radioGroup:Nc,compacted:xc,radio:Dc,selected:Mc,disabled:Ac},$c={classes:Bc},Pt=H(Oc,[["__cssModules",$c]]),qc={class:"quickprint-config-section quickprint-config-inline"},Pc={class:"quickprint-config-content"},Vc={class:"quickprint-config-section quickprint-config-inline"},Fc={class:"quickprint-config-content"},zc={class:"quickprint-config-section quickprint-config-inline"},Uc={class:"quickprint-config-content"},Hc={class:"quickprint-config-section quickprint-config-inline"},Gc={class:"quickprint-config-content"},Wc=F({__name:"NumberConfig",props:{element:{type:he,required:!0}},setup(n){const e=n,t=L({get(){return e.element.attributes.showZero??!0},set(s){const r=e.element.attributes;r.showZero=s}}),l=L({get(){return e.element.attributes.round??on.ROUND},set(s){const r=e.element.attributes;r.round=s}}),o=L({get(){return e.element.attributes.format??St.NONE},set(s){const r=e.element.attributes;r.format=s}});return(s,r)=>(S(),I(ne,null,[u("section",qc,[r[4]||(r[4]=u("header",{class:"quickprint-config-header"},"小数位数",-1)),u("div",Pc,[Se(u("input",{"onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.precision=i),type:"number",step:"1",min:0,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ae,n.element.attributes.precision]])])]),u("section",Vc,[r[5]||(r[5]=u("header",{class:"quickprint-config-header"},"舍入规则",-1)),u("div",Fc,[p(b(le),{options:b(Bs),modelValue:l.value,"onUpdate:modelValue":r[1]||(r[1]=i=>l.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",zc,[r[6]||(r[6]=u("header",{class:"quickprint-config-header"},"显示类型",-1)),u("div",Uc,[p(b(le),{options:b($s),modelValue:o.value,"onUpdate:modelValue":r[2]||(r[2]=i=>o.value=i),class:"quickprint-w-full"},null,8,["options","modelValue"])])]),u("section",Hc,[r[7]||(r[7]=u("header",{class:"quickprint-config-header"},"值为0时",-1)),u("div",Gc,[p(Pt,{modelValue:t.value,"onUpdate:modelValue":r[3]||(r[3]=i=>t.value=i),options:b(qs),class:"quickprint-w-full"},null,8,["modelValue","options"])])])],64))}}),zn=Object.freeze({title:"数字",type:j.NUMBER,icon:"icon-number",editor:Cc,config:{display:Wc},onCreate(){return he.create({type:j.NUMBER,width:Nt,height:qn})}}),Yc=F({__name:"DateEditor",props:{element:{type:fs,required:!0}},setup(n){return(e,t)=>(S(),ee(Vn,{element:n.element},null,8,["element"]))}}),Xc={class:"quickprint-config-section"},jc={class:"quickprint-config-content"},Zc=F({__name:"DateConfig",props:{element:{type:he,required:!0}},setup(n){const e=n,t={NONE:"NONE"},l=L(()=>[{label:"原始值",value:t.NONE},...io]);function o(s){if(s.value==t.NONE){e.element.attributes.format=void 0;return}e.element.attributes.format=s.value}return(s,r)=>(S(),I("section",Xc,[u("header",{class:m(["quickprint-config-header",s.classes.header])},[r[1]||(r[1]=u("span",null,"格式",-1)),p(b(le),{options:l.value,onSelect:o,class:m(s.classes.picker),appearance:"none",size:"mini",border:"none",popoverWidth:200},{selected:_e(()=>[u("span",{class:m(s.classes.placeholder)},"预设模板",2)]),_:1},8,["options","class"])],2),u("div",jc,[Se(u("input",{type:"text","onUpdate:modelValue":r[0]||(r[0]=i=>n.element.attributes.format=i),class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null,512),[[Ae,n.element.attributes.format]])])]))}}),Kc="_header_79607_2",Jc="_picker_79607_8",Qc="_placeholder_79607_15",eu={header:Kc,picker:Jc,placeholder:Qc},tu={classes:eu},nu=H(Zc,[["__cssModules",tu]]),Un=Object.freeze({title:"日期",type:j.DATE,icon:"icon-date",editor:Yc,config:{display:nu},onCreate(){return he.create({type:j.DATE,width:Nt,height:qn})}}),lu=["x1","y1","x2","y2"],ou=F({__name:"Diagonal",props:{mode:{type:Number,default:0},labels:{type:Array,default:null},width:{type:Number,default:null},height:{type:Number,default:null}},setup(n){const e=Ne("classes"),t=n,l=L(()=>t.mode===Ie.TL_BR?{x1:"0",y1:"0",x2:"100%",y2:"100%"}:t.mode===Ie.TR_BL?{x1:"100%",y1:"0",x2:"0",y2:"100%"}:null),o=L(()=>({[e.biagonal]:!0,[e.tlbr]:t.mode===Ie.TL_BR,[e.trbl]:t.mode===Ie.TR_BL})),s=L(()=>({width:t.width?`${t.width}px`:"100%",height:t.height?`${t.height}px`:"100%"})),r=L(()=>{var a,d;return(d=(a=t.labels)==null?void 0:a[0])==null?void 0:d.text}),i=L(()=>{var a,d;return(d=(a=t.labels)==null?void 0:a[1])==null?void 0:d.text});return(a,d)=>(S(),I("div",{class:m(o.value),style:Z(s.value)},[l.value?(S(),I("svg",{key:0,class:m(b(e).line)},[u("line",{x1:l.value.x1,y1:l.value.y1,x2:l.value.x2,y2:l.value.y2},null,8,lu)],2)):Y("",!0),r.value?(S(),I("div",{key:1,class:m(b(e).firstLabel)},K(r.value),3)):Y("",!0),i.value?(S(),I("div",{key:2,class:m(b(e).secondLabel)},K(i.value),3)):Y("",!0)],6))}}),su="_biagonal_17a80_2",iu="_firstLabel_17a80_9",ru="_secondLabel_17a80_10",au="_tlbr_17a80_15",cu="_trbl_17a80_26",uu="_line_17a80_37",du={biagonal:su,firstLabel:iu,secondLabel:ru,tlbr:au,trbl:cu,line:uu},fu={classes:du},ol=H(ou,[["__cssModules",fu]]),pu=["colspan","rowspan"],mu=F({__name:"TableCellEditor",props:{element:{type:xn,required:!0}},setup(n){const e=n,t=L(()=>e.element.isCollapsed),l=L(()=>{const g=e.element.attributes.diagonalMode;return g==null?!1:g!==Ie.NONE}),o=Ce(),s=Ne("classes"),r=L(()=>{const g=e.element,y=g.parent;return{[s.cell]:!0,[J.SELECTED]:(y==null?void 0:y.isSelected)||g.isSelected}}),i=L(()=>{var c;const g=_n((c=e.element.parent)==null?void 0:c.parent),y=_n(e.element.parent),_=_n(e.element);return{...f(e.element),...h(e.element),...Ye(Ye(g,y),_)}}),a=L(()=>{const g=yo(e.element,{exclude:["border","padding"]});return g.color&&(g["--quickprint-element-var-color"]=g.color),g});function d(g){g.button==0&&(g.ctrlKey?o.toggleMultiSelectedElement(e.element):o.selectElement(e.element))}function f(g){const y=g.findPrevDisplayedCell(),_=g.findNextDisplayedCell(),c=g.table,v=ce(g,"left")??ce(g.parent,"left")??ce(c,"left"),E=ce(y,"right")??ce(y==null?void 0:y.parent,"right")??ce(c,"right"),x=ce(g,"right")??ce(g.parent,"right")??ce(c,"right"),C=ce(_,"left")??ce(_==null?void 0:_.parent,"left")??ce(c,"left"),O=Math.max(et.processLengthToPX(v)??0,et.processLengthToPX(E)??0),k=Math.max(et.processLengthToPX(x)??0,et.processLengthToPX(C)??0);return{"--quickprint-cell-width":e.element.offsetWidth+"px","--quickprint-cell-border-left-width":O+"px","--quickprint-cell-border-right-width":k+"px"}}function h(g){var B,q;const y=g.index,_=g.table,c=(B=g.findPrevDisplayedRow())==null?void 0:B.children[y],v=(q=g.findNextDisplayedRow())==null?void 0:q.children[y],E=ce(g,"top")??ce(g.parent,"top")??ce(_,"top"),x=ce(c,"bottom")??ce(c==null?void 0:c.parent,"bottom")??ce(_,"bottom"),C=ce(g,"bottom")??ce(g.parent,"bottom")??ce(_,"bottom"),O=ce(v,"top")??ce(v==null?void 0:v.parent,"top")??ce(_,"top"),k=Math.max(et.processLengthToPX(E)??0,et.processLengthToPX(x)??0),$=Math.max(et.processLengthToPX(C)??0,et.processLengthToPX(O)??0);return{"--quickprint-cell-height":g.offsetHeight+"px","--quickprint-cell-border-top-width":k+"px","--quickprint-cell-border-bottom-width":$+"px"}}return(g,y)=>t.value?Y("",!0):(S(),I("td",to({key:0,[`.${b(je)||""}`]:n.element,class:r.value,style:i.value,colspan:n.element.attributes.colspan,rowspan:n.element.attributes.rowspan,onClick:se(d,["stop"])}),[l.value?(S(),ee(ol,{key:0,mode:n.element.attributes.diagonalMode,labels:n.element.attributes.diagonalLabels,width:n.element.offsetWidth,height:n.element.offsetHeight,style:Z(a.value)},null,8,["mode","labels","width","height","style"])):(S(),ee(Vn,{key:1,element:n.element,class:m(b(s).content)},null,8,["element","class"]))],48,pu))}}),gu="_cell_10c6k_2",hu="_content_10c6k_32",vu={cell:gu,content:hu},bu={classes:vu},Ro=H(mu,[["__cssModules",bu]]);function bl(n,e){return{type:"menu",label:"层级",icon:"icon-cengji",submenu:[{type:"menu",icon:"icon-vertical-align-top",label:"移至顶层",handler(){const t=e.page;if(t==null)return;const l=t.topZIndex;e.setZIndex(l+1),n.createSnapshot()}},{type:"menu",label:"上移一层",icon:"icon-arrowup",handler(){const t=e.zIndex;e.setZIndex(t+1),n.createSnapshot()}},{type:"menu",icon:"icon-arrowdown",label:"下移一层",handler(){const t=e.zIndex;t<=0||(e.setZIndex(t-1),n.createSnapshot())}},{type:"menu",icon:"icon-vertical-align-bottom",label:"移至底层",handler(){e.setZIndex(0),n.createSnapshot()}}]}}const yu=[{label:"微软雅黑",value:"Microsoft YaHei"},{label:"宋体",value:re.SONG},{label:"黑体",value:"黑体"},{label:"仿宋",value:"仿宋"},{label:"楷体",value:"楷体"}],wo=[{label:"Arial",value:"Arial"},{label:"Consolas",value:"Consolas"},{label:"Times",value:"Times"},{label:"Times New Roman",value:"Times New Roman"}],ko=[{label:"默认",value:re.DEFAULT},...wo],Hn=[{label:"默认",value:re.DEFAULT},...yu,...wo],yl=[{label:"默认",value:Re.DEFAULT},{label:"初号",value:Re.SIZE_0+"pt",short:"56px"},{label:"小初",value:Re.SIZE_0_S+"pt",short:"≈49.33px"},{label:"一号",value:Re.SIZE_1+"pt",short:"≈34.67px"},{label:"小一",value:Re.SIZE_1_S+"pt",short:"32px"},{label:"二号",value:Re.SIZE_2+"pt",short:"≈29.33px"},{label:"小二",value:Re.SIZE_2_S+"pt",short:"24px"},{label:"三号",value:Re.SIZE_3+"pt",short:"≈21.33px"},{label:"小三",value:Re.SIZE_3_S+"pt",short:"20px"},{label:"四号",value:Re.SIZE_4+"pt",short:"≈18.67px"},{label:"小四",value:Re.SIZE_4_S+"pt",short:"16px"},{label:"五号",value:Re.SIZE_5+"pt",short:"14px"},{label:"小五",value:Re.SIZE_5_S+"pt",short:"12px"},{label:"12px",value:"12px"},{label:"13px",value:"13px"},{label:"14px",value:"14px"},{label:"15px",value:"15px"},{label:"16px",value:"16px"},{label:"18px",value:"18px"},{label:"20px",value:"20px"},{label:"22px",value:"22px"},{label:"24px",value:"24px"},{label:"28px",value:"28px"},{label:"32px",value:"32px"},{label:"36px",value:"36px"},{label:"42px",value:"42px"},{label:"48px",value:"48px"},{label:"56px",value:"56px"},{label:"72px",value:"72px"}],Lo=[{label:"默认",value:Rt.DEFAULT},{label:"1.0",value:Rt.TIMES_1,short:"单倍行距"},{label:"1.1",value:Rt.TIMES_1_1},{label:"1.5",value:Rt.TIMES_1_5},{label:"2.0",value:Rt.TIMES_2,short:"两倍行距"}],_u=[{label:"无",value:En.NONE},{label:"实线",value:Bt.SOLID},{label:"虚线",value:Bt.DASHED},{label:"点划线",value:Bt.DOTTED},{label:"双实线",value:Bt.DOUBLE},{label:"波浪线",value:Bt.WAVY}],Eu=[{label:"无",value:Q.NONE},{label:"实线",value:Q.SOLID},{label:"虚线",value:Q.DASHED},{label:"点划线",value:Q.DOTTED},{label:"双实线",value:Q.DOUBLE}],Tu=[{label:"默认",value:wt.AUTO},{label:"左对齐",value:wt.LEFT},{label:"居中对齐",value:wt.CENTER},{label:"右对齐",value:wt.RIGHT},{label:"两端对齐",value:wt.JUSTIFY}],sl=[{label:"顶部对齐",value:ot.TOP,icon:"icon-vertical-align-top"},{label:"垂直居中",value:ot.MIDDLE,icon:"icon-vertical-align-middl"},{label:"底部对齐",value:ot.BOTTOM,icon:"icon-vertical-align-bottom"}],il=[{label:"左对齐",value:ft.LEFT,icon:"icon-align-left"},{label:"居中对齐",value:ft.CENTER,icon:"icon-align-center"},{label:"右对齐",value:ft.RIGHT,icon:"icon-align-right"},{label:"两端对齐",value:ft.JUSTIFY,icon:"icon-menu"}],Su={class:"quickprint-is-row"},Ru=["onClick"],wu=F({__name:"FontSize",props:{modelValue:{type:String,default:null},height:{type:String,default:"100%"}},emits:["update:modelValue","update:unit"],setup(n,{emit:e}){const t=[{value:"px",label:"像素"},{value:"pt",label:"磅"}],l=Ne("classes"),o=e,s=n,r=ge(),i=L(()=>({height:s.height})),a=L({get(){return pt(s.modelValue).num??void 0},set(_){if(_==""||ps(_)||_<0){h(void 0);return}const c=pt(s.modelValue);h(`${_}${c.unit}`)}}),d=L({get(){return pt(s.modelValue).unit??pe.PX},set(_){const c=pt(s.modelValue);h(`${c.num}${_}`)}});function f(_){const c=_===Re.DEFAULT?void 0:_;o("update:modelValue",c)}function h(_){o("update:modelValue",_),y()}function g(_){const c=s.modelValue;return c==null&&_.value===Re.DEFAULT?!0:c===_.value}async function y(){await jt();const _=document.querySelector("."+l.fontSelected);_&&_.scrollIntoView({block:"nearest"})}return(_,c)=>(S(),I("div",{class:m(b(l).fontSize),style:Z(i.value)},[u("div",Su,[Se(u("input",{type:"number",step:"any",placeholder:"请输入",class:m(["quickprint-form-control",b(l).input]),min:0,"onUpdate:modelValue":c[0]||(c[0]=v=>a.value=v)},null,2),[[Ae,a.value]]),p(b(le),{width:"54px",options:t,modelValue:d.value,"onUpdate:modelValue":c[1]||(c[1]=v=>d.value=v)},null,8,["modelValue"])]),u("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(l).fonts]),ref_key:"scrollRef",ref:r},[(S(!0),I(ne,null,ae(b(yl),v=>(S(),I("div",{key:v.value,class:m({[b(l).option]:!0,[b(l).fontSelected]:g(v)}),onClick:E=>f(v.value)},[u("span",null,K(v.label),1)],10,Ru))),128))],2)],6))}}),ku="_input_9oh9n_2",Lu="_fontSize_9oh9n_8",Cu="_fonts_9oh9n_13",Iu="_option_9oh9n_25",Ou="_fontSelected_9oh9n_34",Nu={input:ku,fontSize:Lu,fonts:Cu,option:Iu,fontSelected:Ou},xu={classes:Nu},Co=H(wu,[["__cssModules",xu]]),Du=["title"],Mu={key:0},Au="中文字体 AbBbCc",Bu=F({__name:"Font",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=L(()=>Hn.map(c=>(c.style={fontFamily:c.value==re.DEFAULT?re.SONG:c.value},c))),l=L(()=>ko.map(c=>(c.style={fontFamily:c.value==re.DEFAULT?re.SONG:c.value},c))),o=L({get(){const c=e.options.style.fontFamily;return me(c)?re.DEFAULT:c},set(c){e.options.style.fontFamily=c==re.DEFAULT?void 0:c}}),s=L({get(){const c=e.options.style.enFontFamily;return me(c)?re.DEFAULT:c},set(c){e.options.style.enFontFamily=c==re.DEFAULT?void 0:c}}),r=L({get(){const c=e.options.style.color;return me(c)?qe.INHERIT:c},set(c){e.options.style.color=c==qe.INHERIT?void 0:c}}),i=L({get(){const c=e.options.style.highlightColor;return me(c)?qe.INHERIT:c},set(c){e.options.style.highlightColor=c==qe.INHERIT?void 0:c}}),a=L({get(){return e.options.style.fontSize},set(c){const v=me(c)?void 0:c;e.options.style.fontSize=v}}),d=L({get(){return e.options.style.fontWeight===700},set(c){e.options.style.fontWeight=c?700:void 0}}),f=L({get(){return e.options.style.fontStyle==="italic"},set(c){e.options.style.fontStyle=c?"italic":void 0}}),h=L({get(){return e.options.style.lineThrough===!0},set(c){e.options.style.lineThrough=c?!0:void 0}}),g=L({get(){const c=e.options.style.underline;if(c==null||c===!1)return En.NONE;const v=e.options.style.underlineStyle;return me(v)?Bt.SOLID:v},set(c){if(c===En.NONE){e.options.style.underline=void 0,e.options.style.underlineStyle=void 0;return}e.options.style.underline=!0,e.options.style.underlineStyle=c}}),y=L({get(){const c=e.options.style.underlineColor;return me(c)?qe.INHERIT:c},set(c){e.options.style.underlineColor=c==qe.INHERIT?void 0:c}}),_=L(()=>{const c=e.options.style,v={},E=ul(c.fontFamily,c.enFontFamily);E&&(v.fontFamily=E);const x=Gl(c);return x&&Ye(v,x),c.fontSize&&(v.fontSize=c.fontSize),c.fontWeight&&(v.fontWeight=c.fontWeight),c.color&&(v.color=c.color),c.fontStyle&&(v.fontStyle=c.fontStyle),c.highlightColor&&(v["--quickprint-variable-highlight-color"]=c.highlightColor),v});return(c,v)=>(S(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",c.classes.font])},[u("div",{class:m(c.classes.fontFamily)},[u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"中文字体",2),u("div",{class:m(c.classes.content)},[p(b(le),{options:t.value,modelValue:o.value,"onUpdate:modelValue":v[0]||(v[0]=E=>o.value=E)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"颜色",2),p(b(Rn),{modelValue:r.value,"onUpdate:modelValue":v[1]||(v[1]=E=>r.value=E)},null,8,["modelValue"])],2),u("div",{class:m([c.classes.config,c.classes.fontSize])},[u("div",{class:m(c.classes.title)},"字号",2),p(Co,{modelValue:a.value,"onUpdate:modelValue":v[2]||(v[2]=E=>a.value=E),height:"144px"},null,8,["modelValue"])],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"西文字体",2),u("div",{class:m(c.classes.content)},[p(b(le),{options:l.value,modelValue:s.value,"onUpdate:modelValue":v[3]||(v[3]=E=>s.value=E)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"前景色",2),p(b(Rn),{modelValue:i.value,"onUpdate:modelValue":v[4]||(v[4]=E=>i.value=E)},null,8,["modelValue"])],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"下划线",2),u("div",{class:m(c.classes.content)},[p(b(le),{modelValue:g.value,"onUpdate:modelValue":v[5]||(v[5]=E=>g.value=E),options:b(_u),width:"138px"},{option:_e(({option:E})=>[u("div",{title:E.label,class:m(c.classes.option)},[E.value==b(En).NONE?(S(),I("div",Mu,K(E.label),1)):(S(),I("div",{key:1,class:m(c.classes.line),style:Z({textDecorationStyle:E.value})},"--",6))],10,Du)]),_:1},8,["modelValue","options"])],2)],2),u("div",{class:m(c.classes.config)},[u("div",{class:m(c.classes.title)},"线条颜色",2),u("div",{class:m(c.classes.content)},[p(b(Rn),{modelValue:y.value,"onUpdate:modelValue":v[6]||(v[6]=E=>y.value=E),class:"quickprint-w-full"},null,8,["modelValue"])],2)],2)],2),u("div",{class:m(c.classes.fieldset)},[v[13]||(v[13]=u("header",null,"效果",-1)),u("div",{class:m(c.classes.configs)},[u("label",{class:m(c.classes.checkbox)},[Se(u("input",{type:"checkbox","onUpdate:modelValue":v[7]||(v[7]=E=>d.value=E)},null,512),[[Qn,d.value]]),v[10]||(v[10]=u("span",null,"粗体",-1))],2),u("label",{class:m(c.classes.checkbox)},[Se(u("input",{type:"checkbox","onUpdate:modelValue":v[8]||(v[8]=E=>f.value=E)},null,512),[[Qn,f.value]]),v[11]||(v[11]=u("span",null,"斜体",-1))],2),u("label",{class:m(c.classes.checkbox)},[Se(u("input",{type:"checkbox","onUpdate:modelValue":v[9]||(v[9]=E=>h.value=E)},null,512),[[Qn,h.value]]),v[12]||(v[12]=u("span",null,"删除线",-1))],2)],2)],2),u("div",{class:m(c.classes.fieldset)},[v[14]||(v[14]=u("header",null,"预览",-1)),u("div",{class:m(c.classes.preview)},[u("span",{style:Z(_.value)},[u("span",{class:m({[c.classes.lineThrough]:n.options.style.lineThrough})},K(Au),2)],4)],2)],2)],2))}}),$u="_grid2_7i8m3_1",qu="_item_7i8m3_1",Pu="_itemLabel_7i8m3_1",Vu="_fieldset_7i8m3_1",Fu="_font_7i8m3_4",zu="_fontFamily_7i8m3_9",Uu="_config_7i8m3_16",Hu="_fontSize_7i8m3_21",Gu="_title_7i8m3_25",Wu="_configs_7i8m3_30",Yu="_checkbox_7i8m3_36",Xu="_option_7i8m3_51",ju="_line_7i8m3_59",Zu="_preview_7i8m3_70",Ku="_lineThrough_7i8m3_85",Ju={grid2:$u,item:qu,itemLabel:Pu,fieldset:Vu,font:Fu,fontFamily:zu,config:Uu,fontSize:Hu,title:Gu,configs:Wu,checkbox:Yu,option:Xu,line:ju,preview:Zu,lineThrough:Ku},Qu={classes:Ju},ed=H(Bu,[["__cssModules",Qu]]),td=["placeholder","min","disabled"],nd=F({__name:"InputWithUnit",props:{modelValue:{type:String,default:void 0},options:{type:Array,required:!0},placeholder:{type:String,default:"请输入"},defaultUnit:{type:String,default:null},min:{type:Number,default:0},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=e,l=n,o=L(()=>{const a=l.defaultUnit;return l.options.some(d=>d.value===a)?a:l.options[0].value}),s=L({get(){return pt(l.modelValue).num},set(a){if(Zl(a)){const f=pt(l.modelValue).unit??o.value;return i(`${a}${f}`)}i()}}),r=L({get(){return pt(l.modelValue).unit??o.value},set(a){const f=pt(l.modelValue).num??l.min;i(`${f}${a}`)}});function i(a=void 0){t("update:modelValue",a)}return(a,d)=>(S(),I("div",{class:m(a.classes.input)},[Se(u("input",{type:"number",step:"any","onUpdate:modelValue":d[0]||(d[0]=f=>s.value=f),class:m({"quickprint-form-control":!0,"quickprint-form-disabled":n.disabled}),placeholder:n.placeholder,min:n.min,disabled:n.disabled},null,10,td),[[Ae,s.value]]),p(b(le),{modelValue:r.value,"onUpdate:modelValue":d[1]||(d[1]=f=>r.value=f),class:m(a.classes.unit),options:n.options,width:"auto",border:"none",disabled:n.disabled},null,8,["modelValue","class","options","disabled"])],2))}}),ld="_input_gtdaq_2",od="_unit_gtdaq_14",sd={input:ld,unit:od},id={classes:sd},Pe=H(nd,[["__cssModules",id]]),rd="永和九年，岁在癸丑，暮春之初，会于会稽山阴之兰亭，修禊事也。群贤毕至，少长咸集。此地有崇山峻岭，茂林修竹；又有清流激湍，映带左右，引以为流觞曲水，列坐其次。虽无丝竹管弦之盛，一觞一咏，亦足以畅叙幽情。是日也，天朗气清，惠风和畅，仰观宇宙之大，俯察品类之盛，所以游目骋怀，足以极视听之娱，信可乐也。",ad=F({__name:"Paragraph",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:pe.NONE},{label:"磅",value:pe.PT},{label:"像素",value:pe.PX}],l=[{label:"字符",value:pe.EM},{label:"磅",value:pe.PT},{label:"像素",value:pe.PX}],o=[{label:"毫米",value:pe.MM},{label:"磅",value:pe.PT},{label:"像素",value:pe.PX}],s=L({get(){return e.options.style.textAlign??ft.LEFT},set(v){const E=v===ft.LEFT?void 0:v;e.options.style.textAlign=E}}),r=L({get(){return e.options.style.textAlignLast??wt.AUTO},set(v){const E=v===wt.AUTO?void 0:v;e.options.style.textAlignLast=E}}),i=L({get(){return e.options.style.verticalAlign??ot.MIDDLE},set(v){const E=v===ot.MIDDLE?void 0:v;e.options.style.verticalAlign=E}}),a=_("paddingTop"),d=_("paddingBottom"),f=_("paddingLeft"),h=_("paddingRight"),g=L(()=>{const v=e.options.style,E={};return v.textAlign&&(E.textAlign=v.textAlign),v.textAlignLast&&(E.textAlignLast=v.textAlignLast),v.textIndent&&(E.textIndent=v.textIndent),v.lineHeight&&(E.lineHeight=v.lineHeight),Ye(E,c(v.verticalAlign)),E}),y=L(()=>{const v=e.options.style,E={};return E["--openprint-paragraph-preview-padding-top"]=v.paddingTop??"2px",E["--openprint-paragraph-preview-padding-right"]=v.paddingRight??"2px",E["--openprint-paragraph-preview-padding-bottom"]=v.paddingBottom??"2px",E["--openprint-paragraph-preview-padding-left"]=v.paddingLeft??"2px",E});function _(v){return L({get(){return e.options.style[v]},set(E){const x=me(E)?void 0:E;e.options.style[v]=x}})}function c(v){return v==null?{}:v==ot.MIDDLE||v==null?{display:"flex",alignItems:"center"}:v==ot.BOTTOM?{display:"flex",alignItems:"end"}:{}}return(v,E)=>(S(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",v.classes.paragraph])},[u("div",{class:m(v.classes.textAlign)},[u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"文本对齐",2),p(b(le),{options:b(il),modelValue:s.value,"onUpdate:modelValue":E[0]||(E[0]=x=>s.value=x)},null,8,["options","modelValue"])],2),u("div",{class:m(v.classes.alignLast)},[u("div",{class:m(v.classes.configItemLabel)},"最后一行",2),p(b(le),{options:b(Tu),modelValue:r.value,"onUpdate:modelValue":E[1]||(E[1]=x=>r.value=x)},null,8,["options","modelValue"])],2)],2),u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"垂直对齐",2),p(b(le),{options:b(sl),modelValue:i.value,"onUpdate:modelValue":E[2]||(E[2]=x=>i.value=x)},null,8,["options","modelValue"])],2),u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"首行缩进",2),p(Pe,{modelValue:n.options.style.textIndent,"onUpdate:modelValue":E[3]||(E[3]=x=>n.options.style.textIndent=x),options:l,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.configItem)},[u("div",{class:m(v.classes.configItemLabel)},"行高",2),p(Pe,{modelValue:n.options.style.lineHeight,"onUpdate:modelValue":E[4]||(E[4]=x=>n.options.style.lineHeight=x),options:t,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.fieldset)},[E[9]||(E[9]=u("header",null,"内边距",-1)),u("div",{class:m(v.classes.padding)},[u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"上边距",2),p(Pe,{modelValue:b(a),"onUpdate:modelValue":E[5]||(E[5]=x=>st(a)?a.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"下边距",2),p(Pe,{modelValue:b(d),"onUpdate:modelValue":E[6]||(E[6]=x=>st(d)?d.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"左边距",2),p(Pe,{modelValue:b(f),"onUpdate:modelValue":E[7]||(E[7]=x=>st(f)?f.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2),u("div",{class:m(v.classes.paddingItem)},[u("label",{class:m(v.classes.paddingItemLabel)},"右边距",2),p(Pe,{modelValue:b(h),"onUpdate:modelValue":E[8]||(E[8]=x=>st(h)?h.value=x:null),options:o,class:"quickprint-is-fill-w"},null,8,["modelValue"])],2)],2)],2),u("div",{class:m(v.classes.fieldset)},[E[10]||(E[10]=u("header",null,"预览",-1)),u("div",{class:m(v.classes.preview),style:Z(g.value)},[u("div",{style:Z(y.value),class:m(v.classes.previewText)},[ie(K(rd)+" "),u("div",{class:m(v.classes.paddingPreview)},null,2)],6)],6)],2)],2))}}),cd="_grid2_6gzjg_1",ud="_item_6gzjg_1",dd="_itemLabel_6gzjg_1",fd="_fieldset_6gzjg_1",pd="_paragraph_6gzjg_4",md="_preview_6gzjg_9",gd="_textAlign_6gzjg_25 quickprint-is-row",hd="_configItem_6gzjg_30 quickprint-is-row",vd="_alignLast_6gzjg_35 quickprint-is-row",bd="_configItemLabel_6gzjg_45",yd="_padding_6gzjg_50",_d="_paddingItem_6gzjg_57",Ed="_paddingItemLabel_6gzjg_63",Td="_previewText_6gzjg_68",Sd="_paddingPreview_6gzjg_77",Rd={grid2:cd,item:ud,itemLabel:dd,fieldset:fd,paragraph:pd,preview:md,textAlign:gd,configItem:hd,alignLast:vd,configItemLabel:bd,padding:yd,paddingItem:_d,paddingItemLabel:Ed,previewText:Td,paddingPreview:Sd},wd={classes:Rd},kd=H(ad,[["__cssModules",wd]]),Ld=["title","onClick"],Cd={key:0},Id=F({__name:"Border",props:{options:{type:Object,required:!0}},setup(n){const e=Ne("classes"),t=n,l=[{label:"像素",value:pe.PX},{label:"毫米",value:pe.MM},{label:"磅",value:pe.PT}],o={BORDER_TOP:0,BORDER_RIGHT:1,BORDER_BOTTOM:2,BORDER_LEFT:3,RADIUS_TOP_LEFT:4,RADIUS_TOP_RIGHT:5,RADIUS_BOTTOM_LEFT:6,RADIUS_BOTTOM_RIGHT:7},s={[o.BORDER_TOP]:"上边框",[o.BORDER_RIGHT]:"右边框",[o.BORDER_BOTTOM]:"下边框",[o.BORDER_LEFT]:"左边框",[o.RADIUS_TOP_LEFT]:"左上圆角",[o.RADIUS_TOP_RIGHT]:"右上圆角",[o.RADIUS_BOTTOM_LEFT]:"左下圆角",[o.RADIUS_BOTTOM_RIGHT]:"右下圆角"},r=de(),i=L(()=>{const T=r.value;return T==null?"全部边框":s[T]}),a=L(()=>{const T=r.value;return T==null?!0:T<=o.BORDER_LEFT}),d=L(()=>{const T=r.value;return T==null?!0:T>=o.RADIUS_TOP_LEFT}),f=L(()=>{const T=r.value;return{[e.box]:!0,[e.highlightTopLeft]:T==o.RADIUS_TOP_LEFT,[e.highlightTopRight]:T==o.RADIUS_TOP_RIGHT,[e.highlightBottomLeft]:T==o.RADIUS_BOTTOM_LEFT,[e.highlightBottomRight]:T==o.RADIUS_BOTTOM_RIGHT}}),h=L(()=>({...x(o.BORDER_TOP),...x(o.BORDER_RIGHT),...x(o.BORDER_BOTTOM),...x(o.BORDER_LEFT),...E()})),g=L({get(){var V;const T=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return T.borderWidth;const w=(V=Et(R))==null?void 0:V.width;if(w!=null)return Reflect.get(T,w)},set(T){const R=t.options.style,w=r.value,V=T??void 0;if(w==null||w>o.BORDER_LEFT){R.borderWidth=V;return}const P=Et(w);P!=null&&Reflect.set(R,P.width,V)}}),y=L({get(){var V;const T=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return T.borderStyle??Q.NONE;const w=(V=Et(R))==null?void 0:V.style;return w==null?Q.NONE:Reflect.get(T,w)??Q.NONE},set(T){const R=t.options.style,w=r.value,V=T==null||T==Q.NONE?void 0:T;if(w==null||w>o.BORDER_LEFT){R.borderStyle=V;return}const P=Et(w);P!=null&&Reflect.set(R,P.style,V)}}),_=L({get(){var V;const T=t.options.style,R=r.value;if(R==null||R>o.BORDER_LEFT)return T.borderColor;const w=(V=Et(R))==null?void 0:V.color;return w==null?qe.INHERIT:Reflect.get(T,w)??qe.INHERIT},set(T){const R=t.options.style,w=r.value,V=T??void 0;if(w==null||w>o.BORDER_LEFT){R.borderColor=V;return}const P=Et(w);P!=null&&Reflect.set(R,P.color,V)}}),c=L({get(){const T=t.options.style,R=r.value;if(R==null||R<=o.BORDER_LEFT)return T.borderRadius;const w=v(R);if(w!=null)return Reflect.get(T,w)},set(T){const R=t.options.style,w=r.value,V=T??void 0;if(w==null||w<=o.BORDER_LEFT){R.borderRadius=V;return}const P=v(w);P!=null&&Reflect.set(R,P,V)}});function v(T){switch(T){case o.RADIUS_TOP_LEFT:return"borderTopLeftRadius";case o.RADIUS_TOP_RIGHT:return"borderTopRightRadius";case o.RADIUS_BOTTOM_RIGHT:return"borderBottomRightRadius";case o.RADIUS_BOTTOM_LEFT:return"borderBottomLeftRadius"}}function E(){const T=t.options.style;return{borderTopLeftRadius:T.borderTopLeftRadius??T.borderRadius,borderTopRightRadius:T.borderTopRightRadius??T.borderRadius,borderBottomRightRadius:T.borderBottomRightRadius??T.borderRadius,borderBottomLeftRadius:T.borderBottomLeftRadius??T.borderRadius}}function x(T){const R=t.options.style;if(T==null||T>o.BORDER_LEFT){const P=R.borderStyle;return P==null||P==Q.NONE?{borderStyle:Q.NONE}:{}}const w=Et(T);if(w==null)return{};const V=Reflect.get(R,w.style)??Reflect.get(R,"borderStyle");return V==null||V===Q.NONE?{}:{[w.style]:V??R.borderStyle,[w.width]:Reflect.get(R,w.width)??R.borderWidth,[w.color]:Reflect.get(R,w.color)??R.borderColor??qe.BLACK}}function C(T){y.value=T}function O(T){r.value=T===r.value?void 0:T}function k(){const T=t.options.style;T.borderStyle=void 0,T.borderColor=void 0,T.borderWidth=void 0,T.borderTopStyle=void 0,T.borderTopColor=void 0,T.borderTopWidth=void 0,T.borderRightStyle=void 0,T.borderRightColor=void 0,T.borderRightWidth=void 0,T.borderBottomStyle=void 0,T.borderBottomColor=void 0,T.borderBottomWidth=void 0,T.borderLeftStyle=void 0,T.borderLeftColor=void 0,T.borderLeftWidth=void 0}function $(){const T=t.options.style;T.borderTopStyle==Q.NONE&&(T.borderTopStyle=void 0),T.borderRightStyle==Q.NONE&&(T.borderRightStyle=void 0),T.borderBottomStyle==Q.NONE&&(T.borderBottomStyle=void 0),T.borderLeftStyle==Q.NONE&&(T.borderLeftStyle=void 0),T.borderStyle=Q.SOLID}function B(){const T=t.options.style;T.borderStyle=void 0,T.borderRightStyle=void 0,T.borderRightColor=void 0,T.borderRightWidth=void 0,T.borderLeftStyle=void 0,T.borderLeftColor=void 0,T.borderLeftWidth=void 0,T.borderTopStyle=Q.SOLID,T.borderBottomStyle=Q.SOLID}function q(T){const R=t.options.style,w=v(T)??"borderRadius",V=Reflect.get(R,w);return we(V)}function A(){const T=t.options.style;return we(T.borderRadius)??0}function D(T){const R=Math.min(Math.max(12,q(T)??A(),N(T)),36),w={width:R+"px",height:R+"px"};return r.value==T&&(w.backgroundColor="var(--radius-highlight-background-color)"),T==o.RADIUS_TOP_LEFT&&(w.top="-6px",w.left="-6px"),T==o.RADIUS_TOP_RIGHT&&(w.top="-6px",w.right="-6px"),T==o.RADIUS_BOTTOM_RIGHT&&(w.bottom="-6px",w.right="-6px"),T==o.RADIUS_BOTTOM_LEFT&&(w.bottom="-6px",w.left="-6px"),w}function N(T){const R=t.options.style;switch(T){case o.RADIUS_TOP_LEFT:{const w=R.borderTopStyle==null||R.borderTopStyle==Q.NONE?0:we(R.borderTopWidth),V=R.borderLeftStyle==null||R.borderLeftStyle==Q.NONE?0:we(R.borderLeftWidth);return Math.max(w??0,V??0)}case o.RADIUS_TOP_RIGHT:{const w=R.borderTopStyle==null||R.borderTopStyle==Q.NONE?0:we(R.borderTopWidth),V=R.borderRightStyle==null||R.borderRightStyle==Q.NONE?0:we(R.borderRightWidth);return Math.max(w??0,V??0)}case o.RADIUS_BOTTOM_RIGHT:{const w=R.borderBottomStyle==null||R.borderBottomStyle==Q.NONE?0:we(R.borderBottomWidth),V=R.borderRightStyle==null||R.borderRightStyle==Q.NONE?0:we(R.borderRightWidth);return Math.max(w??0,V??0)}case o.RADIUS_BOTTOM_LEFT:{const w=R.borderBottomStyle==null||R.borderBottomStyle==Q.NONE?0:we(R.borderBottomWidth),V=R.borderLeftStyle==null||R.borderLeftStyle==Q.NONE?0:we(R.borderLeftWidth);return Math.max(w??0,V??0)}default:return 0}}function M(T){const R=t.options.style;switch(T){case o.BORDER_TOP:{const w=Math.max(6,Math.min(q(o.RADIUS_TOP_LEFT)??A()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_TOP_RIGHT)??A()-6,32)),P={left:w+"px",right:V+"px",top:"-6px",height:"12px"};if(r.value===T&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderTopStyle==null||R.borderTopStyle==Q.NONE)return P;const te=we(R.borderTopWidth);return te==null||(P.height=12+te+"px",P.top=-6-te+"px"),P}case o.BORDER_BOTTOM:{const w=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_LEFT)??A()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_RIGHT)??A()-6,32)),P={left:w+"px",right:V+"px",bottom:"-6px",height:"12px"};if(r.value===T&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderBottomStyle==null||R.borderBottomStyle==Q.NONE)return P;const te=we(R.borderBottomWidth);return te==null||(P.height=12+te+"px",P.bottom=-6-te+"px"),P}case o.BORDER_LEFT:{const w=Math.max(6,Math.min(q(o.RADIUS_TOP_LEFT)??A()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_LEFT)??A()-6,32)),P={top:w+"px",bottom:V+"px",left:"-6px",width:"12px"};if(r.value===T&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderLeftStyle==null||R.borderLeftStyle==Q.NONE)return P;const te=we(R.borderLeftWidth);return te==null||(P.width=12+te+"px",P.left=-6-te+"px"),P}case o.BORDER_RIGHT:{const w=Math.max(6,Math.min(q(o.RADIUS_TOP_RIGHT)??A()-6,32)),V=Math.max(6,Math.min(q(o.RADIUS_BOTTOM_RIGHT)??A()-6,32)),P={top:w+"px",bottom:V+"px",right:"-6px",width:"12px"};if(r.value===T&&(P.backgroundColor="var(--border-highlight-background-color)"),R.borderRightStyle==null||R.borderRightStyle==Q.NONE)return P;const te=we(R.borderRightWidth);return te==null||(P.width=12+te+"px",P.right=-6-te+"px"),P}}}return(T,R)=>(S(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",b(e).settings])},[u("div",{class:m(b(e).presets)},[R[15]||(R[15]=u("span",null,"预设",-1)),u("button",{type:"button",class:"quickprint-text-btn",onClick:k},[u("div",{class:m(b(e).noBorder)},null,2),R[12]||(R[12]=u("span",null,"无边框",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:$},[u("div",{class:m(b(e).outerBorder)},null,2),R[13]||(R[13]=u("span",null,"外部边框",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:B},[u("div",{class:m(b(e).topBottomBorder)},null,2),R[14]||(R[14]=u("span",null,"上下边框",-1))])],2),u("div",{class:m(f.value),style:Z(h.value),onClick:R[8]||(R[8]=se(()=>{},["stop"]))},[u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_TOP_LEFT)),onClick:R[0]||(R[0]=w=>O(o.RADIUS_TOP_LEFT))},null,6),u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_TOP_RIGHT)),onClick:R[1]||(R[1]=w=>O(o.RADIUS_TOP_RIGHT))},null,6),u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_BOTTOM_LEFT)),onClick:R[2]||(R[2]=w=>O(o.RADIUS_BOTTOM_LEFT))},null,6),u("div",{class:m(b(e).borderRadius),style:Z(D(o.RADIUS_BOTTOM_RIGHT)),onClick:R[3]||(R[3]=w=>O(o.RADIUS_BOTTOM_RIGHT))},null,6),u("div",{class:m(b(e).border),style:Z(M(o.BORDER_TOP)),onClick:R[4]||(R[4]=w=>O(o.BORDER_TOP))},null,6),u("div",{class:m(b(e).border),style:Z(M(o.BORDER_BOTTOM)),onClick:R[5]||(R[5]=w=>O(o.BORDER_BOTTOM))},null,6),u("div",{class:m(b(e).border),style:Z(M(o.BORDER_RIGHT)),onClick:R[6]||(R[6]=w=>O(o.BORDER_RIGHT))},null,6),u("div",{class:m(b(e).border),style:Z(M(o.BORDER_LEFT)),onClick:R[7]||(R[7]=w=>O(o.BORDER_LEFT))},null,6),u("div",{class:m(b(e).borderTitle)},K(i.value),3)],6),u("div",{class:m(b(e).borderSetting)},[u("div",{class:m(b(e).borderStyle)},[u("label",{class:m(b(e).borderStyleTitle)},"线型",2),u("div",{class:m(["quickprint-is-fill-h quickprint-is-scrollable",b(e).borderStyleOptions])},[(S(!0),I(ne,null,ae(b(Eu),w=>(S(),I("div",{key:w.value,title:w.label,class:m({[b(e).option]:!0,[b(e).selected]:w.value===y.value}),onClick:V=>C(w.value)},[w.value==b(Q).NONE?(S(),I("div",Cd,K(w.label),1)):(S(),I("div",{key:1,class:m(b(e).line),style:Z({textDecorationStyle:w.value})},"--",6))],10,Ld))),128))],2)],2),u("div",{class:m(b(e).borderSettingRight)},[u("div",{class:m(b(e).borderItem)},[u("label",{class:m(b(e).borderItemLabel)},"颜色",2),p(b(Rn),{modelValue:_.value,"onUpdate:modelValue":R[9]||(R[9]=w=>_.value=w),disabled:!a.value},null,8,["modelValue","disabled"])],2),u("div",{class:m(b(e).borderItem)},[u("label",{class:m(b(e).borderItemLabel)},"宽度",2),p(Pe,{modelValue:g.value,"onUpdate:modelValue":R[10]||(R[10]=w=>g.value=w),options:l,disabled:!a.value},null,8,["modelValue","disabled"])],2),u("div",{class:m(b(e).borderItem)},[u("label",{class:m(b(e).borderItemLabel)},"圆角",2),p(Pe,{modelValue:c.value,"onUpdate:modelValue":R[11]||(R[11]=w=>c.value=w),options:l,disabled:!d.value},null,8,["modelValue","disabled"])],2)],2)],2)],2))}}),Od="_settings_12vtg_2",Nd="_box_12vtg_8",xd="_border_12vtg_19",Dd="_borderTitle_12vtg_30",Md="_borderRadius_12vtg_39",Ad="_borderItem_12vtg_50",Bd="_borderItemLabel_12vtg_59",$d="_borderSetting_12vtg_65",qd="_borderSettingRight_12vtg_70",Pd="_borderStyle_12vtg_76",Vd="_borderStyleOptions_12vtg_81",Fd="_borderStyleTitle_12vtg_88",zd="_option_12vtg_95",Ud="_line_12vtg_114",Hd="_selected_12vtg_125",Gd="_presets_12vtg_131",Wd="_noBorder_12vtg_142",Yd="_outerBorder_12vtg_143",Xd="_topBottomBorder_12vtg_144",jd={settings:Od,box:Nd,border:xd,borderTitle:Dd,borderRadius:Md,borderItem:Ad,borderItemLabel:Bd,borderSetting:$d,borderSettingRight:qd,borderStyle:Pd,borderStyleOptions:Vd,borderStyleTitle:Fd,option:zd,line:Ud,selected:Hd,presets:Gd,noBorder:Wd,outerBorder:Yd,topBottomBorder:Xd},Zd={classes:jd},Kd=H(Id,[["__cssModules",Zd]]),Jd="_setting_joc27_2",Qd={setting:Jd},ef={};function tf(n,e){return S(),I("div",{class:m(["quickprint-is-scrollable quickprint-is-fill-h",n.classes.setting])},"TODO:",2)}const nf={classes:Qd},lf=H(ef,[["render",tf],["__cssModules",nf]]),of=F({__name:"index",props:{options:{type:Object,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=Ze();function l(){t==null||t.confirm(e.options)}function o(){t==null||t.cancel()}return(s,r)=>(S(),I("div",{class:m(s.classes.setting)},[n.active==="font"?(S(),ee(ed,{key:0,options:e.options},null,8,["options"])):Y("",!0),n.active==="paragraph"?(S(),ee(kd,{key:1,options:e.options},null,8,["options"])):Y("",!0),n.active==="border"?(S(),ee(Kd,{key:2,options:e.options},null,8,["options"])):Y("",!0),n.active==="table"?(S(),ee(lf,{key:3})):Y("",!0),u("div",{class:m(s.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:o},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:l},"确定")],2)],2))}}),sf="_setting_1v5ya_2",rf="_footer_1v5ya_9",af={setting:sf,footer:rf},cf={classes:af},Gn=H(of,[["__cssModules",cf]]),uf=F({__name:"Footer",emits:["confirm"],setup(n,{emit:e}){const t=e,l=Ze();function o(){t("confirm",function(i){l==null||l.confirm(i)})}function s(){l==null||l.cancel()}return(r,i)=>(S(),I("div",{class:m(r.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:s},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:o},"确定")],2))}}),df="_footer_1ux18_2",ff={footer:df},pf={classes:ff},Io=H(uf,[["__cssModules",pf]]),mf=F({__name:"Diagonal",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=L({get(){return e.options.diagonalMode??Ie.NONE},set(i){const a=i==Ie.NONE?void 0:i;e.options.diagonalMode=a}}),l=L({get(){var i,a;return(a=(i=e.options.diagonalLabels)==null?void 0:i[0])==null?void 0:a.text},set(i){const a=e.options;a.diagonalLabels==null&&(a.diagonalLabels=[]),a.diagonalLabels[0]==null&&(a.diagonalLabels[0]={}),a.diagonalLabels[0].text=i}}),o=L({get(){var i,a;return(a=(i=e.options.diagonalLabels)==null?void 0:i[1])==null?void 0:a.text},set(i){const a=e.options;a.diagonalLabels==null&&(a.diagonalLabels=[]),a.diagonalLabels[1]==null&&(a.diagonalLabels[1]={}),a.diagonalLabels[1].text=i}});function s(i){t.value=i}function r(i){i(e.options)}return(i,a)=>(S(),I("div",{class:m(i.classes.setting)},[u("div",{class:m(i.classes.main)},[u("div",{class:m(["quickprint-is-row",i.classes.diagonal])},[u("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Ie).NONE}),onClick:a[0]||(a[0]=d=>s(b(Ie).NONE))},null,2),u("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Ie).TL_BR}),onClick:a[1]||(a[1]=d=>s(b(Ie).TL_BR))},[p(ol,{mode:b(Ie).TL_BR,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2),u("div",{class:m({[i.classes.cell]:!0,[i.classes.selected]:t.value===b(Ie).TR_BL}),onClick:a[2]||(a[2]=d=>s(b(Ie).TR_BL))},[p(ol,{mode:b(Ie).TR_BL,labels:n.options.diagonalLabels},null,8,["mode","labels"])],2)],2),u("div",{class:m(i.classes.label)},[u("div",{class:m(i.classes.text)},"顶部文本",2),Se(u("input",{"onUpdate:modelValue":a[3]||(a[3]=d=>l.value=d),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Ae,l.value]])],2),u("div",{class:m(i.classes.label)},[u("div",{class:m(i.classes.text)},"底部文本",2),Se(u("input",{"onUpdate:modelValue":a[4]||(a[4]=d=>o.value=d),class:"quickprint-form-control quickprint-is-fill-w",placeholder:"请输入"},null,512),[[Ae,o.value]])],2)],2),p(Io,{onConfirm:r})],2))}}),gf="_setting_1u7dq_2",hf="_main_1u7dq_6",vf="_cell_1u7dq_10",bf="_diagonal_1u7dq_25",yf="_selected_1u7dq_29",_f="_label_1u7dq_34",Ef="_text_1u7dq_41",Tf={setting:gf,main:hf,cell:vf,diagonal:bf,selected:yf,label:_f,text:Ef},Sf={classes:Tf},Rf=H(mf,[["__cssModules",Sf]]);function Oo(n){return Oe({style:un(n.style??{})})}function wf(n,e){n.style=Object.assign({},n.style,e.style)}function No(n){if(Array.isArray(n)&&n.length>1)return Oe({style:{}});const e=Array.isArray(n)?n[0]:n;return Oe({width:e.width,height:e.height,diagonalMode:e.attributes.diagonalMode,diagonalLabels:un(e.attributes.diagonalLabels??[]),style:un(e.style??{})})}const kf=ke(function(n){return vt("表格",(e,t)=>p(Gn,{options:Oo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"属性",name:"table",active:!0},{label:"边框",name:"border"}]}).promisify().then(e=>wf(n,e)).catch(Le)}),Lf=ke(function(n){return vt("表格行",(e,t)=>p(Gn,{options:Oo(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(Le)}),Cf=ke(function(n){return vt("单元格",(e,t)=>p(Gn,{options:No(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().catch(Le)}),If=ke(function(n){return Xe("斜线表头",p(Rf,{options:No(n)},null),{width:"360px",top:"15vh",resizeMode:Ft.DISABLED}).promisify().catch(Le)}),Of={style:{overflow:"hidden"}},Nf=F({__name:"TextDirection",props:{options:{type:Object,required:!0}},setup(n){const e=n,t=L(()=>e.options.style.writingMode??Ve.HORIZONTAL_TB);function l(s){e.options.style.writingMode=s===Ve.HORIZONTAL_TB?void 0:s}function o(s){s(e.options)}return(s,r)=>(S(),I("div",Of,[u("div",{class:m(s.classes.textDirection)},[u("div",{class:m(s.classes.grid)},[u("div",{title:"水平排版，从左到右",class:m({[s.classes.horizontalTb]:!0,[s.classes.selected]:t.value===b(Ve).HORIZONTAL_TB}),onClick:r[0]||(r[0]=i=>l(b(Ve).HORIZONTAL_TB))},r[5]||(r[5]=[u("p",null,"文字abc",-1)]),2),u("div",{title:"垂直排版，从上到下，从左到右",class:m({[s.classes.verticalLr]:!0,[s.classes.selected]:t.value===b(Ve).VERTICAL_LR}),onClick:r[1]||(r[1]=i=>l(b(Ve).VERTICAL_LR))},r[6]||(r[6]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2),u("div",{title:"垂直排版，从上到下，从右到左",class:m({[s.classes.verticalRl]:!0,[s.classes.selected]:t.value===b(Ve).VERTICAL_RL}),onClick:r[2]||(r[2]=i=>l(b(Ve).VERTICAL_RL))},r[7]||(r[7]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2),u("div",{title:"垂直排版，从上到下，从右到左",class:m({[s.classes.sidewaysRl]:!0,[s.classes.selected]:t.value===b(Ve).SIDEWAYS_RL}),onClick:r[3]||(r[3]=i=>l(b(Ve).SIDEWAYS_RL))},r[8]||(r[8]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2),u("div",{title:"垂直排版，从下到上，从左到右",class:m({[s.classes.sidewaysLr]:!0,[s.classes.selected]:t.value===b(Ve).SIDEWAYS_LR}),onClick:r[4]||(r[4]=i=>l(b(Ve).SIDEWAYS_LR))},r[9]||(r[9]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2)],2),u("div",{class:m(s.classes.preview)},r[10]||(r[10]=[u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc文字abc",-1),u("p",null,"文字abc→",-1)]),2)],2),p(Io,{onConfirm:o})]))}}),xf="_textDirection_qsmbx_2",Df="_grid_qsmbx_16",Mf="_item_qsmbx_24",Af="_horizontalTb_qsmbx_36 _item_qsmbx_24",Bf="_verticalLr_qsmbx_45 _item_qsmbx_24",$f="_verticalRl_qsmbx_54 _item_qsmbx_24",qf="_sidewaysRl_qsmbx_63 _item_qsmbx_24",Pf="_sidewaysLr_qsmbx_72 _item_qsmbx_24",Vf="_preview_qsmbx_81",Ff="_selected_qsmbx_89",zf={textDirection:xf,grid:Df,item:Mf,horizontalTb:Af,verticalLr:Bf,verticalRl:$f,sidewaysRl:qf,sidewaysLr:Pf,preview:Vf,selected:Ff},Uf={classes:zf},Hf=H(Nf,[["__cssModules",Uf]]);function Gf(n){return Oe({style:un(n.style??{})})}function Wf(n){return Oe({style:n.length==1?un(n[0].style??{}):{}})}function xo(n,e){n.style=Object.assign({},n.style,e.style)}const Yf=ke(function(n){return vt("元素",(e,t)=>p(Gn,{options:Gf(n),active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"字体",name:"font",active:!0},{label:"段落",name:"paragraph"},{label:"边框",name:"border"}]}).promisify().then(e=>xo(n,e)).catch(Le)}),Do=ke(function(n){const e=Array.isArray(n)?n:[n];return Xe("文字方向",p(Hf,{options:Wf(e)},null),{width:"424px",height:"285px",top:"15vh",resizeMode:Ft.DISABLED}).promisify().then(t=>e.forEach(l=>xo(l,t))).catch(Le)});function Xf(n,e,t){const l={menus:[...Mo(e),{type:"menu",label:"行设置",icon:"icon-table-row",handler(){const o=e.getSelectedElements(),s=o[0];s!=null&&Lf(s).then(r=>{if(r!=null)for(const i of o)i.style=Object.assign({},i.style,r.style)})}},{type:"divider"},Ao(e),Bo(e),{type:"divider"},$o(e),bl(e.getDesignApi(),e.getTable())]};Bn.open(n.clientX,n.clientY,l)}function jf(n,e){const l=e.getDesignApi().getSelectedElements();if(e.isSelectTableRow())return Xf(n,e,l[0]);const o=e.getSelectedCells(),s={menus:[...Mo(e),{type:"menu",label:"单元格设置",icon:"icon-border",handler(){Cf(o).then(i=>{if(i!=null)for(const a of o)a.style=Object.assign({},a.style,i.style)})}},{type:"menu",label:"斜线表头",icon:"icon-diagonal",handler(){If(o).then(i=>{if(i!=null)for(const a of o)i.diagonalMode&&(a.attributes.diagonalMode=i.diagonalMode),i.diagonalLabels&&(a.attributes.diagonalLabels=i.diagonalLabels)})}},{type:"menu",label:"文字方向",icon:"icon-text-direction",handler(){Do(o)}},{type:"divider"}]},r=[];return o.length>=2&&r.push({type:"menu",label:"合并单元格",icon:"icon-merge-cells",handler:e.mergeCells,disabled(){const i=o.map(d=>d.parent).filter(d=>d!=null);return new Set(i.map(d=>d.attributes.type)).size>1?!0:new Set(i.map(d=>d.ds.value).filter(d=>An(d))).size>1}}),o.some(i=>i.hasSpan)&&r.push({type:"menu",label:"拆分单元格",icon:"icon-solit-cells",handler:e.splitCells}),o.length===1&&o[0].noSpan&&r.push({type:"menu",label:"拆分列",icon:"icon-split-column",handler:e.splitByColumn},{type:"menu",label:"拆分行",icon:"icon-split-row",handler:e.splitByRow}),r.length>0&&s.menus.push(...r,{type:"divider"}),s.menus.push(Ao(e),Bo(e),{type:"divider"},$o(e),bl(e.getDesignApi(),e.getTable())),Bn.open(n.clientX,n.clientY,s)}function Mo(n){return[{type:"menu",label:"选中表格",icon:"icon-aim",handler:n.selectTable},{type:"menu",label:"表格设置",icon:"icon-table",handler(){kf(n.getTable())}}]}function Ao(n){return{type:"menu",label:"插入",icon:"icon-plus-square",submenu:[{type:"menu",label:"左侧插入列",icon:"icon-insert-column-left",handler:n.insertColumnLeft,disabled:n.isSelectTableRow},{type:"menu",label:"右侧插入列",icon:"icon-insert-column-right",handler:n.insertColumnRight,disabled:n.isSelectTableRow},{type:"menu",label:"上侧插入行",icon:"icon-insert-row-above",handler:n.insertRowTop},{type:"menu",label:"下侧插入行",icon:"icon-insert-row-below",handler:n.inserRowBottom}]}}function Bo(n){return{type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"删除列",icon:"icon-deletecolumn",handler:n.deleteColumns,disabled:n.isSelectTableRow},{type:"menu",label:"删除行",icon:"icon-deleterow",handler:n.deleteRows},{type:"menu",label:"数据源",icon:"icon-datasource",handler:n.deleteDataSource}]}}function $o(n){return{type:"menu",label:"自动调整",icon:"icon-auto-resize",submenu:[{type:"menu",label:"根据纸张调整列宽",handler:n.autoReiszeColumnByPaper},{type:"menu",label:"均分表格宽度",handler:n.avgTableWidth},{type:"menu",label:"均分表格高度",handler:n.avgTableHeight},{type:"menu",label:"将其他行设为相同高度",handler:n.setOtherRowSameHeight,disabled(){const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasRowSpan)}},{type:"menu",label:"将其他列设为相同宽度",handler:n.setOtherColSameWidth,disabled(){if(n.isSelectTableRow())return!0;const e=n.getSelectedCells();return!!(e.length!==1||e[0].hasColSpan)}}]}}function Zf(n,e){function t(){return n.element}function l(){return e.getSelectedElements(t())}function o(){const B=t();return l().filter(A=>{var N;if(A.type!==j.TABLE_CELL)return!1;const D=(N=A.parent)==null?void 0:N.parent;return D==null?!1:D.id==B.id}).sort(xn.sort)}function s(){return e.selectElement(t())}function r(){const B=o();if(B.length===0)return!1;const q=kt.toArea(B);return t().insertColumn(q.colStart,0),e.createSnapshot(),!0}function i(){const B=o();if(B.length===0)return!1;const q=kt.toArea(B);return t().insertColumn(q.colEnd,1),e.createSnapshot(),!0}function a(){if($()){const A=l()[0];return t().inserRow(A.index,0),e.createSnapshot(),!0}const B=o();if(B.length===0)return!1;const q=kt.toArea(B);return t().inserRow(q.rowStart,0),e.createSnapshot(),!0}function d(){if($()){const A=l()[0];return t().inserRow(A.index,1),e.createSnapshot(),!0}const B=o();if(B.length===0)return!1;const q=kt.toArea(B);return t().inserRow(q.rowEnd,1),e.createSnapshot(),!0}function f(){var te,xe;const B=t(),q=B.page;if(q==null)return;const A=B.doc,D=we((te=A==null?void 0:A.margins)==null?void 0:te.left)??38,N=we((xe=A==null?void 0:A.margins)==null?void 0:xe.right)??38,M=B.columns,T=M.reduce((De,Je)=>De+Je,0),R=et.mm_to_px(q.width)-D-N,w=[];for(const De of M){const Je=Math.round(De/T*R);w.push(Je)}const V=w.reduce((De,Je)=>De+Je,0),P=R-V;w[w.length-1]+=P,B.setColumns(w),B.updateBoxSize(),e.createSnapshot()}function h(){const B=t(),q=B.columns,A=q.reduce((T,R)=>T+R,0),D=Math.floor(A/q.length),N=new Array(q.length).fill(D),M=A-N.reduce((T,R)=>T+R,0);N[N.length-1]+=M,B.setColumns(N),B.updateBoxSize(),e.createSnapshot()}function g(){const B=t(),q=Math.round(B.height/B.children.length);B.children.forEach((A,D)=>B.setRowHeight(D,q)),B.updateBoxSize(),e.createSnapshot()}function y(){const B=l()[0];if(B==null)return;const q=B.type===j.TABLE_ROW?B:B.parent;if(!he.isDefineElement(q)||q.type!=j.TABLE_ROW)return;const A=t(),D=q.height;A.children.forEach(N=>N.setRowHeight(D)),A.updateBoxSize(),e.createSnapshot()}function _(){const B=l()[0];if(B==null)return;const q=t(),A=B.width,D=q.attributes.colgroup.map(N=>A);q.setColumns(D),q.updateBoxSize(),e.createSnapshot()}function c(){const B=o();if(B.length<2)return;const A=t().mergeCells(B);e.selectElement(A),e.createSnapshot()}function v(){const B=o();if(B.length==0)return;t().splitCells(B),e.createSnapshot()}function E(){const B=o()[0];if(B==null)return;t().removeColumn(B.index),e.resetSelectedElement(),e.createSnapshot()}function x(){if($()){const D=l()[0];t().removeRow(D.index),e.resetSelectedElement(),e.createSnapshot();return}const B=o();if(B.length==0)return;const q=kt.toArea(B),A=t();for(let D=q.rowEnd;D>=q.rowStart;D--)A.removeRow(D);e.resetSelectedElement(),e.createSnapshot()}function C(){l().forEach(q=>q.resetDS()),e.createSnapshot()}function O(){const B=l();if(B.length!=1)return;const q=B[0];if(q.hasSpan)return;const A=q.index,D=t();D.insertColumn(A,1,!0);for(const N of D.children){const M=N.children[A];if(M.id===q.id)continue;const T=N.children[A+1];if(M.hasSpan){D.mergeRightCell(M,T);continue}if(M.isCollapsed){const R=D.find(M.attributes.control);R&&D.mergeRightCell(R,T);continue}D.mergeCells([M,T])}e.selectElement(q),e.createSnapshot()}function k(){const B=l();if(B.length!=1)return;const q=B[0];if(q.hasSpan)return;const A=q.parent;if(A==null)return;const D=t();D.inserRow(A.index,1);const N=D.children[A.index+1];for(let M=0;M<A.children.length;M++){const T=A.children[M];if(T.id===q.id)continue;const R=N.children[M];if(T.hasSpan){D.mergeBottomCell(T,R);continue}if(T.isCollapsed){const w=D.find(T.attributes.control);w&&D.mergeBottomCell(w,R);continue}D.mergeCells([T,R])}e.selectElement(q),e.createSnapshot()}function $(){const B=l();return B.length==1&&B[0].type==j.TABLE_ROW}return{getDesignApi(){return e},getTable:t,getSelectedElements:l,getSelectedCells:o,selectTable:s,insertColumnLeft:r,insertColumnRight:i,insertRowTop:a,inserRowBottom:d,autoReiszeColumnByPaper:f,avgTableWidth:h,avgTableHeight:g,setOtherRowSameHeight:y,setOtherColSameWidth:_,mergeCells:c,splitCells:v,splitByColumn:O,splitByRow:k,deleteColumns:E,deleteRows:x,deleteDataSource:C,isSelectTableRow:$}}function Kf(n,e,t){const o={moved:!1,left:0,colIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getColumnLeft(f-1)}function r(f){const h=n.getTable(),g=h.attributes.colgroup.length;return f>=g?null:h.getColumnLeft(f+1)}function i(f,h){if(!(f.target instanceof Element))return;const g=f.target.closest("."+e.colResize);if(g==null)return;const y=g.closest("."+e.layer);y!=null&&(f.stopPropagation(),f.preventDefault(),o.left=g.offsetLeft,o.colIndex=h,o.target=g,o.container=y,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",d))}function a(f){if(o.target==null||o.container==null)return;const h=o.container.getBoundingClientRect(),g=n.getDesignApi().state.scale/100,y=s(o.colIndex),_=r(o.colIndex);let c=f.clientX-h.left;y!=null&&c<=y*g+4&&(c=y*g+4),_!=null&&c>=_*g-4&&(c=_*g-4),o.left=c/g,o.target.style.left=c/g+"px",o.moved=!0}function d(f){o.moved&&t.onResizeEnd(o.colIndex,Math.round(o.left)),o.left=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",d)}return i}function Jf(n,e,t){const o={moved:!1,top:0,rowIndex:0,target:null,container:null};function s(f){return f<=0?null:n.getTable().getRowTop(f-1)}function r(f){const h=n.getTable(),g=h.children.length;return f>=g?null:h.getRowTop(f+1)}function i(f,h){if(!(f.target instanceof Element))return;const g=f.target.closest("."+e.rowResize);if(g==null)return;const y=g.closest("."+e.layer);y!=null&&(f.stopPropagation(),f.preventDefault(),o.top=g.offsetTop,o.rowIndex=h,o.target=g,o.container=y,o.target.setPointerCapture(f.pointerId),window.addEventListener("pointermove",a),window.addEventListener("pointerup",d))}function a(f){if(o.target==null||o.container==null)return;const h=n.getDesignApi().state.scale/100,g=o.container.getBoundingClientRect(),y=s(o.rowIndex),_=r(o.rowIndex);let c=f.clientY-g.top;y!=null&&c<=y*h+4&&(c=y*h+4),_!=null&&c>=_*h-4&&(c=_*h-4),o.moved=!0,o.top=c/h,o.target.style.top=c/h+"px"}function d(f){o.moved&&t.onResizeEnd(o.rowIndex,Math.round(o.top)),o.top=0,o.target=null,o.container=null,window.removeEventListener("pointermove",a),window.removeEventListener("pointerup",d)}return i}const Qf=["width"],ep=["onClick"],tp=["onClick"],np=F({__name:"TableEditor",props:{element:{type:kt,required:!0}},setup(n){const e=n,t=Ce(),l=Ne("classes"),o=Zf(e,t),s=Oe({colIndex:-1,rowIndex:-1,silence:!1}),r=L(()=>e.element.attributes.colgroup??[]),i=Kf(o,l,{onResizeEnd:E,onResizeStart:v}),a=Jf(o,l,{onResizeEnd:x,onResizeStart:v});function d(A){return{left:(e.element.attributes.colgroup??[]).slice(0,A).reduce((N,M)=>N+M,0)+"px"}}function f(A){return{top:(e.element.children??[]).slice(0,A).reduce((M,T)=>M+T.height,0)-1+"px"}}function h(A){const D=e.element.attributes.colgroup??[],N=D.slice(0,A).reduce((R,w)=>R+w,0),M=A===0?0:1,T=A>0&&A<D.length?-1:0;return{left:N+M+"px",width:D[A]+T+"px"}}function g(A){const D=e.element.children??[],N=D.slice(0,A).reduce((R,w)=>R+w.height,0),M=A===0?0:1,T=A>0&&A<D.length?-1:0;return{top:N+M+"px",height:D[A].height+T+"px"}}function y(A){t.selectElement(A)}function _(A){const D=[];for(const N of e.element.children){const M=N.children[A];M.isColCollapsed||D.push(M)}t.multiSelectElements(D)}async function c(A){const D=A.target.closest("td");if(D==null)return;const N=Reflect.get(D,je);if(N==null)return;const M=t.getSelectedElements(e.element);(M.length==0||M.length==1&&M[0].type===j.TABLE_CELL||M.length>1&&M.findIndex(T=>T.id===N.id)<0)&&(t.selectElement(N),await jt()),jf(A,o)}function v(){s.silence=!0}function E(A,D){s.silence=!1;const N=e.element.attributes.colgroup??[];if(A==0){const V=e.element.left,P=e.element.calculateCoord(V+D),te=N[0]-(P-V);e.element.setLeft(P),e.element.setColWidth(0,te),e.element.updateBoxSize(),t.createSnapshot();return}if(A==N.length){const V=A-1,P=N.slice(0,V).reduce((xe,De)=>xe+De,0),te=D-P;e.element.setColWidth(A-1,te),e.element.updateBoxSize(),t.createSnapshot();return}const M=A-1,T=N[M]+N[A],R=D-N.slice(0,M).reduce((V,P)=>V+P,0),w=T-R;e.element.setColWidth(M,R),e.element.setColWidth(A,w),e.element.updateBoxSize(),t.createSnapshot()}function x(A,D){s.silence=!1;const N=e.element.children;if(A==0){const V=e.element.top,P=e.element.calculateCoord(V+D),te=N[0].height-(P-V);e.element.setTop(P),e.element.setRowHeight(A,te),e.element.updateBoxSize(),t.createSnapshot();return}if(A==N.length){const V=A-1,P=N.slice(0,V).reduce((xe,De)=>xe+De.height,0),te=D-P;e.element.setRowHeight(A-1,te),e.element.updateBoxSize(),t.createSnapshot();return}const M=A-1,T=N[M].height+N[A].height,R=D-N.slice(0,M).reduce((V,P)=>V+P.height,0),w=T-R;e.element.setRowHeight(M,R),e.element.setRowHeight(A,w),e.element.updateBoxSize(),t.createSnapshot()}function C(){s.rowIndex=-1,s.colIndex=-1}function O(A){const D=A.target.closest("td");if(D==null)return;const N=Reflect.get(D,je);if(N==null||!(N instanceof xn))return;const M=D.getBoundingClientRect(),T=A.clientX-M.left,R=N.index;if(!N.hasColSpan)return T<M.width/2?R:N.getNextColIndex();const w=e.element.attributes.colgroup,V=w[R]/2;if(T>=0&&T<=V)return R;const P=N.offsetWidth,te=P-w[R+N.colspan-1]/2;if(T>=te&&T<=P)return N.getNextColIndex()+1}function k(A){const D=A.target.closest("td");if(D==null)return;const N=Reflect.get(D,je);if(N==null||!(N instanceof xn))return;const M=N.parent;if(M==null)return;const T=D.getBoundingClientRect(),R=A.clientY-T.top,w=M.index;if(!N.hasRowSpan)return R<T.height/2?w:N.getNextRowIndex();const V=M.height/2;if(R>=0&&R<=V)return w;const P=e.element.children.slice(M.index,M.index+N.rowspan),te=P.reduce((De,Je)=>De+Je.height,0),xe=te-P[P.length-1].height;if(R>=xe&&R<=te)return N.getNextRowIndex()+1}function $(A){s.silence||(s.colIndex=O(A)??-1,s.rowIndex=k(A)??-1)}function B(){const A=e.element;A.insertColumn(A.colSize-1,1)}function q(){const A=e.element;A.inserRow(A.rowSize-1,1)}return(A,D)=>(S(),I("div",{class:m(b(l).tableEditor),onContextmenu:se(c,["stop","prevent"]),onClick:D[3]||(D[3]=se(()=>{},["stop"])),onMouseleave:C},[u("table",{class:m(b(l).table),onMousemove:$},[u("colgroup",null,[(S(!0),I(ne,null,ae(r.value,(N,M)=>(S(),I("col",{key:M,width:N},null,8,Qf))),128))]),u("tbody",null,[(S(!0),I(ne,null,ae(n.element.children,N=>(S(),I("tr",{key:N.id},[(S(!0),I(ne,null,ae(N.children,M=>(S(),ee(Ro,{key:M.id,element:M},null,8,["element"]))),128))]))),128))])],34),u("div",{class:m(b(l).layer)},[s.colIndex>=0?(S(),I("div",{key:0,title:"调整列宽",class:m(b(l).colResize),style:Z(d(s.colIndex)),onPointerdown:D[0]||(D[0]=se(N=>b(i)(N,s.colIndex),["stop","prevent"]))},null,38)):Y("",!0),s.rowIndex>=0?(S(),I("div",{key:1,title:"调整行高",class:m(b(l).rowResize),style:Z(f(s.rowIndex)),onPointerdown:D[1]||(D[1]=se(N=>b(a)(N,s.rowIndex),["stop","prevent"]))},null,38)):Y("",!0),(S(!0),I(ne,null,ae(r.value,(N,M)=>(S(),I("div",{title:"选中此列",key:M,style:Z(h(M)),class:m(b(l).colIndicator),onClick:se(T=>_(M),["stop"])},null,14,ep))),128)),(S(!0),I(ne,null,ae(n.element.children,(N,M)=>(S(),I("div",{title:"选中此行",key:M,style:Z(g(M)),class:m(b(l).rowIndicator),onClick:se(T=>y(N),["stop"])},null,14,tp))),128)),n.element.isSelected?(S(),I("button",{key:2,onClick:se(B,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addCol]),title:"添加列"},[p(b(U),{icon:"icon-plus",size:"14px"})],2)):Y("",!0),n.element.isSelected?(S(),I("button",{key:3,onClick:se(q,["stop"]),type:"button",class:m(["quickprint-text-btn",b(l).addRow]),title:"添加行"},[p(b(U),{icon:"icon-plus",size:"14px"})],2)):Y("",!0)],2),u("div",{class:m(b(l).indicator),onPointerdown:D[2]||(D[2]=(...N)=>b(t).onDragStart&&b(t).onDragStart(...N)),title:"选中/拖动表格"},null,34)],34))}}),lp="_tableEditor_5qbkt_2",op="_table_5qbkt_2",sp="_layer_5qbkt_33",ip="_colResize_5qbkt_43",rp="_rowResize_5qbkt_66",ap="_colIndicator_5qbkt_89",cp="_rowIndicator_5qbkt_95",up="_indicator_5qbkt_114",dp="_addCol_5qbkt_151",fp="_addRow_5qbkt_166",pp={tableEditor:lp,table:op,layer:sp,colResize:ip,rowResize:rp,colIndicator:ap,rowIndicator:cp,indicator:up,addCol:dp,addRow:fp},mp={classes:pp},gp=H(np,[["__cssModules",mp]]),hp={class:"quickprint-config-section quickprint-config-inline"},vp={class:"quickprint-config-content"},bp=F({__name:"TableConfig",props:{element:{type:kt,required:!0}},setup(n){const e=n,t=L({get(){return e.element.attributes.rowMode??Qt.CONST},set(o){e.element.attributes.rowMode=o===Qt.CONST?void 0:o}}),l=[{label:"固定行数",value:Qt.CONST,detail:"按照画布中设计打印固定行数，并依此拆分表格"},{label:"忽略空白行",value:Qt.IGNORE_BLANK,detail:"不固定行数，忽略表格中的空白行"},{label:"打印空白行",value:Qt.PRINT_BLANK,detail:"不固定行数，打印表格中的空白行"}];return(o,s)=>(S(),I("section",hp,[s[1]||(s[1]=u("header",{class:"quickprint-config-header"},"行模式",-1)),u("div",vp,[p(b(le),{options:l,modelValue:t.value,"onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),yp={class:"quickprint-config-section quickprint-config-inline"},_p={class:"quickprint-config-content"},Ep=F({__name:"TableRowConfig",props:{element:{type:Tn,required:!0}},setup(n){const e=n,t=[{label:"表头",value:At.HEADER},{label:"表体",value:At.BODY},{label:"表尾",value:At.FOOTER}],l=L({get(){return e.element.attributes.type??At.BODY},set(o){switch(o){case At.HEADER:e.element.asHeader();break;case At.FOOTER:e.element.asFooter();break;default:e.element.asBody()}}});return(o,s)=>(S(),I("section",yp,[s[1]||(s[1]=u("header",{class:"quickprint-config-header"},"行模式",-1)),u("div",_p,[p(b(le),{options:t,modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),class:"quickprint-w-full"},null,8,["modelValue"])])]))}}),Wn=Object.freeze({title:"表格",type:j.TABLE,icon:"icon-table",editor:gp,config:{attributes:bp,exclude:[fe.DISPLAY,fe.BASIC]},features:{draggable:!1,resizable:!1,contextMenu:!1},onCreate(){const n=[Nt,Nt,Nt],e=he.create({type:j.TABLE});return e.style.borderStyle=Q.SOLID,e.setColgroup(n),e.append(Tn.createDefault(n)),e.append(Tn.createDefault(n)),e.append(Tn.createDefault(n)),e.updateBoxSize(),e}}),qo=Object.freeze({title:"表格行",type:j.TABLE_ROW,icon:"icon-table-row",exposed:!1,editor:null,config:{exclude:[fe.POSITION,fe.COORD,fe.OVERFLOW],attributes:Ep}}),_l=Object.freeze({title:"单元格",type:j.TABLE_CELL,icon:"icon-table-cell",exposed:!1,editor:Ro,config:{exclude:[fe.POSITION,fe.COORD]}});class Tp{constructor(e){W(this,"__v_skip",!0);W(this,"observer");W(this,"callbacks",[]);W(this,"handler");this.handler=Xr((t,l)=>{for(const o of this.callbacks)o(t,l)},500),this.observer=new MutationObserver((t,l)=>this.handler(t,l)),this.observer.observe(e,{subtree:!0,childList:!0,characterData:!0,attributes:!0})}addListener(e){return typeof e!="function"||this.callbacks.findIndex(l=>l===e)>=0?!1:(this.callbacks.push(e),!0)}removeListener(e){const t=this.callbacks.findIndex(l=>l===e);return t<0?!1:(this.callbacks.splice(t,1),!0)}cleanup(){this.observer.disconnect(),this.callbacks=[]}}function Sp(n,e){switch(n){case"fontSize":return e===Re.DEFAULT?void 0:e;case"fontFamily":return e===re.DEFAULT?void 0:e;case"lineHeight":return e===Rt.DEFAULT?void 0:e;default:return e}}const Dl="texteditor-const-node",Rp=Object.freeze({CONST:0});class wp{constructor(e,t={}){W(this,"__v_skip",!0);W(this,"emitter",new In);W(this,"container");W(this,"options");W(this,"observer");W(this,"handleClick");this.container=e,this.container.contentEditable="plaintext-only",this.container.classList.add("quickprint-text-editor"),this.options=t,this.observer=new Tp(e),this.handleClick=this.onClick.bind(this),Reflect.defineProperty(this,"emitter",{configurable:!1,enumerable:!1,writable:!1,value:new In}),e.addEventListener("click",this.handleClick)}on(e,t){return this.emitter.on(e,t)}once(e,t){return this.emitter.once(e,t)}off(e,t){return this.emitter.off(e,t)}dispatch(e){return this.emitter.dispatch(e)}createEvent(e,t){return new ms(e,t)}watch(e){return this.observer.addListener(e),()=>{this.observer!=null&&this.observer.removeListener(e)}}cleanup(){this.container.removeEventListener("click",this.handleClick),this.observer.cleanup(),this.emitter.cleanup()}getHTML(){return this.container.innerHTML}setHTML(e){return console.log("TODO: 光标"),this.container.innerHTML=e,!0}clear(){return this.container.innerHTML="",!0}focus(){this.container.focus()}blur(){this.container.blur()}getSelection(){const e=this.container,t=window.getSelection();if(t==null||!e.contains(t.anchorNode)||!e.contains(t.focusNode))return null;const l=t.getRangeAt(0);return l==null?null:{selection:t,range:l}}hasSelection(){const e=this.getSelection();return e==null?!1:!e.selection.isCollapsed}normalize(){const e=this.container;for(let t=e.childNodes.length-1;t>=0;t--){const l=e.childNodes[t];if(me(l.textContent)){e.removeChild(l);continue}if(l instanceof HTMLElement){if(l.contentEditable==="false")continue;l.style.length===0&&l.replaceWith(l.textContent)}}return e.normalize(),e}updateHeight(){const e=this.container.scrollHeight;return this.dispatch(this.createEvent("resize",{height:e})),e}async autosize(){this.container.style.height="auto";const e=this.updateHeight();return await Mn(),this.container.style.removeProperty("height"),e}checkHeight(){const e=this.container;e.scrollHeight>e.clientHeight&&this.updateHeight()}createConstNode(e){const t=document.createElement("span");return t.contentEditable="false",t.innerText=`${e.label??e.value}`,t.className=Dl,t.dataset.value=e.value,t.dataset.type=e.type+"",t}focusAfterNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),t.collapseToEnd(),!0}focusNode(e){if(!this.container.contains(e))return!1;const t=window.getSelection();if(t==null)return!1;const l=new Range;return l.selectNode(e),t.removeAllRanges(),t.addRange(l),!0}focusNodes(e){if(e.length==0)return!1;if(e.length==1)return this.focusNode(e[0]);const t=window.getSelection();if(t==null)return!1;const l=new Range,o=e[0],s=e[e.length-1];return!this.container.contains(o)||!this.container.contains(s)?!1:(t.removeAllRanges(),l.setStartBefore(o),l.setEndAfter(s),t.addRange(l),!0)}insertNode(e,t){var g;const l=this.getSelection();if(l==null)return!1;const{selection:o,range:s}=l;if(o.isCollapsed!=!0&&o.deleteFromDocument(),o.isCollapsed!=!0)return!1;const r=o.anchorNode;if(r==null)return!1;const i=this.container,a=this.createConstNode(e);if(typeof(t==null?void 0:t.onCreateNode)=="function"&&t.onCreateNode(a),r.parentNode===i||(g=r.parentNode)!=null&&g.contains(i))return s.insertNode(a),this.normalize(),this.focusAfterNode(a),!0;const d=r.parentNode;if(d==null)return!1;const f=d.textContent;if(f==null)return!1;if(o.anchorOffset==f.length)return i.insertBefore(a,d.nextSibling),this.normalize(),this.focusAfterNode(a),!0;const h=document.createElement("span");return h.textContent=f.slice(0,o.anchorOffset),d instanceof HTMLElement&&(h.style.cssText=d.style.cssText),d.textContent=f.slice(o.anchorOffset),i.insertBefore(a,d),i.insertBefore(h,a),this.normalize(),this.focusAfterNode(a),!0}insertText(e){const t=this.getSelection();if(t==null)return!1;const{selection:l,range:o}=t;return l.isCollapsed||l.deleteFromDocument(),o.insertNode(document.createTextNode(e)),l.collapseToEnd(),this.normalize(),!0}normalizeRange(e){const t=this.container,l=e.startContainer,o=e.endContainer,s={};return l===t?(s.startNode=t.childNodes[e.startOffset],s.startOffset=-1):(s.startNode=l.parentNode==t?l:l.parentNode,s.startOffset=e.startOffset),o===t?(s.endNode=t.childNodes[e.endOffset],s.endOffset=-1):(s.endNode=o.parentNode==t?o:o.parentNode,s.endOffset=e.endOffset),s}findNodesBetween(e,t){const l=[];let o=e.nextSibling;for(;o!=null&&o!==t;)l.push(o),o=o.nextSibling;return l}inheritStyle(e,t){if(!(t instanceof HTMLElement))return!1;const l=t.style.cssText;return me(l)?!1:(e.style.cssText=l,!0)}extractNodesFromRange(){var f;const e=this.container,t=this.getSelection();if(t==null||t.selection.isCollapsed)return null;const o=t.range,{startNode:s,startOffset:r,endNode:i,endOffset:a}=this.normalizeRange(o);if(s===i){const h=s.textContent??"";if(s instanceof CharacterData){const _=document.createElement("span");return _.textContent=h.slice(r,a),o.deleteContents(),o.insertNode(_),[_]}const g=document.createElement("span");g.textContent=h.slice(0,r),this.inheritStyle(g,i);const y=document.createElement("span");return y.textContent=h.slice(r,a),this.inheritStyle(y,i),i.textContent=h.slice(a),e.insertBefore(y,i),e.insertBefore(g,y),[y]}const d=this.findNodesBetween(s,i);if(r>0){const h=s.textContent??"",g=document.createElement("span");g.textContent=h.slice(0,r),this.inheritStyle(g,s),s.textContent=h.slice(r),e.insertBefore(g,s)}if(a>=0&&a<=(((f=i.textContent)==null?void 0:f.length)??0)){const h=i.textContent??"";if(i instanceof HTMLElement){i.textContent=h.slice(0,a);const g=document.createElement("span");g.textContent=h.slice(a),this.inheritStyle(g,i),e.insertBefore(g,i.nextSibling),d.push(i)}else{const g=document.createElement("span");g.textContent=h.slice(0,a),e.replaceChild(g,i);const y=document.createTextNode(h.slice(a));e.insertBefore(y,i.nextSibling),d.push(g)}}return d.unshift(s),d}setStyle(e,t){const l=this.extractNodesFromRange();if(l==null||l.length==0)return!1;let o=!0;const s=jl(e),r=Sp(e,t);for(let i=0;i<l.length;i++){const a=l[i];if(a instanceof HTMLElement){this.matchElementStyle(a,s,r)||(o=!1);continue}const d=document.createElement("span");d.textContent=a.textContent,this.container.replaceChild(d,a),l[i]=d,o=!1}for(const i of l){if(o||r==null){this.removeElementStyle(i,s,r);continue}this.setElementStyle(i,s,r)}return this.focusNodes(l),!0}matchElementStyle(e,t,l){const o=e.style.getPropertyValue(t);return t==="text-decoration-line"?o.includes(l):o==l}setElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=Lt.push(o,l);e.style.setProperty("text-decoration-line",s);return}e.style.setProperty(t,l)}removeElementStyle(e,t,l){if(t==="text-decoration-line"){const o=e.style.getPropertyValue("text-decoration-line"),s=Lt.remove(o,l);me(s)?e.style.removeProperty("text-decoration-line"):e.style.setProperty("text-decoration-line",s);return}e.style.removeProperty(t)}onClick(e){const t=e.target;if(t instanceof HTMLElement&&t.matches("."+Dl)){e.preventDefault(),e.stopPropagation(),this.focusNode(t);return}}}const kp=F({__name:"ParagraphEditor",props:{element:{type:gs,required:!0}},setup(n){const e=n,t=Ce(),l=ge(),o=L(()=>e.element.isSelected!==!0?!1:t.state.selectMode===it.SINGLE);let s=null;const r=L(()=>Hn.map(k=>(k.style={fontFamily:k.value==re.DEFAULT?re.SONG:k.value},k)));function i(){}async function a(){if(s==null)return;const k=await vl({doc:t.doc}).catch(lt);if(k==null)return;const $=at(k.value,t.doc.ds)??k.value,B={type:Rp.CONST,value:k.value,label:$};s.insertNode(B)}function d(){s==null||s.blur()}function f(){s==null||s.autosize()}function h(k){const $=e.element.ds.value,B=new wp(k);return B.on("resize",q=>{var D;const A=(D=q.detail)==null?void 0:D.height;A!=null&&e.element.setHeight(A+2)}),B.watch(()=>{const q=B.getHTML(),A=e.element.ds.value;q!==A&&(e.element.ds.value=q,B.checkHeight())}),me($)||B.setHTML($),B}function g(k){s==null||s.setStyle("fontFamily",k.value)}function y(k){s==null||s.setStyle("fontSize",k.value)}function _(k){s==null||s.setStyle("lineHeight",k.value)}function c(k){s==null||s.setStyle("backgroundColor",k)}function v(k){s==null||s.setStyle("color",k)}function E(){s==null||s.setStyle("fontWeight","700")}function x(){s==null||s.setStyle("fontStyle","italic")}function C(){s==null||s.setStyle("textDecorationLine","underline")}function O(){s==null||s.setStyle("textDecorationLine","line-through")}return fl(()=>e.element.ds.value,k=>{s==null||s.getHTML()==k||s.setHTML(k)}),pn(()=>{e.element.on("blur",d),s=h(l.value)}),dl(()=>{e.element.off("blur",d),s&&s.cleanup()}),(k,$)=>(S(),I("div",{class:m(k.classes.paragraph),onPointerdown:$[2]||($[2]=se(()=>{},["stop"])),onContextmenu:se(i,["stop","prevent"])},[u("div",{class:m(k.classes.indicator),onPointerdown:$[0]||($[0]=(...B)=>b(t).onDragStart&&b(t).onDragStart(...B)),title:"选中/拖动段落"},null,34),o.value?(S(),I("div",{key:0,class:m(k.classes.toolbar),onMousedown:$[1]||($[1]=se(()=>{},["prevent"]))},[p(b(le),{onSelect:g,title:"字体",width:"60px",options:r.value,class:m(k.classes.tool),button:""},null,8,["options","class"]),p(b(le),{onSelect:y,title:"字号",width:"60px",options:b(yl),class:m(k.classes.tool),button:""},null,8,["options","class"]),p(b(le),{onSelect:_,title:"行高",width:"60px",options:b(Lo),class:m(k.classes.tool),popoverWidth:120,button:""},null,8,["options","class"]),u("div",{class:m(k.classes.divider)},null,2),p(b(Ut),{class:m(k.classes.tool),onSelect:c},{default:_e(()=>[u("div",{class:m(k.classes.colorIcon),title:"突出显示"},[p(b(U),{icon:"icon-bg-color-b",size:"15px"}),u("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),p(b(Ut),{class:m(k.classes.tool),onSelect:v},{default:_e(()=>[u("div",{class:m(k.classes.colorIcon),title:"字体颜色"},[p(b(U),{icon:"icon-font",size:"15px"}),u("div",{class:m(k.classes.colorIndicator)},null,2)],2)]),_:1},8,["class"]),u("button",{onClick:E,type:"button",title:"加粗",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-font-bold",size:"16px"})],2),u("button",{onClick:x,type:"button",title:"斜体",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-italic",size:"16px"})],2),u("button",{onClick:C,type:"button",title:"下划线",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-underline",size:"16px"})],2),u("button",{onClick:O,type:"button",title:"删除线",class:m(["quickprint-text-btn",k.classes.tool])},[p(b(U),{icon:"icon-through-line",size:"16px"})],2),u("div",{class:m(k.classes.divider)},null,2),u("button",{class:"quickprint-text-btn",type:"button",onClick:a},[p(b(U),{icon:"icon-insert-var",size:"16px"}),$[3]||($[3]=u("span",null,"插入变量",-1))]),u("button",{class:"quickprint-text-btn",type:"button",onClick:f},[p(b(U),{icon:"icon-colum-height",size:"16px"}),$[4]||($[4]=u("span",null,"调整高度",-1))])],34)):Y("",!0),u("div",{ref_key:"editorRef",ref:l,class:m(k.classes.editor)},null,2)],34))}}),Lp="_paragraph_1v2pj_2",Cp="_indicator_1v2pj_6",Ip="_editor_1v2pj_18",Op="_toolbar_1v2pj_44",Np="_tool_1v2pj_44",xp="_colorIcon_1v2pj_66",Dp="_colorIndicator_1v2pj_86",Mp="_divider_1v2pj_95",Ap={paragraph:Lp,indicator:Cp,editor:Ip,toolbar:Op,tool:Np,colorIcon:xp,colorIndicator:Dp,divider:Mp},Bp={classes:Ap},$p=H(kp,[["__cssModules",Bp]]),Yn=Object.freeze({title:"段落",type:j.PARAGRAPH,icon:"icon-paragraph",features:{draggable:!1,contextMenu:!1},editor:$p,config:{exclude:[fe.DATASOURCE,fe.BASIC,fe.OVERFLOW]},onCreate(){return he.create({type:j.PARAGRAPH,width:Nt*4,height:qn*6})}}),Po=[Fn,zn,Un,Wn,_l,qo,Yn],qp=[Fn,zn,Un,Wn,Yn],Pp={[j.TEXT]:Fn.editor,[j.NUMBER]:zn.editor,[j.DATE]:Un.editor,[j.TABLE]:Wn.editor,[j.TABLE_CELL]:_l.editor,[j.PARAGRAPH]:Yn.editor},Vp={[j.TEXT]:Fn.config,[j.NUMBER]:zn.config,[j.DATE]:Un.config,[j.TABLE]:Wn.config,[j.TABLE_CELL]:_l.config,[j.TABLE_ROW]:qo.config,[j.PARAGRAPH]:Yn.config},Kt=Po.reduce((n,e)=>(n[e.type]=e,n),{});function Fp(n){const e=Po.find(t=>t.type===n);if(e==null||typeof e.onCreate!="function")throw new Error("未知的打印元素");return e.onCreate()}function zp(n){return Reflect.get(Pp,n)}function nn(n){return Reflect.get(Vp,n)}function dn(n){var e;return((e=Kt[n])==null?void 0:e.title)??n}function Up(n){var e;return(e=Kt[n])==null?void 0:e.icon}function Hp(n){var e,t;return((t=(e=Kt[n])==null?void 0:e.features)==null?void 0:t.selection)!==!1}function Gp(n){var e,t;return((t=(e=Kt[n])==null?void 0:e.features)==null?void 0:t.contextMenu)!==!1}function Wp(n){var e,t;return((t=(e=Kt[n])==null?void 0:e.features)==null?void 0:t.resizable)!==!1}function Yp(n){var e,t;return((t=(e=Kt[n])==null?void 0:e.features)==null?void 0:t.draggable)!==!1}function Ml(n,e,t,l){const[o,s]=e.top>t.top?[t,e]:[e,t],r=o.top-l.top,i=s.bottom-o.top;return{top:r,left:n,height:i}}function Al(n,e,t,l){const[o,s]=e.left>t.left?[t,e]:[e,t],r=o.left-l.left,i=s.right-o.left;return{top:n,left:r,width:i}}function Bl(n,e){const t=n.find(a=>a.left===e.left);if(t==null||t.height==null)return n.push(e);const l=e.top+e.height,o=t.top+t.height,s=Math.min(t.top,e.top),i=Math.max(l,o)-s;t.top=s,t.height=i}function $l(n,e){const t=n.find(a=>a.top===e.top);if(t==null||t.width==null)return n.push(e);const l=e.left+e.width,o=t.left+t.width,s=Math.min(t.left,e.left),i=Math.max(l,o)-s;t.left=s,t.width=i}function Xp(n){const e=document.createElement("div");return n.appendChild(e),e}function jp(n,e){const t=[...e.querySelectorAll(":scope ."+J.GUIDE_LINE)];for(const l of n){const o=t.shift()??Xp(e);o.className=J.GUIDE_LINE,o.style.top=l.top+"px",o.style.left=l.left+"px",o.style.height=(l.height??1)+"px",o.style.width=(l.width??1)+"px"}for(const l of t)l.remove()}function Zp(n,e){const l=e.querySelectorAll(":scope ."+J.ELEMENT),o=e.getBoundingClientRect(),s=n.getBoundingClientRect(),r=[];for(const i of l){if(n==i)continue;const a=i.getBoundingClientRect();if(Math.abs(s.left-a.left)<=1||Math.abs(s.right-a.left)<=1){const d=a.left-o.left;Bl(r,Ml(d,s,a,o))}if(Math.abs(s.left-a.right)<=1||Math.abs(s.right-a.right)<=1){const d=a.right-o.left;Bl(r,Ml(d,s,a,o))}if(Math.abs(s.top-a.top)<=1||Math.abs(s.bottom-a.top)<=1){const d=a.top-o.top;$l(r,Al(d,s,a,o))}if(Math.abs(s.bottom-a.bottom)<=1||Math.abs(s.top-a.bottom)<=1){const d=a.bottom-o.top;$l(r,Al(d,s,a,o))}}jp(r,e)}function Kp(){const n=document.querySelectorAll("."+J.GUIDE_LINE);for(const e of n)e.remove()}const Dn={create:jr(Zp,50),clean:Kp};async function Jp(n){await Mn(),n&&Reflect.deleteProperty(n,$n)}async function Qp(n,e){if(await Promise.resolve(),e.dropTarget==null){e.indicatorElement&&(e.indicatorElement.style.display="none");return}if(e.indicatorElement==null){const s=document.createElement("div");s.className="quickprint-is-indicator",e.indicatorElement=s,document.body.appendChild(s)}const t=em(n,e);if(t==null){e.indicatorElement.style.display="none";return}const l=e.indicatorElement,o=e.ghost.getBoundingClientRect();l.style.display="block",l.style.left=o.left+"px",l.style.top=o.top-co(e.element)+"px",l.textContent=`x:${t.x},y:${t.y},w:${t.w},h:${t.h}`}function em(n,e){const t=e.dropTarget;if(t==null)return null;const l=n.doc.useGrid;if(e.mode===Fe.INSERT){const o=t.closest("."+J.PAGE);if(o==null)return null;const s=o.getBoundingClientRect();return{x:l?qt(e.left-s.left):Math.round(e.left-s.left),y:l?qt(e.top-s.top):Math.round(e.top-s.top),w:e.element.width,h:e.element.height}}return{x:l?qt(e.left):Math.round(e.left),y:l?qt(e.top):Math.round(e.top),w:e.element.width,h:e.element.height}}function tm(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;const r=document.getElementById(s.id);r!=null&&(r.style.left=s.left+l+"px",r.style.top=s.top+o+"px")}}function nm(n,e){const t=n.getSelectedElements();if(t.length<2)return;const l=e.diffX??0,o=e.diffY??0;for(const s of t){if(s.id===e.element.id)continue;s.setLeft(s.left+l),s.setTop(s.top+o);const r=document.getElementById(s.id);r==null||r.style.removeProperty("top"),r==null||r.style.removeProperty("left")}}function lm(n){return!(n.style.rotate&&!n.isSelected)}function om(n){const e=new ll({selector:{container:J.DROPPABLE},scale(t){return t.mode===Fe.INSERT?100:n.state.scale}});return e.on("before-dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,no),s=Reflect.get(l.target,pl);o===Fe.INSERT&&(l.container=n.component.queryElement("root"),l.ghost=n.component.queryElement("ghost")),l.mode=o===Fe.INSERT?o:Fe.MOVE,l.elementType=s,l.initDragElement=!1}),e.on("dragstart",t=>{const l=t.detail;if(l==null)return t.preventDefault();if(l.mode===Fe.INSERT){const s=Fp(l.elementType);l.element=s,l.ghost.style.width=s.width+"px",l.ghost.style.height=s.height+"px";return}const o=Reflect.get(l.target,je);if(o==null||!lm(o))return t.preventDefault();l.element=o}),e.on("dragging",t=>{const l=t.detail;l!=null&&(l.initDragElement!==!0&&(l.mode===Fe.INSERT&&(l.ghost.style.display="block"),l.mode===Fe.MOVE&&Reflect.set(l.target,$n,ml.DRAG_ELEMENT),l.ghost.classList.add(J.DRAGGING),l.initDragElement=!0),l.diffX=l.left-l.element.left,l.diffY=l.top-l.element.top,Qp(n,l),tm(n,l),l.dropTarget&&Dn.create(l.ghost,l.dropTarget))}),e.on("dragend",t=>{const l=t.detail;if(l==null||l.initDragElement!==!0)return;Dn.clean(),l.ghost.classList.remove(J.DRAGGING),l.indicatorElement&&document.body.removeChild(l.indicatorElement),l.mode===Fe.INSERT&&(l.ghost.style.display="none"),l.mode==Fe.MOVE&&Jp(l.target);const o=l.element;if(l.mode==Fe.MOVE){const d=o.left,f=o.top;o.setTop(l.top),o.setLeft(l.left),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.diffX=o.left-d,l.diffY=o.top-f,nm(n,l),n.selectElement(o),n.createSnapshot();return}if(l.dropTarget==null)return;const s=Reflect.get(l.dropTarget,lo);if(s==null)return;const r=s instanceof xt||s instanceof he?s:null;if(r==null)return;const i=l.dropTarget.getBoundingClientRect(),a=n.state.scale/100;o.setTop((l.top-i.top)/a),o.setLeft((l.left-i.left)/a),o.setWidth(o.width/a),o.setHeight(o.height/a),r.append(l.element),n.selectElement(o),n.createSnapshot()}),n.onDragStart=e.onDragStart,e}const ql="quickprint-history-0000",sm=1,ut="snapshot",wn="health",Pl="owner",tt="INDEX_OWNER",im=15*60*1e3,rm=10*60*1e3;function am(){const n={db:null,timer:null,promise:null};async function e(){const f=await a(wn,"readwrite");if(f==null)return n.timer=s(),!1;const h=[],g=f.openCursor();g.onsuccess=async function(y){const _=y.target.result;if(_==null){t(h),n.timer=s(),ze.debug("History","已检查无效快照");return}const c=_.value;c!=null&&Date.now()-c.timestamp>im&&h.push(c),_.continue()},g.onerror=function(y){console.error(y),n.timer=s()}}async function t(f){const h=await Promise.allSettled(f.map(g=>l(g.owner)));for(let g=0;g<h.length;g++){const y=h[g];y.status==="rejected"||y.value!==!0||o(f[g].id)}}async function l(f){const h=await a(ut,"readwrite");return h==null?!1:new Promise(g=>{const y=h.index(tt).openCursor(IDBKeyRange.only(f));y.onsuccess=function(_){const c=_.target.result;if(c==null)return g(!0);c.delete(),c.continue()},y.onerror=function(_){console.error(_),g(!1)}})}async function o(f){const h=await a(wn,"readwrite");return h==null?!1:rn(h.delete(f)).then(()=>!0).catch(g=>(console.log(g),!1))}function s(){return n.timer&&clearTimeout(n.timer),setTimeout(()=>e(),rm)}function r(){return new Promise(f=>{const h=indexedDB.open(ql,sm);h.onupgradeneeded=g=>{const _=g.target.result,c=_.createObjectStore(wn,{keyPath:"id",autoIncrement:!0}),v=_.createObjectStore(ut,{keyPath:"id",autoIncrement:!0});c.createIndex(tt,Pl),v.createIndex(tt,Pl)},h.onsuccess=g=>{const y=g.target;n.db=y.result,ze.debug("History",`已连接数据库【${ql}】`),f(n.db)},h.onerror=function(g){console.error(g),n.db=null,f(null)}})}function i(){return n.promise==null?Promise.resolve(n.db):n.promise}async function a(f,h="readonly"){const g=await i();if(g==null)return null;try{return g.transaction(f,h).objectStore(f)}catch(y){return console.error(y),null}}function d(){n.promise=null,n.db&&(n.db.close(),n.db=null),n.timer&&(clearTimeout(n.timer),n.timer=null)}return n.promise=r(),n.timer=s(),e(),{ready:i,findStore:a,cleanup:d}}function rn(n){return new Promise((e,t)=>{n.onsuccess=function(l){const o=l.target;e(o.result)},n.onerror=function(l){console.error(l),t()}})}const cm=5*60*1e3,Tt=am();var nt,Ge,kn,rl,Vo;class um{constructor(e,t={}){Qe(this,Ge);W(this,"state");W(this,"owner");Qe(this,nt);this.state=e,this.owner=t.owner??hs(vs.HISTORY_OWNER),$e(this,Ge,rl).call(this)}get index(){return this.state.index}get count(){return this.state.count}async createSnapshot(e,t){const l=await Tt.findStore(ut,"readwrite");if(l==null)return!1;await $e(this,Ge,Vo).call(this,l);const o=this.state.index+1,s={index:o,data:JSON.stringify(e),timestamp:Date.now(),owner:this.owner,action:t==null?void 0:t.action};return await rn(l.put(s)).catch(lt)==null?!1:(this.state.index=o,this.state.count=o+1,!0)}async replaceSnapshot(e,t){const l=await this.getCurrentSnapshot();if(l==null||l.action!==t.action)return this.createSnapshot(e,t);const o=await Tt.findStore(ut,"readwrite");return!(o==null||(l.data=JSON.stringify(e),await rn(o.put(l)).catch(lt)==null))}async getCurrentSnapshot(){const e=await Tt.findStore(ut);if(e==null)return null;const t=this.index;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(tt).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return o(a);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getPrevSnapshot(){const e=await Tt.findStore(ut);if(e==null)return null;const t=this.state.index-1;if(t<0)return null;const l=this.owner;return new Promise(o=>{const s=e.index(tt).openCursor(IDBKeyRange.only(l),"prev");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getNextSnapshot(){const e=await Tt.findStore(ut);if(e==null)return null;const t=this.state.index+1;if(t>this.state.count-1)return null;const l=this.owner;return new Promise(o=>{const s=e.index(tt).openCursor(IDBKeyRange.only(l),"next");s.onsuccess=r=>{const i=r.target.result;if(i==null)return o(null);const a=i.value;if(a.owner!=l)return i.continue();if(a.index==t)return this.state.index=t,o(i.value);i.continue()},s.onerror=function(r){console.error(r),o(null)}})}async getUsageSpace(){const e=await navigator.storage.estimate(),t=e.usage;return t==null?null:{usage:t/1024/1024,percent:e.quota?t/e.quota*100:-1}}async list(){const e=await Tt.findStore(ut);if(e==null)return[];const t=this.owner;return new Promise(l=>{const o=e.index(tt).openCursor(IDBKeyRange.only(t),"prev"),s=[];o.onsuccess=r=>{const i=r.target.result;if(i==null)return l(s);const a=i.value;if(a.owner!=t)return i.continue();s.push(a),i.continue()},o.onerror=function(r){console.error(r),l([])}})}cleanup(){Be(this,nt)&&(clearTimeout(Be(this,nt)),yt(this,nt,null))}}nt=new WeakMap,Ge=new WeakSet,kn=function(){yt(this,nt,setTimeout(()=>$e(this,Ge,rl).call(this),cm))},rl=async function(){Be(this,nt)&&clearTimeout(Be(this,nt));const e=await Tt.findStore(wn,"readwrite");if(e==null)return $e(this,Ge,kn).call(this);const t=await rn(e.index(tt).get(this.owner)).catch(lt);if(t==null){const l={owner:this.owner,timestamp:Date.now()};return e.add(l),$e(this,Ge,kn).call(this)}t.timestamp=Date.now(),await rn(e.put(t)).catch(lt),$e(this,Ge,kn).call(this)},Vo=function(e){const t=this.state.index,l=this.state.count;if(t<0||t==l-1)return Promise.resolve(!0);const o=this.owner;return new Promise(s=>{const r=e.index(tt).openCursor(IDBKeyRange.only(o),"prev");r.onsuccess=function(i){const a=i.target.result;if(a==null)return s(!0);const d=a.value;if(d.owner!=o)return a.continue();if(d.index>t){a.delete(),a.continue();return}s(!0)},r.onerror=function(i){console.error(i),s(!1)}})};function dm(n){const e=new um(Oe({index:-1,count:0}));function t(){return e.index>0}function l(){return e.index>=0&&e.index<e.count-1}function o(f){return e.createSnapshot(n.value,f)}function s(f){return e.replaceSnapshot(n.value,f)}async function r(){const f=await e.getPrevSnapshot();if(f==null)return!1;const h=On(f.data);return h==null?!1:(n.value=Ee.create(h),!0)}async function i(){const f=await e.getNextSnapshot();if(f==null)return!1;const h=On(f.data);return h==null?!1:(n.value=Ee.create(h),!0)}function a(){return e.list()}function d(){e.cleanup()}return o(),{allowRedo:l,allowUndo:t,createSnapshot:o,undo:r,redo:i,list:a,cleanup:d,replaceSnapshot:s}}class fm{constructor(e){W(this,"moved",!1);W(this,"position");W(this,"top",0);W(this,"left",0);W(this,"width",0);W(this,"height",0);W(this,"initX",0);W(this,"initY",0);W(this,"indicator");W(this,"container");W(this,"originalEvent");W(this,"target");this.indicator=e.indicator,this.container=e.container,this.target=e.target,this.originalEvent=e.event,this.position=e.position,this.initX=e.event.clientX,this.initY=e.event.clientY}init(e=1){const t=this.target.getBoundingClientRect(),l=this.container.getBoundingClientRect();this.top=(t.top-l.top)/e,this.left=(t.left-l.left)/e,this.width=t.width/e,this.height=t.height/e,this.indicator.setPointerCapture(this.originalEvent.pointerId)}}var Wt,Yt,ht,Fo,zo,Uo;const Me=class Me extends In{constructor(t={}){var l,o,s;super();Qe(this,ht);W(this,"context",null);W(this,"selector");W(this,"scale");W(this,"onResizeStart");Qe(this,Wt);Qe(this,Yt);this.scale=t.scale,this.selector={container:((l=t.selector)==null?void 0:l.container)??J.PAGE,element:((o=t.selector)==null?void 0:o.element)??J.RESIZEABLE,indicator:((s=t.selector)==null?void 0:s.indicator)??J.RESIZEABLE_INDICATOR},this.onResizeStart=$e(this,ht,Fo).bind(this),yt(this,Wt,$e(this,ht,zo).bind(this)),yt(this,Yt,$e(this,ht,Uo).bind(this))}normalizeScale(){if(this.scale==null)return 1;const t=typeof this.scale=="function"?this.scale(this.context):this.scale;return t<=0?1:t/100}reset(){if(this.context==null)return;const t=this.context.indicator;t&&t.releasePointerCapture(this.context.originalEvent.pointerId),window.removeEventListener("pointermove",Be(this,Wt)),window.removeEventListener("pointerup",Be(this,Yt)),this.context=null}};Wt=new WeakMap,Yt=new WeakMap,ht=new WeakSet,Fo=function(t){if(t.button!==0)return;const l=t.target.closest("."+this.selector.indicator);if(l==null)return ze.warn(Me.TAG_NAME,"未找到的可调整元素");const o=Reflect.get(l,oo);if(o==null)return ze.warn(Me.TAG_NAME,"未找到的可调整元素");const s=l.closest("."+this.selector.element);if(s==null)return ze.warn(Me.TAG_NAME,"未找到的可调整元素");const r=ao(s,this.selector.container);this.context=new fm({event:t,indicator:l,target:s,container:r,position:o});const i=this.createEvent("before-resizestart",this.context);if(this.dispatch(i).defaultPrevented)return ze.warn(Me.TAG_NAME,"已取消调整");if(this.context.container==null)return ze.warn(Me.TAG_NAME,"未找到的调整元素的容器");this.context.init(this.normalizeScale()),t.stopPropagation(),t.preventDefault();const a=this.createEvent("resizestart",this.context);if(this.dispatch(a).defaultPrevented)return ze.warn(Me.TAG_NAME,"已取消调整");window.addEventListener("pointermove",Be(this,Wt)),window.addEventListener("pointerup",Be(this,Yt))},zo=function(t){const l=this.context;if(l==null)return;const o=l.position,s=this.normalizeScale(),r=l.container.getBoundingClientRect(),i=l.target.getBoundingClientRect();if(o&sn.TOP){const d=Math.max((i.bottom-t.clientY)/s,Me.MIN_LENGTH);l.top=(i.bottom-r.top)/s-d,l.height=d}if(o&sn.BOTTOM&&(l.height=Math.max((t.clientY-i.top)/s,Me.MIN_LENGTH)),o&sn.LEFT){const d=Math.max((i.right-t.clientX)/s,Me.MIN_LENGTH);l.left=(i.right-r.left)/s-d,l.width=d}o&sn.RIGHT&&(l.width=Math.max((t.clientX-i.left)/s,Me.MIN_LENGTH));const a=this.createEvent("resizing",l);this.dispatch(a).defaultPrevented||(l.target.style.top=l.top+"px",l.target.style.left=l.left+"px",l.target.style.width=l.width+"px",l.target.style.height=l.height+"px")},Uo=function(t){const l=this.context;if(l==null)return;t.preventDefault(),l.originalEvent=t;const o=this.createEvent("resizeend",l);this.dispatch(o).defaultPrevented||this.reset()},W(Me,"TAG_NAME","quickprint-resizeable"),W(Me,"MIN_LENGTH",12);let al=Me;async function pm(n,e){if(await Promise.resolve(),e.indicatorElement==null){const i=document.createElement("div");i.className="quickprint-is-indicator",e.indicatorElement=i,document.body.appendChild(i)}const t=n.doc.useGrid,l=t?qt(e.width):Math.round(e.width),o=t?qt(e.height):Math.round(e.height),s=e.indicatorElement,r=e.target.getBoundingClientRect();s.style.display="block",s.style.left=r.left+"px",s.style.top=r.top-co(e.element)+"px",s.textContent=`x:${e.top},y:${e.left},w:${l},h:${o}`}function mm(n){const e=new al({scale:()=>n.state.scale});return e.on("resizestart",t=>{const l=t.detail;if(l==null)return t.preventDefault();const o=Reflect.get(l.target,je);if(o==null)return t.preventDefault();l.element=o}),e.on("resizing",t=>{const l=t.detail;l!=null&&(pm(n,l),Dn.create(l.target,l.container))}),e.on("resizeend",t=>{const l=t.detail;if(l==null)return;l.indicatorElement&&document.body.removeChild(l.indicatorElement);const o=l.element;o.setTop(l.top),o.setLeft(l.left),o.setWidth(l.width),o.setHeight(l.height),l.target.style.removeProperty("top"),l.target.style.removeProperty("left"),l.target.style.removeProperty("width"),l.target.style.removeProperty("height"),n.createSnapshot(),Dn.clean()}),n.onResizeStart=e.onResizeStart,e}function gm(n){function e(r){const i=document.activeElement,a=r.target;return i instanceof HTMLInputElement||i instanceof HTMLTextAreaElement||i.isContentEditable===!0||a.closest(".quickprint-text-editor")!=null}function t(){const r=n.doc.firstPage;if(n.state.selectMode===ue.PAGE){const i=n.state.selectedPage;return i==null?r:n.doc.findPage(i)??r}if(n.state.selectMode===ue.ELEMENT){const i=n.getSelectedElements()[0];return i==null?r:i.page??r}return r}function l(r){if(!(e(r)||bs()))switch(r.key){case"Delete":case"Backspace":return r.preventDefault(),n.deleteSelectedElement();case"Y":case"y":if(r.ctrlKey)return r.preventDefault(),n.history.redo();case"Z":case"z":if(r.ctrlKey)return r.preventDefault(),n.history.undo();case"ArrowUp":case"ArrowDown":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowUp"?-1:1,d=i.map(f=>f.setTop(f.top+a,!0)?f:null).filter(f=>f!=null);d.length>0&&n.replaceSnapshot("top",d);return}case"ArrowLeft":case"ArrowRight":{const i=n.getSelectedElements();if(i.length==0)return;r.preventDefault(),r.stopPropagation();const a=r.key==="ArrowLeft"?-1:1,d=i.map(f=>f.setLeft(f.left+a,!0)?f:null).filter(f=>f!=null);d.length>0&&n.replaceSnapshot("left",d);return}case"P":case"p":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("preview");case"S":case"s":if(r.ctrlKey)return r.preventDefault(),n.component.dispatchEvent("save");case"A":case"a":if(r.ctrlKey){r.preventDefault();const a=n.doc.pages.reduce((d,f)=>d.concat(f.children),[]);return n.multiSelectElements(a)}case"C":case"c":{const i=n.getSelectedElements();if(r.ctrlKey&&i.length>0)return r.preventDefault(),n.clipboard.writeElement(i)}case"V":case"v":if(r.ctrlKey)return n.clipboard.readElement().then(i=>{if(i.length==0)return;const a=t();for(const d of i)d.setLeft(d.left+8),d.setTop(d.top+8),a.append(d);n.createSnapshot()})}}function o(){window.addEventListener("keydown",l)}function s(){window.removeEventListener("keydown",l)}return{enable:o,disable:s}}const vn="openprint:element,";function hm(n){function e(){return navigator.clipboard.readText().catch(a=>(console.log(a),null))}function t(a){return navigator.clipboard.writeText(a).catch(d=>{console.log(d)})}async function l(){const a=await e();if(a==null||!a.startsWith(vn))return[];t("");const d=On(_s(a.slice(vn.length)),[]);return d.length===0?[]:d.map(f=>(delete f.id,he.create(f))).sort(he.sort)}function o(a){const d=`${vn}${ys(JSON.stringify(a))}`;return t(d)}async function s(){const a=await e();return typeof a=="string"&&a.startsWith(vn)}function r(){}function i(a){}return{readElement:l,writeElement:o,hasElement:s,readStyle:r,writeStyle:i}}const Ho=Symbol();function vm(){return{panel:{left:!0,right:!0},scale:100,selectedType:ue.NONE,selectedPage:void 0,selectMode:it.SINGLE,selected:[]}}function bm(n,e){const t=Oe(vm()),l=dm(n),s={get doc(){return n.value},history:l,document:n,state:t,component:e,setDocument:a,selectPage:h,selectElement:g,resetSelectedElement:y,deleteSelectedElement:_,multiSelectElements:c,toggleMultiSelectedElement:v,isSingleSelectedElement:B,isNoSelectedElement:q,zoomIn:x,zoomOut:E,toggleBackground:C,toggleElementPanel:O,toggleConfigPanel:k,getSelectedElements:d,getSelectedPage:f,cleanup:A,replaceSnapshot:$},r=om(s),i=mm(s);s.shortcut=gm(s),s.createSnapshot=l.createSnapshot,s.clipboard=hm();function a(D){s.document.value=D,s.history.createSnapshot()}function d(D){if(s.state.selectedType!==ue.ELEMENT)return[];const N=t.selected;if(N.length==0)return[];const M=N.map(T=>s.doc.findElement(T)).filter(T=>T!=null);return D==null?M:M.filter(T=>D.contains(T))}function f(){var N;const D=t.selectedPage;if(D!=null)return(N=n.value)==null?void 0:N.findPage(D)}function h(D){return y(),t.selectedPage=D.id,t.selectedType=ue.PAGE,!0}function g(D){t.selectMode=it.SINGLE,t.selectedType=ue.ELEMENT,t.selectedPage=void 0;const N=d();for(const M of N)M.id!==D.id&&M.blur();return D.focus(),t.selected=[D.id],!0}function y(){const D=d();for(const N of D)N.blur();return t.selected=[],t.selectedType=ue.NONE,!0}function _(){if(t.selectedType!=ue.ELEMENT||t.selected.length==0)return!1;let D=!1;const N=d();for(const M of N)M.remove()&&(D=!0);return D&&s.history.createSnapshot(),!0}function c(D){t.selectMode=it.MULTIPLE,t.selectedType=ue.ELEMENT,t.selectedPage=void 0;const N=d(),M=[];for(const T of N){if(D.some(R=>R.id===T.id)){M.push(T.id);continue}T.blur()}for(const T of D)M.includes(T.id)||T.focus();return t.selected=D.map(T=>T.id),!0}function v(D){let N=d();const M=N.findIndex(T=>T.id===D.id);return(D.type===j.TABLE_CELL&&N.some(T=>T.type!==j.TABLE_CELL)||D.type!==j.TABLE_CELL&&N.some(T=>T.type===j.TABLE_CELL))&&(N=[]),M>=0?N.splice(M,1):N.push(D),c(N)}function E(){const D=t.scale??100,N=en.indexOf(D);return N<0?(t.scale=100,!1):N>=en.length-1?!1:(t.scale=en[N+1],!0)}function x(){const D=t.scale??100,N=en.indexOf(D);return N<0?(t.scale=100,!1):N==0?!1:(t.scale=en[N-1],!0)}function C(){const N=s.doc.attributes.grid==null?!0:void 0;s.doc.attributes.grid=N}function O(){s.state.panel.left=!s.state.panel.left}function k(){s.state.panel.right=!s.state.panel.right}function $(D,N){const M=N??s.doc,T=Array.isArray(M)?"element":M instanceof Ee?"document":M instanceof xt?"page":"element",R=Array.isArray(M)?M.map(V=>V.id).join(","):M.id,w=`${T}:${R}:${D}`;return l.replaceSnapshot({action:w})}function B(){return s.state.selectedType!==ue.ELEMENT?!1:s.state.selectMode==it.SINGLE||s.state.selectMode==it.MULTIPLE&&s.state.selected.length==1}function q(){return s.state.selectedType!==ue.ELEMENT?!0:s.state.selected.length==0}function A(){r.cleanup(),i.cleanup(),l.cleanup(),s.shortcut.disable(),s.doc.cleanup()}return s.shortcut.enable(),s.selectPage(n.value.firstPage),eo(Ho,s),dl(A),s}function Ce(){return Ql(Ho)}const ym=F({__name:"Ruler",props:{direction:{type:String,default:"horizontal"},canvas:{type:Object,required:!0},page:{type:Object,required:!0},scale:{type:Number,default:100}},setup(n){const e=n,t=Ne("classes"),l=Ce(),o=L(()=>({[t.horizontalRuler]:e.direction==="horizontal",[t.verticalRuler]:e.direction==="vertical"})),s=L(()=>{const c=e.page.id,v=l.doc.pages.find(E=>E.id===c);return v==null?0:e.direction=="horizontal"?v.width:v.height}),r=L(()=>{const c=s.value,v=[];for(let E=0;E<=c;E+=10)v.push(E/10);return v}),i=L(()=>{const c=s.value,v=[];for(let E=0;E<=c;E+=2.5)v.push(E);return v}),a=L(()=>{const c=l.getSelectedElements();return c.length==1?c[0]:null}),d=L(()=>e.direction==="horizontal"?{height:"100%",width:s.value*e.scale/100+"mm",left:e.page.left+"px",transform:`translateX(${-e.canvas.scrollLeft}px)`}:{width:"100%",height:s.value*e.scale/100+"mm",top:e.page.top+"px",transform:`translateY(${-e.canvas.scrollTop}px)`}),f=L(()=>{const c=a.value;if(c==null)return 0;if(c.type==="TableCell"){const v=c.parent;if(v==null)return 0;const E=v.parent;return v==null?0:E.top+v.offsetTop}if(c.type==="TableRow"){const v=c.parent;return v==null?0:v.top+c.offsetTop}return c.top}),h=L(()=>{const c=a.value;if(c==null)return 0;if(c.type==="TableCell"){const v=c.parent;if(v==null)return 0;const E=v.parent;return v==null?0:E.left+c.offsetLeft}if(c.type==="TableRow"){const v=c.parent;return v==null?0:v.left}return c.left});function g(c,v){return e.direction==="horizontal"?{left:c*(e.scale/100)+"mm",height:(v-2)%4==0?"8px":"4px"}:{top:c*(e.scale/100)+"mm",width:(v-2)%4==0?"8px":"4px"}}function y(c){return e.direction==="horizontal"?{left:c*(e.scale/100)+"cm"}:{top:c*(e.scale/100)+"cm"}}function _(c){return e.direction==="horizontal"?{left:h.value*(e.scale/100)+"px",width:c.width*(e.scale/100)+"px",height:"100%"}:{top:f.value*(e.scale/100)+"px",height:c.height*(e.scale/100)+"px",width:"100%"}}return(c,v)=>(S(),I("div",{class:m(o.value)},[u("div",{class:m(b(t).ruler),style:Z(d.value)},[a.value?(S(),I("div",{key:0,class:m(b(t).selected),style:Z(_(a.value))},null,6)):Y("",!0),(S(!0),I(ne,null,ae(i.value,(E,x)=>(S(),I("div",{key:E,class:m(b(t).scale),style:Z(g(E,x))},null,6))),128)),(S(!0),I(ne,null,ae(r.value,E=>(S(),I("div",{class:m(b(t).number),style:Z(y(E))},K(E),7))),256))],6)],2))}}),_m="_horizontalRuler_170u5_2",Em="_verticalRuler_170u5_15",Tm="_ruler_170u5_27",Sm="_scale_170u5_32",Rm="_number_170u5_46",wm="_selected_170u5_71",km={horizontalRuler:_m,verticalRuler:Em,ruler:Tm,scale:Sm,number:Rm,selected:wm},Lm={classes:km},Vl=H(ym,[["__cssModules",Lm]]),Cm=["title"],bn=8,Im=F({__name:"DragLine",props:{top:{type:Number,default:0},zoom:{type:Number,default:1},title:{type:String,default:null},disabled:{type:Boolean,default:!1},min:{type:Number,default:null},max:{type:Number,default:null}},emits:["move"],setup(n,{emit:e}){const t=n,l=e,o=Ne("classes"),s={},r=Ce(),i=L(()=>({top:Math.round(t.top*t.zoom)+"px"}));function a(g){if(g.button!=0||t.disabled===!0)return;const y=g.target.closest("."+o.dragLine);y!=null&&(g.stopPropagation(),s.init=!1,s.target=y,s.parent=y.offsetParent,s.target.setPointerCapture(g.pointerId),window.addEventListener("pointermove",d),window.addEventListener("pointerup",f))}function d(g){g.preventDefault();const y=h(s.parent);let _=g.clientY-y.top;_<0&&(_=0),_>y.height&&(_=y.height),t.min>0&&_<t.min+bn&&(_=t.min+bn),t.max>0&&_>t.max-bn&&(_=t.max-bn),s.target.style.top=_/(r.state.scale/100)+"px",s.top=_,s.init=!0}function f(g){s.init===!0&&l("move",{top:s.top/(r.state.scale/100)}),s.target.releasePointerCapture(g.pointerId),window.removeEventListener("pointermove",d),window.removeEventListener("pointerup",f)}function h(g){return g instanceof HTMLElement?g.getBoundingClientRect():new DOMRect(0,0,window.innerWidth,window.innerHeight)}return(g,y)=>(S(),I("div",{class:m({[b(o).dragLine]:!0,[b(o).disabled]:n.disabled}),style:Z(i.value),onPointerdown:se(a,["stop"]),title:n.title},null,46,Cm))}}),Om="_dragLine_1m7rt_2",Nm="_disabled_1m7rt_26",xm={dragLine:Om,disabled:Nm},Dm={classes:xm},Fl=H(Im,[["__cssModules",Dm]]),Mm=F({__name:"Selection",setup(n,{expose:e}){const t=ge(),l=ge(),o=Zt("selectionRef"),s=ge(),r=Ce();let i=[];function a(){return{init:!1,initialX:0,initialY:0,top:0,left:0}}function d(){const _=[],c=l.value;if(c==null)return _;const v=f(c);if(v.length==0)return _;const E=o.value;return v.forEach(x=>{if(!Ws(x,E)){x.classList.remove(J.SELECTED);return}const C=Reflect.get(x,je);C instanceof he&&(x.classList.add(J.SELECTED),_.push(C))}),_}function f(_){if(_.matches("."+J.ELEMENT)){const c=Reflect.get(_,je);if(c&&c.type===j.TABLE)return _.querySelectorAll(":scope td")}return _.querySelectorAll(`:scope .${J.PAGE} > .${J.SELECTABLE}`)}function h(_,c){const v=c.closest("."+J.PAPER);if(v==null)return;_.stopPropagation(),_.preventDefault();const E=a(),x=v.getBoundingClientRect();E.initialX=_.clientX,E.initialY=_.clientY,E.top=_.clientY-x.top,E.left=_.clientX-x.left,l.value=c,s.value=E,t.value=v,i=[],window.addEventListener("pointermove",g),window.addEventListener("pointerup",y)}function g(_){const c=s.value;if(c==null)return;_.stopPropagation(),_.preventDefault();const v=o.value;if(c.init!==!0){if(Math.abs(_.clientX-c.initialX)<4&&Math.abs(_.clientY-c.initialY)<4)return;v.setPointerCapture(_.pointerId),v.style.display="block",c.init=!0}const E=Math.abs(_.clientX-c.initialX),x=Math.abs(_.clientY-c.initialY),C=_.clientX<c.initialX?-E:0,O=_.clientY<c.initialY?-x:0;v.style.top=c.top+O+"px",v.style.left=c.left+C+"px",v.style.width=E+"px",v.style.height=x+"px",i=d()}function y(_){const c=s.value;if(c==null)return;c.init&&(_.stopPropagation(),_.preventDefault()),i.length>0&&r.multiSelectElements(i);const v=o.value;v.releasePointerCapture(_.pointerId),v.style.display="none",s.value=void 0,window.removeEventListener("pointermove",g),window.removeEventListener("pointerup",y)}return e({onSelectStart:h}),(_,c)=>(S(),I("div",{ref_key:"selectionRef",ref:o,class:m(_.classes.selection),onClick:c[0]||(c[0]=se(()=>{},["stop"]))},null,2))}}),Am="_selection_10jfe_2",Bm={selection:Am},$m={classes:Bm},qm=H(Mm,[["__cssModules",$m]]);function Pm(n,e,t){const l=[{type:"menu",label:"设置",icon:"icon-setting",handler(){Yf(e.element)}},{type:"menu",label:"文字方向",icon:"icon-text-direction",handler(){Do(e.element)}},{type:"divider"},{type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler(){t.clipboard.writeElement([e.element])}}];l.push({type:"menu",label:"删除",icon:"icon-delete",submenu:[{type:"menu",label:"元素",icon:"icon-pintu",detail:"Delete",handler(){e.element.remove(),t.createSnapshot()}},{type:"menu",label:"数据源",icon:"icon-datasource",handler(){e.element.resetDS(),t.createSnapshot()}}]},{type:"divider"},bl(t,e.element)),Bn.open(n.clientX,n.clientY,{menus:l})}const Vm=F({props:{element:{type:he,required:!0}},setup(n){const e=Ne("classes"),t=Ce(),l=L(()=>{n.element.state.key;const h=n.element,g={"--quickprint-element-top":h.top+"px","--quickprint-element-left":h.left+"px","--quickprint-element-width":h.width+"px","--quickprint-element-height":h.height+"px","z-index":h.zIndex};return r()&&(g.transform=`rotate(${h.style.rotate}deg)`),g}),o={TOP:[e.resizeTop,$t.TOP],BOTTOM:[e.resizeBottom,$t.BOTTOM],LEFT:[e.resizeLeft,$t.LEFT],RIGHT:[e.resizeRight,$t.RIGHT],BOTTOM_RIGHT:[e.resizeBottomRight,$t.BOTTOM_RIGHT]},s=[o.TOP,o.BOTTOM,o.LEFT,o.RIGHT,o.BOTTOM_RIGHT];function r(){const h=n.element;return h.style.rotate==0||h.style.rotate==null?!1:t.state.selectMode===it.SINGLE?!h.isSelected:!0}function i(h){const g=zp(h.type);if(g==null)return p("div",{class:e.unknown},[p("span",null,[ie("未知的打印元素")])]);const y={element:h,key:h.id+"_"+h.state.key};return Gp(h.type)?(y.onContextmenu=d,mt(g,y)):mt(g,y)}function a(h,g){g.stopPropagation();const y=g.target.closest("."+J.ELEMENT);y&&Reflect.get(y,$n)===ml.DRAG_ELEMENT||(g.ctrlKey?t.toggleMultiSelectedElement(h):t.selectElement(h))}function d(h){h.stopPropagation(),h.preventDefault(),Pm(h,n,t)}function f(){return!Wp(n.element.type)||r()?null:s.map(h=>{const g={class:[J.RESIZEABLE_INDICATOR,h[0]],["."+oo]:h[1]};return p("div",Ns(g,{onPointerdown:t.onResizeStart}),null)})}return function(){const h=n.element,g={["."+je]:h,["."+pl]:h.type,id:h.id,key:h.id,class:{[J.ELEMENT]:!0,[J.DRAGGABLE]:!0,[J.RESIZEABLE]:!0,[J.SELECTED]:h.state.selected,[J.SELECTABLE]:Hp(h.type),["quickprint-is-"+h.type.toLowerCase()]:!0},style:l.value,onClick:a.bind(null,h)};return p("div",g,[i(h),f()])}}}),Fm="_unknown_za8zh_2",zm="_resizeTop_za8zh_12",Um="_resizeBottom_za8zh_20",Hm="_resizeLeft_za8zh_28",Gm="_resizeRight_za8zh_36",Wm="_resizeBottomRight_za8zh_44",Ym={unknown:Fm,resizeTop:zm,resizeBottom:Um,resizeLeft:Hm,resizeRight:Gm,resizeBottomRight:Wm},Xm={classes:Ym},jm=H(Vm,[["__cssModules",Xm]]),Go=Yl(()=>Xl(()=>import("./component-DnlbD_FW.js"),__vite__mapDeps([2,3,1,4,5]))),Zm=F({__name:"DocJson",props:{doc:{type:Ee,required:!0}},setup(n){const e=n,t=Ze(),l=de(JSON.stringify(e.doc,null,"  "));return t==null||t.useHandle("confirm",()=>l.value),(o,s)=>(S(),ee(b(Go),{modelValue:l.value,"onUpdate:modelValue":s[0]||(s[0]=r=>l.value=r),language:"json",class:m(o.classes.json)},null,8,["modelValue","class"]))}}),Km="_json_9crpe_2",Jm={json:Km},Qm={classes:Jm},eg=H(Zm,[["__cssModules",Qm]]),tg=ke(function(n){return Xe("调试",p(eg,{doc:n.document.value},null),{preset:"docDebug"}).promisify().catch(lt)});async function ng(n,e,t){const l=[{type:"menu",label:"重新加载",icon:"icon-reload",detail:"Ctrl+R",handler(){window.location.reload()}},{type:"menu",label:"全部选中",icon:"icon-select-all",detail:"Ctrl+A",handler:()=>{const r=e.page.children??[];t.multiSelectElements(r)}},{type:"divider"}],o=[],s=t.getSelectedElements();s.length>0&&o.push({type:"menu",label:"复制",icon:"icon-copy",detail:"Ctrl+C",handler:()=>{t.clipboard.writeElement(s)}}),await t.clipboard.hasElement()&&o.push({type:"menu",label:"粘贴",icon:"icon-paste",detail:"Ctrl+V",async handler(){const r=n.target.closest("."+J.PAGE);if(r==null)return;const i=await t.clipboard.readElement();if(i.length==0)return;const a=r.getBoundingClientRect(),d=n.clientX-a.left-i[0].left,f=n.clientY-a.top-i[0].top;for(const h of i)h.setLeft(h.left+d),h.setTop(h.top+f),e.page.append(h);t.createSnapshot()}}),o.length>0&&l.push(...o,{type:"divider"}),l.push({type:"menu",label:"调试",icon:"icon-bug",handler(){tg(t).then(r=>{if(r==null)return;const i=Ee.create(r);t.setDocument(i)})}},{type:"menu",label:"预览",icon:"icon-run",detail:"Ctrl+P",handler(){t.component.dispatchEvent("preview")}},{type:"menu",label:"保存",icon:"icon-save",detail:"Ctrl+S",handler(){t.component.dispatchEvent("save")}}),Bn.open(n.clientX,n.clientY,{menus:l})}const lg=F({props:{doc:{type:Ee,required:!0},page:{type:xt,required:!0}},setup(n){const e=Ne("classes"),t=Ce(),l=Zt("selectionRef"),o=Zt("paperRef"),s=de(0),r=L(()=>n.page.width),i=L(()=>n.page.height);function a(x){x.stopPropagation();const C=x.target.closest("."+J.PAPER);C&&Reflect.get(C,$n)===ml.SELECTION||(t.resetSelectedElement(),t.selectPage(n.page))}function d(){if(n.page.header.display===!1)return null;const x=n.page.header.height,C="page_header_"+s.value;return p(Fl,{title:"页眉",top:x,onMove:h,key:C},null)}function f(){if(n.page.footer.display===!1)return null;const x=Xt(i.value)-n.page.footer.height,C="page_footer_"+s.value;return p(Fl,{title:"页脚",top:x,onMove:g,key:C},null)}function h(x){n.page.setHeaderHeight(x.top),s.value++}function g(x){n.page.setFooterHeight(Xt(i.value)-x.top),s.value++}function y(x){x.stopPropagation(),x.preventDefault(),ng(x,n,t)}function _(){const x=n.doc.margins;if(x==null)return null;const C=[];return x.top&&C.push(p("div",{title:"上边距参考线",class:e.marginHorizontalGuide,style:{top:x.top}},null)),x.bottom&&C.push(p("div",{title:"下边距参考线",class:e.marginHorizontalGuide,style:{bottom:x.bottom}},null)),x.left&&C.push(p("div",{title:"左边距参考线",class:e.marginVerticalGuide,style:{left:x.left}},null)),x.right&&C.push(p("div",{title:"右边距参考线",class:e.marginVerticalGuide,style:{right:x.right}},null)),C.length>0?C:null}function c(){const x={["."+lo]:n.page,key:n.page.id,style:{width:r.value+"mm",height:i.value+"mm"},class:{[J.PAGE]:!0,[J.DROPPABLE]:!0,[e.grid]:n.doc.useGrid},onContextmenu:y},C=n.page.children.map(O=>p(jm,{element:O},null));return p("div",x,[d(),C,f(),_()])}function v(x){if(x.button!==0)return;x.stopPropagation(),x.preventDefault();const O=x.target.closest("."+J.ELEMENT);if(O==null)return E(x,o.value);const k=Reflect.get(O,je);return k==null?E(x,o.value):k.type===j.TABLE?E(x,O):Yp(k.type)?t.onDragStart(x):E(x,o.value)}function E(x,C){var O;(O=l.value)==null||O.onSelectStart(x,C)}return function(){const x=t.state.scale/100,C={id:"@"+n.page.id,ref:"paperRef",class:{[J.PAPER]:!0,[J.SELECTED]:t.state.selectedPage===n.page.id},style:{width:r.value*x+"mm",height:i.value*x+"mm"},onPointerdown:v,onClick:a};return p("div",C,[c(),p(qm,{ref:"selectionRef"},null)])}}}),og="_paper_1eq2b_2",sg="_grid_1eq2b_12",ig="_marginHorizontalGuide_1eq2b_19",rg="_marginVerticalGuide_1eq2b_27",ag={paper:og,grid:sg,marginHorizontalGuide:ig,marginVerticalGuide:rg},cg={classes:ag},ug=H(lg,[["__cssModules",cg]]),dg={class:"quickprint-is-fill-h quickprint-is-scrollable"},fg="icon-zhanweifu",pg=F({__name:"Element",setup(n){const e=Ce();return(t,l)=>(S(),I("div",{class:m(t.classes.panel)},[u("div",{class:m(t.classes.header)},"可打印元素",2),u("div",dg,[u("div",{class:m(t.classes.grid)},[(S(!0),I(ne,null,ae(b(qp),o=>(S(),I("div",to({key:o.type,class:[b(J).DRAGGABLE,t.classes.element],[`.${b(no)||""}`]:b(Fe).INSERT,[`.${b(pl)||""}`]:o.type,onPointerdown:l[0]||(l[0]=(...s)=>b(e).onDragStart&&b(e).onDragStart(...s))}),[p(b(U),{icon:o.icon??fg,size:"16px",class:m(t.classes.icon)},null,8,["icon","class"]),u("span",null,K(o.title),1)],48))),128))],2)])],2))}}),mg="_panel_1p36j_2",gg="_header_1p36j_8",hg="_grid_1p36j_18",vg="_element_1p36j_30",bg="_icon_1p36j_45",yg={panel:mg,header:gg,grid:hg,element:vg,icon:bg},_g={classes:yg},Eg=H(pg,[["__cssModules",_g]]),Tg=["onClick"],Sg=F({__name:"SelectPath",setup(n){const e=Ce(),t=L(()=>{const s=e.state,r=[{id:e.doc.id,title:"文档",type:"document"}];if(s.selectedType===ue.PAGE){const i=e.getSelectedPage();if(i!=null){const a="页面"+(i.index+1);r.push({id:i.id,title:a,type:"page",data:i})}return r}if(s.selectedType===ue.ELEMENT){if(s.selectMode===it.MULTIPLE){const d=e.getSelectedElements();if(d.length===0)return r;let f=d[0];for(;f.parent;){const h=f.parent;if(h instanceof xt){const g="页面"+(h.index+1);return r.push({id:h.id,title:g,type:"page",data:h}),r}f=h}return r}let i=e.getSelectedElements()[0];if(i==null)return r;const a=[{id:i.id,title:dn(i.type),type:"element",data:i}];for(;i.parent;){const d=i.parent;if(d instanceof xt){const f="页面"+(d.index+1);return a.unshift({id:d.id,title:f,type:"page",data:d}),r.concat(a)}a.unshift({id:d.id,title:dn(d.type),type:"element",data:d}),i=d}}return r}),l=L(()=>{if(e.state.selectedType!=ue.ELEMENT)return;const r=e.getSelectedElements();if(r.length!=1)return;const i=r[0],a=gl(i,e.doc.ds);if(!(a==null||!a.content))return a.type===Te.VARIABLE||a.type===Te.FORMULA?`[${a.content}]`:a.content});function o(s){if(s.type==="element")return e.selectElement(s.data);if(s.type==="page")return e.selectPage(s.data)}return(s,r)=>(S(),I("div",{class:m(s.classes.paths)},[(S(!0),I(ne,null,ae(t.value,(i,a)=>(S(),I(ne,{key:i.id},[a>0?(S(),ee(b(U),{key:0,class:m(s.classes.icon),icon:"icon-right",size:"12px"},null,8,["class"])):Y("",!0),u("div",{class:m(s.classes.path),onClick:d=>o(i)},K(i.title),11,Tg)],64))),128)),l.value?(S(),I(ne,{key:0},[p(b(U),{class:m(s.classes.ion),icon:"icon-right",size:"12px"},null,8,["class"]),u("div",{class:m(s.classes.content)},K(l.value),3)],64)):Y("",!0)],2))}}),Rg="_paths_fuk62_2",wg="_path_fuk62_2",kg="_icon_fuk62_28",Lg="_content_fuk62_33",Cg={paths:Rg,path:wg,icon:kg,content:Lg},Ig={classes:Cg},Og=H(Sg,[["__cssModules",Ig]]),Ng=["min","readonly","placeholder"],xg=F({__name:"LabelNumber",props:Dt({modelValue:{type:Number,default:null},label:{type:String,default:null},min:{type:Number,default:null},defaultValue:{type:Number,default:0},precision:{type:Number,default:null},readonly:{type:Boolean,default:!1},placeholder:{type:String,default:null}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=n,t=fn(n,"modelValue");function l(o){const r=o.target.value;if(t==null||r===""){const a=e.min?e.min:e.defaultValue;t.value=a;return}const i=Number(r);if(!Number.isNaN(i)&&(e.min!=null&&i<e.min&&(t.value=e.min),e.precision!=null)){const a=Math.pow(10,e.precision);t.value=Math.round(i*a)/a}}return(o,s)=>(S(),I("label",{class:m({[o.classes.labelNumber]:!0,[o.classes.readonly]:n.readonly})},[Se(u("input",{class:"quickprint-form-control",type:"number","onUpdate:modelValue":s[0]||(s[0]=r=>t.value=r),step:"any",min:n.min,readonly:n.readonly,placeholder:n.placeholder,onBlur:l},null,40,Ng),[[Ae,t.value]]),u("span",{class:m(o.classes.label)},K(n.label),3)],2))}}),Dg="_labelNumber_1aifb_2",Mg="_label_1aifb_2",Ag="_readonly_1aifb_25",Bg={labelNumber:Dg,label:Mg,readonly:Ag},$g={classes:Bg},Vt=H(xg,[["__cssModules",$g]]),qg={class:"quickprint-config"},Pg={class:"quickprint-config-body quickprint-is-scrollable quickprint-is-fill-h"},Vg={class:"quickprint-config-group"},Fg={class:"quickprint-config-section quickprint-config-inline"},zg={class:"quickprint-config-content quickprint-config-inline"},Ug={class:"quickprint-config-group"},Hg={class:"quickprint-config-section quickprint-config-inline"},Gg={class:"quickprint-config-content quickprint-config-inline"},Wg={class:"quickprint-config-section quickprint-config-inline"},Yg={class:"quickprint-config-content quickprint-form-inline"},Xg={class:"quickprint-config-group"},jg={class:"quickprint-config-section quickprint-config-inline"},Zg={class:"quickprint-config-content quickprint-form-inline"},Kg={key:0,class:"quickprint-config-section quickprint-config-inline"},Jg={class:"quickprint-config-content quickprint-form-inline"},Qg={class:"quickprint-config-section quickprint-config-inline"},eh={class:"quickprint-config-content quickprint-form-inline"},th=F({__name:"PageConfig",props:{page:{type:xt,required:!0}},setup(n){const e=n,t=[{label:"显示",value:!0},{label:"隐藏",value:!1}],l=[{label:"禁止",value:gn.NONE},{label:"跟随表格",value:gn.TABLE,detail:"在尾页最后一个元素是表格，则页脚显示在表格下方"}],o=L({get(){return e.page.size.type},set(d){e.page.size.type=d,d===an.CONTENT&&(e.page.size.orientation=void 0)}}),s=L({get(){return e.page.orientation},set(d){e.page.size.orientation=d}}),r=L(()=>e.page.width),i=L({get(){return e.page.height},set(d){const f=Number(d);!Zl(f)||f<0||(e.page.size.height=f)}}),a=L({get(){return e.page.footer.flow??gn.NONE},set(d){e.page.footer.flow=d===gn.NONE?void 0:d}});return(d,f)=>(S(),I("div",qg,[f[15]||(f[15]=u("div",{class:"quickprint-config-title"},"页面配置",-1)),u("div",Pg,[u("div",Vg,[f[7]||(f[7]=u("div",{class:"quickprint-config-group-title"},"页眉",-1)),u("section",Fg,[f[6]||(f[6]=u("header",{class:"quickprint-config-header"},"位置",-1)),u("div",zg,[p(Vt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.header.height,readonly:""},null,8,["modelValue"]),p(Pt,{modelValue:n.page.header.display,"onUpdate:modelValue":f[0]||(f[0]=h=>n.page.header.display=h),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])])]),u("div",Ug,[f[10]||(f[10]=u("div",{class:"quickprint-config-group-title"},"页脚",-1)),u("section",Hg,[f[8]||(f[8]=u("header",{class:"quickprint-config-header"},"位置",-1)),u("div",Gg,[p(Vt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.page.footer.height,readonly:""},null,8,["modelValue"]),p(Pt,{modelValue:n.page.footer.display,"onUpdate:modelValue":f[1]||(f[1]=h=>n.page.footer.display=h),options:t,class:"quickprint-form-left-gap"},null,8,["modelValue"])])]),u("section",Wg,[f[9]||(f[9]=u("header",{class:"quickprint-config-header"},"跟随",-1)),u("div",Yg,[p(b(le),{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=h=>a.value=h),options:l},null,8,["modelValue"])])])]),u("div",Xg,[f[14]||(f[14]=u("div",{class:"quickprint-config-group-title"},"画布",-1)),u("section",jg,[f[11]||(f[11]=u("header",{class:"quickprint-config-header"},"尺寸",-1)),u("div",Zg,[p(Pt,{modelValue:o.value,"onUpdate:modelValue":f[3]||(f[3]=h=>o.value=h),options:b(Fs),class:"quickprint-w-full"},null,8,["modelValue","options"])])]),n.page.size.type===b(an).CONTENT?(S(),I("section",Kg,[f[12]||(f[12]=u("header",{class:"quickprint-config-header"},"内容",-1)),u("div",Jg,[p(Vt,{class:"quickprint-form-inline-item",label:"宽",modelValue:r.value,readonly:""},null,8,["modelValue"]),p(Vt,{class:"quickprint-form-inline-item",label:"高",modelValue:i.value,"onUpdate:modelValue":f[4]||(f[4]=h=>i.value=h)},null,8,["modelValue"])])])):Y("",!0),u("section",Qg,[f[13]||(f[13]=u("header",{class:"quickprint-config-header"},"方向",-1)),u("div",eh,[p(Pt,{modelValue:s.value,"onUpdate:modelValue":f[5]||(f[5]=h=>s.value=h),class:"quickprint-w-full",options:b(ro),disabled:n.page.size.type===b(an).CONTENT},null,8,["modelValue","options","disabled"])])])])])]))}}),nh=["value","placeholder"],lh=F({__name:"InputWithLabel",props:{label:{type:String,default:null},modelValue:{type:Number,default:null},standard:{type:String,default:"px"},target:{type:String,default:"px"},placeholder:{type:String,default:"请输入"},min:{type:Number,default:1},defaultValue:{type:Number,default:0},clearable:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(n,{emit:e}){const t=n,l=e,o=Zt("inputRef"),s=L({get(){return t.standard===t.target?t.modelValue:t.standard==="px"&&t.target==="mm"?Sl(t.modelValue):t.standard==="mm"&&t.target==="px"?Xt(t.modelValue):0},set(f){if(t.standard===t.target)return l("update:modelValue",f);if(t.standard==="px"&&t.target==="mm")return l("update:modelValue",Xt(f));if(t.standard==="mm"&&t.target==="px")return l("update:modelValue",Sl(f))}}),r=L(()=>t.clearable&&s.value!=null);function i(f){const g=f.target.value;if(s==null||g===""){if(t.clearable)return;const _=t.min?t.min:t.defaultValue;s.value=_;return}const y=Number(g);if(!Number.isNaN(y)){if(t.min!=null&&y<t.min){s.value=t.min;return}if(t.standard==="px"){s.value=Math.round(y);return}s.value=y}}function a(){l("update:modelValue",void 0)}function d(){var f;(f=o.value)==null||f.blur(),setTimeout(()=>{var h;return(h=o.value)==null?void 0:h.focus()},50)}return(f,h)=>(S(),I("label",{class:m({[f.classes.inputWithLabel]:!0,[f.classes.withClear]:n.clearable})},[u("span",{class:m(f.classes.label)},K(n.label),3),u("input",{ref_key:"inputRef",ref:o,class:"quickprint-form-control",type:"number",step:"any",value:s.value,placeholder:n.placeholder,onBlur:i,onKeydown:Jl(d,["enter"])},null,40,nh),r.value?(S(),I("span",{key:0,class:m(f.classes.clearBtn),onClick:se(a,["stop"])},[p(b(U),{icon:"icon-close",size:"11px"})],2)):Y("",!0)],2))}}),oh="_inputWithLabel_1k5y2_2",sh="_clearBtn_1k5y2_7",ih="_label_1k5y2_11",rh="_withClear_1k5y2_31",ah={inputWithLabel:oh,clearBtn:sh,label:ih,withClear:rh},ch={classes:ah},yn=H(lh,[["__cssModules",ch]]),uh=F({__name:"UnitSelect",props:Dt({modelValue:{type:String,default:"px"}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(n){const e=[{label:"像素(px)",value:"px"},{label:"毫米(mm)",value:"mm"}],t=n,l=fn(n,"modelValue"),o=L(()=>{var s;return((s=e.find(r=>r.value===t.modelValue))==null?void 0:s.label)??t.modelValue});return(s,r)=>(S(),I("span",{class:m(s.classes.unit),title:"1毫米≈3.778像素，1像素≈0.265毫米"},[p(b(le),{modelValue:l.value,"onUpdate:modelValue":r[0]||(r[0]=i=>l.value=i),options:e,class:m(s.classes.select),appearance:"none",border:"none"},{selected:_e(()=>[u("span",{class:m(s.classes.text)},K(o.value),3)]),_:1},8,["modelValue","class"])],2))}}),dh="_unit_135mn_2",fh="_text_135mn_8",ph="_select_135mn_25",mh={unit:dh,text:fh,select:ph},gh={classes:mh},hh=H(uh,[["__cssModules",gh]]),vh=F({__name:"CopyBtn",emits:["copy"],setup(n,{emit:e}){const t=e,l=de(!1);function o(){t("copy",async function(r){await navigator.clipboard.writeText(r).catch(Es)!==!1&&(l.value=!0,setTimeout(()=>l.value=!1,500))})}return(s,r)=>(S(),I("button",{type:"button",class:m(["quickprint-text-btn",s.classes.btn]),title:"复制",onClick:o},[p(b(U),{icon:"icon-copy"}),p(xs,{name:"quickprint-fade"},{default:_e(()=>[l.value?(S(),I("span",{key:0,class:m(s.classes.message)},"已复制",2)):Y("",!0)]),_:1})],2))}}),bh="_btn_v9scw_2",yh="_message_v9scw_6",_h={btn:bh,message:yh},Eh={classes:_h},Th=H(vh,[["__cssModules",Eh]]),Sh=F({__name:"window",props:{code:{type:String,default:""},doc:{type:Ee,default:null},mode:{type:String,default:"code"}},setup(n){const e=n,t=Ze(),l=de(e.code),o=ge();function s(){return l.value}function r(){e.doc!=null&&vc({doc:e.doc}).then(h=>{var y;if(h==null)return;const g=h.type=="reference"?`[=${h.value}]`:`[${h.value}]`;(y=o.value)==null||y.insert(g)})}function i(h){var g;return at(h,(g=e.doc)==null?void 0:g.ds)}function a(){var h;(h=o.value)==null||h.insert(`[2.6.${cl.ELEMENT_VALUR}]`)}function d(){bc().then(h=>{var g;h!=null&&((g=o.value)==null||g.insert(h.value))})}function f(){yc({doc:e.doc}).then(h=>{var g;h!=null&&((g=o.value)==null||g.insert(h.value))})}return t==null||t.useHandle("confirm",s),(h,g)=>(S(),I("div",{class:m(h.classes.window)},[n.mode!=="code"?(S(),I("div",{key:0,class:m(h.classes.toolbar)},[n.mode=="condition"?(S(),I(ne,{key:0},[u("button",{type:"button",class:"quickprint-text-btn",onClick:a},[p(b(U),{icon:"icon-number-sign"}),g[1]||(g[1]=u("span",null,"插入元素值",-1))]),u("div",{class:m(h.classes.divider)},null,2)],64)):Y("",!0),u("button",{type:"button",onClick:r,class:"quickprint-text-btn"},[p(b(U),{icon:"icon-insert-var"}),g[2]||(g[2]=u("span",null,"插入变量",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:d},[p(b(U),{icon:"icon-function"}),g[3]||(g[3]=u("span",null,"插入函数",-1))]),u("button",{type:"button",class:"quickprint-text-btn",onClick:f},[p(b(U),{icon:"icon-formula"}),g[4]||(g[4]=u("span",null,"插入公式",-1))])],2)):Y("",!0),p(b(Go),{modelValue:l.value,"onUpdate:modelValue":g[0]||(g[0]=y=>l.value=y),language:"javascript",class:m(h.classes.code),formatVariable:i,autofocus:"",ref_key:"codeRef",ref:o},null,8,["modelValue","class"])],2))}}),Rh="_window_n935p_2",wh="_toolbar_n935p_11",kh="_code_n935p_22",Lh="_divider_n935p_27",Ch={window:Rh,toolbar:wh,code:kh,divider:Lh},Ih={classes:Ch},Wo=H(Sh,[["__cssModules",Ih]]),Yo=ke(function(n){return Xe("公式",p(Wo,{code:n==null?void 0:n.code,doc:n==null?void 0:n.doc,mode:n==null?void 0:n.mode},null),{preset:"editor"}).promisify().catch(Le)}),Oh=ke(function(n,e){return Xe(n,p(Wo,{code:e},null),{preset:"editor"}).promisify().catch(Le)}),Nh={class:"quickprint-config-section quickprint-config-inline"},xh={class:"quickprint-config-content"},Dh=["value"],Mh=F({__name:"Visibility",props:{element:{type:he,required:!0}},setup(n){const e=n,t=L({get(){var i;return((i=e.element.visibility)==null?void 0:i.type)??It.VISIBLE},set(i){e.element.visibility==null&&(e.element.visibility={}),i!==It.CONDITION&&(e.element.visibility.condition=void 0),e.element.visibility.type=i}}),l=L({get(){var i;return((i=e.element.visibility)==null?void 0:i.condition)??""},set(i){e.element.visibility==null&&(e.element.visibility={}),e.element.visibility.condition=i}}),o=L(()=>{var i;return hl((i=e.element.visibility)==null?void 0:i.condition,e.element.doc)}),s=L(()=>{var i;return t.value!==It.CONDITION?!1:!((i=e.element.visibility)!=null&&i.condition)});function r(){const i=l.value||`[2.6.${cl.ELEMENT_VALUR}]`;Yo({code:i,doc:e.element.doc,mode:"condition"}).then(a=>{a!=null&&(l.value=a)})}return(i,a)=>(S(),I(ne,null,[u("section",Nh,[a[1]||(a[1]=u("header",{class:"quickprint-config-header"},"可见性",-1)),u("div",xh,[p(b(le),{class:"quickprint-w-full",options:b(As),modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=d=>t.value=d)},null,8,["options","modelValue"])])]),t.value===b(It).CONDITION?(S(),I("div",{key:0,class:m([i.classes.condition,"quickprint-config-section"]),onClick:r},[u("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Dh),s.value?(S(),ee(b(U),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2)):Y("",!0)],64))}}),Ah="_condition_siopf_2",Bh={condition:Ah},$h={classes:Bh},qh=H(Mh,[["__cssModules",$h]]);function Ph(n){return L({get(){return n.element.attributes.position??Ln.DEFAULT},set(e){const t=e===Ln.DEFAULT?void 0:e;n.element.attributes.position=t}})}function Vh(n){return L({get(){return n.element.attributes.printMode??Cn.ONCE},set(e){const t=e===Cn.ONCE?void 0:e;n.element.attributes.printMode=t}})}function Fh(n){return L({get(){return n.element.attributes.overflow??cn.HIDDEN},set(e){const t=e===cn.HIDDEN?void 0:e;n.element.attributes.overflow=t}})}function zh(n){return L({get(){return n.element.width},set(e){n.element.setWidth(e,!0)}})}function Uh(n){return L({get(){return n.element.height},set(e){n.element.setHeight(e,!0)}})}function Hh(n){return L({get(){return n.element.attributes.display},set(e){if(e==null){n.element.attributes.display=void 0;return}n.element.attributes.display=e}})}function Gh(n){return L({get(){return n.element.ds.type},set(e){const t=n.element.ds.type;n.element.ds.type=e,t!=e&&(n.element.ds.value=void 0)}})}const Wh=F({__name:"Const",props:{element:{type:he,required:!0}},setup(n){const e=n,t=L({get(){return e.element.ds.value},set(l){e.element.ds.value=l}});return(l,o)=>Se((S(),I("textarea",{"onUpdate:modelValue":o[0]||(o[0]=s=>t.value=s),class:"quickprint-form-control quickprint-form-control-block quickprint-config-space",rows:"3",placeholder:"请输入"},null,512)),[[Ae,t.value]])}}),Yh={class:"quickprint-config-ds-var-type"},Xh=["title"],jh=F({__name:"Variable",props:{element:{type:he,required:!0}},setup(n){const e=n,t=Ce(),l=L(()=>me(e.element.ds.value)),o=L(()=>at(e.element.ds.value,t.doc.ds));function s(i){i.stopPropagation(),e.element.ds.value=void 0}async function r(){var f;const i=await vl({doc:t.doc,value:e.element.ds.value}).catch(lt);if(i==null||(e.element.setDataSource(Te.VARIABLE,i.value),e.element.type!=j.TABLE_CELL||i.type!=="ds"))return;const a=e.element.parent;if(a==null||a.isBindVariable||((f=i.parent)==null?void 0:f.type)!==oe.ARRAY)return;const d=i.parent;a.setDataSource(Te.VARIABLE,`${Ot.DS}.${d.type}.${d.name}`)}return(i,a)=>(S(),I("div",{class:"quickprint-config-ds-variable",onClick:r},[l.value?(S(),I(ne,{key:0},[a[0]||(a[0]=u("span",{class:"quickprint-config-ds-placeholder"},"请选择",-1)),p(b(U),{icon:"icon-open-new",size:"14px"})],64)):(S(),I(ne,{key:1},[u("span",Yh,"<"+K(b(Zr)(e.element.ds.value))+">",1),u("span",{class:"quickprint-is-fill-w quickprint-is-truncate",title:o.value},K(o.value),9,Xh),u("button",{type:"button",class:"quickprint-text-btn quickprint-config-ds-remove-var",onClick:s},[p(b(U),{icon:"icon-close",size:"12px"})])],64))]))}}),Zh=["value"],Kh=F({__name:"Code",props:{element:{type:he,required:!0}},setup(n){const e=n,t=L(()=>me(e.element.ds.value));function l(){return An(e.element.ds.value)?e.element.ds.value:`function data(element){
  // 在此处自定义返回值
  // 支持返回Promise
  return
}`}function o(){Oh("自定义",l()).then(s=>{s!=null&&(e.element.ds.value=s)})}return(s,r)=>(S(),I("div",{onClick:o,class:m(s.classes.code)},[u("textarea",{value:e.element.ds.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,Zh),t.value?(S(),ee(b(U),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2))}}),Jh="_code_1az68_2",Qh={code:Jh},ev={classes:Qh},tv=H(Kh,[["__cssModules",ev]]),nv=["value"],lv=F({__name:"Formula",props:{element:{type:he,required:!0}},setup(n){const e=n,t=Ce(),l=L(()=>me(e.element.ds.value)),o=L(()=>hl(e.element.ds.value,e.element.doc));function s(){const r=e.element.ds.value;Yo({code:r,doc:t.doc,mode:"formula"}).then(i=>{i!=null&&(e.element.ds.value=i)})}return(r,i)=>(S(),I("div",{onClick:s,class:m(r.classes.code)},[u("textarea",{value:o.value,class:"quickprint-form-control quickprint-form-control-block quickprint-config-space quickprint-is-scrollable",rows:"3",readonly:"",placeholder:"请输入"},null,8,nv),l.value?(S(),ee(b(U),{key:0,icon:"icon-open-new",size:"14px"})):Y("",!0)],2))}}),ov="_code_ipm2q_2",sv={code:ov},iv={classes:sv},rv=H(lv,[["__cssModules",iv]]);function av(n){switch(n.ds.type){case Te.CONST:return p(Wh,{element:n},null);case Te.VARIABLE:return p(jh,{element:n},null);case Te.CODE:return p(tv,{element:n},null);case Te.FORMULA:return p(rv,{element:n},null);default:return null}}const cv=F({props:{element:{type:he,required:!0}},setup(n){const e=L(()=>dn(n.element.type)),t=L(()=>Ps.filter(C=>C.value!=n.element.type)),l=de("px"),o=zh(n),s=Uh(n),r=Fh(n),i=Ph(n),a=Vh(n),d=Hh(n),f=Gh(n),h=L(()=>{const C=n.element,O=C.parent;if(O===null||!(O instanceof xt))return!1;const k=O.header;if(k.display&&C.bottom<=(k.height??0))return!1;const $=O.parent;if($==null)return!1;const B=O.footer;return!(B.display&&C.top>=Math.floor(Xt($.paper.height))-(B.height??0))});function g(C,O){return O==null?!1:!!O.includes(C)}function y(){const C=nn(n.element.type);if(g(fe.LAYOUT,C==null?void 0:C.exclude))return null;const O=n.element,k=g(fe.COORD,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("位置")]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(yn,{class:"quickprint-form-inline-item",label:"左",modelValue:O.left,"onUpdate:modelValue":N=>O.left=N,target:l.value},null),p(yn,{class:"quickprint-form-inline-item",label:"上",modelValue:O.top,"onUpdate:modelValue":N=>O.top=N,target:l.value},null)])]),$=g(fe.SIZE)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[p("span",null,[ie("尺寸")])]),p("div",{class:"quickprint-config-content quickprint-form-inline"},[p(yn,{class:"quickprint-form-inline-item",label:"宽",modelValue:o.value,"onUpdate:modelValue":N=>o.value=N,target:l.value},null),p(yn,{class:"quickprint-form-inline-item",label:"高",modelValue:s.value,"onUpdate:modelValue":N=>s.value=N,target:l.value},null)])]),B=g(fe.VISIBILITY,C==null?void 0:C.exclude)?null:p(qh,{element:O},null),q=g(fe.OVERFLOW,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("溢出时")]),p("div",{class:"quickprint-config-content"},[p(le,{modelValue:r.value,"onUpdate:modelValue":N=>r.value=N,options:Hs,class:"quickprint-w-full"},null)])]),A=g(fe.PRINT_MODE,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header "},[ie("打印模式")]),p("div",{class:"quickprint-config-content"},[p(le,{modelValue:a.value,"onUpdate:modelValue":N=>a.value=N,options:Us,class:"quickprint-w-full"},null)])]),D=g(fe.POSITION,C==null?void 0:C.exclude)||!h.value?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("定位模式")]),p("div",{class:"quickprint-config-content"},[p(le,{modelValue:i.value,"onUpdate:modelValue":N=>i.value=N,options:zs,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title quickprint-is-row"},[p("span",{class:"quickprint-is-fill-w"},[ie("布局")]),p("span",null,[ie("单位：")]),p(hh,{modelValue:l.value,"onUpdate:modelValue":N=>l.value=N},null)]),k,$,B,q,A,D])}function _(){const C=nn(n.element.type);if(g(fe.BASIC,C==null?void 0:C.exclude))return null;const O=n.element,k=g(fe.PREFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("前缀")]),p("div",{class:"quickprint-config-content"},[Se(p("input",{"onUpdate:modelValue":q=>O.attributes.prefix=q,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ae,O.attributes.prefix]])])]),$=g(fe.SUFFIX,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("后缀")]),p("div",{class:"quickprint-config-content"},[Se(p("input",{"onUpdate:modelValue":q=>O.attributes.suffix=q,type:"text",class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ae,O.attributes.suffix]])])]),B=g(fe.DISPLAY,C==null?void 0:C.exclude)?null:p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("数据类型")]),p("div",{class:"quickprint-config-content"},[p(le,{options:t.value,modelValue:d.value,"onUpdate:modelValue":q=>d.value=q,class:"quickprint-w-full"},null)])]);return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ie("基础")]),k,$,B])}function c(){const C=nn(n.element.display);return(C==null?void 0:C.display)==null?null:mt(C.display,{element:n.element})}function v(){const C=nn(n.element.type);if(g(fe.ATTRIBUTES,C==null?void 0:C.exclude))return null;const O=C!=null&&C.attributes?mt(C.attributes,{element:n.element}):null,k=c();if(O==null&&k==null)return null;const $=k!=null&&O!=null?p("div",{class:"quickprint-config-divider"},null):null;return p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ie("属性")]),k,$,O])}function E(){const C=nn(n.element.type);return g(fe.DATASOURCE,C==null?void 0:C.exclude)?null:p("div",{class:"quickprint-config-group"},[p("div",{class:"quickprint-config-group-title"},[ie("数据")]),p(le,{options:so,modelValue:f.value,"onUpdate:modelValue":O=>f.value=O},null),av(n.element)])}function x(C){C(n.element.id)}return function(){const O=n.element;return p("div",{class:"quickprint-config"},[p("div",{class:"quickprint-config-title"},[p("span",null,[e.value,ie("配置")]),null]),p("div",{class:"quickprint-config-body quickprint-is-fill-h quickprint-is-scrollable"},[p("div",{class:"quickprint-config-group"},[p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("标识")]),p("div",{class:"quickprint-config-content"},[p("span",{class:"quickprint-config-id"},[O.id]),p(Th,{onCopy:x},null)])]),p("section",{class:"quickprint-config-section quickprint-config-inline"},[p("header",{class:"quickprint-config-header"},[ie("标题")]),p("div",{class:"quickprint-config-content"},[Se(p("input",{type:"text","onUpdate:modelValue":k=>O.title=k,class:"quickprint-form-control quickprint-w-full",placeholder:"请输入"},null),[[Ae,O.title]])])])]),y(),_(),v(),E()])])}}}),uv=F({setup(){const n=Ce(),e=Ne("classes");function t(){return p("div",{class:e.tip},[ie("未知的打印元素")])}function l(){return p("div",{class:e.tip},[ie("请先选择元素")])}function o(){const i=n.getSelectedPage()??n.doc.firstPage;return p(th,{page:i},null)}function s(){const i=n.getSelectedElements()[0];return i==null?l():Object.values(j).includes(i.type)===!1?t():mt(cv,{element:i,key:i.id})}function r(){const i=n.state;return i.selectedType!==ue.ELEMENT?!1:i.selectMode===it.SINGLE?!0:i.selected.length===1}return function(){return r()?s():o()}}}),dv="_tip_cdonk_2",fv={tip:dv},pv={classes:fv},mv=H(uv,[["__cssModules",pv]]);function Ke(n,e){if(n.state.selectedType!==ue.ELEMENT)return;const l=n.getSelectedElements();if(l.length===1)return l[0].getStyle(e)}function Ue(n,e,t){if(n.state.selectedType!==ue.ELEMENT)return;const o=n.getSelectedElements();if(o.length!=0){for(const s of o)s.setStyle(e,t);n.createSnapshot()}}function We(n,e){if(n.state.selectedType!==ue.ELEMENT)return;const l=n.getSelectedElements();if(l.length!=0){for(const o of l)o.removeStyle(e);n.createSnapshot()}}function gv(n){const e="underline";return L({get(){if(n.state.selectedType!==ue.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ue(n,e,t):We(n,e)}})}function hv(n){const e="lineThrough";return L({get(){if(n.state.selectedType!==ue.ELEMENT)return!1;const l=n.getSelectedElements();return l.length!==1?!1:l[0].getStyle(e)===!0},set(t){t?Ue(n,e,t):We(n,e)}})}function vv(n){const e="lineHeight";return L({get(){return Ke(n,e)},set(t){t===Rt.DEFAULT?We(n,e):Ue(n,e,t)}})}function bv(n){const e="highlightColor";return L({get(){return Ke(n,e)??qe.BLACK},set(t){t===""?We(n,e):Ue(n,e,t)}})}function yv(n){const e="backgroundColor";return L({get(){return Ke(n,e)??qe.BLACK},set(t){t===""?We(n,e):Ue(n,e,t)}})}function _v(n){const e="fontStyle";return L({get(){return Ke(n,e)===Rl.ITALIC},set(t){t?Ue(n,e,Rl.ITALIC):We(n,e)}})}function Ev(n){const e="textAlign";return L({get(){return Ke(n,e)??ft.LEFT},set(t){t===ft.LEFT?We(n,e):Ue(n,e,t)}})}function Tv(n){const e="verticalAlign";return L({get(){return Ke(n,e)??ot.MIDDLE},set(t){t===ot.MIDDLE?We(n,e):Ue(n,e,t)}})}function Sv(n){const e="fontFamily";return L({get(){return Ke(n,e)},set(t){t===re.DEFAULT?We(n,e):Ue(n,e,t)}})}function Rv(n){const e="fontSize";return L({get(){return Ke(n,e)},set(t){t===Re.DEFAULT?We(n,e):Ue(n,e,t)}})}function wv(n){const e="color";return L({get(){return Ke(n,e)??qe.BLACK},set(t){Ue(n,e,t)}})}function kv(n){const e="fontWeight";return L({get(){return Ke(n,e)===700},set(t){t?Ue(n,e,700):We(n,e)}})}const Lv=["title","onClick"],Cv=F({__name:"BorderSelect",setup(n){const e=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8,ALL:15}),t=Ce(),l=L(()=>{if(t.state.selectedType!==ue.ELEMENT)return null;const _=t.getSelectedElements();if(_.length!==1)return null;const c=_[0],v={};return be(c,"top")&&(v.borderTopStyle="solid"),be(c,"right")&&(v.borderRightStyle="solid"),be(c,"bottom")&&(v.borderBottomStyle="solid"),be(c,"left")&&(v.borderLeftStyle="solid"),v}),o=[{label:"上框线",value:e.TOP,icon:"icon-border-top"},{label:"下框线",value:e.BOTTOM,icon:"icon-border-bottom"},{label:"左框线",value:e.LEFT,icon:"icon-border-left"},{label:"右框线",value:e.RIGHT,icon:"icon-border-right"}];function s(y){if(t.state.selectedType!==ue.ELEMENT)return!1;const c=t.getSelectedElements();if(c.length!==1)return!1;const v=c[0];switch(y){case e.TOP:return be(v,"top");case e.RIGHT:return be(v,"right");case e.BOTTOM:return be(v,"bottom");case e.LEFT:return be(v,"left");case e.ALL:return be(v,"top")&&be(v,"right")&&be(v,"bottom")&&be(v,"left");default:return!1}}function r(y){if(t.state.selectedType!==ue.ELEMENT)return;const c=t.getSelectedElements();if(c.length!=0){switch(y){case e.TOP:return a(c);case e.BOTTOM:return f(c);case e.LEFT:return h(c);case e.RIGHT:return d(c);case e.ALL:return g(c)}t.createSnapshot()}}function i(){if(t.state.selectedType!==ue.ELEMENT)return;const _=t.getSelectedElements();if(_.length!=0){for(const c of _)c.setStyle("borderStyle",void 0),c.setStyle("borderTopStyle",void 0),c.setStyle("borderRightStyle",void 0),c.setStyle("borderBottomStyle",void 0),c.setStyle("borderLeftStyle",void 0);t.createSnapshot()}}function a(y){const _=!y.every(c=>be(c,"top"));for(const c of y)_?c.setStyle("borderTopStyle",Q.SOLID):c.removeStyle("borderTopStyle")}function d(y){const _=!y.every(c=>be(c,"right"));for(const c of y)_?c.setStyle("borderRightStyle",Q.SOLID):c.removeStyle("borderRightStyle")}function f(y){const _=!y.every(c=>be(c,"bottom"));for(const c of y)_?c.setStyle("borderBottomStyle",Q.SOLID):c.removeStyle("borderBottomStyle")}function h(y){const _=!y.every(c=>be(c,"left"));for(const c of y)_?c.setStyle("borderLeftStyle",Q.SOLID):c.removeStyle("borderLeftStyle")}function g(y){const _=!y.every(c=>be(c,"top")&&be(c,"right")&&be(c,"bottom")&&be(c,"left"));for(const c of y){if(_){c.setStyle("borderStyle",_?"solid":void 0);continue}c.removeStyle("borderStyle"),c.removeStyle("borderTopStyle"),c.removeStyle("borderRightStyle"),c.removeStyle("borderBottomStyle"),c.removeStyle("borderLeftStyle")}}return(y,_)=>(S(),ee(b(mo),null,{popover:_e(()=>[u("div",{class:m(y.classes.popover)},[u("div",null,[(S(),I("button",{type:"button",title:"全部框线",key:b(e).ALL,class:m({"quickprint-text-btn":!0,[y.classes.tool]:!0,"quickprint-is-selected":s(b(e).ALL)}),onClick:_[0]||(_[0]=c=>r(b(e).ALL))},[p(b(U),{icon:"icon-border",size:"16px"})],2)),(S(),I("button",{type:"button",title:"无框线",key:b(e).NONE,class:m({"quickprint-text-btn":!0,[y.classes.tool]:!0}),onClick:i},[p(b(U),{icon:"icon-border-none",size:"16px"})],2))]),u("div",{class:m(y.classes.divider)},[(S(),I(ne,null,ae(o,c=>u("button",{type:"button",title:c.label,key:c.value,class:m({"quickprint-text-btn":!0,[y.classes.tool]:!0,"quickprint-is-selected":s(c.value)}),onClick:v=>r(c.value)},[p(b(U),{icon:c.icon,size:"16px"},null,8,["icon"])],10,Lv)),64))],2)],2)]),default:_e(()=>[u("div",{class:m(["quickprint-text-btn",y.classes.borderSelect]),title:"边框"},[u("div",{class:m({[y.classes.border]:!0}),style:Z(l.value)},null,6)],2)]),_:1}))}}),Iv="_border_rprfx_2",Ov="_borderSelect_rprfx_10",Nv="_popover_rprfx_14",xv="_divider_rprfx_18",Dv={border:Iv,borderSelect:Ov,popover:Nv,divider:xv},Mv={classes:Dv},Av=H(Cv,[["__cssModules",Mv]]),Bv="_itemLabel_noxgo_1",$v="_fieldset_noxgo_7",Xo={itemLabel:Bv,fieldset:$v};function qv(n,e){var l,o;const t={width:n.width??"54px"};return p("label",{class:"quickprint-is-row"},[p("span",{class:Xo.itemLabel,style:t},[n.label]),(o=(l=e.slots).default)==null?void 0:o.call(l)])}function Pv(n,e){var l,o;const t=n.desc?p(ei,{title:n.desc},null):null;return p("div",{class:Xo.fieldset},[p("header",null,[p("span",null,[n.header]),t]),(o=(l=e.slots).default)==null?void 0:o.call(l)])}const ln={Item:qv,Fieldset:Pv},Vv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Fv={class:"quickprint-config-section"},zv={class:"quickprint-form-inline"},Uv={class:"quickprint-config-section quickprint-config-inline"},Hv=F({__name:"Paper",props:{config:{type:Object,required:!0}},setup(n){const e=n;de("mm");const t=[{label:"磅",value:pe.PT},{label:"像素",value:pe.PX},{label:"毫米",value:pe.MM}],l=g("top"),o=g("bottom"),s=g("left"),r=g("right"),i=L(()=>Kn.map(y=>({label:y.size===Jn.CUSTOM?"自定义":`${y.size}(${y.width}mm ✕ ${y.height}mm)`,value:y.size})));function a(y){e.config.width=y,h()}function d(y){e.config.height=y,h()}function f(y){const _=Kn.find(c=>c.size===y);_!=null&&(e.config.width=_.width,e.config.height=_.height,e.config.orientation=_.orientation,e.config.margins=_.margins,e.config.size=_.size)}function h(){const y=e.config,_=Kn.find(c=>c.size===Jn.CUSTOM?!1:c.orientation===y.orientation&&c.width===y.width&&c.height===y.height);if(_==null){y.size=Jn.CUSTOM;return}y.size=_.size}function g(y){return L({get(){var _;return(_=e.config.margins)==null?void 0:_[y]},set(_){e.config.margins==null&&(e.config.margins={}),e.config.margins[y]=_}})}return(y,_)=>(S(),I("div",Vv,[u("section",Fv,[_[5]||(_[5]=u("header",{class:"quickprint-config-header"},[u("span",null,"尺寸")],-1)),p(b(le),{options:i.value,modelValue:n.config.size,"onUpdate:modelValue":f,class:"quickprint-form-control-block quickprint-form-bottom-gap"},null,8,["options","modelValue"]),u("div",zv,[p(Vt,{class:"quickprint-form-inline-item",label:"宽",modelValue:n.config.width,min:1,"onUpdate:modelValue":a},null,8,["modelValue"]),p(Vt,{class:"quickprint-form-inline-item",label:"高",modelValue:n.config.height,min:1,"onUpdate:modelValue":d},null,8,["modelValue"])])]),u("section",Uv,[_[6]||(_[6]=u("header",{class:"quickprint-config-header"},"方向",-1)),p(Pt,{modelValue:n.config.orientation,"onUpdate:modelValue":_[0]||(_[0]=c=>n.config.orientation=c),options:b(ro)},null,8,["modelValue","options"])]),p(b(ln).Fieldset,{header:"参考边距",desc:"可用于标记可打印区域。请确保设打印元素在可打印区域内，避免内容被裁剪。"},{default:_e(()=>[u("div",{class:m(y.classes.margins)},[p(b(ln).Item,{label:"上边距"},{default:_e(()=>[p(Pe,{modelValue:b(l),"onUpdate:modelValue":_[1]||(_[1]=c=>st(l)?l.value=c:null),options:t,defaultUnit:b(pe).MM},null,8,["modelValue","defaultUnit"])]),_:1}),p(b(ln).Item,{label:"下边距"},{default:_e(()=>[p(Pe,{modelValue:b(o),"onUpdate:modelValue":_[2]||(_[2]=c=>st(o)?o.value=c:null),options:t,defaultUnit:b(pe).MM},null,8,["modelValue","defaultUnit"])]),_:1}),p(b(ln).Item,{label:"左边距"},{default:_e(()=>[p(Pe,{modelValue:b(s),"onUpdate:modelValue":_[3]||(_[3]=c=>st(s)?s.value=c:null),options:t,defaultUnit:b(pe).MM},null,8,["modelValue","defaultUnit"])]),_:1}),p(b(ln).Item,{label:"右边距"},{default:_e(()=>[p(Pe,{modelValue:b(r),"onUpdate:modelValue":_[4]||(_[4]=c=>st(r)?r.value=c:null),options:t,defaultUnit:b(pe).MM},null,8,["modelValue","defaultUnit"])]),_:1})],2)]),_:1})]))}}),Gv="_margins_1x2w9_2",Wv={margins:Gv},Yv={classes:Wv},Xv=H(Hv,[["__cssModules",Yv]]),jv={class:"quickprint-is-fill-h quickprint-is-scrollable quickprint-p-4"},Zv={class:"quickprint-is-fill-h"},Kv={class:"quickprint-is-fill-h"},Jv=F({__name:"Font",props:{config:{type:Object,required:!0}},setup(n){const e=n,t=[{label:"倍",value:pe.NONE},{label:"磅",value:pe.PT},{label:"像素",value:pe.PX}],l=L(()=>Hn.map(d=>(d.style={fontFamily:d.value==re.DEFAULT?re.SONG:d.value},d))),o=L(()=>ko.map(d=>(d.style={fontFamily:d.value==re.DEFAULT?re.SONG:d.value},d))),s=L({get(){return e.config.style.fontFamily??re.DEFAULT},set(d){const f=d===re.DEFAULT?void 0:d;e.config.style.fontFamily=f}}),r=L({get(){return e.config.style.enFontFamily??re.DEFAULT},set(d){const f=d===re.DEFAULT?void 0:d;e.config.style.enFontFamily=f}}),i=L({get(){return e.config.style.fontSize},set(d){const f=me(d)?void 0:d;e.config.style.fontSize=f}}),a=L({get(){return e.config.style.lineHeight},set(d){e.config.style.lineHeight=d}});return(d,f)=>(S(),I("div",jv,[u("section",{class:m(d.classes.font)},[u("div",{class:m(d.classes.zhFont)},[u("div",{class:m(d.classes.title)},"中文字体",2),u("div",Zv,[p(b(le),{options:l.value,modelValue:s.value,"onUpdate:modelValue":f[0]||(f[0]=h=>s.value=h)},null,8,["options","modelValue"])])],2),u("div",{class:m(d.classes.enFont)},[u("div",{class:m(d.classes.title)},"西文字体",2),u("div",Kv,[p(b(le),{options:o.value,modelValue:r.value,"onUpdate:modelValue":f[1]||(f[1]=h=>r.value=h)},null,8,["options","modelValue"])])],2),u("div",{class:m(d.classes.lineHeight)},[u("div",{class:m(d.classes.title)},"行高",2),p(Pe,{modelValue:a.value,"onUpdate:modelValue":f[2]||(f[2]=h=>a.value=h),options:t},null,8,["modelValue"])],2),u("div",{class:m(d.classes.fontSize)},[u("div",{class:m(d.classes.title)},"字号",2),p(Co,{modelValue:i.value,"onUpdate:modelValue":f[3]||(f[3]=h=>i.value=h),height:"144px"},null,8,["modelValue"])],2)],2)]))}}),Qv="_font_145qf_2",eb="_zhFont_145qf_9",tb="_enFont_145qf_16",nb="_lineHeight_145qf_23",lb="_fontSize_145qf_30",ob="_title_145qf_45",sb={font:Qv,zhFont:eb,enFont:tb,lineHeight:nb,fontSize:lb,title:ob},ib={classes:sb},rb=H(Jv,[["__cssModules",ib]]),ab=F({__name:"index",props:{doc:{type:Ee,required:!0},active:{type:String,default:null}},setup(n){const e=n,t=Ze(),l=Oe(o());function o(){const i=e.doc;return{size:i.paper.size,width:i.paper.width,height:i.paper.height,orientation:i.paper.orientation,margins:i.margins?{...i.margins}:void 0,style:{...i.style}}}function s(){t==null||t.confirm(l)}function r(){t==null||t.cancel()}return(i,a)=>(S(),I("div",{class:m(i.classes.setting)},[n.active=="paper"?(S(),ee(Xv,{key:0,config:l},null,8,["config"])):Y("",!0),n.active=="font"?(S(),ee(rb,{key:1,config:l},null,8,["config"])):Y("",!0),u("div",{class:m(i.classes.footer)},[u("button",{type:"button",class:"quickprint-text-btn",onClick:r},"取消"),u("button",{type:"button",class:"quickprint-text-btn",onClick:s},"确定")],2)],2))}}),cb="_setting_h98ws_2",ub="_footer_h98ws_10",db={setting:cb,footer:ub},fb={classes:db},pb=H(ab,[["__cssModules",fb]]),mb=ke(function(n){return vt("文档",(e,t)=>p(pb,{doc:n,active:t},null),{preset:"setting",icon:"svg:icon-setting",tabs:[{label:"纸张",name:"paper",active:!0},{label:"字体",name:"font"}]}).promisify().then(e=>(n.paper.size=e.size,n.paper.width=e.width,n.paper.height=e.height,n.paper.orientation=e.orientation,n.margins=e.margins,n.style=e.style,e)).catch(Le)}),gb=F({props:{toolbar:{type:Array,required:!0}},setup(n){const e=Ce(),t=Ne("classes"),l=Sv(e),o=Rv(e),s=vv(e),r=yv(e),i=bv(e),a=wv(e),d=kv(e),f=_v(e),h=gv(e),g=hv(e),y=Ev(e),_=Tv(e),c=L(()=>Hn.map(M=>(M.style={fontFamily:M.value==re.DEFAULT?re.SONG:M.value},M)));function v(M){return p("button",{type:"button",class:"quickprint-text-btn",onClick:()=>M.handler(e)},[M.icon&&p(U,{icon:M.icon},null),p("span",null,[M.label])])}function E(M){M.preventDefault()}function x(){d.value=!d.value}function C(){f.value=!f.value}function O(){h.value=!h.value}function k(){g.value=!g.value}function $(){const M=e.getSelectedElements();if(M.length==0)return;const T=Math.min(...M.map(R=>R.left));for(const R of M)R.setLeft(T,!0);e.createSnapshot()}function B(){const M=e.getSelectedElements();if(M.length==0)return;const T=M[0].page;if(T==null)return;const R=Xt(T.width);for(const w of M)w.setLeft((R-w.width)/2);e.createSnapshot()}function q(){const M=e.getSelectedElements();if(M.length==0)return;const T=Math.max(...M.map(R=>R.left+R.width));for(const R of M)R.setLeft(T-R.width,!0);e.createSnapshot()}async function A(){const M=await hc(e.doc);M!=null&&(e.doc.ds=e.doc.createDS(M))}function D(){mb(e.doc)}function N(M){var T,R;if(typeof M=="function")return M(e,t);if(typeof M=="object")return v(M);if(typeof M!="string")return null;switch(M){case"divider":case"---":return p("div",{class:t.divider},null);case"space":return p("div",{class:"quickprint-is-fill-w"},null);case"undo":{const w=!e.history.allowUndo();return p("button",{type:"button",title:"撤销 Ctrl + Z",class:"quickprint-text-btn",disabled:w,onClick:e.history.undo},[p(U,{icon:"icon-undo"},null)])}case"redo":{const w=!e.history.allowRedo();return p("button",{type:"button",title:"重做 Ctrl + Y",class:"quickprint-text-btn",disabled:w,onClick:e.history.redo},[p(U,{icon:"icon-redo"},null)])}case"delete":return p("button",{type:"button",class:["quickprint-text-btn",t.tool],title:"删除",onClick:e.deleteSelectedElement},[p(U,{icon:"icon-delete",size:"16px"},null)]);case"fontFamily":return p(le,{title:"字体",width:"80px",modelValue:l.value,"onUpdate:modelValue":w=>l.value=w,options:c.value,class:t.tool,button:!0},null);case"fontSize":return p(le,{title:"字号",width:"60px",modelValue:o.value,"onUpdate:modelValue":w=>o.value=w,options:yl,class:t.tool,button:!0},null);case"lineHeight":return p(le,{title:"行高",width:"60px",modelValue:s.value,"onUpdate:modelValue":w=>s.value=w,options:Lo,class:t.tool,popoverWidth:120,button:!0},null);case"backgroundColor":return p(Ut,{modelValue:r.value,"onUpdate:modelValue":w=>r.value=w,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"背景色"},[p(U,{icon:"icon-bg-color-a",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:r.value}},null)])]});case"highlightColor":return p(Ut,{modelValue:i.value,"onUpdate:modelValue":w=>i.value=w,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"突出显示"},[p(U,{icon:"icon-bg-color-b",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:i.value}},null)])]});case"fontColor":return p(Ut,{modelValue:a.value,"onUpdate:modelValue":w=>a.value=w,class:t.tool},{default:()=>[p("div",{class:t.colorIcon,title:"字体颜色"},[p(U,{icon:"icon-font",size:"15px"},null),p("div",{class:t.colorIndicator,style:{backgroundColor:a.value}},null)])]});case"fontWeight":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":d.value};return p("button",{type:"button",title:"加粗",class:w,onClick:x},[p(U,{icon:"icon-font-bold",size:"16px"},null)])}case"fontStyle":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":f.value};return p("button",{type:"button",title:"斜体",class:w,onClick:C},[p(U,{icon:"icon-italic",size:"16px"},null)])}case"underline":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":h.value};return p("button",{type:"button",title:"下划线",class:w,onClick:O},[p(U,{icon:"icon-underline",size:"16px"},null)])}case"throughLine":{const w={"quickprint-text-btn":!0,[t.tool]:!0,"quickprint-is-selected":g.value};return p("button",{type:"button",title:"删除线",class:w,onClick:k},[p(U,{icon:"icon-through-line",size:"16px"},null)])}case"border":return p(Av,null,null);case"textAlign":{const w=((T=il.find(P=>P.value===y.value))==null?void 0:T.label)??"水平对齐",V={selected({option:P}){return p(U,{icon:P==null?void 0:P.icon,class:"quickprint-is-self-center"},null)}};return p(le,{modelValue:y.value,"onUpdate:modelValue":P=>y.value=P,options:il,title:w,class:t.tool,width:"36px",size:"mini",button:!0},V)}case"verticalAlign":{const w=((R=sl.find(P=>P.value===_.value))==null?void 0:R.label)??"垂直对齐",V={selected({option:P}){return p(U,{icon:P==null?void 0:P.icon,class:"quickprint-is-self-center"},null)}};return p(le,{modelValue:_.value,"onUpdate:modelValue":P=>_.value=P,options:sl,title:w,class:t.tool,width:"36px",size:"mini",button:!0},V)}case"alignLeft":{const w={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"左侧对齐",class:w,onClick:$},[p(U,{icon:"icon-layout-align-left",size:"16px"},null)])}case"alignCenter":{const w={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"水平居中",class:w,onClick:B},[p(U,{icon:"icon-layout-align-center",size:"16px"},null)])}case"alignRight":{const w={"quickprint-text-btn":!0,[t.tool]:!0};return p("button",{type:"button",title:"右侧对齐",class:w,onClick:q},[p(U,{icon:"icon-layout-align-right",size:"16px"},null)])}case"useGrid":{const w={"quickprint-text-btn":!0,"quickprint-is-selected":e.doc.useGrid};return p("button",{type:"button",title:"网格",class:w,onClick:e.toggleBackground},[p(U,{icon:"icon-beijing",size:"16px"},null)])}case"elementPanel":{const w={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.left};return p("button",{type:"button",title:"元素面板",class:w,onClick:e.toggleElementPanel},[p(U,{icon:"icon-pintu",size:"16px"},null)])}case"configPanel":{const w={"quickprint-text-btn":!0,"quickprint-is-selected":e.state.panel.right};return p("button",{type:"button",title:"配置面板",class:w,onClick:e.toggleConfigPanel},[p(U,{icon:"icon-config",size:"16px"},null)])}case"datasource":return p("button",{type:"button",class:"quickprint-text-btn",onClick:A},[p(U,{icon:"icon-datasource"},null),p("span",null,[ie("数据源")])]);case"document":return p("button",{type:"button",class:"quickprint-text-btn",onClick:D},[p(U,{icon:"icon-file-text"},null),p("span",null,[ie("文档配置")])]);default:return null}}return function(){return p("div",{class:t.toolbar,onMousedown:E},[n.toolbar.map(N)])}}}),hb="_toolbar_1bhq2_2",vb="_divider_1bhq2_8",bb="_tool_1bhq2_2",yb="_colorIcon_1bhq2_18",_b="_colorIndicator_1bhq2_38",Eb={toolbar:hb,divider:vb,tool:bb,colorIcon:yb,colorIndicator:_b},Tb={classes:Eb},Sb=H(gb,[["__cssModules",Tb]]);function Rb(n){let e=null;const t=ge(),l=Oe({width:0,height:0,scrollTop:0,scrollLeft:0}),o=ge(),s=Oe({id:"",top:0,left:0,width:0,height:0});async function r(){await jt();const y=t.value;y!=null&&(l.width=y.offsetWidth,l.height=y.offsetHeight)}function i(y){const _=y.target;l.scrollLeft=_.scrollLeft,l.scrollTop=_.scrollTop}function a(y){const c=y.target.closest("."+J.PAPER);c!=null&&(o.value=c,f(c),d())}async function d(){await jt();const y=o.value;y!=null&&(s.id=y.id.slice(1),s.width=y.offsetWidth,s.height=y.offsetHeight,s.top=y.offsetTop,s.left=y.offsetLeft)}function f(y){y!=null&&(o.value&&(e==null||e.unobserve(o.value)),e==null||e.observe(y))}function h(){const y=n.doc.firstPage;if(y==null)return;const _=document.querySelector("#\\@"+y.id);o.value=_,e&&_&&e.observe(_),d()}function g(y){y.some(_=>_.target.matches("."+J.CANVAS))&&(r(),d()),y.some(_=>_.target.matches("."+J.PAPER))&&(r(),d())}return fl(()=>n.state.scale,()=>d()),pn(()=>{e=new ResizeObserver(g),e.observe(t.value),h(),r()}),Ds(()=>{e==null||e.disconnect(),e=null}),{canvasRef:t,canvasRect:l,pageRect:s,onScroll:i,onSelectPage:a}}const jo=Object.freeze(["undo","redo","delete","---","fontFamily","fontSize","lineHeight","---","backgroundColor","highlightColor","fontColor","fontWeight","fontStyle","underline","throughLine","---","border","textAlign","verticalAlign","---","alignLeft","alignCenter","alignRight","---","useGrid","elementPanel","configPanel","---","datasource","document"]),wb=F({__name:"index",props:Dt({modelValue:{type:Ee,required:!0},toolbar:{type:Array,default(){return jo}}},{modelValue:{required:!0},modelModifiers:{}}),emits:Dt(["save","preview"],["update:modelValue"]),setup(n,{emit:e}){const t=e,l=ge(),o=ge(),s=Ys(),r=fn(n,"modelValue"),i=bm(r,{queryElement:E,dispatchEvent:x}),{canvasRef:a,canvasRect:d,pageRect:f,onScroll:h,onSelectPage:g}=Rb(i),y=L(()=>({"--quickprint-page-scale":i.state.scale/100,"--quickprint-dpr":s.value})),_=L(()=>{const O=i.doc.style;return{fontFamily:ul(O==null?void 0:O.fontFamily,O==null?void 0:O.enFontFamily),fontSize:O==null?void 0:O.fontSize,lineHeight:O==null?void 0:O.lineHeight}});function c(){i.state.panel.left=!1}function v(){i.state.panel.right=!1}function E(O){switch(O){case"ghost":return o.value;case"root":return l.value;default:return}}function x(O,...k){t(O,...k)}function C(O){O.deltaY>0?i.zoomIn():i.zoomOut()}return(O,k)=>(S(),I("div",{class:m(O.classes.designer),ref_key:"rootRef",ref:l,style:Z(y.value)},[u("div",{class:m(O.classes.header)},[rt(O.$slots,"headerLeft"),p(Sb,{class:m(O.classes.toolbar),toolbar:n.toolbar},null,8,["class","toolbar"]),rt(O.$slots,"headerRight")],2),u("div",{class:m(O.classes.main)},[b(i).state.panel.left?(S(),I("div",{key:0,class:m(O.classes.left)},[u("button",{type:"button",onClick:c,class:m(["quickprint-text-btn",O.classes.closePanelBtn])},[p(b(U),{icon:"icon-close",size:"12px"})],2),p(Eg)],2)):Y("",!0),u("div",{class:m([O.classes.center,b(J).CANVAS]),onWheel:se(C,["ctrl","stop","prevent"]),ref_key:"canvasRef",ref:a},[p(Vl,{canvas:b(d),page:b(f),scale:b(i).state.scale,direction:"horizontal"},null,8,["canvas","page","scale"]),p(Vl,{canvas:b(d),page:b(f),scale:b(i).state.scale,direction:"vertical"},null,8,["canvas","page","scale"]),u("div",{class:m([b(J).SCROLLABLE,O.classes.canvas]),style:Z(_.value),onScroll:k[0]||(k[0]=(...$)=>b(h)&&b(h)(...$)),onClickCapture:k[1]||(k[1]=(...$)=>b(g)&&b(g)(...$))},[(S(!0),I(ne,null,ae(r.value.pages,$=>(S(),ee(ug,{key:$.id,doc:r.value,page:$},null,8,["doc","page"]))),128))],38),u("div",{class:m(O.classes.footer)},[p(Og),p(b(Ts),{scale:b(i).state.scale,onZoomIn:b(i).zoomIn,onZoomOut:b(i).zoomOut},null,8,["scale","onZoomIn","onZoomOut"])],2)],34),b(i).state.panel.right?(S(),I("div",{key:1,class:m(O.classes.right)},[u("button",{type:"button",onClick:v,class:m(["quickprint-text-btn",O.classes.closePanelBtn])},[p(b(U),{icon:"icon-close",size:"12px"})],2),p(mv)],2)):Y("",!0)],2),u("div",{ref_key:"ghostRef",ref:o,class:m(O.classes.ghost)},null,2),p(b(Ss))],6))}}),kb="_designer_grxxm_2",Lb="_header_grxxm_17",Cb="_toolbar_grxxm_25",Ib="_footer_grxxm_31",Ob="_main_grxxm_47",Nb="_left_grxxm_55",xb="_center_grxxm_63",Db="_right_grxxm_75",Mb="_canvas_grxxm_83",Ab="_closePanelBtn_grxxm_96",Bb="_ghost_grxxm_103",$b={designer:kb,header:Lb,toolbar:Cb,footer:Ib,main:Ob,left:Nb,center:xb,right:Db,canvas:Mb,closePanelBtn:Ab,ghost:Bb},qb={classes:$b},Pb=H(wb,[["__cssModules",qb]]),Vb={default:{pinnable:!1},editor:{pinnable:!1,mask:!0,top:"15vh",width:"800px",height:"480px",resizeMode:Ft.DISABLED,menus:[{label:"确定",handler:n=>n.dispatchConfirm().catch(Le)}]},docDebug:{width:"1200px",height:"860px",menus:[{label:"保存",handler:n=>n.dispatchConfirm()}]},elementDebug:{width:"1200px",height:"860px",pinnable:!1},setting:{pinnable:!1,top:"15vh",width:"420px",height:"520px",resizeMode:Ft.DISABLED},variable:{pinnable:!1,top:"15vh",width:"840px",height:"600px",mask:!0,resizeMode:Ft.DISABLED}};function Fb(n,e={}){const t=Rs(e.zIndexManager);n.use(ws,{zIndex:t,presets:Vb}),ks(n._context)}const zb="0.0.0",Ub={version:zb,install:Fb},Hb=["onClick"],Gb=F({__name:"SwitchCase",emits:["switch"],setup(n,{emit:e}){const t=Ze();function l(o){t==null||t.confirm(o)}return(o,s)=>(S(),I("div",{class:m(o.classes.panel)},[(S(!0),I(ne,null,ae(b(Ls),(r,i)=>(S(),I("div",{key:r.id,class:m(o.classes.item),onClick:a=>l(r)},[u("div",null,[u("span",null,K(i+1)+". ",1),u("span",null,K(r.name),1)])],10,Hb))),128))],2))}}),Wb="_panel_1he7q_2",Yb="_item_1he7q_9",Xb={panel:Wb,item:Yb},jb={classes:Xb},Zb=H(Gb,[["__cssModules",jb]]),Kb='<div class="quickprint-md"><h3>预览</h3><ul><li>fix: 改进元素对齐机制，使用flex布局实现</li><li>feat: 预览时，支持打印选项（右侧面板）<ul><li>只有在连接到打印插件时才显示</li><li>打印页面</li><li>份数</li><li>打印机</li><li>打印选项参照wps</li></ul></li><li>feat: 预览时支持键盘操作<ul><li>键盘翻页</li></ul></li></ul></div>',Jb=["innerHTML"],Qb=F({__name:"Todo",setup(n){return(e,t)=>(S(),I("div",{innerHTML:b(Kb),class:m(e.classes.doc)},null,10,Jb))}}),ey="_doc_15jua_2",ty={doc:ey},ny={classes:ty},ly=H(Qb,[["__cssModules",ny]]),oy="local",zl="quickprint-local-define",sy=F({__name:"index",setup(n){const e=Ne("classes"),t=y(),l="20251208",o=[{label:"新建",icon:"icon-file-text",handler:f},{label:"加载示例",icon:"icon-import",handler:a},"---",...jo];function s(){const c=JSON.stringify(t.value);localStorage.setItem(zl,c)}function r(){s()}function i(){const c=t.value.id,v=c.startsWith("case_")?c:oy,E=`${window.location.origin}/preview.html?id=${v}`;s(),Xe("文档预览",mt("iframe",{src:E,className:e.iframe}),{pinnable:!1,mask:!0,closeOnPressEsc:!0,width:Math.min(Math.max(1600,t.value.paperWidth+240),window.innerWidth-20)+"px",height:"calc(100vh - 100px)",menus:[{label:"从外部打开链接",handler(x){window.open(E,"_blank"),x.close()}}]})}function a(){const c={mask:!0,top:"15vh",width:"800px",height:"600px",resizeMode:Ft.DISABLED};Xe("选择示例",mt(Zb),c).promisify().then(v=>d(v.id)).catch(Le)}async function d(c){const v=await wl(c,!1);v!=null&&(Cs(c),t.value=Ee.create(v.define),h())}function f(){const c=Ee.createNormalDocument();t.value=c,h()}function h(){document.title=t.value.name+" - OpenPrint(开发中...)"}async function g(){const c=localStorage.getItem(zl);if(c!=null)return Ee.create(c);const v=Is(),E=await wl(v.id,!1);return E==null?Ee.createNormalDocument():Ee.create(E.define)}function y(){const c=de();return g().then(v=>{c.value=v,h()}),c}const _=ke(function(){return Xe("待办事项",mt(ly),{minHeight:360}).promisify().catch(lt)});return(c,v)=>b(t)?(S(),ee(b(Pb),{modelValue:b(t),"onUpdate:modelValue":v[1]||(v[1]=E=>st(t)?t.value=E:null),toolbar:o,class:m(b(e).main),key:b(t).id,onSave:r,onPreview:i},{headerLeft:_e(()=>[u("div",{class:m(b(e).logo)},[v[2]||(v[2]=u("h1",null,"OpenPrint",-1)),u("div",{class:m(b(e).dev),onClick:v[0]||(v[0]=(...E)=>b(_)&&b(_)(...E))},"DEV_"+K(b(l)),3)],2)]),headerRight:_e(()=>[u("div",{class:m(b(e).operate)},[u("button",{type:"button",class:"quickprint-text-btn",title:"预览",onClick:i},[p(b(U),{icon:"icon-run"}),v[3]||(v[3]=u("span",null,"预览",-1))]),u("button",{type:"button",onClick:s,class:"quickprint-text-btn",title:"保存"},[p(b(U),{icon:"icon-save"}),v[4]||(v[4]=u("span",null,"保存",-1))])],2)]),_:1},8,["modelValue","class"])):Y("",!0)}}),iy="_main_14ojw_2",ry="_iframe_14ojw_6",ay="_divider_14ojw_14",cy="_logo_14ojw_20",uy="_dev_14ojw_39",dy="_operate_14ojw_52",fy={main:iy,iframe:ry,divider:ay,logo:cy,dev:uy,operate:dy},py={classes:fy},my=H(sy,[["__cssModules",py]]),Zo=Ms(my);Zo.use(Ub);Zo.mount("#app");
