const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-CXH56Phs.js","assets/utils-B3YDrDEo.js","assets/vue-B00pXJJQ.js","assets/utils-DCW1KeBq.css"])))=>i.map(i=>d[i]);
var Ar=Object.defineProperty;var bn=e=>{throw TypeError(e)};var br=(e,t,n)=>t in e?Ar(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var P=(e,t,n)=>br(e,typeof t!="symbol"?t+"":t,n),Vt=(e,t,n)=>t.has(e)||bn("Cannot "+n);var H=(e,t,n)=>(Vt(e,t,"read from private field"),n?n.call(e):t.get(e)),de=(e,t,n)=>t.has(e)?bn("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),it=(e,t,n,r)=>(Vt(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),st=(e,t,n)=>(Vt(e,t,"access private method"),n);var Rn=(e,t,n,r)=>({set _(i){it(e,t,i,n)},get _(){return H(e,t,r)}});import{M as Rr,ap as fn,aq as hn,aM as Be,r as tn,au as Or,av as Mr,b as se,aN as B,H as Ee,o as dn,F as Qe,i as vt,P as Pr,m as et,D as Et,G as Ir,V as Gt,aO as ct,a as ot,N as zt,O as _t,n as Cr,E as On,t as pn,x as nn,a4 as Lr,u as Qn,v as kr,w as We,y as xr,z as qr,A as $r,B as Fr,c as ae,q as Hr,Q as rn,L as Ur,aP as Br,U as Yr,_ as $t,I as sn,aC as Vr,R as Gr,aQ as er,h as me,T as zr,W as jr,$ as Wr,K as Zr,aE as Xr,X as Kr,aR as Mn,aS as Pn,aJ as Jr,aI as In,aF as Qr,aG as ei,aH as ti}from"./utils-B3YDrDEo.js";import{d as dt,h as be,c as Ze,a as Ye,b as ue,n as ie,v as bt,e as W,H as Rt,u as tr,s as Ot,g as nr,B as ni,i as J,f as Cn,F as ri,w as ii,y as si,E as Ln,G as oi,S as ai,N as ui,r as jt,j as ci,R as li}from"./vue-B00pXJJQ.js";const le=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),Dt=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),on=Object.freeze({CREATED:0,MOUNDTED:1}),ce={UNDEFINED:0,PENDING:1,DONE:2},Se={PENDING:-1,HIDDEN:0,VISIBLE:1},at=[25,50,75,100,125,150,200,300,400],fi=["class","className","style"],Ae=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDDE_LINE:"quickprint-guide-line"}),kn=Promise.resolve(),hi=2e3,di=48;let an=0,Tt=0;function pi(){an=0,Tt=0}function Ge(){return an<=hi?(an++,kn):Tt<di?(Tt++,kn):new Promise(e=>{Tt=0,setTimeout(e)})}function mi(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&(e.charCodeAt(2)>122||e.charCodeAt(2)<97)}function gi(e){return e.charCodeAt(0)===111&&e.charCodeAt(1)===110&&e.charCodeAt(2)>96&&e.charCodeAt(2)<123}function un(e){return e==null?"":typeof e=="string"?e.trim():Array.isArray(e)?e.map(un).join(" "):typeof e=="object"?Object.keys(e).filter(t=>e[t]).join(" "):""}function rr(e,t){if(t!=null){if(t instanceof Element){e.appendChild(t);return}if(Array.isArray(t)){for(const n of t)rr(e,n);return}e.textContent+=t}}function vi(e,t){if(!(t==null||typeof t!="object"))for(const n of Object.keys(t)){const r=t[n];if(r==null)continue;const i=Rr(n);e.style.setProperty(i,r)}}function Ei(e,t){if(un(t)=="")return;const r=e.className==""?"":" ";e.className+=r+un(t)}function ir(e,t,n){switch(t){case"class":case"className":Ei(e,n);break;case"style":vi(e,n);break;case"children":n!=null&&rr(e,n);break;case"innerHTML":break;default:if(t[0]==="@")return wi(e,t,n);t in e&&(e[t]=n),n==null?e.removeAttribute(t):e.setAttribute(t,n)}}function wi(e,t,n){Reflect.set(e,t.slice(1),n)}function yi(e,t,n){const r=e(t);if(r==null)return null;for(const i of Object.keys(t??{}))(mi(i)||gi(i)||fi.includes(i))&&ir(r,i,t[i]);return r}function Ni(e,t,n){const r=document.createElement(e);if(r==null)return null;for(const i of Object.keys(t??{}))ir(r,i,t[i]);return r}function Q(e,t,n){return typeof e=="function"?yi(e,t):Ni(e,t)}function xn(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var Lt,Le;const kt=class kt{constructor(t,n,r){de(this,Lt,fn(hn.PRINT_PAGE));de(this,Le,Object.create(null));P(this,"file");P(this,"define");P(this,"pageNum",-1);P(this,"pageTotal",-1);P(this,"extra",!1);P(this,"paper");P(this,"header");P(this,"footer");P(this,"children",[]);P(this,"fixed",[]);P(this,"parent");P(this,"element");P(this,"rendering");P(this,"state",Dt.CREATED);this.file=r,this.define=t,this.paper=this.createPaper(t,n),this.header=this.createHeader(),this.footer=this.createFooter(),Be(this,"parent",null),Be(this,"element",null),Be(this,"rendering",0)}static create(t,n,r="0000"){return new kt(t,n,r)}get id(){return"@"+H(this,Lt)}get index(){return this.parent==null?-1:this.parent.pages.findIndex(t=>t.id===this.id)}get defines(){const t=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>t.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>t.add(i.id)),this.define.children.filter(i=>!t.has(i.id)).sort(tn.sort)}get style(){const{offsetWidth:t,offsetHeight:n}=this.paper;return{width:t+"px",height:n+"px"}}get isLast(){return this.pageNum===this.pageTotal}createPageHeader(){const t=this.header;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[Ae.GUIDDE_LINE,Ae.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}createPageFooter(){const t=this.footer;if(t.display!==!0)return null;const n={top:t.offsetTop+"px"},r=[Ae.GUIDDE_LINE,Ae.PRINT_HIDDEN];return[...t.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}render(){return Q("div",{id:this.id,class:Ae.PAGE,"data-index":this.index+1,children:Q("div",{class:Ae.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(t){this.state=Dt.PAGED,await this.onPaged()}async mountChild(t){if(this.element==null||t.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(t.element),await Ge(),await t.mount(t.element),!0)}async replaceChild(t,n){if(this.element==null||t.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null?r.removeChild(t.element):r.replaceChild(n,t.element),await Ge(),await t.mount(n),!0)}beginPaging(){this.state=Dt.PAGING}onCreated(){const t=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(t.map(n=>n.onCreated()))}onPaged(){const t=this.children.map(n=>typeof n.onPaged=="function"?n.onPaged():Promise.resolve());return Promise.allSettled(t)}onFinshed(){const t=this.children.map(r=>typeof r.onFinished=="function"?r.onFinished():Promise.resolve()),n=this.adjustFooter();return n&&t.push(n),Promise.allSettled(t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),H(this,Le)[t.id]=t}appendToHeader(t){t.setParent(this),this.header.children.push(t),H(this,Le)[t.id]=t}appendToFooter(t){t.setParent(this),this.footer.children.push(t),H(this,Le)[t.id]=t}appendToFixed(t){t.setParent(this),this.fixed.push(t),H(this,Le)[t.id]=t}createPaper(t,n){return{size:n.size,width:n.width,height:n.height,orientation:t.orientation,offsetWidth:Math.round(n.width),offsetHeight:Math.round(n.height)}}createHeader(){const t=this.define.header;if(t.display!==!0)return xn();const n=t.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const t=this.define.footer;if(t.display!==!0)return xn();const n=t.height??0,i=Math.floor(Or(this.paper.height))-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const t=new kt(this.define,this.paper,this.file);t.rendering=0;for(const n of this.header.children){const r=n.clone();t.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();t.appendToFooter(r)}return t}findElement(t){const n=H(this,Le)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}filterElement(t){const n=typeof t=="string"?t:t.id;return this.children.filter(r=>r.define.id===n)}adjustFooter(){if(!this.isLast||this.define.footer.flow!==Mr.TABLE)return;let t=0,n=null;for(const i of this.children)if(i.offsetBottom>t&&(t=i.offsetBottom),i.type===se.TABLE){if(n==null){n=i;continue}i.offsetBottom>n.offsetBottom&&(n=i)}if(n==null||Math.abs(t-n.offsetBottom)>=4)return;const r=Math.floor(this.footer.offsetTop-n.offsetBottom);return Promise.allSettled(this.footer.children.map(i=>(i.offsetTop-=r,i.updateElement())))}};Lt=new WeakMap,Le=new WeakMap;let Mt=kt;var tt=1e9,_i={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},gn,V=!0,ge="[DecimalError] ",Ve=ge+"Invalid argument: ",mn=ge+"Exponent out of range: ",nt=Math.floor,$e=Math.pow,Di=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe,ne=1e7,Y=7,sr=9007199254740991,Pt=nt(sr/Y),_={};_.absoluteValue=_.abs=function(){var e=new this.constructor(this);return e.s&&(e.s=1),e};_.comparedTo=_.cmp=function(e){var t,n,r,i,s=this;if(e=new s.constructor(e),s.s!==e.s)return s.s||-e.s;if(s.e!==e.e)return s.e>e.e^s.s<0?1:-1;for(r=s.d.length,i=e.d.length,t=0,n=r<i?r:i;t<n;++t)if(s.d[t]!==e.d[t])return s.d[t]>e.d[t]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};_.decimalPlaces=_.dp=function(){var e=this,t=e.d.length-1,n=(t-e.e)*Y;if(t=e.d[t],t)for(;t%10==0;t/=10)n--;return n<0?0:n};_.dividedBy=_.div=function(e){return Oe(this,new this.constructor(e))};_.dividedToIntegerBy=_.idiv=function(e){var t=this,n=t.constructor;return F(Oe(t,new n(e),0,1),n.precision)};_.equals=_.eq=function(e){return!this.cmp(e)};_.exponent=function(){return X(this)};_.greaterThan=_.gt=function(e){return this.cmp(e)>0};_.greaterThanOrEqualTo=_.gte=function(e){return this.cmp(e)>=0};_.isInteger=_.isint=function(){return this.e>this.d.length-2};_.isNegative=_.isneg=function(){return this.s<0};_.isPositive=_.ispos=function(){return this.s>0};_.isZero=function(){return this.s===0};_.lessThan=_.lt=function(e){return this.cmp(e)<0};_.lessThanOrEqualTo=_.lte=function(e){return this.cmp(e)<1};_.logarithm=_.log=function(e){var t,n=this,r=n.constructor,i=r.precision,s=i+5;if(e===void 0)e=new r(10);else if(e=new r(e),e.s<1||e.eq(fe))throw Error(ge+"NaN");if(n.s<1)throw Error(ge+(n.s?"NaN":"-Infinity"));return n.eq(fe)?new r(0):(V=!1,t=Oe(ft(n,s),ft(e,s),s),V=!0,F(t,i))};_.minus=_.sub=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?ur(t,e):or(t,(e.s=-e.s,e))};_.modulo=_.mod=function(e){var t,n=this,r=n.constructor,i=r.precision;if(e=new r(e),!e.s)throw Error(ge+"NaN");return n.s?(V=!1,t=Oe(n,e,0,1).times(e),V=!0,n.minus(t)):F(new r(n),i)};_.naturalExponential=_.exp=function(){return ar(this)};_.naturalLogarithm=_.ln=function(){return ft(this)};_.negated=_.neg=function(){var e=new this.constructor(this);return e.s=-e.s||0,e};_.plus=_.add=function(e){var t=this;return e=new t.constructor(e),t.s==e.s?or(t,e):ur(t,(e.s=-e.s,e))};_.precision=_.sd=function(e){var t,n,r,i=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(Ve+e);if(t=X(i)+1,r=i.d.length-1,n=r*Y+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return e&&t>n?t:n};_.squareRoot=_.sqrt=function(){var e,t,n,r,i,s,o,a=this,u=a.constructor;if(a.s<1){if(!a.s)return new u(0);throw Error(ge+"NaN")}for(e=X(a),V=!1,i=Math.sqrt(+a),i==0||i==1/0?(t=ye(a.d),(t.length+e)%2==0&&(t+="0"),i=Math.sqrt(t),e=nt((e+1)/2)-(e<0||e%2),i==1/0?t="5e"+e:(t=i.toExponential(),t=t.slice(0,t.indexOf("e")+1)+e),r=new u(t)):r=new u(i.toString()),n=u.precision,i=o=n+3;;)if(s=r,r=s.plus(Oe(a,s,o+2)).times(.5),ye(s.d).slice(0,o)===(t=ye(r.d)).slice(0,o)){if(t=t.slice(o-3,o+1),i==o&&t=="4999"){if(F(s,n+1,0),s.times(s).eq(a)){r=s;break}}else if(t!="9999")break;o+=4}return V=!0,F(r,n)};_.times=_.mul=function(e){var t,n,r,i,s,o,a,u,l,f=this,d=f.constructor,y=f.d,m=(e=new d(e)).d;if(!f.s||!e.s)return new d(0);for(e.s*=f.s,n=f.e+e.e,u=y.length,l=m.length,u<l&&(s=y,y=m,m=s,o=u,u=l,l=o),s=[],o=u+l,r=o;r--;)s.push(0);for(r=l;--r>=0;){for(t=0,i=u+r;i>r;)a=s[i]+m[r]*y[i-r-1]+t,s[i--]=a%ne|0,t=a/ne|0;s[i]=(s[i]+t)%ne|0}for(;!s[--o];)s.pop();return t?++n:s.shift(),e.d=s,e.e=n,V?F(e,d.precision):e};_.toDecimalPlaces=_.todp=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(_e(e,0,tt),t===void 0?t=r.rounding:_e(t,0,8),F(n,e+X(n)+1,t))};_.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=ze(r,!0):(_e(e,0,tt),t===void 0?t=i.rounding:_e(t,0,8),r=F(new i(r),e+1,t),n=ze(r,!0,e+1)),n};_.toFixed=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?ze(i):(_e(e,0,tt),t===void 0?t=s.rounding:_e(t,0,8),r=F(new s(i),e+X(i)+1,t),n=ze(r.abs(),!1,e+X(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};_.toInteger=_.toint=function(){var e=this,t=e.constructor;return F(new t(e),X(e)+1,t.rounding)};_.toNumber=function(){return+this};_.toPower=_.pow=function(e){var t,n,r,i,s,o,a=this,u=a.constructor,l=12,f=+(e=new u(e));if(!e.s)return new u(fe);if(a=new u(a),!a.s){if(e.s<1)throw Error(ge+"Infinity");return a}if(a.eq(fe))return a;if(r=u.precision,e.eq(fe))return F(a,r);if(t=e.e,n=e.d.length-1,o=t>=n,s=a.s,o){if((n=f<0?-f:f)<=sr){for(i=new u(fe),t=Math.ceil(r/Y+4),V=!1;n%2&&(i=i.times(a),$n(i.d,t)),n=nt(n/2),n!==0;)a=a.times(a),$n(a.d,t);return V=!0,e.s<0?new u(fe).div(i):F(i,r)}}else if(s<0)throw Error(ge+"NaN");return s=s<0&&e.d[Math.max(t,n)]&1?-1:1,a.s=1,V=!1,i=e.times(ft(a,r+l)),V=!0,i=ar(i),i.s=s,i};_.toPrecision=function(e,t){var n,r,i=this,s=i.constructor;return e===void 0?(n=X(i),r=ze(i,n<=s.toExpNeg||n>=s.toExpPos)):(_e(e,1,tt),t===void 0?t=s.rounding:_e(t,0,8),i=F(new s(i),e,t),n=X(i),r=ze(i,e<=n||n<=s.toExpNeg,e)),r};_.toSignificantDigits=_.tosd=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(_e(e,1,tt),t===void 0?t=r.rounding:_e(t,0,8)),F(new r(n),e,t)};_.toString=_.valueOf=_.val=_.toJSON=_[Symbol.for("nodejs.util.inspect.custom")]=function(){var e=this,t=X(e),n=e.constructor;return ze(e,t<=n.toExpNeg||t>=n.toExpPos)};function or(e,t){var n,r,i,s,o,a,u,l,f=e.constructor,d=f.precision;if(!e.s||!t.s)return t.s||(t=new f(e)),V?F(t,d):t;if(u=e.d,l=t.d,o=e.e,i=t.e,u=u.slice(),s=o-i,s){for(s<0?(r=u,s=-s,a=l.length):(r=l,i=o,a=u.length),o=Math.ceil(d/Y),a=o>a?o+1:a+1,s>a&&(s=a,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(a=u.length,s=l.length,a-s<0&&(s=a,r=l,l=u,u=r),n=0;s;)n=(u[--s]=u[s]+l[s]+n)/ne|0,u[s]%=ne;for(n&&(u.unshift(n),++i),a=u.length;u[--a]==0;)u.pop();return t.d=u,t.e=i,V?F(t,d):t}function _e(e,t,n){if(e!==~~e||e<t||e>n)throw Error(Ve+e)}function ye(e){var t,n,r,i=e.length-1,s="",o=e[0];if(i>0){for(s+=o,t=1;t<i;t++)r=e[t]+"",n=Y-r.length,n&&(s+=Ce(n)),s+=r;o=e[t],r=o+"",n=Y-r.length,n&&(s+=Ce(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Oe=function(){function e(r,i){var s,o=0,a=r.length;for(r=r.slice();a--;)s=r[a]*i+o,r[a]=s%ne|0,o=s/ne|0;return o&&r.unshift(o),r}function t(r,i,s,o){var a,u;if(s!=o)u=s>o?1:-1;else for(a=u=0;a<s;a++)if(r[a]!=i[a]){u=r[a]>i[a]?1:-1;break}return u}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*ne+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var a,u,l,f,d,y,m,R,v,c,h,p,N,q,L,k,x,C,z=r.constructor,M=r.s==i.s?1:-1,D=r.d,O=i.d;if(!r.s)return new z(r);if(!i.s)throw Error(ge+"Division by zero");for(u=r.e-i.e,x=O.length,L=D.length,m=new z(M),R=m.d=[],l=0;O[l]==(D[l]||0);)++l;if(O[l]>(D[l]||0)&&--u,s==null?p=s=z.precision:o?p=s+(X(r)-X(i))+1:p=s,p<0)return new z(0);if(p=p/Y+2|0,l=0,x==1)for(f=0,O=O[0],p++;(l<L||f)&&p--;l++)N=f*ne+(D[l]||0),R[l]=N/O|0,f=N%O|0;else{for(f=ne/(O[0]+1)|0,f>1&&(O=e(O,f),D=e(D,f),x=O.length,L=D.length),q=x,v=D.slice(0,x),c=v.length;c<x;)v[c++]=0;C=O.slice(),C.unshift(0),k=O[0],O[1]>=ne/2&&++k;do f=0,a=t(O,v,x,c),a<0?(h=v[0],x!=c&&(h=h*ne+(v[1]||0)),f=h/k|0,f>1?(f>=ne&&(f=ne-1),d=e(O,f),y=d.length,c=v.length,a=t(d,v,y,c),a==1&&(f--,n(d,x<y?C:O,y))):(f==0&&(a=f=1),d=O.slice()),y=d.length,y<c&&d.unshift(0),n(v,d,c),a==-1&&(c=v.length,a=t(O,v,x,c),a<1&&(f++,n(v,x<c?C:O,c))),c=v.length):a===0&&(f++,v=[0]),R[l++]=f,a&&v[0]?v[c++]=D[q]||0:(v=[D[q]],c=1);while((q++<L||v[0]!==void 0)&&p--)}return R[0]||R.shift(),m.e=u,F(m,o?s+X(m)+1:s)}}();function ar(e,t){var n,r,i,s,o,a,u=0,l=0,f=e.constructor,d=f.precision;if(X(e)>16)throw Error(mn+X(e));if(!e.s)return new f(fe);for(V=!1,a=d,o=new f(.03125);e.abs().gte(.1);)e=e.times(o),l+=5;for(r=Math.log($e(2,l))/Math.LN10*2+5|0,a+=r,n=i=s=new f(fe),f.precision=a;;){if(i=F(i.times(e),a),n=n.times(++u),o=s.plus(Oe(i,n,a)),ye(o.d).slice(0,a)===ye(s.d).slice(0,a)){for(;l--;)s=F(s.times(s),a);return f.precision=d,t==null?(V=!0,F(s,d)):s}s=o}}function X(e){for(var t=e.e*Y,n=e.d[0];n>=10;n/=10)t++;return t}function Wt(e,t,n){if(t>e.LN10.sd())throw V=!0,n&&(e.precision=n),Error(ge+"LN10 precision limit exceeded");return F(new e(e.LN10),t)}function Ce(e){for(var t="";e--;)t+="0";return t}function ft(e,t){var n,r,i,s,o,a,u,l,f,d=1,y=10,m=e,R=m.d,v=m.constructor,c=v.precision;if(m.s<1)throw Error(ge+(m.s?"NaN":"-Infinity"));if(m.eq(fe))return new v(0);if(t==null?(V=!1,l=c):l=t,m.eq(10))return t==null&&(V=!0),Wt(v,l);if(l+=y,v.precision=l,n=ye(R),r=n.charAt(0),s=X(m),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(e),n=ye(m.d),r=n.charAt(0),d++;s=X(m),r>1?(m=new v("0."+n),s++):m=new v(r+"."+n.slice(1))}else return u=Wt(v,l+2,c).times(s+""),m=ft(new v(r+"."+n.slice(1)),l-y).plus(u),v.precision=c,t==null?(V=!0,F(m,c)):m;for(a=o=m=Oe(m.minus(fe),m.plus(fe),l),f=F(m.times(m),l),i=3;;){if(o=F(o.times(f),l),u=a.plus(Oe(o,new v(i),l)),ye(u.d).slice(0,l)===ye(a.d).slice(0,l))return a=a.times(2),s!==0&&(a=a.plus(Wt(v,l+2,c).times(s+""))),a=Oe(a,new v(d),l),v.precision=c,t==null?(V=!0,F(a,c)):a;a=u,i+=2}}function qn(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;)++r;for(i=t.length;t.charCodeAt(i-1)===48;)--i;if(t=t.slice(r,i),t){if(i-=r,n=n-r-1,e.e=nt(n/Y),e.d=[],r=(n+1)%Y,n<0&&(r+=Y),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=Y;r<i;)e.d.push(+t.slice(r,r+=Y));t=t.slice(r),r=Y-t.length}else r-=i;for(;r--;)t+="0";if(e.d.push(+t),V&&(e.e>Pt||e.e<-Pt))throw Error(mn+n)}else e.s=0,e.e=0,e.d=[0];return e}function F(e,t,n){var r,i,s,o,a,u,l,f,d=e.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(r=t-o,r<0)r+=Y,i=t,l=d[f=0];else{if(f=Math.ceil((r+1)/Y),s=d.length,f>=s)return e;for(l=s=d[f],o=1;s>=10;s/=10)o++;r%=Y,i=r-Y+o}if(n!==void 0&&(s=$e(10,o-i-1),a=l/s%10|0,u=t<0||d[f+1]!==void 0||l%s,u=n<4?(a||u)&&(n==0||n==(e.s<0?3:2)):a>5||a==5&&(n==4||u||n==6&&(r>0?i>0?l/$e(10,o-i):0:d[f-1])%10&1||n==(e.s<0?8:7))),t<1||!d[0])return u?(s=X(e),d.length=1,t=t-s-1,d[0]=$e(10,(Y-t%Y)%Y),e.e=nt(-t/Y)||0):(d.length=1,d[0]=e.e=e.s=0),e;if(r==0?(d.length=f,s=1,f--):(d.length=f+1,s=$e(10,Y-r),d[f]=i>0?(l/$e(10,o-i)%$e(10,i)|0)*s:0),u)for(;;)if(f==0){(d[0]+=s)==ne&&(d[0]=1,++e.e);break}else{if(d[f]+=s,d[f]!=ne)break;d[f--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(V&&(e.e>Pt||e.e<-Pt))throw Error(mn+X(e));return e}function ur(e,t){var n,r,i,s,o,a,u,l,f,d,y=e.constructor,m=y.precision;if(!e.s||!t.s)return t.s?t.s=-t.s:t=new y(e),V?F(t,m):t;if(u=e.d,d=t.d,r=t.e,l=e.e,u=u.slice(),o=l-r,o){for(f=o<0,f?(n=u,o=-o,a=d.length):(n=d,r=l,a=u.length),i=Math.max(Math.ceil(m/Y),a)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=u.length,a=d.length,f=i<a,f&&(a=i),i=0;i<a;i++)if(u[i]!=d[i]){f=u[i]<d[i];break}o=0}for(f&&(n=u,u=d,d=n,t.s=-t.s),a=u.length,i=d.length-a;i>0;--i)u[a++]=0;for(i=d.length;i>o;){if(u[--i]<d[i]){for(s=i;s&&u[--s]===0;)u[s]=ne-1;--u[s],u[i]+=ne}u[i]-=d[i]}for(;u[--a]===0;)u.pop();for(;u[0]===0;u.shift())--r;return u[0]?(t.d=u,t.e=r,V?F(t,m):t):new y(0)}function ze(e,t,n){var r,i=X(e),s=ye(e.d),o=s.length;return t?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Ce(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Ce(-i-1)+s,n&&(r=n-o)>0&&(s+=Ce(r))):i>=o?(s+=Ce(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+Ce(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=Ce(r))),e.s<0?"-"+s:s}function $n(e,t){if(e.length>t)return e.length=t,!0}function cr(e){var t,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ve+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return qn(o,s.toString())}else if(typeof s!="string")throw Error(Ve+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,Di.test(s))qn(o,s);else throw Error(Ve+s)}if(i.prototype=_,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=cr,i.config=i.set=Ti,e===void 0&&(e={}),e)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Ti(e){if(!e||typeof e!="object")throw Error(ge+"Object expected");var t,n,r,i=["precision",1,tt,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(t=0;t<i.length;t+=3)if((r=e[n=i[t]])!==void 0)if(nt(r)===r&&r>=i[t+1]&&r<=i[t+2])this[n]=r;else throw Error(Ve+n+": "+r);if((r=e[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ve+n+": "+r);return this}var gn=cr(_i);fe=new gn(1);const Ne=gn,Z={of(e){return new Ne(e)},sum(...e){let t=new Ne(0);for(const n of e)t=t.plus(n);return t},toFormat(e,t,n,r){const i=e.toFixed(t,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[a,u]=i.split("."),l=[];for(let f=a.length;f>0;f-=s)l.unshift(a.slice(Math.max(0,f-s),f));return l.join(o)+(u?`.${u}`:"")},round(e,t,n){return Z.of(e).toDecimalPlaces(t,n).toNumber()}};function Si(e){switch(e){case B.Equal:return"==";case B.NotEqual:return"!=";case B.Lte:return"<=";case B.Gte:return">=";case B.LogicalAnd:return"&&";case B.LogicalOr:return"||";case B.Power:return"**";case B.Nullish:return"??";case B.Group:return"()";default:return String.fromCharCode(e)}}function pe(e){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(e)}function ut(e){return e==null}const rt=new Map;function Ai(e,t){const n=rt.get(e);if(n==null)throw new Error(`不支持的函数：${e}`);return n(...t)}function lr(){return new Error("Unexpected end of input")}function te(e){return new Error(`Unexpected end of input at position ${e.start}, near \`${Si(e.value)}\``)}function bi(e,t,n){switch(e.value){case B.Plus:{if(e.left==null||e.right==null)throw te(e);return typeof t=="string"||typeof n=="string"?t+n:pe(t)&&pe(n)?Z.of(t).plus(n).toNumber():Number.NaN}case B.Minus:{if(e.left==null&&e.right==null)throw te(e);return e.left==null&&e.right?-n:pe(t)&&pe(n)?Z.of(t).minus(n).toNumber():Number.NaN}case B.Asterisk:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).times(n).toNumber():Number.NaN}case B.Slash:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).div(n).toNumber():Number.NaN}case B.Percent:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).mod(n).toNumber():Number.NaN}case B.Power:{if(e.left==null||e.right==null)throw te(e);return pe(t)&&pe(n)?Z.of(t).pow(n).toNumber():Number.NaN}case B.Equal:{if(e.left==null||e.right==null)throw te(e);return ut(t)&&ut(n)?!0:t===n}case B.NotEqual:{if(e.left==null||e.right==null)throw te(e);return ut(t)&&ut(n)?!1:t!==n}case B.Lt:{if(e.left==null||e.right==null)throw te(e);return t<n}case B.Lte:{if(e.left==null||e.right==null)throw te(e);return t<=n}case B.Gt:{if(e.left==null||e.right==null)throw te(e);return t>n}case B.Gte:{if(e.left==null||e.right==null)throw te(e);return t>=n}case B.LogicalAnd:{if(e.left==null||e.right==null)throw te(e);return t&&n}case B.LogicalOr:{if(e.left==null||e.right==null)throw te(e);return t||n}case B.LogicalNot:{if(e.right==null)throw te(e);return!n}case B.Nullish:{if(e.left==null||e.right==null)throw te(e);return ut(t)?n:t}default:throw te(e)}}function Ri(e,t){const r=(e.children??[]).map(i=>{if(i!=null)return Re(i,t)});return Ai(e.value,r)}function Oi(e,t){var n;return t==null||typeof t!="object"?null:(n=t.data)==null?void 0:n[e.value]}function Mi(e,t){var n;return t==null||typeof t!="object"?null:(n=t.scope)==null?void 0:n[e.value]}function Pi(e,t){if(e.left==null||e.right==null||e.condition==null)throw lr();return Re(e.condition,t)?(e.result=Re(e.left,t),e.result):(e.result=Re(e.right,t),e.result)}function Re(e,t){switch(e.type){case Ee.NULL:return null;case Ee.UNDEFINED:return;case Ee.NUMBER:return Number(e.value);case Ee.STRING:return String(e.value);case Ee.TEMPLATE:{const r=(Array.isArray(e.value)?e.value:[e.value]).map(i=>Re(i,t));return e.result=r.join(""),e.result}case Ee.BOOLEAN:return!!e.value;case Ee.VARIABLE:return e.result=Oi(e,t),e.result;case Ee.REFERENCE:return e.result=Mi(e,t),e.result;case Ee.FUNCTION:return e.result=Ri(e,t),e.result;case Ee.OPERATOR:{if(e.isQuestion)return Pi(e,t);if(e.isGroup){if(e.right==null)throw te(e);return e.result=Re(e.right,t),e.result}const n=e.left?Re(e.left,t):null,r=e.right?Re(e.right,t):null;return e.result=bi(e,n,r),e.result}default:throw lr()}}function Ii(e,t){return Re(e,t??{})}const fr="Resolve Element Value Pending Error",hr="ElementValueError";function $(e){const t=Object.create(null);return t.state=ce.DONE,t.raw=e,t}function Xe(){const e=Object.create(null);return e.state=ce.PENDING,e}function Ft(){const e=new Error(fr);return e.name=hr,e}function Ci(e){return e instanceof Error&&e.name===hr&&e.message===fr}function Li(e,t){var r;const n=typeof t=="string"?dn(t)?Qe(t):null:t;if(n==null)return $();switch(n.value){case vt.CURRENT_DATE:return $(Date.now());case vt.PAGE_NUMBER:{const i=e.doc;return i==null?$():i.isPaged?$(e.pageNum):Xe()}case vt.PAGE_TOTAL:{const i=e.doc;return i==null?$():i.isPaged?$((r=e.page)==null?void 0:r.pageTotal):Xe()}case vt.ROW_INDEX:{const i=e.doc;if(i==null)return $();if(i.isPaged){if(e.type!==se.TABLE_CELL)return $();const s=e.parent;return s==null?$():$(s.rowIndex)}return Xe()}default:return $()}}function ki(e,t){const n=typeof t=="string"?dn(t)?Qe(t):null:t;if(n==null)return $();switch(n.value){case Pr.ELEMENT_VALUR:return e.isProcessValueDone?$(e.getRawValue()):Xe();default:return $()}}function xi(e,t,n){const r=typeof t=="string"?Qe(t):t,i=e.parent;if(i==null||!i.isBindVariable)return $(ct(n,r.value));const s=Qe(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?$():$(ct(i.rowData,r.value)):$(ct(n,r.value))}async function qi(e,t){const n=e.define;if(n.ds==null)return $();const r=n.ds,i=r.value;return et(i)?$():r.type===Et.TEMPLATE?$i(e,i):r.type===Et.VARIABLE?vn(e,i,t):r.type===Et.FORMULA?dr(e,i,t):r.type===Et.CODE?Fi(e,i):$(r.value)}function vn(e,t,n,r=!1){const i=Qe(t);switch(i.varType){case Gt.DS:return e.type===se.TABLE_CELL?xi(e,i,n):e.type===se.TABLE_ROW?$(e.rowData):$(ct(n,r?i.path:i.value));case Gt.BUILTIN:return Li(e,i);case Gt.SPECIAL:return ki(e,i);default:return $()}}function $i(e,t){return console.log("TODO: template:"+t),$()}function dr(e,t,n){try{const r=Ir.compile(t),i={data:{},scope:{}};for(const o of r.variable){const a=vn(e,o.value,n);if(a.state===ce.PENDING)return Xe();Reflect.set(i.data,o.value,a.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{value:o.value,element:e});const s=Ii(r.root,i);return $(s)}catch(r){return Ci(r)?Xe():(console.log(r),$())}}async function Fi(e,t){try{const r=new Function("element",`return (${t})(element)`)(e);if(r instanceof Promise){const i=await r;return $(i)}return $(r)}catch(n){return console.log(n),$()}}function Fn(){const e=document.createElement("span"),t="important";return e.style.visibility="hidden",e.style.position="absolute",e.style.left="0",e.style.top="0",e.style.zIndex="-1",e.style.setProperty("line-height","1",t),e.style.setProperty("font-family","宋体",t),e.style.setProperty("padding","0",t),e.textContent="水",e}function Hi(){const e=Fn();e.style.fontSize="6px",document.body.appendChild(e);const t=Fn();t.style.fontSize="12px",document.body.appendChild(t);const n=e.clientHeight<t.clientHeight;return document.body.removeChild(e),document.body.removeChild(t),n}let pr=function(){const e=Hi();return pr=function(){return e},e};const Ui=/Chrome/.test(navigator.userAgent);function En(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var we={},Hn;function mr(){if(Hn)return we;Hn=1;var e=/^([+-])?0*(\d+)(\.(\d+))?$/,t=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=we.e2ten=function(i){var s=t.exec(i.toString());if(!s)return i;var o=s[2],a=s[4]||"",u=s[5]?+s[5]:0;if(u>0){var l=a.substr(0,u);l=l.length<u?l+new Array(u-l.length+1).join("0"):l,a=a.substr(u),o+=l}else{u=-u;var f=o.length-u;f=f<0?0:f;var d=o.substr(f,u);d=d.length<u?new Array(u-d.length+1).join("0")+d:d,o=o.substring(0,f),a=d+a}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(a?"."+a:"")};we.getNumbResult=function(i){var s=e.exec(i.toString());if(!s&&t.test(i.toString())&&(s=e.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},we.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var a=[].slice.call(arguments,2);a.unshift(s),i.apply(null,a)}return s};var r=we.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return we.extend=function(i){for(var s,o=arguments[0]||{},a=Array.prototype.slice.call(arguments,1),u=0;u<a.length;u++){var l=a[u];for(s in l)r(l,s)&&(o[s]=l[s])}return o},we.getDigit=function(i){return i>=5?(i-4)*4+4:i},we.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},we.clearZero=function(i,s,o){if(i==null)return"";var a=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,u=new RegExp("^"+a+"+"),l=new RegExp(a+"+$"),f=new RegExp(a+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(u,"")),(!o||o=="$")&&(i=i.replace(l,"")),(!o||o=="nto1")&&(i=i.replace(f,s)),i},we}var Zt,Un;function Bi(){if(Un)return Zt;Un=1;var e=mr();function t(i,s){var o=e.getNumbResult(i);if(!o)return i;s=s||{};var a=this.ch,u=this.ch_u,l=this.ch_f||"",f=this.ch_d||".",d=a.charAt(0),y=o.int,m=o.decimal,R=o.minus,v="",c="",h=R?l:"",p=function x(C,z,M){C=e.getNumbResult(C).int;var D="",O=arguments.length>1?arguments[1]:s.tenMin,K=C.length;if(K==1)return a.charAt(+C);if(K<=4)for(var S=0,w=K;w--;){var g=+C.charAt(S);D+=O&&K==2&&S==0&&g==1?"":a.charAt(g),D+=g&&w?u.charAt(w):"",S++}else{for(var T=C.length/4>>0,E=C.length%4;E==0||!u.charAt(3+T);)E+=4,T--;var A=C.substr(0,E),b=C.substr(E);D=x(A,O)+u.charAt(3+T)+(b.charAt(0)=="0"?d:"")+x(b,b.length>4?O:!1)}return D=e.clearZero(D,d),D};if(m){m=e.clearZero(m,"0","$");for(var N=0;N<m.length;N++)c+=a.charAt(+m.charAt(N));c=c?f+c:""}if(v=p(y),s.ww&&u.length>5){var q=u.charAt(4),L=u.charAt(5),k=v.lastIndexOf(L);~k&&(v=v.substring(0,k).replace(new RegExp(L,"g"),q+q)+v.substring(k))}return h+v+c}function n(i,s){i=i.toString();var o=i.split(this.ch_d),a=o[0].replace(this.ch_f,""),u=o[1],l=!!~o[0].indexOf(this.ch_f),f=this.ch_u.charAt(1),d=this.ch_u.charAt(4),y=this.ch_u.charAt(5);a=a.replace(new RegExp(d+"{2}(?!"+d+")","g"),y);for(var m=a.split(""),R=0,v=0,c=[],h=[],p=[],N=0;N<m.length;N++){var q=m[N],L=0,k=0;if(~(L=this.ch.indexOf(q)))L>0&&p.unshift(L);else if(~(k=this.ch_u.indexOf(q))){var x=e.getDigit(k);R>k?(e.unshiftZero(p,x),e.centerArray(h,p)):k>=v?(N==0&&(p=[1]),e.centerArray(c,h,p),c.length>0&&e.unshiftZero(c,x),v=k):(p.length==0&&f==q&&(p=[1]),e.centerArray(h,p),e.unshiftZero(h,e.getDigit(k)),R=k)}}e.centerArray(c,h,p).reverse(),c.length==0&&c.push(0);var C=0;if(u){c.push("."),C="0.";for(var N=0;N<u.length;N++)C+=this.ch.indexOf(u.charAt(N)),c.push(this.ch.indexOf(u.charAt(N)));C=+C}return l&&c.unshift("-"),s&&s.outputString?c.join(""):parseFloat(c.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},a=e.getNumbResult(i),u=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!a)return i;s=e.extend(o,s);var l=a.int,f=a.decimal||"",d=s.outSymbol?this.m_t:"",y=a.minus?this.ch_f:"",m="";if(s.complete){for(var R=1;R<this.m_u.length;R++)m+=t.call(this,f.charAt(R-1)||"0")+this.m_u.charAt(R);y+=t.call(this,l,s)+this.m_u.charAt(0)}else{var v=s.unOmitYuan||l!=="0";if(f=f.substr(0,this.m_u.length-1),f=e.clearZero(f,"0","$"),f)for(var c,R=0;R<this.m_u.length-1;R++)f.charAt(R)&&f.charAt(R)!="0"&&(m+=t.call(this,f.charAt(R))+this.m_u.charAt(R+1),c=!1),f.charAt(R)==="0"&&!c&&((R!=0||l!=="0")&&(m+=u),c=!0);(v||!m)&&(y+=t.call(this,l,s)+this.m_u.charAt(0)),s.forceZheng?(m==""||m.charAt(m.length-1)!==this.m_u[2])&&(m+=this.m_z):y+=a.decimal?"":this.m_z,s.forceZheng}return d+y+m}return Zt={CL:t,unCL:n,toMoney:r},Zt}var Xt,Bn;function Yi(){if(Bn)return Xt;Bn=1;var e=Bi(),t=mr();function n(r,i){return{encodeS:function(s,o){return o=t.extend({ww:!0,tenMin:!0},o),e.CL.call(r,s,o)},encodeB:function(s,o){return o=t.extend({ww:!0},o),e.CL.call(i,s,o)},decodeS:function(){return e.unCL.apply(r,arguments)},decodeB:function(){return e.unCL.apply(i,arguments)},toMoney:function(s,o){return o=t.extend({ww:!0},o),e.toMoney.call(i,s,o)}}}return Xt=n,Xt}var Kt,Yn;function Vi(){return Yn||(Yn=1,Kt={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),Kt}var Jt,Vn;function Gi(){return Vn||(Vn=1,Jt={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),Jt}var Qt,Gn;function zi(){if(Gn)return Qt;Gn=1;var e=Yi(),t={s:Vi(),b:Gi()};return Qt=e(t.s,t.b),Qt}var ji=zi();const Wi=En(ji);var St={exports:{}},Zi=St.exports,zn;function Xi(){return zn||(zn=1,function(e,t){(function(n,r){e.exports=r()})(Zi,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",a="minute",u="hour",l="day",f="week",d="month",y="quarter",m="year",R="date",v="Invalid Date",c=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(S){var w=["th","st","nd","rd"],g=S%100;return"["+S+(w[(g-20)%10]||w[g]||w[0])+"]"}},N=function(S,w,g){var T=String(S);return!T||T.length>=w?S:""+Array(w+1-T.length).join(g)+S},q={s:N,z:function(S){var w=-S.utcOffset(),g=Math.abs(w),T=Math.floor(g/60),E=g%60;return(w<=0?"+":"-")+N(T,2,"0")+":"+N(E,2,"0")},m:function S(w,g){if(w.date()<g.date())return-S(g,w);var T=12*(g.year()-w.year())+(g.month()-w.month()),E=w.clone().add(T,d),A=g-E<0,b=w.clone().add(T+(A?-1:1),d);return+(-(T+(g-E)/(A?E-b:b-E))||0)},a:function(S){return S<0?Math.ceil(S)||0:Math.floor(S)},p:function(S){return{M:d,y:m,w:f,d:l,D:R,h:u,m:a,s:o,ms:s,Q:y}[S]||String(S||"").toLowerCase().replace(/s$/,"")},u:function(S){return S===void 0}},L="en",k={};k[L]=p;var x="$isDayjsObject",C=function(S){return S instanceof O||!(!S||!S[x])},z=function S(w,g,T){var E;if(!w)return L;if(typeof w=="string"){var A=w.toLowerCase();k[A]&&(E=A),g&&(k[A]=g,E=A);var b=w.split("-");if(!E&&b.length>1)return S(b[0])}else{var I=w.name;k[I]=w,E=I}return!T&&E&&(L=E),E||!T&&L},M=function(S,w){if(C(S))return S.clone();var g=typeof w=="object"?w:{};return g.date=S,g.args=arguments,new O(g)},D=q;D.l=z,D.i=C,D.w=function(S,w){return M(S,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var O=function(){function S(g){this.$L=z(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[x]=!0}var w=S.prototype;return w.parse=function(g){this.$d=function(T){var E=T.date,A=T.utc;if(E===null)return new Date(NaN);if(D.u(E))return new Date;if(E instanceof Date)return new Date(E);if(typeof E=="string"&&!/Z$/i.test(E)){var b=E.match(c);if(b){var I=b[2]-1||0,U=(b[7]||"0").substring(0,3);return A?new Date(Date.UTC(b[1],I,b[3]||1,b[4]||0,b[5]||0,b[6]||0,U)):new Date(b[1],I,b[3]||1,b[4]||0,b[5]||0,b[6]||0,U)}}return new Date(E)}(g),this.init()},w.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},w.$utils=function(){return D},w.isValid=function(){return this.$d.toString()!==v},w.isSame=function(g,T){var E=M(g);return this.startOf(T)<=E&&E<=this.endOf(T)},w.isAfter=function(g,T){return M(g)<this.startOf(T)},w.isBefore=function(g,T){return this.endOf(T)<M(g)},w.$g=function(g,T,E){return D.u(g)?this[T]:this.set(E,g)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(g,T){var E=this,A=!!D.u(T)||T,b=D.p(g),I=function(ve,re){var he=D.w(E.$u?Date.UTC(E.$y,re,ve):new Date(E.$y,re,ve),E);return A?he:he.endOf(l)},U=function(ve,re){return D.w(E.toDate()[ve].apply(E.toDate("s"),(A?[0,0,0,0]:[23,59,59,999]).slice(re)),E)},G=this.$W,ee=this.$M,oe=this.$D,Pe="set"+(this.$u?"UTC":"");switch(b){case m:return A?I(1,0):I(31,11);case d:return A?I(1,ee):I(0,ee+1);case f:var De=this.$locale().weekStart||0,qe=(G<De?G+7:G)-De;return I(A?oe-qe:oe+(6-qe),ee);case l:case R:return U(Pe+"Hours",0);case u:return U(Pe+"Minutes",1);case a:return U(Pe+"Seconds",2);case o:return U(Pe+"Milliseconds",3);default:return this.clone()}},w.endOf=function(g){return this.startOf(g,!1)},w.$set=function(g,T){var E,A=D.p(g),b="set"+(this.$u?"UTC":""),I=(E={},E[l]=b+"Date",E[R]=b+"Date",E[d]=b+"Month",E[m]=b+"FullYear",E[u]=b+"Hours",E[a]=b+"Minutes",E[o]=b+"Seconds",E[s]=b+"Milliseconds",E)[A],U=A===l?this.$D+(T-this.$W):T;if(A===d||A===m){var G=this.clone().set(R,1);G.$d[I](U),G.init(),this.$d=G.set(R,Math.min(this.$D,G.daysInMonth())).$d}else I&&this.$d[I](U);return this.init(),this},w.set=function(g,T){return this.clone().$set(g,T)},w.get=function(g){return this[D.p(g)]()},w.add=function(g,T){var E,A=this;g=Number(g);var b=D.p(T),I=function(ee){var oe=M(A);return D.w(oe.date(oe.date()+Math.round(ee*g)),A)};if(b===d)return this.set(d,this.$M+g);if(b===m)return this.set(m,this.$y+g);if(b===l)return I(1);if(b===f)return I(7);var U=(E={},E[a]=r,E[u]=i,E[o]=n,E)[b]||1,G=this.$d.getTime()+g*U;return D.w(G,this)},w.subtract=function(g,T){return this.add(-1*g,T)},w.format=function(g){var T=this,E=this.$locale();if(!this.isValid())return E.invalidDate||v;var A=g||"YYYY-MM-DDTHH:mm:ssZ",b=D.z(this),I=this.$H,U=this.$m,G=this.$M,ee=E.weekdays,oe=E.months,Pe=E.meridiem,De=function(re,he,Te,Ie){return re&&(re[he]||re(T,A))||Te[he].slice(0,Ie)},qe=function(re){return D.s(I%12||12,re,"0")},ve=Pe||function(re,he,Te){var Ie=re<12?"AM":"PM";return Te?Ie.toLowerCase():Ie};return A.replace(h,function(re,he){return he||function(Te){switch(Te){case"YY":return String(T.$y).slice(-2);case"YYYY":return D.s(T.$y,4,"0");case"M":return G+1;case"MM":return D.s(G+1,2,"0");case"MMM":return De(E.monthsShort,G,oe,3);case"MMMM":return De(oe,G);case"D":return T.$D;case"DD":return D.s(T.$D,2,"0");case"d":return String(T.$W);case"dd":return De(E.weekdaysMin,T.$W,ee,2);case"ddd":return De(E.weekdaysShort,T.$W,ee,3);case"dddd":return ee[T.$W];case"H":return String(I);case"HH":return D.s(I,2,"0");case"h":return qe(1);case"hh":return qe(2);case"a":return ve(I,U,!0);case"A":return ve(I,U,!1);case"m":return String(U);case"mm":return D.s(U,2,"0");case"s":return String(T.$s);case"ss":return D.s(T.$s,2,"0");case"SSS":return D.s(T.$ms,3,"0");case"Z":return b}return null}(re)||b.replace(":","")})},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(g,T,E){var A,b=this,I=D.p(T),U=M(g),G=(U.utcOffset()-this.utcOffset())*r,ee=this-U,oe=function(){return D.m(b,U)};switch(I){case m:A=oe()/12;break;case d:A=oe();break;case y:A=oe()/3;break;case f:A=(ee-G)/6048e5;break;case l:A=(ee-G)/864e5;break;case u:A=ee/i;break;case a:A=ee/r;break;case o:A=ee/n;break;default:A=ee}return E?A:D.a(A)},w.daysInMonth=function(){return this.endOf(d).$D},w.$locale=function(){return k[this.$L]},w.locale=function(g,T){if(!g)return this.$L;var E=this.clone(),A=z(g,T,!0);return A&&(E.$L=A),E},w.clone=function(){return D.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},S}(),K=O.prototype;return M.prototype=K,[["$ms",s],["$s",o],["$m",a],["$H",u],["$W",l],["$M",d],["$y",m],["$D",R]].forEach(function(S){K[S[1]]=function(w){return this.$g(w,S[0],S[1])}}),M.extend=function(S,w){return S.$i||(S(w,O,M),S.$i=!0),M},M.locale=z,M.isDayjs=C,M.unix=function(S){return M(1e3*S)},M.en=k[L],M.Ls=k,M.p={},M})}(St)),St.exports}var Ki=Xi();const Me=En(Ki);var At={exports:{}},Ji=At.exports,jn;function Qi(){return jn||(jn=1,function(e,t){(function(n,r){e.exports=r()})(Ji,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,a=/\d*[^-_:/,()\s\d]+/,u={},l=function(c){return(c=+c)+(c>68?1900:2e3)},f=function(c){return function(h){this[c]=+h}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(c){(this.zone||(this.zone={})).offset=function(h){if(!h||h==="Z")return 0;var p=h.match(/([+-]|\d\d)/g),N=60*p[1]+(+p[2]||0);return N===0?0:p[0]==="+"?-N:N}(c)}],y=function(c){var h=u[c];return h&&(h.indexOf?h:h.s.concat(h.f))},m=function(c,h){var p,N=u.meridiem;if(N){for(var q=1;q<=24;q+=1)if(c.indexOf(N(q,0,h))>-1){p=q>12;break}}else p=c===(h?"pm":"PM");return p},R={A:[a,function(c){this.afternoon=m(c,!1)}],a:[a,function(c){this.afternoon=m(c,!0)}],Q:[i,function(c){this.month=3*(c-1)+1}],S:[i,function(c){this.milliseconds=100*+c}],SS:[s,function(c){this.milliseconds=10*+c}],SSS:[/\d{3}/,function(c){this.milliseconds=+c}],s:[o,f("seconds")],ss:[o,f("seconds")],m:[o,f("minutes")],mm:[o,f("minutes")],H:[o,f("hours")],h:[o,f("hours")],HH:[o,f("hours")],hh:[o,f("hours")],D:[o,f("day")],DD:[s,f("day")],Do:[a,function(c){var h=u.ordinal,p=c.match(/\d+/);if(this.day=p[0],h)for(var N=1;N<=31;N+=1)h(N).replace(/\[|\]/g,"")===c&&(this.day=N)}],w:[o,f("week")],ww:[s,f("week")],M:[o,f("month")],MM:[s,f("month")],MMM:[a,function(c){var h=y("months"),p=(y("monthsShort")||h.map(function(N){return N.slice(0,3)})).indexOf(c)+1;if(p<1)throw new Error;this.month=p%12||p}],MMMM:[a,function(c){var h=y("months").indexOf(c)+1;if(h<1)throw new Error;this.month=h%12||h}],Y:[/[+-]?\d+/,f("year")],YY:[s,function(c){this.year=l(c)}],YYYY:[/\d{4}/,f("year")],Z:d,ZZ:d};function v(c){var h,p;h=c,p=u&&u.formats;for(var N=(c=h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(M,D,O){var K=O&&O.toUpperCase();return D||p[O]||n[O]||p[K].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(S,w,g){return w||g.slice(1)})})).match(r),q=N.length,L=0;L<q;L+=1){var k=N[L],x=R[k],C=x&&x[0],z=x&&x[1];N[L]=z?{regex:C,parser:z}:k.replace(/^\[|\]$/g,"")}return function(M){for(var D={},O=0,K=0;O<q;O+=1){var S=N[O];if(typeof S=="string")K+=S.length;else{var w=S.regex,g=S.parser,T=M.slice(K),E=w.exec(T)[0];g.call(D,E),M=M.replace(E,"")}}return function(A){var b=A.afternoon;if(b!==void 0){var I=A.hours;b?I<12&&(A.hours+=12):I===12&&(A.hours=0),delete A.afternoon}}(D),D}}return function(c,h,p){p.p.customParseFormat=!0,c&&c.parseTwoDigitYear&&(l=c.parseTwoDigitYear);var N=h.prototype,q=N.parse;N.parse=function(L){var k=L.date,x=L.utc,C=L.args;this.$u=x;var z=C[1];if(typeof z=="string"){var M=C[2]===!0,D=C[3]===!0,O=M||D,K=C[2];D&&(K=C[2]),u=this.$locale(),!M&&K&&(u=p.Ls[K]),this.$d=function(T,E,A,b){try{if(["x","X"].indexOf(E)>-1)return new Date((E==="X"?1e3:1)*T);var I=v(E)(T),U=I.year,G=I.month,ee=I.day,oe=I.hours,Pe=I.minutes,De=I.seconds,qe=I.milliseconds,ve=I.zone,re=I.week,he=new Date,Te=ee||(U||G?1:he.getDate()),Ie=U||he.getFullYear(),mt=0;U&&!G||(mt=G>0?G-1:he.getMonth());var gt,Ht=oe||0,Ut=Pe||0,Bt=De||0,Yt=qe||0;return ve?new Date(Date.UTC(Ie,mt,Te,Ht,Ut,Bt,Yt+60*ve.offset*1e3)):A?new Date(Date.UTC(Ie,mt,Te,Ht,Ut,Bt,Yt)):(gt=new Date(Ie,mt,Te,Ht,Ut,Bt,Yt),re&&(gt=b(gt).week(re).toDate()),gt)}catch{return new Date("")}}(k,z,x,p),this.init(),K&&K!==!0&&(this.$L=this.locale(K).$L),O&&k!=this.format(z)&&(this.$d=new Date("")),u={}}else if(z instanceof Array)for(var S=z.length,w=1;w<=S;w+=1){C[1]=z[w-1];var g=p.apply(this,C);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}w===S&&(this.$d=new Date(""))}else q.call(this,L)}}})}(At)),At.exports}var es=Qi();const ts=En(es);Me.extend(ts);function ns(e){switch(e){case zt.FLOOR:return Ne.ROUND_FLOOR;case zt.CEIL:return Ne.ROUND_CEIL;case zt.BANKER_ROUND:return Ne.ROUND_HALF_EVEN;default:return Ne.ROUND_HALF_UP}}function rs(e,t){if(e==null)return"";const n=t.format,r=ns(t.round),i=t.showZero===!1;switch(n){case ot.FIXED:{const s=t.precision;if(s==null||s<0)return e.toString();const o=typeof e=="number"?Z.of(e):e;return o.eq(0)&&i?"":o.toFixed(s,r)}case ot.THOUSAND:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":Z.toFormat(s,2,r,{groupSize:3})}case ot.TEN_THOUSAND:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":Z.toFormat(s,2,r,{groupSize:4})}case ot.DAXIE:{const s=typeof e=="number"?Z.of(e):e;return s.eq(0)&&i?"":Wi.toMoney(s.toFixed(2,r),{outSymbol:!1})}case ot.PERCENTAGE:{const s=typeof e=="number"?Z.of(e):e;if(s.eq(0)&&i)return"";const o=t.precision??2;return s.times(100).toFixed(o,Ne.ROUND_HALF_UP)+"%"}default:return typeof e=="number"?e==0&&i?"":e.toString():e.eq(0)&&i?"":e.toString()}}function is(e,t){const n=t.format;return n==null?e:Me(e).format(n)}function ss(e,t){const n=e.attributes;switch(e.display){case se.NUMBER:return rs(t,n);case se.DATE:return is(t,n);default:return t}}const Wn=Object.create(null);var xt,Ke;const lt=class lt{constructor(t){de(this,xt,fn(hn.PRINT_ELEMENT));de(this,Ke,Object.create(null));P(this,"define");P(this,"children",[]);P(this,"atomized",!1);P(this,"extra",!1);P(this,"parent");P(this,"offsetTop",0);P(this,"offsetLeft",0);P(this,"offsetWidth",0);P(this,"offsetHeight",0);P(this,"element");P(this,"zIndex");P(this,"state",on.CREATED);P(this,"visibility",Se.PENDING);P(this,"value",{state:ce.UNDEFINED});this.define=t,this.offsetTop=t.offsetTop,this.offsetLeft=t.offsetLeft,this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.zIndex=t.zIndex,Be(this,"parent",null),Be(this,"element",null)}static register(t,n){Wn[t]=n}static create(t){const n=Wn[t.type]??lt;return new n(t)}static isPrintElement(t){return t instanceof lt}get id(){return"@"+H(this,xt)}get type(){return this.define.type}get page(){let t=this.parent;for(;t;){if(t instanceof Mt)return t;t=t.parent}return null}get doc(){var t;return(t=this.page)==null?void 0:t.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const t=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return t+n}get pageNum(){var t;return((t=this.page)==null?void 0:t.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const t=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${t}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===_t.AUTO}get isOverflowScale(){return this.define.attributes.overflow===_t.SCALE}get isOverflowHidden(){const t=this.define.attributes.overflow;return t==null||t===_t.HIDDEN}get isProcessValueDone(){return this.value.state===ce.DONE}get isUndefinedValue(){return this.value.state===ce.UNDEFINED}get isHidden(){return this.visibility===Se.HIDDEN}async processValue(){var t,n,r;if(!this.isProcessValueDone)switch(this.value=await qi(this,(t=this.doc)==null?void 0:t.data),this.value.state){case ce.DONE:(n=this.doc)==null||n.removeDependency(this);break;case ce.PENDING:(r=this.doc)==null||r.addDependency(this,{state:ce.PENDING});break}}getRawValue(){if(this.value.state===ce.DONE)return this.value.raw}format(){return ss(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(t=>t.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const t=this.content;return Cr(t)?null:Q("div",{class:"quickprint-content",children:Q("span",{children:this.content})})}async updateElement(){const t=this.parent;if(t==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await t.replaceChild(this,n)}async mountChild(t){var n;return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),await Ge(),await t.mount(t.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(t,n){var r;return this.element==null||t.element==null?!1:(n==null?this.element.removeChild(t.element):this.element.replaceChild(n,t.element),await Ge(),await t.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(t){t!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=t.offsetWidth,this.offsetHeight=t.offsetHeight,this.state=on.MOUNDTED,this.element=t)}setParent(t){this.parent=t}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}append(t){t.setParent(this),this.children.push(t),H(this,Ke)[t.id]=t}clone(){const t=lt.create(this.define),n=this.children.map(r=>r.clone());return t.appendMany(n),t}checkOverflow(){if(this.element==null)return!1;const t=this.element.querySelector(".quickprint-content");if(t==null)return!1;const n=t.parentElement;return n==null?!1:n.offsetHeight<t.offsetHeight}processOverflow(){return this.isOverflowScale?pr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const t=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return t==null||(t.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(t){const n=H(this,Ke)[t];if(n)return n;for(const r of this.children){const i=r.findElement(t);if(i)return i}}findElementFromDefine(t){return this.children.find(n=>n.define.id===t)}createElements(){it(this,Ke,this.children.reduce((t,n)=>(t[n.id]=n,t),Object.create(null)))}checkVisibility(){var i,s,o;const t=this.define;if(t.visibility==null||t.visibility.type===On.VISIBLE)return Se.VISIBLE;if(t.visibility.type===On.HIDDEN)return Se.HIDDEN;const n=t.visibility.condition;if(et(n))return Se.VISIBLE;const r=dr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case ce.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Se.VISIBLE:Se.HIDDEN;case ce.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:ce.PENDING}),Se.PENDING;default:return Se.PENDING}}};xt=new WeakMap,Ke=new WeakMap;let j=lt;function wt(e,t){return t.exclude==null?!0:!t.exclude.includes(e)}function pt(e){var s;const t={};if(!Ui)return t;const n=e.define,r=n.style.fontFamily;return(r==null||r===Lr.SONG)&&((s=n.style)==null?void 0:s.fontWeight)===700&&(t["quickprint-patch-song-blod"]=!0),t}function wn(e,t={}){const n={},r=e.define.style??{},i=Qn(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=kr(r);return s&&We(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),We(n,xr(e.define)),We(n,qr(e.define)),We(n,$r(e.define)),We(n,Fr(e.define)),n}function yn(e,t={}){const n={};if(wt("top",t)&&(n.top=e.offsetTop+"px"),wt("left",t)&&(n.left=e.offsetLeft+"px"),wt("width",t)&&(n.width=e.offsetWidth+"px"),wt("height",t)){const r=e.define.attributes.overflow===_t.AUTO?"min-height":"height";n[r]=e.offsetHeight+"px"}return e.zIndex&&(n.zIndex=e.zIndex),n}function Nn(e,t={}){return pn(yn(e,t),wn(e,t),nn(e.define))}class os extends j{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class as extends j{get style(){return yn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...pt(this)}}processConstNode(t){var i;const n=t.dataset.value;if(et(n))return;const r=vn(this,n,(i=this.doc)==null?void 0:i.data);t.textContent=r.raw}process(t){for(const n of Array.from(t.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return t}render(){if(this.isHidden)return null;const t=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=t,Q("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class us extends j{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class cs extends j{get style(){return Nn(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class gr extends j{constructor(){super(...arguments);P(this,"rendering",0)}get style(){return{...pn(yn(this),wn(this)),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>Q("col",{width:s}));return Q("div",{id:this.id,class:this.className,style:this.style,children:Q("table",{children:[Q("colgroup",{children:i}),Q("tbody",{})]})})}async mountChild(n){var i;if(n.element==null)return!1;const r=this.getTableBody();return r==null?!1:(r.appendChild(n.element),await Ge(),await n.mount(n.element),this.offsetHeight=((i=this.element)==null?void 0:i.offsetHeight)??0,!0)}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await Ge(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n+1),i=this.getTableBody();if(this.children.length=n,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class ls extends j{constructor(){super(...arguments);P(this,"repeatIndex",-1);P(this,"rowData");P(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return Q("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=on.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}}class _n extends j{get style(){var r;const t=nn((r=this.define.parent)==null?void 0:r.parent),n=nn(this.define);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-height":this.offsetHeight+"px",...We(t,n)}}get className(){const t=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(t==null?void 0:t.isOverflowAuto)===!0,"quickprint-fixed-height":(t==null?void 0:t.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...pt(this)}}get isCollapsed(){return this.define.attributes.colspan===0||this.define.attributes.rowspan===0}createContentStyle(){const t=[];let n=this;for(;j.isPrintElement(n);)t.unshift(wn(n)),n=n.parent;return pn({},...t)}render(){if(this.isCollapsed)return null;const n=this.define.attributes,r=this.isHidden?null:Q("div",{class:"quickprint-layout",style:this.createContentStyle(),children:this.createContent()});return Q("td",{id:this.id,class:this.className,style:this.style,rowspan:n.rowspan,colspan:n.colspan,children:r})}}j.register(se.TEXT,os);j.register(se.PARAGRAPH,as);j.register(se.NUMBER,us);j.register(se.DATE,cs);j.register(se.TABLE,gr);j.register(se.TABLE_ROW,ls);j.register(se.TABLE_CELL,_n);function fs(e){return Number(e)}function hs(e){return Math.abs(e)}function ds(e){return Math.trunc(e)}function ps(...e){return Math.min(...e)}function ms(...e){return Math.max(...e)}function gs(e,t){return Z.round(e,t??0,Ne.ROUND_CEIL)}function vs(e,t){return Z.round(e,t??0,Ne.ROUND_FLOOR)}function Es(e,t,n){return Z.round(e,t??0,n??Ne.ROUND_HALF_UP)}function ws(e){e.set("NUMBER",fs),e.set("ABS",hs),e.set("TRUNC",ds),e.set("MIN",ps),e.set("MAX",ms),e.set("CEIL",gs),e.set("FLOOR",vs),e.set("ROUND",Es)}function ys(e){return String(e)}function Ns(e){return String(e).length}function _s(e){return String(e).toLowerCase()}function Ds(e){return String(e).toUpperCase()}function Ts(e){const t=String(e);return t[0].toUpperCase()+t.slice(1)}function Ss(e){return String(e).trim()}function As(e,t,n){return String(e).replace(t,n)}function bs(e,t,n){return String(e).replaceAll(t,n)}function Rs(e,t,n){return String(e).slice(t,n)}function Os(e,t,n){return String(e).includes(String(t),n)}function Ms(e,t,n){return String(e).indexOf(String(t),n)}function Ps(e,t,n){return String(e).lastIndexOf(String(t),n)}function Is(e,t,n){return String(e).startsWith(String(t),n)}function Cs(e,t,n){return String(e).endsWith(String(t),n)}function Ls(e){e.set("STRING",ys),e.set("LENGTH",Ns),e.set("LOWER",_s),e.set("UPPER",Ds),e.set("TRIM",Ss),e.set("UPPER_FIRST",Ts),e.set("REPLACE",As),e.set("REPLACE_ALL",bs),e.set("SLICE",Rs),e.set("INCLUDES",Os),e.set("INDEX_OF",Ms),e.set("LAST_INDEX_OF",Ps),e.set("STARTS_WITH",Is),e.set("ENDS_WITH",Cs)}function ks(e,t,n){return e?t:n}function xs(e,t){return Number.isNaN(e)?t:e}function qs(e,t){return Number.isNaN(e)||e==null?t:e}function $s(e,...t){for(let r=0;r<t.length;r+=2){const i=t[r],s=t[r+1];if(i===e)return s}return t.length%2===0?void 0:t[t.length-1]}function vr(e){return Number.isNaN(e)}function Fs(e){return Number.isInteger(e)}function Er(e){return typeof e=="number"}function wr(e){return typeof e=="string"}function Hs(e){return typeof e=="boolean"}function yr(e){return e===null}function Nr(e){return e===void 0}function _r(e){return yr(e)||Nr(e)}function Us(e){return _r(e)?!0:wr(e)?e.length==0:Er(e)?!vr(e):!1}function Bs(e){e.set("IF",ks),e.set("IFNA",xs),e.set("IFERROR",qs),e.set("IS_NAN",vr),e.set("IS_INTEGER",Fs),e.set("IS_NUMBER",Er),e.set("IS_STRING",wr),e.set("IS_BOOLEAN",Hs),e.set("IS_NULL",yr),e.set("IS_UNDEFINED",Nr),e.set("IS_NULLISH",_r),e.set("IS_EMPTY",Us),e.set("SWITCH",$s)}const Ys=[ae.YEAR_MONTH,ae.YEAR_MONTH_CHS,ae.YEAR_MONTH_DAY,ae.YEAR_MONTH_DAY_CHS,ae.DATETIME_SHORT,ae.DATETIME_SHORT_CHS,ae.DATETIME,ae.DATETIME_CHS,ae.TIME,ae.TIME_SHORT,ae.YEAR,ae.MONTH,ae.DAY];function ke(e){if(e!=null){if(typeof e=="number")return Ys[e];if(typeof e=="string")return e}}function Dr(e,t,n){return e===null&&(e=void 0),Me(e,ke(n)).format(ke(t)??ae.DATETIME)}function Vs(e){return Dr(void 0,e)}function Gs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).year()}function zs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).month()+1}function js(e,t){return e===null&&(e=void 0),Me(e,ke(t)).date()}function Ws(e,t){return e===null&&(e=void 0),Me(e,ke(t)).hour()}function Zs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).minute()}function Xs(e,t){return e===null&&(e=void 0),Me(e,ke(t)).second()}function Ks(e){e.set("DATE",Dr),e.set("NOW",Vs),e.set("YEAR",Gs),e.set("MONTH",zs),e.set("DAY",js),e.set("HOUR",Ws),e.set("MINUTE",Zs),e.set("SECOND",Xs)}function Tr(e,t){return e.children.reduce((n,r)=>{const i=r.findElementFromDefine(t);if(i==null)return n;if(!i.isProcessValueDone)throw Ft();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(Hr(o)?o:0),n},[])}function Dn(e,t){var r;const n=(r=e.parent)==null?void 0:r.parent;if(!(n==null||n.type!==se.TABLE))return Tr(n,t)}function Tn(e,t){var i,s;const n=(i=e.parent)==null?void 0:i.parent;if(n==null||n.type!==se.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,a)=>o.concat(a.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,a)=>o.concat(Tr(a,t)),[])}function Js(e,t){if(!e.doc.isPaged)throw Ft();const r=e.page,i=r.pageNum<r.pageTotal?Dn(e,t):Tn(e,t);return i==null||i.length==0?0:Z.sum(...i).toNumber()}function Qs(e,t){const n=e.element,r=e.value;if(!(n instanceof _n))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();if(t===2)return Js(n,r);const s=t==1?Dn(n,r):Tn(n,r);return s==null||s.length==0?0:Z.sum(...s).toNumber()}function eo(e,t){const n=e.element,r=e.value;if(!(n instanceof _n))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();const s=t==1?Dn(n,r):Tn(n,r);return s==null||s.length==0?0:Z.sum(...s).div(s.length).toNumber()}function to(e){e.set("COL_SUM",Qs),e.set("COL_AVG",eo)}ws(rt);Ls(rt);Bs(rt);Ks(rt);to(rt);const no=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-line;min-width:100%}.quickprint-content>span{background-color:var(--quickprint-variable-highlight-color, transparent)}",ro="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none!important}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song-blod{text-shadow:0 0 currentColor,0 0 currentColor}}";function Zn(){return no}function io(){return ro}var qt,Je,ht,Fe,He,Ue,xe,cn,ln;const An=class An{constructor(t,n){de(this,xe);de(this,qt,fn(hn.PRINT_DOCUMENT));de(this,Je);de(this,ht);de(this,Fe,Object.create(null));de(this,He,0);P(this,"define");P(this,"data");P(this,"state");P(this,"pages",[]);P(this,"element");P(this,"rendering");P(this,"renderState",le.CREATED);P(this,"devicePixelRatio",window.devicePixelRatio);de(this,Ue,[]);const{promise:r,resolve:i}=Promise.withResolvers();it(this,ht,r),it(this,Je,i),this.define=t,this.state=n,Be(this,"element",null),Be(this,"rendering",0),this.state.renderState=le.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(t,n={}){const r=t instanceof rn?t:rn.create(t);return new An(r,n)}get id(){return"@"+H(this,qt)}get style(){const t=this.state.scale??100,n=this.define.style;return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":t/100,"--quickprint-paper-width":this.define.paper.width+"mm","--quickprint-paper-height":`calc(${this.define.paper.height}mm - 1px)`,fontFamily:Qn(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get isPaged(){return this.renderState===le.PAGED||this.renderState===le.READY}get isFirstRount(){return H(this,He)===0}onCreated(){return Promise.allSettled(this.pages.map(t=>t.onCreated()))}onBeforeUnmount(t){H(this,Ue).indexOf(t)>=0||H(this,Ue).push(t)}unmount(){for(const t of H(this,Ue))typeof t=="function"&&t();H(this,Ue).length=0,this.renderState=le.UNMOUNT,this.element=null}render(){return Q("div",{class:Ae.DOCUMENT,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(t){return this.element==null||t.element==null?!1:(this.element.appendChild(t.element),!0)}async mount(){this.state.total=this.pages.length,this.refreshPageTotal(),st(this,xe,ln).call(this,le.PAGED),await st(this,xe,cn).call(this),st(this,xe,ln).call(this,le.READY);const t=this.pages.map(n=>n.onFinshed());await Promise.allSettled(t),typeof H(this,Je)=="function"&&(H(this,Je).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(t){this.pages.push(t),t.setParent(this)}appendMany(t){for(let n=0,r=t.length;n<r;n++)this.append(t[n])}insert(t,n){this.pages.splice(n,0,t),t.setParent(this)}ready(){return H(this,ht)}injectElementStyle(){const t=document.createElement("style");t.textContent=Zn(),document.head.appendChild(t)}async print(){return await this.ready(),new Promise(t=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),t()})})}genPapeStyle(){const t=this.define;return`@page{ size: ${t.paper.width}mm ${t.paper.height}mm }`}genPrintHtml(){var r;const t=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${t}</title>`,`<style>${Zn()}</style>`,`<style>${io()}</style>`,`<style>${this.genPapeStyle()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const t=this.state.scale??100,n=at.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=at[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const t=this.state.scale??100,n=at.indexOf(t);if(n<0)return this.resetZoom(),!1;if(n>=at.length-1)return!1;const r=at[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const t=100;this.state.scale=t,this.element.style.setProperty("--quickprint-doc-scale",`${t/100}`)}addDependency(t,n){H(this,Fe)[t.id]={element:t,...n}}removeDependency(t){delete H(this,Fe)[t.id]}watchDevicePixelRatio(){const t=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);t.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{t.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}debug(){var t;this.state.debug=!0,(t=this.element)==null||t.classList.add("quickprint-document-debug")}toggleDebug(){var t;this.state.debug=this.state.debug!==!0,(t=this.element)==null||t.classList.toggle("quickprint-document-debug")}findElement(t){for(const n of this.pages){const r=n.findElement(t);if(r)return r}}refreshPageTotal(){const t={};for(const n of this.pages){const r=n.file;if(t[r]!=null){n.pageTotal=t[r];continue}const i=this.pages.filter(s=>s.file===r);t[r]=i.length,n.pageTotal=i.length}}};qt=new WeakMap,Je=new WeakMap,ht=new WeakMap,Fe=new WeakMap,He=new WeakMap,Ue=new WeakMap,xe=new WeakSet,cn=async function(){for(const n of Object.values(H(this,Fe))){const r=n.element;await r.processValue(),r.isProcessValueDone&&(this.removeDependency(r),await r.updateElement())}if(Object.keys(H(this,Fe)).length==0){Ur.debug("Document",`已完成第计算, 共${H(this,He)+1}轮`);return}Rn(this,He)._++,!(H(this,He)>=100)&&await st(this,xe,cn).call(this)},ln=function(t){this.renderState=t,this.state.renderState=t};let It=An;function Ct(e){const t=j.create(e),n=e.children.map(r=>j.create(r));return t.appendMany(n),t}async function so(e,t={}){const n=e.define.pages.map(l=>r(l));e.data=t,e.appendMany(n),await e.onCreated(),e.renderState=le.RENDERING,e.state.renderState=le.RENDERING;function r(l){const f=Mt.create(l,e.define.paper);i(f);for(const d of f.defines){const y=o(d);y.define.isFixed?f.appendToFixed(y):f.append(y)}return s(f),f.state=Dt.INIT,f}function i(l){if(!(l.header.display!=!0||l.header.defines.length==0))for(const f of l.header.defines)l.appendToHeader(o(f))}function s(l){if(!(l.footer.display!=!0||l.footer.defines.length==0))for(const f of l.footer.defines)l.appendToFooter(o(f))}function o(l){switch(l.type){case"Table":return a(l);default:return j.create(l)}}function a(l){const f=j.create(l),d=l.children;for(const y of d){if(y.isRepeat){f.appendMany(u(y));continue}f.append(Ct(y))}return f}function u(l){const f=Qe(l.ds.value),d=ct(t,f.value);return Br(d).map((y,m)=>{const R=Ct(l);return R.repeatIndex=m,R.rowData=y,R})}return e}function oo(e,t,n){let r=null,i=1;async function s(){const c=t.rendering,h=t.pages[c];return h==null?t.mount():(h.beginPaging(),h.createElement()==null?(t.rendering+=1,s()):(await t.mountChild(h),await a(h),await u(h),h.file!==r&&(i=1),h.pageNum=i++,await h.onPaged(),t.rendering+=1,t.state.total=t.pages.length,s()))}function o(c,h){const p=c.children[c.rendering-1];return p==null?c.extra?c.header.offsetHeight+4:h.offsetTop:!p.isChanged||tn.isIsolated(p.define,h.define)?h.offsetTop:p.offsetBottom+h.define.top-p.define.top-p.define.height}async function a(c){const h=c.children[c.rendering];return h==null?void 0:(h.offsetTop=o(c,h),h.createElement()==null?(c.rendering+=1,a(c)):(await l(c,h),c.rendering+=1,a(c)))}async function u(c){for(const h of c.fixed)h.createElement(),await c.mountChild(h)}function l(c,h){switch(h.define.type){case se.TABLE:return m(c,h);case se.TEXT:return R(c,h);default:return v(c,h)}}async function f(c,h){const p=h.children[h.rendering];if(p==null)return;if(p.extra&&p.isUndefinedValue&&await p.onCreated(),p.createElement()==null)return h.rendering+=1,f(c,h);await h.mountChild(p);const q=Yr.mm_to_px(c.paper.offsetHeight)-c.footer.offsetHeight;if(h.offsetBottom-q>=2){const L=d(c,h,q),k=h.children.filter(x=>x.extra);return t.insert(L,c.index+1),await Promise.allSettled(k.map(x=>x.onCreated())),await L.onCreated(),f(c,h)}return h.rendering+=1,f(c,h)}function d(c,h,p){const N=h.define.footer.map(M=>{const D=Ct(M);return D.extra=!0,D}),q=p-N.reduce((M,D)=>M+D.offsetHeight,0),L=y(h,q),k=h.splitRows(L);h.appendMany(N),h.atomized=!0,h.rendering=L-1;const x=c.clone(),C=new gr(h.define),z=h.define.header.map(M=>Ct(M));C.extra=!0,C.appendMany(z),C.appendMany(k),x.append(C);for(let M=c.rendering+1,D=c.children.length;M<D;M++){const O=c.children[M];tn.isIsolated(O.define,h.define)||(x.append(O),Reflect.set(c.children,M,null))}return c.children=c.children.filter(M=>M!=null),x}function y(c,h){let p=c.offsetTop;for(let N=0;N<c.children.length;N++){if(p+=c.children[N].offsetHeight,p==h)return N;if(p>h)return N-1}return c.children.length-1}async function m(c,h){return await c.mountChild(h),f(c,h)}async function R(c,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),c.mountChild(h)}async function v(c,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),c.mountChild(h)}return async function(){pi(),await Ge(),await so(t,n);const c=t.createElement();return c&&e.appendChild(c),r=t.pages[0].file,s()}}function ao(e){const t=Date.now(),n=It.create(e.define,e.state);return oo(e.container,n,e.data??{})().then(()=>{n.state.renderTime=Date.now()-t}),n}const uo=dt({__name:"DocState",props:{state:{type:Object,required:!0}},setup(e){const t=e,n=be(()=>t.state.renderState===le.READY),r=be(()=>t.state.renderState===le.READY?"已就绪":t.state.renderState===le.RENDERING?`正在生成(${t.state.total??0}页)...`:"正在生成...");return(i,s)=>(Ye(),Ze("div",null,[s[0]||(s[0]=ue("span",null,"文档：",-1)),ue("span",{class:ie({[i.classes.finished]:n.value})},bt(r.value),3)]))}}),co="_finished_7h37m_2",lo={finished:co},fo={classes:lo},ho=$t(uo,[["__cssModules",fo]]),po="_toolbar_3etac_1",mo="_button_3etac_9",go="_actived_3etac_33",vo="_divider_3etac_46",je={toolbar:po,button:mo,actived:go,divider:vo},Eo=["viewMode","debug","space","print"],wo=dt({props:{doc:{type:It},buttons:{type:Array,required:!0}},setup(e){function t(){var u;(u=e.doc)==null||u.print()}function n(){var u;(u=e.doc)==null||u.toggleViewMode()}function r(){var l;const u={[je.button]:!0,[je.actived]:((l=e.doc)==null?void 0:l.state.viewMode)==="multiple"};return W("button",{type:"button",title:"切换单页/多页视图",class:u,onClick:n},[W(sn,{icon:"icon-multi-page"},null),W("span",null,[Rt("多页")])])}function i(){return W("button",{type:"button",class:je.button,onClick:t,title:"打印 Ctrl + P"},[W(sn,{icon:"icon-printer"},null),W("span",null,[Rt("打印")])])}function s(){return W("div",{class:je.divider},null)}function o(){return W("div",{class:"quickprint-is-fill-w"},null)}function a(u){if(typeof u=="function")return u(je,e.doc);switch(u){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return W("div",{class:je.toolbar},[e.buttons.map(a)])}}});function yo(e){function t(i){const s=e.value;if(s!=null)switch(i.key){case"p":case"P":if(i.ctrlKey)return i.preventDefault(),s.print();case"Add":if(i.ctrlKey)return i.preventDefault(),s.zoomOut();case"Subtract":if(i.ctrlKey)return i.preventDefault(),s.zoomIn();case"0":if(i.ctrlKey)return i.preventDefault(),s.resetZoom();case"m":case"M":if(i.ctrlKey)return i.preventDefault(),s.toggleViewMode()}}function n(){window.addEventListener("keydown",t)}function r(){window.removeEventListener("keydown",t)}return{enable:n,disable:r}}const No={key:1,class:"quickprint-is-fill-w"},_o=dt({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return Eo}}},emits:["mock"],setup(e,{emit:t}){const n=e,r=tr("classes"),i=Ot(),s=Ot(),o=nr({}),a=yo(s),u=be(()=>o.renderState===le.READY),l=be(()=>{const h=o.renderTime??0;if(h<=6e4)return`${h/1e3}秒`;const p=Math.floor(h/1e3),N=p%60,q=(p-N)/60;return N==0?`${q}分`:`${q}分${N}秒`}),f=be(()=>o.total??"--"),d=be(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function y(){var h;(h=s.value)==null||h.zoomIn()}function m(){var h;(h=s.value)==null||h.zoomOut()}function R(h){var p,N;h.deltaY>0?(p=s.value)==null||p.zoomIn():(N=s.value)==null||N.zoomOut()}function v(){var h;(h=s.value)==null||h.toggleDebug()}async function c(){const h=ao({container:i.value,define:rn.create(n.define),state:o,data:n.data});s.value=h,document.title=h?`${h.define.name} - OpenPrint`:"OpenPrint",await h.ready(),a.enable();const p=window.location.hostname;(p==="localhost"||p==="127.0.0.1")&&h.debug()}return ni(()=>{c()}),(h,p)=>{var N;return Ye(),Ze("div",{class:ie(J(r).preview),onWheel:ii(R,["ctrl","prevent"])},[ue("div",{class:ie([J(Ae).PRINT_HIDDEN,J(r).header])},[ue("div",{class:ie(J(r).headerLeft)},[Cn(h.$slots,"headerLeft")],2),W(J(wo),{doc:s.value,buttons:e.buttons},null,8,["doc","buttons"]),ue("div",{class:ie(J(r).headerRight)},[Cn(h.$slots,"headerRight")],2)],2),ue("div",{class:ie(d.value),ref_key:"containerRef",ref:i},null,2),ue("div",{class:ie([J(Ae).PRINT_HIDDEN,J(r).footer])},[W(ho,{state:o,class:ie(J(r).status)},null,8,["state","class"]),u.value?(Ye(),Ze(ri,{key:0},[ue("div",{class:ie(J(r).status)},"用时："+bt(l.value),3),p[0]||(p[0]=ue("div",{class:"quickprint-is-fill-w"},null,-1)),ue("button",{type:"button",class:ie({"quickprint-text-btn":!0,"quickprint-is-selected":(N=s.value)==null?void 0:N.state.debug}),title:"调试模式",onClick:v},[W(J(sn),{icon:"icon-bug"})],2),p[1]||(p[1]=ue("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ue("div",{class:ie(J(r).divider)},null,2),ue("div",{class:ie(J(r).status)},"第1页，共"+bt(f.value)+"页",3),ue("div",{class:ie(J(r).divider)},null,2)],64)):(Ye(),Ze("div",No)),W(J(Vr),{class:ie(J(r).zoom),scale:o.scale,onZoomIn:y,onZoomOut:m},null,8,["class","scale"])],2)],34)}}}),Do="_preview_1hc69_2",To="_header_1hc69_13",So="_headerLeft_1hc69_22",Ao="_headerRight_1hc69_28",bo="_body_1hc69_34",Ro="_footer_1hc69_53",Oo="_status_1hc69_73",Mo="_divider_1hc69_79",Po="_zoom_1hc69_86",Io={preview:Do,header:To,headerLeft:So,headerRight:Ao,body:bo,footer:Ro,status:Oo,divider:Mo,zoom:Po},Co={classes:Io},Lo=$t(_o,[["__cssModules",Co]]),ko=dt({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(e){const t=e,n=tr("classes"),r=Gr(),i=er(t.local??[]),s=nr(t.ds.fields.map(l=>u(l))),o=[{label:"文本",value:me.STRING},{label:"数字",value:me.NUMBER},{label:"日期",value:me.DATE},{label:"对象",value:me.OBJECT},{label:"数组",value:me.ARRAY}],a=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(l,f){var y;const d=l[f.name];return((y=o.find(m=>m.value===d))==null?void 0:y.label)??d}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(l,f){if(l.type===me.OBJECT)return null;if(l.type===me.ARRAY)return Ln(W("input",{type:"number","onUpdate:modelValue":y=>l.total=y,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[oi,l.total]]);const d=t.options.find(y=>y.classify===l.type);return d==null?null:Ln(W("select",{"onUpdate:modelValue":y=>l.func=y,class:n.select},[W("option",{value:"",class:n.placeholder},[Rt("请选择")]),d.rules.map(y=>W("option",{value:y.func,key:y.func},[y.name]))]),[[ai,l.func]])}}];function u(l,f){const d=f?`${f}.${l.name}`:l.name,y=l.children?l.children.map(R=>u(R,l.name)):void 0,m=i[d];return{type:l.type,name:l.name,title:l.title,children:y,$expand:!0,func:(m==null?void 0:m.func)??"",total:m==null?void 0:m.total}}return r==null||r.useHandle("confirm",()=>si(s)),(l,f)=>(Ye(),Ze("div",{class:ie(J(n).ds)},[W(J(zr),{columns:a,data:s},null,8,["data"])],2))}}),xo="_ds_6a9ph_2",qo="_placeholder_6a9ph_8",$o="_select_6a9ph_12",Fo="_input_6a9ph_13",Ho={ds:xo,placeholder:qo,select:$o,input:Fo},Uo={classes:Ho},Bo=$t(ko,[["__cssModules",Uo]]);let yt=null;const Xn=490;function Sr(){return yt!=null?Promise.resolve(yt):Zr(()=>import("./mock-CXH56Phs.js"),__vite__mapDeps([0,1,2,3])).then(e=>(yt=e.default,yt))}function Kn(e,t){switch(t){case me.DATE:return e.randDate();case me.NUMBER:return e.randDecimal();case me.STRING:return e.randName();default:return null}}function Yo(e){if((e==null?void 0:e.total)==null)return Xn;const t=Number(e.total);return Number.isNaN(t)||!Number.isFinite(t)||t<=0?Xn:Math.round(t)}function en(e,t,n){if(n==null||et(n.func))return Kn(e,t.type);const r=e[n.func];return typeof r!="function"?Kn(e,t.type):r(n)}const Vo=jr(function(e,t,n){const r={ds:t,options:e.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:Xr.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return Kr("创建模拟数据",ui(Bo,r),i).promisify()});async function Jn(e,t){if(e==null)return[];const n=await Sr(),r=await Vo(n,e,t).catch(Wr);return Array.isArray(r)?r:[]}async function Nt(e,t){if(e==null||!Array.isArray(t)||t.length==0)return{};const n=await Sr(),r=er(t);return e.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===me.OBJECT){const a=s.children??[];return i[s.name]=a.reduce((u,l)=>{if(et(l.name))return u;const f=`${s.name}.${l.name}`;return u[l.name]=en(n,l,r[f]),u},{}),i}if(s.type===me.ARRAY){const a=s.children??[],u=Yo(o),l=10+Math.round(Math.random()*u);return i[s.name]=Array(l).fill("").map(()=>a.reduce((f,d)=>{if(et(d.name))return f;const y=`${s.name}.${d.name}`;return f[d.name]=en(n,d,r[y]),f},{})),i}return i[s.name]=en(n,s,o),i},{})}const Go=dt({__name:"index",setup(e){const t={INIT:0,LOADED_CASE:1,LOADED_DATA:2,READY:3},n=Ot(),r=Ot(),i=jt(0),s=jt(!1),o=be(()=>{var c;return`${((c=n.value)==null?void 0:c.id)??Date.now()}-${i.value}`}),a=jt(t.INIT),u=be(()=>["viewMode","debug","space",s.value?m:null,"print"]),l=be(()=>a.value===t.INIT?"正在加载...":a.value===t.LOADED_CASE?"已加载模板，正在准备数据...":a.value===t.LOADED_DATA?"开始渲染模板":"");function f(){const c=new URLSearchParams(window.location.search).get("id");return dn(c)&&(c==="local"||In.some(h=>h.id===c))?c:In[0].id}async function d(v){var N,q,L,k;if(v==null)return{};if(v.data)return s.value=!1,v.data;const c=Mn(v.id);if(Array.isArray(c)&&c.length>0)return Nt((N=v.define)==null?void 0:N.ds,c);const h=v.rules;if(Array.isArray(h)&&h.length>0)return Nt((q=v.define)==null?void 0:q.ds,h);const p=await Jn((L=n.value)==null?void 0:L.ds);return Pn(p,v.id),Nt((k=v.define)==null?void 0:k.ds,p)}async function y(){if(n.value==null)return;const v=n.value.id;if(v==null||v=="")return;const c=Mn(v),h=await Jn(n.value.ds,c);Pn(h,n.value.id),r.value=await Nt(n.value.ds,h),i.value++}function m(v){return W("button",{type:"button",class:v.button,onClick:y},[W("span",null,[Rt("模拟数据")])])}async function R(){a.value=t.INIT,s.value=!0;const v=await Jr(f());n.value=(v==null?void 0:v.define)??{},a.value=t.LOADED_CASE,r.value=await d(v),a.value=t.LOADED_DATA,a.value=t.READY}return R(),(v,c)=>a.value<=t.LOADED_DATA?(Ye(),Ze("div",{key:0,class:ie(v.classes.logs)},bt(l.value),3)):(Ye(),ci(J(Lo),{define:n.value,data:r.value,buttons:u.value,key:o.value,class:ie(v.classes.preview),onMock:y},null,8,["define","data","buttons","class"]))}}),zo="_preview_17t3s_7",jo="_logs_17t3s_11",Wo={preview:zo,logs:jo},Zo={classes:Wo},Xo=$t(Go,[["__cssModules",Zo]]),Sn=li(Xo),Ko=Qr();Sn.use(ei,{zIndex:Ko});Sn.mount("#app");ti(Sn._context);
