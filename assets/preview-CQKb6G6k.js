const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/mock-DUDdPH4f.js","assets/utils-B5FdvqY9.js","assets/vue-C4hvfNT6.js","assets/utils-B7EFy5Gd.css"])))=>i.map(i=>d[i]);
var Or=Object.defineProperty;var On=t=>{throw TypeError(t)};var Mr=(t,e,n)=>e in t?Or(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var L=(t,e,n)=>Mr(t,typeof e!="symbol"?e+"":e,n),Gt=(t,e,n)=>e.has(t)||On("Cannot "+n);var F=(t,e,n)=>(Gt(t,e,"read from private field"),n?n.call(t):e.get(t)),de=(t,e,n)=>e.has(t)?On("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),it=(t,e,n,r)=>(Gt(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),st=(t,e,n)=>(Gt(t,e,"access private method"),n);var Mn=(t,e,n,r)=>({set _(i){it(t,e,i,n)},get _(){return F(t,e,r)}});import{C as Lr,ag as dn,ah as pn,aG as Ye,r as nn,ap as Ir,aq as Cr,b as se,aH as B,y as ve,p as mn,v as Qe,i as vt,P as Pr,m as et,D as wt,x as xr,w as zt,aI as ct,a as ot,N as Wt,O as Dt,n as kr,E as Ln,t as gn,F as rn,u as lt,B as Te,o as $r,S as qr,V as In,c as ue,q as Hr,G as sn,L as Fr,aJ as Ur,U as Br,_ as Ht,I as on,aw as Yr,H as Vr,aK as nr,h as me,T as Gr,K as zr,W as Wr,A as jr,ay as Zr,R as Xr,aL as Cn,aM as Pn,aD as Kr,aC as xn,az as Jr,aA as Qr,aB as ei}from"./utils-B5FdvqY9.js";import{d as pt,h as Re,c as Ze,a as Ve,b as ae,n as ie,v as Rt,e as j,D as Ot,u as rr,s as Mt,g as ir,J as ti,i as J,f as kn,F as ni,w as ri,y as ii,B as $n,C as si,S as oi,N as ui,r as jt,j as ai,R as li}from"./vue-C4hvfNT6.js";const ce=Object.freeze({CREATED:0,RENDERING:1,PAGED:2,READY:3,UNMOUNT:4}),_t=Object.freeze({CREATED:0,INIT:1,PAGING:2,PAGED:3,READY:4}),un=Object.freeze({CREATED:0,MOUNDTED:1}),le={UNDEFINED:0,PENDING:1,DONE:2},Ae={PENDING:-1,HIDDEN:0,VISIBLE:1},ut=[25,50,75,100,125,150,200,300,400],ci=["class","className","style"],Se=Object.freeze({DOCUMENT:"quickprint-document",PAGE:"quickprint-page",PAPER:"quickprint-paper",PRINT_HIDDEN:"quickprint-hidden",GUIDDE_LINE:"quickprint-guide-line"}),qn=Promise.resolve(),fi=2e3,hi=48;let an=0,Tt=0;function di(){an=0,Tt=0}function ze(){return an<=fi?(an++,qn):Tt<hi?(Tt++,qn):new Promise(t=>{Tt=0,setTimeout(t)})}function pi(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&(t.charCodeAt(2)>122||t.charCodeAt(2)<97)}function mi(t){return t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)>96&&t.charCodeAt(2)<123}function ln(t){return t==null?"":typeof t=="string"?t.trim():Array.isArray(t)?t.map(ln).join(" "):typeof t=="object"?Object.keys(t).filter(e=>t[e]).join(" "):""}function sr(t,e){if(e!=null){if(e instanceof Element){t.appendChild(e);return}if(Array.isArray(e)){for(const n of e)sr(t,n);return}t.textContent+=e}}function gi(t,e){if(!(e==null||typeof e!="object"))for(const n of Object.keys(e)){const r=e[n];if(r==null)continue;const i=Lr(n);t.style.setProperty(i,r)}}function Ei(t,e){if(ln(e)=="")return;const r=t.className==""?"":" ";t.className+=r+ln(e)}function or(t,e,n){switch(e){case"class":case"className":Ei(t,n);break;case"style":gi(t,n);break;case"children":n!=null&&sr(t,n);break;case"innerHTML":break;default:if(e[0]==="@")return vi(t,e,n);e in t&&(t[e]=n),n==null?t.removeAttribute(e):t.setAttribute(e,n)}}function vi(t,e,n){Reflect.set(t,e.slice(1),n)}function wi(t,e,n){const r=t(e);if(r==null)return null;for(const i of Object.keys(e??{}))(pi(i)||mi(i)||ci.includes(i))&&or(r,i,e[i]);return r}function yi(t,e,n){const r=document.createElement(t);if(r==null)return null;for(const i of Object.keys(e??{}))or(r,i,e[i]);return r}function Q(t,e,n){return typeof t=="function"?wi(t,e):yi(t,e)}function Hn(){return{display:!1,postion:0,height:0,offsetTop:0,offsetHeight:0,defines:[],children:[]}}var xt,xe;const kt=class kt{constructor(e,n,r){de(this,xt,dn(pn.PRINT_PAGE));de(this,xe,Object.create(null));L(this,"file");L(this,"define");L(this,"pageNum",-1);L(this,"pageTotal",-1);L(this,"extra",!1);L(this,"paper");L(this,"header");L(this,"footer");L(this,"children",[]);L(this,"fixed",[]);L(this,"parent");L(this,"element");L(this,"rendering");L(this,"state",_t.CREATED);this.file=r,this.define=e,this.paper=this.createPaper(e,n),this.header=this.createHeader(),this.footer=this.createFooter(),Ye(this,"parent",null),Ye(this,"element",null),Ye(this,"rendering",0)}static create(e,n,r="0000"){return new kt(e,n,r)}get id(){return"@"+F(this,xt)}get index(){return this.parent==null?-1:this.parent.pages.findIndex(e=>e.id===this.id)}get defines(){const e=new Set,n=this.header,r=this.footer;return n.display&&n.defines.length>0&&n.defines.forEach(i=>e.add(i.id)),r.display&&r.defines.length>0&&r.defines.forEach(i=>e.add(i.id)),this.define.children.filter(i=>!e.has(i.id)).sort(nn.sort)}get style(){const{offsetWidth:e,offsetHeight:n}=this.paper;return{width:e+"px",height:n+"px"}}get isLast(){return this.pageNum===this.pageTotal}createPageHeader(){const e=this.header;if(e.display!==!0)return null;const n={top:e.offsetTop+"px"},r=[Se.GUIDDE_LINE,Se.PRINT_HIDDEN];return[...e.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}createPageFooter(){const e=this.footer;if(e.display!==!0)return null;const n={top:e.offsetTop+"px"},r=[Se.GUIDDE_LINE,Se.PRINT_HIDDEN];return[...e.children.map(i=>i.createElement()),Q("div",{class:r,style:n})]}render(){return Q("div",{id:this.id,class:Se.PAGE,"data-index":this.index+1,children:Q("div",{class:Se.PAPER,children:[this.createPageHeader(),this.createPageFooter()]})})}createElement(){return this.element?this.element:(this.element=this.render(),this.element)}async mount(e){this.state=_t.PAGED,await this.onPaged()}async mountChild(e){if(this.element==null||e.element==null)return!1;const n=this.element.querySelector(".quickprint-paper");return n==null?!1:(n.appendChild(e.element),await ze(),await e.mount(e.element),!0)}async replaceChild(e,n){if(this.element==null||e.element==null)return!1;const r=this.element.querySelector(".quickprint-paper");return r==null?!1:(n==null?r.removeChild(e.element):r.replaceChild(n,e.element),await ze(),await e.mount(n),!0)}beginPaging(){this.state=_t.PAGING}onCreated(){const e=[...this.header.children,...this.children,...this.footer.children,...this.fixed];return Promise.allSettled(e.map(n=>n.onCreated()))}onPaged(){const e=this.children.map(n=>typeof n.onPaged=="function"?n.onPaged():Promise.resolve());return Promise.allSettled(e)}onFinshed(){const e=this.children.map(r=>typeof r.onFinished=="function"?r.onFinished():Promise.resolve()),n=this.adjustFooter();return n&&e.push(n),Promise.allSettled(e)}setParent(e){this.parent=e}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}append(e){e.setParent(this),this.children.push(e),F(this,xe)[e.id]=e}appendToHeader(e){e.setParent(this),this.header.children.push(e),F(this,xe)[e.id]=e}appendToFooter(e){e.setParent(this),this.footer.children.push(e),F(this,xe)[e.id]=e}appendToFixed(e){e.setParent(this),this.fixed.push(e),F(this,xe)[e.id]=e}createPaper(e,n){return{size:n.size,width:n.width,height:n.height,orientation:e.orientation,offsetWidth:Math.round(n.width),offsetHeight:Math.round(n.height)}}createHeader(){const e=this.define.header;if(e.display!==!0)return Hn();const n=e.height??0;return{display:!0,postion:n,height:n,offsetTop:Math.round(n),offsetHeight:Math.round(n),defines:this.define.children.filter(r=>r.top+r.height<=n),children:[]}}createFooter(){const e=this.define.footer;if(e.display!==!0)return Hn();const n=e.height??0,i=Math.floor(Ir(this.paper.height))-n;return{display:!0,postion:i,height:n,offsetTop:Math.round(i),offsetHeight:Math.round(n),defines:this.define.children.filter(s=>s.top>=i),children:[]}}clone(){const e=new kt(this.define,this.paper,this.file);e.rendering=0;for(const n of this.header.children){const r=n.clone();e.appendToHeader(r)}for(const n of this.footer.children){const r=n.clone();e.appendToFooter(r)}return e}findElement(e){const n=F(this,xe)[e];if(n)return n;for(const r of this.children){const i=r.findElement(e);if(i)return i}}filterElement(e){const n=typeof e=="string"?e:e.id;return this.children.filter(r=>r.define.id===n)}adjustFooter(){if(!this.isLast||this.define.footer.flow!==Cr.TABLE)return;let e=0,n=null;for(const i of this.children)if(i.offsetBottom>e&&(e=i.offsetBottom),i.type===se.TABLE){if(n==null){n=i;continue}i.offsetBottom>n.offsetBottom&&(n=i)}if(n==null||Math.abs(e-n.offsetBottom)>=4)return;const r=Math.floor(this.footer.offsetTop-n.offsetBottom);return Promise.allSettled(this.footer.children.map(i=>(i.offsetTop-=r,i.updateElement())))}};xt=new WeakMap,xe=new WeakMap;let Lt=kt;var tt=1e9,Ni={precision:20,rounding:4,toExpNeg:-7,toExpPos:21,LN10:"2.302585092994045684017991454684364207601101488628772976033327900967572609677352480235997205089598298341967784042286"},vn,V=!0,ge="[DecimalError] ",Ge=ge+"Invalid argument: ",En=ge+"Exponent out of range: ",nt=Math.floor,He=Math.pow,bi=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,fe,ne=1e7,Y=7,ur=9007199254740991,It=nt(ur/Y),b={};b.absoluteValue=b.abs=function(){var t=new this.constructor(this);return t.s&&(t.s=1),t};b.comparedTo=b.cmp=function(t){var e,n,r,i,s=this;if(t=new s.constructor(t),s.s!==t.s)return s.s||-t.s;if(s.e!==t.e)return s.e>t.e^s.s<0?1:-1;for(r=s.d.length,i=t.d.length,e=0,n=r<i?r:i;e<n;++e)if(s.d[e]!==t.d[e])return s.d[e]>t.d[e]^s.s<0?1:-1;return r===i?0:r>i^s.s<0?1:-1};b.decimalPlaces=b.dp=function(){var t=this,e=t.d.length-1,n=(e-t.e)*Y;if(e=t.d[e],e)for(;e%10==0;e/=10)n--;return n<0?0:n};b.dividedBy=b.div=function(t){return Me(this,new this.constructor(t))};b.dividedToIntegerBy=b.idiv=function(t){var e=this,n=e.constructor;return H(Me(e,new n(t),0,1),n.precision)};b.equals=b.eq=function(t){return!this.cmp(t)};b.exponent=function(){return X(this)};b.greaterThan=b.gt=function(t){return this.cmp(t)>0};b.greaterThanOrEqualTo=b.gte=function(t){return this.cmp(t)>=0};b.isInteger=b.isint=function(){return this.e>this.d.length-2};b.isNegative=b.isneg=function(){return this.s<0};b.isPositive=b.ispos=function(){return this.s>0};b.isZero=function(){return this.s===0};b.lessThan=b.lt=function(t){return this.cmp(t)<0};b.lessThanOrEqualTo=b.lte=function(t){return this.cmp(t)<1};b.logarithm=b.log=function(t){var e,n=this,r=n.constructor,i=r.precision,s=i+5;if(t===void 0)t=new r(10);else if(t=new r(t),t.s<1||t.eq(fe))throw Error(ge+"NaN");if(n.s<1)throw Error(ge+(n.s?"NaN":"-Infinity"));return n.eq(fe)?new r(0):(V=!1,e=Me(ht(n,s),ht(t,s),s),V=!0,H(e,i))};b.minus=b.sub=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?cr(e,t):ar(e,(t.s=-t.s,t))};b.modulo=b.mod=function(t){var e,n=this,r=n.constructor,i=r.precision;if(t=new r(t),!t.s)throw Error(ge+"NaN");return n.s?(V=!1,e=Me(n,t,0,1).times(t),V=!0,n.minus(e)):H(new r(n),i)};b.naturalExponential=b.exp=function(){return lr(this)};b.naturalLogarithm=b.ln=function(){return ht(this)};b.negated=b.neg=function(){var t=new this.constructor(this);return t.s=-t.s||0,t};b.plus=b.add=function(t){var e=this;return t=new e.constructor(t),e.s==t.s?ar(e,t):cr(e,(t.s=-t.s,t))};b.precision=b.sd=function(t){var e,n,r,i=this;if(t!==void 0&&t!==!!t&&t!==1&&t!==0)throw Error(Ge+t);if(e=X(i)+1,r=i.d.length-1,n=r*Y+1,r=i.d[r],r){for(;r%10==0;r/=10)n--;for(r=i.d[0];r>=10;r/=10)n++}return t&&e>n?e:n};b.squareRoot=b.sqrt=function(){var t,e,n,r,i,s,o,u=this,a=u.constructor;if(u.s<1){if(!u.s)return new a(0);throw Error(ge+"NaN")}for(t=X(u),V=!1,i=Math.sqrt(+u),i==0||i==1/0?(e=ye(u.d),(e.length+t)%2==0&&(e+="0"),i=Math.sqrt(e),t=nt((t+1)/2)-(t<0||t%2),i==1/0?e="5e"+t:(e=i.toExponential(),e=e.slice(0,e.indexOf("e")+1)+t),r=new a(e)):r=new a(i.toString()),n=a.precision,i=o=n+3;;)if(s=r,r=s.plus(Me(u,s,o+2)).times(.5),ye(s.d).slice(0,o)===(e=ye(r.d)).slice(0,o)){if(e=e.slice(o-3,o+1),i==o&&e=="4999"){if(H(s,n+1,0),s.times(s).eq(u)){r=s;break}}else if(e!="9999")break;o+=4}return V=!0,H(r,n)};b.times=b.mul=function(t){var e,n,r,i,s,o,u,a,c,f=this,d=f.constructor,y=f.d,m=(t=new d(t)).d;if(!f.s||!t.s)return new d(0);for(t.s*=f.s,n=f.e+t.e,a=y.length,c=m.length,a<c&&(s=y,y=m,m=s,o=a,a=c,c=o),s=[],o=a+c,r=o;r--;)s.push(0);for(r=c;--r>=0;){for(e=0,i=a+r;i>r;)u=s[i]+m[r]*y[i-r-1]+e,s[i--]=u%ne|0,e=u/ne|0;s[i]=(s[i]+e)%ne|0}for(;!s[--o];)s.pop();return e?++n:s.shift(),t.d=s,t.e=n,V?H(t,d.precision):t};b.toDecimalPlaces=b.todp=function(t,e){var n=this,r=n.constructor;return n=new r(n),t===void 0?n:(be(t,0,tt),e===void 0?e=r.rounding:be(e,0,8),H(n,t+X(n)+1,e))};b.toExponential=function(t,e){var n,r=this,i=r.constructor;return t===void 0?n=We(r,!0):(be(t,0,tt),e===void 0?e=i.rounding:be(e,0,8),r=H(new i(r),t+1,e),n=We(r,!0,t+1)),n};b.toFixed=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?We(i):(be(t,0,tt),e===void 0?e=s.rounding:be(e,0,8),r=H(new s(i),t+X(i)+1,e),n=We(r.abs(),!1,t+X(r)+1),i.isneg()&&!i.isZero()?"-"+n:n)};b.toInteger=b.toint=function(){var t=this,e=t.constructor;return H(new e(t),X(t)+1,e.rounding)};b.toNumber=function(){return+this};b.toPower=b.pow=function(t){var e,n,r,i,s,o,u=this,a=u.constructor,c=12,f=+(t=new a(t));if(!t.s)return new a(fe);if(u=new a(u),!u.s){if(t.s<1)throw Error(ge+"Infinity");return u}if(u.eq(fe))return u;if(r=a.precision,t.eq(fe))return H(u,r);if(e=t.e,n=t.d.length-1,o=e>=n,s=u.s,o){if((n=f<0?-f:f)<=ur){for(i=new a(fe),e=Math.ceil(r/Y+4),V=!1;n%2&&(i=i.times(u),Un(i.d,e)),n=nt(n/2),n!==0;)u=u.times(u),Un(u.d,e);return V=!0,t.s<0?new a(fe).div(i):H(i,r)}}else if(s<0)throw Error(ge+"NaN");return s=s<0&&t.d[Math.max(e,n)]&1?-1:1,u.s=1,V=!1,i=t.times(ht(u,r+c)),V=!0,i=lr(i),i.s=s,i};b.toPrecision=function(t,e){var n,r,i=this,s=i.constructor;return t===void 0?(n=X(i),r=We(i,n<=s.toExpNeg||n>=s.toExpPos)):(be(t,1,tt),e===void 0?e=s.rounding:be(e,0,8),i=H(new s(i),t,e),n=X(i),r=We(i,t<=n||n<=s.toExpNeg,t)),r};b.toSignificantDigits=b.tosd=function(t,e){var n=this,r=n.constructor;return t===void 0?(t=r.precision,e=r.rounding):(be(t,1,tt),e===void 0?e=r.rounding:be(e,0,8)),H(new r(n),t,e)};b.toString=b.valueOf=b.val=b.toJSON=b[Symbol.for("nodejs.util.inspect.custom")]=function(){var t=this,e=X(t),n=t.constructor;return We(t,e<=n.toExpNeg||e>=n.toExpPos)};function ar(t,e){var n,r,i,s,o,u,a,c,f=t.constructor,d=f.precision;if(!t.s||!e.s)return e.s||(e=new f(t)),V?H(e,d):e;if(a=t.d,c=e.d,o=t.e,i=e.e,a=a.slice(),s=o-i,s){for(s<0?(r=a,s=-s,u=c.length):(r=c,i=o,u=a.length),o=Math.ceil(d/Y),u=o>u?o+1:u+1,s>u&&(s=u,r.length=1),r.reverse();s--;)r.push(0);r.reverse()}for(u=a.length,s=c.length,u-s<0&&(s=u,r=c,c=a,a=r),n=0;s;)n=(a[--s]=a[s]+c[s]+n)/ne|0,a[s]%=ne;for(n&&(a.unshift(n),++i),u=a.length;a[--u]==0;)a.pop();return e.d=a,e.e=i,V?H(e,d):e}function be(t,e,n){if(t!==~~t||t<e||t>n)throw Error(Ge+t)}function ye(t){var e,n,r,i=t.length-1,s="",o=t[0];if(i>0){for(s+=o,e=1;e<i;e++)r=t[e]+"",n=Y-r.length,n&&(s+=Pe(n)),s+=r;o=t[e],r=o+"",n=Y-r.length,n&&(s+=Pe(n))}else if(o===0)return"0";for(;o%10===0;)o/=10;return s+o}var Me=function(){function t(r,i){var s,o=0,u=r.length;for(r=r.slice();u--;)s=r[u]*i+o,r[u]=s%ne|0,o=s/ne|0;return o&&r.unshift(o),r}function e(r,i,s,o){var u,a;if(s!=o)a=s>o?1:-1;else for(u=a=0;u<s;u++)if(r[u]!=i[u]){a=r[u]>i[u]?1:-1;break}return a}function n(r,i,s){for(var o=0;s--;)r[s]-=o,o=r[s]<i[s]?1:0,r[s]=o*ne+r[s]-i[s];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,s,o){var u,a,c,f,d,y,m,R,E,l,h,p,N,$,P,x,k,C,z=r.constructor,M=r.s==i.s?1:-1,D=r.d,O=i.d;if(!r.s)return new z(r);if(!i.s)throw Error(ge+"Division by zero");for(a=r.e-i.e,k=O.length,P=D.length,m=new z(M),R=m.d=[],c=0;O[c]==(D[c]||0);)++c;if(O[c]>(D[c]||0)&&--a,s==null?p=s=z.precision:o?p=s+(X(r)-X(i))+1:p=s,p<0)return new z(0);if(p=p/Y+2|0,c=0,k==1)for(f=0,O=O[0],p++;(c<P||f)&&p--;c++)N=f*ne+(D[c]||0),R[c]=N/O|0,f=N%O|0;else{for(f=ne/(O[0]+1)|0,f>1&&(O=t(O,f),D=t(D,f),k=O.length,P=D.length),$=k,E=D.slice(0,k),l=E.length;l<k;)E[l++]=0;C=O.slice(),C.unshift(0),x=O[0],O[1]>=ne/2&&++x;do f=0,u=e(O,E,k,l),u<0?(h=E[0],k!=l&&(h=h*ne+(E[1]||0)),f=h/x|0,f>1?(f>=ne&&(f=ne-1),d=t(O,f),y=d.length,l=E.length,u=e(d,E,y,l),u==1&&(f--,n(d,k<y?C:O,y))):(f==0&&(u=f=1),d=O.slice()),y=d.length,y<l&&d.unshift(0),n(E,d,l),u==-1&&(l=E.length,u=e(O,E,k,l),u<1&&(f++,n(E,k<l?C:O,l))),l=E.length):u===0&&(f++,E=[0]),R[c++]=f,u&&E[0]?E[l++]=D[$]||0:(E=[D[$]],l=1);while(($++<P||E[0]!==void 0)&&p--)}return R[0]||R.shift(),m.e=a,H(m,o?s+X(m)+1:s)}}();function lr(t,e){var n,r,i,s,o,u,a=0,c=0,f=t.constructor,d=f.precision;if(X(t)>16)throw Error(En+X(t));if(!t.s)return new f(fe);for(V=!1,u=d,o=new f(.03125);t.abs().gte(.1);)t=t.times(o),c+=5;for(r=Math.log(He(2,c))/Math.LN10*2+5|0,u+=r,n=i=s=new f(fe),f.precision=u;;){if(i=H(i.times(t),u),n=n.times(++a),o=s.plus(Me(i,n,u)),ye(o.d).slice(0,u)===ye(s.d).slice(0,u)){for(;c--;)s=H(s.times(s),u);return f.precision=d,e==null?(V=!0,H(s,d)):s}s=o}}function X(t){for(var e=t.e*Y,n=t.d[0];n>=10;n/=10)e++;return e}function Zt(t,e,n){if(e>t.LN10.sd())throw V=!0,n&&(t.precision=n),Error(ge+"LN10 precision limit exceeded");return H(new t(t.LN10),e)}function Pe(t){for(var e="";t--;)e+="0";return e}function ht(t,e){var n,r,i,s,o,u,a,c,f,d=1,y=10,m=t,R=m.d,E=m.constructor,l=E.precision;if(m.s<1)throw Error(ge+(m.s?"NaN":"-Infinity"));if(m.eq(fe))return new E(0);if(e==null?(V=!1,c=l):c=e,m.eq(10))return e==null&&(V=!0),Zt(E,c);if(c+=y,E.precision=c,n=ye(R),r=n.charAt(0),s=X(m),Math.abs(s)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)m=m.times(t),n=ye(m.d),r=n.charAt(0),d++;s=X(m),r>1?(m=new E("0."+n),s++):m=new E(r+"."+n.slice(1))}else return a=Zt(E,c+2,l).times(s+""),m=ht(new E(r+"."+n.slice(1)),c-y).plus(a),E.precision=l,e==null?(V=!0,H(m,l)):m;for(u=o=m=Me(m.minus(fe),m.plus(fe),c),f=H(m.times(m),c),i=3;;){if(o=H(o.times(f),c),a=u.plus(Me(o,new E(i),c)),ye(a.d).slice(0,c)===ye(u.d).slice(0,c))return u=u.times(2),s!==0&&(u=u.plus(Zt(E,c+2,l).times(s+""))),u=Me(u,new E(d),c),E.precision=l,e==null?(V=!0,H(u,l)):u;u=a,i+=2}}function Fn(t,e){var n,r,i;for((n=e.indexOf("."))>-1&&(e=e.replace(".","")),(r=e.search(/e/i))>0?(n<0&&(n=r),n+=+e.slice(r+1),e=e.substring(0,r)):n<0&&(n=e.length),r=0;e.charCodeAt(r)===48;)++r;for(i=e.length;e.charCodeAt(i-1)===48;)--i;if(e=e.slice(r,i),e){if(i-=r,n=n-r-1,t.e=nt(n/Y),t.d=[],r=(n+1)%Y,n<0&&(r+=Y),r<i){for(r&&t.d.push(+e.slice(0,r)),i-=Y;r<i;)t.d.push(+e.slice(r,r+=Y));e=e.slice(r),r=Y-e.length}else r-=i;for(;r--;)e+="0";if(t.d.push(+e),V&&(t.e>It||t.e<-It))throw Error(En+n)}else t.s=0,t.e=0,t.d=[0];return t}function H(t,e,n){var r,i,s,o,u,a,c,f,d=t.d;for(o=1,s=d[0];s>=10;s/=10)o++;if(r=e-o,r<0)r+=Y,i=e,c=d[f=0];else{if(f=Math.ceil((r+1)/Y),s=d.length,f>=s)return t;for(c=s=d[f],o=1;s>=10;s/=10)o++;r%=Y,i=r-Y+o}if(n!==void 0&&(s=He(10,o-i-1),u=c/s%10|0,a=e<0||d[f+1]!==void 0||c%s,a=n<4?(u||a)&&(n==0||n==(t.s<0?3:2)):u>5||u==5&&(n==4||a||n==6&&(r>0?i>0?c/He(10,o-i):0:d[f-1])%10&1||n==(t.s<0?8:7))),e<1||!d[0])return a?(s=X(t),d.length=1,e=e-s-1,d[0]=He(10,(Y-e%Y)%Y),t.e=nt(-e/Y)||0):(d.length=1,d[0]=t.e=t.s=0),t;if(r==0?(d.length=f,s=1,f--):(d.length=f+1,s=He(10,Y-r),d[f]=i>0?(c/He(10,o-i)%He(10,i)|0)*s:0),a)for(;;)if(f==0){(d[0]+=s)==ne&&(d[0]=1,++t.e);break}else{if(d[f]+=s,d[f]!=ne)break;d[f--]=0,s=1}for(r=d.length;d[--r]===0;)d.pop();if(V&&(t.e>It||t.e<-It))throw Error(En+X(t));return t}function cr(t,e){var n,r,i,s,o,u,a,c,f,d,y=t.constructor,m=y.precision;if(!t.s||!e.s)return e.s?e.s=-e.s:e=new y(t),V?H(e,m):e;if(a=t.d,d=e.d,r=e.e,c=t.e,a=a.slice(),o=c-r,o){for(f=o<0,f?(n=a,o=-o,u=d.length):(n=d,r=c,u=a.length),i=Math.max(Math.ceil(m/Y),u)+2,o>i&&(o=i,n.length=1),n.reverse(),i=o;i--;)n.push(0);n.reverse()}else{for(i=a.length,u=d.length,f=i<u,f&&(u=i),i=0;i<u;i++)if(a[i]!=d[i]){f=a[i]<d[i];break}o=0}for(f&&(n=a,a=d,d=n,e.s=-e.s),u=a.length,i=d.length-u;i>0;--i)a[u++]=0;for(i=d.length;i>o;){if(a[--i]<d[i]){for(s=i;s&&a[--s]===0;)a[s]=ne-1;--a[s],a[i]+=ne}a[i]-=d[i]}for(;a[--u]===0;)a.pop();for(;a[0]===0;a.shift())--r;return a[0]?(e.d=a,e.e=r,V?H(e,m):e):new y(0)}function We(t,e,n){var r,i=X(t),s=ye(t.d),o=s.length;return e?(n&&(r=n-o)>0?s=s.charAt(0)+"."+s.slice(1)+Pe(r):o>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(i<0?"e":"e+")+i):i<0?(s="0."+Pe(-i-1)+s,n&&(r=n-o)>0&&(s+=Pe(r))):i>=o?(s+=Pe(i+1-o),n&&(r=n-i-1)>0&&(s=s+"."+Pe(r))):((r=i+1)<o&&(s=s.slice(0,r)+"."+s.slice(r)),n&&(r=n-o)>0&&(i+1===o&&(s+="."),s+=Pe(r))),t.s<0?"-"+s:s}function Un(t,e){if(t.length>e)return t.length=e,!0}function fr(t){var e,n,r;function i(s){var o=this;if(!(o instanceof i))return new i(s);if(o.constructor=i,s instanceof i){o.s=s.s,o.e=s.e,o.d=(s=s.d)?s.slice():s;return}if(typeof s=="number"){if(s*0!==0)throw Error(Ge+s);if(s>0)o.s=1;else if(s<0)s=-s,o.s=-1;else{o.s=0,o.e=0,o.d=[0];return}if(s===~~s&&s<1e7){o.e=0,o.d=[s];return}return Fn(o,s.toString())}else if(typeof s!="string")throw Error(Ge+s);if(s.charCodeAt(0)===45?(s=s.slice(1),o.s=-1):o.s=1,bi.test(s))Fn(o,s);else throw Error(Ge+s)}if(i.prototype=b,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.clone=fr,i.config=i.set=Di,t===void 0&&(t={}),t)for(r=["precision","rounding","toExpNeg","toExpPos","LN10"],e=0;e<r.length;)t.hasOwnProperty(n=r[e++])||(t[n]=this[n]);return i.config(t),i}function Di(t){if(!t||typeof t!="object")throw Error(ge+"Object expected");var e,n,r,i=["precision",1,tt,"rounding",0,8,"toExpNeg",-1/0,0,"toExpPos",0,1/0];for(e=0;e<i.length;e+=3)if((r=t[n=i[e]])!==void 0)if(nt(r)===r&&r>=i[e+1]&&r<=i[e+2])this[n]=r;else throw Error(Ge+n+": "+r);if((r=t[n="LN10"])!==void 0)if(r==Math.LN10)this[n]=new this(r);else throw Error(Ge+n+": "+r);return this}var vn=fr(Ni);fe=new vn(1);const Ne=vn,Z={of(t){return new Ne(t)},sum(...t){let e=new Ne(0);for(const n of t)e=e.plus(n);return e},toFormat(t,e,n,r){const i=t.toFixed(e,n);if(r==null)return i;const s=r.groupSize??3,o=r.groupSeparator??",",[u,a]=i.split("."),c=[];for(let f=u.length;f>0;f-=s)c.unshift(u.slice(Math.max(0,f-s),f));return c.join(o)+(a?`.${a}`:"")},round(t,e,n){return Z.of(t).toDecimalPlaces(e,n).toNumber()}};function _i(t){switch(t){case B.Equal:return"==";case B.NotEqual:return"!=";case B.Lte:return"<=";case B.Gte:return">=";case B.LogicalAnd:return"&&";case B.LogicalOr:return"||";case B.Power:return"**";case B.Nullish:return"??";case B.Group:return"()";default:return String.fromCharCode(t)}}function pe(t){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(t)}function at(t){return t==null}const rt=new Map;function Ti(t,e){const n=rt.get(t);if(n==null)throw new Error(`不支持的函数：${t}`);return n(...e)}function hr(){return new Error("Unexpected end of input")}function te(t){return new Error(`Unexpected end of input at position ${t.start}, near \`${_i(t.value)}\``)}function Ai(t,e,n){switch(t.value){case B.Plus:{if(t.left==null||t.right==null)throw te(t);return typeof e=="string"||typeof n=="string"?e+n:pe(e)&&pe(n)?Z.of(e).plus(n).toNumber():Number.NaN}case B.Minus:{if(t.left==null&&t.right==null)throw te(t);return t.left==null&&t.right?-n:pe(e)&&pe(n)?Z.of(e).minus(n).toNumber():Number.NaN}case B.Asterisk:{if(t.left==null||t.right==null)throw te(t);return pe(e)&&pe(n)?Z.of(e).times(n).toNumber():Number.NaN}case B.Slash:{if(t.left==null||t.right==null)throw te(t);return pe(e)&&pe(n)?Z.of(e).div(n).toNumber():Number.NaN}case B.Percent:{if(t.left==null||t.right==null)throw te(t);return pe(e)&&pe(n)?Z.of(e).mod(n).toNumber():Number.NaN}case B.Power:{if(t.left==null||t.right==null)throw te(t);return pe(e)&&pe(n)?Z.of(e).pow(n).toNumber():Number.NaN}case B.Equal:{if(t.left==null||t.right==null)throw te(t);return at(e)&&at(n)?!0:e===n}case B.NotEqual:{if(t.left==null||t.right==null)throw te(t);return at(e)&&at(n)?!1:e!==n}case B.Lt:{if(t.left==null||t.right==null)throw te(t);return e<n}case B.Lte:{if(t.left==null||t.right==null)throw te(t);return e<=n}case B.Gt:{if(t.left==null||t.right==null)throw te(t);return e>n}case B.Gte:{if(t.left==null||t.right==null)throw te(t);return e>=n}case B.LogicalAnd:{if(t.left==null||t.right==null)throw te(t);return e&&n}case B.LogicalOr:{if(t.left==null||t.right==null)throw te(t);return e||n}case B.LogicalNot:{if(t.right==null)throw te(t);return!n}case B.Nullish:{if(t.left==null||t.right==null)throw te(t);return at(e)?n:e}default:throw te(t)}}function Si(t,e){const r=(t.children??[]).map(i=>{if(i!=null)return Oe(i,e)});return Ti(t.value,r)}function Ri(t,e){var n;return e==null||typeof e!="object"?null:(n=e.data)==null?void 0:n[t.value]}function Oi(t,e){var n;return e==null||typeof e!="object"?null:(n=e.scope)==null?void 0:n[t.value]}function Mi(t,e){if(t.left==null||t.right==null||t.condition==null)throw hr();return Oe(t.condition,e)?(t.result=Oe(t.left,e),t.result):(t.result=Oe(t.right,e),t.result)}function Oe(t,e){switch(t.type){case ve.NULL:return null;case ve.UNDEFINED:return;case ve.NUMBER:return Number(t.value);case ve.STRING:return String(t.value);case ve.TEMPLATE:{const r=(Array.isArray(t.value)?t.value:[t.value]).map(i=>Oe(i,e));return t.result=r.join(""),t.result}case ve.BOOLEAN:return!!t.value;case ve.VARIABLE:return t.result=Ri(t,e),t.result;case ve.REFERENCE:return t.result=Oi(t,e),t.result;case ve.FUNCTION:return t.result=Si(t,e),t.result;case ve.OPERATOR:{if(t.isQuestion)return Mi(t,e);if(t.isGroup){if(t.right==null)throw te(t);return t.result=Oe(t.right,e),t.result}const n=t.left?Oe(t.left,e):null,r=t.right?Oe(t.right,e):null;return t.result=Ai(t,n,r),t.result}default:throw hr()}}function Li(t,e){return Oe(t,e??{})}const dr="Resolve Element Value Pending Error",pr="ElementValueError";function q(t){const e=Object.create(null);return e.state=le.DONE,e.raw=t,e}function Xe(){const t=Object.create(null);return t.state=le.PENDING,t}function Ft(){const t=new Error(dr);return t.name=pr,t}function Ii(t){return t instanceof Error&&t.name===pr&&t.message===dr}function Ci(t,e){var r;const n=typeof e=="string"?mn(e)?Qe(e):null:e;if(n==null)return q();switch(n.value){case vt.CURRENT_DATE:return q(Date.now());case vt.PAGE_NUMBER:{const i=t.doc;return i==null?q():i.isPaged?q(t.pageNum):Xe()}case vt.PAGE_TOTAL:{const i=t.doc;return i==null?q():i.isPaged?q((r=t.page)==null?void 0:r.pageTotal):Xe()}case vt.ROW_INDEX:{const i=t.doc;if(i==null)return q();if(i.isPaged){if(t.type!==se.TABLE_CELL)return q();const s=t.parent;return s==null?q():q(s.rowIndex)}return Xe()}default:return q()}}function Pi(t,e){const n=typeof e=="string"?mn(e)?Qe(e):null:e;if(n==null)return q();switch(n.value){case Pr.ELEMENT_VALUR:return t.isProcessValueDone?q(t.getRawValue()):Xe();default:return q()}}function xi(t,e,n){const r=typeof e=="string"?Qe(e):e,i=t.parent;if(i==null||!i.isBindVariable)return q(ct(n,r.value));const s=Qe(i.define.ds.value);return r.path.startsWith(s.path+".")?i.rowData==null?q():q(ct(i.rowData,r.value)):q(ct(n,r.value))}async function ki(t,e){const n=t.define;if(n.ds==null)return q();const r=n.ds,i=r.value;return et(i)?q():r.type===wt.TEMPLATE?$i(t,i):r.type===wt.VARIABLE?wn(t,i,e):r.type===wt.FORMULA?mr(t,i,e):r.type===wt.CODE?qi(t,i):q(r.value)}function wn(t,e,n,r=!1){const i=Qe(e);switch(i.varType){case zt.DS:return t.type===se.TABLE_CELL?xi(t,i,n):t.type===se.TABLE_ROW?q(t.rowData):q(ct(n,r?i.path:i.value));case zt.BUILTIN:return Ci(t,i);case zt.SPECIAL:return Pi(t,i);default:return q()}}function $i(t,e){return console.log("TODO: template:"+e),q()}function mr(t,e,n){try{const r=xr.compile(e),i={data:{},scope:{}};for(const o of r.variable){const u=wn(t,o.value,n);if(u.state===le.PENDING)return Xe();Reflect.set(i.data,o.value,u.raw)}for(const o of r.reference)Reflect.set(i.scope,o.value,{value:o.value,element:t});const s=Li(r.root,i);return q(s)}catch(r){return Ii(r)?Xe():(console.log(r),q())}}async function qi(t,e){try{const r=new Function("element",`return (${e})(element)`)(t);if(r instanceof Promise){const i=await r;return q(i)}return q(r)}catch(n){return console.log(n),q()}}function Bn(){const t=document.createElement("span"),e="important";return t.style.visibility="hidden",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.zIndex="-1",t.style.setProperty("line-height","1",e),t.style.setProperty("font-family","宋体",e),t.style.setProperty("padding","0",e),t.textContent="水",t}function Hi(){const t=Bn();t.style.fontSize="6px",document.body.appendChild(t);const e=Bn();e.style.fontSize="12px",document.body.appendChild(e);const n=t.clientHeight<e.clientHeight;return document.body.removeChild(t),document.body.removeChild(e),n}let gr=function(){const t=Hi();return gr=function(){return t},t};const Fi=/Chrome/.test(navigator.userAgent);function yn(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var we={},Yn;function Er(){if(Yn)return we;Yn=1;var t=/^([+-])?0*(\d+)(\.(\d+))?$/,e=/^([+-])?0*(\d+)(\.(\d+))?e(([+-])?(\d+))$/i,n=we.e2ten=function(i){var s=e.exec(i.toString());if(!s)return i;var o=s[2],u=s[4]||"",a=s[5]?+s[5]:0;if(a>0){var c=u.substr(0,a);c=c.length<a?c+new Array(a-c.length+1).join("0"):c,u=u.substr(a),o+=c}else{a=-a;var f=o.length-a;f=f<0?0:f;var d=o.substr(f,a);d=d.length<a?new Array(a-d.length+1).join("0")+d:d,o=o.substring(0,f),u=d+u}return o=o==""?"0":o,(s[1]=="-"?"-":"")+o+(u?"."+u:"")};we.getNumbResult=function(i){var s=t.exec(i.toString());if(!s&&e.test(i.toString())&&(s=t.exec(n(i.toString()))),s)return{int:s[2],decimal:s[4],minus:s[1]=="-",num:s.slice(1,3).join("")}},we.centerArray=function i(s,o){if(s.splice.apply(s,[0,o.length].concat(o.splice(0,o.length))),arguments.length>2){var u=[].slice.call(arguments,2);u.unshift(s),i.apply(null,u)}return s};var r=we.hasAttr=function(i,s){return Object.prototype.hasOwnProperty.call(i,s)};return we.extend=function(i){for(var s,o=arguments[0]||{},u=Array.prototype.slice.call(arguments,1),a=0;a<u.length;a++){var c=u[a];for(s in c)r(c,s)&&(o[s]=c[s])}return o},we.getDigit=function(i){return i>=5?(i-4)*4+4:i},we.unshiftZero=function(i,s){if(s==null&&(s=1),!(s<=0))for(;s--;)i.unshift(0)},we.clearZero=function(i,s,o){if(i==null)return"";var u=~"*.?+$^[](){}|\\/".indexOf(s)?"\\"+s:s,a=new RegExp("^"+u+"+"),c=new RegExp(u+"+$"),f=new RegExp(u+"{2}","g");return i=i.toString(),o=="^"&&(i=i.replace(a,"")),(!o||o=="$")&&(i=i.replace(c,"")),(!o||o=="nto1")&&(i=i.replace(f,s)),i},we}var Xt,Vn;function Ui(){if(Vn)return Xt;Vn=1;var t=Er();function e(i,s){var o=t.getNumbResult(i);if(!o)return i;s=s||{};var u=this.ch,a=this.ch_u,c=this.ch_f||"",f=this.ch_d||".",d=u.charAt(0),y=o.int,m=o.decimal,R=o.minus,E="",l="",h=R?c:"",p=function k(C,z,M){C=t.getNumbResult(C).int;var D="",O=arguments.length>1?arguments[1]:s.tenMin,K=C.length;if(K==1)return u.charAt(+C);if(K<=4)for(var T=0,w=K;w--;){var g=+C.charAt(T);D+=O&&K==2&&T==0&&g==1?"":u.charAt(g),D+=g&&w?a.charAt(w):"",T++}else{for(var _=C.length/4>>0,v=C.length%4;v==0||!a.charAt(3+_);)v+=4,_--;var A=C.substr(0,v),S=C.substr(v);D=k(A,O)+a.charAt(3+_)+(S.charAt(0)=="0"?d:"")+k(S,S.length>4?O:!1)}return D=t.clearZero(D,d),D};if(m){m=t.clearZero(m,"0","$");for(var N=0;N<m.length;N++)l+=u.charAt(+m.charAt(N));l=l?f+l:""}if(E=p(y),s.ww&&a.length>5){var $=a.charAt(4),P=a.charAt(5),x=E.lastIndexOf(P);~x&&(E=E.substring(0,x).replace(new RegExp(P,"g"),$+$)+E.substring(x))}return h+E+l}function n(i,s){i=i.toString();var o=i.split(this.ch_d),u=o[0].replace(this.ch_f,""),a=o[1],c=!!~o[0].indexOf(this.ch_f),f=this.ch_u.charAt(1),d=this.ch_u.charAt(4),y=this.ch_u.charAt(5);u=u.replace(new RegExp(d+"{2}(?!"+d+")","g"),y);for(var m=u.split(""),R=0,E=0,l=[],h=[],p=[],N=0;N<m.length;N++){var $=m[N],P=0,x=0;if(~(P=this.ch.indexOf($)))P>0&&p.unshift(P);else if(~(x=this.ch_u.indexOf($))){var k=t.getDigit(x);R>x?(t.unshiftZero(p,k),t.centerArray(h,p)):x>=E?(N==0&&(p=[1]),t.centerArray(l,h,p),l.length>0&&t.unshiftZero(l,k),E=x):(p.length==0&&f==$&&(p=[1]),t.centerArray(h,p),t.unshiftZero(h,t.getDigit(x)),R=x)}}t.centerArray(l,h,p).reverse(),l.length==0&&l.push(0);var C=0;if(a){l.push("."),C="0.";for(var N=0;N<a.length;N++)C+=this.ch.indexOf(a.charAt(N)),l.push(this.ch.indexOf(a.charAt(N)));C=+C}return c&&l.unshift("-"),s&&s.outputString?l.join(""):parseFloat(l.join(""))}function r(i,s){var o={ww:!0,complete:!1,outSymbol:!0,unOmitYuan:!1,forceZheng:!1},u=t.getNumbResult(i),a=this.ch.charAt(0);if(s=typeof s=="object"?s:{},!u)return i;s=t.extend(o,s);var c=u.int,f=u.decimal||"",d=s.outSymbol?this.m_t:"",y=u.minus?this.ch_f:"",m="";if(s.complete){for(var R=1;R<this.m_u.length;R++)m+=e.call(this,f.charAt(R-1)||"0")+this.m_u.charAt(R);y+=e.call(this,c,s)+this.m_u.charAt(0)}else{var E=s.unOmitYuan||c!=="0";if(f=f.substr(0,this.m_u.length-1),f=t.clearZero(f,"0","$"),f)for(var l,R=0;R<this.m_u.length-1;R++)f.charAt(R)&&f.charAt(R)!="0"&&(m+=e.call(this,f.charAt(R))+this.m_u.charAt(R+1),l=!1),f.charAt(R)==="0"&&!l&&((R!=0||c!=="0")&&(m+=a),l=!0);(E||!m)&&(y+=e.call(this,c,s)+this.m_u.charAt(0)),s.forceZheng?(m==""||m.charAt(m.length-1)!==this.m_u[2])&&(m+=this.m_z):y+=u.decimal?"":this.m_z,s.forceZheng}return d+y+m}return Xt={CL:e,unCL:n,toMoney:r},Xt}var Kt,Gn;function Bi(){if(Gn)return Kt;Gn=1;var t=Ui(),e=Er();function n(r,i){return{encodeS:function(s,o){return o=e.extend({ww:!0,tenMin:!0},o),t.CL.call(r,s,o)},encodeB:function(s,o){return o=e.extend({ww:!0},o),t.CL.call(i,s,o)},decodeS:function(){return t.unCL.apply(r,arguments)},decodeB:function(){return t.unCL.apply(i,arguments)},toMoney:function(s,o){return o=e.extend({ww:!0},o),t.toMoney.call(i,s,o)}}}return Kt=n,Kt}var Jt,zn;function Yi(){return zn||(zn=1,Jt={ch:"零一二三四五六七八九",ch_u:"个十百千万亿",ch_f:"负",ch_d:"点"}),Jt}var Qt,Wn;function Vi(){return Wn||(Wn=1,Qt={ch:"零壹贰叁肆伍陆柒捌玖",ch_u:"个拾佰仟万亿",ch_f:"负",ch_d:"点",m_t:"人民币",m_z:"整",m_u:"元角分"}),Qt}var en,jn;function Gi(){if(jn)return en;jn=1;var t=Bi(),e={s:Yi(),b:Vi()};return en=t(e.s,e.b),en}var zi=Gi();const Wi=yn(zi);var At={exports:{}},ji=At.exports,Zn;function Zi(){return Zn||(Zn=1,function(t,e){(function(n,r){t.exports=r()})(ji,function(){var n=1e3,r=6e4,i=36e5,s="millisecond",o="second",u="minute",a="hour",c="day",f="week",d="month",y="quarter",m="year",R="date",E="Invalid Date",l=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,h=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var w=["th","st","nd","rd"],g=T%100;return"["+T+(w[(g-20)%10]||w[g]||w[0])+"]"}},N=function(T,w,g){var _=String(T);return!_||_.length>=w?T:""+Array(w+1-_.length).join(g)+T},$={s:N,z:function(T){var w=-T.utcOffset(),g=Math.abs(w),_=Math.floor(g/60),v=g%60;return(w<=0?"+":"-")+N(_,2,"0")+":"+N(v,2,"0")},m:function T(w,g){if(w.date()<g.date())return-T(g,w);var _=12*(g.year()-w.year())+(g.month()-w.month()),v=w.clone().add(_,d),A=g-v<0,S=w.clone().add(_+(A?-1:1),d);return+(-(_+(g-v)/(A?v-S:S-v))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:d,y:m,w:f,d:c,D:R,h:a,m:u,s:o,ms:s,Q:y}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},P="en",x={};x[P]=p;var k="$isDayjsObject",C=function(T){return T instanceof O||!(!T||!T[k])},z=function T(w,g,_){var v;if(!w)return P;if(typeof w=="string"){var A=w.toLowerCase();x[A]&&(v=A),g&&(x[A]=g,v=A);var S=w.split("-");if(!v&&S.length>1)return T(S[0])}else{var I=w.name;x[I]=w,v=I}return!_&&v&&(P=v),v||!_&&P},M=function(T,w){if(C(T))return T.clone();var g=typeof w=="object"?w:{};return g.date=T,g.args=arguments,new O(g)},D=$;D.l=z,D.i=C,D.w=function(T,w){return M(T,{locale:w.$L,utc:w.$u,x:w.$x,$offset:w.$offset})};var O=function(){function T(g){this.$L=z(g.locale,null,!0),this.parse(g),this.$x=this.$x||g.x||{},this[k]=!0}var w=T.prototype;return w.parse=function(g){this.$d=function(_){var v=_.date,A=_.utc;if(v===null)return new Date(NaN);if(D.u(v))return new Date;if(v instanceof Date)return new Date(v);if(typeof v=="string"&&!/Z$/i.test(v)){var S=v.match(l);if(S){var I=S[2]-1||0,U=(S[7]||"0").substring(0,3);return A?new Date(Date.UTC(S[1],I,S[3]||1,S[4]||0,S[5]||0,S[6]||0,U)):new Date(S[1],I,S[3]||1,S[4]||0,S[5]||0,S[6]||0,U)}}return new Date(v)}(g),this.init()},w.init=function(){var g=this.$d;this.$y=g.getFullYear(),this.$M=g.getMonth(),this.$D=g.getDate(),this.$W=g.getDay(),this.$H=g.getHours(),this.$m=g.getMinutes(),this.$s=g.getSeconds(),this.$ms=g.getMilliseconds()},w.$utils=function(){return D},w.isValid=function(){return this.$d.toString()!==E},w.isSame=function(g,_){var v=M(g);return this.startOf(_)<=v&&v<=this.endOf(_)},w.isAfter=function(g,_){return M(g)<this.startOf(_)},w.isBefore=function(g,_){return this.endOf(_)<M(g)},w.$g=function(g,_,v){return D.u(g)?this[_]:this.set(v,g)},w.unix=function(){return Math.floor(this.valueOf()/1e3)},w.valueOf=function(){return this.$d.getTime()},w.startOf=function(g,_){var v=this,A=!!D.u(_)||_,S=D.p(g),I=function(Ee,re){var he=D.w(v.$u?Date.UTC(v.$y,re,Ee):new Date(v.$y,re,Ee),v);return A?he:he.endOf(c)},U=function(Ee,re){return D.w(v.toDate()[Ee].apply(v.toDate("s"),(A?[0,0,0,0]:[23,59,59,999]).slice(re)),v)},G=this.$W,ee=this.$M,oe=this.$D,Ie="set"+(this.$u?"UTC":"");switch(S){case m:return A?I(1,0):I(31,11);case d:return A?I(1,ee):I(0,ee+1);case f:var De=this.$locale().weekStart||0,qe=(G<De?G+7:G)-De;return I(A?oe-qe:oe+(6-qe),ee);case c:case R:return U(Ie+"Hours",0);case a:return U(Ie+"Minutes",1);case u:return U(Ie+"Seconds",2);case o:return U(Ie+"Milliseconds",3);default:return this.clone()}},w.endOf=function(g){return this.startOf(g,!1)},w.$set=function(g,_){var v,A=D.p(g),S="set"+(this.$u?"UTC":""),I=(v={},v[c]=S+"Date",v[R]=S+"Date",v[d]=S+"Month",v[m]=S+"FullYear",v[a]=S+"Hours",v[u]=S+"Minutes",v[o]=S+"Seconds",v[s]=S+"Milliseconds",v)[A],U=A===c?this.$D+(_-this.$W):_;if(A===d||A===m){var G=this.clone().set(R,1);G.$d[I](U),G.init(),this.$d=G.set(R,Math.min(this.$D,G.daysInMonth())).$d}else I&&this.$d[I](U);return this.init(),this},w.set=function(g,_){return this.clone().$set(g,_)},w.get=function(g){return this[D.p(g)]()},w.add=function(g,_){var v,A=this;g=Number(g);var S=D.p(_),I=function(ee){var oe=M(A);return D.w(oe.date(oe.date()+Math.round(ee*g)),A)};if(S===d)return this.set(d,this.$M+g);if(S===m)return this.set(m,this.$y+g);if(S===c)return I(1);if(S===f)return I(7);var U=(v={},v[u]=r,v[a]=i,v[o]=n,v)[S]||1,G=this.$d.getTime()+g*U;return D.w(G,this)},w.subtract=function(g,_){return this.add(-1*g,_)},w.format=function(g){var _=this,v=this.$locale();if(!this.isValid())return v.invalidDate||E;var A=g||"YYYY-MM-DDTHH:mm:ssZ",S=D.z(this),I=this.$H,U=this.$m,G=this.$M,ee=v.weekdays,oe=v.months,Ie=v.meridiem,De=function(re,he,_e,Ce){return re&&(re[he]||re(_,A))||_e[he].slice(0,Ce)},qe=function(re){return D.s(I%12||12,re,"0")},Ee=Ie||function(re,he,_e){var Ce=re<12?"AM":"PM";return _e?Ce.toLowerCase():Ce};return A.replace(h,function(re,he){return he||function(_e){switch(_e){case"YY":return String(_.$y).slice(-2);case"YYYY":return D.s(_.$y,4,"0");case"M":return G+1;case"MM":return D.s(G+1,2,"0");case"MMM":return De(v.monthsShort,G,oe,3);case"MMMM":return De(oe,G);case"D":return _.$D;case"DD":return D.s(_.$D,2,"0");case"d":return String(_.$W);case"dd":return De(v.weekdaysMin,_.$W,ee,2);case"ddd":return De(v.weekdaysShort,_.$W,ee,3);case"dddd":return ee[_.$W];case"H":return String(I);case"HH":return D.s(I,2,"0");case"h":return qe(1);case"hh":return qe(2);case"a":return Ee(I,U,!0);case"A":return Ee(I,U,!1);case"m":return String(U);case"mm":return D.s(U,2,"0");case"s":return String(_.$s);case"ss":return D.s(_.$s,2,"0");case"SSS":return D.s(_.$ms,3,"0");case"Z":return S}return null}(re)||S.replace(":","")})},w.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},w.diff=function(g,_,v){var A,S=this,I=D.p(_),U=M(g),G=(U.utcOffset()-this.utcOffset())*r,ee=this-U,oe=function(){return D.m(S,U)};switch(I){case m:A=oe()/12;break;case d:A=oe();break;case y:A=oe()/3;break;case f:A=(ee-G)/6048e5;break;case c:A=(ee-G)/864e5;break;case a:A=ee/i;break;case u:A=ee/r;break;case o:A=ee/n;break;default:A=ee}return v?A:D.a(A)},w.daysInMonth=function(){return this.endOf(d).$D},w.$locale=function(){return x[this.$L]},w.locale=function(g,_){if(!g)return this.$L;var v=this.clone(),A=z(g,_,!0);return A&&(v.$L=A),v},w.clone=function(){return D.w(this.$d,this)},w.toDate=function(){return new Date(this.valueOf())},w.toJSON=function(){return this.isValid()?this.toISOString():null},w.toISOString=function(){return this.$d.toISOString()},w.toString=function(){return this.$d.toUTCString()},T}(),K=O.prototype;return M.prototype=K,[["$ms",s],["$s",o],["$m",u],["$H",a],["$W",c],["$M",d],["$y",m],["$D",R]].forEach(function(T){K[T[1]]=function(w){return this.$g(w,T[0],T[1])}}),M.extend=function(T,w){return T.$i||(T(w,O,M),T.$i=!0),M},M.locale=z,M.isDayjs=C,M.unix=function(T){return M(1e3*T)},M.en=x[P],M.Ls=x,M.p={},M})}(At)),At.exports}var Xi=Zi();const Le=yn(Xi);var St={exports:{}},Ki=St.exports,Xn;function Ji(){return Xn||(Xn=1,function(t,e){(function(n,r){t.exports=r()})(Ki,function(){var n={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},r=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|Q|YYYY|YY?|ww?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,i=/\d/,s=/\d\d/,o=/\d\d?/,u=/\d*[^-_:/,()\s\d]+/,a={},c=function(l){return(l=+l)+(l>68?1900:2e3)},f=function(l){return function(h){this[l]=+h}},d=[/[+-]\d\d:?(\d\d)?|Z/,function(l){(this.zone||(this.zone={})).offset=function(h){if(!h||h==="Z")return 0;var p=h.match(/([+-]|\d\d)/g),N=60*p[1]+(+p[2]||0);return N===0?0:p[0]==="+"?-N:N}(l)}],y=function(l){var h=a[l];return h&&(h.indexOf?h:h.s.concat(h.f))},m=function(l,h){var p,N=a.meridiem;if(N){for(var $=1;$<=24;$+=1)if(l.indexOf(N($,0,h))>-1){p=$>12;break}}else p=l===(h?"pm":"PM");return p},R={A:[u,function(l){this.afternoon=m(l,!1)}],a:[u,function(l){this.afternoon=m(l,!0)}],Q:[i,function(l){this.month=3*(l-1)+1}],S:[i,function(l){this.milliseconds=100*+l}],SS:[s,function(l){this.milliseconds=10*+l}],SSS:[/\d{3}/,function(l){this.milliseconds=+l}],s:[o,f("seconds")],ss:[o,f("seconds")],m:[o,f("minutes")],mm:[o,f("minutes")],H:[o,f("hours")],h:[o,f("hours")],HH:[o,f("hours")],hh:[o,f("hours")],D:[o,f("day")],DD:[s,f("day")],Do:[u,function(l){var h=a.ordinal,p=l.match(/\d+/);if(this.day=p[0],h)for(var N=1;N<=31;N+=1)h(N).replace(/\[|\]/g,"")===l&&(this.day=N)}],w:[o,f("week")],ww:[s,f("week")],M:[o,f("month")],MM:[s,f("month")],MMM:[u,function(l){var h=y("months"),p=(y("monthsShort")||h.map(function(N){return N.slice(0,3)})).indexOf(l)+1;if(p<1)throw new Error;this.month=p%12||p}],MMMM:[u,function(l){var h=y("months").indexOf(l)+1;if(h<1)throw new Error;this.month=h%12||h}],Y:[/[+-]?\d+/,f("year")],YY:[s,function(l){this.year=c(l)}],YYYY:[/\d{4}/,f("year")],Z:d,ZZ:d};function E(l){var h,p;h=l,p=a&&a.formats;for(var N=(l=h.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(M,D,O){var K=O&&O.toUpperCase();return D||p[O]||n[O]||p[K].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(T,w,g){return w||g.slice(1)})})).match(r),$=N.length,P=0;P<$;P+=1){var x=N[P],k=R[x],C=k&&k[0],z=k&&k[1];N[P]=z?{regex:C,parser:z}:x.replace(/^\[|\]$/g,"")}return function(M){for(var D={},O=0,K=0;O<$;O+=1){var T=N[O];if(typeof T=="string")K+=T.length;else{var w=T.regex,g=T.parser,_=M.slice(K),v=w.exec(_)[0];g.call(D,v),M=M.replace(v,"")}}return function(A){var S=A.afternoon;if(S!==void 0){var I=A.hours;S?I<12&&(A.hours+=12):I===12&&(A.hours=0),delete A.afternoon}}(D),D}}return function(l,h,p){p.p.customParseFormat=!0,l&&l.parseTwoDigitYear&&(c=l.parseTwoDigitYear);var N=h.prototype,$=N.parse;N.parse=function(P){var x=P.date,k=P.utc,C=P.args;this.$u=k;var z=C[1];if(typeof z=="string"){var M=C[2]===!0,D=C[3]===!0,O=M||D,K=C[2];D&&(K=C[2]),a=this.$locale(),!M&&K&&(a=p.Ls[K]),this.$d=function(_,v,A,S){try{if(["x","X"].indexOf(v)>-1)return new Date((v==="X"?1e3:1)*_);var I=E(v)(_),U=I.year,G=I.month,ee=I.day,oe=I.hours,Ie=I.minutes,De=I.seconds,qe=I.milliseconds,Ee=I.zone,re=I.week,he=new Date,_e=ee||(U||G?1:he.getDate()),Ce=U||he.getFullYear(),gt=0;U&&!G||(gt=G>0?G-1:he.getMonth());var Et,Ut=oe||0,Bt=Ie||0,Yt=De||0,Vt=qe||0;return Ee?new Date(Date.UTC(Ce,gt,_e,Ut,Bt,Yt,Vt+60*Ee.offset*1e3)):A?new Date(Date.UTC(Ce,gt,_e,Ut,Bt,Yt,Vt)):(Et=new Date(Ce,gt,_e,Ut,Bt,Yt,Vt),re&&(Et=S(Et).week(re).toDate()),Et)}catch{return new Date("")}}(x,z,k,p),this.init(),K&&K!==!0&&(this.$L=this.locale(K).$L),O&&x!=this.format(z)&&(this.$d=new Date("")),a={}}else if(z instanceof Array)for(var T=z.length,w=1;w<=T;w+=1){C[1]=z[w-1];var g=p.apply(this,C);if(g.isValid()){this.$d=g.$d,this.$L=g.$L,this.init();break}w===T&&(this.$d=new Date(""))}else $.call(this,P)}}})}(St)),St.exports}var Qi=Ji();const es=yn(Qi);Le.extend(es);function ts(t){switch(t){case Wt.FLOOR:return Ne.ROUND_FLOOR;case Wt.CEIL:return Ne.ROUND_CEIL;case Wt.BANKER_ROUND:return Ne.ROUND_HALF_EVEN;default:return Ne.ROUND_HALF_UP}}function ns(t,e){if(t==null)return"";const n=e.format,r=ts(e.round),i=e.showZero===!1;switch(n){case ot.FIXED:{const s=e.precision;if(s==null||s<0)return t.toString();const o=typeof t=="number"?Z.of(t):t;return o.eq(0)&&i?"":o.toFixed(s,r)}case ot.THOUSAND:{const s=typeof t=="number"?Z.of(t):t;return s.eq(0)&&i?"":Z.toFormat(s,2,r,{groupSize:3})}case ot.TEN_THOUSAND:{const s=typeof t=="number"?Z.of(t):t;return s.eq(0)&&i?"":Z.toFormat(s,2,r,{groupSize:4})}case ot.DAXIE:{const s=typeof t=="number"?Z.of(t):t;return s.eq(0)&&i?"":Wi.toMoney(s.toFixed(2,r),{outSymbol:!1})}case ot.PERCENTAGE:{const s=typeof t=="number"?Z.of(t):t;if(s.eq(0)&&i)return"";const o=e.precision??2;return s.times(100).toFixed(o,Ne.ROUND_HALF_UP)+"%"}default:return typeof t=="number"?t==0&&i?"":t.toString():t.eq(0)&&i?"":t.toString()}}function rs(t,e){const n=e.format;return n==null?t:Le(t).format(n)}function is(t,e){const n=t.attributes;switch(t.display){case se.NUMBER:return ns(e,n);case se.DATE:return rs(e,n);default:return e}}const Kn=Object.create(null);var $t,Ke;const ft=class ft{constructor(e){de(this,$t,dn(pn.PRINT_ELEMENT));de(this,Ke,Object.create(null));L(this,"define");L(this,"children",[]);L(this,"atomized",!1);L(this,"extra",!1);L(this,"parent");L(this,"offsetTop",0);L(this,"offsetLeft",0);L(this,"offsetWidth",0);L(this,"offsetHeight",0);L(this,"element");L(this,"zIndex");L(this,"state",un.CREATED);L(this,"visibility",Ae.PENDING);L(this,"value",{state:le.UNDEFINED});this.define=e,this.offsetTop=e.offsetTop,this.offsetLeft=e.offsetLeft,this.offsetWidth=e.offsetWidth,this.offsetHeight=e.offsetHeight,this.zIndex=e.zIndex,Ye(this,"parent",null),Ye(this,"element",null)}static register(e,n){Kn[e]=n}static create(e){const n=Kn[e.type]??ft;return new n(e)}static isPrintElement(e){return e instanceof ft}get id(){return"@"+F(this,$t)}get type(){return this.define.type}get page(){let e=this.parent;for(;e;){if(e instanceof Lt)return e;e=e.parent}return null}get doc(){var e;return(e=this.page)==null?void 0:e.parent}get isChanged(){return this.offsetTop!=this.define.offsetTop||this.offsetHeight!=this.define.offsetHeight}get offsetBottom(){var r,i;const e=((r=this.element)==null?void 0:r.offsetTop)??0,n=((i=this.element)==null?void 0:i.offsetHeight)??0;return e+n}get pageNum(){var e;return((e=this.page)==null?void 0:e.pageNum)??-1}get isBindVariable(){return this.define.isBindVariable}get content(){const e=this.format()??"",n=this.define.attributes.prefix??"",r=this.define.attributes.suffix??"";return`${n}${e}${r}`}get isOverflowAuto(){return this.define.attributes.overflow===Dt.AUTO}get isOverflowScale(){return this.define.attributes.overflow===Dt.SCALE}get isOverflowHidden(){const e=this.define.attributes.overflow;return e==null||e===Dt.HIDDEN}get isProcessValueDone(){return this.value.state===le.DONE}get isUndefinedValue(){return this.value.state===le.UNDEFINED}get isHidden(){return this.visibility===Ae.HIDDEN}async processValue(){var e,n,r;if(!this.isProcessValueDone)switch(this.value=await ki(this,(e=this.doc)==null?void 0:e.data),this.value.state){case le.DONE:(n=this.doc)==null||n.removeDependency(this);break;case le.PENDING:(r=this.doc)==null||r.addDependency(this,{state:le.PENDING});break}}getRawValue(){if(this.value.state===le.DONE)return this.value.raw}format(){return is(this.define,this.getRawValue())}async onCreated(){await Promise.allSettled(this.children.map(e=>e.onCreated())),await this.processValue(),this.visibility=this.checkVisibility()}__createElement__(){return typeof this.render=="function"?this.render():null}createElement(){return this.element?this.element:(this.element=this.__createElement__(),this.element)}createContent(){const e=this.content;return kr(e)?null:Q("div",{class:"quickprint-content",children:Q("span",{children:this.content})})}async updateElement(){const e=this.parent;if(e==null)return!1;await this.processValue(),this.visibility=this.checkVisibility();const n=this.__createElement__();return await e.replaceChild(this,n)}async mountChild(e){var n;return this.element==null||e.element==null?!1:(this.element.appendChild(e.element),await ze(),await e.mount(e.element),this.offsetHeight=((n=this.element)==null?void 0:n.offsetHeight)??0,!0)}async replaceChild(e,n){var r;return this.element==null||e.element==null?!1:(n==null?this.element.removeChild(e.element):this.element.replaceChild(n,e.element),await ze(),await e.mount(n),this.offsetHeight=((r=this.element)==null?void 0:r.offsetHeight)??0,!0)}async mount(e){e!=null&&(this.checkOverflow()&&await this.processOverflow(),this.offsetWidth=e.offsetWidth,this.offsetHeight=e.offsetHeight,this.state=un.MOUNDTED,this.element=e)}setParent(e){this.parent=e}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}append(e){e.setParent(this),this.children.push(e),F(this,Ke)[e.id]=e}clone(){const e=ft.create(this.define),n=this.children.map(r=>r.clone());return e.appendMany(n),e}checkOverflow(){if(this.element==null)return!1;const e=this.element.querySelector(".quickprint-content");if(e==null)return!1;const n=e.parentElement;return n==null?!1:n.offsetHeight<e.offsetHeight}processOverflow(){return this.isOverflowScale?gr()?this.processOverflowScaleByFont():this.processOverflowScaleByTransform():this.isOverflowHidden?this.processOverflowHidden():Promise.resolve()}processOverflowHidden(){var n;const e=(n=this.element)==null?void 0:n.querySelector(".quickprint-layout");return e==null||(e.style.alignItems="flex-start"),Promise.resolve()}async processOverflowScaleByFont(){console.log("scale font")}async processOverflowScaleByTransform(){console.log("scale transform")}findElement(e){const n=F(this,Ke)[e];if(n)return n;for(const r of this.children){const i=r.findElement(e);if(i)return i}}findElementFromDefine(e){return this.children.find(n=>n.define.id===e)}createElements(){it(this,Ke,this.children.reduce((e,n)=>(e[n.id]=n,e),Object.create(null)))}checkVisibility(){var i,s,o;const e=this.define;if(e.visibility==null||e.visibility.type===Ln.VISIBLE)return Ae.VISIBLE;if(e.visibility.type===Ln.HIDDEN)return Ae.HIDDEN;const n=e.visibility.condition;if(et(n))return Ae.VISIBLE;const r=mr(this,n,(i=this.doc)==null?void 0:i.data);switch(r.state){case le.DONE:return(s=this.doc)==null||s.removeDependency(this),r.raw?Ae.VISIBLE:Ae.HIDDEN;case le.PENDING:return(o=this.doc)==null||o.addDependency(this,{state:le.PENDING}),Ae.PENDING;default:return Ae.PENDING}}};$t=new WeakMap,Ke=new WeakMap;let W=ft;function yt(t,e){return e.exclude==null?!0:!e.exclude.includes(t)}function mt(t){var s;const e={};if(!Fi)return e;const n=t.define,r=n.style.fontFamily;return(r==null||r===rn.SONG)&&((s=n.style)==null?void 0:s.fontWeight)===700&&(e["quickprint-patch-song-blod"]=!0),e}function vr(t,e){const n=[];if(e&&e!=rn.DEFAULT&&n.push(`"${e}"`),t&&t!==rn.DEFAULT&&n.push(`"${t}"`),n.length!=0)return n.join(",")}function ss(t){if(t.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:t.underlineStyle,textDecorationColor:t.underlineColor}}function os(t){if(t==null)return{};const e=t.style??{},n={};return e.textAlign&&(n.textAlign=e.textAlign),e.textAlignLast&&(n.textAlignLast=e.textAlignLast),n}function us(t){if(t==null)return{};const e=t.style??{};return e.verticalAlign==In.MIDDLE||e.verticalAlign==null?{display:"flex",alignItems:"center"}:e.verticalAlign==In.BOTTOM?{display:"flex",alignItems:"end"}:{}}function as(t){if(t==null)return{};const e=t.style??{};if(e.padding==null)return{};const n={};return e.padding.top&&(n.paddingTop=e.padding.top),e.padding.right&&(n.paddingRight=e.padding.right),e.padding.bottom&&(n.paddingBottom=e.padding.bottom),e.padding.left&&(n.paddingLeft=e.padding.left),n}function cn(t){if(t==null)return{};const e=t.style??{};if(e.border==null||e.border===Te.NONE)return{};const n={},r=e.borderWidth??1,i=e.borderStyle??$r.SOLID,s=e.borderColor??qr.BLACK;if(e.border==Te.ALL||e.border&Te.TOP){const o=e.borderTopWidth??r,u=e.borderTopStyle??i,a=e.borderTopColor??s;n.borderTop=`${o}px ${u} ${a}`}if(e.border==Te.ALL||e.border&Te.RIGHT){const o=e.borderRightWidth??r,u=e.borderRightStyle??i,a=e.borderRightColor??s;n.borderRight=`${o}px ${u} ${a}`}if(e.border==Te.ALL||e.border&Te.BOTTOM){const o=e.borderBottomWidth??r,u=e.borderBottomStyle??i,a=e.borderBottomColor??s;n.borderBottom=`${o}px ${u} ${a}`}if(e.border==Te.ALL||e.border&Te.LEFT){const o=e.borderLeftWidth??r,u=e.borderLeftStyle??i,a=e.borderLeftColor??s;n.borderLeft=`${o}px ${u} ${a}`}return n}function Nn(t,e={}){const n={},r=t.define.style??{},i=vr(r.fontFamily,r.enFontFamily);i&&(n.fontFamily=i);const s=ss(r);return s&&lt(n,s),r.fontSize&&(n.fontSize=r.fontSize),r.fontWeight&&(n.fontWeight=r.fontWeight),r.color&&(n.color=r.color),r.lineHeight&&(n.lineHeight=r.lineHeight),r.highlightColor&&(n["--quickprint-variable-highlight-color"]=r.highlightColor),r.backgroundColor&&(n.backgroundColor=r.backgroundColor),r.fontStyle&&(n.fontStyle=r.fontStyle),r.rotate&&(n.transform=`rotate(${r.rotate}deg)`),r.textIndent&&(n.textIndent=r.textIndent),r.padding&&lt(n,as(t.define)),lt(n,os(t.define)),lt(n,us(t.define)),n}function bn(t,e={}){const n={};if(yt("top",e)&&(n.top=t.offsetTop+"px"),yt("left",e)&&(n.left=t.offsetLeft+"px"),yt("width",e)&&(n.width=t.offsetWidth+"px"),yt("height",e)){const r=t.define.attributes.overflow===Dt.AUTO?"min-height":"height";n[r]=t.offsetHeight+"px"}return t.zIndex&&(n.zIndex=t.zIndex),n}function Dn(t,e={}){return gn(bn(t,e),Nn(t,e),cn(t.define))}class ls extends W{get style(){return Dn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class cs extends W{get style(){return bn(this)}get className(){return{"quickprint-element":!0,"quickprint-text":!0,"quickprint-layout":!0,...mt(this)}}processConstNode(e){var i;const n=e.dataset.value;if(et(n))return;const r=wn(this,n,(i=this.doc)==null?void 0:i.data);e.textContent=r.raw}process(e){for(const n of Array.from(e.childNodes))if(n instanceof HTMLElement&&n.contentEditable==="false"&&n.matches(".is-const-node")){this.processConstNode(n);continue}return e}render(){if(this.isHidden)return null;const e=this.getRawValue(),n=document.createElement("span");return n.className="quickprint-content",n.innerHTML=e,Q("div",{id:this.id,class:this.className,style:this.style,children:this.process(n)})}}class fs extends W{get style(){return Dn(this)}get className(){return{"quickprint-element":!0,"quickprint-number":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class hs extends W{get style(){return Dn(this)}get className(){return{"quickprint-element":!0,"quickprint-date":!0,"quickprint-layout":!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}render(){return this.isHidden?null:Q("div",{id:this.id,class:this.className,style:this.style,children:this.createContent()})}}class wr extends W{constructor(){super(...arguments);L(this,"rendering",0)}get style(){return{...gn(bn(this),Nn(this)),height:void 0}}get className(){return"quickprint-element quickprint-table"}getTableBody(){return this.element==null?null:this.element.querySelector("tbody")}render(){if(this.isHidden)return null;const i=this.define.columns.map(s=>Q("col",{width:s}));return Q("div",{id:this.id,class:this.className,style:this.style,children:Q("table",{children:[Q("colgroup",{children:i}),Q("tbody",{})]})})}async mountChild(n){var i;if(n.element==null)return!1;const r=this.getTableBody();return r==null?!1:(r.appendChild(n.element),await ze(),await n.mount(n.element),this.offsetHeight=((i=this.element)==null?void 0:i.offsetHeight)??0,!0)}async replaceChild(n,r){var s;if(this.element==null||n.element==null)return!1;const i=this.getTableBody();return i==null?!1:(r==null?i.removeChild(n.element):i.replaceChild(r,n.element),await ze(),await n.mount(r),this.offsetHeight=((s=this.element)==null?void 0:s.offsetHeight)??0,!0)}onPaged(){const n=this.children.filter(i=>i.define.isBody),r=this.children.map(i=>(i.define.isBody&&(i.rowIndex=n.findIndex(s=>s.id===i.id)),typeof i.onPaged=="function"?i.onPaged():Promise.resolve()));return Promise.allSettled(r)}splitRows(n){const r=this.children.slice(n+1),i=this.getTableBody();if(this.children.length=n,this.createElements(),i)for(const s of r){if(s.element==null)break;i.removeChild(s.element)}return r}}class ds extends W{constructor(){super(...arguments);L(this,"repeatIndex",-1);L(this,"rowData");L(this,"rowIndex",-1)}get style(){return{}}get className(){return"quickprint-table-row"}get isOverflowAuto(){return this.children.some(n=>n.isOverflowAuto)}get index(){var n;return((n=this.parent)==null?void 0:n.children.findIndex(r=>r.id===this.id))??-1}render(){const n=this.children.map(r=>r.createElement());return Q("tr",{id:this.id,class:this.className,style:this.style,children:n})}async mount(n){if(n!=null){for(const r of this.children)await r.mount(r.element);this.offsetWidth=n.offsetWidth,this.offsetHeight=n.offsetHeight,this.state=un.MOUNDTED}}onPaged(){const n=this.children.map(r=>typeof r.onPaged=="function"?r.onPaged():Promise.resolve());return Promise.allSettled(n)}}class _n extends W{get style(){var r;const e=cn((r=this.define.parent)==null?void 0:r.parent),n=cn(this.define);return{"--quickprint-cell-width":this.offsetWidth+"px","--quickprint-cell-height":this.offsetHeight+"px",...lt(e,n)}}get className(){const e=this.parent;return{"quickprint-table-cell":!0,"quickprint-auto-height":(e==null?void 0:e.isOverflowAuto)===!0,"quickprint-fixed-height":(e==null?void 0:e.isOverflowAuto)!==!0,"quickprint-line-through":this.define.style.lineThrough,...mt(this)}}get isCollapsed(){return this.define.attributes.colspan===0||this.define.attributes.rowspan===0}createContentStyle(){const e=[];let n=this;for(;W.isPrintElement(n);)e.unshift(Nn(n)),n=n.parent;return gn({},...e)}render(){if(this.isCollapsed)return null;const n=this.define.attributes,r=this.isHidden?null:Q("div",{class:"quickprint-layout",style:this.createContentStyle(),children:this.createContent()});return Q("td",{id:this.id,class:this.className,style:this.style,rowspan:n.rowspan,colspan:n.colspan,children:r})}}W.register(se.TEXT,ls);W.register(se.PARAGRAPH,cs);W.register(se.NUMBER,fs);W.register(se.DATE,hs);W.register(se.TABLE,wr);W.register(se.TABLE_ROW,ds);W.register(se.TABLE_CELL,_n);function ps(t){return Number(t)}function ms(t){return Math.abs(t)}function gs(t){return Math.trunc(t)}function Es(...t){return Math.min(...t)}function vs(...t){return Math.max(...t)}function ws(t,e){return Z.round(t,e??0,Ne.ROUND_CEIL)}function ys(t,e){return Z.round(t,e??0,Ne.ROUND_FLOOR)}function Ns(t,e,n){return Z.round(t,e??0,n??Ne.ROUND_HALF_UP)}function bs(t){t.set("NUMBER",ps),t.set("ABS",ms),t.set("TRUNC",gs),t.set("MIN",Es),t.set("MAX",vs),t.set("CEIL",ws),t.set("FLOOR",ys),t.set("ROUND",Ns)}function Ds(t){return String(t)}function _s(t){return String(t).length}function Ts(t){return String(t).toLowerCase()}function As(t){return String(t).toUpperCase()}function Ss(t){const e=String(t);return e[0].toUpperCase()+e.slice(1)}function Rs(t){return String(t).trim()}function Os(t,e,n){return String(t).replace(e,n)}function Ms(t,e,n){return String(t).replaceAll(e,n)}function Ls(t,e,n){return String(t).slice(e,n)}function Is(t,e,n){return String(t).includes(String(e),n)}function Cs(t,e,n){return String(t).indexOf(String(e),n)}function Ps(t,e,n){return String(t).lastIndexOf(String(e),n)}function xs(t,e,n){return String(t).startsWith(String(e),n)}function ks(t,e,n){return String(t).endsWith(String(e),n)}function $s(t){t.set("STRING",Ds),t.set("LENGTH",_s),t.set("LOWER",Ts),t.set("UPPER",As),t.set("TRIM",Rs),t.set("UPPER_FIRST",Ss),t.set("REPLACE",Os),t.set("REPLACE_ALL",Ms),t.set("SLICE",Ls),t.set("INCLUDES",Is),t.set("INDEX_OF",Cs),t.set("LAST_INDEX_OF",Ps),t.set("STARTS_WITH",xs),t.set("ENDS_WITH",ks)}function qs(t,e,n){return t?e:n}function Hs(t,e){return Number.isNaN(t)?e:t}function Fs(t,e){return Number.isNaN(t)||t==null?e:t}function Us(t,...e){for(let r=0;r<e.length;r+=2){const i=e[r],s=e[r+1];if(i===t)return s}return e.length%2===0?void 0:e[e.length-1]}function yr(t){return Number.isNaN(t)}function Bs(t){return Number.isInteger(t)}function Nr(t){return typeof t=="number"}function br(t){return typeof t=="string"}function Ys(t){return typeof t=="boolean"}function Dr(t){return t===null}function _r(t){return t===void 0}function Tr(t){return Dr(t)||_r(t)}function Vs(t){return Tr(t)?!0:br(t)?t.length==0:Nr(t)?!yr(t):!1}function Gs(t){t.set("IF",qs),t.set("IFNA",Hs),t.set("IFERROR",Fs),t.set("IS_NAN",yr),t.set("IS_INTEGER",Bs),t.set("IS_NUMBER",Nr),t.set("IS_STRING",br),t.set("IS_BOOLEAN",Ys),t.set("IS_NULL",Dr),t.set("IS_UNDEFINED",_r),t.set("IS_NULLISH",Tr),t.set("IS_EMPTY",Vs),t.set("SWITCH",Us)}const zs=[ue.YEAR_MONTH,ue.YEAR_MONTH_CHS,ue.YEAR_MONTH_DAY,ue.YEAR_MONTH_DAY_CHS,ue.DATETIME_SHORT,ue.DATETIME_SHORT_CHS,ue.DATETIME,ue.DATETIME_CHS,ue.TIME,ue.TIME_SHORT,ue.YEAR,ue.MONTH,ue.DAY];function ke(t){if(t!=null){if(typeof t=="number")return zs[t];if(typeof t=="string")return t}}function Ar(t,e,n){return t===null&&(t=void 0),Le(t,ke(n)).format(ke(e)??ue.DATETIME)}function Ws(t){return Ar(void 0,t)}function js(t,e){return t===null&&(t=void 0),Le(t,ke(e)).year()}function Zs(t,e){return t===null&&(t=void 0),Le(t,ke(e)).month()+1}function Xs(t,e){return t===null&&(t=void 0),Le(t,ke(e)).date()}function Ks(t,e){return t===null&&(t=void 0),Le(t,ke(e)).hour()}function Js(t,e){return t===null&&(t=void 0),Le(t,ke(e)).minute()}function Qs(t,e){return t===null&&(t=void 0),Le(t,ke(e)).second()}function eo(t){t.set("DATE",Ar),t.set("NOW",Ws),t.set("YEAR",js),t.set("MONTH",Zs),t.set("DAY",Xs),t.set("HOUR",Ks),t.set("MINUTE",Js),t.set("SECOND",Qs)}function Sr(t,e){return t.children.reduce((n,r)=>{const i=r.findElementFromDefine(e);if(i==null)return n;if(!i.isProcessValueDone)throw Ft();const s=i.getRawValue(),o=s==null?0:Number(s);return n.push(Hr(o)?o:0),n},[])}function Tn(t,e){var r;const n=(r=t.parent)==null?void 0:r.parent;if(!(n==null||n.type!==se.TABLE))return Sr(n,e)}function An(t,e){var i,s;const n=(i=t.parent)==null?void 0:i.parent;if(n==null||n.type!==se.TABLE)return;const r=(s=n.doc)==null?void 0:s.pages.reduce((o,u)=>o.concat(u.filterElement(n.define.id)),[]);if(r!=null)return r.reduce((o,u)=>o.concat(Sr(u,e)),[])}function to(t,e){if(!t.doc.isPaged)throw Ft();const r=t.page,i=r.pageNum<r.pageTotal?Tn(t,e):An(t,e);return i==null||i.length==0?0:Z.sum(...i).toNumber()}function no(t,e){const n=t.element,r=t.value;if(!(n instanceof _n))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();if(e===2)return to(n,r);const s=e==1?Tn(n,r):An(n,r);return s==null||s.length==0?0:Z.sum(...s).toNumber()}function ro(t,e){const n=t.element,r=t.value;if(!(n instanceof _n))return;const i=n.doc;if(i==null)return;if(i.isFirstRount)throw Ft();const s=e==1?Tn(n,r):An(n,r);return s==null||s.length==0?0:Z.sum(...s).div(s.length).toNumber()}function io(t){t.set("COL_SUM",no),t.set("COL_AVG",ro)}bs(rt);$s(rt);Gs(rt);eo(rt);io(rt);const so=".quickprint-document{padding:40px 0;box-sizing:border-box;font-family:宋体;font-size:9pt;line-height:1.15;color:#000;word-break:break-all;min-width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale) + 80px)}.quickprint-document *{box-sizing:border-box}.quickprint-document-multi-view{display:grid;column-gap:36px;row-gap:36px;justify-content:center;grid-template-rows:auto;grid-template-columns:repeat(auto-fill,calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale)))}.quickprint-document-multi-view .quickprint-page{margin:0!important}.quickprint-guide-line{position:absolute;left:0;right:0;z-index:999;border-top:1px dashed #ddd;-webkit-user-select:none;user-select:none;pointer-events:none;display:none}.quickprint-page{position:relative;width:calc(var(--quickprint-paper-width) * var(--quickprint-doc-scale));height:calc(var(--quickprint-paper-height) * var(--quickprint-doc-scale));margin:0 auto;background-color:#fff;box-shadow:#0000000f 0 0 10px,#0000000a 0 0 0 1px;page-break-inside:avoid;page-break-after:always}.quickprint-paper{width:var(--quickprint-paper-width);height:var(--quickprint-paper-height);transform:scale(var(--quickprint-doc-scale));transform-origin:top left}.quickprint-page:after{content:attr(data-index);position:absolute;bottom:-24px;left:calc(50% - 50px);width:100px;line-height:20px;text-align:center;font-size:12px;color:#606266}.quickprint-page+.quickprint-page{margin-top:50px}.quickprint-document-debug .quickprint-guide-line{display:block}.quickprint-element{position:absolute;padding:2px}.quickprint-line-through .quickprint-content{text-decoration:line-through}.quickprint-text{word-break:break-all}.quickprint-table>table{border-collapse:collapse;table-layout:fixed}.quickprint-table-cell{padding:0}.quickprint-layout{padding:2px;width:calc(var(--quickprint-cell-width) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-auto-height .quickprint-layout{min-height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-table-cell.quickprint-fixed-height .quickprint-layout{word-break:break-all;overflow:hidden;height:calc(var(--quickprint-cell-height) - (1px / var(--quickprint-dpr, 1)))}.quickprint-number{word-break:normal}.quickprint-content{white-space:pre-line;min-width:100%}.quickprint-content>span{background-color:var(--quickprint-variable-highlight-color, transparent)}",oo="@media print{@page{margin:0}html,body{margin:0!important;padding:0!important;color:#000}.quickprint-page{margin:0!important;box-shadow:none!important}.quickprint-page:after{display:none}.quickprint-hidden{display:none!important}.quickprint-document{--quickprint-doc-scale: 1 !important;padding:0!important;display:block!important;min-width:auto!important}.quickprint-patch-song-blod{text-shadow:0 0 currentColor,0 0 currentColor}}";function Jn(){return so}function uo(){return oo}var qt,Je,dt,Fe,Ue,Be,$e,fn,hn;const Rn=class Rn{constructor(e,n){de(this,$e);de(this,qt,dn(pn.PRINT_DOCUMENT));de(this,Je);de(this,dt);de(this,Fe,Object.create(null));de(this,Ue,0);L(this,"define");L(this,"data");L(this,"state");L(this,"pages",[]);L(this,"element");L(this,"rendering");L(this,"renderState",ce.CREATED);L(this,"devicePixelRatio",window.devicePixelRatio);de(this,Be,[]);const{promise:r,resolve:i}=Promise.withResolvers();it(this,dt,r),it(this,Je,i),this.define=e,this.state=n,Ye(this,"element",null),Ye(this,"rendering",0),this.state.renderState=ce.CREATED,this.state.scale=100,this.watchDevicePixelRatio(),this.injectElementStyle()}static create(e,n={}){const r=e instanceof sn?e:sn.create(e);return new Rn(r,n)}get id(){return"@"+F(this,qt)}get style(){const e=this.state.scale??100,n=this.define.style;return{"--quickprint-dpr":this.devicePixelRatio,"--quickprint-doc-scale":e/100,"--quickprint-paper-width":this.define.paper.width+"mm","--quickprint-paper-height":`calc(${this.define.paper.height}mm - 1px)`,fontFamily:vr(n==null?void 0:n.fontFamily,n==null?void 0:n.enFontFamily),fontSize:n==null?void 0:n.fontSize,lineHeight:n==null?void 0:n.lineHeight}}get isPaged(){return this.renderState===ce.PAGED||this.renderState===ce.READY}get isFirstRount(){return F(this,Ue)===0}onCreated(){return Promise.allSettled(this.pages.map(e=>e.onCreated()))}onBeforeUnmount(e){F(this,Be).indexOf(e)>=0||F(this,Be).push(e)}unmount(){for(const e of F(this,Be))typeof e=="function"&&e();F(this,Be).length=0,this.renderState=ce.UNMOUNT,this.element=null}render(){return Q("div",{class:Se.DOCUMENT,style:this.style})}createElement(){return this.element=this.render(),this.element}async mountChild(e){return this.element==null||e.element==null?!1:(this.element.appendChild(e.element),!0)}async mount(){this.state.total=this.pages.length,this.refreshPageTotal(),st(this,$e,hn).call(this,ce.PAGED),await st(this,$e,fn).call(this),st(this,$e,hn).call(this,ce.READY);const e=this.pages.map(n=>n.onFinshed());await Promise.allSettled(e),typeof F(this,Je)=="function"&&(F(this,Je).call(this),Reflect.deleteProperty(this,"readyResolve"))}append(e){this.pages.push(e),e.setParent(this)}appendMany(e){for(let n=0,r=e.length;n<r;n++)this.append(e[n])}insert(e,n){this.pages.splice(n,0,e),e.setParent(this)}ready(){return F(this,dt)}injectElementStyle(){const e=document.createElement("style");e.textContent=Jn(),document.head.appendChild(e)}async print(){return await this.ready(),new Promise(e=>{var s;const n=new Blob(this.genPrintHtml(),{type:"text/html"}),r=URL.createObjectURL(n),i=document.createElement("iframe");i.style.position="absolute",i.style.top="0",i.style.left="0",i.style.visibility="hidden",i.style.zIndex="-100",i.src=r,document.body.appendChild(i),i.onload=function(){var o;(o=i.contentWindow)==null||o.print()},(s=i.contentWindow)==null||s.addEventListener("afterprint",()=>{URL.revokeObjectURL(r),setTimeout(()=>document.body.removeChild(i),2e3),e()})})}genPapeStyle(){const e=this.define;return`@page{ size: ${e.paper.width}mm ${e.paper.height}mm }`}genPrintHtml(){var r;const e=this.define.name,n=((r=this.element)==null?void 0:r.outerHTML)??"";return["<!DOCTYPE html><html><head>",'<meta charset="UTF-8">','<meta name="viewport" content="width=device-width, initial-scale=1.0">',`<title>${e}</title>`,`<style>${Jn()}</style>`,`<style>${uo()}</style>`,`<style>${this.genPapeStyle()}</style>`,"</head><body>",n,"</body></html>"]}enableMuiltView(){if(this.element==null||this.state.viewMode==="multiple")return!1;this.state.viewMode="multiple",this.element.classList.add("quickprint-document-multi-view")}enableSingleView(){if(this.element==null||this.state.viewMode==="single")return!1;this.state.viewMode="single",this.element.classList.remove("quickprint-document-multi-view")}toggleViewMode(){return this.state.viewMode==="multiple"?this.enableSingleView():this.enableMuiltView()}zoomIn(){if(this.element==null)return!1;const e=this.state.scale??100,n=ut.indexOf(e);if(n<0)return this.resetZoom(),!1;if(n==0)return!1;const r=ut[n-1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}zoomOut(){if(this.element==null)return!1;const e=this.state.scale??100,n=ut.indexOf(e);if(n<0)return this.resetZoom(),!1;if(n>=ut.length-1)return!1;const r=ut[n+1];this.state.scale=r,this.element.style.setProperty("--quickprint-doc-scale",`${r/100}`)}resetZoom(){if(this.element==null)return!1;const e=100;this.state.scale=e,this.element.style.setProperty("--quickprint-doc-scale",`${e/100}`)}addDependency(e,n){F(this,Fe)[e.id]={element:e,...n}}removeDependency(e){delete F(this,Fe)[e.id]}watchDevicePixelRatio(){const e=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`),n=this.updateDevicePixelRatio.bind(this);e.addEventListener("change",n),window.addEventListener("resize",n),this.onBeforeUnmount(()=>{e.removeEventListener("change",n),window.removeEventListener("resize",n)})}updateDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio,this.element!=null&&this.element.style.setProperty("--quickprint-dpr",this.devicePixelRatio+"")}debug(){var e;this.state.debug=!0,(e=this.element)==null||e.classList.add("quickprint-document-debug")}toggleDebug(){var e;this.state.debug=this.state.debug!==!0,(e=this.element)==null||e.classList.toggle("quickprint-document-debug")}findElement(e){for(const n of this.pages){const r=n.findElement(e);if(r)return r}}refreshPageTotal(){const e={};for(const n of this.pages){const r=n.file;if(e[r]!=null){n.pageTotal=e[r];continue}const i=this.pages.filter(s=>s.file===r);e[r]=i.length,n.pageTotal=i.length}}};qt=new WeakMap,Je=new WeakMap,dt=new WeakMap,Fe=new WeakMap,Ue=new WeakMap,Be=new WeakMap,$e=new WeakSet,fn=async function(){for(const n of Object.values(F(this,Fe))){const r=n.element;await r.processValue(),r.isProcessValueDone&&(this.removeDependency(r),await r.updateElement())}if(Object.keys(F(this,Fe)).length==0){Fr.debug("Document",`已完成第计算, 共${F(this,Ue)+1}轮`);return}Mn(this,Ue)._++,!(F(this,Ue)>=100)&&await st(this,$e,fn).call(this)},hn=function(e){this.renderState=e,this.state.renderState=e};let Ct=Rn;function Pt(t){const e=W.create(t),n=t.children.map(r=>W.create(r));return e.appendMany(n),e}async function ao(t,e={}){const n=t.define.pages.map(c=>r(c));t.data=e,t.appendMany(n),await t.onCreated(),t.renderState=ce.RENDERING,t.state.renderState=ce.RENDERING;function r(c){const f=Lt.create(c,t.define.paper);i(f);for(const d of f.defines){const y=o(d);y.define.isFixed?f.appendToFixed(y):f.append(y)}return s(f),f.state=_t.INIT,f}function i(c){if(!(c.header.display!=!0||c.header.defines.length==0))for(const f of c.header.defines)c.appendToHeader(o(f))}function s(c){if(!(c.footer.display!=!0||c.footer.defines.length==0))for(const f of c.footer.defines)c.appendToFooter(o(f))}function o(c){switch(c.type){case"Table":return u(c);default:return W.create(c)}}function u(c){const f=W.create(c),d=c.children;for(const y of d){if(y.isRepeat){f.appendMany(a(y));continue}f.append(Pt(y))}return f}function a(c){const f=Qe(c.ds.value),d=ct(e,f.value);return Ur(d).map((y,m)=>{const R=Pt(c);return R.repeatIndex=m,R.rowData=y,R})}return t}function lo(t,e,n){let r=null,i=1;async function s(){const l=e.rendering,h=e.pages[l];return h==null?e.mount():(h.beginPaging(),h.createElement()==null?(e.rendering+=1,s()):(await e.mountChild(h),await u(h),await a(h),h.file!==r&&(i=1),h.pageNum=i++,await h.onPaged(),e.rendering+=1,e.state.total=e.pages.length,s()))}function o(l,h){const p=l.children[l.rendering-1];return p==null?l.extra?l.header.offsetHeight+4:h.offsetTop:!p.isChanged||nn.isIsolated(p.define,h.define)?h.offsetTop:p.offsetBottom+h.define.top-p.define.top-p.define.height}async function u(l){const h=l.children[l.rendering];return h==null?void 0:(h.offsetTop=o(l,h),h.createElement()==null?(l.rendering+=1,u(l)):(await c(l,h),l.rendering+=1,u(l)))}async function a(l){for(const h of l.fixed)h.createElement(),await l.mountChild(h)}function c(l,h){switch(h.define.type){case se.TABLE:return m(l,h);case se.TEXT:return R(l,h);default:return E(l,h)}}async function f(l,h){const p=h.children[h.rendering];if(p==null)return;if(p.extra&&p.isUndefinedValue&&await p.onCreated(),p.createElement()==null)return h.rendering+=1,f(l,h);await h.mountChild(p);const $=Br.mm_to_px(l.paper.offsetHeight)-l.footer.offsetHeight;if(h.offsetBottom-$>=2){const P=d(l,h,$),x=h.children.filter(k=>k.extra);return e.insert(P,l.index+1),await Promise.allSettled(x.map(k=>k.onCreated())),await P.onCreated(),f(l,h)}return h.rendering+=1,f(l,h)}function d(l,h,p){const N=h.define.footer.map(M=>{const D=Pt(M);return D.extra=!0,D}),$=p-N.reduce((M,D)=>M+D.offsetHeight,0),P=y(h,$),x=h.splitRows(P);h.appendMany(N),h.atomized=!0,h.rendering=P-1;const k=l.clone(),C=new wr(h.define),z=h.define.header.map(M=>Pt(M));C.extra=!0,C.appendMany(z),C.appendMany(x),k.append(C);for(let M=l.rendering+1,D=l.children.length;M<D;M++){const O=l.children[M];nn.isIsolated(O.define,h.define)||(k.append(O),Reflect.set(l.children,M,null))}return l.children=l.children.filter(M=>M!=null),k}function y(l,h){let p=l.offsetTop;for(let N=0;N<l.children.length;N++){if(p+=l.children[N].offsetHeight,p==h)return N;if(p>h)return N-1}return l.children.length-1}async function m(l,h){return await l.mountChild(h),f(l,h)}async function R(l,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),l.mountChild(h)}async function E(l,h){return h.extra&&h.isUndefinedValue&&await h.onCreated(),l.mountChild(h)}return async function(){di(),await ze(),await ao(e,n);const l=e.createElement();return l&&t.appendChild(l),r=e.pages[0].file,s()}}function co(t){const e=Date.now(),n=Ct.create(t.define,t.state);return lo(t.container,n,t.data??{})().then(()=>{n.state.renderTime=Date.now()-e}),n}const fo=pt({__name:"DocState",props:{state:{type:Object,required:!0}},setup(t){const e=t,n=Re(()=>e.state.renderState===ce.READY),r=Re(()=>e.state.renderState===ce.READY?"已就绪":e.state.renderState===ce.RENDERING?`正在生成(${e.state.total??0}页)...`:"正在生成...");return(i,s)=>(Ve(),Ze("div",null,[s[0]||(s[0]=ae("span",null,"文档：",-1)),ae("span",{class:ie({[i.classes.finished]:n.value})},Rt(r.value),3)]))}}),ho="_finished_7h37m_2",po={finished:ho},mo={classes:po},go=Ht(fo,[["__cssModules",mo]]),Eo="_toolbar_3etac_1",vo="_button_3etac_9",wo="_actived_3etac_33",yo="_divider_3etac_46",je={toolbar:Eo,button:vo,actived:wo,divider:yo},No=["viewMode","debug","space","print"],bo=pt({props:{doc:{type:Ct},buttons:{type:Array,required:!0}},setup(t){function e(){var a;(a=t.doc)==null||a.print()}function n(){var a;(a=t.doc)==null||a.toggleViewMode()}function r(){var c;const a={[je.button]:!0,[je.actived]:((c=t.doc)==null?void 0:c.state.viewMode)==="multiple"};return j("button",{type:"button",title:"切换单页/多页视图",class:a,onClick:n},[j(on,{icon:"icon-multi-page"},null),j("span",null,[Ot("多页")])])}function i(){return j("button",{type:"button",class:je.button,onClick:e,title:"打印 Ctrl + P"},[j(on,{icon:"icon-printer"},null),j("span",null,[Ot("打印")])])}function s(){return j("div",{class:je.divider},null)}function o(){return j("div",{class:"quickprint-is-fill-w"},null)}function u(a){if(typeof a=="function")return a(je,t.doc);switch(a){case"viewMode":return r();case"print":return i();case"divider":return s();case"space":return o();default:return null}}return function(){return j("div",{class:je.toolbar},[t.buttons.map(u)])}}});function Do(t){function e(i){const s=t.value;if(s!=null)switch(i.key){case"p":case"P":if(i.ctrlKey)return i.preventDefault(),s.print();case"Add":if(i.ctrlKey)return i.preventDefault(),s.zoomOut();case"Subtract":if(i.ctrlKey)return i.preventDefault(),s.zoomIn();case"0":if(i.ctrlKey)return i.preventDefault(),s.resetZoom();case"m":case"M":if(i.ctrlKey)return i.preventDefault(),s.toggleViewMode()}}function n(){window.addEventListener("keydown",e)}function r(){window.removeEventListener("keydown",e)}return{enable:n,disable:r}}const _o={key:1,class:"quickprint-is-fill-w"},To=pt({__name:"index",props:{define:{type:Object,required:!0},data:{type:Object,required:!0},buttons:{type:Array,default(){return No}}},emits:["mock"],setup(t,{emit:e}){const n=t,r=rr("classes"),i=Mt(),s=Mt(),o=ir({}),u=Do(s),a=Re(()=>o.renderState===ce.READY),c=Re(()=>{const h=o.renderTime??0;if(h<=6e4)return`${h/1e3}秒`;const p=Math.floor(h/1e3),N=p%60,$=(p-N)/60;return N==0?`${$}分`:`${$}分${N}秒`}),f=Re(()=>o.total??"--"),d=Re(()=>({"quickprint-is-scrollable":!0,"quickprint-is-scroll-y":!0,[r.body]:!0}));function y(){var h;(h=s.value)==null||h.zoomIn()}function m(){var h;(h=s.value)==null||h.zoomOut()}function R(h){var p,N;h.deltaY>0?(p=s.value)==null||p.zoomIn():(N=s.value)==null||N.zoomOut()}function E(){var h;(h=s.value)==null||h.toggleDebug()}async function l(){const h=co({container:i.value,define:sn.create(n.define),state:o,data:n.data});s.value=h,document.title=h?`${h.define.name} - OpenPrint`:"OpenPrint",await h.ready(),u.enable();const p=window.location.hostname;(p==="localhost"||p==="127.0.0.1")&&h.debug()}return ti(()=>{l()}),(h,p)=>{var N;return Ve(),Ze("div",{class:ie(J(r).preview),onWheel:ri(R,["ctrl","prevent"])},[ae("div",{class:ie([J(Se).PRINT_HIDDEN,J(r).header])},[ae("div",{class:ie(J(r).headerLeft)},[kn(h.$slots,"headerLeft")],2),j(J(bo),{doc:s.value,buttons:t.buttons},null,8,["doc","buttons"]),ae("div",{class:ie(J(r).headerRight)},[kn(h.$slots,"headerRight")],2)],2),ae("div",{class:ie(d.value),ref_key:"containerRef",ref:i},null,2),ae("div",{class:ie([J(Se).PRINT_HIDDEN,J(r).footer])},[j(go,{state:o,class:ie(J(r).status)},null,8,["state","class"]),a.value?(Ve(),Ze(ni,{key:0},[ae("div",{class:ie(J(r).status)},"用时："+Rt(c.value),3),p[0]||(p[0]=ae("div",{class:"quickprint-is-fill-w"},null,-1)),ae("button",{type:"button",class:ie({"quickprint-text-btn":!0,"quickprint-is-selected":(N=s.value)==null?void 0:N.state.debug}),title:"调试模式",onClick:E},[j(J(on),{icon:"icon-bug"})],2),p[1]||(p[1]=ae("button",{type:"button",class:"quickprint-text-btn"},"快捷键",-1)),ae("div",{class:ie(J(r).divider)},null,2),ae("div",{class:ie(J(r).status)},"第1页，共"+Rt(f.value)+"页",3),ae("div",{class:ie(J(r).divider)},null,2)],64)):(Ve(),Ze("div",_o)),j(J(Yr),{class:ie(J(r).zoom),scale:o.scale,onZoomIn:y,onZoomOut:m},null,8,["class","scale"])],2)],34)}}}),Ao="_preview_1hc69_2",So="_header_1hc69_13",Ro="_headerLeft_1hc69_22",Oo="_headerRight_1hc69_28",Mo="_body_1hc69_34",Lo="_footer_1hc69_53",Io="_status_1hc69_73",Co="_divider_1hc69_79",Po="_zoom_1hc69_86",xo={preview:Ao,header:So,headerLeft:Ro,headerRight:Oo,body:Mo,footer:Lo,status:Io,divider:Co,zoom:Po},ko={classes:xo},$o=Ht(To,[["__cssModules",ko]]),qo=pt({__name:"component",props:{ds:{type:Object,required:!0},options:{type:Array,default(){return[]}},local:{type:Array,default:null}},setup(t){const e=t,n=rr("classes"),r=Vr(),i=nr(e.local??[]),s=ir(e.ds.fields.map(c=>a(c))),o=[{label:"文本",value:me.STRING},{label:"数字",value:me.NUMBER},{label:"日期",value:me.DATE},{label:"对象",value:me.OBJECT},{label:"数组",value:me.ARRAY}],u=[{name:"$index"},{name:"$expand"},{name:"type",title:"类型",width:60,formatter(c,f){var y;const d=c[f.name];return((y=o.find(m=>m.value===d))==null?void 0:y.label)??d}},{name:"name",title:"名称",width:150},{name:"title",title:"标题",width:150},{name:"func",title:"数据",width:200,render(c,f){if(c.type===me.OBJECT)return null;if(c.type===me.ARRAY)return $n(j("input",{type:"number","onUpdate:modelValue":y=>c.total=y,placeholder:"默认生成10-500行数据",min:"0",step:"1",class:n.input},null),[[si,c.total]]);const d=e.options.find(y=>y.classify===c.type);return d==null?null:$n(j("select",{"onUpdate:modelValue":y=>c.func=y,class:n.select},[j("option",{value:"",class:n.placeholder},[Ot("请选择")]),d.rules.map(y=>j("option",{value:y.func,key:y.func},[y.name]))]),[[oi,c.func]])}}];function a(c,f){const d=f?`${f}.${c.name}`:c.name,y=c.children?c.children.map(R=>a(R,c.name)):void 0,m=i[d];return{type:c.type,name:c.name,title:c.title,children:y,$expand:!0,func:(m==null?void 0:m.func)??"",total:m==null?void 0:m.total}}return r==null||r.useHandle("confirm",()=>ii(s)),(c,f)=>(Ve(),Ze("div",{class:ie(J(n).ds)},[j(J(Gr),{columns:u,data:s},null,8,["data"])],2))}}),Ho="_ds_6a9ph_2",Fo="_placeholder_6a9ph_8",Uo="_select_6a9ph_12",Bo="_input_6a9ph_13",Yo={ds:Ho,placeholder:Fo,select:Uo,input:Bo},Vo={classes:Yo},Go=Ht(qo,[["__cssModules",Vo]]);let Nt=null;const Qn=490;function Rr(){return Nt!=null?Promise.resolve(Nt):jr(()=>import("./mock-DUDdPH4f.js"),__vite__mapDeps([0,1,2,3])).then(t=>(Nt=t.default,Nt))}function er(t,e){switch(e){case me.DATE:return t.randDate();case me.NUMBER:return t.randDecimal();case me.STRING:return t.randName();default:return null}}function zo(t){if((t==null?void 0:t.total)==null)return Qn;const e=Number(t.total);return Number.isNaN(e)||!Number.isFinite(e)||e<=0?Qn:Math.round(e)}function tn(t,e,n){if(n==null||et(n.func))return er(t,e.type);const r=t[n.func];return typeof r!="function"?er(t,e.type):r(n)}const Wo=zr(function(t,e,n){const r={ds:e,options:t.rules,local:n},i={pinnable:!1,mask:!0,top:"15vh",width:"720px",height:"600px",minWidth:720,minHeight:600,resizeMode:Zr.RESIZE_ONLY,menus:[{label:"确定",handler:s=>s.dispatchConfirm()}]};return Xr("创建模拟数据",ui(Go,r),i).promisify()});async function tr(t,e){if(t==null)return[];const n=await Rr(),r=await Wo(n,t,e).catch(Wr);return Array.isArray(r)?r:[]}async function bt(t,e){if(t==null||!Array.isArray(e)||e.length==0)return{};const n=await Rr(),r=nr(e);return t.fields.reduce((i,s)=>{const o=r[s.name];if(s.name==""||s.name==null)return i;if(s.type===me.OBJECT){const u=s.children??[];return i[s.name]=u.reduce((a,c)=>{if(et(c.name))return a;const f=`${s.name}.${c.name}`;return a[c.name]=tn(n,c,r[f]),a},{}),i}if(s.type===me.ARRAY){const u=s.children??[],a=zo(o),c=10+Math.round(Math.random()*a);return i[s.name]=Array(c).fill("").map(()=>u.reduce((f,d)=>{if(et(d.name))return f;const y=`${s.name}.${d.name}`;return f[d.name]=tn(n,d,r[y]),f},{})),i}return i[s.name]=tn(n,s,o),i},{})}const jo=pt({__name:"index",setup(t){const e={INIT:0,LOADED_CASE:1,LOADED_DATA:2,READY:3},n=Mt(),r=Mt(),i=jt(0),s=jt(!1),o=Re(()=>{var l;return`${((l=n.value)==null?void 0:l.id)??Date.now()}-${i.value}`}),u=jt(e.INIT),a=Re(()=>["viewMode","debug","space",s.value?m:null,"print"]),c=Re(()=>u.value===e.INIT?"正在加载...":u.value===e.LOADED_CASE?"已加载模板，正在准备数据...":u.value===e.LOADED_DATA?"开始渲染模板":"");function f(){const l=new URLSearchParams(window.location.search).get("id");return mn(l)&&(l==="local"||xn.some(h=>h.id===l))?l:xn[0].id}async function d(E){var N,$,P,x;if(E==null)return{};if(E.data)return s.value=!1,E.data;const l=Cn(E.id);if(Array.isArray(l)&&l.length>0)return bt((N=E.define)==null?void 0:N.ds,l);const h=E.rules;if(Array.isArray(h)&&h.length>0)return bt(($=E.define)==null?void 0:$.ds,h);const p=await tr((P=n.value)==null?void 0:P.ds);return Pn(p,E.id),bt((x=E.define)==null?void 0:x.ds,p)}async function y(){if(n.value==null)return;const E=n.value.id;if(E==null||E=="")return;const l=Cn(E),h=await tr(n.value.ds,l);Pn(h,n.value.id),r.value=await bt(n.value.ds,h),i.value++}function m(E){return j("button",{type:"button",class:E.button,onClick:y},[j("span",null,[Ot("模拟数据")])])}async function R(){u.value=e.INIT,s.value=!0;const E=await Kr(f());n.value=(E==null?void 0:E.define)??{},u.value=e.LOADED_CASE,r.value=await d(E),u.value=e.LOADED_DATA,u.value=e.READY}return R(),(E,l)=>u.value<=e.LOADED_DATA?(Ve(),Ze("div",{key:0,class:ie(E.classes.logs)},Rt(c.value),3)):(Ve(),ai(J($o),{define:n.value,data:r.value,buttons:a.value,key:o.value,class:ie(E.classes.preview),onMock:y},null,8,["define","data","buttons","class"]))}}),Zo="_preview_17t3s_7",Xo="_logs_17t3s_11",Ko={preview:Zo,logs:Xo},Jo={classes:Ko},Qo=Ht(jo,[["__cssModules",Jo]]),Sn=li(Qo),eu=Jr();Sn.use(Qr,{zIndex:eu});Sn.mount("#app");ei(Sn._context);
