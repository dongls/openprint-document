var Qe=Object.defineProperty;var ce=n=>{throw TypeError(n)};var Ke=(n,t,e)=>t in n?Qe(n,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[t]=e;var c=(n,t,e)=>Ke(n,typeof t!="symbol"?t+"":t,e),tn=(n,t,e)=>t.has(n)||ce("Cannot "+e);var K=(n,t,e)=>(tn(n,t,"read from private field"),e?e.call(n):t.get(n)),ue=(n,t,e)=>t.has(n)?ce("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(n):t.set(n,e);import{d as H,h as J,c as It,a as Lt,l as Ne,n as Et,b as ot,e as h,v as en,U as nn,r as Jt,g as Ft,z as rn,N as ct,V as le,s as sn,A as on,T as an,x as de,W as Ae,o as cn}from"./vue-B00pXJJQ.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function e(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=e(r);fetch(r.href,s)}})();function un(n){return JSON.parse(JSON.stringify(n))}function Ms(n){return n&&n.__v_raw?JSON.parse(JSON.stringify(n)):typeof globalThis.structuredClone=="function"?globalThis.structuredClone(n):JSON.parse(JSON.stringify(n))}function at(n,t,e){return Reflect.defineProperty(n,t,{configurable:!1,enumerable:!1,writable:!0,value:e})}function Ut(n,t,e){return Reflect.defineProperty(n,t,{configurable:!1,enumerable:!0,writable:!1,value:e})}function ln(n,t,e){return Reflect.defineProperty(n,t,{configurable:!1,enumerable:!1,writable:!1,value:e})}function St(n="u"){const t=crypto.getRandomValues(new Uint8Array(12));let e=t[0]%11;const i="*********".replace(/[\*]/g,function(){const r=t[e++];return e>=12&&(e=1),(r%36).toString(36)});return`${n}_${i}`}function Qt(n,t=null){if(n==null)return t;try{return JSON.parse(n)}catch(e){return console.error(e),t}}function Z(n){return Array.isArray(n)?n:[]}function ye(n){if(n==null||typeof n!="object")return n;const t=Reflect.ownKeys(n);for(const e of t){const i=n[e];i!=null&&(typeof i=="object"||typeof i=="function")&&ye(i)}return Object.freeze(n)}function nt(n){return typeof n!="string"?!1:n.trim().length>0}function mt(n){return!nt(n)}function _s(n){return n==null?!0:typeof n=="string"?n=="":Array.isArray(n)?n.length==0:!1}function xe(n=0){return new Promise(t=>setTimeout(t,n))}const he=Object.create(null);function Ps(n,t="-"){const e=he[n];if(e!=null)return e;const i=n.replace(/([A-Z])/g,(r,s,o)=>o===0?s.toLowerCase():t+s.toLowerCase());return he[n]=i,i}function Ds(n){return n instanceof Error&&console.error(n),null}function zs(n){return n instanceof Error&&console.error(n),!1}function Bs(n){}function Hs(n,t){if(t==null||t==""||n==null)return;const e=t.split(".");if(e.length<=1)return n[t];let i=n;for(const r of e)if(i=i[r],i==null)return;return i}function dn(n){const t=atob(n);return Uint8Array.from(t,e=>e.codePointAt(0))}function hn(n){const t=Array.from(n,e=>String.fromCodePoint(e)).join("");return btoa(t)}function ks(n){return hn(new TextEncoder().encode(n))}function Ws(n){return new TextDecoder().decode(dn(n))}const B=Object.freeze({PORTRAIT:0,LANDSCAPE:1}),fe=Object.freeze({NORMAL:0}),Ht=Object.freeze({PAPER:0,CONTENT:1}),F=Object.freeze({CONST:0,VARIABLE:1,TEMPLATE:2,FORMULA:3,CODE:4}),fn=Object.freeze({VISIBLE:0,HIDDEN:1,CONDITION:2}),Ct=Object.freeze({DEFINE_DOCUMENT:"d0",DEFINE_PAGE:"p0",DEFINE_ELEMENT:"e0",PRINT_DOCUMENT:"d1",PRINT_PAGE:"p1",PRINT_ELEMENT:"e1",HISTORY_OWNER:"ho",CONTEXTMENU:"cm"}),P=Object.freeze({TEXT:"Text",NUMBER:"Number",DATE:"Date",TABLE:"Table",TABLE_ROW:"TableRow",TABLE_CELL:"TableCell",PARAGRAPH:"Paragraph"}),Yt=Object.freeze({CUSTOM:"custom",A4:"A4"}),et=Object.freeze({size:"A4",width:210,height:297,orientation:B.PORTRAIT}),pn=ye([{size:Yt.CUSTOM,width:210,height:297,orientation:B.PORTRAIT},et,{size:"A3",width:297,height:420,orientation:B.PORTRAIT},{size:"B3",width:353,height:500,orientation:B.PORTRAIT},{size:"B4",width:250,height:353,orientation:B.PORTRAIT},{size:"二等分连续纸",width:241,height:139.7,orientation:B.PORTRAIT,margins:{left:"12.7mm",right:"12.7mm"}},{size:"三等分连续纸",width:241,height:93.1,orientation:B.PORTRAIT,margins:{left:"12.7mm",right:"12.7mm"}}]),dt=Object.freeze({HEADER:0,BODY:1,FOOTER:2}),Fs=Object.freeze({ROUND:0,FLOOR:1,CEIL:2,BANKER_ROUND:3}),Us=Object.freeze({NONE:0,FIXED:1,THOUSAND:2,TEN_THOUSAND:3,DAXIE:4,PERCENTAGE:5}),Ys=Object.freeze({YEAR_MONTH:"YYYY-MM",YEAR_MONTH_CHS:"YYYY年MM月",YEAR_MONTH_DAY:"YYYY-MM-DD",YEAR_MONTH_DAY_CHS:"YYYY年MM月DD日",DATETIME_SHORT:"YYYY-MM-DD HH:mm",DATETIME_SHORT_CHS:"YYYY年MM月DD HH时mm分",DATETIME:"YYYY-MM-DD HH:mm:ss",DATETIME_CHS:"YYYY年MM月DD日 HH时mm分ss秒",TIME:"HH:mm:ss",TIME_SHORT:"HH:mm",YEAR:"YYYY",MONTH:"MM",DAY:"DD"}),qs=Object.freeze({PAGE_NUMBER:"pageNumber",PAGE_TOTAL:"pageTotal",ROW_INDEX:"rowIndex",CURRENT_DATE:"currentDate"}),js=Object.freeze({ELEMENT_VALUR:"elementValue"}),gn=Object.freeze({DEFAULT:0,FIXED:1}),kt=Object.freeze({ONCE:0,EACH:1}),Vs=Object.freeze({AUTO:0,HIDDEN:1,SCALE:2}),Gs=Object.freeze({BUILTIN:0,DS:1,SPECIAL:2}),Wt=Object.freeze({OBJECT:0,ARRAY:1,STRING:2,NUMBER:3,BOOLEAN:4,DATE:5,ANY:6}),Zs=Object.freeze({NONE:0,TABLE:1}),$s=Object.freeze({CONST:0,IGNORE_BLANK:1,PRINT_BLANK:2}),Xs=Object.freeze({NONE:0,TL_BR:1,TR_BL:2});function ve(n){return typeof n!="number"||Number.isNaN(n)?!1:!!Number.isFinite(n)}function Js(n){return!ve(n)}const Ie=En(),Le=25.4,Se=4;function En(){return 96}function mn(n,t=Se){return Math.round(n/t)*t}function X(n){return Math.round(n*Ie/Le)}function bn(n,t=3){const e=n*Le/Ie,i=Math.pow(10,t);return Math.round(e*i)/i}function Tn(n){return Math.round(n*3/4)}function Ce(n){if(mt(n))return{num:null,unit:null};const t=n.match(/^(-?\d+(?:\.\d+)?)(px|pt|mm|em|%)?$/);if(t==null)return{num:null,unit:null};const e=Number(t[1]),i=ve(e)?e:null,r=mt(t[2])?null:t[2];return{num:i,unit:r}}function wn(n){if(n==null)return null;if(typeof n=="number")return n;if(typeof n!="string")return null;const t=Ce(n);if(t.num==null)return null;switch(t.unit){case"px":return t.num;case"pt":return pe.pt_to_px(t.num);case"mm":return pe.mm_to_px(t.num);default:return null}}const pe={unit:Se,mm_to_px:X,pt_to_mm:bn,pt_to_px:Tn,parseNumAndUnit:Ce,processLengthToPX:wn};class bt{constructor(t,e){c(this,"id");c(this,"elements");c(this,"index");c(this,"header");c(this,"footer");c(this,"padding");c(this,"parent");c(this,"children");c(this,"size");if(Ut(this,"id",t.id??St(Ct.DEFINE_PAGE)),at(this,"elements",Object.create(null)),this.index=t.index,this.header=this.createHeader(t.header),this.footer=this.createFooter(t.footer),this.padding=t.padding,this.children=e,this.size=this.createPageSize(t.size),at(this,"parent",void 0),Array.isArray(e))for(const i of e)i.setParent(this),this.elements[i.id]=i}static create(t){const e=Z(t.children).map(i=>x.create(i));return new bt(t,e)}get orientation(){const t=this.size.orientation;if(t!=null)return t;const e=this.parent;return e==null?B.PORTRAIT:e.paper.orientation}get topZIndex(){const t=this.children;return t.length===0?10:Math.max(...t.map(e=>e.zIndex??10))}get width(){const t=this.parent;return this.size.type===Ht.CONTENT?(t==null?void 0:t.paperWidth)??0:t==null?0:(this.size.orientation??t.paper.orientation)===B.LANDSCAPE?t.paperHeight:t.paperWidth}get height(){const t=this.parent;return this.size.type===Ht.CONTENT?this.size.height??(t==null?void 0:t.paperHeight)??0:t==null?0:(this.size.orientation??t.paper.orientation)===B.LANDSCAPE?t.paperWidth:t.paperHeight}setParent(t){this.parent=t}createHeader(t={}){return{display:t.display!==!1,height:t.height??80}}createPageSize(t){return t??{type:Ht.PAPER}}createFooter(t={}){return{display:t.display!==!1,height:t.height??80,flow:t.flow}}append(t){t.setParent(this),this.children.push(t),this.elements[t.id]=t}removeChild(t){const e=this.children.indexOf(t);return e<0?!1:(this.children.splice(e,1),t.setParent(void 0),delete this.elements[t.id],!0)}checkHeaderAndFooter(t){const e=this.header,i=this.footer;e.display&&e.height>t&&(e.height=Math.min(80,Math.floor(t*.8))),i.display&&i.height>t&&(i.height=Math.min(80,Math.floor(t*.8))),e.display&&i.display&&e.height+i.height>t&&(i.height=t-e.height-16)}setHeaderHeight(t){const e=this.parent;if(e==null)return!1;const i=X(e.paperHeight),r=this.footer;let s=Math.round(t);return s<=0&&(s=0),s>i&&(s=i),r.display!==!0?(this.header.height=s,!0):(s>i-r.height&&(s=i-r.height-16),this.header.height=s,!0)}setFooterHeight(t){const e=this.parent;if(e==null)return!1;const i=this.header,r=X(e.paperHeight);let s=Math.round(t);return s<=0&&(s=0),s>r&&(s=r),i.display!==!0?(this.footer.height=s,!0):(r-s<i.height&&(s=r-i.height-16),this.footer.height=s,!0)}findElement(t){const e=this.elements[t];if(e)return e;for(const i of this.children){const r=i.find(t);if(r)return r}}}function Rn(n,...t){console.log(`%c[${n}]`,"color: orange;",...t)}function On(n,...t){console.log(`%c[${n}]`,"color: green;",...t)}function Nn(n,...t){console.log(`%c[${n}]`,"color: red;",...t)}function An(n){console.log(`%c${n}`,"font-family:monospace;")}function yn(){console.log("".padStart(24,"-"))}function xn(){console.clear()}function vn(){console.log(`
`)}const In={warn:Rn,debug:On,writeLine:yn,writeSpaceLine:vn,write:An,clear:xn,error:Nn};class Me{constructor(t,e){c(this,"type");c(this,"stopped",!1);c(this,"defaultPrevented",!1);c(this,"detail");this.type=t,this.detail=e}stopPropagation(){this.stopped=!0}preventDefault(){this.defaultPrevented=!0}}var G;class Ln{constructor(){c(this,"__v_skip",!0);ue(this,G,new Map)}on(t,e){const i=K(this,G).get(t);return i==null?(K(this,G).set(t,[e]),this):i.includes(e)?this:(i.unshift(e),this)}once(t,e){const i=r=>{e(r),this.off(t,i)};return this.on(t,i),this}off(t,e){const i=K(this,G).get(t);if(i==null)return this;const r=i.indexOf(e);return r<0?this:(i.splice(r,1),this)}dispatch(t){const e=K(this,G).get(t.type);if(e==null)return t;for(let i=e.length-1;i>=0;i--){const r=e[i];if(typeof r=="function"&&r(t),t.stopped)break}return t}cleanup(){K(this,G).clear()}createEvent(t,e){return new Me(t,e)}}G=new WeakMap;function Sn(n){const t=n.split(".");return{varType:Number(t[0]),dataType:Number(t[1]),path:t.slice(2).join("."),value:t[t.length-1]}}function Cn(n){switch(n){case Wt.STRING:return P.TEXT;case Wt.NUMBER:return P.NUMBER;case Wt.DATE:return P.DATE;default:return}}const z=class z{constructor(t={},e){c(this,"id");c(this,"type");c(this,"title");c(this,"elements");c(this,"top");c(this,"left");c(this,"width");c(this,"height");c(this,"zIndex");c(this,"style");c(this,"attributes");c(this,"ds");c(this,"visibility");c(this,"parent");c(this,"children");c(this,"state");c(this,"emitter");if(Ut(this,"id",t.id??St(Ct.DEFINE_ELEMENT)),Ut(this,"type",t.type),at(this,"elements",Object.create(null)),this.title=t.title,this.top=t.top??0,this.left=t.left??0,this.width=t.width??0,this.height=t.height??0,this.style=this.createStyle(t.style??{}),this.attributes=t.attributes??{},this.ds=this.createDS(t.ds??{}),this.children=e,this.visibility=t.visibility,this.zIndex=t.zIndex??10,Array.isArray(e))for(const i of e)i.setParent(this),this.elements[i.id]=i;at(this,"parent",void 0),at(this,"state",this.createState()),ln(this,"emitter",new Ln)}static register(t,e){z.ELEMENTS[t]=e}static create(t,e){const i=z.ELEMENTS[t.type]??z,r=Z(t.children).map(o=>z.create(o)),s=new i(t,r);return e&&s.setParent(e),s}static sort(t,e){return t.top===e.top?t.left-e.left:t.top-e.top}static isIsolated(t,e){return t.left+t.width<=e.left||t.left>=e.left+e.width}static ignoreProp(t,e){switch(t){case"style":case"attributes":return Object.keys(e[t]).length==0;case"top":case"left":case"width":case"height":return e[t]===0;case"children":return e.children.length==0;case"visibility":return e.visibility==null||e.visibility.type===fn.VISIBLE;case"ds":return mt(e.ds.value);default:return!1}}static isDefineElement(t){return t==null?!1:t instanceof z}get bottom(){return this.top+this.height}get offsetTop(){return Math.round(this.top)}get offsetLeft(){return Math.round(this.left)}get offsetWidth(){return Math.round(this.width)}get offsetHeight(){return Math.round(this.height)}get display(){var t;return((t=this.attributes)==null?void 0:t.display)??this.type}get isBindConst(){const t=this.ds;return t==null?!1:t.type===F.CONST}get isBindVariable(){const t=this.ds;return t==null?!1:t.type===F.VARIABLE&&nt(t.value)}get isBindTemplate(){const t=this.ds;return t==null?!1:t.type===F.TEMPLATE&&nt(t.value)}get isBindFormula(){const t=this.ds;return t==null?!1:t.type===F.FORMULA&&nt(t.value)}get isBindCode(){const t=this.ds;return t==null?!1:t.type===F.CODE&&nt(t.value)}get index(){const t=this.parent;return t==null?-1:t.children.indexOf(this)}get isSelected(){return this.state.selected===!0}get isFixed(){return this.attributes.position===gn.FIXED}get page(){let t=this.parent;for(;t;){if(t instanceof bt)return t;if(!(t instanceof z))return null;t=t.parent}return null}get doc(){var t;return(t=this.page)==null?void 0:t.parent}on(t,e){return this.emitter.on(t,e)}once(t,e){return this.emitter.once(t,e)}off(t,e){return this.emitter.off(t,e)}dispatch(t){return this.emitter.dispatch(t)}createEvent(t,e){return new Me(t,e)}setParent(t){this.parent=t}createStyle(t){return t}createDS(t){return{type:(t==null?void 0:t.type)??F.CONST,value:t==null?void 0:t.value}}createState(){return{selected:!1,dragging:!1,key:0}}append(t){t.setParent(this),this.children.push(t),this.elements[t.id]=t}insert(t,e){e.setParent(this),this.children.splice(t,0,e),this.elements[e.id]=e}remove(){const t=this.parent;return t==null?(In.warn("DefineElement","元素未插入文档中，无法删除"),!1):t.removeChild(this)}removeChild(t){const e=this.children.indexOf(t);return e<0?!1:(this.children.splice(e,1),t.setParent(void 0),delete this.elements[t.id],!0)}resetDS(){this.ds=this.createDS()}forceUpdate(){this.state&&this.state.key++}calculateCoord(t){var i;return((i=this.doc)==null?void 0:i.useGrid)?mn(t):Math.round(t)}setTop(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("top",i),!0}setLeft(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("left",i),!0}setWidth(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("width",i),!0}setHeight(t,e=!1){const i=e?Math.round(t):this.calculateCoord(t);return this.updateValue("height",i),!0}updateValue(t,e){return Reflect.get(this,t)===e?!1:(Reflect.set(this,t,e),this.dispatch(this.createEvent("update",{key:t,value:e})),!0)}setZIndex(t){this.zIndex=t}setStyle(t,e){this.style[t]=e}getStyle(t){return this.style[t]}removeStyle(t){Reflect.deleteProperty(this.style,t)}blur(){this.state.selected===!0&&(this.state.selected=!1,this.dispatch(this.createEvent("blur")))}focus(){this.state.selected!==!0&&(this.state.selected=!0,this.dispatch(this.createEvent("focus")))}find(t){if(t==null)return;const e=this.elements[t];if(e)return e;for(const i of this.children){const r=i.find(t);if(r)return r}}contains(t){const e=t instanceof z?t.id:t;return this.find(e)!=null}toJSON(){const t={};for(const e in this)z.ignoreProp(e,this)||(t[e]=this[e]);return t}setDataSource(t,e){if(this.ds.type=t,this.ds.value=e,t!==F.VARIABLE)return;const i=Sn(e),r=Cn(i.dataType);r&&r!==this.display&&(this.attributes.display=r)}};c(z,"ELEMENTS",Object.create(null));let x=z;class Mn extends x{}class _n extends x{}class Pn extends x{}class At extends x{static sort(t,e){var u,p;const i=(u=t.parent)==null?void 0:u.index,r=(p=e.parent)==null?void 0:p.index,s=t.index,o=e.index;return i==null||r==null||i===r?s-o:i-r}static createDefault(t,e){return x.create({type:P.TABLE_CELL,width:t,height:e})}get offsetLeft(){const t=this.parent;if(t==null)return 0;const e=this.index;return e==0?0:(t.children??[]).slice(0,e).reduce((r,s)=>r+s.width,0)}get offsetWidth(){var s,o;const t=this.attributes.colspan;if(t==null||t<0)return Math.round(this.width);if(t==0)return 0;const e=(o=(s=this.parent)==null?void 0:s.parent)==null?void 0:o.columns;if(!Array.isArray(e)||e.length==0)return Math.round(this.width);const i=this.index,r=e.slice(i,i+t).reduce((u,p)=>u+p,0);return Math.round(r)}get offsetHeight(){const t=this.attributes.rowspan;if(t==null||t<0)return Math.round(this.height);if(t==0)return 0;const e=this.parent;if(e==null)return 0;const i=e.parent;if(i==null)return 0;const r=e.index,s=i.children.slice(r,r+t).reduce((o,u)=>o+u.height,0);return Math.round(s)}get hasRowSpan(){const t=this.attributes.rowspan;return t==null?!1:t>=2}get hasColSpan(){const t=this.attributes.colspan;return t==null?!1:t>=2}get hasSpan(){return this.hasColSpan||this.hasRowSpan}get noSpan(){return!this.hasColSpan&&!this.hasRowSpan}get isRowCollapsed(){return this.attributes.rowspan===0}get isColCollapsed(){return this.attributes.colspan===0}get isCollapsed(){return this.isRowCollapsed||this.isColCollapsed}get colspan(){return this.attributes.colspan??1}get rowspan(){return this.attributes.rowspan??1}get offsetTop(){var t;return((t=this.parent)==null?void 0:t.offsetTop)??0}get table(){var t;return(t=this.parent)==null?void 0:t.parent}setTop(t,e){return!1}setLeft(t,e){return!1}setWidth(t,e=!0){var s;const i=(s=this.parent)==null?void 0:s.parent;if(i==null)return!1;const r=e?Math.round(t):this.calculateCoord(t);return i.setColWidth(this.index,r),i.updateBoxSize(),!0}setHeight(t,e){var s;const i=this.parent;if(i==null)return!1;const r=e?Math.round(t):this.calculateCoord(t);return i.setRowHeight(r),(s=i.parent)==null||s.updateBoxSize(),!0}resetSpan(){var i;const t=this.attributes.range,e=(i=this.parent)==null?void 0:i.parent;if(this.attributes.colspan=void 0,this.attributes.rowspan=void 0,this.attributes.range=void 0,this.attributes.control=void 0,!(!Array.isArray(t)||e==null))for(const r of t){const s=e.find(r);s!=null&&s.resetSpan()}}getNextColIndex(){return this.hasColSpan?this.index+this.colspan-1:this.index+1}getNextRowIndex(){const t=this.parent;return t==null?-1:this.hasRowSpan?t.index+this.rowspan-1:t.index+1}findPrevDisplayedCell(){var r;const t=this.index;if(t<=0)return;const e=this.parent,i=e==null?void 0:e.children[t-1];if(i!=null)return i.isColCollapsed?(r=e==null?void 0:e.parent)==null?void 0:r.find(i.attributes.control):i}findNextDisplayedCell(){var e,i,r;const t=this.index;if(!(t<=0)){if(this.hasColSpan){const s=t+this.colspan-1;return(i=(e=this.parent)==null?void 0:e.children)==null?void 0:i[s]}return(r=this.parent)==null?void 0:r.children[t+1]}}findPrevDisplayedRow(){const t=this.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const i=t.index,r=this.index,s=e.children[i-1];if(s==null)return;const o=s.children[r];if(o.isRowCollapsed){const u=i-o.rowspan;return e.children[u]}return s}findNextDisplayedRow(){const t=this.parent,e=t==null?void 0:t.parent;if(t==null||e==null)return;const i=t.index,r=this.hasRowSpan?this.rowspan:1;return e.children[i+r]}collapse(t){this.attributes.colspan=0,this.attributes.rowspan=0,this.attributes.control=t}}const gt=class gt extends x{static createDefault(t,e=gt.DEFAULT_HEIGHT){const i=t.map(r=>At.createDefault(r,e));return gt.create({type:P.TABLE_ROW,children:i,height:e,width:t.reduce((r,s)=>r+s,0)})}get isRepeat(){return this.ds==null||this.isHeader||this.isFooter||this.ds.type!=F.VARIABLE?!1:nt(this.ds.value)}get rowspan(){return Math.max(...this.children.map(t=>t.rowspan))}get isHeader(){return this.attributes.type===dt.HEADER}get isFooter(){return this.attributes.type===dt.FOOTER}get isBody(){return!this.isFooter&&!this.isHeader}get offsetTop(){const t=this.parent;if(t==null)return 0;const e=this.index;return e==0?0:(t.children??[]).slice(0,e).reduce((r,s)=>r+s.height,0)}setTop(t,e){return!1}setLeft(t,e){return!1}setRowHeight(t){this.setHeight(t,!0),this.children.forEach(e=>e.updateValue("height",this.height))}asHeader(){this.attributes.type=dt.HEADER,this.attributes.printMode=kt.EACH}asFooter(){this.attributes.type=dt.FOOTER,this.attributes.printMode=kt.EACH}asBody(){this.attributes.type=dt.BODY,this.attributes.printMode=kt.ONCE}};c(gt,"DEFAULT_HEIGHT",32);let yt=gt;class it extends x{constructor(e={},i){super(e,i);c(this,"spans");this.attributes.colgroup=Z(this.attributes.colgroup),this.spans=this.buildSpans()}static toArea(e){var m,w,I;const[i,...r]=e;let s=i.index,o=i.index,u=((m=i.parent)==null?void 0:m.index)??-1,p=((w=i.parent)==null?void 0:w.index)??-1;for(const R of r){const C=R.index,f=((I=R.parent)==null?void 0:I.index)??-1,E=R.hasColSpan?C+R.colspan-1:C,v=R.hasRowSpan?f+R.rowspan-1:f;C>=0&&C<s&&(s=C),C>=0&&E>o&&(o=E),f>=0&&f<u&&(u=f),f>=0&&v>p&&(p=v)}return{colStart:s,colEnd:o,rowStart:u,rowEnd:p,colSpan:o-s+1,rowSpan:p-u+1}}get columns(){return(this.attributes.colgroup??[]).map(i=>Math.round(i))}get header(){return this.children.filter(e=>e.isHeader)}get footer(){return this.children.filter(e=>e.isFooter)}get offsetWidth(){return this.columns.reduce((e,i)=>e+i,0)}get colSize(){return this.attributes.colgroup.length}get rowSize(){return this.children.length}buildSpans(){const e=new Set;for(const i of this.children)for(const r of i.children)r.hasSpan&&e.add(r);return e}setColgroup(e){this.attributes.colgroup=e}updateBoxSize(){const e=this.attributes.colgroup;for(const i of this.children){const r=i.height;for(let s=0;s<i.children.length;s++){const o=i.children[s];o.updateValue("width",e[s]),o.updateValue("height",r)}}this.updateValue("width",e.reduce((i,r)=>i+=r,0)),this.updateValue("height",this.children.reduce((i,r)=>i+=r.height,0))}insertColumn(e,i,r=!1){const s=this.attributes.colgroup;if(e<0||e>=s.length)return;const o=s[e],u=r?Math.round(o/2):o,p=e+i;s.splice(p,0,u),r&&(s[e]=o-u);for(const m of this.children){const w=At.createDefault(o,m.height);m.insert(p,w)}this.updateCellSpan(),this.updateBoxSize()}removeColumn(e){const i=this.attributes.colgroup;if(!(e<0||e>=i.length)){i.splice(e,1);for(const r of this.children){const s=r.children[e];s.hasSpan&&(s.resetSpan(),this.spans.delete(s)),r.removeChild(s)}this.updateCellSpan(),this.updateBoxSize()}}inserRow(e,i,r=!1){const s=this.children[e],o=s.height,u=r?Math.round(o/2):s.height,p=e+i,m=yt.createDefault(this.attributes.colgroup,u);r&&s.setRowHeight(o-u),this.insert(p,m),this.updateCellSpan(),this.updateBoxSize()}removeRow(e){const i=this.children[e];for(const r of i.children)r.noSpan||(r.resetSpan(),this.spans.delete(r));this.removeChild(i),this.updateCellSpan(),this.updateBoxSize()}updateCellSpan(){for(const e of this.spans){if(e.noSpan){this.spans.delete(e);continue}const i=this.findCellFromRange(Z(e.attributes.range)),r=it.toArea([e,...i]),s=this.findCellFromArea(r).filter(o=>o.id!==e.id);for(const o of s)o.collapse(e.id);e.attributes.colspan=r.colSpan,e.attributes.rowspan=r.rowSpan,e.attributes.range=s.map(o=>o.id)}}setColWidth(e,i){this.attributes.colgroup[e]=i}setRowHeight(e,i){const r=this.children[e];r&&r.setRowHeight(i)}setColumns(e){this.attributes.colgroup=e}getColumnLeft(e){return(this.attributes.colgroup??[]).slice(0,e).reduce((r,s)=>r+s,0)}getRowTop(e){return(this.children??[]).slice(0,e).reduce((r,s)=>r+s.height,0)}mergeCells(e){const i=e[0],r=it.toArea(e),s=this.findCellFromArea(r).filter(o=>o.id!==i.id);for(const o of s)o.hasSpan&&this.spans.delete(o),o.collapse(i.id);return i.attributes.colspan=r.colSpan,i.attributes.rowspan=r.rowSpan,i.attributes.range=s.map(o=>o.id),this.spans.add(i),i}mergeRightCell(e,i){i.collapse(e.id);const r=Z(e.attributes.range);r.includes(i.id)||r.push(i.id);const s=it.toArea([e,...this.findCellFromRange(r)]);e.attributes.colspan=s.colSpan,e.attributes.range=r}mergeBottomCell(e,i){i.collapse(e.id);const r=Z(e.attributes.range);r.includes(i.id)||r.push(i.id);const s=it.toArea([e,...this.findCellFromRange(r)]);e.attributes.rowspan=s.rowSpan,e.attributes.range=r}splitCells(e){for(const i of e)i.noSpan||(i.resetSpan(),this.spans.delete(i))}findCellFromArea(e){const i=[];for(let r=e.rowStart;r<=e.rowEnd;r++){const s=this.children[r];for(let o=e.colStart;o<=e.colEnd;o++)i.push(s.children[o])}return i}findCellFromRange(e){return e.map(i=>this.find(i)).filter(i=>i instanceof At)}}class Dn extends x{constructor(t={},e=[]){super(t,e),this.ds.type=F.CONST}}const Qs=Object.freeze({DEFAULT:0,SIZE_0:42,SIZE_0_S:37,SIZE_1:26,SIZE_1_S:24,SIZE_2:22,SIZE_2_S:18,SIZE_3:16,SIZE_3_S:15,SIZE_4:14,SIZE_4_S:12,SIZE_5:10.5,SIZE_5_S:9,SIZE_6:7.5,SIZE_6_S:6.5,SIZE_7:5.5,SIZE_8:5}),ge=Object.freeze({DEFAULT:"inherit",SONG:"SimSun"}),Ks=Object.freeze({NORMAL:"normal",ITALIC:"italic"}),to=Object.freeze({LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"}),eo=Object.freeze({AUTO:"auto",LEFT:"left",CENTER:"center",RIGHT:"right",JUSTIFY:"justify"}),Ee=Object.freeze({TOP:0,MIDDLE:1,BOTTOM:2}),ft=Object.freeze({NONE:"none",SOLID:"solid",DOTTED:"dotted",DASHED:"dashed",DOUBLE:"double"}),no=Object.freeze({NONE:"none",UNDERLINE:"underline",OVERLINE:"overline",LINE_THROUGH:"line-through"}),io=Object.freeze({SOLID:"solid",DOTTED:"dotted",DASHED:"dashed",DOUBLE:"double",WAVY:"wavy"}),ro=Object.freeze({DEFAULT:"0",TIMES_1:"1",TIMES_1_1:"1.1",TIMES_1_5:"1.5",TIMES_2:"2"}),zn=Object.freeze({INHERIT:"inherit",CURRENT_COLOR:"currentColor",BLACK:"#000000"}),so=Object.freeze({NONE:"",PX:"px",PT:"pt",MM:"mm",EM:"em",PERCENTAGE:"%"});function Bn(n,t){if(t==null)return n;const e=Object.keys(t);if(e.length==0)return n;for(const i of e){const r=t[i];r!=null&&(n[i]=r)}return n}function oo(n,...t){for(const e of t)Bn(n,e);return n}function pt(n,t){const e=t[0].toUpperCase()+t.slice(1),i=n.getStyle(`border${e}Style`)??n.getStyle("borderStyle");if(i==null)return!1;switch(i){case ft.DASHED:case ft.DOTTED:case ft.SOLID:case ft.DOUBLE:return!0;default:return!1}}function ao(n,t){const e=[];if(t&&t!=ge.DEFAULT&&e.push(`"${t}"`),n&&n!==ge.DEFAULT&&e.push(`"${n}"`),e.length!=0)return e.join(",")}function co(n){if(n.underline===!0)return{textDecorationLine:"underline",textDecorationStyle:n.underlineStyle,textDecorationColor:n.underlineColor}}function uo(n){if(n==null)return{};const t=n.style??{},e={};return t.textAlign&&(e.textAlign=t.textAlign),t.textAlignLast&&(e.textAlignLast=t.textAlignLast),e}function lo(n){if(n==null)return{};const t=n.style??{};return t.verticalAlign==Ee.MIDDLE||t.verticalAlign==null?{display:"flex",alignItems:"center"}:t.verticalAlign==Ee.BOTTOM?{display:"flex",alignItems:"end"}:{}}function ho(n){if(n==null)return{};const t=n.style??{},e={};return t.paddingTop&&(e.paddingTop=t.paddingTop),t.paddingRight&&(e.paddingRight=t.paddingRight),t.paddingBottom&&(e.paddingBottom=t.paddingBottom),t.paddingLeft&&(e.paddingLeft=t.paddingLeft),e}function fo(n){if(n==null)return{};const t=n.style??{},e=t.borderRadius;return{borderTopLeftRadius:t.borderTopLeftRadius??e,borderTopRightRadius:t.borderTopRightRadius??e,borderBottomLeftRadius:t.borderBottomLeftRadius??e,borderBottomRightRadius:t.borderBottomRightRadius??e}}function po(n){if(n==null)return{};const t=n.style??{},e={},i=t.borderWidth??"1px",r=t.borderStyle??ft.SOLID,s=t.borderColor??zn.BLACK;if(pt(n,"top")){const o=t.borderTopWidth??i,u=t.borderTopStyle??r,p=t.borderTopColor??s;e.borderTop=`${o} ${u} ${p}`}if(pt(n,"right")){const o=t.borderRightWidth??i,u=t.borderRightStyle??r,p=t.borderRightColor??s;e.borderRight=`${o} ${u} ${p}`}if(pt(n,"bottom")){const o=t.borderBottomWidth??i,u=t.borderBottomStyle??r,p=t.borderBottomColor??s;e.borderBottom=`${o} ${u} ${p}`}if(pt(n,"left")){const o=t.borderLeftWidth??i,u=t.borderLeftStyle??r,p=t.borderLeftColor??s;e.borderLeft=`${o} ${u} ${p}`}return e}function go(n,t){if(n==null||!pt(n,t))return null;const e=n.style??{},i=e.borderWidth??"1px";switch(t){case"top":return e.borderTopWidth??i;case"right":return e.borderRightWidth??i;case"bottom":return e.borderBottomWidth??i;case"left":return e.borderLeftWidth??i;default:return null}}class Hn extends Map{constructor(e){super();c(this,"timer",null);c(this,"delay",6e4);c(this,"validator");this.validator=e,this.startTimer()}startTimer(){this.clearTimer(),this.timer=setTimeout(()=>{this.prune(),this.startTimer()},this.delay)}clearTimer(){this.timer!=null&&(clearTimeout(this.timer),this.timer=null)}prune(){const e=this.validator;if(e==null||typeof e!="function"){this.clear();return}for(const[i,r]of this)e(i,r)||this.delete(i)}get(e){const i=super.get(e);if(i!=null){if(this.validate(e,i))return i;this.delete(e)}}validate(e,i){const r=this.validator;return r==null||typeof r!="function"?!0:r(e,i)}cleanup(){this.clear(),this.clearTimer()}}class qt{constructor(t={},e){c(this,"elements");c(this,"id");c(this,"name");c(this,"type");c(this,"paper");c(this,"margins");c(this,"style");c(this,"pages",[]);c(this,"attributes");c(this,"ds");this.id=t.id??St(Ct.DEFINE_DOCUMENT),this.name=t.name??"未命名的文档",this.type=t.type??fe.NORMAL,this.paper=this.createPaper(t.paper),this.pages=Z(e),this.ds=this.createDS(t.ds),this.attributes=t.attributes??{grid:!0},this.margins=t.margins,this.style=this.createStyle(t.style),this.pages.length>0&&this.pages.forEach(i=>i.setParent(this)),at(this,"elements",new Hn((i,r)=>r.parent!=null))}static createNormalDocument(){const t={height:297,orientation:B.PORTRAIT,size:"A4",width:210},e=bt.create({index:0,orientation:t.orientation}),i={type:fe.NORMAL,paper:t};return new qt(i,[e])}static create(t){const e=typeof t=="string"?Qt(t,{}):un(t),i=Z(e.pages).map(r=>bt.create(r));return new qt(e,i)}get paperWidth(){return this.paper.width}get paperHeight(){return this.paper.height}get firstPage(){return this.pages[0]}get useGrid(){return this.attributes.grid===!0}createPaper(t){if(t==null)return{...et};if(t.size===Yt.CUSTOM)return{size:Yt.CUSTOM,orientation:(t==null?void 0:t.orientation)??et.orientation,width:(t==null?void 0:t.width)??et.width,height:(t==null?void 0:t.height)??et.height};const e=pn.find(i=>i.size===t.size);return e==null?{...et}:{...e}}createDS(t){return{fields:(t==null?void 0:t.fields)??[]}}createStyle(t){return{fontFamily:t==null?void 0:t.fontFamily,enFontFamily:t==null?void 0:t.enFontFamily,fontSize:(t==null?void 0:t.fontSize)??"9pt",lineHeight:(t==null?void 0:t.lineHeight)??"1.15"}}createMarginsFromPaper(t){if(t==null||t.margins==null||Object.keys(t.margins).length==0)return;const e=t.margins;return{top:e.top==null?void 0:X(e.top),right:e.right==null?void 0:X(e.right),bottom:e.bottom==null?void 0:X(e.bottom),left:e.left==null?void 0:X(e.left)}}updateDS(t){this.ds=this.createDS(t)}submit(){return this}findElement(t){const e=this.elements.get(t);if(e){if(e.parent==null){this.elements.delete(t);return}return e}for(const i of this.pages){const r=i.findElement(t);if(r)return this.elements.set(t,r),r}}findPage(t){return this.pages.find(e=>t===e.id)}cleanup(){this.elements.cleanup()}}x.register(P.TEXT,Mn);x.register(P.NUMBER,_n);x.register(P.DATE,Pn);x.register(P.TABLE,it);x.register(P.TABLE_ROW,yt);x.register(P.TABLE_CELL,At);x.register(P.PARAGRAPH,Dn);const kn=["xlink:href"],Wn=H({__name:"Icon",props:{icon:{type:String,required:!0},size:{type:String,default:"14px"},color:{type:String}},setup(n){const t=n,e=J(()=>({fontSize:t.size,color:t.color}));return(i,r)=>(Lt(),It("svg",{class:Et(i.classes.icon),"aria-hidden":"true",style:Ne(e.value)},[ot("use",{"xlink:href":"#"+n.icon},null,8,kn)],6))}}),Fn="_icon_1uhhs_2",Un={icon:Fn},Kt=(n,t)=>{const e=n.__vccOpts||n;for(const[i,r]of t)e[i]=r;return e},Yn={classes:Un},jt=Kt(Wn,[["__cssModules",Yn]]),qn=H({__name:"Zoom",props:{scale:{type:Number,default:100}},emits:["zoomIn","zoomOut"],setup(n,{emit:t}){const e=t;function i(){e("zoomIn")}function r(){e("zoomOut")}return(s,o)=>(Lt(),It("div",{class:Et(s.classes.zoom)},[ot("button",{type:"button",class:"quickprint-text-btn",onClick:i,title:"缩小"},[h(jt,{icon:"icon-minus"})]),ot("span",{class:Et(s.classes.scale)},en(n.scale)+"%",3),ot("button",{type:"button",class:"quickprint-text-btn",onClick:r,title:"放大"},[h(jt,{icon:"icon-plus"})])],2))}}),jn="_zoom_13dvp_2",Vn="_scale_13dvp_8",Gn={zoom:jn,scale:Vn},Zn={classes:Gn},Eo=Kt(qn,[["__cssModules",Zn]]);let xt=$n();function mo(n){return n!=null&&(xt=n),xt}function $n(){let n=3e3;function t(){return n}function e(r){n=r}function i(){return n++,n}return{getZIndex:t,setZIndex:e,getNextZIndex:i}}function bo(){return xt.getZIndex()}function To(){return xt.getNextZIndex()}const Xn="_table_g83er_1",Jn="_thead_g83er_21",Qn="_tbody_g83er_29",Kn="_index_g83er_45",ti="_cell_g83er_49",ei="_expand_g83er_53",ni="_expandBtn_g83er_57",ii="_expandActive_g83er_92",ri="_indent_g83er_102",si="_indentLast_g83er_128",L={table:Xn,thead:Jn,tbody:Qn,index:Kn,cell:ti,expand:ei,expandBtn:ni,expandActive:ii,indent:ri,indentLast:si};function oi(n){return{name:"$index",title:"#",width:n.width??48}}function ai(n){return{name:"$expand",width:n.width??36}}function ci(n){return{...n,title:n.title??n.name,width:n.width??80}}const wo=H({emits:["select"],props:{columns:{type:Array,required:!0},data:{type:Array,default(){return[]}}},setup(n,{emit:t}){const e=J(()=>n.columns.map(f=>f.name==="$index"?oi(f):f.name==="$expand"?ai(f):ci(f)));function i(f,E){f.stopPropagation(),E.$expand=E.$expand!==!0}function r(f){if(f.children==null||f.children.length==0)return;const E={[L.expandBtn]:!0,[L.expandActive]:f.$expand===!0};return h("div",{class:L.expand},[h("button",{type:"button",onClick:v=>i(v,f),class:E},null)])}function s(f){const E={[L.indent]:!0,[L.indentLast]:f.isLastChildren};return h("div",{class:E},null)}function o(f,E,v){if(typeof E.render=="function")return E.render(f,E,v);if(E.name=="$index")return h("div",{class:L.cell},[v.rowIndex+1]);if(E.name=="$expand")return v.isChildren?s(v):r(f);const S=E.formatter?E.formatter(f,E):f[E.name];return h("div",{class:L.cell},[S])}function u(f,E){const v=e.value.map(S=>h("td",{class:m(S)},[o(f,S,E)]));return h("tr",{onClick:C.bind(null,f,E)},[v])}function p(f){return{[L.index]:f.name==="$index"}}function m(f){return{[L.index]:f.name==="$index"}}function w(){let f=0;const E=n.data.reduce((v,S)=>{if(v.push(u(S,{rowIndex:f++,classes:L})),S.children&&S.children.length>0&&S.$expand===!0){const Dt=S.children.map((zt,Bt)=>u(zt,{rowIndex:f++,classes:L,isChildren:!0,isLastChildren:Bt===S.children.length-1,parent:S}));return v.concat(Dt)}return v},[]);return h("tbody",null,[E])}function I(){const f=e.value.map(E=>h("col",{width:E.width},null));return h("colgroup",null,[f])}function R(){const f=e.value.map(E=>h("th",{class:p(E)},[h("div",{class:L.cell},[E.title])]));return h("thead",null,[h("tr",null,[f])])}function C(f,E){t("select",f,E==null?void 0:E.parent)}return function(){return h("div",{class:L.table},[h("div",{class:L.thead},[h("table",null,[I(),R()])]),h("div",{class:L.tbody},[h("table",null,[I(),w()])])])}}}),Vt=4,vt="http://www.w3.org/2000/svg",Gt="@quickprint-contextmenu-handler";let D=null;function te(n){return typeof n.disabled=="function"?n.disabled(n)===!0:typeof n.disabled=="boolean"?n.disabled===!0:!1}function ui(n){typeof n.handler=="function"&&n.handler(n)}function li(){const n=document.createElement("div");return n.className="quickprint-contextmenu-divider",n}function _e(n){if(n==null||n==""){const i=document.createElement("div");return i.className="quickprint-contextmenu-icon",i}const t=document.createElementNS(vt,"svg"),e=document.createElementNS(vt,"use");return e.setAttribute("href","#"+n),t.setAttribute("class","quickprint-contextmenu-icon"),t.appendChild(e),t}function di(){const n=document.createElementNS(vt,"svg"),t=document.createElementNS(vt,"use");return t.setAttribute("href","#icon-right"),n.setAttribute("class","quickprint-contextmenu-arrow"),n.appendChild(t),n}function Pe(n,t){if(te(n)||n.type==="menu"&&n.submenu&&n.submenu.length>0)return;const e=function(i){i.stopPropagation(),t.removeEventListener("click",e),ui(n),ut()};t.addEventListener("click",e),Reflect.set(t,Gt,e)}function hi(n){const t=document.createElement("button");return t.type="button",t.title=n.label,t.className="quickprint-text-btn",t.appendChild(_e(n.icon)),te(n)&&t.classList.add("quickprint-contextmenu-disabled"),Pe(n,t),t}function De(n){const t=document.createElement("div");t.className="quickprint-contextmenu-menu";const e=document.createElement("div"),i=te(n),r=_e(n.icon),s=document.createElement("div");if(s.textContent=n.label,s.className="quickprint-contextmenu-label",e.className="quickprint-contextmenu-item",e.append(r,s),n.detail){const u=document.createElement("div");u.textContent=n.detail,u.className="quickprint-contextmenu-detail",e.appendChild(u)}i&&e.classList.add("quickprint-contextmenu-disabled"),Pe(n,e),t.appendChild(e);const o=Array.isArray(n.submenu)&&n.submenu.length>0;if(o&&!i){const u=document.createElement("div");u.className="quickprint-contextmenu-submenu";for(const p of n.submenu){const m=De(p);u.appendChild(m)}t.appendChild(u)}return o&&e.appendChild(di()),t}function fi(n,t){const e=document.createElement("div");if(e.id=n,e.className="quickprint-contextmenu",e.addEventListener("mouseover",me),Array.isArray(t.top)&&t.top.length>0){const r=document.createElement("div");r.className="quickprint-contextmenu-top";for(const s of t.top){const o=hi(s);r.appendChild(o)}e.appendChild(r)}const i=t.menus??[];for(const r of i){const s=r.type==="divider"?li():De(r);e.append(s)}return document.body.appendChild(e),{id:n,element:e,cleanup(){const r=[...e.querySelectorAll(".quickprint-contextmenu-item"),...e.querySelectorAll(".quickprint-contextmenu-top > button.quickprint-text-btn")];for(const s of r){const o=Reflect.get(s,Gt);typeof o=="function"&&(s.removeEventListener("click",o),Reflect.deleteProperty(s,Gt))}e.removeEventListener("mouseover",me),document.body.removeChild(e)}}}function ut(){D!=null&&(D.cleanup(),D=null)}function pi(n,t,e){ut();const i=St(Ct.CONTEXTMENU);return D=fi(i,e),xe().then(()=>{if(D==null)return;const r=D.element,s=r.offsetWidth,o=r.offsetHeight;let u=t,p=n;u+o>window.innerHeight&&(u=window.innerHeight-o-Vt),p+s>window.innerWidth&&(p=window.innerWidth-s-Vt),r.style.top=u+"px",r.style.left=p+"px",r.classList.add("quickprint-contextmenu-open")}),{id:i,close:ut}}function gi(n){if(D!=null&&n.target instanceof Node){if(D.element.contains(n.target))return n.preventDefault();ut()}}function Ei(n){D!=null&&n.target instanceof Node&&(D.element.contains(n.target)||ut())}function me(n){if(n.stopPropagation(),D==null)return;const t=D.element.querySelector(".quickprint-contextmenu-expand");t&&!t.contains(n.target)&&mi(t);const e=n.target.closest(".quickprint-contextmenu-item");if(e==null||e.matches(".quickprint-contextmenu-disabled"))return;const i=e.closest(".quickprint-contextmenu-menu");i!=null&&bi(i)}function mi(n){n.classList.remove("quickprint-contextmenu-expand"),n.classList.remove("quickprint-contextmenu-visible")}function bi(n){if(n.matches(".quickprint-contextmenu-expand"))return;const t=n.querySelector(".quickprint-contextmenu-submenu");t!=null&&(n.classList.add("quickprint-contextmenu-expand"),xe().then(()=>{const e=t.getBoundingClientRect(),i=n.getBoundingClientRect();let r=-4,s=i.width;i.top+e.height>window.innerHeight&&(r=window.innerHeight-e.height-Vt-i.top),i.right+e.width>window.innerWidth&&(s=-e.width),t.style.top=r+"px",t.style.left=s+"px",n.classList.add("quickprint-contextmenu-visible")}))}window.addEventListener("contextmenu",gi,!0);window.addEventListener("click",Ei,!0);const Ro={open:pi,close:ut},Ti=H({__name:"Loading",setup(n){return(t,e)=>(Lt(),It("div",{class:Et(t.classes.loading)},[h(jt,{icon:"icon-loading"}),e[0]||(e[0]=ot("span",null,"正在加载中...",-1))],2))}}),wi="_loading_n57p9_2",Ri={loading:wi,"loading-rotate":"_loading-rotate_n57p9_1"},Oi={classes:Ri},Ni=Kt(Ti,[["__cssModules",Oi]]);function Oo(n){}function No(n){return nn({loader:n,loadingComponent:Ni})}if(document.getElementById("quickprint-icon")==null){const n=document.createElement("script");n.id="quickprint-icon",n.src="//at.alicdn.com/t/c/font_4643940_gg8mtul3qqg.js",document.head.appendChild(n)}const l=Object.freeze({NULL:0,UNDEFINED:1,STRING:2,NUMBER:3,BOOLEAN:4,BIGINT:5,TEMPLATE:6,VARIABLE:11,REFERENCE:12,FUNCTION:13,OPERATOR:14}),a=Object.freeze({Group:8648,Plus:43,Minus:45,Asterisk:42,Slash:47,Percent:37,Power:94,Nullish:8658,Eq:61,Equal:10869,NotEqual:8800,Lt:60,Lte:10877,Gt:62,Gte:10878,And:38,Or:124,Not:33,LogicalAnd:10837,LogicalOr:8214,LogicalNot:33,OpenBracket:40,CloseBracket:41,LeftSquare:91,RightSquare:93,Comma:44,Question:63,Colon:58,At:64,SingleQuote:39,DoubleQuote:34,Zero:48,One:49,Two:50,Three:51,Four:52,Five:53,Six:54,Seven:55,Eight:56,Nine:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,f:102,n:110,t:116,u:117,Tab:9,NewLine:10,FormFeed:12,CarriageReturn:13,Space:32,Backslash:92,NumberSign:35,Semi:59,Dot:46}),Mt={Group:19,Function:18,Negative:15,[a.OpenBracket]:19,[a.CloseBracket]:19,[a.LogicalNot]:15,[a.Power]:14,[a.Asterisk]:13,[a.Slash]:13,[a.Plus]:12,[a.Minus]:12,[a.Lt]:10,[a.Lte]:10,[a.Gt]:10,[a.Gte]:10,[a.Equal]:9,[a.NotEqual]:9,[a.LogicalAnd]:5,[a.LogicalOr]:4,[a.Nullish]:4,[a.Question]:3,[a.Colon]:3},M=Object.freeze({EXPRESSION:0,OPERATOR:1,FUNCTION:2,TERNARY_TRUE:3,TERNARY_FALSE:4});function ze(n){switch(n){case l.NULL:return"Null";case l.UNDEFINED:return"Undefined";case l.STRING:return"String";case l.NUMBER:return"Number";case l.BOOLEAN:return"Boolean";case l.VARIABLE:return"Variable";case l.FUNCTION:return"Function";case l.OPERATOR:return"Operator";default:return"Unknown"}}function Be(n){switch(n){case a.Equal:return"==";case a.NotEqual:return"!=";case a.Lte:return"<=";case a.Gte:return">=";case a.LogicalAnd:return"&&";case a.LogicalOr:return"||";case a.Power:return"**";case a.Nullish:return"??";case a.Group:return"()";default:return String.fromCharCode(n)}}function He(n){switch(n.type){case l.OPERATOR:return Be(n.value);case l.NULL:return"null";case l.UNDEFINED:return"undefined";default:return n.value}}function Ai(n){return{type:ze(n.type),value:He(n)}}function Zt(n){return Reflect.get(Mt,n)??0}function yi(n){switch(n.type){case l.FUNCTION:return Mt.Function;case l.OPERATOR:return Zt(n.value);default:return 0}}function y(n,t){const e=new Error(`Invalid ${n} at position ${t}`);return Reflect.set(e,"__err_index__",t),e}function xi(n){return/^-?(?:0|[1-9]\d*)(?:\.\d+)?$/.test(n)}function vi(n,t){switch(n){case l.NULL:return null;case l.UNDEFINED:return;case l.NUMBER:return t==="NaN"?Number.NaN:Number(t);case l.BOOLEAN:return t==="true";case l.REFERENCE:return t.charCodeAt(0)===a.LeftSquare?t.slice(2,-1):t;case l.VARIABLE:return t.charCodeAt(0)===a.LeftSquare?t.slice(1,-1):t;case l.TEMPLATE:return t;default:return t}}function A(n,t,e,i){return{type:n,value:vi(n,t),start:e,end:i??e+t.length-1,precedence:yi({type:n,value:t})}}function Ii(n,t,e){const i=n.indexOf(String.fromCharCode(e),t+1);if(i===-1)throw y("string",t);const r=n.slice(t+1,i),s=r.split(/(\[[0-2]\.[0-6](?:\.[^.]+)?\.[^.]+\])/);if(s.length==0)throw y("string",t);if(s.length==1)return{start:t,end:i,value:A(l.STRING,r,t)};let o=t+1;const u=s.reduce((m,w)=>{if(w=="")return m;const I=A(w.charCodeAt(0)===a.LeftSquare?l.VARIABLE:l.STRING,w,o);return o=I.end+1,m.push(I),m},[]),p=A(l.TEMPLATE,u,t,i);return{start:t,end:i,value:p}}function Li(n,t){const e=n.slice(t).match(/^([\.\d]+)\D?/);if(e==null)throw y("number",t);const i=e[1];if(!xi(i))throw y("number",t);const r=A(l.NUMBER,i,t);return{start:t,end:r.end,value:r}}function Si(n,t){const e=n.slice(t).match(/^(\[=\w+\])/);if(e==null)throw y("reference",t);const i=A(l.REFERENCE,e[1],t);return{start:t,end:i.end,value:i}}function Ci(n,t){const e=n.charCodeAt(t+1);if(e!==a.Zero&&e!==a.One&&e!==a.Two)throw y("variable",t);const i=n.slice(t).match(/^(\[[0-2]\.[0-6](?:\.[^.]+)?\.[^.]+\])/);if(i==null)throw y("variable",t);const r=A(l.VARIABLE,i[1],t);return{start:t,end:r.end,value:r}}function Mi(n,t){const e=n.slice(t).match(/^([A-Z_]+)/);if(e==null)throw y("function",t);const i=A(l.FUNCTION,e[1],t);return{start:t,end:i.end,value:i}}function _i(n,t){const e=n.slice(t).match(/^(true|false)/);if(e==null)throw y("boolean",t);const i=A(l.BOOLEAN,e[1],t);return{start:t,end:i.end,value:i}}function Pi(n,t){const e=n.slice(t).match(/^(null|undefined)/);if(e==null)throw y("input",t);const i=e[1],r=i==="null"?l.NULL:l.UNDEFINED,s=A(r,i,t);return{start:t,end:s.end,value:s}}function ke(n){const t=[];let e=0;for(;e<n.length;){const i=n.charCodeAt(e);switch(i){case a.SingleQuote:case a.DoubleQuote:{const r=Ii(n,e,i);t.push(r.value),e=r.end+1;break}case a.Zero:case a.One:case a.Two:case a.Three:case a.Four:case a.Five:case a.Six:case a.Seven:case a.Eight:case a.Nine:{const r=Li(n,e);t.push(r.value),e=r.end+1;break}case a.t:case a.f:{const r=_i(n,e);t.push(r.value),e=r.end+1;break}case a.n:case a.u:{const r=Pi(n,e);t.push(r.value),e=r.end+1;break}case a.LeftSquare:{if(n.charCodeAt(e+1)===a.Eq){const s=Si(n,e);t.push(s.value),e=s.end+1;break}const r=Ci(n,e);t.push(r.value),e=r.end+1;break}case a.A:case a.B:case a.C:case a.D:case a.E:case a.F:case a.G:case a.H:case a.I:case a.J:case a.K:case a.L:case a.M:case a.N:case a.O:case a.P:case a.Q:case a.R:case a.S:case a.T:case a.U:case a.V:case a.W:case a.X:case a.Y:case a.Z:{const r=Mi(n,e);t.push(r.value),e=r.end+1;break}case a.Lt:{const r=n.charCodeAt(e+1),s=r===a.Eq?2:1,o=r===a.Eq?a.Lte:a.Lt,u=A(l.OPERATOR,o,e,e+s-1);t.push(u),e+=s;break}case a.Gt:{const r=n.charCodeAt(e+1),s=r===a.Eq?2:1,o=r===a.Eq?a.Gte:a.Gt,u=A(l.OPERATOR,o,e,e+s-1);t.push(u),e+=s;break}case a.Eq:{const r=n.charCodeAt(e+1)===a.Eq?2:1,s=A(l.OPERATOR,a.Equal,e,e+r-1);t.push(s),e+=r;break}case a.Not:{const r=n.charCodeAt(e+1),s=r===a.Eq?2:1,o=r===a.Eq?a.NotEqual:a.LogicalNot,u=A(l.OPERATOR,o,e,e+s-1);t.push(u),e+=s;break}case a.And:{const r=n.charCodeAt(e+1)===a.And?2:1,s=A(l.OPERATOR,a.LogicalAnd,e,e+r-1);t.push(s),e+=r;break}case a.Or:{const r=n.charCodeAt(e+1)===a.Or?2:1,s=A(l.OPERATOR,a.LogicalOr,e,e+r-1);t.push(s),e+=r;break}case a.Asterisk:{const r=n.charCodeAt(e+1),s=r===a.Asterisk?2:1,o=r===a.Asterisk?a.Power:a.Asterisk,u=A(l.OPERATOR,o,e,e+s-1);t.push(u),e+=s;break}case a.Question:{const r=n.charCodeAt(e+1),s=r===a.Question?2:1,o=r===a.Question?a.Nullish:a.Question,u=A(l.OPERATOR,o,e,e+s-1);t.push(u),e+=s;break}case a.Plus:case a.Slash:case a.Minus:case a.OpenBracket:case a.CloseBracket:case a.Comma:case a.Percent:case a.Colon:{const r=A(l.OPERATOR,i,e,e);t.push(r),e++;break}default:{if(!/^\s$/.test(n[e]))throw new Error("Unexpected error at position "+e);e++}}}return t}class U{constructor(t){c(this,"type");c(this,"value");c(this,"start");c(this,"end");c(this,"precedence");c(this,"result");c(this,"left");c(this,"right");c(this,"condition");c(this,"children");this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,this.precedence=t.precedence}static appendNode(t,e){if(t==null)return e;if(!t.isOperator&&!e.isOperator)throw y("input",e.start);if(!t.isOperator&&e.isOperator)return e.appendLeft(t),e;if(t.isOperator&&!e.isOperator)return t.appendRight(e),t;const i=t.precedence??-1;return(e.precedence??-1)<=i?t.isLogicalNot&&e.isLogicalNot?(t.appendRight(e),t):(e.appendLeft(t),e):(t.right&&(e.appendLeft(t.right),t.right=void 0),t.appendRight(e),t)}static createGroupNode(t,e){return new U({type:l.OPERATOR,value:a.Group,start:t,end:e,precedence:Mt.Group})}get isOperator(){return this.type===l.OPERATOR}get isMinus(){return this.type===l.OPERATOR&&this.value===a.Minus}get isOpenBracket(){return this.type===l.OPERATOR&&this.value===a.OpenBracket}get isCloseBracket(){return this.type===l.OPERATOR&&this.value===a.CloseBracket}get isLogicalNot(){return this.type===l.OPERATOR&&this.value===a.LogicalNot}get isFunction(){return this.type===l.FUNCTION}get isComma(){return this.type===l.OPERATOR&&this.value===a.Comma}get isQuestion(){return this.type===l.OPERATOR&&this.value===a.Question}get isColon(){return this.type===l.OPERATOR&&this.value===a.Colon}get isGroup(){return this.isOperator&&this.value===a.Group}get isPrimitive(){switch(this.type){case l.FUNCTION:case l.OPERATOR:return!1;default:return!0}}appendLeft(t){this.left=t,this.start=t.start}appendRight(t){this.right=t,this.end=t.end}appendChild(t){this.children==null&&(this.children=[]),this.children.push(t)}}function Di(n){switch(n.type){case l.FUNCTION:case l.VARIABLE:case l.REFERENCE:case l.NUMBER:return!0;case l.OPERATOR:return n.value===a.Group;default:return!1}}function Y(n,t){let e,i=(t==null?void 0:t.start)??0;for(;i<n.length;){const r=new U(n[i]);if((t==null?void 0:t.mode)===M.EXPRESSION&&e){if(r.isCloseBracket)return{root:e,start:t.start,end:i-1};const s=t.precedence??0;if((r.precedence??0)<=s)return{root:e,start:t.start,end:i-1}}if((t==null?void 0:t.mode)===M.OPERATOR&&r.isOperator&&r.value===t.expect){if(e==null)throw y("input",r.start);return{root:e,start:t.start,end:i}}if((t==null?void 0:t.mode)===M.FUNCTION&&r.isComma){if(t.function==null)throw y("input",r.start);t.function.appendChild(e),e=void 0,i++;continue}if((t==null?void 0:t.mode)===M.FUNCTION&&r.isCloseBracket){if(t.function==null)throw y("input",r.start);return e&&t.function.appendChild(e),{root:t.function,start:t.start,end:i}}if((t==null?void 0:t.mode)===M.TERNARY_TRUE&&r.isColon){if(e==null)throw y("input",r.start);return{root:e,start:t.start,end:i-1}}if((t==null?void 0:t.mode)===M.TERNARY_FALSE&&e){if(r.isColon||r.isCloseBracket||r.isComma)return{root:e,start:t.start,end:i-1};const s=t.precedence??0;if((r.precedence??0)<=s)return{root:e,start:t.start,end:i-1}}if(r.isOpenBracket){const s=Y(n,{start:i+1,expect:a.CloseBracket,mode:M.OPERATOR}),o=U.createGroupNode(i,s.end);o.appendRight(s.root),e=U.appendNode(e,o),i=s.end+1;continue}if(r.isMinus&&(e==null||e.isOperator)){const s=Y(n,{start:i+1,expect:null,mode:M.EXPRESSION,precedence:Mt.Negative});if(Di(s.root)){r.appendRight(s.root),e=U.appendNode(e,r),i=s.end+1;continue}}if(r.isLogicalNot){const s=Y(n,{start:i+1,expect:null,mode:M.EXPRESSION,precedence:a.LogicalNot});r.appendRight(s.root),e=U.appendNode(e,r),i=s.end+1;continue}if(r.isFunction){const s=n[i+1];if(s==null||s.type!==l.OPERATOR||s.value!==a.OpenBracket)throw y("input",i);const o=Y(n,{start:i+2,expect:a.CloseBracket,mode:M.FUNCTION,function:r});r.end=o.end,e=U.appendNode(e,r),i=o.end+1;continue}if(r.isQuestion){const s=Y(n,{start:i+1,expect:a.Colon,mode:M.TERNARY_TRUE,precedence:Zt(a.Question)}),o=Y(n,{start:s.end+2,mode:M.TERNARY_FALSE,expect:null,precedence:Zt(a.Colon)});r.appendLeft(s.root),r.appendRight(o.root),r.condition=e,r.start=(e==null?void 0:e.start)??0,e=r,i=o.end+1;continue}if(r.isOperator){if(e==null)throw y("input",r.start);if(r.isMinus){const o=n[i+1];if(o&&o.type===l.OPERATOR&&o.value===a.Minus)throw y("input",r.start)}const s=Y(n,{start:i+1,mode:M.EXPRESSION,expect:null,precedence:r.precedence??0});r.appendLeft(e),r.appendRight(s.root),e=r,i=s.end+1;continue}e=U.appendNode(e,r),i++}if(e==null)throw new Error("Uncaught SyntaxError");return{root:e,start:0,end:n.length-1}}const $t=new Map;function zi(n){const t=ke(n),e=Y(t),i=[],r=[];for(const o of t){if(o.type===l.REFERENCE){r.push(o);continue}if(o.type===l.VARIABLE){i.push(o);continue}if(o.type===l.TEMPLATE){const u=Array.isArray(o.value)?o.value:[o.value];for(const p of u)if(p.type===l.VARIABLE){i.push(p);continue}}}const s={root:e.root,tokens:t,variable:i,reference:r};return $t.set(n,s),s}function Bi(n){const t=$t.get(n);if(t)return t;const e=zi(n);return $t.set(n,e),e}function Hi(n,t){if(!(t instanceof Error))return console.log(t);console.error(t)}const Ao={tokenize:ke,parse:Y,compile:Bi,formatOperator:Be,formatToken:Ai,formatTokenType:ze,formatTokenValue:He,debug:Hi},ki="modulepreload",Wi=function(n){return"/"+n},be={},Te=function(t,e,i){let r=Promise.resolve();if(e&&e.length>0){let o=function(m){return Promise.all(m.map(w=>Promise.resolve(w).then(I=>({status:"fulfilled",value:I}),I=>({status:"rejected",reason:I}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),p=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));r=o(e.map(m=>{if(m=Wi(m),m in be)return;be[m]=!0;const w=m.endsWith(".css"),I=w?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${m}"]${I}`))return;const R=document.createElement("link");if(R.rel=w?"stylesheet":ki,w||(R.as="script"),R.crossOrigin="",R.href=m,p&&R.setAttribute("nonce",p),document.head.appendChild(R),w)return new Promise((C,f)=>{R.addEventListener("load",C),R.addEventListener("error",()=>f(new Error(`Unable to preload CSS for ${m}`)))})}))}function s(o){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=o,window.dispatchEvent(u),!u.defaultPrevented)throw o}return r.then(o=>{for(const u of o||[])u.status==="rejected"&&s(u.reason);return t().catch(s)})};/**
* @dongls/xwindow v0.3.12
* (c) 2023-present dongls
* @license MIT
**/const Fi="0.3.12",We=Symbol(),Ui=Math.floor(Number.MAX_SAFE_INTEGER/10)-1e4,_=Object.freeze({WINDOW:"xwindow",SIMPLE_WINDOW:"xindow-is-simplewindow",TRANSITION:"xwindow-is-transition",MENU:"xwindow-is-menu",SIMPLE_WINDOW_MENU:"xwindow-is-simplewindow-menu",FOCUSED:"xwindow-is-focused",MAXIMIZE:"xwindow-is-maximize",HEADER:"xwindow-header",BODY:"xwindow-body"}),N=Object.freeze({NONE:0,TOP:1,BOTTOM:2,LEFT:4,RIGHT:8}),V=Object.freeze({TOP:N.TOP,BOTTOM:N.BOTTOM,LEFT:N.LEFT,RIGHT:N.RIGHT,TOP_LEFT:N.TOP|N.LEFT,TOP_RIGHT:N.TOP|N.RIGHT,BOTTOM_LEFT:N.BOTTOM|N.LEFT,BOTTOM_RIGHT:N.BOTTOM|N.RIGHT}),q=Object.freeze({NONE:N.NONE,MAXIMIZE:N.TOP}),rt=Object.freeze({DISABLED:0,RESIZE:1,RESIZE_ONLY:2}),ht=Object.freeze({INIT:0,MOUNTED:1,UNMOUNTED:2}),j=Object.freeze({SIMPLE_WINDOW:"SimpleWindow",BLANK_WINDOW:"BlankWindow",TABS_WINDOW:"TabsWindow"}),k=Object.freeze({CLOSE:0,MAXIMIZE:1,RESTORE:2,PIN:3,UNPIN:4}),lt={},T=Vi();let _t;function Yi(){const n=Jt(1e3);function t(){return n.value}function e(r){n.value=r}function i(){return n.value++,n.value}return{getZIndex:t,setZIndex:e,getNextZIndex:i}}function qi(n){lt.draggaleHeight=(n==null?void 0:n.draggaleHeight)??32,lt.presets=(n==null?void 0:n.presets)??{},_t=(n==null?void 0:n.zIndex)??Yi()}function ji(){return rn(We)}function Vi(){return{appContext:null,isMounted:!1,stack:new Map,ids:Jt([]),topWindow:null}}function Gi(){return _t.getZIndex()}function Zi(){return _t.getNextZIndex()}function $i(n,t){lt.presets[n]=t}function Xi(n){n&&(_t=n)}class ee{constructor(t,e,i){c(this,"type");c(this,"stopped",!1);c(this,"defaultPrevented",!1);c(this,"instance");c(this,"detail");this.type=t,this.instance=e,this.detail=i}stop(){this.stopped=!0}preventDefault(){this.defaultPrevented=!0}}class Ji{constructor(){c(this,"__v_skip",!0);c(this,"ALL_EVENTS",new Map)}on(t,e){const i=this.ALL_EVENTS.get(t);return i==null?(this.ALL_EVENTS.set(t,[e]),this):i.includes(e)?this:(i.unshift(e),this)}once(t,e){const i=r=>{e(r),this.off(t,i)};return this.on(t,i),this}off(t,e){const i=this.ALL_EVENTS.get(t);if(i==null)return this;const r=i.indexOf(e);return r<0?this:(i.splice(r,1),this)}dispatch(t){const e=this.ALL_EVENTS.get(t.type);if(e==null)return t;for(let i=e.length-1;i>=0;i--){const r=e[i];if(typeof r=="function"&&r(t),t.stopped)break}return t}cleanup(){this.ALL_EVENTS.clear()}}class Qi{constructor(t,e){c(this,"moved",!1);c(this,"originalEvent");c(this,"target");c(this,"deltaX");c(this,"deltaY");c(this,"initialX");c(this,"initialY");c(this,"left",0);c(this,"top",0);c(this,"prevClientX");c(this,"prevClientY");const i=t.getBoundingClientRect();this.originalEvent=e,this.target=t,this.deltaX=Math.round(i.left-e.clientX),this.deltaY=Math.round(i.top-e.clientY),this.initialX=e.clientX,this.initialY=e.clientY,this.prevClientX=e.clientX,this.prevClientY=e.clientY}preventDragEvent(t){return!(this.moved||Math.abs(t.clientX-this.initialX)>4||Math.abs(t.clientY-this.initialY)>4)}createEvent(t,e){return new ee(t,e,this)}}class Ki{constructor(t){c(this,"window");c(this,"context");c(this,"onDragging");c(this,"onDragend");this.window=t}static isConflict(t,e){const i=t.getBoundingClientRect(),r=e.getBoundingClientRect();return!(i.top>r.bottom||i.right<r.left||i.bottom<r.top||i.left>r.right)}static findElementsFromPoint(t,e,i,r){return typeof document.elementsFromPoint!="function"?[]:document.elementsFromPoint(t,e).filter(s=>r!=null&&!r.contains(s)?!1:typeof i=="string"?s.matches(i):!1)}dragstart(t){if(t.button!==0)return;const e=t.target;if(e instanceof Element&&e.closest("."+_.MENU))return;const i=this.window.getElement();if(i==null)return;const r=i.getBoundingClientRect();t.clientY-r.top>this.window.allowDragArea||(t.preventDefault(),t.stopPropagation(),this.context=new Qi(i,t),this.context.left=this.window.state.offsetLeft,this.context.top=this.window.state.offsetTop,this.onDragging=this.dragging.bind(this),this.onDragend=this.dragend.bind(this),window.addEventListener("pointermove",this.onDragging),window.addEventListener("pointerup",this.onDragend))}dragging(t){if(this.context==null)return;const e=this.context;if(!e.moved){if(this.window.dispatch(this.context.createEvent("dragStart",this.window)).defaultPrevented)return this.cleanup();const s=this.window.useCssModule();s!=null&&s.dragging&&e.target.classList.add(s.dragging),e.target.setPointerCapture(t.pointerId),e.moved=!0}if(e.preventDragEvent(t))return;t.preventDefault(),t.stopPropagation(),e.originalEvent=t,e.left=Math.round(t.clientX+e.deltaX),e.top=Math.round(t.clientY+e.deltaY),e.prevClientX=t.clientX,e.prevClientY=t.clientY;const i=e.target;i.style.left=e.left+"px",i.style.top=e.top+"px";const r=this.context.createEvent("dragging",this.window);this.window.dispatch(r)}dragend(t){if(this.context==null||!this.context.moved)return this.cleanup();t.preventDefault(),t.stopPropagation();const e=this.context;e.originalEvent=t,e.target.releasePointerCapture(t.pointerId);const i=e.createEvent("dragEnd",this.window);this.window.dispatch(i),this.window.state.offsetTop=e.top,this.window.state.offsetLeft=e.left,this.cleanup()}cleanup(){var e;const t=this.window.useCssModule();t!=null&&t.dragging&&((e=this.context)==null||e.target.classList.remove(t.dragging)),this.onDragging&&window.removeEventListener("pointermove",this.onDragging),this.onDragend&&window.removeEventListener("pointerup",this.onDragend),this.onDragging=void 0,this.onDragend=void 0,this.context=void 0}}function tt(n,t,e){return t!=null&&Number.isFinite(t)&&n<t?t:n}function we(n){return n==null||typeof n!="string"?!0:n.length==0}function tr(n){return n==null||typeof n!="string"?!1:n.length!=0}function Nt(n){n.stopPropagation()}function er(...n){console.log("%c[xWindow]","color: green;",...n)}function nr(...n){console.log("%c[xWindow]","color: orange;",...n)}const Re={DEBUG:er,WARN:nr};function ir(n){const{deltaX:t,deltaY:e}=n,i=n.deltaMode==0?1:n.deltaMode==1?40:800;return{pixelX:t*i,pixelY:e*i}}const rr={top:"offsetTop",left:"offsetLeft",width:"offsetWidth",height:"offsetHeight"};class sr{constructor(t){c(this,"init",!1);c(this,"defaultPrevented",!1);c(this,"originalEvent");c(this,"target");c(this,"direction");this.originalEvent=t,this.target=t.target,this.direction=Reflect.get(this.target,Pt.PROP)}createEvent(t,e){return new ee(t,e,this)}}class Pt{constructor(t){c(this,"context");c(this,"window");c(this,"onResizing");c(this,"onResizeend");this.window=t}resizestart(t){t.stopPropagation(),t.preventDefault();const e=new sr(t);this.context=e,this.onResizing=this.resizing.bind(this),this.onResizeend=this.resizeend.bind(this),window.addEventListener("pointermove",this.onResizing),window.addEventListener("pointerup",this.onResizeend)}resizing(t){if(this.context==null)return;t.stopPropagation(),t.preventDefault();const e=this.context;if(!e.init){if(this.window.dispatch(this.context.createEvent("resizeStart",this.window)).defaultPrevented)return this.cleanup();e.target.setPointerCapture(t.pointerId),e.init=!0}const i=this.calcWindowState(t),r=this.window.getElement();for(const o in i){const u=Math.round(i[o]);Reflect.set(r.style,o,u+"px")}e.originalEvent=t;const s=this.context.createEvent("resizing",this.window);this.window.dispatch(s)}resizeend(t){if(this.context==null)return;t.stopPropagation(),t.preventDefault();const e=this.context;if(e.init){const i=e.createEvent("resizeEnd",this.window);this.window.dispatch(i),this.patchWindowState(this.calcWindowState(t)),e.target.releasePointerCapture(t.pointerId)}this.cleanup()}cleanup(){this.onResizing&&window.removeEventListener("pointermove",this.onResizing),this.onResizeend&&window.removeEventListener("pointerup",this.onResizeend),this.onResizing=void 0,this.onResizeend=void 0,this.context=void 0}calcWindowState(t){const e=this.context,i=this.window.options,r=typeof i.minWidth=="number"&&i.minWidth>=0?i.minWidth:360,s=typeof i.minHeight=="number"&&i.minHeight>=0?i.minHeight:32,o=this.window.getElement().getBoundingClientRect(),u={};return e.direction&N.TOP&&(u.height=tt(o.bottom-tt(t.clientY,0),s),u.top=o.bottom-u.height),e.direction&N.BOTTOM&&(u.height=tt(t.clientY-o.top,s)),e.direction&N.LEFT&&(u.width=tt(o.right-tt(t.clientX,0),r),u.left=o.right-u.width),e.direction&N.RIGHT&&(u.width=tt(t.clientX-o.left,r)),u}patchWindowState(t){const e=this.window.state;for(const i in t){const r=Math.round(t[i]),s=rr[i];s!=null&&Reflect.set(e,s,r)}}}c(Pt,"PROP","__xwindow_resize_prop__");const st=class st extends Ji{constructor(e){super();c(this,"CREATE_RESOLVE");c(this,"CREATE_REJECT");c(this,"id");c(this,"type");c(this,"options");c(this,"body");c(this,"state");c(this,"created",!1);c(this,"destroyed",!1);c(this,"component");c(this,"draggable");c(this,"resizable");c(this,"handles",{});c(this,"readyPromis");c(this,"dragstart");c(this,"resizestart");Reflect.defineProperty(this,"id",{enumerable:!0,configurable:!1,writable:!1,value:st.seed++});const{body:i,type:r,...s}=e;this.type=r??j.SIMPLE_WINDOW,this.options=Ft(this.createOptions(s)),this.body=i,this.initDraggable(),this.initResizable(),this.initHooks()}static create(e){return e instanceof st?e:new st(e)}get wid(){return"window--"+this.id}get isReady(){return this.created===!0}get allowDrag(){const e=this.options.draggable;return e===!1?!1:typeof e=="number"?e>0:!0}get allowDragArea(){const e=this.options.draggable;return typeof e=="number"&&e>0?e:lt.draggaleHeight}get isMaximize(){var e;return((e=this.state)==null?void 0:e.windowMode)===q.MAXIMIZE}get isFixedZIndex(){const e=this.options;return typeof e.zIndex=="number"&&e.zIndex>0}get zIndex(){if(this.isFixedZIndex)return this.options.zIndex;const e=this.state;return e==null?0:(e.pinned?Ui:0)+e.zIndex}createOptions(e){return{...e,title:e.title??"未命名的窗口",icon:e.icon,className:e.className,width:e.width??"640px",minWidth:e.minWidth??360,maxWidth:e.maxWidth,height:e.height,minHeight:e.minHeight??32,maxHeight:e.maxHeight,top:e.top,left:e.left,zIndex:e.zIndex,maximize:e.maximize===!0,teleport:e.teleport??"body",draggable:e.draggable==null?!0:e.draggable,resizeMode:e.resizeMode??rt.RESIZE,closeable:e.closeable!==!1,mask:e.mask===!0,pinnable:e.pinnable!==!1,displayAfterCreate:e.displayAfterCreate!==!1,destroyAfterClose:e.destroyAfterClose!==!1,closeOnPressEsc:e.closeOnPressEsc!==!1}}createEvent(e,i){return new ee(e,this,i)}initDraggable(){this.draggable=new Ki(this),this.dragstart=this.draggable.dragstart.bind(this.draggable)}initResizable(){this.resizable=new Pt(this),this.resizestart=this.resizable.resizestart.bind(this.resizable)}initHooks(){this.once("created",()=>{this.created=!0,typeof this.CREATE_RESOLVE=="function"&&this.CREATE_RESOLVE(),delete this.CREATE_REJECT,delete this.CREATE_RESOLVE,delete this.readyPromis})}ready(){return this.created===!0?Promise.resolve():this.readyPromis?this.readyPromis:(this.readyPromis=new Promise((e,i)=>{this.CREATE_RESOLVE=e,this.CREATE_REJECT=i}),this.readyPromis)}show(){this.state==null||this.dispatch(this.createEvent("beforeShow")).defaultPrevented||(this.state.visible=!0)}close(e=!1){if(this.state==null||this.options.closeable===!1&&e!==!0)return!1;const i=this.dispatch(this.createEvent("beforeClose"));return e!==!0&&i.defaultPrevented?!1:(this.state.visible=!1,this.dispatch(this.createEvent("close")),this.state.focused&&setTimeout(Rs),!this.destroyed&&this.options.destroyAfterClose!==!1&&this.destroy(),!0)}cleanup(){super.cleanup(),this.dragstart=void 0,this.resizestart=void 0,this.component=void 0,this.state=void 0,this.handles={}}destroy(){var e;this.destroyed=!0,((e=this.state)==null?void 0:e.visible)===!0&&this.close(),this.dispatch(this.createEvent("beforeDestroy")),fs(this.id),setTimeout(()=>this.cleanup(),100)}getElement(){var e;return(e=this.component)==null?void 0:e.getElement()}useMenus(){var e;return((e=this.component)==null?void 0:e.useMenus())??[]}useCssModule(){var e;return((e=this.component)==null?void 0:e.useCssModule())??{}}focus(){this.state==null||this.state.focused||ws(this.id)}startTransition(){const e=document.documentElement,i=function(r){r.target.matches("."+_.WINDOW)&&(e.classList.remove(_.TRANSITION),e.removeEventListener("transitionend",i))};e.classList.add(_.TRANSITION),e.addEventListener("transitionend",i)}requestMaximize(){const e=this.state;e==null||this.options.resizeMode!==rt.RESIZE||(e.windowMode=q.MAXIMIZE,this.startTransition(),this.dispatch(this.createEvent("maximizeChange")))}exitMaximize(){const e=this.state;e==null||this.options.resizeMode!==rt.RESIZE||(e.windowMode=q.NONE,this.startTransition(),this.dispatch(this.createEvent("maximizeChange")))}toggleMaximize(){const e=this.state;e==null||this.options.resizeMode!==rt.RESIZE||(e.windowMode===q.MAXIMIZE?this.exitMaximize():this.requestMaximize())}pin(){const e=this.state;e!=null&&(e.pinned=!0)}unpin(){const e=this.state;e!=null&&(e.pinned=!1)}togglePin(){const e=this.state;e!=null&&(e.pinned?this.unpin():this.pin())}useHandle(e,i){this.handles[e]=i}async callHandle(e){const i=this.handles[e];if(typeof i=="function")return await i()}dispatchConfirm(){return this.callHandle("confirm").then(e=>this.confirm(e))}confirm(e){this.dispatch(this.createEvent("confirm",e)),this.close(!0)}dispatchCancel(){return this.callHandle("cancel").then(e=>this.cancel(!0,e))}cancel(e=!0,i){this.close(e)&&this.dispatch(this.createEvent("cancel",i))}promisify(){return new Promise((e,i)=>{this.once("confirm",r=>e(r.detail)),this.once("cancel",r=>i(r.detail))})}showLoading(e){var i;(i=this.component)==null||i.showLoading(e)}hideLoading(){var e;(e=this.component)==null||e.hideLoading()}};c(st,"seed",1e3);let $=st;class Tt extends ${static create(t){return t instanceof Tt?t:new Tt(t)}constructor(t){super(t)}updateMenus(t){this.options.menus=t}}class wt extends ${static create(t){return t instanceof wt?t:new wt(t)}constructor(t){super(t),Array.isArray(this.options.tabs)||(this.options.tabs=[])}addTab(t,e){const i=this.options.tabs;if(typeof e=="number"&&e>=0){i.splice(e,0,t);return}i.push(t)}removeTab(t){this.options.tabs=this.options.tabs.filter(e=>e.name!==t)}switchTab(t){const e=this.options.tabs.find(i=>i.name===t);if(!(e==null||e.disabled===!0))for(const i of this.options.tabs){if(i.disabled===!0){i.active=!1;continue}i.active=i.name===t}}disableTab(t){const e=this.options.tabs.find(i=>i.name===t);e!=null&&(e.disabled=!0)}enableTab(t){const e=this.options.tabs.find(i=>i.name===t);e!=null&&(e.disabled=!1)}}const or="_1VK7aP6Q",ar="NVNs1c77",cr="_6YdNLaat",ur="_2CnbRoMJ",lr="zA2SqXcr",dr="_9aEaFNkh",hr="vZWb6Qkb",fr="iLHsNYpe xwindow-is-menu",pr="N7MFTyEe",gr="uva6XuQT",Er="qoDFBdfs",mr="DBu6bn4U",br="UemRcQUk",Tr="cVGxhGiz",wr="wMNZtQy7",Rr="fzRsy8Zk iLHsNYpe xwindow-is-menu",Or="omADR9yA iLHsNYpe xwindow-is-menu",Nr="BNHRemDj",Ar="Qe5vFNec BNHRemDj",yr="uznknYWJ BNHRemDj",xr="DBccUnAy BNHRemDj",vr="V9cjA8EU BNHRemDj",Ir="dWwPKrwA BNHRemDj",Lr="_63ZYzjpc BNHRemDj",Sr="qBuPDFpV BNHRemDj",Cr="_2G4YhoPB BNHRemDj",Mr="fuN6xzuM",_r="crvWM9VP",Pr="zpqhzNYo",Dr="_8AD13SKa",zr="_6KHoWN2k",Br="pcaqYgBy",Hr="efQetSTC",kr="kuJMFhpr",Wr="jE8V5gCe",Fr="hFkm7TBq",Ur="ifbvf59W",Yr="rxdUa2oY",qr="ijgxF5xE",g={window:or,dragging:ar,resizing:cr,maximize:ur,focused:lr,header:dr,tabsHeader:hr,menu:fr,logo:pr,main:gr,init:Er,title:mr,menus:br,body:Tr,footer:wr,closeMenu:Rr,pinMenu:Or,resizeBar:Nr,resizeTop:Ar,resizeBottom:yr,resizeRight:xr,resizeLeft:vr,resizeTopLeft:Ir,resizeBottomLeft:Lr,resizeTopRight:Sr,resizeBottomRight:Cr,mask:Mr,simpleWindow:_r,simpleWindowHeaderMenu:Pr,loading:Dr,loader:zr,loaderAnimation:Br,tabsWindow:Hr,tabsTitle:kr,tabsMain:Wr,tabs:Fr,tab:Ur,disabled:Yr,active:qr},ne=H({name:"WindowBody",props:{wid:String,body:{type:[Object,Function,String,Number],default:null},params:{type:Array,default(){return[]}}},setup(n){const t=ji();return function(){if(t==null)return Re.WARN(`窗体实例(${n.wid})不存在`),null;const e=typeof n.body=="function"?n.body(t,...n.params):n.body;return e==null&&Re.WARN("请指定窗体内容:",t.options.title),e}}});function jr(n){return typeof n=="function"||Object.prototype.toString.call(n)==="[object Object]"&&!Ae(n)}const Vr=[[g.resizeTop,V.TOP],[g.resizeBottom,V.BOTTOM],[g.resizeLeft,V.LEFT],[g.resizeRight,V.RIGHT],[g.resizeTopLeft,V.TOP_LEFT],[g.resizeTopRight,V.TOP_RIGHT],[g.resizeBottomLeft,V.BOTTOM_LEFT],[g.resizeBottomRight,V.BOTTOM_RIGHT]],ie=H({name:j.BLANK_WINDOW,props:{instance:{type:$,required:!0}},setup(n,{slots:t}){const e=Jt(ht.INIT),i=sn(),r=Ft({visible:!1,offsetWidth:0,offsetHeight:0,offsetTop:0,offsetLeft:0,focused:!1,pinned:!1,zIndex:0,windowMode:q.NONE}),s=Ft({show:!1}),o=J(()=>{const d=n.instance.options;return e.value==ht.INIT?{width:d.width,height:d.height,left:d.left,top:d.top,minWidth:d.minWidth?d.minWidth+"px":void 0,minHeight:d.minHeight?d.minHeight+"px":void 0}:{top:r.offsetTop+"px",left:r.offsetLeft+"px",width:r.offsetWidth+"px",height:r.offsetHeight+"px",minWidth:d.minWidth?d.minWidth+"px":void 0,minHeight:d.minHeight?d.minHeight+"px":void 0,zIndex:d.mask?void 0:n.instance.zIndex}}),u=J(()=>{const d=[_.WINDOW,g.window],b=n.instance;return b.type===j.SIMPLE_WINDOW&&d.push(_.SIMPLE_WINDOW),e.value==ht.INIT&&d.push(g.init),r.windowMode==q.MAXIMIZE&&d.push(g.maximize,_.MAXIMIZE),r.focused&&d.push(g.focused,_.FOCUSED),tr(b.options.className)&&d.push(b.options.className),d}),p=J(()=>{const d=[],b=n.instance,O=b.options;return O.pinnable&&O.mask!==!0&&!b.isFixedZIndex&&d.push(r.pinned?k.PIN:k.UNPIN),O.resizeMode==rt.RESIZE&&d.push(r.windowMode==q.MAXIMIZE?k.RESTORE:k.MAXIMIZE),O.closeable&&d.push(k.CLOSE),d}),m={getElement:w,getRenderState:I,useCssModule:R,useMenus:f,showLoading:Ze,hideLoading:$e};function w(){return i.value}function I(){return e.value}function R(){return g}async function C(d){d==null||d.preventDefault(),n.instance.toggleMaximize()}function f(){return p.value}function E(d){const b=Array.from(d.querySelectorAll("[autofocus]"));for(const O of b)if(O instanceof HTMLElement&&O.autofocus)return O.focus()}async function v(d){await de();const b=n.instance,O=b.options,Rt=d.el,Q=Rt.getBoundingClientRect();if(e.value==ht.INIT){const W=Math.round(Q.width),Ot=Math.round(Q.height);let oe=Math.round(Q.left),ae=Math.round(Q.top);we(O.left)&&(oe=Math.floor((window.innerWidth-W)/2)),we(O.top)&&(ae=Math.floor((window.innerHeight-Ot)/2)),r.offsetWidth=W,r.offsetHeight=Ot,r.offsetLeft=oe,r.offsetTop=ae,O.maximize&&C(),e.value=ht.MOUNTED,de(()=>{const Je=b.createEvent("show");b.dispatch(Je),E(Rt)})}b.focus()}function S(d){const b=n.instance;b.focus(),!(!b.allowDrag||b.isMaximize)&&b.dragstart(d)}function Dt(d){const b=w();if(b==null)return;const O=b.getBoundingClientRect();d.clientY-O.top>n.instance.allowDragArea||C(d)}function zt(){const d=n.instance;d.component=m,d.state=r,hs(d.id,d);const b=d.createEvent("created");d.dispatch(b)}function Bt(d,b){return d==rt.DISABLED?null:Vr.map(O=>ct("div",{["."+Pt.PROP]:O[1],className:O[0],onPointerdown:b}))}function Ze(d="Loading..."){s.show=!0,s.text=d}function $e(){s.show=!1,s.text=void 0}function Xe(){return s.show!==!0?null:h("div",{class:g.loading},[h("div",{"data-text":s.text,class:g.loader},null)])}return on(We,n.instance),zt(),function(){const d=n.instance,b=d.options;if(r.visible!==!0)return null;const O=h("div",{class:g.main,onDblclick:Dt},[typeof t.default=="function"?t.default(m):h(ne,{body:d.body,key:d.wid},null)]),Rt={ref:i,id:d.wid,onVnodeMounted:v,onPointerdown:S,class:u.value,style:o.value},Q=Bt(b.resizeMode,d.resizestart);let W=ct("div",Rt,[O,Q,Xe()]);if(b.mask===!0){const Ot={zIndex:d.zIndex};W=h("div",{class:g.mask,style:Ot},[W])}return b.teleport===!1?W:h(an,{to:b.teleport},jr(W)?W:{default:()=>[W]})}}}),Gr='<svg width="64" height="64" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path fill="currentColor" d="M590.265 511.987l305.521-305.468c21.617-21.589 21.617-56.636.027-78.252-21.616-21.617-56.663-21.617-78.279 0L512.012 433.735 206.544 128.213c-21.617-21.617-56.635-21.617-78.252 0-21.616 21.589-21.616 56.635-.027 78.252L433.76 511.987 128.211 817.482c-21.617 21.59-21.617 56.635 0 78.251 10.808 10.81 24.967 16.213 39.125 16.213 14.159 0 28.318-5.403 39.126-16.213l305.522-305.468L817.48 895.788C828.289 906.597 842.447 912 856.606 912s28.317-5.403 39.125-16.212c21.618-21.59 21.618-56.636.028-78.252L590.265 511.987z"/></svg>',Zr='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5228" width="64" height="64"><path d="M97.74775349 97.74775349h828.50449302v828.50449302H97.74775349V97.74775349z m103.56306133 103.56306133v621.37837036h621.37837036V201.31081482H201.31081482z" fill="currentColor"></path></svg>',$r='<svg width="64" height="64" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg"><path d="M38.794 124.791v778.495h946.412V124.791H38.794zm896.678 728.033H89.292v-460.9h846.18v460.9z"/></svg>',Xr='<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="64" height="64"><path d="M738.793 681.382v-48.331l88.242-88.243a298.676 298.676 0 00156.712-83.482 38.836 38.836 0 000-54.923l-366.15-366.15a38.836 38.836 0 00-54.923 0 298.52 298.52 0 00-83.519 156.749l-88.169 88.169h-48.332a411.145 411.145 0 00-292.59 121.232c-15.16 15.159-15.16 39.764 0 54.923L278.906 690.17 86.642 882.436a38.836 38.836 0 1054.922 54.922l192.23-192.229 228.844 228.845a38.836 38.836 0 0054.922 0 411.042 411.042 0 00121.233-292.592zM134.02 435.44a333.473 333.473 0 01208.56-72.571l64.406.037a38.836 38.836 0 0027.461-11.351L544.292 241.71a38.68 38.68 0 0011.351-27.462 180.096 180.096 0 0136.798-89.01L898.8 431.593a180.925 180.925 0 01-89.12 36.835 38.836 38.836 0 00-27.462 11.35L672.373 589.626c-7.287 7.286-11.387 17.173-11.35 27.461l.036 64.406a333.318 333.318 0 01-72.608 208.596L134.021 435.44z"/></svg>',Jr='<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="64" height="64"><path d="M845.40952426 212.52063539H65.21904746v702.17142826h780.1904768V212.52063539z m-702.17142933 624.1523808V290.53968285h624.1523808v546.13333334H143.23809493z" fill="currentColor"></path><path d="M981.53650809 76.3936505H201.34603129v78.01904746h702.17142933v624.15238187h78.01904747V76.3936505z" fill="currentColor"></path></svg>',Fe=H({props:{instance:{type:$,required:!0}},setup(n){function t(){n.instance.cancel()}function e(){n.instance.togglePin()}function i(r){r.preventDefault(),n.instance.toggleMaximize()}return function(){const r=n.instance.useMenus(),s=n.instance.useCssModule()??{},o=n.instance.state;return r.map(u=>{switch(u){case k.CLOSE:return h("button",{onClick:t,type:"button",innerHTML:Gr,class:s.closeMenu,title:"关闭"},null);case k.PIN:case k.UNPIN:{const p=o!=null&&o.pinned?"取消固定":"固定",m=o!=null&&o.pinned?s.pinMenu:s.menu;return h("button",{onClick:e,type:"button",innerHTML:Xr,class:m,title:p},null)}case k.MAXIMIZE:case k.RESTORE:{const p=(o==null?void 0:o.windowMode)==q.MAXIMIZE?Jr:Zr,m=(o==null?void 0:o.windowMode)==q.MAXIMIZE?"还原":"最大化";return h("button",{onClick:i,type:"button",innerHTML:p,class:s.menu,title:m},null)}default:return null}})}}}),Qr=["xlink:href"],Kr=H({__name:"Icon",props:{icon:{type:String,required:!0},size:{type:String,default:"14px"},color:{type:String}},setup(n){const t=n,e=J(()=>({fontSize:t.size,color:t.color}));return(i,r)=>(Lt(),It("svg",{class:Et(i.classes.icon),"aria-hidden":"true",style:Ne(e.value)},[ot("use",{"xlink:href":"#"+n.icon},null,8,Qr)],6))}}),ts="ETCBCJiq",es={icon:ts},ns=(n,t)=>{const e=n.__vccOpts||n;for(const[i,r]of t)e[i]=r;return e},is={classes:es},rs=ns(Kr,[["__cssModules",is]]);function Ue(n){const t=n.options.icon;return typeof t=="string"?t.startsWith("svg:")?h(rs,{icon:t.slice(4),size:"18px"},null):h("i",{class:[g.logo,"icon",t]},null):Ae(t)?t:typeof t=="function"?t(n):h("i",{class:g.logo,innerHTML:$r},null)}const ss=H({name:j.SIMPLE_WINDOW,props:{instance:{type:Tt,required:!0}},setup(n){const t=n.instance;function e(r,s){s.stopPropagation(),typeof r.handler=="function"&&r.handler(t)}function i(r){const s=[g.simpleWindowHeaderMenu,_.SIMPLE_WINDOW_MENU];return h("button",{type:"button",class:s,onClick:e.bind(null,r)},[r.label])}return function(){return ct(ie,{instance:t},function(){const r=t.options.menus??[];return h("div",{class:g.simpleWindow},[h("header",{class:[g.header,_.HEADER]},[Ue(t),h("div",{class:g.title},[t.options.title??"新窗口"]),h("div",{class:g.menus,onMousedown:Nt},[r.map(s=>i(s)),h(Fe,{instance:t},null)])]),h("div",{class:[g.body,_.BODY]},[h(ne,{body:t.body,key:t.wid},null)])])})}}}),os=H({name:j.SIMPLE_WINDOW,props:{instance:{type:wt,required:!0}},setup(n){const t=J(()=>{var o;const r=n.instance.options.tabs,s=r.find(u=>u.active===!0);return s?s.name:(o=r[0])==null?void 0:o.name});function e(r){n.instance.switchTab(r),n.instance.focus()}function i(r){const s=r.target.closest("."+g.tabs);if(s==null||s.scrollWidth<s.offsetWidth)return;const{pixelY:o}=ir(r);s.scrollLeft+=o}return function(){const r=n.instance;return ct(ie,{instance:r},function(){const s=(Array.isArray(r.options.tabs)?r.options.tabs:[]).map(o=>{const u={[g.tab]:!0,[g.active]:o.name==t.value,[g.disabled]:o.disabled};return h("div",{class:u,onClick:e.bind(null,o.name),onPointerdown:Nt,onDblclick:Nt},[h("span",null,[o.label])])});return h("div",{class:g.tabsWindow},[h("header",{class:[g.tabsHeader,_.HEADER]},[h("div",{class:g.tabsMain},[Ue(r),h("div",{class:g.tabsTitle},[r.options.title??"新窗口"]),h("div",{class:g.tabs,onWheel:i},[s])]),h("div",{class:g.menus,onMousedown:Nt},[h(Fe,{instance:r},null)])]),h("div",{class:[g.body,_.BODY]},[h(ne,{body:r.body,key:r.wid,params:[t.value]},null)])])})}}});function Ye(n){switch(n){case"SimpleWindow":return ss;case"TabsWindow":return os;default:return ie}}function as(n){if(n.key=="Escape")return ps({forced:!1})}function cs(){T.isMounted=!0}function us(){T.isMounted=!1,T.topWindow=null,T.ids.value=[],T.stack.clear()}function ls(){return Gi()}function ds(){return Zi()}function hs(n,t){T.stack.set(n,t)}function fs(n){if(!T.stack.has(n)||(T.stack.delete(n),!T.isMounted))return;const t=T.ids.value.indexOf(n);t<0||T.ids.value.splice(t,1)}function ps(n){if(T.stack.size==0||T.topWindow==null)return;T.topWindow.options.closeOnPressEsc!==!0||T.topWindow.cancel(n==null?void 0:n.forced)}function gs(n){const t=document.createDocumentFragment(),e=Ye(n.type),i=ct(e,{instance:n});i.appContext=T.appContext,le(i,t),document.body.appendChild(t),n.on("beforeDestroy",()=>{le(null,t)})}function Es(n){switch(n.type){case j.SIMPLE_WINDOW:return Tt.create(n);case j.TABS_WINDOW:return wt.create(n);default:return $.create(n)}}function ms(n){const t=Es(n);return T.isMounted?(T.ids.value.push(t.id),T.stack.set(t.id,t),t):(gs(t),t)}function bs(n){return T.stack.get(n)}function Ts(){return T.ids}function qe(n){if(T.topWindow=n,n!=null){for(const t of T.stack.values()){const e=t.state;e!=null&&(e.focused=t===n)}n.state==null||n.isFixedZIndex||n.state.zIndex<ls()&&(n.state.zIndex=ds())}}function ws(n){const t=T.stack.get(n);qe(t)}function Rs(){const n=Os();qe(n)}function Os(){if(T.stack.size==0)return;let n;for(const t of T.stack.values())if(!(t.state==null||t.state.visible!==!0)){if(n==null){n=t;continue}n.zIndex<t.zIndex&&(n=t)}return n}function Ns(){window.addEventListener("keydown",as,!0)}function As(n){T.appContext=n._context}function yo(){return Array.from(T.stack.values()).some(n=>{var t;return((t=n.state)==null?void 0:t.visible)===!0})}const xo=H({name:"WindowManager",setup(){const n=Ts();return cs(),cn(()=>us()),function(){return n.value.map(t=>{const e=bs(t);if(e==null)return null;const i=Ye(e.type);return i==null?null:ct(i,{instance:e,key:e.wid})})}}});function ys(n){if(n.length==1){const t=n[0];return t==null?null:typeof t=="object"?{...t}:null}if(n.length==2){const[t,e]=n;if(typeof t=="string"&&e!=null)return{title:t,body:e}}if(n.length==3){const[t,e,i]=n;if(typeof t=="string"&&e!=null)return{...i,title:t,body:e}}return null}function Oe(n,t){if(t!=null)for(const e in t){if(n[e]!=null)continue;const i=t[e];i!=null&&(n[e]=i)}}function je(n){const t=ys(n)??{},e=Reflect.get(lt.presets,"default"),i=typeof t.preset=="string"&&t.preset!="default"?Reflect.get(lt.presets,t.preset):void 0;return Oe(t,i),Oe(t,e),t}function vo(...n){const t=je(n)??{};return t.type=j.SIMPLE_WINDOW,Ve(t)}function Io(...n){const t=je(n)??{};return t.type=j.TABS_WINDOW,Ve(t)}function Ve(n){const t=ms(n);return t.ready().then(()=>{n.displayAfterCreate!==!1&&t.show()}),t}function Lo(n){return function(...t){const e=Reflect.get(n,"__XWINDOW_VALUE__");if(e)return e;let i=n(...t);i instanceof $&&(i=i.promisify());const r=i.finally(()=>{Reflect.deleteProperty(n,"__XWINDOW_VALUE__")});return Reflect.defineProperty(n,"__XWINDOW_VALUE__",{configurable:!0,enumerable:!1,writable:!1,value:r}),r}}function xs(n,t){qi(t),Ns(),As(n)}const vs=Fi,So={install:xs,version:vs,registerPreset:$i,registerZIndexManager:Xi},Ge="local",Is="quickprint-local-define",Xt=[{id:"case_01",name:"成绩单",loader:()=>Te(()=>import("./case_01-CP5z7pkX.js"),[])},{id:"case_02",name:"入库单",loader:()=>Te(()=>import("./case_02-C7ch91u3.js"),[])}];function Ls(){const n=localStorage.getItem(Is),t=Qt(n,null);if(t!=null)return{id:Ge,name:"未命名的模板",define:t}}async function Co(n,t=!0){var o;const e=Ls();if(n===Ge)return e;const i=Xt.find(u=>u.id==n);if(i==null)return;const r=await i.loader().catch(u=>(console.log(u),null));if(r==null||r.default==null)return;let s=r.default.define;return t&&((o=e==null?void 0:e.define)==null?void 0:o.id)==i.id&&(s=e.define),{id:i.id,name:i.name,define:s,data:r.default.data,rules:r.default.rules}}function Mo(){const n=Math.floor(Math.random()*Xt.length);return Xt[n]}const re="quickprint-mock-rules";function se(){const n=localStorage.getItem(re);return n==null||n==""?{}:Qt(n,{})}function _o(n,t){if(t==null)return;const e=se();e[t]=n,localStorage.setItem(re,JSON.stringify(e))}function Po(n){if(n!=null)return se()[n]}function Do(n){return n.reduce((t,e)=>{if(mt(e.name))return t;if(t[e.name]=e,e.children&&e.children.length>0){const i=e.name;e.children.forEach(r=>{mt(r.name)||(t[`${i}.${r.name}`]=r)})}return t},{})}function zo(n){const t=se();delete t[n],localStorage.setItem(re,JSON.stringify(t))}export{_n as $,nt as A,Sn as B,zn as C,F as D,fn as E,Ao as F,l as G,No as H,jt as I,Te as J,Ps as K,In as L,qt as M,Fs as N,Vs as O,js as P,ji as Q,un as R,Lo as S,wo as T,vo as U,Gs as V,Bs as W,Io as X,Ds as Y,Mn as Z,Kt as _,Us as a,Pn as a0,Xs as a1,At as a2,go as a3,pe as a4,ge as a5,Qs as a6,ro as a7,no as a8,io as a9,Zs as aA,bn as aB,zs as aC,Ks as aD,pt as aE,pn as aF,Yt as aG,Eo as aH,xo as aI,mo as aJ,So as aK,Oo as aL,Xt as aM,Co as aN,zo as aO,Mo as aP,at as aQ,a as aR,Hs as aS,Z as aT,Do as aU,Po as aV,_o as aW,ft as aa,eo as ab,Ee as ac,to as ad,Js as ae,Ce as af,so as ag,ve as ah,wn as ai,rt as aj,Ms as ak,Ro as al,it as am,$s as an,yt as ao,dt as ap,Me as aq,Dn as ar,bt as as,mn as at,St as au,Ct as av,yo as aw,ks as ax,Ws as ay,X as az,P as b,Ys as c,Ht as d,B as e,gn as f,kt as g,Wt as h,qs as i,Ln as j,To as k,bo as l,mt as m,_s as n,x as o,Qt as p,oo as q,ao as r,xe as s,co as t,Bn as u,po as v,fo as w,uo as x,lo as y,ho as z};
